const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./freemarker2-iKSS_P_J.js","./wrapNativeSuper-ezTqcbMv.js","./index-uubelm5h.js","./iframe-D8WhmL6e.js","./index-TW2i6qtr.js","./index-BHA-8DXB.js","./index-BK_xiHMm.js","./handlebars-BJ1Ug93s.js","./html-BNanwR7z.js","./javascript-BeYYW6DN.js","./typescript-CUcK_uBK.js","./liquid-Db0Z1PkM.js","./mdx-D-joiJ4U.js","./python-CMIRCxP9.js","./razor-DiJRVaBF.js","./xml-CdZT1Zxy.js","./yaml-8Bjt_smL.js","./cssMode-C8zAVF2z.js","./htmlMode-BEKPBxiE.js","./jsonMode-zOFsrIZs.js","./tsMode-62CBXEki.js"])))=>i.map(i=>d[i]);
import{_ as mH,j as St}from"./wrapNativeSuper-ezTqcbMv.js";import{r as ce,R as ze,g as nG}from"./index-uubelm5h.js";import{_ as Le}from"./iframe-D8WhmL6e.js";import{a as sG,b as oG}from"./index-TW2i6qtr.js";import{f as Mb,b8 as _H,b9 as _1,h as bH,aK as rG,ba as aG,a6 as b1,B as vH,a9 as uP,c as gs,C as hC,a1 as CH,L as lG,aA as cG,az as gP,aC as dG,bb as hG,s as uG,j as Rr,aD as gG,aE as fG,af as yH,ae as wH,l as SH,n as uC,bc as vk,m as LH,J as Ab,U as pG,$ as mG,am as _G,D as bG,ao as vG,aq as CG,o as yG,I as xH,a7 as wG,p as kH,r as SG,t as fP,ay as LG,T as n5,z as xG,N as Ck,e as kG}from"./index-BHA-8DXB.js";import{R as DG}from"./index-BK_xiHMm.js";var gC=Mb({},DG),IG=gC.version,TG=gC.render,EG=gC.unmountComponentAtNode,cL;try{var NG=Number((IG||"").split(".")[0]);NG>=18&&(cL=gC.createRoot)}catch{}function s5(s){var e=gC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;e&&bH(e)==="object"&&(e.usingClientEntryPoint=s)}var v1="__rc_react_root__";function RG(s,e){s5(!0);var t=e[v1]||cL(e);s5(!1),t.render(s),e[v1]=t}function MG(s,e){TG(s,e)}function AG(s,e){if(cL){RG(s,e);return}MG(s,e)}function PG(s){return UI.apply(this,arguments)}function UI(){return UI=_H(_1().mark(function s(e){return _1().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Promise.resolve().then(function(){var n;(n=e[v1])===null||n===void 0||n.unmount(),delete e[v1]}));case 1:case"end":return i.stop()}},s)})),UI.apply(this,arguments)}function OG(s){EG(s)}function FG(s){return $I.apply(this,arguments)}function $I(){return $I=_H(_1().mark(function s(e){return _1().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(cL===void 0){i.next=2;break}return i.abrupt("return",PG(e));case 2:OG(e);case 3:case"end":return i.stop()}},s)})),$I.apply(this,arguments)}const BG=s=>{const{componentCls:e,colorPrimary:t}=s;return{[e]:{position:"absolute",background:"transparent",pointerEvents:"none",boxSizing:"border-box",color:`var(--wave-color, ${t})`,boxShadow:"0 0 0 0 currentcolor",opacity:.2,"&.wave-motion-appear":{transition:[`box-shadow 0.4s ${s.motionEaseOutCirc}`,`opacity 2s ${s.motionEaseOutCirc}`].join(","),"&-active":{boxShadow:"0 0 0 6px currentcolor",opacity:0},"&.wave-quick":{transition:[`box-shadow ${s.motionDurationSlow} ${s.motionEaseInOut}`,`opacity ${s.motionDurationSlow} ${s.motionEaseInOut}`].join(",")}}}}},WG=rG("Wave",s=>[BG(s)]),DH=`${aG}-wave-target`;function yk(s){return s&&s!=="#fff"&&s!=="#ffffff"&&s!=="rgb(255, 255, 255)"&&s!=="rgba(255, 255, 255, 1)"&&!/rgba\((?:\d*, ){3}0\)/.test(s)&&s!=="transparent"}function HG(s){const{borderTopColor:e,borderColor:t,backgroundColor:i}=getComputedStyle(s);return yk(e)?e:yk(t)?t:yk(i)?i:null}function wk(s){return Number.isNaN(s)?0:s}const VG=s=>{const{className:e,target:t,component:i}=s,n=ce.useRef(null),[o,r]=ce.useState(null),[a,l]=ce.useState([]),[c,d]=ce.useState(0),[h,u]=ce.useState(0),[g,f]=ce.useState(0),[m,_]=ce.useState(0),[b,v]=ce.useState(!1),C={left:c,top:h,width:g,height:m,borderRadius:a.map(x=>`${x}px`).join(" ")};o&&(C["--wave-color"]=o);function y(){const x=getComputedStyle(t);r(HG(t));const L=x.position==="static",{borderLeftWidth:D,borderTopWidth:T}=x;d(L?t.offsetLeft:wk(-parseFloat(D))),u(L?t.offsetTop:wk(-parseFloat(T))),f(t.offsetWidth),_(t.offsetHeight);const{borderTopLeftRadius:F,borderTopRightRadius:W,borderBottomLeftRadius:H,borderBottomRightRadius:$}=x;l([F,W,$,H].map(V=>wk(parseFloat(V))))}if(ce.useEffect(()=>{if(t){const x=b1(()=>{y(),v(!0)});let L;return typeof ResizeObserver<"u"&&(L=new ResizeObserver(y),L.observe(t)),()=>{b1.cancel(x),L?.disconnect()}}},[]),!b)return null;const w=(i==="Checkbox"||i==="Radio")&&t?.classList.contains(DH);return ce.createElement(vH,{visible:!0,motionAppear:!0,motionName:"wave-motion",motionDeadline:5e3,onAppearEnd:(x,L)=>{var D;if(L.deadline||L.propertyName==="opacity"){const T=(D=n.current)===null||D===void 0?void 0:D.parentElement;FG(T).then(()=>{T?.remove()})}return!1}},(x,L)=>{let{className:D}=x;return ce.createElement("div",{ref:uP(n,L),className:gs(e,D,{"wave-quick":w}),style:C})})},zG=(s,e)=>{var t;const{component:i}=e;if(i==="Checkbox"&&!(!((t=s.querySelector("input"))===null||t===void 0)&&t.checked))return;const n=document.createElement("div");n.style.position="absolute",n.style.left="0px",n.style.top="0px",s?.insertBefore(n,s?.firstChild),AG(ce.createElement(VG,Object.assign({},e,{target:s})),n)},UG=(s,e,t)=>{const{wave:i}=ce.useContext(hC),[,n,o]=CH(),r=lG(c=>{const d=s.current;if(i?.disabled||!d)return;const h=d.querySelector(`.${DH}`)||d,{showEffect:u}=i||{};(u||zG)(h,{className:e,token:n,component:t,event:c,hashId:o})}),a=ce.useRef();return c=>{b1.cancel(a.current),a.current=b1(()=>{r(c)})}},$G=s=>{const{children:e,disabled:t,component:i}=s,{getPrefixCls:n}=ce.useContext(hC),o=ce.useRef(null),r=n("wave"),[,a]=WG(r),l=UG(o,gs(r,a),i);if(ze.useEffect(()=>{const d=o.current;if(!d||d.nodeType!==1||t)return;const h=u=>{!dG(u.target)||!d.getAttribute||d.getAttribute("disabled")||d.disabled||d.className.includes("disabled")||d.className.includes("-leave")||l(u)};return d.addEventListener("click",h,!0),()=>{d.removeEventListener("click",h,!0)}},[t]),!ze.isValidElement(e))return e??null;const c=cG(e)?uP(e.ref,o):o;return gP(e,{ref:c})};var jG=function(s,e){var t={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&e.indexOf(i)<0&&(t[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(s);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(s,i[n])&&(t[i[n]]=s[i[n]]);return t};const IH=ce.createContext(void 0),ZG=s=>{const{getPrefixCls:e,direction:t}=ce.useContext(hC),{prefixCls:i,size:n,className:o}=s,r=jG(s,["prefixCls","size","className"]),a=e("btn-group",i),[,,l]=CH();let c="";switch(n){case"large":c="lg";break;case"small":c="sm";break}const d=gs(a,{[`${a}-${c}`]:c,[`${a}-rtl`]:t==="rtl"},o,l);return ce.createElement(IH.Provider,{value:n},ce.createElement("div",Object.assign({},r,{className:d})))},o5=/^[\u4E00-\u9FA5]{2}$/,jI=o5.test.bind(o5);function b2e(s){return s==="danger"?{danger:!0}:{type:s}}function r5(s){return typeof s=="string"}function Sk(s){return s==="text"||s==="link"}function KG(s,e){if(s==null)return;const t=e?" ":"";return typeof s!="string"&&typeof s!="number"&&r5(s.type)&&jI(s.props.children)?gP(s,{children:s.props.children.split("").join(t)}):r5(s)?jI(s)?ze.createElement("span",null,s.split("").join(t)):ze.createElement("span",null,s):hG(s)?ze.createElement("span",null,s):s}function qG(s,e){let t=!1;const i=[];return ze.Children.forEach(s,n=>{const o=typeof n,r=o==="string"||o==="number";if(t&&r){const a=i.length-1,l=i[a];i[a]=`${l}${n}`}else i.push(n);t=r}),ze.Children.map(i,n=>KG(n,e))}const TH=ce.forwardRef((s,e)=>{const{className:t,style:i,children:n,prefixCls:o}=s,r=gs(`${o}-icon`,t);return ze.createElement("span",{ref:e,className:r,style:i},n)}),a5=ce.forwardRef((s,e)=>{const{prefixCls:t,className:i,style:n,iconClassName:o}=s,r=gs(`${t}-loading-icon`,i);return ze.createElement(TH,{prefixCls:t,className:r,style:n,ref:e},ze.createElement(uG,{className:o}))}),Lk=()=>({width:0,opacity:0,transform:"scale(0)"}),xk=s=>({width:s.scrollWidth,opacity:1,transform:"scale(1)"}),GG=s=>{const{prefixCls:e,loading:t,existIcon:i,className:n,style:o}=s,r=!!t;return i?ze.createElement(a5,{prefixCls:e,className:n,style:o}):ze.createElement(vH,{visible:r,motionName:`${e}-loading-icon-motion`,motionLeave:r,removeOnLeave:!0,onAppearStart:Lk,onAppearActive:xk,onEnterStart:Lk,onEnterActive:xk,onLeaveStart:xk,onLeaveActive:Lk},(a,l)=>{let{className:c,style:d}=a;return ze.createElement(a5,{prefixCls:e,className:n,style:Object.assign(Object.assign({},o),d),ref:l,iconClassName:c})})},l5=(s,e)=>({[`> span, > ${s}`]:{"&:not(:last-child)":{[`&, & > ${s}`]:{"&:not(:disabled)":{borderInlineEndColor:e}}},"&:not(:first-child)":{[`&, & > ${s}`]:{"&:not(:disabled)":{borderInlineStartColor:e}}}}}),YG=s=>{const{componentCls:e,fontSize:t,lineWidth:i,groupBorderColor:n,colorErrorHover:o}=s;return{[`${e}-group`]:[{position:"relative",display:"inline-flex",[`> span, > ${e}`]:{"&:not(:last-child)":{[`&, & > ${e}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},"&:not(:first-child)":{marginInlineStart:s.calc(i).mul(-1).equal(),[`&, & > ${e}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}},[e]:{position:"relative",zIndex:1,"&:hover, &:focus, &:active":{zIndex:2},"&[disabled]":{zIndex:0}},[`${e}-icon-only`]:{fontSize:t}},l5(`${e}-primary`,n),l5(`${e}-danger`,o)]}},qn=Math.round;function kk(s,e){const t=s.replace(/^[^(]*\((.*)/,"$1").replace(/\).*/,"").match(/\d*\.?\d+%?/g)||[],i=t.map(n=>parseFloat(n));for(let n=0;n<3;n+=1)i[n]=e(i[n]||0,t[n]||"",n);return t[3]?i[3]=t[3].includes("%")?i[3]/100:i[3]:i[3]=1,i}const c5=(s,e,t)=>t===0?s:s/100;function zm(s,e){const t=e||255;return s>t?t:s<0?0:s}class dL{constructor(e){Rr(this,"isValid",!0),Rr(this,"r",0),Rr(this,"g",0),Rr(this,"b",0),Rr(this,"a",1),Rr(this,"_h",void 0),Rr(this,"_s",void 0),Rr(this,"_l",void 0),Rr(this,"_v",void 0),Rr(this,"_max",void 0),Rr(this,"_min",void 0),Rr(this,"_brightness",void 0);function t(i){return i[0]in e&&i[1]in e&&i[2]in e}if(e)if(typeof e=="string"){let n=function(o){return i.startsWith(o)};const i=e.trim();/^#?[A-F\d]{3,8}$/i.test(i)?this.fromHexString(i):n("rgb")?this.fromRgbString(i):n("hsl")?this.fromHslString(i):(n("hsv")||n("hsb"))&&this.fromHsvString(i)}else if(e instanceof dL)this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this._h=e._h,this._s=e._s,this._l=e._l,this._v=e._v;else if(t("rgb"))this.r=zm(e.r),this.g=zm(e.g),this.b=zm(e.b),this.a=typeof e.a=="number"?zm(e.a,1):1;else if(t("hsl"))this.fromHsl(e);else if(t("hsv"))this.fromHsv(e);else throw new Error("@ant-design/fast-color: unsupported input "+JSON.stringify(e))}setR(e){return this._sc("r",e)}setG(e){return this._sc("g",e)}setB(e){return this._sc("b",e)}setA(e){return this._sc("a",e,1)}setHue(e){const t=this.toHsv();return t.h=e,this._c(t)}getLuminance(){function e(o){const r=o/255;return r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}const t=e(this.r),i=e(this.g),n=e(this.b);return .2126*t+.7152*i+.0722*n}getHue(){if(typeof this._h>"u"){const e=this.getMax()-this.getMin();e===0?this._h=0:this._h=qn(60*(this.r===this.getMax()?(this.g-this.b)/e+(this.g<this.b?6:0):this.g===this.getMax()?(this.b-this.r)/e+2:(this.r-this.g)/e+4))}return this._h}getSaturation(){if(typeof this._s>"u"){const e=this.getMax()-this.getMin();e===0?this._s=0:this._s=e/this.getMax()}return this._s}getLightness(){return typeof this._l>"u"&&(this._l=(this.getMax()+this.getMin())/510),this._l}getValue(){return typeof this._v>"u"&&(this._v=this.getMax()/255),this._v}getBrightness(){return typeof this._brightness>"u"&&(this._brightness=(this.r*299+this.g*587+this.b*114)/1e3),this._brightness}darken(e=10){const t=this.getHue(),i=this.getSaturation();let n=this.getLightness()-e/100;return n<0&&(n=0),this._c({h:t,s:i,l:n,a:this.a})}lighten(e=10){const t=this.getHue(),i=this.getSaturation();let n=this.getLightness()+e/100;return n>1&&(n=1),this._c({h:t,s:i,l:n,a:this.a})}mix(e,t=50){const i=this._c(e),n=t/100,o=a=>(i[a]-this[a])*n+this[a],r={r:qn(o("r")),g:qn(o("g")),b:qn(o("b")),a:qn(o("a")*100)/100};return this._c(r)}tint(e=10){return this.mix({r:255,g:255,b:255,a:1},e)}shade(e=10){return this.mix({r:0,g:0,b:0,a:1},e)}onBackground(e){const t=this._c(e),i=this.a+t.a*(1-this.a),n=o=>qn((this[o]*this.a+t[o]*t.a*(1-this.a))/i);return this._c({r:n("r"),g:n("g"),b:n("b"),a:i})}isDark(){return this.getBrightness()<128}isLight(){return this.getBrightness()>=128}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}clone(){return this._c(this)}toHexString(){let e="#";const t=(this.r||0).toString(16);e+=t.length===2?t:"0"+t;const i=(this.g||0).toString(16);e+=i.length===2?i:"0"+i;const n=(this.b||0).toString(16);if(e+=n.length===2?n:"0"+n,typeof this.a=="number"&&this.a>=0&&this.a<1){const o=qn(this.a*255).toString(16);e+=o.length===2?o:"0"+o}return e}toHsl(){return{h:this.getHue(),s:this.getSaturation(),l:this.getLightness(),a:this.a}}toHslString(){const e=this.getHue(),t=qn(this.getSaturation()*100),i=qn(this.getLightness()*100);return this.a!==1?`hsla(${e},${t}%,${i}%,${this.a})`:`hsl(${e},${t}%,${i}%)`}toHsv(){return{h:this.getHue(),s:this.getSaturation(),v:this.getValue(),a:this.a}}toRgb(){return{r:this.r,g:this.g,b:this.b,a:this.a}}toRgbString(){return this.a!==1?`rgba(${this.r},${this.g},${this.b},${this.a})`:`rgb(${this.r},${this.g},${this.b})`}toString(){return this.toRgbString()}_sc(e,t,i){const n=this.clone();return n[e]=zm(t,i),n}_c(e){return new this.constructor(e)}getMax(){return typeof this._max>"u"&&(this._max=Math.max(this.r,this.g,this.b)),this._max}getMin(){return typeof this._min>"u"&&(this._min=Math.min(this.r,this.g,this.b)),this._min}fromHexString(e){const t=e.replace("#","");function i(n,o){return parseInt(t[n]+t[o||n],16)}t.length<6?(this.r=i(0),this.g=i(1),this.b=i(2),this.a=t[3]?i(3)/255:1):(this.r=i(0,1),this.g=i(2,3),this.b=i(4,5),this.a=t[6]?i(6,7)/255:1)}fromHsl({h:e,s:t,l:i,a:n}){if(this._h=e%360,this._s=t,this._l=i,this.a=typeof n=="number"?n:1,t<=0){const u=qn(i*255);this.r=u,this.g=u,this.b=u}let o=0,r=0,a=0;const l=e/60,c=(1-Math.abs(2*i-1))*t,d=c*(1-Math.abs(l%2-1));l>=0&&l<1?(o=c,r=d):l>=1&&l<2?(o=d,r=c):l>=2&&l<3?(r=c,a=d):l>=3&&l<4?(r=d,a=c):l>=4&&l<5?(o=d,a=c):l>=5&&l<6&&(o=c,a=d);const h=i-c/2;this.r=qn((o+h)*255),this.g=qn((r+h)*255),this.b=qn((a+h)*255)}fromHsv({h:e,s:t,v:i,a:n}){this._h=e%360,this._s=t,this._v=i,this.a=typeof n=="number"?n:1;const o=qn(i*255);if(this.r=o,this.g=o,this.b=o,t<=0)return;const r=e/60,a=Math.floor(r),l=r-a,c=qn(i*(1-t)*255),d=qn(i*(1-t*l)*255),h=qn(i*(1-t*(1-l))*255);switch(a){case 0:this.g=h,this.b=c;break;case 1:this.r=d,this.b=c;break;case 2:this.r=c,this.b=h;break;case 3:this.r=c,this.g=d;break;case 4:this.r=h,this.g=c;break;case 5:default:this.g=c,this.b=d;break}}fromHsvString(e){const t=kk(e,c5);this.fromHsv({h:t[0],s:t[1],v:t[2],a:t[3]})}fromHslString(e){const t=kk(e,c5);this.fromHsl({h:t[0],s:t[1],l:t[2],a:t[3]})}fromRgbString(e){const t=kk(e,(i,n)=>n.includes("%")?qn(i/100*255):i);this.r=t[0],this.g=t[1],this.b=t[2],this.a=t[3]}}var XG=["b"],QG=["v"],Dk=function(e){return Math.round(Number(e||0))},JG=function(e){if(e instanceof dL)return e;if(e&&bH(e)==="object"&&"h"in e&&"b"in e){var t=e,i=t.b,n=SH(t,XG);return Mb(Mb({},n),{},{v:i})}return typeof e=="string"&&/hsb/.test(e)?e.replace(/hsb/,"hsv"):e},Pb=function(s){gG(t,s);var e=fG(t);function t(i){return yH(this,t),e.call(this,JG(i))}return wH(t,[{key:"toHsbString",value:function(){var n=this.toHsb(),o=Dk(n.s*100),r=Dk(n.b*100),a=Dk(n.h),l=n.a,c="hsb(".concat(a,", ").concat(o,"%, ").concat(r,"%)"),d="hsba(".concat(a,", ").concat(o,"%, ").concat(r,"%, ").concat(l.toFixed(l===0?0:2),")");return l===1?c:d}},{key:"toHsb",value:function(){var n=this.toHsv(),o=n.v,r=SH(n,QG);return Mb(Mb({},r),{},{b:o,a:this.a})}}]),t}(dL),eY=function(e){return e instanceof Pb?e:new Pb(e)};eY("#1677ff");const tY=(s,e)=>s?.replace(/[^\w/]/g,"").slice(0,e?8:6)||"",iY=(s,e)=>s?tY(s,e):"";let nY=function(){function s(e){yH(this,s);var t;if(this.cleared=!1,e instanceof s){this.metaColor=e.metaColor.clone(),this.colors=(t=e.colors)===null||t===void 0?void 0:t.map(n=>({color:new s(n.color),percent:n.percent})),this.cleared=e.cleared;return}const i=Array.isArray(e);i&&e.length?(this.colors=e.map(n=>{let{color:o,percent:r}=n;return{color:new s(o),percent:r}}),this.metaColor=new Pb(this.colors[0].color.metaColor)):this.metaColor=new Pb(i?"":e),(!e||i&&!this.colors)&&(this.metaColor=this.metaColor.setA(0),this.cleared=!0)}return wH(s,[{key:"toHsb",value:function(){return this.metaColor.toHsb()}},{key:"toHsbString",value:function(){return this.metaColor.toHsbString()}},{key:"toHex",value:function(){return iY(this.toHexString(),this.metaColor.a<1)}},{key:"toHexString",value:function(){return this.metaColor.toHexString()}},{key:"toRgb",value:function(){return this.metaColor.toRgb()}},{key:"toRgbString",value:function(){return this.metaColor.toRgbString()}},{key:"isGradient",value:function(){return!!this.colors&&!this.cleared}},{key:"getColors",value:function(){return this.colors||[{color:this,percent:0}]}},{key:"toCssString",value:function(){const{colors:t}=this;return t?`linear-gradient(90deg, ${t.map(n=>`${n.color.toRgbString()} ${n.percent}%`).join(", ")})`:this.metaColor.toRgbString()}},{key:"equals",value:function(t){return!t||this.isGradient()!==t.isGradient()?!1:this.isGradient()?this.colors.length===t.colors.length&&this.colors.every((i,n)=>{const o=t.colors[n];return i.percent===o.percent&&i.color.equals(o.color)}):this.toHexString()===t.toHexString()}}])}();const sY=(s,e)=>{const{r:t,g:i,b:n,a:o}=s.toRgb(),r=new Pb(s.toRgbString()).onBackground(e).toHsv();return o<=.5?r.v>.5:t*.299+i*.587+n*.114>192},EH=s=>{const{paddingInline:e,onlyIconSize:t,paddingBlock:i}=s;return uC(s,{buttonPaddingHorizontal:e,buttonPaddingVertical:i,buttonIconOnlyFontSize:t})},NH=s=>{var e,t,i,n,o,r;const a=(e=s.contentFontSize)!==null&&e!==void 0?e:s.fontSize,l=(t=s.contentFontSizeSM)!==null&&t!==void 0?t:s.fontSize,c=(i=s.contentFontSizeLG)!==null&&i!==void 0?i:s.fontSizeLG,d=(n=s.contentLineHeight)!==null&&n!==void 0?n:vk(a),h=(o=s.contentLineHeightSM)!==null&&o!==void 0?o:vk(l),u=(r=s.contentLineHeightLG)!==null&&r!==void 0?r:vk(c),g=sY(new nY(s.colorBgSolid),"#fff")?"#000":"#fff";return{fontWeight:400,defaultShadow:`0 ${s.controlOutlineWidth}px 0 ${s.controlTmpOutline}`,primaryShadow:`0 ${s.controlOutlineWidth}px 0 ${s.controlOutline}`,dangerShadow:`0 ${s.controlOutlineWidth}px 0 ${s.colorErrorOutline}`,primaryColor:s.colorTextLightSolid,dangerColor:s.colorTextLightSolid,borderColorDisabled:s.colorBorder,defaultGhostColor:s.colorBgContainer,ghostBg:"transparent",defaultGhostBorderColor:s.colorBgContainer,paddingInline:s.paddingContentHorizontal-s.lineWidth,paddingInlineLG:s.paddingContentHorizontal-s.lineWidth,paddingInlineSM:8-s.lineWidth,onlyIconSize:s.fontSizeLG,onlyIconSizeSM:s.fontSizeLG-2,onlyIconSizeLG:s.fontSizeLG+2,groupBorderColor:s.colorPrimaryHover,linkHoverBg:"transparent",textTextColor:s.colorText,textTextHoverColor:s.colorText,textTextActiveColor:s.colorText,textHoverBg:s.colorBgTextHover,defaultColor:s.colorText,defaultBg:s.colorBgContainer,defaultBorderColor:s.colorBorder,defaultBorderColorDisabled:s.colorBorder,defaultHoverBg:s.colorBgContainer,defaultHoverColor:s.colorPrimaryHover,defaultHoverBorderColor:s.colorPrimaryHover,defaultActiveBg:s.colorBgContainer,defaultActiveColor:s.colorPrimaryActive,defaultActiveBorderColor:s.colorPrimaryActive,solidTextColor:g,contentFontSize:a,contentFontSizeSM:l,contentFontSizeLG:c,contentLineHeight:d,contentLineHeightSM:h,contentLineHeightLG:u,paddingBlock:Math.max((s.controlHeight-a*d)/2-s.lineWidth,0),paddingBlockSM:Math.max((s.controlHeightSM-l*h)/2-s.lineWidth,0),paddingBlockLG:Math.max((s.controlHeightLG-c*u)/2-s.lineWidth,0)}},oY=s=>{const{componentCls:e,iconCls:t,fontWeight:i}=s;return{[e]:{outline:"none",position:"relative",display:"inline-flex",gap:s.marginXS,alignItems:"center",justifyContent:"center",fontWeight:i,whiteSpace:"nowrap",textAlign:"center",backgroundImage:"none",background:"transparent",border:`${Ab(s.lineWidth)} ${s.lineType} transparent`,cursor:"pointer",transition:`all ${s.motionDurationMid} ${s.motionEaseInOut}`,userSelect:"none",touchAction:"manipulation",color:s.colorText,"&:disabled > *":{pointerEvents:"none"},"> span":{display:"inline-block"},[`${e}-icon`]:{lineHeight:1},"> a":{color:"currentColor"},"&:not(:disabled)":Object.assign({},pG(s)),[`&${e}-two-chinese-chars::first-letter`]:{letterSpacing:"0.34em"},[`&${e}-two-chinese-chars > *:not(${t})`]:{marginInlineEnd:"-0.34em",letterSpacing:"0.34em"},"&-icon-end":{flexDirection:"row-reverse"}}}},RH=(s,e,t)=>({[`&:not(:disabled):not(${s}-disabled)`]:{"&:hover":e,"&:active":t}}),rY=s=>({minWidth:s.controlHeight,paddingInlineStart:0,paddingInlineEnd:0,borderRadius:"50%"}),aY=s=>({borderRadius:s.controlHeight,paddingInlineStart:s.calc(s.controlHeight).div(2).equal(),paddingInlineEnd:s.calc(s.controlHeight).div(2).equal()}),lY=s=>({cursor:"not-allowed",borderColor:s.borderColorDisabled,color:s.colorTextDisabled,background:s.colorBgContainerDisabled,boxShadow:"none"}),pP=(s,e,t,i,n,o,r,a)=>({[`&${s}-background-ghost`]:Object.assign(Object.assign({color:t||void 0,background:e,borderColor:i||void 0,boxShadow:"none"},RH(s,Object.assign({background:e},r),Object.assign({background:e},a))),{"&:disabled":{cursor:"not-allowed",color:n||void 0,borderColor:o||void 0}})}),cY=s=>({[`&:disabled, &${s.componentCls}-disabled`]:Object.assign({},lY(s))}),dY=s=>({[`&:disabled, &${s.componentCls}-disabled`]:{cursor:"not-allowed",color:s.colorTextDisabled}}),hL=(s,e,t,i)=>{const o=i&&["link","text"].includes(i)?dY:cY;return Object.assign(Object.assign({},o(s)),RH(s.componentCls,e,t))},mP=(s,e,t,i,n)=>({[`&${s.componentCls}-variant-solid`]:Object.assign({color:e,background:t},hL(s,i,n))}),_P=(s,e,t,i,n)=>({[`&${s.componentCls}-variant-outlined, &${s.componentCls}-variant-dashed`]:Object.assign({borderColor:e,background:t},hL(s,i,n))}),bP=s=>({[`&${s.componentCls}-variant-dashed`]:{borderStyle:"dashed"}}),vP=(s,e,t,i)=>({[`&${s.componentCls}-variant-filled`]:Object.assign({boxShadow:"none",background:e},hL(s,t,i))}),Cp=(s,e,t,i,n)=>({[`&${s.componentCls}-variant-${t}`]:Object.assign({color:e,boxShadow:"none"},hL(s,i,n,t))}),hY=s=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:s.defaultColor,boxShadow:s.defaultShadow},mP(s,s.solidTextColor,s.colorBgSolid,{background:s.colorBgSolidHover},{background:s.colorBgSolidActive})),bP(s)),vP(s,s.colorFillTertiary,{background:s.colorFillSecondary},{background:s.colorFill})),Cp(s,s.textTextColor,"link",{color:s.colorLinkHover,background:s.linkHoverBg},{color:s.colorLinkActive})),pP(s.componentCls,s.ghostBg,s.defaultGhostColor,s.defaultGhostBorderColor,s.colorTextDisabled,s.colorBorder)),uY=s=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:s.colorPrimary,boxShadow:s.primaryShadow},_P(s,s.colorPrimary,s.colorBgContainer,{color:s.colorPrimaryTextHover,borderColor:s.colorPrimaryHover,background:s.colorBgContainer},{color:s.colorPrimaryTextActive,borderColor:s.colorPrimaryActive,background:s.colorBgContainer})),bP(s)),vP(s,s.colorPrimaryBg,{background:s.colorPrimaryBgHover},{background:s.colorPrimaryBorder})),Cp(s,s.colorLink,"text",{color:s.colorPrimaryTextHover,background:s.colorPrimaryBg},{color:s.colorPrimaryTextActive,background:s.colorPrimaryBorder})),pP(s.componentCls,s.ghostBg,s.colorPrimary,s.colorPrimary,s.colorTextDisabled,s.colorBorder,{color:s.colorPrimaryHover,borderColor:s.colorPrimaryHover},{color:s.colorPrimaryActive,borderColor:s.colorPrimaryActive})),gY=s=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:s.colorError,boxShadow:s.dangerShadow},mP(s,s.dangerColor,s.colorError,{background:s.colorErrorHover},{background:s.colorErrorActive})),_P(s,s.colorError,s.colorBgContainer,{color:s.colorErrorHover,borderColor:s.colorErrorBorderHover},{color:s.colorErrorActive,borderColor:s.colorErrorActive})),bP(s)),vP(s,s.colorErrorBg,{background:s.colorErrorBgFilledHover},{background:s.colorErrorBgActive})),Cp(s,s.colorError,"text",{color:s.colorErrorHover,background:s.colorErrorBg},{color:s.colorErrorHover,background:s.colorErrorBgActive})),Cp(s,s.colorError,"link",{color:s.colorErrorHover},{color:s.colorErrorActive})),pP(s.componentCls,s.ghostBg,s.colorError,s.colorError,s.colorTextDisabled,s.colorBorder,{color:s.colorErrorHover,borderColor:s.colorErrorHover},{color:s.colorErrorActive,borderColor:s.colorErrorActive})),fY=s=>{const{componentCls:e}=s;return{[`${e}-color-default`]:hY(s),[`${e}-color-primary`]:uY(s),[`${e}-color-dangerous`]:gY(s)}},pY=s=>Object.assign(Object.assign(Object.assign(Object.assign({},_P(s,s.defaultBorderColor,s.defaultBg,{color:s.defaultHoverColor,borderColor:s.defaultHoverBorderColor,background:s.defaultHoverBg},{color:s.defaultActiveColor,borderColor:s.defaultActiveBorderColor,background:s.defaultActiveBg})),Cp(s,s.textTextColor,"text",{color:s.textTextHoverColor,background:s.textHoverBg},{color:s.textTextActiveColor,background:s.colorBgTextActive})),mP(s,s.primaryColor,s.colorPrimary,{background:s.colorPrimaryHover,color:s.primaryColor},{background:s.colorPrimaryActive,color:s.primaryColor})),Cp(s,s.colorLink,"link",{color:s.colorLinkHover,background:s.linkHoverBg},{color:s.colorLinkActive})),CP=function(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const{componentCls:t,controlHeight:i,fontSize:n,lineHeight:o,borderRadius:r,buttonPaddingHorizontal:a,iconCls:l,buttonPaddingVertical:c}=s,d=`${t}-icon-only`;return[{[e]:{fontSize:n,lineHeight:o,height:i,padding:`${Ab(c)} ${Ab(a)}`,borderRadius:r,[`&${d}`]:{width:i,paddingInline:0,[`&${t}-compact-item`]:{flex:"none"},[`&${t}-round`]:{width:"auto"},[l]:{fontSize:s.buttonIconOnlyFontSize}},[`&${t}-loading`]:{opacity:s.opacityLoading,cursor:"default"},[`${t}-loading-icon`]:{transition:`width ${s.motionDurationSlow} ${s.motionEaseInOut}, opacity ${s.motionDurationSlow} ${s.motionEaseInOut}`}}},{[`${t}${t}-circle${e}`]:rY(s)},{[`${t}${t}-round${e}`]:aY(s)}]},mY=s=>{const e=uC(s,{fontSize:s.contentFontSize,lineHeight:s.contentLineHeight});return CP(e,s.componentCls)},_Y=s=>{const e=uC(s,{controlHeight:s.controlHeightSM,fontSize:s.contentFontSizeSM,lineHeight:s.contentLineHeightSM,padding:s.paddingXS,buttonPaddingHorizontal:s.paddingInlineSM,buttonPaddingVertical:s.paddingBlockSM,borderRadius:s.borderRadiusSM,buttonIconOnlyFontSize:s.onlyIconSizeSM});return CP(e,`${s.componentCls}-sm`)},bY=s=>{const e=uC(s,{controlHeight:s.controlHeightLG,fontSize:s.contentFontSizeLG,lineHeight:s.contentLineHeightLG,buttonPaddingHorizontal:s.paddingInlineLG,buttonPaddingVertical:s.paddingBlockLG,borderRadius:s.borderRadiusLG,buttonIconOnlyFontSize:s.onlyIconSizeLG});return CP(e,`${s.componentCls}-lg`)},vY=s=>{const{componentCls:e}=s;return{[e]:{[`&${e}-block`]:{width:"100%"}}}},CY=LH("Button",s=>{const e=EH(s);return[oY(e),mY(e),_Y(e),bY(e),vY(e),fY(e),pY(e),YG(e)]},NH,{unitless:{fontWeight:!0,contentLineHeight:!0,contentLineHeightSM:!0,contentLineHeightLG:!0}});function yY(s,e){return{[`&-item:not(${e}-last-item)`]:{marginBottom:s.calc(s.lineWidth).mul(-1).equal()},"&-item":{"&:hover,&:focus,&:active":{zIndex:2},"&[disabled]":{zIndex:0}}}}function wY(s,e){return{[`&-item:not(${e}-first-item):not(${e}-last-item)`]:{borderRadius:0},[`&-item${e}-first-item:not(${e}-last-item)`]:{[`&, &${s}-sm, &${s}-lg`]:{borderEndEndRadius:0,borderEndStartRadius:0}},[`&-item${e}-last-item:not(${e}-first-item)`]:{[`&, &${s}-sm, &${s}-lg`]:{borderStartStartRadius:0,borderStartEndRadius:0}}}}function SY(s){const e=`${s.componentCls}-compact-vertical`;return{[e]:Object.assign(Object.assign({},yY(s,e)),wY(s.componentCls,e))}}const LY=s=>{const{componentCls:e,calc:t}=s;return{[e]:{[`&-compact-item${e}-primary`]:{[`&:not([disabled]) + ${e}-compact-item${e}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:t(s.lineWidth).mul(-1).equal(),insetInlineStart:t(s.lineWidth).mul(-1).equal(),display:"inline-block",width:s.lineWidth,height:`calc(100% + ${Ab(s.lineWidth)} * 2)`,backgroundColor:s.colorPrimaryHover,content:'""'}}},"&-compact-vertical-item":{[`&${e}-primary`]:{[`&:not([disabled]) + ${e}-compact-vertical-item${e}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:t(s.lineWidth).mul(-1).equal(),insetInlineStart:t(s.lineWidth).mul(-1).equal(),display:"inline-block",width:`calc(100% + ${Ab(s.lineWidth)} * 2)`,height:s.lineWidth,backgroundColor:s.colorPrimaryHover,content:'""'}}}}}}},xY=mG(["Button","compact"],s=>{const e=EH(s);return[_G(e),SY(e),LY(e)]},NH);var kY=function(s,e){var t={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&e.indexOf(i)<0&&(t[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(s);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(s,i[n])&&(t[i[n]]=s[i[n]]);return t};function DY(s){if(typeof s=="object"&&s){let e=s?.delay;return e=!Number.isNaN(e)&&typeof e=="number"?e:0,{loading:e<=0,delay:e}}return{loading:!!s,delay:0}}const IY={default:["default","outlined"],primary:["primary","solid"],dashed:["default","dashed"],link:["primary","link"],text:["default","text"]},TY=ze.forwardRef((s,e)=>{var t,i,n;const{loading:o=!1,prefixCls:r,color:a,variant:l,type:c,danger:d=!1,shape:h="default",size:u,styles:g,disabled:f,className:m,rootClassName:_,children:b,icon:v,iconPosition:C="start",ghost:y=!1,block:w=!1,htmlType:x="button",classNames:L,style:D={},autoInsertSpace:T}=s,F=kY(s,["loading","prefixCls","color","variant","type","danger","shape","size","styles","disabled","className","rootClassName","children","icon","iconPosition","ghost","block","htmlType","classNames","style","autoInsertSpace"]),W=c||"default",[H,$]=ce.useMemo(()=>{if(a&&l)return[a,l];const Bi=IY[W]||[];return d?["danger",Bi[1]]:Bi},[c,a,l,d]),Y=H==="danger"?"dangerous":H,{getPrefixCls:ie,direction:ue,button:fe}=ce.useContext(hC),oe=(t=T??fe?.autoInsertSpace)!==null&&t!==void 0?t:!0,be=ie("btn",r),[xe,wt,pt]=CY(be),Et=ce.useContext(bG),Ei=f??Et,Fi=ce.useContext(IH),Fn=ce.useMemo(()=>DY(o),[o]),[ei,wo]=ce.useState(Fn.loading),[Es,Tr]=ce.useState(!1),Er=uP(e,ce.createRef()),ra=ce.Children.count(b)===1&&!v&&!Sk($);ce.useEffect(()=>{let Bi=null;Fn.delay>0?Bi=setTimeout(()=>{Bi=null,wo(!0)},Fn.delay):wo(Fn.loading);function hi(){Bi&&(clearTimeout(Bi),Bi=null)}return hi},[Fn]),ce.useEffect(()=>{if(!Er||!Er.current||!oe)return;const Bi=Er.current.textContent;ra&&jI(Bi)?Es||Tr(!0):Es&&Tr(!1)},[Er]);const jl=Bi=>{const{onClick:hi}=s;if(ei||Ei){Bi.preventDefault();return}hi?.(Bi)},{compactSize:td,compactItemClassnames:Th}=vG(be,ue),Ag={large:"lg",small:"sm",middle:void 0},Pg=CG(Bi=>{var hi,Ns;return(Ns=(hi=u??td)!==null&&hi!==void 0?hi:Fi)!==null&&Ns!==void 0?Ns:Bi}),aa=Pg&&Ag[Pg]||"",Zl=ei?"loading":v,Jo=yG(F,["navigate"]),Nr=gs(be,wt,pt,{[`${be}-${h}`]:h!=="default"&&h,[`${be}-${W}`]:W,[`${be}-dangerous`]:d,[`${be}-color-${Y}`]:Y,[`${be}-variant-${$}`]:$,[`${be}-${aa}`]:aa,[`${be}-icon-only`]:!b&&b!==0&&!!Zl,[`${be}-background-ghost`]:y&&!Sk($),[`${be}-loading`]:ei,[`${be}-two-chinese-chars`]:Es&&oe&&!ei,[`${be}-block`]:w,[`${be}-rtl`]:ue==="rtl",[`${be}-icon-end`]:C==="end"},Th,m,_,fe?.className),Eh=Object.assign(Object.assign({},fe?.style),D),id=gs(L?.icon,(i=fe?.classNames)===null||i===void 0?void 0:i.icon),Og=Object.assign(Object.assign({},g?.icon||{}),((n=fe?.styles)===null||n===void 0?void 0:n.icon)||{}),Ya=v&&!ei?ze.createElement(TH,{prefixCls:be,className:id,style:Og},v):ze.createElement(GG,{existIcon:!!v,prefixCls:be,loading:ei}),Nh=b||b===0?qG(b,ra&&oe):null;if(Jo.href!==void 0)return xe(ze.createElement("a",Object.assign({},Jo,{className:gs(Nr,{[`${be}-disabled`]:Ei}),href:Ei?void 0:Jo.href,style:Eh,onClick:jl,ref:Er,tabIndex:Ei?-1:0}),Ya,Nh));let er=ze.createElement("button",Object.assign({},F,{type:x,className:Nr,style:Eh,onClick:jl,disabled:Ei,ref:Er}),Ya,Nh,!!Th&&ze.createElement(xY,{key:"compact",prefixCls:be}));return Sk($)||(er=ze.createElement($G,{component:"Button",disabled:ei},er)),xe(er)}),yP=TY;yP.Group=ZG;yP.__ANT_BUTTON=!0;var EY={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"}}]},name:"down",theme:"outlined"},NY=function(e,t){return ce.createElement(xH,mH({},e,{ref:t,icon:EY}))},RY=ce.forwardRef(NY);function MY(s,e,t){var i=t||{},n=i.noTrailing,o=n===void 0?!1:n,r=i.noLeading,a=r===void 0?!1:r,l=i.debounceMode,c=l===void 0?void 0:l,d,h=!1,u=0;function g(){d&&clearTimeout(d)}function f(_){var b=_||{},v=b.upcomingOnly,C=v===void 0?!1:v;g(),h=!C}function m(){for(var _=arguments.length,b=new Array(_),v=0;v<_;v++)b[v]=arguments[v];var C=this,y=Date.now()-u;if(h)return;function w(){u=Date.now(),e.apply(C,b)}function x(){d=void 0}!a&&c&&!d&&w(),g(),c===void 0&&y>s?a?(u=Date.now(),o||(d=setTimeout(c?x:w,s))):w():o!==!0&&(d=setTimeout(c?x:w,c===void 0?s-y:s))}return m.cancel=f,m}function AY(s,e,t){var i={},n=i.atBegin,o=n===void 0?!1:n;return MY(s,e,{debounceMode:o!==!1})}const C1=100,MH=C1/5,AH=C1/2-MH/2,Ik=AH*2*Math.PI,d5=50,h5=s=>{const{dotClassName:e,style:t,hasCircleCls:i}=s;return ce.createElement("circle",{className:gs(`${e}-circle`,{[`${e}-circle-bg`]:i}),r:AH,cx:d5,cy:d5,strokeWidth:MH,style:t})},PY=s=>{let{percent:e,prefixCls:t}=s;const i=`${t}-dot`,n=`${i}-holder`,o=`${n}-hidden`,[r,a]=ce.useState(!1);wG(()=>{e!==0&&a(!0)},[e!==0]);const l=Math.max(Math.min(e,100),0);if(!r)return null;const c={strokeDashoffset:`${Ik/4}`,strokeDasharray:`${Ik*l/100} ${Ik*(100-l)/100}`};return ce.createElement("span",{className:gs(n,`${i}-progress`,l<=0&&o)},ce.createElement("svg",{viewBox:`0 0 ${C1} ${C1}`,role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":l},ce.createElement(h5,{dotClassName:i,hasCircleCls:!0}),ce.createElement(h5,{dotClassName:i,style:c})))};function OY(s){const{prefixCls:e,percent:t=0}=s,i=`${e}-dot`,n=`${i}-holder`,o=`${n}-hidden`;return ce.createElement(ce.Fragment,null,ce.createElement("span",{className:gs(n,t>0&&o)},ce.createElement("span",{className:gs(i,`${e}-dot-spin`)},[1,2,3,4].map(r=>ce.createElement("i",{className:`${e}-dot-item`,key:r})))),ce.createElement(PY,{prefixCls:e,percent:t}))}function FY(s){const{prefixCls:e,indicator:t,percent:i}=s,n=`${e}-dot`;return t&&ce.isValidElement(t)?gP(t,{className:gs(t.props.className,n),percent:i}):ce.createElement(OY,{prefixCls:e,percent:i})}const BY=new kH("antSpinMove",{to:{opacity:1}}),WY=new kH("antRotate",{to:{transform:"rotate(405deg)"}}),HY=s=>{const{componentCls:e,calc:t}=s;return{[e]:Object.assign(Object.assign({},SG(s)),{position:"absolute",display:"none",color:s.colorPrimary,fontSize:0,textAlign:"center",verticalAlign:"middle",opacity:0,transition:`transform ${s.motionDurationSlow} ${s.motionEaseInOutCirc}`,"&-spinning":{position:"relative",display:"inline-block",opacity:1},[`${e}-text`]:{fontSize:s.fontSize,paddingTop:t(t(s.dotSize).sub(s.fontSize)).div(2).add(2).equal()},"&-fullscreen":{position:"fixed",width:"100vw",height:"100vh",backgroundColor:s.colorBgMask,zIndex:s.zIndexPopupBase,inset:0,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",opacity:0,visibility:"hidden",transition:`all ${s.motionDurationMid}`,"&-show":{opacity:1,visibility:"visible"},[e]:{[`${e}-dot-holder`]:{color:s.colorWhite},[`${e}-text`]:{color:s.colorTextLightSolid}}},"&-nested-loading":{position:"relative",[`> div > ${e}`]:{position:"absolute",top:0,insetInlineStart:0,zIndex:4,display:"block",width:"100%",height:"100%",maxHeight:s.contentHeight,[`${e}-dot`]:{position:"absolute",top:"50%",insetInlineStart:"50%",margin:t(s.dotSize).mul(-1).div(2).equal()},[`${e}-text`]:{position:"absolute",top:"50%",width:"100%",textShadow:`0 1px 2px ${s.colorBgContainer}`},[`&${e}-show-text ${e}-dot`]:{marginTop:t(s.dotSize).div(2).mul(-1).sub(10).equal()},"&-sm":{[`${e}-dot`]:{margin:t(s.dotSizeSM).mul(-1).div(2).equal()},[`${e}-text`]:{paddingTop:t(t(s.dotSizeSM).sub(s.fontSize)).div(2).add(2).equal()},[`&${e}-show-text ${e}-dot`]:{marginTop:t(s.dotSizeSM).div(2).mul(-1).sub(10).equal()}},"&-lg":{[`${e}-dot`]:{margin:t(s.dotSizeLG).mul(-1).div(2).equal()},[`${e}-text`]:{paddingTop:t(t(s.dotSizeLG).sub(s.fontSize)).div(2).add(2).equal()},[`&${e}-show-text ${e}-dot`]:{marginTop:t(s.dotSizeLG).div(2).mul(-1).sub(10).equal()}}},[`${e}-container`]:{position:"relative",transition:`opacity ${s.motionDurationSlow}`,"&::after":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,zIndex:10,width:"100%",height:"100%",background:s.colorBgContainer,opacity:0,transition:`all ${s.motionDurationSlow}`,content:'""',pointerEvents:"none"}},[`${e}-blur`]:{clear:"both",opacity:.5,userSelect:"none",pointerEvents:"none","&::after":{opacity:.4,pointerEvents:"auto"}}},"&-tip":{color:s.spinDotDefault},[`${e}-dot-holder`]:{width:"1em",height:"1em",fontSize:s.dotSize,display:"inline-block",transition:`transform ${s.motionDurationSlow} ease, opacity ${s.motionDurationSlow} ease`,transformOrigin:"50% 50%",lineHeight:1,color:s.colorPrimary,"&-hidden":{transform:"scale(0.3)",opacity:0}},[`${e}-dot-progress`]:{position:"absolute",top:"50%",transform:"translate(-50%, -50%)",insetInlineStart:"50%"},[`${e}-dot`]:{position:"relative",display:"inline-block",fontSize:s.dotSize,width:"1em",height:"1em","&-item":{position:"absolute",display:"block",width:t(s.dotSize).sub(t(s.marginXXS).div(2)).div(2).equal(),height:t(s.dotSize).sub(t(s.marginXXS).div(2)).div(2).equal(),background:"currentColor",borderRadius:"100%",transform:"scale(0.75)",transformOrigin:"50% 50%",opacity:.3,animationName:BY,animationDuration:"1s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDirection:"alternate","&:nth-child(1)":{top:0,insetInlineStart:0,animationDelay:"0s"},"&:nth-child(2)":{top:0,insetInlineEnd:0,animationDelay:"0.4s"},"&:nth-child(3)":{insetInlineEnd:0,bottom:0,animationDelay:"0.8s"},"&:nth-child(4)":{bottom:0,insetInlineStart:0,animationDelay:"1.2s"}},"&-spin":{transform:"rotate(45deg)",animationName:WY,animationDuration:"1.2s",animationIterationCount:"infinite",animationTimingFunction:"linear"},"&-circle":{strokeLinecap:"round",transition:["stroke-dashoffset","stroke-dasharray","stroke","stroke-width","opacity"].map(i=>`${i} ${s.motionDurationSlow} ease`).join(","),fillOpacity:0,stroke:"currentcolor"},"&-circle-bg":{stroke:s.colorFillSecondary}},[`&-sm ${e}-dot`]:{"&, &-holder":{fontSize:s.dotSizeSM}},[`&-sm ${e}-dot-holder`]:{i:{width:t(t(s.dotSizeSM).sub(t(s.marginXXS).div(2))).div(2).equal(),height:t(t(s.dotSizeSM).sub(t(s.marginXXS).div(2))).div(2).equal()}},[`&-lg ${e}-dot`]:{"&, &-holder":{fontSize:s.dotSizeLG}},[`&-lg ${e}-dot-holder`]:{i:{width:t(t(s.dotSizeLG).sub(s.marginXXS)).div(2).equal(),height:t(t(s.dotSizeLG).sub(s.marginXXS)).div(2).equal()}},[`&${e}-show-text ${e}-text`]:{display:"block"}})}},VY=s=>{const{controlHeightLG:e,controlHeight:t}=s;return{contentHeight:400,dotSize:e/2,dotSizeSM:e*.35,dotSizeLG:t}},zY=LH("Spin",s=>{const e=uC(s,{spinDotDefault:s.colorTextDescription});return[HY(e)]},VY),UY=200,u5=[[30,.05],[70,.03],[96,.01]];function $Y(s,e){const[t,i]=ce.useState(0),n=ce.useRef(),o=e==="auto";return ce.useEffect(()=>(o&&s&&(i(0),n.current=setInterval(()=>{i(r=>{const a=100-r;for(let l=0;l<u5.length;l+=1){const[c,d]=u5[l];if(r<=c)return r+a*d}return r})},UY)),()=>{clearInterval(n.current)}),[o,s]),o?t:e}var jY=function(s,e){var t={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&e.indexOf(i)<0&&(t[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(s);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(s,i[n])&&(t[i[n]]=s[i[n]]);return t};let PH;function ZY(s,e){return!!s&&!!e&&!isNaN(Number(e))}const OH=s=>{var e;const{prefixCls:t,spinning:i=!0,delay:n=0,className:o,rootClassName:r,size:a="default",tip:l,wrapperClassName:c,style:d,children:h,fullscreen:u=!1,indicator:g,percent:f}=s,m=jY(s,["prefixCls","spinning","delay","className","rootClassName","size","tip","wrapperClassName","style","children","fullscreen","indicator","percent"]),{getPrefixCls:_,direction:b,spin:v}=ce.useContext(hC),C=_("spin",t),[y,w,x]=zY(C),[L,D]=ce.useState(()=>i&&!ZY(i,n)),T=$Y(L,f);ce.useEffect(()=>{if(i){const ie=AY(n,()=>{D(!0)});return ie(),()=>{var ue;(ue=ie?.cancel)===null||ue===void 0||ue.call(ie)}}D(!1)},[n,i]);const F=ce.useMemo(()=>typeof h<"u"&&!u,[h,u]),W=gs(C,v?.className,{[`${C}-sm`]:a==="small",[`${C}-lg`]:a==="large",[`${C}-spinning`]:L,[`${C}-show-text`]:!!l,[`${C}-rtl`]:b==="rtl"},o,!u&&r,w,x),H=gs(`${C}-container`,{[`${C}-blur`]:L}),$=(e=g??v?.indicator)!==null&&e!==void 0?e:PH,V=Object.assign(Object.assign({},v?.style),d),Y=ce.createElement("div",Object.assign({},m,{style:V,className:W,"aria-live":"polite","aria-busy":L}),ce.createElement(FY,{prefixCls:C,indicator:$,percent:T}),l&&(F||u)?ce.createElement("div",{className:`${C}-text`},l):null);return y(F?ce.createElement("div",Object.assign({},m,{className:gs(`${C}-nested-loading`,c,w,x)}),L&&ce.createElement("div",{key:"loading"},Y),ce.createElement("div",{className:H,key:"container"},h)):u?ce.createElement("div",{className:gs(`${C}-fullscreen`,{[`${C}-fullscreen-show`]:L},r,w,x)},Y):Y)};OH.setDefaultIndicator=s=>{PH=s};var KY={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M840 192h-56v-72c0-13.3-10.7-24-24-24H168c-13.3 0-24 10.7-24 24v272c0 13.3 10.7 24 24 24h592c13.3 0 24-10.7 24-24V256h32v200H465c-22.1 0-40 17.9-40 40v136h-44c-4.4 0-8 3.6-8 8v228c0 .6.1 1.3.2 1.9A83.99 83.99 0 00457 960c46.4 0 84-37.6 84-84 0-2.1-.1-4.1-.2-6.1.1-.6.2-1.2.2-1.9V640c0-4.4-3.6-8-8-8h-44V520h351c22.1 0 40-17.9 40-40V232c0-22.1-17.9-40-40-40zM720 352H208V160h512v192zM477 876c0 11-9 20-20 20s-20-9-20-20V696h40v180z"}}]},name:"format-painter",theme:"outlined"},qY=function(e,t){return ce.createElement(xH,mH({},e,{ref:t,icon:KY}))},GY=ce.forwardRef(qY);function FH(s,e,t){var i=this,n=ce.useRef(null),o=ce.useRef(0),r=ce.useRef(null),a=ce.useRef([]),l=ce.useRef(),c=ce.useRef(),d=ce.useRef(s),h=ce.useRef(!0);d.current=s;var u=typeof window<"u",g=!e&&e!==0&&u;if(typeof s!="function")throw new TypeError("Expected a function");e=+e||0;var f=!!(t=t||{}).leading,m=!("trailing"in t)||!!t.trailing,_="maxWait"in t,b="debounceOnServer"in t&&!!t.debounceOnServer,v=_?Math.max(+t.maxWait||0,e):null;ce.useEffect(function(){return h.current=!0,function(){h.current=!1}},[]);var C=ce.useMemo(function(){var y=function(F){var W=a.current,H=l.current;return a.current=l.current=null,o.current=F,c.current=d.current.apply(H,W)},w=function(F,W){g&&cancelAnimationFrame(r.current),r.current=g?requestAnimationFrame(F):setTimeout(F,W)},x=function(F){if(!h.current)return!1;var W=F-n.current;return!n.current||W>=e||W<0||_&&F-o.current>=v},L=function(F){return r.current=null,m&&a.current?y(F):(a.current=l.current=null,c.current)},D=function F(){var W=Date.now();if(x(W))return L(W);if(h.current){var H=e-(W-n.current),$=_?Math.min(H,v-(W-o.current)):H;w(F,$)}},T=function(){if(u||b){var F=Date.now(),W=x(F);if(a.current=[].slice.call(arguments),l.current=i,n.current=F,W){if(!r.current&&h.current)return o.current=n.current,w(D,e),f?y(n.current):c.current;if(_)return w(D,e),y(n.current)}return r.current||w(D,e),c.current}};return T.cancel=function(){r.current&&(g?cancelAnimationFrame(r.current):clearTimeout(r.current)),o.current=0,a.current=n.current=l.current=r.current=null},T.isPending=function(){return!!r.current},T.flush=function(){return r.current?L(Date.now()):c.current},T},[f,_,e,v,m,g,u,b]);return C}function YY(s,e,t){var i=t===void 0?{}:t,n=i.leading,o=i.trailing;return FH(s,e,{maxWait:e,leading:n===void 0||n,trailing:o===void 0||o})}const ZI=s=>{const{horizontal:e,reversed:t,verticalAlign:i="start",horizontalAlign:n="start",gap:o=8,height:r="auto",width:a="100%",grow:l,style:c,...d}=s,h=ce.useMemo(()=>e?t?"row-reverse":"row":t?"column-reverse":"column",[e,t]);return St.jsx("div",{style:{display:"flex",flexDirection:h,justifyContent:e?n:i,alignItems:e?i:n,height:r,width:a,gap:o,flexGrow:l?1:void 0,...c},...d})};ZI.__docgenInfo={description:"",methods:[],displayName:"Stack",props:{horizontal:{required:!1,tsType:{name:"boolean"},description:""},reversed:{required:!1,tsType:{name:"boolean"},description:""},grow:{required:!1,tsType:{name:"boolean"},description:""},verticalAlign:{required:!1,tsType:{name:"union",raw:`| 'start'
| 'end'
| 'center'
| 'space-between'
| 'space-around'
| 'space-evenly'
| 'baseline'
| 'stretch'`,elements:[{name:"literal",value:"'start'"},{name:"literal",value:"'end'"},{name:"literal",value:"'center'"},{name:"literal",value:"'space-between'"},{name:"literal",value:"'space-around'"},{name:"literal",value:"'space-evenly'"},{name:"literal",value:"'baseline'"},{name:"literal",value:"'stretch'"}]},description:""},horizontalAlign:{required:!1,tsType:{name:"union",raw:`| 'start'
| 'end'
| 'center'
| 'space-between'
| 'space-around'
| 'space-evenly'
| 'baseline'
| 'stretch'`,elements:[{name:"literal",value:"'start'"},{name:"literal",value:"'end'"},{name:"literal",value:"'center'"},{name:"literal",value:"'space-between'"},{name:"literal",value:"'space-around'"},{name:"literal",value:"'space-evenly'"},{name:"literal",value:"'baseline'"},{name:"literal",value:"'stretch'"}]},description:""},gap:{required:!1,tsType:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}]},description:""},height:{required:!1,tsType:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}]},description:""},width:{required:!1,tsType:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}]},description:""}}};function XY(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function g5(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),t.push.apply(t,i)}return t}function f5(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?g5(Object(t),!0).forEach(function(i){XY(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):g5(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}function QY(s,e){if(s==null)return{};var t={},i=Object.keys(s),n,o;for(o=0;o<i.length;o++)n=i[o],!(e.indexOf(n)>=0)&&(t[n]=s[n]);return t}function JY(s,e){if(s==null)return{};var t=QY(s,e),i,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(s);for(n=0;n<o.length;n++)i=o[n],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(s,i)&&(t[i]=s[i])}return t}function eX(s,e){return tX(s)||iX(s,e)||nX(s,e)||sX()}function tX(s){if(Array.isArray(s))return s}function iX(s,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(s)))){var t=[],i=!0,n=!1,o=void 0;try{for(var r=s[Symbol.iterator](),a;!(i=(a=r.next()).done)&&(t.push(a.value),!(e&&t.length===e));i=!0);}catch(l){n=!0,o=l}finally{try{!i&&r.return!=null&&r.return()}finally{if(n)throw o}}return t}}function nX(s,e){if(s){if(typeof s=="string")return p5(s,e);var t=Object.prototype.toString.call(s).slice(8,-1);if(t==="Object"&&s.constructor&&(t=s.constructor.name),t==="Map"||t==="Set")return Array.from(s);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return p5(s,e)}}function p5(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=s[t];return i}function sX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oX(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function m5(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),t.push.apply(t,i)}return t}function _5(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?m5(Object(t),!0).forEach(function(i){oX(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):m5(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}function rX(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];return function(i){return e.reduceRight(function(n,o){return o(n)},i)}}function b_(s){return function e(){for(var t=this,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return n.length>=s.length?s.apply(this,n):function(){for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return e.apply(t,[].concat(n,a))}}}function y1(s){return{}.toString.call(s).includes("Object")}function aX(s){return!Object.keys(s).length}function Ob(s){return typeof s=="function"}function lX(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function cX(s,e){return y1(e)||Ud("changeType"),Object.keys(e).some(function(t){return!lX(s,t)})&&Ud("changeField"),e}function dX(s){Ob(s)||Ud("selectorType")}function hX(s){Ob(s)||y1(s)||Ud("handlerType"),y1(s)&&Object.values(s).some(function(e){return!Ob(e)})&&Ud("handlersType")}function uX(s){s||Ud("initialIsRequired"),y1(s)||Ud("initialType"),aX(s)&&Ud("initialContent")}function gX(s,e){throw new Error(s[e]||s.default)}var fX={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},Ud=b_(gX)(fX),hy={changes:cX,selector:dX,handler:hX,initial:uX};function pX(s){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};hy.initial(s),hy.handler(e);var t={current:s},i=b_(bX)(t,e),n=b_(_X)(t),o=b_(hy.changes)(s),r=b_(mX)(t);function a(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(d){return d};return hy.selector(c),c(t.current)}function l(c){rX(i,n,o,r)(c)}return[a,l]}function mX(s,e){return Ob(e)?e(s.current):e}function _X(s,e){return s.current=_5(_5({},s.current),e),e}function bX(s,e,t){return Ob(e)?e(s.current):Object.keys(t).forEach(function(i){var n;return(n=e[i])===null||n===void 0?void 0:n.call(e,s.current[i])}),t}var vX={create:pX},CX={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}};function yX(s){return function e(){for(var t=this,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return n.length>=s.length?s.apply(this,n):function(){for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return e.apply(t,[].concat(n,a))}}}function wX(s){return{}.toString.call(s).includes("Object")}function SX(s){return s||b5("configIsRequired"),wX(s)||b5("configType"),s.urls?(LX(),{paths:{vs:s.urls.monacoBase}}):s}function LX(){console.warn(BH.deprecation)}function xX(s,e){throw new Error(s[e]||s.default)}var BH={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},b5=yX(xX)(BH),kX={config:SX},DX=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(n){return t.reduceRight(function(o,r){return r(o)},n)}};function WH(s,e){return Object.keys(e).forEach(function(t){e[t]instanceof Object&&s[t]&&Object.assign(e[t],WH(s[t],e[t]))}),f5(f5({},s),e)}var IX={type:"cancelation",msg:"operation is manually canceled"};function Tk(s){var e=!1,t=new Promise(function(i,n){s.then(function(o){return e?n(IX):i(o)}),s.catch(n)});return t.cancel=function(){return e=!0},t}var TX=vX.create({config:CX,isInitialized:!1,resolve:null,reject:null,monaco:null}),HH=eX(TX,2),fC=HH[0],uL=HH[1];function EX(s){var e=kX.config(s),t=e.monaco,i=JY(e,["monaco"]);uL(function(n){return{config:WH(n.config,i),monaco:t}})}function NX(){var s=fC(function(e){var t=e.monaco,i=e.isInitialized,n=e.resolve;return{monaco:t,isInitialized:i,resolve:n}});if(!s.isInitialized){if(uL({isInitialized:!0}),s.monaco)return s.resolve(s.monaco),Tk(Ek);if(window.monaco&&window.monaco.editor)return VH(window.monaco),s.resolve(window.monaco),Tk(Ek);DX(RX,AX)(PX)}return Tk(Ek)}function RX(s){return document.body.appendChild(s)}function MX(s){var e=document.createElement("script");return s&&(e.src=s),e}function AX(s){var e=fC(function(i){var n=i.config,o=i.reject;return{config:n,reject:o}}),t=MX("".concat(e.config.paths.vs,"/loader.js"));return t.onload=function(){return s()},t.onerror=e.reject,t}function PX(){var s=fC(function(t){var i=t.config,n=t.resolve,o=t.reject;return{config:i,resolve:n,reject:o}}),e=window.require;e.config(s.config),e(["vs/editor/editor.main"],function(t){VH(t),s.resolve(t)},function(t){s.reject(t)})}function VH(s){fC().monaco||uL({monaco:s})}function OX(){return fC(function(s){var e=s.monaco;return e})}var Ek=new Promise(function(s,e){return uL({resolve:s,reject:e})}),Fb={config:EX,init:NX,__getMonacoInstance:OX},FX={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},Nk=FX,BX={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},WX=BX;function HX({children:s}){return ze.createElement("div",{style:WX.container},s)}var VX=HX,zX=VX;function UX({width:s,height:e,isEditorReady:t,loading:i,_ref:n,className:o,wrapperProps:r}){return ze.createElement("section",{style:{...Nk.wrapper,width:s,height:e},...r},!t&&ze.createElement(zX,null,i),ze.createElement("div",{ref:n,style:{...Nk.fullWidth,...!t&&Nk.hide},className:o}))}var $X=UX,zH=ce.memo($X);function jX(s){ce.useEffect(s,[])}var wP=jX;function ZX(s,e,t=!0){let i=ce.useRef(!0);ce.useEffect(i.current||!t?()=>{i.current=!1}:s,e)}var rr=ZX;function j_(){}function _f(s,e,t,i){return KX(s,i)||qX(s,e,t,i)}function KX(s,e){return s.editor.getModel(UH(s,e))}function qX(s,e,t,i){return s.editor.createModel(e,t,i?UH(s,i):void 0)}function UH(s,e){return s.Uri.parse(e)}function GX({original:s,modified:e,language:t,originalLanguage:i,modifiedLanguage:n,originalModelPath:o,modifiedModelPath:r,keepCurrentOriginalModel:a=!1,keepCurrentModifiedModel:l=!1,theme:c="light",loading:d="Loading...",options:h={},height:u="100%",width:g="100%",className:f,wrapperProps:m={},beforeMount:_=j_,onMount:b=j_}){let[v,C]=ce.useState(!1),[y,w]=ce.useState(!0),x=ce.useRef(null),L=ce.useRef(null),D=ce.useRef(null),T=ce.useRef(b),F=ce.useRef(_),W=ce.useRef(!1);wP(()=>{let Y=Fb.init();return Y.then(ie=>(L.current=ie)&&w(!1)).catch(ie=>ie?.type!=="cancelation"&&console.error("Monaco initialization: error:",ie)),()=>x.current?V():Y.cancel()}),rr(()=>{if(x.current&&L.current){let Y=x.current.getOriginalEditor(),ie=_f(L.current,s||"",i||t||"text",o||"");ie!==Y.getModel()&&Y.setModel(ie)}},[o],v),rr(()=>{if(x.current&&L.current){let Y=x.current.getModifiedEditor(),ie=_f(L.current,e||"",n||t||"text",r||"");ie!==Y.getModel()&&Y.setModel(ie)}},[r],v),rr(()=>{let Y=x.current.getModifiedEditor();Y.getOption(L.current.editor.EditorOption.readOnly)?Y.setValue(e||""):e!==Y.getValue()&&(Y.executeEdits("",[{range:Y.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),Y.pushUndoStop())},[e],v),rr(()=>{x.current?.getModel()?.original.setValue(s||"")},[s],v),rr(()=>{let{original:Y,modified:ie}=x.current.getModel();L.current.editor.setModelLanguage(Y,i||t||"text"),L.current.editor.setModelLanguage(ie,n||t||"text")},[t,i,n],v),rr(()=>{L.current?.editor.setTheme(c)},[c],v),rr(()=>{x.current?.updateOptions(h)},[h],v);let H=ce.useCallback(()=>{if(!L.current)return;F.current(L.current);let Y=_f(L.current,s||"",i||t||"text",o||""),ie=_f(L.current,e||"",n||t||"text",r||"");x.current?.setModel({original:Y,modified:ie})},[t,e,n,s,i,o,r]),$=ce.useCallback(()=>{!W.current&&D.current&&(x.current=L.current.editor.createDiffEditor(D.current,{automaticLayout:!0,...h}),H(),L.current?.editor.setTheme(c),C(!0),W.current=!0)},[h,c,H]);ce.useEffect(()=>{v&&T.current(x.current,L.current)},[v]),ce.useEffect(()=>{!y&&!v&&$()},[y,v,$]);function V(){let Y=x.current?.getModel();a||Y?.original?.dispose(),l||Y?.modified?.dispose(),x.current?.dispose()}return ze.createElement(zH,{width:g,height:u,isEditorReady:v,loading:d,_ref:D,className:f,wrapperProps:m})}var YX=GX;ce.memo(YX);function XX(){let[s,e]=ce.useState(Fb.__getMonacoInstance());return wP(()=>{let t;return s||(t=Fb.init(),t.then(i=>{e(i)})),()=>t?.cancel()}),s}var QX=XX;function JX(s){let e=ce.useRef();return ce.useEffect(()=>{e.current=s},[s]),e.current}var eQ=JX,uy=new Map;function tQ({defaultValue:s,defaultLanguage:e,defaultPath:t,value:i,language:n,path:o,theme:r="light",line:a,loading:l="Loading...",options:c={},overrideServices:d={},saveViewState:h=!0,keepCurrentModel:u=!1,width:g="100%",height:f="100%",className:m,wrapperProps:_={},beforeMount:b=j_,onMount:v=j_,onChange:C,onValidate:y=j_}){let[w,x]=ce.useState(!1),[L,D]=ce.useState(!0),T=ce.useRef(null),F=ce.useRef(null),W=ce.useRef(null),H=ce.useRef(v),$=ce.useRef(b),V=ce.useRef(),Y=ce.useRef(i),ie=eQ(o),ue=ce.useRef(!1),fe=ce.useRef(!1);wP(()=>{let xe=Fb.init();return xe.then(wt=>(T.current=wt)&&D(!1)).catch(wt=>wt?.type!=="cancelation"&&console.error("Monaco initialization: error:",wt)),()=>F.current?be():xe.cancel()}),rr(()=>{let xe=_f(T.current,s||i||"",e||n||"",o||t||"");xe!==F.current?.getModel()&&(h&&uy.set(ie,F.current?.saveViewState()),F.current?.setModel(xe),h&&F.current?.restoreViewState(uy.get(o)))},[o],w),rr(()=>{F.current?.updateOptions(c)},[c],w),rr(()=>{!F.current||i===void 0||(F.current.getOption(T.current.editor.EditorOption.readOnly)?F.current.setValue(i):i!==F.current.getValue()&&(fe.current=!0,F.current.executeEdits("",[{range:F.current.getModel().getFullModelRange(),text:i,forceMoveMarkers:!0}]),F.current.pushUndoStop(),fe.current=!1))},[i],w),rr(()=>{let xe=F.current?.getModel();xe&&n&&T.current?.editor.setModelLanguage(xe,n)},[n],w),rr(()=>{a!==void 0&&F.current?.revealLine(a)},[a],w),rr(()=>{T.current?.editor.setTheme(r)},[r],w);let oe=ce.useCallback(()=>{if(!(!W.current||!T.current)&&!ue.current){$.current(T.current);let xe=o||t,wt=_f(T.current,i||s||"",e||n||"",xe||"");F.current=T.current?.editor.create(W.current,{model:wt,automaticLayout:!0,...c},d),h&&F.current.restoreViewState(uy.get(xe)),T.current.editor.setTheme(r),a!==void 0&&F.current.revealLine(a),x(!0),ue.current=!0}},[s,e,t,i,n,o,c,d,h,r,a]);ce.useEffect(()=>{w&&H.current(F.current,T.current)},[w]),ce.useEffect(()=>{!L&&!w&&oe()},[L,w,oe]),Y.current=i,ce.useEffect(()=>{w&&C&&(V.current?.dispose(),V.current=F.current?.onDidChangeModelContent(xe=>{fe.current||C(F.current.getValue(),xe)}))},[w,C]),ce.useEffect(()=>{if(w){let xe=T.current.editor.onDidChangeMarkers(wt=>{let pt=F.current.getModel()?.uri;if(pt&&wt.find(Et=>Et.path===pt.path)){let Et=T.current.editor.getModelMarkers({resource:pt});y?.(Et)}});return()=>{xe?.dispose()}}return()=>{}},[w,y]);function be(){V.current?.dispose(),u?h&&uy.set(o,F.current.saveViewState()):F.current.getModel()?.dispose(),F.current.dispose()}return ze.createElement(zH,{width:g,height:f,isEditorReady:w,loading:l,_ref:W,className:m,wrapperProps:_})}var iQ=tQ,nQ=ce.memo(iQ);self.monaco&&Fb.config({monaco:self.monaco});function tr(s,e=0){return s[s.length-(1+e)]}function sQ(s){if(s.length===0)throw new Error("Invalid tail call");return[s.slice(0,s.length-1),s[s.length-1]]}function ii(s,e,t=(i,n)=>i===n){if(s===e)return!0;if(!s||!e||s.length!==e.length)return!1;for(let i=0,n=s.length;i<n;i++)if(!t(s[i],e[i]))return!1;return!0}function oQ(s,e){const t=s.length-1;e<t&&(s[e]=s[t]),s.pop()}function Bb(s,e,t){return rQ(s.length,i=>t(s[i],e))}function rQ(s,e){let t=0,i=s-1;for(;t<=i;){const n=(t+i)/2|0,o=e(n);if(o<0)t=n+1;else if(o>0)i=n-1;else return n}return-(t+1)}function KI(s,e,t){if(s=s|0,s>=e.length)throw new TypeError("invalid index");const i=e[Math.floor(e.length*Math.random())],n=[],o=[],r=[];for(const a of e){const l=t(a,i);l<0?n.push(a):l>0?o.push(a):r.push(a)}return s<n.length?KI(s,n,t):s<n.length+r.length?r[0]:KI(s-(n.length+r.length),o,t)}function v5(s,e){const t=[];let i;for(const n of s.slice(0).sort(e))!i||e(i[0],n)!==0?(i=[n],t.push(i)):i.push(n);return t}function*SP(s,e){let t,i;for(const n of s)i!==void 0&&e(i,n)?t.push(n):(t&&(yield t),t=[n]),i=n;t&&(yield t)}function $H(s,e){for(let t=0;t<=s.length;t++)e(t===0?void 0:s[t-1],t===s.length?void 0:s[t])}function aQ(s,e){for(let t=0;t<s.length;t++)e(t===0?void 0:s[t-1],s[t],t+1===s.length?void 0:s[t+1])}function Yr(s){return s.filter(e=>!!e)}function C5(s){let e=0;for(let t=0;t<s.length;t++)s[t]&&(s[e]=s[t],e+=1);s.length=e}function jH(s){return!Array.isArray(s)||s.length===0}function os(s){return Array.isArray(s)&&s.length>0}function Pc(s,e=t=>t){const t=new Set;return s.filter(i=>{const n=e(i);return t.has(n)?!1:(t.add(n),!0)})}function LP(s,e){return s.length>0?s[0]:e}function As(s,e){let t=typeof e=="number"?s:0;typeof e=="number"?t=s:(t=0,e=s);const i=[];if(t<=e)for(let n=t;n<e;n++)i.push(n);else for(let n=t;n>e;n--)i.push(n);return i}function gL(s,e,t){const i=s.slice(0,e),n=s.slice(e);return i.concat(t,n)}function Rk(s,e){const t=s.indexOf(e);t>-1&&(s.splice(t,1),s.unshift(e))}function gy(s,e){const t=s.indexOf(e);t>-1&&(s.splice(t,1),s.push(e))}function qI(s,e){for(const t of e)s.push(t)}function xP(s){return Array.isArray(s)?s:[s]}function lQ(s,e,t){const i=ZH(s,e),n=s.length,o=t.length;s.length=n+o;for(let r=n-1;r>=i;r--)s[r+o]=s[r];for(let r=0;r<o;r++)s[r+i]=t[r]}function y5(s,e,t,i){const n=ZH(s,e);let o=s.splice(n,t);return o===void 0&&(o=[]),lQ(s,n,i),o}function ZH(s,e){return e<0?Math.max(e+s.length,0):Math.min(e,s.length)}var Wb;(function(s){function e(o){return o<0}s.isLessThan=e;function t(o){return o<=0}s.isLessThanOrEqual=t;function i(o){return o>0}s.isGreaterThan=i;function n(o){return o===0}s.isNeitherLessOrGreaterThan=n,s.greaterThan=1,s.lessThan=-1,s.neitherLessOrGreaterThan=0})(Wb||(Wb={}));function bs(s,e){return(t,i)=>e(s(t),s(i))}function cQ(...s){return(e,t)=>{for(const i of s){const n=i(e,t);if(!Wb.isNeitherLessOrGreaterThan(n))return n}return Wb.neitherLessOrGreaterThan}}const qr=(s,e)=>s-e,dQ=(s,e)=>qr(s?1:0,e?1:0);function KH(s){return(e,t)=>-s(e,t)}class Oc{constructor(e){this.items=e,this.firstIdx=0,this.lastIdx=this.items.length-1}get length(){return this.lastIdx-this.firstIdx+1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;const i=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,i}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;const i=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,i}peek(){if(this.length!==0)return this.items[this.firstIdx]}dequeue(){const e=this.items[this.firstIdx];return this.firstIdx++,e}takeCount(e){const t=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,t}}class Dc{static{this.empty=new Dc(e=>{})}constructor(e){this.iterate=e}toArray(){const e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new Dc(t=>this.iterate(i=>e(i)?t(i):!0))}map(e){return new Dc(t=>this.iterate(i=>t(e(i))))}findLast(e){let t;return this.iterate(i=>(e(i)&&(t=i),!0)),t}findLastMaxBy(e){let t,i=!0;return this.iterate(n=>((i||Wb.isGreaterThan(e(n,t)))&&(i=!1,t=n),!0)),t}}class w1{constructor(e){this._indexMap=e}static createSortPermutation(e,t){const i=Array.from(e.keys()).sort((n,o)=>t(e[n],e[o]));return new w1(i)}apply(e){return e.map((t,i)=>e[this._indexMap[i]])}inverse(){const e=this._indexMap.slice();for(let t=0;t<this._indexMap.length;t++)e[this._indexMap[t]]=t;return new w1(e)}}function zs(s){return typeof s=="string"}function dn(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)&&!(s instanceof RegExp)&&!(s instanceof Date)}function hQ(s){const e=Object.getPrototypeOf(Uint8Array);return typeof s=="object"&&s instanceof e}function Jd(s){return typeof s=="number"&&!isNaN(s)}function w5(s){return!!s&&typeof s[Symbol.iterator]=="function"}function qH(s){return s===!0||s===!1}function ns(s){return typeof s>"u"}function Sl(s){return!Mo(s)}function Mo(s){return ns(s)||s===null}function gt(s,e){if(!s)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function Id(s){if(Mo(s))throw new Error("Assertion Failed: argument is undefined or null");return s}function Hb(s){return typeof s=="function"}function uQ(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++)gQ(s[i],e[i])}function gQ(s,e){if(zs(e)){if(typeof s!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(Hb(e)){try{if(s instanceof e)return}catch{}if(!Mo(s)&&s.constructor===e||e.length===1&&e.call(void 0,s)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function lc(s){if(!s||typeof s!="object"||s instanceof RegExp)return s;const e=Array.isArray(s)?[]:{};return Object.entries(s).forEach(([t,i])=>{e[t]=i&&typeof i=="object"?lc(i):i}),e}function fQ(s){if(!s||typeof s!="object")return s;const e=[s];for(;e.length>0;){const t=e.shift();Object.freeze(t);for(const i in t)if(GH.call(t,i)){const n=t[i];typeof n=="object"&&!Object.isFrozen(n)&&!hQ(n)&&e.push(n)}}return s}const GH=Object.prototype.hasOwnProperty;function YH(s,e){return GI(s,e,new Set)}function GI(s,e,t){if(Mo(s))return s;const i=e(s);if(typeof i<"u")return i;if(Array.isArray(s)){const n=[];for(const o of s)n.push(GI(o,e,t));return n}if(dn(s)){if(t.has(s))throw new Error("Cannot clone recursive data-structure");t.add(s);const n={};for(const o in s)GH.call(s,o)&&(n[o]=GI(s[o],e,t));return t.delete(s),n}return s}function fL(s,e,t=!0){return dn(s)?(dn(e)&&Object.keys(e).forEach(i=>{i in s?t&&(dn(s[i])&&dn(e[i])?fL(s[i],e[i],t):s[i]=e[i]):s[i]=e[i]}),s):e}function co(s,e){if(s===e)return!0;if(s==null||e===null||e===void 0||typeof s!=typeof e||typeof s!="object"||Array.isArray(s)!==Array.isArray(e))return!1;let t,i;if(Array.isArray(s)){if(s.length!==e.length)return!1;for(t=0;t<s.length;t++)if(!co(s[t],e[t]))return!1}else{const n=[];for(i in s)n.push(i);n.sort();const o=[];for(i in e)o.push(i);if(o.sort(),!co(n,o))return!1;for(t=0;t<n.length;t++)if(!co(s[n[t]],e[n[t]]))return!1}return!0}function pQ(s){let e=[];for(;Object.prototype!==s;)e=e.concat(Object.getOwnPropertyNames(s)),s=Object.getPrototypeOf(s);return e}function YI(s){const e=[];for(const t of pQ(s))typeof s[t]=="function"&&e.push(t);return e}function mQ(s,e){const t=n=>function(){const o=Array.prototype.slice.call(arguments,0);return e(n,o)},i={};for(const n of s)i[n]=t(n);return i}function XH(){return globalThis._VSCODE_NLS_MESSAGES}function kP(){return globalThis._VSCODE_NLS_LANGUAGE}const _Q=kP()==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function S1(s,e){let t;return e.length===0?t=s:t=s.replace(/\{(\d+)\}/g,(i,n)=>{const o=n[0],r=e[o];let a=i;return typeof r=="string"?a=r:(typeof r=="number"||typeof r=="boolean"||r===void 0||r===null)&&(a=String(r)),a}),_Q&&(t=""+t.replace(/[aouei]/g,"$&$&")+""),t}function p(s,e,...t){return S1(typeof s=="number"?QH(s,e):e,t)}function QH(s,e){const t=XH()?.[s];if(typeof t!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${s} !!!`)}return t}function Re(s,e,...t){let i;typeof s=="number"?i=QH(s,e):i=e;const n=S1(i,t);return{value:n,original:e===i?n:S1(e,t)}}const bf="en";let L1=!1,x1=!1,Dw=!1,JH=!1,DP=!1,IP=!1,e6=!1,fy,Iw=bf,S5=bf,bQ,ec;const Ic=globalThis;let nr;typeof Ic.vscode<"u"&&typeof Ic.vscode.process<"u"?nr=Ic.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(nr=process);const vQ=typeof nr?.versions?.electron=="string",CQ=vQ&&nr?.type==="renderer";if(typeof nr=="object"){L1=nr.platform==="win32",x1=nr.platform==="darwin",Dw=nr.platform==="linux",Dw&&nr.env.SNAP&&nr.env.SNAP_REVISION,nr.env.CI||nr.env.BUILD_ARTIFACTSTAGINGDIRECTORY,fy=bf,Iw=bf;const s=nr.env.VSCODE_NLS_CONFIG;if(s)try{const e=JSON.parse(s);fy=e.userLocale,S5=e.osLocale,Iw=e.resolvedLanguage||bf,bQ=e.languagePack?.translationsConfigFile}catch{}JH=!0}else typeof navigator=="object"&&!CQ?(ec=navigator.userAgent,L1=ec.indexOf("Windows")>=0,x1=ec.indexOf("Macintosh")>=0,IP=(ec.indexOf("Macintosh")>=0||ec.indexOf("iPad")>=0||ec.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,Dw=ec.indexOf("Linux")>=0,e6=ec?.indexOf("Mobi")>=0,DP=!0,Iw=kP()||bf,fy=navigator.language.toLowerCase(),S5=fy):console.error("Unable to resolve platform.");const An=L1,Qe=x1,ys=Dw,Ia=JH,gg=DP,yQ=DP&&typeof Ic.importScripts=="function",wQ=yQ?Ic.origin:void 0,Oa=IP,t6=e6,Dl=ec,SQ=Iw,LQ=typeof Ic.postMessage=="function"&&!Ic.importScripts,i6=(()=>{if(LQ){const s=[];Ic.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let i=0,n=s.length;i<n;i++){const o=s[i];if(o.id===t.data.vscodeScheduleAsyncWork){s.splice(i,1),o.callback();return}}});let e=0;return t=>{const i=++e;s.push({id:i,callback:t}),Ic.postMessage({vscodeScheduleAsyncWork:i},"*")}}return s=>setTimeout(s)})(),lo=x1||IP?2:L1?1:3;let L5=!0,x5=!1;function n6(){if(!x5){x5=!0;const s=new Uint8Array(2);s[0]=1,s[1]=2,L5=new Uint16Array(s.buffer)[0]===513}return L5}const s6=!!(Dl&&Dl.indexOf("Chrome")>=0),xQ=!!(Dl&&Dl.indexOf("Firefox")>=0),kQ=!!(!s6&&Dl&&Dl.indexOf("Safari")>=0),DQ=!!(Dl&&Dl.indexOf("Edg/")>=0),IQ=!!(Dl&&Dl.indexOf("Android")>=0),Vn={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}};var st;(function(s){function e(y){return y&&typeof y=="object"&&typeof y[Symbol.iterator]=="function"}s.is=e;const t=Object.freeze([]);function i(){return t}s.empty=i;function*n(y){yield y}s.single=n;function o(y){return e(y)?y:n(y)}s.wrap=o;function r(y){return y||t}s.from=r;function*a(y){for(let w=y.length-1;w>=0;w--)yield y[w]}s.reverse=a;function l(y){return!y||y[Symbol.iterator]().next().done===!0}s.isEmpty=l;function c(y){return y[Symbol.iterator]().next().value}s.first=c;function d(y,w){let x=0;for(const L of y)if(w(L,x++))return!0;return!1}s.some=d;function h(y,w){for(const x of y)if(w(x))return x}s.find=h;function*u(y,w){for(const x of y)w(x)&&(yield x)}s.filter=u;function*g(y,w){let x=0;for(const L of y)yield w(L,x++)}s.map=g;function*f(y,w){let x=0;for(const L of y)yield*w(L,x++)}s.flatMap=f;function*m(...y){for(const w of y)yield*w}s.concat=m;function _(y,w,x){let L=x;for(const D of y)L=w(L,D);return L}s.reduce=_;function*b(y,w,x=y.length){for(w<0&&(w+=y.length),x<0?x+=y.length:x>y.length&&(x=y.length);w<x;w++)yield y[w]}s.slice=b;function v(y,w=Number.POSITIVE_INFINITY){const x=[];if(w===0)return[x,y];const L=y[Symbol.iterator]();for(let D=0;D<w;D++){const T=L.next();if(T.done)return[x,s.empty()];x.push(T.value)}return[x,{[Symbol.iterator](){return L}}]}s.consume=v;async function C(y){const w=[];for await(const x of y)w.push(x);return Promise.resolve(w)}s.asyncToArray=C})(st||(st={}));let Gi=class Tw{static{this.Undefined=new Tw(void 0)}constructor(e){this.element=e,this.next=Tw.Undefined,this.prev=Tw.Undefined}};class fs{constructor(){this._first=Gi.Undefined,this._last=Gi.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===Gi.Undefined}clear(){let e=this._first;for(;e!==Gi.Undefined;){const t=e.next;e.prev=Gi.Undefined,e.next=Gi.Undefined,e=t}this._first=Gi.Undefined,this._last=Gi.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const i=new Gi(e);if(this._first===Gi.Undefined)this._first=i,this._last=i;else if(t){const o=this._last;this._last=i,i.prev=o,o.next=i}else{const o=this._first;this._first=i,i.next=o,o.prev=i}this._size+=1;let n=!1;return()=>{n||(n=!0,this._remove(i))}}shift(){if(this._first!==Gi.Undefined){const e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==Gi.Undefined){const e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==Gi.Undefined&&e.next!==Gi.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===Gi.Undefined&&e.next===Gi.Undefined?(this._first=Gi.Undefined,this._last=Gi.Undefined):e.next===Gi.Undefined?(this._last=this._last.prev,this._last.next=Gi.Undefined):e.prev===Gi.Undefined&&(this._first=this._first.next,this._first.prev=Gi.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==Gi.Undefined;)yield e.element,e=e.next}}const k1="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function TQ(s=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(const t of k1)s.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}const TP=TQ();function EP(s){let e=TP;if(s&&s instanceof RegExp)if(s.global)e=s;else{let t="g";s.ignoreCase&&(t+="i"),s.multiline&&(t+="m"),s.unicode&&(t+="u"),e=new RegExp(s.source,t)}return e.lastIndex=0,e}const o6=new fs;o6.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function Vb(s,e,t,i,n){if(e=EP(e),n||(n=st.first(o6)),t.length>n.maxLen){let c=s-n.maxLen/2;return c<0?c=0:i+=c,t=t.substring(c,s+n.maxLen/2),Vb(s,e,t,i,n)}const o=Date.now(),r=s-1-i;let a=-1,l=null;for(let c=1;!(Date.now()-o>=n.timeBudget);c++){const d=r-n.windowSize*c;e.lastIndex=Math.max(0,d);const h=EQ(e,t,r,a);if(!h&&l||(l=h,d<=0))break;a=d}if(l){const c={word:l[0],startColumn:i+1+l.index,endColumn:i+1+l.index+l[0].length};return e.lastIndex=0,c}return null}function EQ(s,e,t,i){let n;for(;n=s.exec(e);){const o=n.index||0;if(o<=t&&s.lastIndex>=t)return n;if(i>0&&o>i)return null}return null}const ol=8;class r6{constructor(e){this._values=e}hasChanged(e){return this._values[e]}}class a6{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class Jt{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return pL(e,t)}compute(e,t,i){return i}}class Z_{constructor(e,t){this.newValue=e,this.didChange=t}}function pL(s,e){if(typeof s!="object"||typeof e!="object"||!s||!e)return new Z_(e,s!==e);if(Array.isArray(s)||Array.isArray(e)){const i=Array.isArray(s)&&Array.isArray(e)&&ii(s,e);return new Z_(e,!i)}let t=!1;for(const i in e)if(e.hasOwnProperty(i)){const n=pL(s[i],e[i]);n.didChange&&(s[i]=n.newValue,t=!0)}return new Z_(s,t)}class pC{constructor(e){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return pL(e,t)}validate(e){return this.defaultValue}}class gm{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return pL(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,i){return i}}function ve(s,e){return typeof s>"u"?e:s==="false"?!1:!!s}class ht extends gm{constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="boolean",n.default=i),super(e,t,i,n)}validate(e){return ve(e,this.defaultValue)}}function jh(s,e,t,i){if(typeof s>"u")return e;let n=parseInt(s,10);return isNaN(n)?e:(n=Math.max(t,n),n=Math.min(i,n),n|0)}class Pt extends gm{static clampedInt(e,t,i,n){return jh(e,t,i,n)}constructor(e,t,i,n,o,r=void 0){typeof r<"u"&&(r.type="integer",r.default=i,r.minimum=n,r.maximum=o),super(e,t,i,r),this.minimum=n,this.maximum=o}validate(e){return Pt.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}}function NQ(s,e,t,i){if(typeof s>"u")return e;const n=Fo.float(s,e);return Fo.clamp(n,t,i)}class Fo extends gm{static clamp(e,t,i){return e<t?t:e>i?i:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;const i=parseFloat(e);return isNaN(i)?t:i}constructor(e,t,i,n,o){typeof o<"u"&&(o.type="number",o.default=i),super(e,t,i,o),this.validationFn=n}validate(e){return this.validationFn(Fo.float(e,this.defaultValue))}}class ts extends gm{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="string",n.default=i),super(e,t,i,n)}validate(e){return ts.string(e,this.defaultValue)}}function pi(s,e,t,i){return typeof s!="string"?e:i&&s in i?i[s]:t.indexOf(s)===-1?e:s}class fi extends gm{constructor(e,t,i,n,o=void 0){typeof o<"u"&&(o.type="string",o.enum=n,o.default=i),super(e,t,i,o),this._allowedValues=n}validate(e){return pi(e,this.defaultValue,this._allowedValues)}}class py extends Jt{constructor(e,t,i,n,o,r,a=void 0){typeof a<"u"&&(a.type="string",a.enum=o,a.default=n),super(e,t,i,a),this._allowedValues=o,this._convert=r}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}}function RQ(s){switch(s){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}class MQ extends Jt{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[p("accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached."),p("accessibilitySupport.on","Optimize for usage with a Screen Reader."),p("accessibilitySupport.off","Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:p("accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,i){return i===0?e.accessibilitySupport:i}}class AQ extends Jt{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:p("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:p("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertSpace:ve(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:ve(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}function PQ(s){switch(s){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var bn;(function(s){s[s.Line=1]="Line",s[s.Block=2]="Block",s[s.Underline=3]="Underline",s[s.LineThin=4]="LineThin",s[s.BlockOutline=5]="BlockOutline",s[s.UnderlineThin=6]="UnderlineThin"})(bn||(bn={}));function OQ(s){switch(s){case"line":return bn.Line;case"block":return bn.Block;case"underline":return bn.Underline;case"line-thin":return bn.LineThin;case"block-outline":return bn.BlockOutline;case"underline-thin":return bn.UnderlineThin}}class FQ extends pC{constructor(){super(143)}compute(e,t,i){const n=["monaco-editor"];return t.get(39)&&n.push(t.get(39)),e.extraEditorClassName&&n.push(e.extraEditorClassName),t.get(74)==="default"?n.push("mouse-default"):t.get(74)==="copy"&&n.push("mouse-copy"),t.get(112)&&n.push("showUnused"),t.get(141)&&n.push("showDeprecated"),n.join(" ")}}class BQ extends ht{constructor(){super(37,"emptySelectionClipboard",!0,{description:p("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(e,t,i){return i&&e.emptySelectionClipboard}}class WQ extends Jt{constructor(){const e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(41,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:p("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[p("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),p("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),p("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:p("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[p("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),p("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),p("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:p("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:p("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:Qe},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:p("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:p("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{cursorMoveOnType:ve(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":pi(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":pi(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:ve(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:ve(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:ve(t.loop,this.defaultValue.loop)}}}class Ur extends Jt{static{this.OFF='"liga" off, "calt" off'}static{this.ON='"liga" on, "calt" on'}constructor(){super(51,"fontLigatures",Ur.OFF,{anyOf:[{type:"boolean",description:p("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:p("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:p("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?Ur.OFF:e==="true"?Ur.ON:e:e?Ur.ON:Ur.OFF}}class gc extends Jt{static{this.OFF="normal"}static{this.TRANSLATE="translate"}constructor(){super(54,"fontVariations",gc.OFF,{anyOf:[{type:"boolean",description:p("fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:p("fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:p("fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?gc.OFF:e==="true"?gc.TRANSLATE:e:e?gc.TRANSLATE:gc.OFF}compute(e,t,i){return e.fontInfo.fontVariationSettings}}class HQ extends pC{constructor(){super(50)}compute(e,t,i){return e.fontInfo}}class VQ extends gm{constructor(){super(52,"fontSize",vs.fontSize,{type:"number",minimum:6,maximum:100,default:vs.fontSize,description:p("fontSize","Controls the font size in pixels.")})}validate(e){const t=Fo.float(e,this.defaultValue);return t===0?vs.fontSize:Fo.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}}class tu extends Jt{static{this.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"]}static{this.MINIMUM_VALUE=1}static{this.MAXIMUM_VALUE=1e3}constructor(){super(53,"fontWeight",vs.fontWeight,{anyOf:[{type:"number",minimum:tu.MINIMUM_VALUE,maximum:tu.MAXIMUM_VALUE,errorMessage:p("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:tu.SUGGESTION_VALUES}],default:vs.fontWeight,description:p("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(Pt.clampedInt(e,vs.fontWeight,tu.MINIMUM_VALUE,tu.MAXIMUM_VALUE))}}class zQ extends Jt{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[p("editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),p("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),p("editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(58,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:p("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:p("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:p("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:p("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:p("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:p("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:p("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:p("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:p("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:p("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:p("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{multiple:pi(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:t.multipleDefinitions??pi(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:t.multipleTypeDefinitions??pi(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:t.multipleDeclarations??pi(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:t.multipleImplementations??pi(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:t.multipleReferences??pi(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:t.multipleTests??pi(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:ts.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:ts.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:ts.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:ts.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:ts.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:ts.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}}class UQ extends Jt{constructor(){const e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(60,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:p("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:p("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:p("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:p("hover.hidingDelay","Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:p("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ve(t.enabled,this.defaultValue.enabled),delay:Pt.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:ve(t.sticky,this.defaultValue.sticky),hidingDelay:Pt.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:ve(t.above,this.defaultValue.above)}}}class $f extends pC{constructor(){super(146)}compute(e,t,i){return $f.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){const t=e.height/e.lineHeight,i=Math.floor(e.paddingTop/e.lineHeight);let n=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(n=Math.max(n,t-1));const o=(i+e.viewLineCount+n)/(e.pixelRatio*e.height),r=Math.floor(e.viewLineCount/o);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:i,extraLinesBeyondLastLine:n,desiredRatio:o,minimapLineCount:r}}static _computeMinimapLayout(e,t){const i=e.outerWidth,n=e.outerHeight,o=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(o*n),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:n};const r=t.stableMinimapLayoutInput,a=r&&e.outerHeight===r.outerHeight&&e.lineHeight===r.lineHeight&&e.typicalHalfwidthCharacterWidth===r.typicalHalfwidthCharacterWidth&&e.pixelRatio===r.pixelRatio&&e.scrollBeyondLastLine===r.scrollBeyondLastLine&&e.paddingTop===r.paddingTop&&e.paddingBottom===r.paddingBottom&&e.minimap.enabled===r.minimap.enabled&&e.minimap.side===r.minimap.side&&e.minimap.size===r.minimap.size&&e.minimap.showSlider===r.minimap.showSlider&&e.minimap.renderCharacters===r.minimap.renderCharacters&&e.minimap.maxColumn===r.minimap.maxColumn&&e.minimap.scale===r.minimap.scale&&e.verticalScrollbarWidth===r.verticalScrollbarWidth&&e.isViewportWrapping===r.isViewportWrapping,l=e.lineHeight,c=e.typicalHalfwidthCharacterWidth,d=e.scrollBeyondLastLine,h=e.minimap.renderCharacters;let u=o>=2?Math.round(e.minimap.scale*2):e.minimap.scale;const g=e.minimap.maxColumn,f=e.minimap.size,m=e.minimap.side,_=e.verticalScrollbarWidth,b=e.viewLineCount,v=e.remainingWidth,C=e.isViewportWrapping,y=h?2:3;let w=Math.floor(o*n);const x=w/o;let L=!1,D=!1,T=y*u,F=u/o,W=1;if(f==="fill"||f==="fit"){const{typicalViewportLineCount:fe,extraLinesBeforeFirstLine:oe,extraLinesBeyondLastLine:be,desiredRatio:xe,minimapLineCount:wt}=$f.computeContainedMinimapLineCount({viewLineCount:b,scrollBeyondLastLine:d,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:n,lineHeight:l,pixelRatio:o});if(b/wt>1)L=!0,D=!0,u=1,T=1,F=u/o;else{let Et=!1,Ei=u+1;if(f==="fit"){const Fi=Math.ceil((oe+b+be)*T);C&&a&&v<=t.stableFitRemainingWidth?(Et=!0,Ei=t.stableFitMaxMinimapScale):Et=Fi>w}if(f==="fill"||Et){L=!0;const Fi=u;T=Math.min(l*o,Math.max(1,Math.floor(1/xe))),C&&a&&v<=t.stableFitRemainingWidth&&(Ei=t.stableFitMaxMinimapScale),u=Math.min(Ei,Math.max(1,Math.floor(T/y))),u>Fi&&(W=Math.min(2,u/Fi)),F=u/o/W,w=Math.ceil(Math.max(fe,oe+b+be)*T),C?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=v,t.stableFitMaxMinimapScale=u):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}const H=Math.floor(g*F),$=Math.min(H,Math.max(0,Math.floor((v-_-2)*F/(c+F)))+ol);let V=Math.floor(o*$);const Y=V/o;V=Math.floor(V*W);const ie=h?1:2,ue=m==="left"?0:i-$-_;return{renderMinimap:ie,minimapLeft:ue,minimapWidth:$,minimapHeightIsEditorHeight:L,minimapIsSampling:D,minimapScale:u,minimapLineHeight:T,minimapCanvasInnerWidth:V,minimapCanvasInnerHeight:w,minimapCanvasOuterWidth:Y,minimapCanvasOuterHeight:x}}static computeLayout(e,t){const i=t.outerWidth|0,n=t.outerHeight|0,o=t.lineHeight|0,r=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,c=t.pixelRatio,d=t.viewLineCount,h=e.get(138),u=h==="inherit"?e.get(137):h,g=u==="inherit"?e.get(133):u,f=e.get(136),m=t.isDominatedByLongLines,_=e.get(57),b=e.get(68).renderType!==0,v=e.get(69),C=e.get(106),y=e.get(84),w=e.get(73),x=e.get(104),L=x.verticalScrollbarSize,D=x.verticalHasArrows,T=x.arrowSize,F=x.horizontalScrollbarSize,W=e.get(43),H=e.get(111)!=="never";let $=e.get(66);W&&H&&($+=16);let V=0;if(b){const ei=Math.max(r,v);V=Math.round(ei*l)}let Y=0;_&&(Y=o*t.glyphMarginDecorationLaneCount);let ie=0,ue=ie+Y,fe=ue+V,oe=fe+$;const be=i-Y-V-$;let xe=!1,wt=!1,pt=-1;u==="inherit"&&m?(xe=!0,wt=!0):g==="on"||g==="bounded"?wt=!0:g==="wordWrapColumn"&&(pt=f);const Et=$f._computeMinimapLayout({outerWidth:i,outerHeight:n,lineHeight:o,typicalHalfwidthCharacterWidth:a,pixelRatio:c,scrollBeyondLastLine:C,paddingTop:y.top,paddingBottom:y.bottom,minimap:w,verticalScrollbarWidth:L,viewLineCount:d,remainingWidth:be,isViewportWrapping:wt},t.memory||new a6);Et.renderMinimap!==0&&Et.minimapLeft===0&&(ie+=Et.minimapWidth,ue+=Et.minimapWidth,fe+=Et.minimapWidth,oe+=Et.minimapWidth);const Ei=be-Et.minimapWidth,Fi=Math.max(1,Math.floor((Ei-L-2)/a)),Fn=D?T:0;return wt&&(pt=Math.max(1,Fi),g==="bounded"&&(pt=Math.min(pt,f))),{width:i,height:n,glyphMarginLeft:ie,glyphMarginWidth:Y,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:ue,lineNumbersWidth:V,decorationsLeft:fe,decorationsWidth:$,contentLeft:oe,contentWidth:Ei,minimap:Et,viewportColumn:Fi,isWordWrapMinified:xe,isViewportWrapping:wt,wrappingColumn:pt,verticalScrollbarWidth:L,horizontalScrollbarHeight:F,overviewRuler:{top:Fn,width:L,height:n-2*Fn,right:0}}}}class $Q extends Jt{constructor(){super(140,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[p("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),p("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:p("wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return pi(e,"simple",["simple","advanced"])}compute(e,t,i){return t.get(2)===2?"advanced":i}}var Wr;(function(s){s.Off="off",s.OnCode="onCode",s.On="on"})(Wr||(Wr={}));class jQ extends Jt{constructor(){const e={enabled:Wr.OnCode};super(65,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:[Wr.Off,Wr.OnCode,Wr.On],default:e.enabled,enumDescriptions:[p("editor.lightbulb.enabled.off","Disable the code action menu."),p("editor.lightbulb.enabled.onCode","Show the code action menu when the cursor is on lines with code."),p("editor.lightbulb.enabled.on","Show the code action menu when the cursor is on lines with code or on empty lines.")],description:p("enabled","Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:pi(e.enabled,this.defaultValue.enabled,[Wr.Off,Wr.OnCode,Wr.On])}}}class ZQ extends Jt{constructor(){const e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(116,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:p("editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:p("editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:p("editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:p("editor.stickyScroll.scrollWithEditor","Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ve(t.enabled,this.defaultValue.enabled),maxLineCount:Pt.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:pi(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:ve(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}}class KQ extends Jt{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:!1};super(142,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:p("inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[p("editor.inlayHints.on","Inlay hints are enabled"),p("editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",Qe?"Ctrl+Option":"Ctrl+Alt"),p("editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",Qe?"Ctrl+Option":"Ctrl+Alt"),p("editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:p("inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:p("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:p("inlayHints.padding","Enables the padding around the inlay hints in the editor.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:pi(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Pt.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:ts.string(t.fontFamily,this.defaultValue.fontFamily),padding:ve(t.padding,this.defaultValue.padding)}}}class qQ extends Jt{constructor(){super(66,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):Pt.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,i){return i<0?Pt.clampedInt(-i*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}}class GQ extends Fo{constructor(){super(67,"lineHeight",vs.lineHeight,e=>Fo.clamp(e,0,150),{markdownDescription:p("lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,i){return e.fontInfo.lineHeight}}class YQ extends Jt{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(73,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:p("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:p("minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[p("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),p("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),p("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:p("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:p("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:p("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:p("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:p("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:p("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:p("minimap.showRegionSectionHeaders","Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:p("minimap.showMarkSectionHeaders","Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:p("minimap.sectionHeaderFontSize","Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:p("minimap.sectionHeaderLetterSpacing","Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ve(t.enabled,this.defaultValue.enabled),autohide:ve(t.autohide,this.defaultValue.autohide),size:pi(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:pi(t.side,this.defaultValue.side,["right","left"]),showSlider:pi(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:ve(t.renderCharacters,this.defaultValue.renderCharacters),scale:Pt.clampedInt(t.scale,1,1,3),maxColumn:Pt.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:ve(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:ve(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),sectionHeaderFontSize:Fo.clamp(t.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:Fo.clamp(t.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}}function XQ(s){return s==="ctrlCmd"?Qe?"metaKey":"ctrlKey":"altKey"}class QQ extends Jt{constructor(){super(84,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:p("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:p("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{top:Pt.clampedInt(t.top,0,0,1e3),bottom:Pt.clampedInt(t.bottom,0,0,1e3)}}}class JQ extends Jt{constructor(){const e={enabled:!0,cycle:!0};super(86,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:p("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:p("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ve(t.enabled,this.defaultValue.enabled),cycle:ve(t.cycle,this.defaultValue.cycle)}}}class eJ extends pC{constructor(){super(144)}compute(e,t,i){return e.pixelRatio}}class tJ extends Jt{constructor(){super(88,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}}class iJ extends Jt{constructor(){const e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[p("on","Quick suggestions show inside the suggest widget"),p("inline","Quick suggestions show as ghost text"),p("off","Quick suggestions are disabled")]}];super(90,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:p("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:p("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:p("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:p("quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){const c=e?"on":"off";return{comments:c,strings:c,other:c}}if(!e||typeof e!="object")return this.defaultValue;const{other:t,comments:i,strings:n}=e,o=["on","inline","off"];let r,a,l;return typeof t=="boolean"?r=t?"on":"off":r=pi(t,this.defaultValue.other,o),typeof i=="boolean"?a=i?"on":"off":a=pi(i,this.defaultValue.comments,o),typeof n=="boolean"?l=n?"on":"off":l=pi(n,this.defaultValue.strings,o),{other:r,comments:a,strings:l}}}class nJ extends Jt{constructor(){super(68,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[p("lineNumbers.off","Line numbers are not rendered."),p("lineNumbers.on","Line numbers are rendered as absolute number."),p("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),p("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:p("lineNumbers","Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,i=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:i}}}function D1(s){const e=s.get(99);return e==="editable"?s.get(92):e!=="on"}class sJ extends Jt{constructor(){const e=[],t={type:"number",description:p("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(103,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:p("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:p("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="number")t.push({column:Pt.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){const n=i;t.push({column:Pt.clampedInt(n.column,0,0,1e4),color:n.color})}return t.sort((i,n)=>i.column-n.column),t}return this.defaultValue}}class oJ extends Jt{constructor(){super(93,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}}function k5(s,e){if(typeof s!="string")return e;switch(s){case"hidden":return 2;case"visible":return 3;default:return 1}}let rJ=class extends Jt{constructor(){const e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(104,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[p("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),p("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),p("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:p("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[p("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),p("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),p("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:p("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:p("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:p("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:p("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:p("scrollbar.ignoreHorizontalScrollbarInContentHeight","When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e,i=Pt.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),n=Pt.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Pt.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:k5(t.vertical,this.defaultValue.vertical),horizontal:k5(t.horizontal,this.defaultValue.horizontal),useShadows:ve(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:ve(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:ve(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:ve(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:ve(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:Pt.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:n,verticalSliderSize:Pt.clampedInt(t.verticalSliderSize,n,0,1e3),scrollByPage:ve(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:ve(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}};const ko="inUntrustedWorkspace",Os={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};class aJ extends Jt{constructor(){const e={nonBasicASCII:ko,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:ko,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(126,"unicodeHighlight",e,{[Os.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,ko],default:e.nonBasicASCII,description:p("unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[Os.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:p("unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[Os.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:p("unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[Os.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,ko],default:e.includeComments,description:p("unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[Os.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,ko],default:e.includeStrings,description:p("unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[Os.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:p("unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[Os.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:p("unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let i=!1;t.allowedCharacters&&e&&(co(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},i=!0)),t.allowedLocales&&e&&(co(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},i=!0));const n=super.applyUpdate(e,t);return i?new Z_(n.newValue,!0):n}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{nonBasicASCII:jf(t.nonBasicASCII,ko,[!0,!1,ko]),invisibleCharacters:ve(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:ve(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:jf(t.includeComments,ko,[!0,!1,ko]),includeStrings:jf(t.includeStrings,ko,[!0,!1,ko]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;const i={};for(const[n,o]of Object.entries(e))o===!0&&(i[n]=!0);return i}}class lJ extends Jt{constructor(){const e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default"};super(62,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:p("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[p("inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),p("inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion."),p("inlineSuggest.showToolbar.never","Never show the inline suggestion toolbar.")],description:p("inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:p("inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:p("inlineSuggest.fontFamily","Controls the font family of the inline suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ve(t.enabled,this.defaultValue.enabled),mode:pi(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:pi(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:ve(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:ve(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:ts.string(t.fontFamily,this.defaultValue.fontFamily)}}}class cJ extends Jt{constructor(){const e={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1};super(63,"experimentalInlineEdit",e,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:e.enabled,description:p("inlineEdit.enabled","Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[p("inlineEdit.showToolbar.always","Show the inline edit toolbar whenever an inline suggestion is shown."),p("inlineEdit.showToolbar.onHover","Show the inline edit toolbar when hovering over an inline suggestion."),p("inlineEdit.showToolbar.never","Never show the inline edit toolbar.")],description:p("inlineEdit.showToolbar","Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:e.fontFamily,description:p("inlineEdit.fontFamily","Controls the font family of the inline edit.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ve(t.enabled,this.defaultValue.enabled),showToolbar:pi(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:ts.string(t.fontFamily,this.defaultValue.fontFamily),keepOnBlur:ve(t.keepOnBlur,this.defaultValue.keepOnBlur)}}}class dJ extends Jt{constructor(){const e={enabled:Vn.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:Vn.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:p("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:p("bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ve(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:ve(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}}class hJ extends Jt{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[p("editor.guides.bracketPairs.true","Enables bracket pair guides."),p("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),p("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:e.bracketPairs,description:p("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[p("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),p("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),p("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:p("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:p("editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:p("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[p("editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),p("editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),p("editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:p("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{bracketPairs:jf(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:jf(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:ve(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:ve(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:jf(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}}function jf(s,e,t){const i=t.indexOf(s);return i===-1?e:t[i]}class uJ extends Jt{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(119,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[p("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),p("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:p("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:p("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:p("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:p("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[p("suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),p("suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),p("suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),p("suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:p("suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:p("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:p("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:p("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:p("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:p("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:p("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:p("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertMode:pi(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:ve(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:ve(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:ve(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:ve(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:pi(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:ve(t.showIcons,this.defaultValue.showIcons),showStatusBar:ve(t.showStatusBar,this.defaultValue.showStatusBar),preview:ve(t.preview,this.defaultValue.preview),previewMode:pi(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:ve(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:ve(t.showMethods,this.defaultValue.showMethods),showFunctions:ve(t.showFunctions,this.defaultValue.showFunctions),showConstructors:ve(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:ve(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:ve(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:ve(t.showFields,this.defaultValue.showFields),showVariables:ve(t.showVariables,this.defaultValue.showVariables),showClasses:ve(t.showClasses,this.defaultValue.showClasses),showStructs:ve(t.showStructs,this.defaultValue.showStructs),showInterfaces:ve(t.showInterfaces,this.defaultValue.showInterfaces),showModules:ve(t.showModules,this.defaultValue.showModules),showProperties:ve(t.showProperties,this.defaultValue.showProperties),showEvents:ve(t.showEvents,this.defaultValue.showEvents),showOperators:ve(t.showOperators,this.defaultValue.showOperators),showUnits:ve(t.showUnits,this.defaultValue.showUnits),showValues:ve(t.showValues,this.defaultValue.showValues),showConstants:ve(t.showConstants,this.defaultValue.showConstants),showEnums:ve(t.showEnums,this.defaultValue.showEnums),showEnumMembers:ve(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:ve(t.showKeywords,this.defaultValue.showKeywords),showWords:ve(t.showWords,this.defaultValue.showWords),showColors:ve(t.showColors,this.defaultValue.showColors),showFiles:ve(t.showFiles,this.defaultValue.showFiles),showReferences:ve(t.showReferences,this.defaultValue.showReferences),showFolders:ve(t.showFolders,this.defaultValue.showFolders),showTypeParameters:ve(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:ve(t.showSnippets,this.defaultValue.showSnippets),showUsers:ve(t.showUsers,this.defaultValue.showUsers),showIssues:ve(t.showIssues,this.defaultValue.showIssues)}}}class gJ extends Jt{constructor(){super(114,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:p("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:p("selectSubwords","Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:ve(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:ve(e.selectSubwords,this.defaultValue.selectSubwords)}}}class fJ extends Jt{constructor(){const e=[];super(131,"wordSegmenterLocales",e,{anyOf:[{description:p("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:p("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="string")try{Intl.Segmenter.supportedLocalesOf(i).length>0&&t.push(i)}catch{}return t}return this.defaultValue}}class pJ extends Jt{constructor(){super(139,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[p("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),p("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),p("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),p("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:p("wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,i){return t.get(2)===2?0:i}}class mJ extends pC{constructor(){super(147)}compute(e,t,i){const n=t.get(146);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:n.isWordWrapMinified,isViewportWrapping:n.isViewportWrapping,wrappingColumn:n.wrappingColumn}}}class _J extends Jt{constructor(){const e={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:p("dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:p("dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[p("dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),p("dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ve(t.enabled,this.defaultValue.enabled),showDropSelector:pi(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}}class bJ extends Jt{constructor(){const e={enabled:!0,showPasteSelector:"afterPaste"};super(85,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:p("pasteAs.enabled","Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:p("pasteAs.showPasteSelector","Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[p("pasteAs.showPasteSelector.afterPaste","Show the paste selector widget after content is pasted into the editor."),p("pasteAs.showPasteSelector.never","Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ve(t.enabled,this.defaultValue.enabled),showPasteSelector:pi(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}}const vJ="Consolas, 'Courier New', monospace",CJ="Menlo, Monaco, 'Courier New', monospace",yJ="'Droid Sans Mono', 'monospace', monospace",vs={fontFamily:Qe?CJ:ys?yJ:vJ,fontWeight:"normal",fontSize:Qe?12:14,lineHeight:0,letterSpacing:0},vf=[];function ne(s){return vf[s.id]=s,s}const ja={acceptSuggestionOnCommitCharacter:ne(new ht(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:p("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:ne(new fi(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",p("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:p("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:ne(new MQ),accessibilityPageSize:ne(new Pt(3,"accessibilityPageSize",10,1,1073741824,{description:p("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:ne(new ts(4,"ariaLabel",p("editorViewAccessibleLabel","Editor content"))),ariaRequired:ne(new ht(5,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:ne(new ht(8,"screenReaderAnnounceInlineSuggestion",!0,{description:p("screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:ne(new fi(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",p("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),p("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:p("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:ne(new fi(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",p("editor.autoClosingComments.languageDefined","Use language configurations to determine when to autoclose comments."),p("editor.autoClosingComments.beforeWhitespace","Autoclose comments only when the cursor is to the left of whitespace."),""],description:p("autoClosingComments","Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:ne(new fi(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",p("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:p("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:ne(new fi(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",p("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:p("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:ne(new fi(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",p("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),p("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:p("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:ne(new py(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],RQ,{enumDescriptions:[p("editor.autoIndent.none","The editor will not insert indentation automatically."),p("editor.autoIndent.keep","The editor will keep the current line's indentation."),p("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),p("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),p("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:p("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:ne(new ht(13,"automaticLayout",!1)),autoSurround:ne(new fi(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[p("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),p("editor.autoSurround.quotes","Surround with quotes but not brackets."),p("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:p("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:ne(new dJ),bracketPairGuides:ne(new hJ),stickyTabStops:ne(new ht(117,"stickyTabStops",!1,{description:p("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:ne(new ht(17,"codeLens",!0,{description:p("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:ne(new ts(18,"codeLensFontFamily","",{description:p("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:ne(new Pt(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:p("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:ne(new ht(20,"colorDecorators",!0,{description:p("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:ne(new fi(149,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[p("editor.colorDecoratorActivatedOn.clickAndHover","Make the color picker appear both on click and hover of the color decorator"),p("editor.colorDecoratorActivatedOn.hover","Make the color picker appear on hover of the color decorator"),p("editor.colorDecoratorActivatedOn.click","Make the color picker appear on click of the color decorator")],description:p("colorDecoratorActivatedOn","Controls the condition to make a color picker appear from a color decorator")})),colorDecoratorsLimit:ne(new Pt(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:p("colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:ne(new ht(22,"columnSelection",!1,{description:p("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:ne(new AQ),contextmenu:ne(new ht(24,"contextmenu",!0)),copyWithSyntaxHighlighting:ne(new ht(25,"copyWithSyntaxHighlighting",!0,{description:p("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:ne(new py(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],PQ,{description:p("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:ne(new fi(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[p("cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),p("cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),p("cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:p("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:ne(new py(28,"cursorStyle",bn.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],OQ,{description:p("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:ne(new Pt(29,"cursorSurroundingLines",0,0,1073741824,{description:p("cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:ne(new fi(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[p("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),p("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],markdownDescription:p("cursorSurroundingLinesStyle","Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:ne(new Pt(31,"cursorWidth",0,0,1073741824,{markdownDescription:p("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:ne(new ht(32,"disableLayerHinting",!1)),disableMonospaceOptimizations:ne(new ht(33,"disableMonospaceOptimizations",!1)),domReadOnly:ne(new ht(34,"domReadOnly",!1)),dragAndDrop:ne(new ht(35,"dragAndDrop",!0,{description:p("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:ne(new BQ),dropIntoEditor:ne(new _J),stickyScroll:ne(new ZQ),experimentalWhitespaceRendering:ne(new fi(38,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[p("experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),p("experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),p("experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:p("experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:ne(new ts(39,"extraEditorClassName","")),fastScrollSensitivity:ne(new Fo(40,"fastScrollSensitivity",5,s=>s<=0?5:s,{markdownDescription:p("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:ne(new WQ),fixedOverflowWidgets:ne(new ht(42,"fixedOverflowWidgets",!1)),folding:ne(new ht(43,"folding",!0,{description:p("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:ne(new fi(44,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[p("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),p("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:p("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:ne(new ht(45,"foldingHighlight",!0,{description:p("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:ne(new ht(46,"foldingImportsByDefault",!1,{description:p("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:ne(new Pt(47,"foldingMaximumRegions",5e3,10,65e3,{description:p("foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:ne(new ht(48,"unfoldOnClickAfterEndOfLine",!1,{description:p("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:ne(new ts(49,"fontFamily",vs.fontFamily,{description:p("fontFamily","Controls the font family.")})),fontInfo:ne(new HQ),fontLigatures2:ne(new Ur),fontSize:ne(new VQ),fontWeight:ne(new tu),fontVariations:ne(new gc),formatOnPaste:ne(new ht(55,"formatOnPaste",!1,{description:p("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:ne(new ht(56,"formatOnType",!1,{description:p("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:ne(new ht(57,"glyphMargin",!0,{description:p("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:ne(new zQ),hideCursorInOverviewRuler:ne(new ht(59,"hideCursorInOverviewRuler",!1,{description:p("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:ne(new UQ),inDiffEditor:ne(new ht(61,"inDiffEditor",!1)),letterSpacing:ne(new Fo(64,"letterSpacing",vs.letterSpacing,s=>Fo.clamp(s,-5,20),{description:p("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:ne(new jQ),lineDecorationsWidth:ne(new qQ),lineHeight:ne(new GQ),lineNumbers:ne(new nJ),lineNumbersMinChars:ne(new Pt(69,"lineNumbersMinChars",5,1,300)),linkedEditing:ne(new ht(70,"linkedEditing",!1,{description:p("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:ne(new ht(71,"links",!0,{description:p("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:ne(new fi(72,"matchBrackets","always",["always","near","never"],{description:p("matchBrackets","Highlight matching brackets.")})),minimap:ne(new YQ),mouseStyle:ne(new fi(74,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:ne(new Fo(75,"mouseWheelScrollSensitivity",1,s=>s===0?1:s,{markdownDescription:p("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:ne(new ht(76,"mouseWheelZoom",!1,{markdownDescription:Qe?p("mouseWheelZoom.mac","Zoom the font of the editor when using mouse wheel and holding `Cmd`."):p("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:ne(new ht(77,"multiCursorMergeOverlapping",!0,{description:p("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:ne(new py(78,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],XQ,{markdownEnumDescriptions:[p("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),p("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:p({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:ne(new fi(79,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[p("multiCursorPaste.spread","Each cursor pastes a single line of the text."),p("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:p("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:ne(new Pt(80,"multiCursorLimit",1e4,1,1e5,{markdownDescription:p("multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:ne(new fi(81,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[p("occurrencesHighlight.off","Does not highlight occurrences."),p("occurrencesHighlight.singleFile","Highlights occurrences only in the current file."),p("occurrencesHighlight.multiFile","Experimental: Highlights occurrences across all valid open files.")],markdownDescription:p("occurrencesHighlight","Controls whether occurrences should be highlighted across open files.")})),overviewRulerBorder:ne(new ht(82,"overviewRulerBorder",!0,{description:p("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:ne(new Pt(83,"overviewRulerLanes",3,0,3)),padding:ne(new QQ),pasteAs:ne(new bJ),parameterHints:ne(new JQ),peekWidgetDefaultFocus:ne(new fi(87,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[p("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),p("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:p("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:ne(new tJ),definitionLinkOpensInPeek:ne(new ht(89,"definitionLinkOpensInPeek",!1,{description:p("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:ne(new iJ),quickSuggestionsDelay:ne(new Pt(91,"quickSuggestionsDelay",10,0,1073741824,{description:p("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:ne(new ht(92,"readOnly",!1)),readOnlyMessage:ne(new oJ),renameOnType:ne(new ht(94,"renameOnType",!1,{description:p("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:p("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:ne(new ht(95,"renderControlCharacters",!0,{description:p("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:ne(new fi(96,"renderFinalNewline",ys?"dimmed":"on",["off","on","dimmed"],{description:p("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:ne(new fi(97,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",p("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:p("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:ne(new ht(98,"renderLineHighlightOnlyWhenFocus",!1,{description:p("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:ne(new fi(99,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:ne(new fi(100,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",p("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),p("renderWhitespace.selection","Render whitespace characters only on selected text."),p("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:p("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:ne(new Pt(101,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:ne(new ht(102,"roundedSelection",!0,{description:p("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:ne(new sJ),scrollbar:ne(new rJ),scrollBeyondLastColumn:ne(new Pt(105,"scrollBeyondLastColumn",4,0,1073741824,{description:p("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:ne(new ht(106,"scrollBeyondLastLine",!0,{description:p("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:ne(new ht(107,"scrollPredominantAxis",!0,{description:p("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:ne(new ht(108,"selectionClipboard",!0,{description:p("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:ys})),selectionHighlight:ne(new ht(109,"selectionHighlight",!0,{description:p("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:ne(new ht(110,"selectOnLineNumbers",!0)),showFoldingControls:ne(new fi(111,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[p("showFoldingControls.always","Always show the folding controls."),p("showFoldingControls.never","Never show the folding controls and reduce the gutter size."),p("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:p("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:ne(new ht(112,"showUnused",!0,{description:p("showUnused","Controls fading out of unused code.")})),showDeprecated:ne(new ht(141,"showDeprecated",!0,{description:p("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:ne(new KQ),snippetSuggestions:ne(new fi(113,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[p("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),p("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),p("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),p("snippetSuggestions.none","Do not show snippet suggestions.")],description:p("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:ne(new gJ),smoothScrolling:ne(new ht(115,"smoothScrolling",!1,{description:p("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:ne(new Pt(118,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:ne(new uJ),inlineSuggest:ne(new lJ),inlineEdit:ne(new cJ),inlineCompletionsAccessibilityVerbose:ne(new ht(150,"inlineCompletionsAccessibilityVerbose",!1,{description:p("inlineCompletionsAccessibilityVerbose","Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:ne(new Pt(120,"suggestFontSize",0,0,1e3,{markdownDescription:p("suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:ne(new Pt(121,"suggestLineHeight",0,0,1e3,{markdownDescription:p("suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:ne(new ht(122,"suggestOnTriggerCharacters",!0,{description:p("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:ne(new fi(123,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[p("suggestSelection.first","Always select the first suggestion."),p("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),p("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:p("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:ne(new fi(124,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[p("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),p("tabCompletion.off","Disable tab completions."),p("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:p("tabCompletion","Enables tab completions.")})),tabIndex:ne(new Pt(125,"tabIndex",0,-1,1073741824)),unicodeHighlight:ne(new aJ),unusualLineTerminators:ne(new fi(127,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[p("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),p("unusualLineTerminators.off","Unusual line terminators are ignored."),p("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:p("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:ne(new ht(128,"useShadowDOM",!0)),useTabStops:ne(new ht(129,"useTabStops",!0,{description:p("useTabStops","Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:ne(new fi(130,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[p("wordBreak.normal","Use the default line break rule."),p("wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:p("wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:ne(new fJ),wordSeparators:ne(new ts(132,"wordSeparators",k1,{description:p("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:ne(new fi(133,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[p("wordWrap.off","Lines will never wrap."),p("wordWrap.on","Lines will wrap at the viewport width."),p({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),p({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:p({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:ne(new ts(134,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;")),wordWrapBreakBeforeCharacters:ne(new ts(135,"wordWrapBreakBeforeCharacters","([{+")),wordWrapColumn:ne(new Pt(136,"wordWrapColumn",80,1,1073741824,{markdownDescription:p({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:ne(new fi(137,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:ne(new fi(138,"wordWrapOverride2","inherit",["off","on","inherit"])),editorClassName:ne(new FQ),defaultColorDecorators:ne(new ht(148,"defaultColorDecorators",!1,{markdownDescription:p("defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),pixelRatio:ne(new eJ),tabFocusMode:ne(new ht(145,"tabFocusMode",!1,{markdownDescription:p("tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:ne(new $f),wrappingInfo:ne(new mJ),wrappingIndent:ne(new pJ),wrappingStrategy:ne(new $Q)};class wJ{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?yp.isErrorNoTelemetry(e)?new yp(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}emit(e){this.listeners.forEach(t=>{t(e)})}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}}const l6=new wJ;function Oe(s){xr(s)||l6.onUnexpectedError(s)}function Li(s){xr(s)||l6.onUnexpectedExternalError(s)}function D5(s){if(s instanceof Error){const{name:e,message:t}=s,i=s.stacktrace||s.stack;return{$isError:!0,name:e,message:t,stack:i,noTelemetry:yp.isErrorNoTelemetry(s)}}return s}const I1="Canceled";function xr(s){return s instanceof Xr?!0:s instanceof Error&&s.name===I1&&s.message===I1}class Xr extends Error{constructor(){super(I1),this.name=this.message}}function SJ(){const s=new Error(I1);return s.name=s.message,s}function mr(s){return s?new Error(`Illegal argument: ${s}`):new Error("Illegal argument")}function NP(s){return s?new Error(`Illegal state: ${s}`):new Error("Illegal state")}class LJ extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}}class yp extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof yp)return e;const t=new yp;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}}class mt extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,mt.prototype)}}function eh(s,e){const t=this;let i=!1,n;return function(){return i||(i=!0,n=s.apply(t,arguments)),n}}function mL(s){return typeof s=="object"&&s!==null&&typeof s.dispose=="function"&&s.dispose.length===0}function At(s){if(st.is(s)){const e=[];for(const t of s)if(t)try{t.dispose()}catch(i){e.push(i)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(s)?[]:s}else if(s)return s.dispose(),s}function Gr(...s){return Ce(()=>At(s))}function Ce(s){return{dispose:eh(()=>{s()})}}class Z{static{this.DISABLE_DISPOSED_WARNING=!1}constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{At(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?Z.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}deleteAndLeak(e){e&&this._toDispose.has(e)&&this._toDispose.delete(e)}}class B{static{this.None=Object.freeze({dispose(){}})}constructor(){this._store=new Z,this._store}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}}class nn{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}}class xJ{constructor(e){this._disposable=e,this._counter=1}acquire(){return this._counter++,this}release(){return--this._counter===0&&this._disposable.dispose(),this}}class kJ{constructor(e){this.object=e}dispose(){}}class RP{constructor(){this._store=new Map,this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{At(this._store.values())}finally{this._store.clear()}}get(e){return this._store.get(e)}set(e,t,i=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||this._store.get(e)?.dispose(),this._store.set(e,t)}deleteAndDispose(e){this._store.get(e)?.dispose(),this._store.delete(e)}[Symbol.iterator](){return this._store[Symbol.iterator]()}}const DJ=globalThis.performance&&typeof globalThis.performance.now=="function";class un{static create(e){return new un(e)}constructor(e){this._now=DJ&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}}var se;(function(s){s.None=()=>B.None;function e($,V){return u($,()=>{},0,void 0,!0,void 0,V)}s.defer=e;function t($){return(V,Y=null,ie)=>{let ue=!1,fe;return fe=$(oe=>{if(!ue)return fe?fe.dispose():ue=!0,V.call(Y,oe)},null,ie),ue&&fe.dispose(),fe}}s.once=t;function i($,V){return s.once(s.filter($,V))}s.onceIf=i;function n($,V,Y){return d((ie,ue=null,fe)=>$(oe=>ie.call(ue,V(oe)),null,fe),Y)}s.map=n;function o($,V,Y){return d((ie,ue=null,fe)=>$(oe=>{V(oe),ie.call(ue,oe)},null,fe),Y)}s.forEach=o;function r($,V,Y){return d((ie,ue=null,fe)=>$(oe=>V(oe)&&ie.call(ue,oe),null,fe),Y)}s.filter=r;function a($){return $}s.signal=a;function l(...$){return(V,Y=null,ie)=>{const ue=Gr(...$.map(fe=>fe(oe=>V.call(Y,oe))));return h(ue,ie)}}s.any=l;function c($,V,Y,ie){let ue=Y;return n($,fe=>(ue=V(ue,fe),ue),ie)}s.reduce=c;function d($,V){let Y;const ie={onWillAddFirstListener(){Y=$(ue.fire,ue)},onDidRemoveLastListener(){Y?.dispose()}},ue=new O(ie);return V?.add(ue),ue.event}function h($,V){return V instanceof Array?V.push($):V&&V.add($),$}function u($,V,Y=100,ie=!1,ue=!1,fe,oe){let be,xe,wt,pt=0,Et;const Ei={leakWarningThreshold:fe,onWillAddFirstListener(){be=$(Fn=>{pt++,xe=V(xe,Fn),ie&&!wt&&(Fi.fire(xe),xe=void 0),Et=()=>{const ei=xe;xe=void 0,wt=void 0,(!ie||pt>1)&&Fi.fire(ei),pt=0},typeof Y=="number"?(clearTimeout(wt),wt=setTimeout(Et,Y)):wt===void 0&&(wt=0,queueMicrotask(Et))})},onWillRemoveListener(){ue&&pt>0&&Et?.()},onDidRemoveLastListener(){Et=void 0,be.dispose()}},Fi=new O(Ei);return oe?.add(Fi),Fi.event}s.debounce=u;function g($,V=0,Y){return s.debounce($,(ie,ue)=>ie?(ie.push(ue),ie):[ue],V,void 0,!0,void 0,Y)}s.accumulate=g;function f($,V=(ie,ue)=>ie===ue,Y){let ie=!0,ue;return r($,fe=>{const oe=ie||!V(fe,ue);return ie=!1,ue=fe,oe},Y)}s.latch=f;function m($,V,Y){return[s.filter($,V,Y),s.filter($,ie=>!V(ie),Y)]}s.split=m;function _($,V=!1,Y=[],ie){let ue=Y.slice(),fe=$(xe=>{ue?ue.push(xe):be.fire(xe)});ie&&ie.add(fe);const oe=()=>{ue?.forEach(xe=>be.fire(xe)),ue=null},be=new O({onWillAddFirstListener(){fe||(fe=$(xe=>be.fire(xe)),ie&&ie.add(fe))},onDidAddFirstListener(){ue&&(V?setTimeout(oe):oe())},onDidRemoveLastListener(){fe&&fe.dispose(),fe=null}});return ie&&ie.add(be),be.event}s.buffer=_;function b($,V){return(ie,ue,fe)=>{const oe=V(new C);return $(function(be){const xe=oe.evaluate(be);xe!==v&&ie.call(ue,xe)},void 0,fe)}}s.chain=b;const v=Symbol("HaltChainable");class C{constructor(){this.steps=[]}map(V){return this.steps.push(V),this}forEach(V){return this.steps.push(Y=>(V(Y),Y)),this}filter(V){return this.steps.push(Y=>V(Y)?Y:v),this}reduce(V,Y){let ie=Y;return this.steps.push(ue=>(ie=V(ie,ue),ie)),this}latch(V=(Y,ie)=>Y===ie){let Y=!0,ie;return this.steps.push(ue=>{const fe=Y||!V(ue,ie);return Y=!1,ie=ue,fe?ue:v}),this}evaluate(V){for(const Y of this.steps)if(V=Y(V),V===v)break;return V}}function y($,V,Y=ie=>ie){const ie=(...be)=>oe.fire(Y(...be)),ue=()=>$.on(V,ie),fe=()=>$.removeListener(V,ie),oe=new O({onWillAddFirstListener:ue,onDidRemoveLastListener:fe});return oe.event}s.fromNodeEventEmitter=y;function w($,V,Y=ie=>ie){const ie=(...be)=>oe.fire(Y(...be)),ue=()=>$.addEventListener(V,ie),fe=()=>$.removeEventListener(V,ie),oe=new O({onWillAddFirstListener:ue,onDidRemoveLastListener:fe});return oe.event}s.fromDOMEventEmitter=w;function x($){return new Promise(V=>t($)(V))}s.toPromise=x;function L($){const V=new O;return $.then(Y=>{V.fire(Y)},()=>{V.fire(void 0)}).finally(()=>{V.dispose()}),V.event}s.fromPromise=L;function D($,V){return $(Y=>V.fire(Y))}s.forward=D;function T($,V,Y){return V(Y),$(ie=>V(ie))}s.runAndSubscribe=T;class F{constructor(V,Y){this._observable=V,this._counter=0,this._hasChanged=!1;const ie={onWillAddFirstListener:()=>{V.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{V.removeObserver(this)}};this.emitter=new O(ie),Y&&Y.add(this.emitter)}beginUpdate(V){this._counter++}handlePossibleChange(V){}handleChange(V,Y){this._hasChanged=!0}endUpdate(V){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function W($,V){return new F($,V).emitter.event}s.fromObservable=W;function H($){return(V,Y,ie)=>{let ue=0,fe=!1;const oe={beginUpdate(){ue++},endUpdate(){ue--,ue===0&&($.reportChanges(),fe&&(fe=!1,V.call(Y)))},handlePossibleChange(){},handleChange(){fe=!0}};$.addObserver(oe),$.reportChanges();const be={dispose(){$.removeObserver(oe)}};return ie instanceof Z?ie.add(be):Array.isArray(ie)&&ie.push(be),be}}s.fromObservableLight=H})(se||(se={}));class T1{static{this.all=new Set}static{this._idPool=0}constructor(e){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${e}_${T1._idPool++}`,T1.all.add(this)}start(e){this._stopWatch=new un,this.listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}}let IJ=-1;class MP{static{this._idPool=1}constructor(e,t,i=(MP._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e,this.threshold=t,this.name=i,this._warnCountdown=0}dispose(){this._stacks?.clear()}check(e,t){const i=this.threshold;if(i<=0||t<i)return;this._stacks||(this._stacks=new Map);const n=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,n+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=i*.5;const[o,r]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${r}):`;console.warn(a),console.warn(o);const l=new TJ(a,o);this._errorHandler(l)}return()=>{const o=this._stacks.get(e.value)||0;this._stacks.set(e.value,o-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(const[i,n]of this._stacks)(!e||t<n)&&(e=[i,n],t=n);return e}}class AP{static create(){const e=new Error;return new AP(e.stack??"")}constructor(e){this.value=e}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}}class TJ extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}}class EJ extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}}class Mk{constructor(e){this.value=e}}const NJ=2;let O=class{constructor(e){this._size=0,this._options=e,this._leakageMon=this._options?.leakWarningThreshold?new MP(e?.onListenerError??Oe,this._options?.leakWarningThreshold??IJ):void 0,this._perfMon=this._options?._profName?new T1(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){this._disposed||(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose())}get event(){return this._event??=(e,t,i)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){const a=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(a);const l=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],c=new EJ(`${a}. HINT: Stack shows most frequent listener (${l[1]}-times)`,l[0]);return(this._options?.onListenerError||Oe)(c),B.None}if(this._disposed)return B.None;t&&(e=e.bind(t));const n=new Mk(e);let o;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(n.stack=AP.create(),o=this._leakageMon.check(n.stack,this._size+1)),this._listeners?this._listeners instanceof Mk?(this._deliveryQueue??=new c6,this._listeners=[this._listeners,n]):this._listeners.push(n):(this._options?.onWillAddFirstListener?.(this),this._listeners=n,this._options?.onDidAddFirstListener?.(this)),this._size++;const r=Ce(()=>{o?.(),this._removeListener(n)});return i instanceof Z?i.add(r):Array.isArray(i)&&i.push(r),r},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}const t=this._listeners,i=t.indexOf(e);if(i===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[i]=void 0;const n=this._deliveryQueue.current===this;if(this._size*NJ<=t.length){let o=0;for(let r=0;r<t.length;r++)t[r]?t[o++]=t[r]:n&&(this._deliveryQueue.end--,o<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=o}}_deliver(e,t){if(!e)return;const i=this._options?.onListenerError||Oe;if(!i){e.value(t);return}try{e.value(t)}catch(n){i(n)}}_deliverQueue(e){const t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof Mk)this._deliver(this._listeners,e);else{const t=this._deliveryQueue;t.enqueue(this,e,this._listeners.length),this._deliverQueue(t)}this._perfMon?.stop()}hasListeners(){return this._size>0}};const RJ=()=>new c6;class c6{constructor(){this.i=-1,this.end=0}enqueue(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}}class Vu extends O{constructor(e){super(e),this._isPaused=0,this._eventQueue=new fs,this._mergeFn=e?.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){const e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}}class d6 extends Vu{constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}}class MJ extends O{constructor(e){super(e),this._queuedEvents=[],this._mergeFn=e?.merge}fire(e){this.hasListeners()&&(this._queuedEvents.push(e),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(t=>super.fire(t)),this._queuedEvents=[]}))}}class AJ{constructor(){this.hasListeners=!1,this.events=[],this.emitter=new O({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(e){const t={event:e,listener:null};return this.events.push(t),this.hasListeners&&this.hook(t),Ce(eh(()=>{this.hasListeners&&this.unhook(t);const n=this.events.indexOf(t);this.events.splice(n,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(e=>this.hook(e))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(e=>this.unhook(e))}hook(e){e.listener=e.event(t=>this.emitter.fire(t))}unhook(e){e.listener?.dispose(),e.listener=null}dispose(){this.emitter.dispose();for(const e of this.events)e.listener?.dispose();this.events=[]}}class mC{constructor(){this.data=[]}wrapEvent(e,t,i){return(n,o,r)=>e(a=>{const l=this.data[this.data.length-1];if(!t){l?l.buffers.push(()=>n.call(o,a)):n.call(o,a);return}const c=l;if(!c){n.call(o,t(i,a));return}c.items??=[],c.items.push(a),c.buffers.length===0&&l.buffers.push(()=>{c.reducedResult??=i?c.items.reduce(t,i):c.items.reduce(t),n.call(o,c.reducedResult)})},void 0,r)}bufferEvents(e){const t={buffers:new Array};this.data.push(t);const i=e();return this.data.pop(),t.buffers.forEach(n=>n()),i}}class I5{constructor(){this.listening=!1,this.inputEvent=se.None,this.inputEventListener=B.None,this.emitter=new O({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}}),this.event=this.emitter.event}set input(e){this.inputEvent=e,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=e(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}}const h6=Object.freeze(function(s,e){const t=setTimeout(s.bind(e),0);return{dispose(){clearTimeout(t)}}});var Ue;(function(s){function e(t){return t===s.None||t===s.Cancelled||t instanceof Ew?!0:!t||typeof t!="object"?!1:typeof t.isCancellationRequested=="boolean"&&typeof t.onCancellationRequested=="function"}s.isCancellationToken=e,s.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:se.None}),s.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:h6})})(Ue||(Ue={}));class Ew{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?h6:(this._emitter||(this._emitter=new O),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}let li=class{constructor(e){this._token=void 0,this._parentListener=void 0,this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new Ew),this._token}cancel(){this._token?this._token instanceof Ew&&this._token.cancel():this._token=Ue.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof Ew&&this._token.dispose():this._token=Ue.None}};function XI(s){const e=new li;return s.add({dispose(){e.cancel()}}),e.token}class PP{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}}const Nw=new PP,QI=new PP,JI=new PP,u6=new Array(230),PJ=Object.create(null),OJ=Object.create(null),OP=[];for(let s=0;s<=193;s++)OP[s]=-1;(function(){const s="",e=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",s,s],[1,1,"Hyper",0,s,0,s,s,s],[1,2,"Super",0,s,0,s,s,s],[1,3,"Fn",0,s,0,s,s,s],[1,4,"FnLock",0,s,0,s,s,s],[1,5,"Suspend",0,s,0,s,s,s],[1,6,"Resume",0,s,0,s,s,s],[1,7,"Turbo",0,s,0,s,s,s],[1,8,"Sleep",0,s,0,"VK_SLEEP",s,s],[1,9,"WakeUp",0,s,0,s,s,s],[0,10,"KeyA",31,"A",65,"VK_A",s,s],[0,11,"KeyB",32,"B",66,"VK_B",s,s],[0,12,"KeyC",33,"C",67,"VK_C",s,s],[0,13,"KeyD",34,"D",68,"VK_D",s,s],[0,14,"KeyE",35,"E",69,"VK_E",s,s],[0,15,"KeyF",36,"F",70,"VK_F",s,s],[0,16,"KeyG",37,"G",71,"VK_G",s,s],[0,17,"KeyH",38,"H",72,"VK_H",s,s],[0,18,"KeyI",39,"I",73,"VK_I",s,s],[0,19,"KeyJ",40,"J",74,"VK_J",s,s],[0,20,"KeyK",41,"K",75,"VK_K",s,s],[0,21,"KeyL",42,"L",76,"VK_L",s,s],[0,22,"KeyM",43,"M",77,"VK_M",s,s],[0,23,"KeyN",44,"N",78,"VK_N",s,s],[0,24,"KeyO",45,"O",79,"VK_O",s,s],[0,25,"KeyP",46,"P",80,"VK_P",s,s],[0,26,"KeyQ",47,"Q",81,"VK_Q",s,s],[0,27,"KeyR",48,"R",82,"VK_R",s,s],[0,28,"KeyS",49,"S",83,"VK_S",s,s],[0,29,"KeyT",50,"T",84,"VK_T",s,s],[0,30,"KeyU",51,"U",85,"VK_U",s,s],[0,31,"KeyV",52,"V",86,"VK_V",s,s],[0,32,"KeyW",53,"W",87,"VK_W",s,s],[0,33,"KeyX",54,"X",88,"VK_X",s,s],[0,34,"KeyY",55,"Y",89,"VK_Y",s,s],[0,35,"KeyZ",56,"Z",90,"VK_Z",s,s],[0,36,"Digit1",22,"1",49,"VK_1",s,s],[0,37,"Digit2",23,"2",50,"VK_2",s,s],[0,38,"Digit3",24,"3",51,"VK_3",s,s],[0,39,"Digit4",25,"4",52,"VK_4",s,s],[0,40,"Digit5",26,"5",53,"VK_5",s,s],[0,41,"Digit6",27,"6",54,"VK_6",s,s],[0,42,"Digit7",28,"7",55,"VK_7",s,s],[0,43,"Digit8",29,"8",56,"VK_8",s,s],[0,44,"Digit9",30,"9",57,"VK_9",s,s],[0,45,"Digit0",21,"0",48,"VK_0",s,s],[1,46,"Enter",3,"Enter",13,"VK_RETURN",s,s],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",s,s],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",s,s],[1,49,"Tab",2,"Tab",9,"VK_TAB",s,s],[1,50,"Space",10,"Space",32,"VK_SPACE",s,s],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,s,0,s,s,s],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",s,s],[1,64,"F1",59,"F1",112,"VK_F1",s,s],[1,65,"F2",60,"F2",113,"VK_F2",s,s],[1,66,"F3",61,"F3",114,"VK_F3",s,s],[1,67,"F4",62,"F4",115,"VK_F4",s,s],[1,68,"F5",63,"F5",116,"VK_F5",s,s],[1,69,"F6",64,"F6",117,"VK_F6",s,s],[1,70,"F7",65,"F7",118,"VK_F7",s,s],[1,71,"F8",66,"F8",119,"VK_F8",s,s],[1,72,"F9",67,"F9",120,"VK_F9",s,s],[1,73,"F10",68,"F10",121,"VK_F10",s,s],[1,74,"F11",69,"F11",122,"VK_F11",s,s],[1,75,"F12",70,"F12",123,"VK_F12",s,s],[1,76,"PrintScreen",0,s,0,s,s,s],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",s,s],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",s,s],[1,79,"Insert",19,"Insert",45,"VK_INSERT",s,s],[1,80,"Home",14,"Home",36,"VK_HOME",s,s],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",s,s],[1,82,"Delete",20,"Delete",46,"VK_DELETE",s,s],[1,83,"End",13,"End",35,"VK_END",s,s],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",s,s],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",s],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",s],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",s],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",s],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",s,s],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",s,s],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",s,s],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",s,s],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",s,s],[1,94,"NumpadEnter",3,s,0,s,s,s],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",s,s],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",s,s],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",s,s],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",s,s],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",s,s],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",s,s],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",s,s],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",s,s],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",s,s],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",s,s],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",s,s],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",s,s],[1,107,"ContextMenu",58,"ContextMenu",93,s,s,s],[1,108,"Power",0,s,0,s,s,s],[1,109,"NumpadEqual",0,s,0,s,s,s],[1,110,"F13",71,"F13",124,"VK_F13",s,s],[1,111,"F14",72,"F14",125,"VK_F14",s,s],[1,112,"F15",73,"F15",126,"VK_F15",s,s],[1,113,"F16",74,"F16",127,"VK_F16",s,s],[1,114,"F17",75,"F17",128,"VK_F17",s,s],[1,115,"F18",76,"F18",129,"VK_F18",s,s],[1,116,"F19",77,"F19",130,"VK_F19",s,s],[1,117,"F20",78,"F20",131,"VK_F20",s,s],[1,118,"F21",79,"F21",132,"VK_F21",s,s],[1,119,"F22",80,"F22",133,"VK_F22",s,s],[1,120,"F23",81,"F23",134,"VK_F23",s,s],[1,121,"F24",82,"F24",135,"VK_F24",s,s],[1,122,"Open",0,s,0,s,s,s],[1,123,"Help",0,s,0,s,s,s],[1,124,"Select",0,s,0,s,s,s],[1,125,"Again",0,s,0,s,s,s],[1,126,"Undo",0,s,0,s,s,s],[1,127,"Cut",0,s,0,s,s,s],[1,128,"Copy",0,s,0,s,s,s],[1,129,"Paste",0,s,0,s,s,s],[1,130,"Find",0,s,0,s,s,s],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",s,s],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",s,s],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",s,s],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",s,s],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",s,s],[1,136,"KanaMode",0,s,0,s,s,s],[0,137,"IntlYen",0,s,0,s,s,s],[1,138,"Convert",0,s,0,s,s,s],[1,139,"NonConvert",0,s,0,s,s,s],[1,140,"Lang1",0,s,0,s,s,s],[1,141,"Lang2",0,s,0,s,s,s],[1,142,"Lang3",0,s,0,s,s,s],[1,143,"Lang4",0,s,0,s,s,s],[1,144,"Lang5",0,s,0,s,s,s],[1,145,"Abort",0,s,0,s,s,s],[1,146,"Props",0,s,0,s,s,s],[1,147,"NumpadParenLeft",0,s,0,s,s,s],[1,148,"NumpadParenRight",0,s,0,s,s,s],[1,149,"NumpadBackspace",0,s,0,s,s,s],[1,150,"NumpadMemoryStore",0,s,0,s,s,s],[1,151,"NumpadMemoryRecall",0,s,0,s,s,s],[1,152,"NumpadMemoryClear",0,s,0,s,s,s],[1,153,"NumpadMemoryAdd",0,s,0,s,s,s],[1,154,"NumpadMemorySubtract",0,s,0,s,s,s],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",s,s],[1,156,"NumpadClearEntry",0,s,0,s,s,s],[1,0,s,5,"Ctrl",17,"VK_CONTROL",s,s],[1,0,s,4,"Shift",16,"VK_SHIFT",s,s],[1,0,s,6,"Alt",18,"VK_MENU",s,s],[1,0,s,57,"Meta",91,"VK_COMMAND",s,s],[1,157,"ControlLeft",5,s,0,"VK_LCONTROL",s,s],[1,158,"ShiftLeft",4,s,0,"VK_LSHIFT",s,s],[1,159,"AltLeft",6,s,0,"VK_LMENU",s,s],[1,160,"MetaLeft",57,s,0,"VK_LWIN",s,s],[1,161,"ControlRight",5,s,0,"VK_RCONTROL",s,s],[1,162,"ShiftRight",4,s,0,"VK_RSHIFT",s,s],[1,163,"AltRight",6,s,0,"VK_RMENU",s,s],[1,164,"MetaRight",57,s,0,"VK_RWIN",s,s],[1,165,"BrightnessUp",0,s,0,s,s,s],[1,166,"BrightnessDown",0,s,0,s,s,s],[1,167,"MediaPlay",0,s,0,s,s,s],[1,168,"MediaRecord",0,s,0,s,s,s],[1,169,"MediaFastForward",0,s,0,s,s,s],[1,170,"MediaRewind",0,s,0,s,s,s],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",s,s],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",s,s],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",s,s],[1,174,"Eject",0,s,0,s,s,s],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",s,s],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",s,s],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",s,s],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",s,s],[1,179,"LaunchApp1",0,s,0,"VK_MEDIA_LAUNCH_APP1",s,s],[1,180,"SelectTask",0,s,0,s,s,s],[1,181,"LaunchScreenSaver",0,s,0,s,s,s],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",s,s],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",s,s],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",s,s],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",s,s],[1,186,"BrowserStop",0,s,0,"VK_BROWSER_STOP",s,s],[1,187,"BrowserRefresh",0,s,0,"VK_BROWSER_REFRESH",s,s],[1,188,"BrowserFavorites",0,s,0,"VK_BROWSER_FAVORITES",s,s],[1,189,"ZoomToggle",0,s,0,s,s,s],[1,190,"MailReply",0,s,0,s,s,s],[1,191,"MailForward",0,s,0,s,s,s],[1,192,"MailSend",0,s,0,s,s,s],[1,0,s,114,"KeyInComposition",229,s,s,s],[1,0,s,116,"ABNT_C2",194,"VK_ABNT_C2",s,s],[1,0,s,96,"OEM_8",223,"VK_OEM_8",s,s],[1,0,s,0,s,0,"VK_KANA",s,s],[1,0,s,0,s,0,"VK_HANGUL",s,s],[1,0,s,0,s,0,"VK_JUNJA",s,s],[1,0,s,0,s,0,"VK_FINAL",s,s],[1,0,s,0,s,0,"VK_HANJA",s,s],[1,0,s,0,s,0,"VK_KANJI",s,s],[1,0,s,0,s,0,"VK_CONVERT",s,s],[1,0,s,0,s,0,"VK_NONCONVERT",s,s],[1,0,s,0,s,0,"VK_ACCEPT",s,s],[1,0,s,0,s,0,"VK_MODECHANGE",s,s],[1,0,s,0,s,0,"VK_SELECT",s,s],[1,0,s,0,s,0,"VK_PRINT",s,s],[1,0,s,0,s,0,"VK_EXECUTE",s,s],[1,0,s,0,s,0,"VK_SNAPSHOT",s,s],[1,0,s,0,s,0,"VK_HELP",s,s],[1,0,s,0,s,0,"VK_APPS",s,s],[1,0,s,0,s,0,"VK_PROCESSKEY",s,s],[1,0,s,0,s,0,"VK_PACKET",s,s],[1,0,s,0,s,0,"VK_DBE_SBCSCHAR",s,s],[1,0,s,0,s,0,"VK_DBE_DBCSCHAR",s,s],[1,0,s,0,s,0,"VK_ATTN",s,s],[1,0,s,0,s,0,"VK_CRSEL",s,s],[1,0,s,0,s,0,"VK_EXSEL",s,s],[1,0,s,0,s,0,"VK_EREOF",s,s],[1,0,s,0,s,0,"VK_PLAY",s,s],[1,0,s,0,s,0,"VK_ZOOM",s,s],[1,0,s,0,s,0,"VK_NONAME",s,s],[1,0,s,0,s,0,"VK_PA1",s,s],[1,0,s,0,s,0,"VK_OEM_CLEAR",s,s]],t=[],i=[];for(const n of e){const[o,r,a,l,c,d,h,u,g]=n;if(i[r]||(i[r]=!0,PJ[a]=r,OJ[a.toLowerCase()]=r,o&&(OP[r]=l)),!t[l]){if(t[l]=!0,!c)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);Nw.define(l,c),QI.define(l,u||c),JI.define(l,g||u||c)}d&&(u6[d]=l)}})();var fc;(function(s){function e(a){return Nw.keyCodeToStr(a)}s.toString=e;function t(a){return Nw.strToKeyCode(a)}s.fromString=t;function i(a){return QI.keyCodeToStr(a)}s.toUserSettingsUS=i;function n(a){return JI.keyCodeToStr(a)}s.toUserSettingsGeneral=n;function o(a){return QI.strToKeyCode(a)||JI.strToKeyCode(a)}s.fromUserSettings=o;function r(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return Nw.keyCodeToStr(a)}s.toElectronAccelerator=r})(fc||(fc={}));function Hi(s,e){const t=(e&65535)<<16>>>0;return(s|t)>>>0}var T5={};let Zf;const Ak=globalThis.vscode;if(typeof Ak<"u"&&typeof Ak.process<"u"){const s=Ak.process;Zf={get platform(){return s.platform},get arch(){return s.arch},get env(){return s.env},cwd(){return s.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?Zf={get platform(){return process.platform},get arch(){return process.arch},get env(){return T5},cwd(){return T5.VSCODE_CWD||process.cwd()}}:Zf={get platform(){return An?"win32":Qe?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};const E1=Zf.cwd,eT=Zf.env,FJ=Zf.platform,BJ=65,WJ=97,HJ=90,VJ=122,$d=46,Yn=47,Lo=92,od=58,zJ=63;class g6 extends Error{constructor(e,t,i){let n;typeof t=="string"&&t.indexOf("not ")===0?(n="must not be",t=t.replace(/^not /,"")):n="must be";const o=e.indexOf(".")!==-1?"property":"argument";let r=`The "${e}" ${o} ${n} of type ${t}`;r+=`. Received type ${typeof i}`,super(r),this.code="ERR_INVALID_ARG_TYPE"}}function UJ(s,e){if(s===null||typeof s!="object")throw new g6(e,"Object",s)}function ln(s,e){if(typeof s!="string")throw new g6(e,"string",s)}const qc=FJ==="win32";function Dt(s){return s===Yn||s===Lo}function tT(s){return s===Yn}function rd(s){return s>=BJ&&s<=HJ||s>=WJ&&s<=VJ}function N1(s,e,t,i){let n="",o=0,r=-1,a=0,l=0;for(let c=0;c<=s.length;++c){if(c<s.length)l=s.charCodeAt(c);else{if(i(l))break;l=Yn}if(i(l)){if(!(r===c-1||a===1))if(a===2){if(n.length<2||o!==2||n.charCodeAt(n.length-1)!==$d||n.charCodeAt(n.length-2)!==$d){if(n.length>2){const d=n.lastIndexOf(t);d===-1?(n="",o=0):(n=n.slice(0,d),o=n.length-1-n.lastIndexOf(t)),r=c,a=0;continue}else if(n.length!==0){n="",o=0,r=c,a=0;continue}}e&&(n+=n.length>0?`${t}..`:"..",o=2)}else n.length>0?n+=`${t}${s.slice(r+1,c)}`:n=s.slice(r+1,c),o=c-r-1;r=c,a=0}else l===$d&&a!==-1?++a:a=-1}return n}function $J(s){return s?`${s[0]==="."?"":"."}${s}`:""}function f6(s,e){UJ(e,"pathObject");const t=e.dir||e.root,i=e.base||`${e.name||""}${$J(e.ext)}`;return t?t===e.root?`${t}${i}`:`${t}${s}${i}`:i}const Vs={resolve(...s){let e="",t="",i=!1;for(let n=s.length-1;n>=-1;n--){let o;if(n>=0){if(o=s[n],ln(o,`paths[${n}]`),o.length===0)continue}else e.length===0?o=E1():(o=eT[`=${e}`]||E1(),(o===void 0||o.slice(0,2).toLowerCase()!==e.toLowerCase()&&o.charCodeAt(2)===Lo)&&(o=`${e}\\`));const r=o.length;let a=0,l="",c=!1;const d=o.charCodeAt(0);if(r===1)Dt(d)&&(a=1,c=!0);else if(Dt(d))if(c=!0,Dt(o.charCodeAt(1))){let h=2,u=h;for(;h<r&&!Dt(o.charCodeAt(h));)h++;if(h<r&&h!==u){const g=o.slice(u,h);for(u=h;h<r&&Dt(o.charCodeAt(h));)h++;if(h<r&&h!==u){for(u=h;h<r&&!Dt(o.charCodeAt(h));)h++;(h===r||h!==u)&&(l=`\\\\${g}\\${o.slice(u,h)}`,a=h)}}}else a=1;else rd(d)&&o.charCodeAt(1)===od&&(l=o.slice(0,2),a=2,r>2&&Dt(o.charCodeAt(2))&&(c=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(i){if(e.length>0)break}else if(t=`${o.slice(a)}\\${t}`,i=c,c&&e.length>0)break}return t=N1(t,!i,"\\",Dt),i?`${e}\\${t}`:`${e}${t}`||"."},normalize(s){ln(s,"path");const e=s.length;if(e===0)return".";let t=0,i,n=!1;const o=s.charCodeAt(0);if(e===1)return tT(o)?"\\":s;if(Dt(o))if(n=!0,Dt(s.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Dt(s.charCodeAt(a));)a++;if(a<e&&a!==l){const c=s.slice(l,a);for(l=a;a<e&&Dt(s.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Dt(s.charCodeAt(a));)a++;if(a===e)return`\\\\${c}\\${s.slice(l)}\\`;a!==l&&(i=`\\\\${c}\\${s.slice(l,a)}`,t=a)}}}else t=1;else rd(o)&&s.charCodeAt(1)===od&&(i=s.slice(0,2),t=2,e>2&&Dt(s.charCodeAt(2))&&(n=!0,t=3));let r=t<e?N1(s.slice(t),!n,"\\",Dt):"";return r.length===0&&!n&&(r="."),r.length>0&&Dt(s.charCodeAt(e-1))&&(r+="\\"),i===void 0?n?`\\${r}`:r:n?`${i}\\${r}`:`${i}${r}`},isAbsolute(s){ln(s,"path");const e=s.length;if(e===0)return!1;const t=s.charCodeAt(0);return Dt(t)||e>2&&rd(t)&&s.charCodeAt(1)===od&&Dt(s.charCodeAt(2))},join(...s){if(s.length===0)return".";let e,t;for(let o=0;o<s.length;++o){const r=s[o];ln(r,"path"),r.length>0&&(e===void 0?e=t=r:e+=`\\${r}`)}if(e===void 0)return".";let i=!0,n=0;if(typeof t=="string"&&Dt(t.charCodeAt(0))){++n;const o=t.length;o>1&&Dt(t.charCodeAt(1))&&(++n,o>2&&(Dt(t.charCodeAt(2))?++n:i=!1))}if(i){for(;n<e.length&&Dt(e.charCodeAt(n));)n++;n>=2&&(e=`\\${e.slice(n)}`)}return Vs.normalize(e)},relative(s,e){if(ln(s,"from"),ln(e,"to"),s===e)return"";const t=Vs.resolve(s),i=Vs.resolve(e);if(t===i||(s=t.toLowerCase(),e=i.toLowerCase(),s===e))return"";let n=0;for(;n<s.length&&s.charCodeAt(n)===Lo;)n++;let o=s.length;for(;o-1>n&&s.charCodeAt(o-1)===Lo;)o--;const r=o-n;let a=0;for(;a<e.length&&e.charCodeAt(a)===Lo;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===Lo;)l--;const c=l-a,d=r<c?r:c;let h=-1,u=0;for(;u<d;u++){const f=s.charCodeAt(n+u);if(f!==e.charCodeAt(a+u))break;f===Lo&&(h=u)}if(u!==d){if(h===-1)return i}else{if(c>d){if(e.charCodeAt(a+u)===Lo)return i.slice(a+u+1);if(u===2)return i.slice(a+u)}r>d&&(s.charCodeAt(n+u)===Lo?h=u:u===2&&(h=3)),h===-1&&(h=0)}let g="";for(u=n+h+1;u<=o;++u)(u===o||s.charCodeAt(u)===Lo)&&(g+=g.length===0?"..":"\\..");return a+=h,g.length>0?`${g}${i.slice(a,l)}`:(i.charCodeAt(a)===Lo&&++a,i.slice(a,l))},toNamespacedPath(s){if(typeof s!="string"||s.length===0)return s;const e=Vs.resolve(s);if(e.length<=2)return s;if(e.charCodeAt(0)===Lo){if(e.charCodeAt(1)===Lo){const t=e.charCodeAt(2);if(t!==zJ&&t!==$d)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(rd(e.charCodeAt(0))&&e.charCodeAt(1)===od&&e.charCodeAt(2)===Lo)return`\\\\?\\${e}`;return s},dirname(s){ln(s,"path");const e=s.length;if(e===0)return".";let t=-1,i=0;const n=s.charCodeAt(0);if(e===1)return Dt(n)?s:".";if(Dt(n)){if(t=i=1,Dt(s.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Dt(s.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&Dt(s.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Dt(s.charCodeAt(a));)a++;if(a===e)return s;a!==l&&(t=i=a+1)}}}}else rd(n)&&s.charCodeAt(1)===od&&(t=e>2&&Dt(s.charCodeAt(2))?3:2,i=t);let o=-1,r=!0;for(let a=e-1;a>=i;--a)if(Dt(s.charCodeAt(a))){if(!r){o=a;break}}else r=!1;if(o===-1){if(t===-1)return".";o=t}return s.slice(0,o)},basename(s,e){e!==void 0&&ln(e,"suffix"),ln(s,"path");let t=0,i=-1,n=!0,o;if(s.length>=2&&rd(s.charCodeAt(0))&&s.charCodeAt(1)===od&&(t=2),e!==void 0&&e.length>0&&e.length<=s.length){if(e===s)return"";let r=e.length-1,a=-1;for(o=s.length-1;o>=t;--o){const l=s.charCodeAt(o);if(Dt(l)){if(!n){t=o+1;break}}else a===-1&&(n=!1,a=o+1),r>=0&&(l===e.charCodeAt(r)?--r===-1&&(i=o):(r=-1,i=a))}return t===i?i=a:i===-1&&(i=s.length),s.slice(t,i)}for(o=s.length-1;o>=t;--o)if(Dt(s.charCodeAt(o))){if(!n){t=o+1;break}}else i===-1&&(n=!1,i=o+1);return i===-1?"":s.slice(t,i)},extname(s){ln(s,"path");let e=0,t=-1,i=0,n=-1,o=!0,r=0;s.length>=2&&s.charCodeAt(1)===od&&rd(s.charCodeAt(0))&&(e=i=2);for(let a=s.length-1;a>=e;--a){const l=s.charCodeAt(a);if(Dt(l)){if(!o){i=a+1;break}continue}n===-1&&(o=!1,n=a+1),l===$d?t===-1?t=a:r!==1&&(r=1):t!==-1&&(r=-1)}return t===-1||n===-1||r===0||r===1&&t===n-1&&t===i+1?"":s.slice(t,n)},format:f6.bind(null,"\\"),parse(s){ln(s,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return e;const t=s.length;let i=0,n=s.charCodeAt(0);if(t===1)return Dt(n)?(e.root=e.dir=s,e):(e.base=e.name=s,e);if(Dt(n)){if(i=1,Dt(s.charCodeAt(1))){let h=2,u=h;for(;h<t&&!Dt(s.charCodeAt(h));)h++;if(h<t&&h!==u){for(u=h;h<t&&Dt(s.charCodeAt(h));)h++;if(h<t&&h!==u){for(u=h;h<t&&!Dt(s.charCodeAt(h));)h++;h===t?i=h:h!==u&&(i=h+1)}}}}else if(rd(n)&&s.charCodeAt(1)===od){if(t<=2)return e.root=e.dir=s,e;if(i=2,Dt(s.charCodeAt(2))){if(t===3)return e.root=e.dir=s,e;i=3}}i>0&&(e.root=s.slice(0,i));let o=-1,r=i,a=-1,l=!0,c=s.length-1,d=0;for(;c>=i;--c){if(n=s.charCodeAt(c),Dt(n)){if(!l){r=c+1;break}continue}a===-1&&(l=!1,a=c+1),n===$d?o===-1?o=c:d!==1&&(d=1):o!==-1&&(d=-1)}return a!==-1&&(o===-1||d===0||d===1&&o===a-1&&o===r+1?e.base=e.name=s.slice(r,a):(e.name=s.slice(r,o),e.base=s.slice(r,a),e.ext=s.slice(o,a))),r>0&&r!==i?e.dir=s.slice(0,r-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},jJ=(()=>{if(qc){const s=/\\/g;return()=>{const e=E1().replace(s,"/");return e.slice(e.indexOf("/"))}}return()=>E1()})(),Ai={resolve(...s){let e="",t=!1;for(let i=s.length-1;i>=-1&&!t;i--){const n=i>=0?s[i]:jJ();ln(n,`paths[${i}]`),n.length!==0&&(e=`${n}/${e}`,t=n.charCodeAt(0)===Yn)}return e=N1(e,!t,"/",tT),t?`/${e}`:e.length>0?e:"."},normalize(s){if(ln(s,"path"),s.length===0)return".";const e=s.charCodeAt(0)===Yn,t=s.charCodeAt(s.length-1)===Yn;return s=N1(s,!e,"/",tT),s.length===0?e?"/":t?"./":".":(t&&(s+="/"),e?`/${s}`:s)},isAbsolute(s){return ln(s,"path"),s.length>0&&s.charCodeAt(0)===Yn},join(...s){if(s.length===0)return".";let e;for(let t=0;t<s.length;++t){const i=s[t];ln(i,"path"),i.length>0&&(e===void 0?e=i:e+=`/${i}`)}return e===void 0?".":Ai.normalize(e)},relative(s,e){if(ln(s,"from"),ln(e,"to"),s===e||(s=Ai.resolve(s),e=Ai.resolve(e),s===e))return"";const t=1,i=s.length,n=i-t,o=1,r=e.length-o,a=n<r?n:r;let l=-1,c=0;for(;c<a;c++){const h=s.charCodeAt(t+c);if(h!==e.charCodeAt(o+c))break;h===Yn&&(l=c)}if(c===a)if(r>a){if(e.charCodeAt(o+c)===Yn)return e.slice(o+c+1);if(c===0)return e.slice(o+c)}else n>a&&(s.charCodeAt(t+c)===Yn?l=c:c===0&&(l=0));let d="";for(c=t+l+1;c<=i;++c)(c===i||s.charCodeAt(c)===Yn)&&(d+=d.length===0?"..":"/..");return`${d}${e.slice(o+l)}`},toNamespacedPath(s){return s},dirname(s){if(ln(s,"path"),s.length===0)return".";const e=s.charCodeAt(0)===Yn;let t=-1,i=!0;for(let n=s.length-1;n>=1;--n)if(s.charCodeAt(n)===Yn){if(!i){t=n;break}}else i=!1;return t===-1?e?"/":".":e&&t===1?"//":s.slice(0,t)},basename(s,e){e!==void 0&&ln(e,"ext"),ln(s,"path");let t=0,i=-1,n=!0,o;if(e!==void 0&&e.length>0&&e.length<=s.length){if(e===s)return"";let r=e.length-1,a=-1;for(o=s.length-1;o>=0;--o){const l=s.charCodeAt(o);if(l===Yn){if(!n){t=o+1;break}}else a===-1&&(n=!1,a=o+1),r>=0&&(l===e.charCodeAt(r)?--r===-1&&(i=o):(r=-1,i=a))}return t===i?i=a:i===-1&&(i=s.length),s.slice(t,i)}for(o=s.length-1;o>=0;--o)if(s.charCodeAt(o)===Yn){if(!n){t=o+1;break}}else i===-1&&(n=!1,i=o+1);return i===-1?"":s.slice(t,i)},extname(s){ln(s,"path");let e=-1,t=0,i=-1,n=!0,o=0;for(let r=s.length-1;r>=0;--r){const a=s.charCodeAt(r);if(a===Yn){if(!n){t=r+1;break}continue}i===-1&&(n=!1,i=r+1),a===$d?e===-1?e=r:o!==1&&(o=1):e!==-1&&(o=-1)}return e===-1||i===-1||o===0||o===1&&e===i-1&&e===t+1?"":s.slice(e,i)},format:f6.bind(null,"/"),parse(s){ln(s,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return e;const t=s.charCodeAt(0)===Yn;let i;t?(e.root="/",i=1):i=0;let n=-1,o=0,r=-1,a=!0,l=s.length-1,c=0;for(;l>=i;--l){const d=s.charCodeAt(l);if(d===Yn){if(!a){o=l+1;break}continue}r===-1&&(a=!1,r=l+1),d===$d?n===-1?n=l:c!==1&&(c=1):n!==-1&&(c=-1)}if(r!==-1){const d=o===0&&t?1:o;n===-1||c===0||c===1&&n===r-1&&n===o+1?e.base=e.name=s.slice(d,r):(e.name=s.slice(d,n),e.base=s.slice(d,r),e.ext=s.slice(n,r))}return o>0?e.dir=s.slice(0,o-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};Ai.win32=Vs.win32=Vs;Ai.posix=Vs.posix=Ai;const p6=qc?Vs.normalize:Ai.normalize,ZJ=qc?Vs.join:Ai.join,KJ=qc?Vs.resolve:Ai.resolve,qJ=qc?Vs.relative:Ai.relative,m6=qc?Vs.dirname:Ai.dirname,jd=qc?Vs.basename:Ai.basename,GJ=qc?Vs.extname:Ai.extname,Ta=qc?Vs.sep:Ai.sep,YJ=/^\w[\w\d+.-]*$/,XJ=/^\//,QJ=/^\/\//;function JJ(s,e){if(!s.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${s.authority}", path: "${s.path}", query: "${s.query}", fragment: "${s.fragment}"}`);if(s.scheme&&!YJ.test(s.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(s.path){if(s.authority){if(!XJ.test(s.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(QJ.test(s.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function eee(s,e){return!s&&!e?"file":s}function tee(s,e){switch(s){case"https":case"http":case"file":e?e[0]!==Sa&&(e=Sa+e):e=Sa;break}return e}const Ri="",Sa="/",iee=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class Se{static isUri(e){return e instanceof Se?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}constructor(e,t,i,n,o,r=!1){typeof e=="object"?(this.scheme=e.scheme||Ri,this.authority=e.authority||Ri,this.path=e.path||Ri,this.query=e.query||Ri,this.fragment=e.fragment||Ri):(this.scheme=eee(e,r),this.authority=t||Ri,this.path=tee(this.scheme,i||Ri),this.query=n||Ri,this.fragment=o||Ri,JJ(this,r))}get fsPath(){return R1(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:i,path:n,query:o,fragment:r}=e;return t===void 0?t=this.scheme:t===null&&(t=Ri),i===void 0?i=this.authority:i===null&&(i=Ri),n===void 0?n=this.path:n===null&&(n=Ri),o===void 0?o=this.query:o===null&&(o=Ri),r===void 0?r=this.fragment:r===null&&(r=Ri),t===this.scheme&&i===this.authority&&n===this.path&&o===this.query&&r===this.fragment?this:new Fg(t,i,n,o,r)}static parse(e,t=!1){const i=iee.exec(e);return i?new Fg(i[2]||Ri,my(i[4]||Ri),my(i[5]||Ri),my(i[7]||Ri),my(i[9]||Ri),t):new Fg(Ri,Ri,Ri,Ri,Ri)}static file(e){let t=Ri;if(An&&(e=e.replace(/\\/g,Sa)),e[0]===Sa&&e[1]===Sa){const i=e.indexOf(Sa,2);i===-1?(t=e.substring(2),e=Sa):(t=e.substring(2,i),e=e.substring(i)||Sa)}return new Fg("file",t,e,Ri,Ri)}static from(e,t){return new Fg(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let i;return An&&e.scheme==="file"?i=Se.file(Vs.join(R1(e,!0),...t)).path:i=Ai.join(e.path,...t),e.with({path:i})}toString(e=!1){return iT(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof Se)return e;{const t=new Fg(e);return t._formatted=e.external??null,t._fsPath=e._sep===_6?e.fsPath??null:null,t}}else return e}}const _6=An?1:void 0;let Fg=class extends Se{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=R1(this,!1)),this._fsPath}toString(e=!1){return e?iT(this,!0):(this._formatted||(this._formatted=iT(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=_6),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}};const b6={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function E5(s,e,t){let i,n=-1;for(let o=0;o<s.length;o++){const r=s.charCodeAt(o);if(r>=97&&r<=122||r>=65&&r<=90||r>=48&&r<=57||r===45||r===46||r===95||r===126||e&&r===47||t&&r===91||t&&r===93||t&&r===58)n!==-1&&(i+=encodeURIComponent(s.substring(n,o)),n=-1),i!==void 0&&(i+=s.charAt(o));else{i===void 0&&(i=s.substr(0,o));const a=b6[r];a!==void 0?(n!==-1&&(i+=encodeURIComponent(s.substring(n,o)),n=-1),i+=a):n===-1&&(n=o)}}return n!==-1&&(i+=encodeURIComponent(s.substring(n))),i!==void 0?i:s}function nee(s){let e;for(let t=0;t<s.length;t++){const i=s.charCodeAt(t);i===35||i===63?(e===void 0&&(e=s.substr(0,t)),e+=b6[i]):e!==void 0&&(e+=s[t])}return e!==void 0?e:s}function R1(s,e){let t;return s.authority&&s.path.length>1&&s.scheme==="file"?t=`//${s.authority}${s.path}`:s.path.charCodeAt(0)===47&&(s.path.charCodeAt(1)>=65&&s.path.charCodeAt(1)<=90||s.path.charCodeAt(1)>=97&&s.path.charCodeAt(1)<=122)&&s.path.charCodeAt(2)===58?e?t=s.path.substr(1):t=s.path[1].toLowerCase()+s.path.substr(2):t=s.path,An&&(t=t.replace(/\//g,"\\")),t}function iT(s,e){const t=e?nee:E5;let i="",{scheme:n,authority:o,path:r,query:a,fragment:l}=s;if(n&&(i+=n,i+=":"),(o||n==="file")&&(i+=Sa,i+=Sa),o){let c=o.indexOf("@");if(c!==-1){const d=o.substr(0,c);o=o.substr(c+1),c=d.lastIndexOf(":"),c===-1?i+=t(d,!1,!1):(i+=t(d.substr(0,c),!1,!1),i+=":",i+=t(d.substr(c+1),!1,!0)),i+="@"}o=o.toLowerCase(),c=o.lastIndexOf(":"),c===-1?i+=t(o,!1,!0):(i+=t(o.substr(0,c),!1,!0),i+=o.substr(c))}if(r){if(r.length>=3&&r.charCodeAt(0)===47&&r.charCodeAt(2)===58){const c=r.charCodeAt(1);c>=65&&c<=90&&(r=`/${String.fromCharCode(c+32)}:${r.substr(3)}`)}else if(r.length>=2&&r.charCodeAt(1)===58){const c=r.charCodeAt(0);c>=65&&c<=90&&(r=`${String.fromCharCode(c+32)}:${r.substr(2)}`)}i+=t(r,!0,!1)}return a&&(i+="?",i+=t(a,!1,!1)),l&&(i+="#",i+=e?l:E5(l,!1,!1)),i}function v6(s){try{return decodeURIComponent(s)}catch{return s.length>3?s.substr(0,3)+v6(s.substr(3)):s}}const N5=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function my(s){return s.match(N5)?s.replace(N5,e=>v6(e)):s}let P=class Zh{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new Zh(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return Zh.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return Zh.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return Zh.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){const i=e.lineNumber|0,n=t.lineNumber|0;if(i===n){const o=e.column|0,r=t.column|0;return o-r}return i-n}clone(){return new Zh(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new Zh(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}},k=class fn{constructor(e,t,i,n){e>i||e===i&&t>n?(this.startLineNumber=i,this.startColumn=n,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=n)}isEmpty(){return fn.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return fn.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return fn.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return fn.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return fn.plusRange(this,e)}static plusRange(e,t){let i,n,o,r;return t.startLineNumber<e.startLineNumber?(i=t.startLineNumber,n=t.startColumn):t.startLineNumber===e.startLineNumber?(i=t.startLineNumber,n=Math.min(t.startColumn,e.startColumn)):(i=e.startLineNumber,n=e.startColumn),t.endLineNumber>e.endLineNumber?(o=t.endLineNumber,r=t.endColumn):t.endLineNumber===e.endLineNumber?(o=t.endLineNumber,r=Math.max(t.endColumn,e.endColumn)):(o=e.endLineNumber,r=e.endColumn),new fn(i,n,o,r)}intersectRanges(e){return fn.intersectRanges(this,e)}static intersectRanges(e,t){let i=e.startLineNumber,n=e.startColumn,o=e.endLineNumber,r=e.endColumn;const a=t.startLineNumber,l=t.startColumn,c=t.endLineNumber,d=t.endColumn;return i<a?(i=a,n=l):i===a&&(n=Math.max(n,l)),o>c?(o=c,r=d):o===c&&(r=Math.min(r,d)),i>o||i===o&&n>r?null:new fn(i,n,o,r)}equalsRange(e){return fn.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return fn.getEndPosition(this)}static getEndPosition(e){return new P(e.endLineNumber,e.endColumn)}getStartPosition(){return fn.getStartPosition(this)}static getStartPosition(e){return new P(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new fn(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new fn(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return fn.collapseToStart(this)}static collapseToStart(e){return new fn(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return fn.collapseToEnd(this)}static collapseToEnd(e){return new fn(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new fn(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new fn(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new fn(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){const o=e.startLineNumber|0,r=t.startLineNumber|0;if(o===r){const a=e.startColumn|0,l=t.startColumn|0;if(a===l){const c=e.endLineNumber|0,d=t.endLineNumber|0;if(c===d){const h=e.endColumn|0,u=t.endColumn|0;return h-u}return c-d}return a-l}return o-r}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}},me=class Ar extends k{constructor(e,t,i,n){super(e,t,i,n),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=i,this.positionColumn=n}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return Ar.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new Ar(this.startLineNumber,this.startColumn,e,t):new Ar(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new P(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new P(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new Ar(e,t,this.endLineNumber,this.endColumn):new Ar(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new Ar(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new Ar(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new Ar(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new Ar(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(!this.selectionsEqual(e[i],t[i]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,i,n,o){return o===0?new Ar(e,t,i,n):new Ar(i,n,e,t)}};const nT=Object.create(null);function S(s,e){if(zs(e)){const t=nT[e];if(t===void 0)throw new Error(`${s} references an unknown codicon: ${e}`);e=t}return nT[s]=e,{id:s}}function C6(){return nT}const see={add:S("add",6e4),plus:S("plus",6e4),gistNew:S("gist-new",6e4),repoCreate:S("repo-create",6e4),lightbulb:S("lightbulb",60001),lightBulb:S("light-bulb",60001),repo:S("repo",60002),repoDelete:S("repo-delete",60002),gistFork:S("gist-fork",60003),repoForked:S("repo-forked",60003),gitPullRequest:S("git-pull-request",60004),gitPullRequestAbandoned:S("git-pull-request-abandoned",60004),recordKeys:S("record-keys",60005),keyboard:S("keyboard",60005),tag:S("tag",60006),gitPullRequestLabel:S("git-pull-request-label",60006),tagAdd:S("tag-add",60006),tagRemove:S("tag-remove",60006),person:S("person",60007),personFollow:S("person-follow",60007),personOutline:S("person-outline",60007),personFilled:S("person-filled",60007),gitBranch:S("git-branch",60008),gitBranchCreate:S("git-branch-create",60008),gitBranchDelete:S("git-branch-delete",60008),sourceControl:S("source-control",60008),mirror:S("mirror",60009),mirrorPublic:S("mirror-public",60009),star:S("star",60010),starAdd:S("star-add",60010),starDelete:S("star-delete",60010),starEmpty:S("star-empty",60010),comment:S("comment",60011),commentAdd:S("comment-add",60011),alert:S("alert",60012),warning:S("warning",60012),search:S("search",60013),searchSave:S("search-save",60013),logOut:S("log-out",60014),signOut:S("sign-out",60014),logIn:S("log-in",60015),signIn:S("sign-in",60015),eye:S("eye",60016),eyeUnwatch:S("eye-unwatch",60016),eyeWatch:S("eye-watch",60016),circleFilled:S("circle-filled",60017),primitiveDot:S("primitive-dot",60017),closeDirty:S("close-dirty",60017),debugBreakpoint:S("debug-breakpoint",60017),debugBreakpointDisabled:S("debug-breakpoint-disabled",60017),debugHint:S("debug-hint",60017),terminalDecorationSuccess:S("terminal-decoration-success",60017),primitiveSquare:S("primitive-square",60018),edit:S("edit",60019),pencil:S("pencil",60019),info:S("info",60020),issueOpened:S("issue-opened",60020),gistPrivate:S("gist-private",60021),gitForkPrivate:S("git-fork-private",60021),lock:S("lock",60021),mirrorPrivate:S("mirror-private",60021),close:S("close",60022),removeClose:S("remove-close",60022),x:S("x",60022),repoSync:S("repo-sync",60023),sync:S("sync",60023),clone:S("clone",60024),desktopDownload:S("desktop-download",60024),beaker:S("beaker",60025),microscope:S("microscope",60025),vm:S("vm",60026),deviceDesktop:S("device-desktop",60026),file:S("file",60027),fileText:S("file-text",60027),more:S("more",60028),ellipsis:S("ellipsis",60028),kebabHorizontal:S("kebab-horizontal",60028),mailReply:S("mail-reply",60029),reply:S("reply",60029),organization:S("organization",60030),organizationFilled:S("organization-filled",60030),organizationOutline:S("organization-outline",60030),newFile:S("new-file",60031),fileAdd:S("file-add",60031),newFolder:S("new-folder",60032),fileDirectoryCreate:S("file-directory-create",60032),trash:S("trash",60033),trashcan:S("trashcan",60033),history:S("history",60034),clock:S("clock",60034),folder:S("folder",60035),fileDirectory:S("file-directory",60035),symbolFolder:S("symbol-folder",60035),logoGithub:S("logo-github",60036),markGithub:S("mark-github",60036),github:S("github",60036),terminal:S("terminal",60037),console:S("console",60037),repl:S("repl",60037),zap:S("zap",60038),symbolEvent:S("symbol-event",60038),error:S("error",60039),stop:S("stop",60039),variable:S("variable",60040),symbolVariable:S("symbol-variable",60040),array:S("array",60042),symbolArray:S("symbol-array",60042),symbolModule:S("symbol-module",60043),symbolPackage:S("symbol-package",60043),symbolNamespace:S("symbol-namespace",60043),symbolObject:S("symbol-object",60043),symbolMethod:S("symbol-method",60044),symbolFunction:S("symbol-function",60044),symbolConstructor:S("symbol-constructor",60044),symbolBoolean:S("symbol-boolean",60047),symbolNull:S("symbol-null",60047),symbolNumeric:S("symbol-numeric",60048),symbolNumber:S("symbol-number",60048),symbolStructure:S("symbol-structure",60049),symbolStruct:S("symbol-struct",60049),symbolParameter:S("symbol-parameter",60050),symbolTypeParameter:S("symbol-type-parameter",60050),symbolKey:S("symbol-key",60051),symbolText:S("symbol-text",60051),symbolReference:S("symbol-reference",60052),goToFile:S("go-to-file",60052),symbolEnum:S("symbol-enum",60053),symbolValue:S("symbol-value",60053),symbolRuler:S("symbol-ruler",60054),symbolUnit:S("symbol-unit",60054),activateBreakpoints:S("activate-breakpoints",60055),archive:S("archive",60056),arrowBoth:S("arrow-both",60057),arrowDown:S("arrow-down",60058),arrowLeft:S("arrow-left",60059),arrowRight:S("arrow-right",60060),arrowSmallDown:S("arrow-small-down",60061),arrowSmallLeft:S("arrow-small-left",60062),arrowSmallRight:S("arrow-small-right",60063),arrowSmallUp:S("arrow-small-up",60064),arrowUp:S("arrow-up",60065),bell:S("bell",60066),bold:S("bold",60067),book:S("book",60068),bookmark:S("bookmark",60069),debugBreakpointConditionalUnverified:S("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:S("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:S("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:S("debug-breakpoint-data-unverified",60072),debugBreakpointData:S("debug-breakpoint-data",60073),debugBreakpointDataDisabled:S("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:S("debug-breakpoint-log-unverified",60074),debugBreakpointLog:S("debug-breakpoint-log",60075),debugBreakpointLogDisabled:S("debug-breakpoint-log-disabled",60075),briefcase:S("briefcase",60076),broadcast:S("broadcast",60077),browser:S("browser",60078),bug:S("bug",60079),calendar:S("calendar",60080),caseSensitive:S("case-sensitive",60081),check:S("check",60082),checklist:S("checklist",60083),chevronDown:S("chevron-down",60084),chevronLeft:S("chevron-left",60085),chevronRight:S("chevron-right",60086),chevronUp:S("chevron-up",60087),chromeClose:S("chrome-close",60088),chromeMaximize:S("chrome-maximize",60089),chromeMinimize:S("chrome-minimize",60090),chromeRestore:S("chrome-restore",60091),circleOutline:S("circle-outline",60092),circle:S("circle",60092),debugBreakpointUnverified:S("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:S("terminal-decoration-incomplete",60092),circleSlash:S("circle-slash",60093),circuitBoard:S("circuit-board",60094),clearAll:S("clear-all",60095),clippy:S("clippy",60096),closeAll:S("close-all",60097),cloudDownload:S("cloud-download",60098),cloudUpload:S("cloud-upload",60099),code:S("code",60100),collapseAll:S("collapse-all",60101),colorMode:S("color-mode",60102),commentDiscussion:S("comment-discussion",60103),creditCard:S("credit-card",60105),dash:S("dash",60108),dashboard:S("dashboard",60109),database:S("database",60110),debugContinue:S("debug-continue",60111),debugDisconnect:S("debug-disconnect",60112),debugPause:S("debug-pause",60113),debugRestart:S("debug-restart",60114),debugStart:S("debug-start",60115),debugStepInto:S("debug-step-into",60116),debugStepOut:S("debug-step-out",60117),debugStepOver:S("debug-step-over",60118),debugStop:S("debug-stop",60119),debug:S("debug",60120),deviceCameraVideo:S("device-camera-video",60121),deviceCamera:S("device-camera",60122),deviceMobile:S("device-mobile",60123),diffAdded:S("diff-added",60124),diffIgnored:S("diff-ignored",60125),diffModified:S("diff-modified",60126),diffRemoved:S("diff-removed",60127),diffRenamed:S("diff-renamed",60128),diff:S("diff",60129),diffSidebyside:S("diff-sidebyside",60129),discard:S("discard",60130),editorLayout:S("editor-layout",60131),emptyWindow:S("empty-window",60132),exclude:S("exclude",60133),extensions:S("extensions",60134),eyeClosed:S("eye-closed",60135),fileBinary:S("file-binary",60136),fileCode:S("file-code",60137),fileMedia:S("file-media",60138),filePdf:S("file-pdf",60139),fileSubmodule:S("file-submodule",60140),fileSymlinkDirectory:S("file-symlink-directory",60141),fileSymlinkFile:S("file-symlink-file",60142),fileZip:S("file-zip",60143),files:S("files",60144),filter:S("filter",60145),flame:S("flame",60146),foldDown:S("fold-down",60147),foldUp:S("fold-up",60148),fold:S("fold",60149),folderActive:S("folder-active",60150),folderOpened:S("folder-opened",60151),gear:S("gear",60152),gift:S("gift",60153),gistSecret:S("gist-secret",60154),gist:S("gist",60155),gitCommit:S("git-commit",60156),gitCompare:S("git-compare",60157),compareChanges:S("compare-changes",60157),gitMerge:S("git-merge",60158),githubAction:S("github-action",60159),githubAlt:S("github-alt",60160),globe:S("globe",60161),grabber:S("grabber",60162),graph:S("graph",60163),gripper:S("gripper",60164),heart:S("heart",60165),home:S("home",60166),horizontalRule:S("horizontal-rule",60167),hubot:S("hubot",60168),inbox:S("inbox",60169),issueReopened:S("issue-reopened",60171),issues:S("issues",60172),italic:S("italic",60173),jersey:S("jersey",60174),json:S("json",60175),kebabVertical:S("kebab-vertical",60176),key:S("key",60177),law:S("law",60178),lightbulbAutofix:S("lightbulb-autofix",60179),linkExternal:S("link-external",60180),link:S("link",60181),listOrdered:S("list-ordered",60182),listUnordered:S("list-unordered",60183),liveShare:S("live-share",60184),loading:S("loading",60185),location:S("location",60186),mailRead:S("mail-read",60187),mail:S("mail",60188),markdown:S("markdown",60189),megaphone:S("megaphone",60190),mention:S("mention",60191),milestone:S("milestone",60192),gitPullRequestMilestone:S("git-pull-request-milestone",60192),mortarBoard:S("mortar-board",60193),move:S("move",60194),multipleWindows:S("multiple-windows",60195),mute:S("mute",60196),noNewline:S("no-newline",60197),note:S("note",60198),octoface:S("octoface",60199),openPreview:S("open-preview",60200),package:S("package",60201),paintcan:S("paintcan",60202),pin:S("pin",60203),play:S("play",60204),run:S("run",60204),plug:S("plug",60205),preserveCase:S("preserve-case",60206),preview:S("preview",60207),project:S("project",60208),pulse:S("pulse",60209),question:S("question",60210),quote:S("quote",60211),radioTower:S("radio-tower",60212),reactions:S("reactions",60213),references:S("references",60214),refresh:S("refresh",60215),regex:S("regex",60216),remoteExplorer:S("remote-explorer",60217),remote:S("remote",60218),remove:S("remove",60219),replaceAll:S("replace-all",60220),replace:S("replace",60221),repoClone:S("repo-clone",60222),repoForcePush:S("repo-force-push",60223),repoPull:S("repo-pull",60224),repoPush:S("repo-push",60225),report:S("report",60226),requestChanges:S("request-changes",60227),rocket:S("rocket",60228),rootFolderOpened:S("root-folder-opened",60229),rootFolder:S("root-folder",60230),rss:S("rss",60231),ruby:S("ruby",60232),saveAll:S("save-all",60233),saveAs:S("save-as",60234),save:S("save",60235),screenFull:S("screen-full",60236),screenNormal:S("screen-normal",60237),searchStop:S("search-stop",60238),server:S("server",60240),settingsGear:S("settings-gear",60241),settings:S("settings",60242),shield:S("shield",60243),smiley:S("smiley",60244),sortPrecedence:S("sort-precedence",60245),splitHorizontal:S("split-horizontal",60246),splitVertical:S("split-vertical",60247),squirrel:S("squirrel",60248),starFull:S("star-full",60249),starHalf:S("star-half",60250),symbolClass:S("symbol-class",60251),symbolColor:S("symbol-color",60252),symbolConstant:S("symbol-constant",60253),symbolEnumMember:S("symbol-enum-member",60254),symbolField:S("symbol-field",60255),symbolFile:S("symbol-file",60256),symbolInterface:S("symbol-interface",60257),symbolKeyword:S("symbol-keyword",60258),symbolMisc:S("symbol-misc",60259),symbolOperator:S("symbol-operator",60260),symbolProperty:S("symbol-property",60261),wrench:S("wrench",60261),wrenchSubaction:S("wrench-subaction",60261),symbolSnippet:S("symbol-snippet",60262),tasklist:S("tasklist",60263),telescope:S("telescope",60264),textSize:S("text-size",60265),threeBars:S("three-bars",60266),thumbsdown:S("thumbsdown",60267),thumbsup:S("thumbsup",60268),tools:S("tools",60269),triangleDown:S("triangle-down",60270),triangleLeft:S("triangle-left",60271),triangleRight:S("triangle-right",60272),triangleUp:S("triangle-up",60273),twitter:S("twitter",60274),unfold:S("unfold",60275),unlock:S("unlock",60276),unmute:S("unmute",60277),unverified:S("unverified",60278),verified:S("verified",60279),versions:S("versions",60280),vmActive:S("vm-active",60281),vmOutline:S("vm-outline",60282),vmRunning:S("vm-running",60283),watch:S("watch",60284),whitespace:S("whitespace",60285),wholeWord:S("whole-word",60286),window:S("window",60287),wordWrap:S("word-wrap",60288),zoomIn:S("zoom-in",60289),zoomOut:S("zoom-out",60290),listFilter:S("list-filter",60291),listFlat:S("list-flat",60292),listSelection:S("list-selection",60293),selection:S("selection",60293),listTree:S("list-tree",60294),debugBreakpointFunctionUnverified:S("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:S("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:S("debug-breakpoint-function-disabled",60296),debugStackframeActive:S("debug-stackframe-active",60297),circleSmallFilled:S("circle-small-filled",60298),debugStackframeDot:S("debug-stackframe-dot",60298),terminalDecorationMark:S("terminal-decoration-mark",60298),debugStackframe:S("debug-stackframe",60299),debugStackframeFocused:S("debug-stackframe-focused",60299),debugBreakpointUnsupported:S("debug-breakpoint-unsupported",60300),symbolString:S("symbol-string",60301),debugReverseContinue:S("debug-reverse-continue",60302),debugStepBack:S("debug-step-back",60303),debugRestartFrame:S("debug-restart-frame",60304),debugAlt:S("debug-alt",60305),callIncoming:S("call-incoming",60306),callOutgoing:S("call-outgoing",60307),menu:S("menu",60308),expandAll:S("expand-all",60309),feedback:S("feedback",60310),gitPullRequestReviewer:S("git-pull-request-reviewer",60310),groupByRefType:S("group-by-ref-type",60311),ungroupByRefType:S("ungroup-by-ref-type",60312),account:S("account",60313),gitPullRequestAssignee:S("git-pull-request-assignee",60313),bellDot:S("bell-dot",60314),debugConsole:S("debug-console",60315),library:S("library",60316),output:S("output",60317),runAll:S("run-all",60318),syncIgnored:S("sync-ignored",60319),pinned:S("pinned",60320),githubInverted:S("github-inverted",60321),serverProcess:S("server-process",60322),serverEnvironment:S("server-environment",60323),pass:S("pass",60324),issueClosed:S("issue-closed",60324),stopCircle:S("stop-circle",60325),playCircle:S("play-circle",60326),record:S("record",60327),debugAltSmall:S("debug-alt-small",60328),vmConnect:S("vm-connect",60329),cloud:S("cloud",60330),merge:S("merge",60331),export:S("export",60332),graphLeft:S("graph-left",60333),magnet:S("magnet",60334),notebook:S("notebook",60335),redo:S("redo",60336),checkAll:S("check-all",60337),pinnedDirty:S("pinned-dirty",60338),passFilled:S("pass-filled",60339),circleLargeFilled:S("circle-large-filled",60340),circleLarge:S("circle-large",60341),circleLargeOutline:S("circle-large-outline",60341),combine:S("combine",60342),gather:S("gather",60342),table:S("table",60343),variableGroup:S("variable-group",60344),typeHierarchy:S("type-hierarchy",60345),typeHierarchySub:S("type-hierarchy-sub",60346),typeHierarchySuper:S("type-hierarchy-super",60347),gitPullRequestCreate:S("git-pull-request-create",60348),runAbove:S("run-above",60349),runBelow:S("run-below",60350),notebookTemplate:S("notebook-template",60351),debugRerun:S("debug-rerun",60352),workspaceTrusted:S("workspace-trusted",60353),workspaceUntrusted:S("workspace-untrusted",60354),workspaceUnknown:S("workspace-unknown",60355),terminalCmd:S("terminal-cmd",60356),terminalDebian:S("terminal-debian",60357),terminalLinux:S("terminal-linux",60358),terminalPowershell:S("terminal-powershell",60359),terminalTmux:S("terminal-tmux",60360),terminalUbuntu:S("terminal-ubuntu",60361),terminalBash:S("terminal-bash",60362),arrowSwap:S("arrow-swap",60363),copy:S("copy",60364),personAdd:S("person-add",60365),filterFilled:S("filter-filled",60366),wand:S("wand",60367),debugLineByLine:S("debug-line-by-line",60368),inspect:S("inspect",60369),layers:S("layers",60370),layersDot:S("layers-dot",60371),layersActive:S("layers-active",60372),compass:S("compass",60373),compassDot:S("compass-dot",60374),compassActive:S("compass-active",60375),azure:S("azure",60376),issueDraft:S("issue-draft",60377),gitPullRequestClosed:S("git-pull-request-closed",60378),gitPullRequestDraft:S("git-pull-request-draft",60379),debugAll:S("debug-all",60380),debugCoverage:S("debug-coverage",60381),runErrors:S("run-errors",60382),folderLibrary:S("folder-library",60383),debugContinueSmall:S("debug-continue-small",60384),beakerStop:S("beaker-stop",60385),graphLine:S("graph-line",60386),graphScatter:S("graph-scatter",60387),pieChart:S("pie-chart",60388),bracket:S("bracket",60175),bracketDot:S("bracket-dot",60389),bracketError:S("bracket-error",60390),lockSmall:S("lock-small",60391),azureDevops:S("azure-devops",60392),verifiedFilled:S("verified-filled",60393),newline:S("newline",60394),layout:S("layout",60395),layoutActivitybarLeft:S("layout-activitybar-left",60396),layoutActivitybarRight:S("layout-activitybar-right",60397),layoutPanelLeft:S("layout-panel-left",60398),layoutPanelCenter:S("layout-panel-center",60399),layoutPanelJustify:S("layout-panel-justify",60400),layoutPanelRight:S("layout-panel-right",60401),layoutPanel:S("layout-panel",60402),layoutSidebarLeft:S("layout-sidebar-left",60403),layoutSidebarRight:S("layout-sidebar-right",60404),layoutStatusbar:S("layout-statusbar",60405),layoutMenubar:S("layout-menubar",60406),layoutCentered:S("layout-centered",60407),target:S("target",60408),indent:S("indent",60409),recordSmall:S("record-small",60410),errorSmall:S("error-small",60411),terminalDecorationError:S("terminal-decoration-error",60411),arrowCircleDown:S("arrow-circle-down",60412),arrowCircleLeft:S("arrow-circle-left",60413),arrowCircleRight:S("arrow-circle-right",60414),arrowCircleUp:S("arrow-circle-up",60415),layoutSidebarRightOff:S("layout-sidebar-right-off",60416),layoutPanelOff:S("layout-panel-off",60417),layoutSidebarLeftOff:S("layout-sidebar-left-off",60418),blank:S("blank",60419),heartFilled:S("heart-filled",60420),map:S("map",60421),mapHorizontal:S("map-horizontal",60421),foldHorizontal:S("fold-horizontal",60421),mapFilled:S("map-filled",60422),mapHorizontalFilled:S("map-horizontal-filled",60422),foldHorizontalFilled:S("fold-horizontal-filled",60422),circleSmall:S("circle-small",60423),bellSlash:S("bell-slash",60424),bellSlashDot:S("bell-slash-dot",60425),commentUnresolved:S("comment-unresolved",60426),gitPullRequestGoToChanges:S("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:S("git-pull-request-new-changes",60428),searchFuzzy:S("search-fuzzy",60429),commentDraft:S("comment-draft",60430),send:S("send",60431),sparkle:S("sparkle",60432),insert:S("insert",60433),mic:S("mic",60434),thumbsdownFilled:S("thumbsdown-filled",60435),thumbsupFilled:S("thumbsup-filled",60436),coffee:S("coffee",60437),snake:S("snake",60438),game:S("game",60439),vr:S("vr",60440),chip:S("chip",60441),piano:S("piano",60442),music:S("music",60443),micFilled:S("mic-filled",60444),repoFetch:S("repo-fetch",60445),copilot:S("copilot",60446),lightbulbSparkle:S("lightbulb-sparkle",60447),robot:S("robot",60448),sparkleFilled:S("sparkle-filled",60449),diffSingle:S("diff-single",60450),diffMultiple:S("diff-multiple",60451),surroundWith:S("surround-with",60452),share:S("share",60453),gitStash:S("git-stash",60454),gitStashApply:S("git-stash-apply",60455),gitStashPop:S("git-stash-pop",60456),vscode:S("vscode",60457),vscodeInsiders:S("vscode-insiders",60458),codeOss:S("code-oss",60459),runCoverage:S("run-coverage",60460),runAllCoverage:S("run-all-coverage",60461),coverage:S("coverage",60462),githubProject:S("github-project",60463),mapVertical:S("map-vertical",60464),foldVertical:S("fold-vertical",60464),mapVerticalFilled:S("map-vertical-filled",60465),foldVerticalFilled:S("fold-vertical-filled",60465),goToSearch:S("go-to-search",60466),percentage:S("percentage",60467),sortPercentage:S("sort-percentage",60467),attach:S("attach",60468)},oee={dialogError:S("dialog-error","error"),dialogWarning:S("dialog-warning","warning"),dialogInfo:S("dialog-info","info"),dialogClose:S("dialog-close","close"),treeItemExpanded:S("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:S("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:S("tree-filter-on-type-off","list-selection"),treeFilterClear:S("tree-filter-clear","close"),treeItemLoading:S("tree-item-loading","loading"),menuSelection:S("menu-selection","check"),menuSubmenu:S("menu-submenu","chevron-right"),menuBarMore:S("menubar-more","more"),scrollbarButtonLeft:S("scrollbar-button-left","triangle-left"),scrollbarButtonRight:S("scrollbar-button-right","triangle-right"),scrollbarButtonUp:S("scrollbar-button-up","triangle-up"),scrollbarButtonDown:S("scrollbar-button-down","triangle-down"),toolBarMore:S("toolbar-more","more"),quickInputBack:S("quick-input-back","arrow-left"),dropDownButton:S("drop-down-button",60084),symbolCustomColor:S("symbol-customcolor",60252),exportIcon:S("export",60332),workspaceUnspecified:S("workspace-unspecified",60355),newLine:S("newline",60394),thumbsDownFilled:S("thumbsdown-filled",60435),thumbsUpFilled:S("thumbsup-filled",60436),gitFetch:S("git-fetch",60445),lightbulbSparkleAutofix:S("lightbulb-sparkle-autofix",60447),debugBreakpointPending:S("debug-breakpoint-pending",60377)},J={...see,...oee};let y6=class{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new O,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),Ce(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){this._factories.get(e)?.dispose();const i=new ree(this,e,t);return this._factories.set(e,i),Ce(()=>{const n=this._factories.get(e);!n||n!==i||(this._factories.delete(e),n.dispose())})}async getOrCreate(e){const t=this.get(e);if(t)return t;const i=this._factories.get(e);return!i||i.isResolved?null:(await i.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;const i=this._factories.get(e);return!!(!i||i.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}};class ree extends B{get isResolved(){return this._isResolved}constructor(e,t,i){super(),this._registry=e,this._languageId=t,this._factory=i,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){const e=await this._factory.tokenizationSupport;this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))}}let zb=class{constructor(e,t,i){this.offset=e,this.type=t,this.language=i,this._tokenBrand=void 0}toString(){return"("+this.offset+", "+this.type+")"}};class FP{constructor(e,t){this.tokens=e,this.endState=t,this._tokenizationResultBrand=void 0}}class _L{constructor(e,t){this.tokens=e,this.endState=t,this._encodedTokenizationResultBrand=void 0}}var oo;(function(s){s[s.Increase=0]="Increase",s[s.Decrease=1]="Decrease"})(oo||(oo={}));var Ub;(function(s){const e=new Map;e.set(0,J.symbolMethod),e.set(1,J.symbolFunction),e.set(2,J.symbolConstructor),e.set(3,J.symbolField),e.set(4,J.symbolVariable),e.set(5,J.symbolClass),e.set(6,J.symbolStruct),e.set(7,J.symbolInterface),e.set(8,J.symbolModule),e.set(9,J.symbolProperty),e.set(10,J.symbolEvent),e.set(11,J.symbolOperator),e.set(12,J.symbolUnit),e.set(13,J.symbolValue),e.set(15,J.symbolEnum),e.set(14,J.symbolConstant),e.set(15,J.symbolEnum),e.set(16,J.symbolEnumMember),e.set(17,J.symbolKeyword),e.set(27,J.symbolSnippet),e.set(18,J.symbolText),e.set(19,J.symbolColor),e.set(20,J.symbolFile),e.set(21,J.symbolReference),e.set(22,J.symbolCustomColor),e.set(23,J.symbolFolder),e.set(24,J.symbolTypeParameter),e.set(25,J.account),e.set(26,J.issues);function t(o){let r=e.get(o);return r||(console.info("No codicon found for CompletionItemKind "+o),r=J.symbolProperty),r}s.toIcon=t;const i=new Map;i.set("method",0),i.set("function",1),i.set("constructor",2),i.set("field",3),i.set("variable",4),i.set("class",5),i.set("struct",6),i.set("interface",7),i.set("module",8),i.set("property",9),i.set("event",10),i.set("operator",11),i.set("unit",12),i.set("value",13),i.set("constant",14),i.set("enum",15),i.set("enum-member",16),i.set("enumMember",16),i.set("keyword",17),i.set("snippet",27),i.set("text",18),i.set("color",19),i.set("file",20),i.set("reference",21),i.set("customcolor",22),i.set("folder",23),i.set("type-parameter",24),i.set("typeParameter",24),i.set("account",25),i.set("issue",26);function n(o,r){let a=i.get(o);return typeof a>"u"&&!r&&(a=9),a}s.fromString=n})(Ub||(Ub={}));var Ea;(function(s){s[s.Automatic=0]="Automatic",s[s.Explicit=1]="Explicit"})(Ea||(Ea={}));class w6{constructor(e,t,i,n){this.range=e,this.text=t,this.completionKind=i,this.isSnippetText=n}equals(e){return k.lift(this.range).equalsRange(e.range)&&this.text===e.text&&this.completionKind===e.completionKind&&this.isSnippetText===e.isSnippetText}}var $b;(function(s){s[s.Automatic=0]="Automatic",s[s.PasteAs=1]="PasteAs"})($b||($b={}));var Ll;(function(s){s[s.Invoke=1]="Invoke",s[s.TriggerCharacter=2]="TriggerCharacter",s[s.ContentChange=3]="ContentChange"})(Ll||(Ll={}));var wp;(function(s){s[s.Text=0]="Text",s[s.Read=1]="Read",s[s.Write=2]="Write"})(wp||(wp={}));function aee(s){return s&&Se.isUri(s.uri)&&k.isIRange(s.range)&&(k.isIRange(s.originSelectionRange)||k.isIRange(s.targetSelectionRange))}const lee={17:p("Array","array"),16:p("Boolean","boolean"),4:p("Class","class"),13:p("Constant","constant"),8:p("Constructor","constructor"),9:p("Enum","enumeration"),21:p("EnumMember","enumeration member"),23:p("Event","event"),7:p("Field","field"),0:p("File","file"),11:p("Function","function"),10:p("Interface","interface"),19:p("Key","key"),5:p("Method","method"),1:p("Module","module"),2:p("Namespace","namespace"),20:p("Null","null"),15:p("Number","number"),18:p("Object","object"),24:p("Operator","operator"),3:p("Package","package"),6:p("Property","property"),14:p("String","string"),22:p("Struct","struct"),25:p("TypeParameter","type parameter"),12:p("Variable","variable")};function cee(s,e){return p("symbolAriaLabel","{0} ({1})",s,lee[e])}var M1;(function(s){const e=new Map;e.set(0,J.symbolFile),e.set(1,J.symbolModule),e.set(2,J.symbolNamespace),e.set(3,J.symbolPackage),e.set(4,J.symbolClass),e.set(5,J.symbolMethod),e.set(6,J.symbolProperty),e.set(7,J.symbolField),e.set(8,J.symbolConstructor),e.set(9,J.symbolEnum),e.set(10,J.symbolInterface),e.set(11,J.symbolFunction),e.set(12,J.symbolVariable),e.set(13,J.symbolConstant),e.set(14,J.symbolString),e.set(15,J.symbolNumber),e.set(16,J.symbolBoolean),e.set(17,J.symbolArray),e.set(18,J.symbolObject),e.set(19,J.symbolKey),e.set(20,J.symbolNull),e.set(21,J.symbolEnumMember),e.set(22,J.symbolStruct),e.set(23,J.symbolEvent),e.set(24,J.symbolOperator),e.set(25,J.symbolTypeParameter);function t(i){let n=e.get(i);return n||(console.info("No codicon found for SymbolKind "+i),n=J.symbolProperty),n}s.toIcon=t})(M1||(M1={}));class Eo{static{this.Comment=new Eo("comment")}static{this.Imports=new Eo("imports")}static{this.Region=new Eo("region")}static fromValue(e){switch(e){case"comment":return Eo.Comment;case"imports":return Eo.Imports;case"region":return Eo.Region}return new Eo(e)}constructor(e){this.value=e}}var sT;(function(s){s[s.AIGenerated=1]="AIGenerated"})(sT||(sT={}));var jb;(function(s){s[s.Invoke=0]="Invoke",s[s.Automatic=1]="Automatic"})(jb||(jb={}));var oT;(function(s){function e(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}s.is=e})(oT||(oT={}));var A1;(function(s){s[s.Type=1]="Type",s[s.Parameter=2]="Parameter"})(A1||(A1={}));class dee{constructor(e){this.createSupport=e,this._tokenizationSupport=null}dispose(){this._tokenizationSupport&&this._tokenizationSupport.then(e=>{e&&e.dispose()})}get tokenizationSupport(){return this._tokenizationSupport||(this._tokenizationSupport=this.createSupport()),this._tokenizationSupport}}const mi=new y6,rT=new y6;var P1;(function(s){s[s.Invoke=0]="Invoke",s[s.Automatic=1]="Automatic"})(P1||(P1={}));var aT;(function(s){s[s.Unknown=0]="Unknown",s[s.Disabled=1]="Disabled",s[s.Enabled=2]="Enabled"})(aT||(aT={}));var lT;(function(s){s[s.Invoke=1]="Invoke",s[s.Auto=2]="Auto"})(lT||(lT={}));var cT;(function(s){s[s.None=0]="None",s[s.KeepWhitespace=1]="KeepWhitespace",s[s.InsertAsSnippet=4]="InsertAsSnippet"})(cT||(cT={}));var dT;(function(s){s[s.Method=0]="Method",s[s.Function=1]="Function",s[s.Constructor=2]="Constructor",s[s.Field=3]="Field",s[s.Variable=4]="Variable",s[s.Class=5]="Class",s[s.Struct=6]="Struct",s[s.Interface=7]="Interface",s[s.Module=8]="Module",s[s.Property=9]="Property",s[s.Event=10]="Event",s[s.Operator=11]="Operator",s[s.Unit=12]="Unit",s[s.Value=13]="Value",s[s.Constant=14]="Constant",s[s.Enum=15]="Enum",s[s.EnumMember=16]="EnumMember",s[s.Keyword=17]="Keyword",s[s.Text=18]="Text",s[s.Color=19]="Color",s[s.File=20]="File",s[s.Reference=21]="Reference",s[s.Customcolor=22]="Customcolor",s[s.Folder=23]="Folder",s[s.TypeParameter=24]="TypeParameter",s[s.User=25]="User",s[s.Issue=26]="Issue",s[s.Snippet=27]="Snippet"})(dT||(dT={}));var hT;(function(s){s[s.Deprecated=1]="Deprecated"})(hT||(hT={}));var uT;(function(s){s[s.Invoke=0]="Invoke",s[s.TriggerCharacter=1]="TriggerCharacter",s[s.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(uT||(uT={}));var gT;(function(s){s[s.EXACT=0]="EXACT",s[s.ABOVE=1]="ABOVE",s[s.BELOW=2]="BELOW"})(gT||(gT={}));var fT;(function(s){s[s.NotSet=0]="NotSet",s[s.ContentFlush=1]="ContentFlush",s[s.RecoverFromMarkers=2]="RecoverFromMarkers",s[s.Explicit=3]="Explicit",s[s.Paste=4]="Paste",s[s.Undo=5]="Undo",s[s.Redo=6]="Redo"})(fT||(fT={}));var pT;(function(s){s[s.LF=1]="LF",s[s.CRLF=2]="CRLF"})(pT||(pT={}));var mT;(function(s){s[s.Text=0]="Text",s[s.Read=1]="Read",s[s.Write=2]="Write"})(mT||(mT={}));var _T;(function(s){s[s.None=0]="None",s[s.Keep=1]="Keep",s[s.Brackets=2]="Brackets",s[s.Advanced=3]="Advanced",s[s.Full=4]="Full"})(_T||(_T={}));var bT;(function(s){s[s.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",s[s.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",s[s.accessibilitySupport=2]="accessibilitySupport",s[s.accessibilityPageSize=3]="accessibilityPageSize",s[s.ariaLabel=4]="ariaLabel",s[s.ariaRequired=5]="ariaRequired",s[s.autoClosingBrackets=6]="autoClosingBrackets",s[s.autoClosingComments=7]="autoClosingComments",s[s.screenReaderAnnounceInlineSuggestion=8]="screenReaderAnnounceInlineSuggestion",s[s.autoClosingDelete=9]="autoClosingDelete",s[s.autoClosingOvertype=10]="autoClosingOvertype",s[s.autoClosingQuotes=11]="autoClosingQuotes",s[s.autoIndent=12]="autoIndent",s[s.automaticLayout=13]="automaticLayout",s[s.autoSurround=14]="autoSurround",s[s.bracketPairColorization=15]="bracketPairColorization",s[s.guides=16]="guides",s[s.codeLens=17]="codeLens",s[s.codeLensFontFamily=18]="codeLensFontFamily",s[s.codeLensFontSize=19]="codeLensFontSize",s[s.colorDecorators=20]="colorDecorators",s[s.colorDecoratorsLimit=21]="colorDecoratorsLimit",s[s.columnSelection=22]="columnSelection",s[s.comments=23]="comments",s[s.contextmenu=24]="contextmenu",s[s.copyWithSyntaxHighlighting=25]="copyWithSyntaxHighlighting",s[s.cursorBlinking=26]="cursorBlinking",s[s.cursorSmoothCaretAnimation=27]="cursorSmoothCaretAnimation",s[s.cursorStyle=28]="cursorStyle",s[s.cursorSurroundingLines=29]="cursorSurroundingLines",s[s.cursorSurroundingLinesStyle=30]="cursorSurroundingLinesStyle",s[s.cursorWidth=31]="cursorWidth",s[s.disableLayerHinting=32]="disableLayerHinting",s[s.disableMonospaceOptimizations=33]="disableMonospaceOptimizations",s[s.domReadOnly=34]="domReadOnly",s[s.dragAndDrop=35]="dragAndDrop",s[s.dropIntoEditor=36]="dropIntoEditor",s[s.emptySelectionClipboard=37]="emptySelectionClipboard",s[s.experimentalWhitespaceRendering=38]="experimentalWhitespaceRendering",s[s.extraEditorClassName=39]="extraEditorClassName",s[s.fastScrollSensitivity=40]="fastScrollSensitivity",s[s.find=41]="find",s[s.fixedOverflowWidgets=42]="fixedOverflowWidgets",s[s.folding=43]="folding",s[s.foldingStrategy=44]="foldingStrategy",s[s.foldingHighlight=45]="foldingHighlight",s[s.foldingImportsByDefault=46]="foldingImportsByDefault",s[s.foldingMaximumRegions=47]="foldingMaximumRegions",s[s.unfoldOnClickAfterEndOfLine=48]="unfoldOnClickAfterEndOfLine",s[s.fontFamily=49]="fontFamily",s[s.fontInfo=50]="fontInfo",s[s.fontLigatures=51]="fontLigatures",s[s.fontSize=52]="fontSize",s[s.fontWeight=53]="fontWeight",s[s.fontVariations=54]="fontVariations",s[s.formatOnPaste=55]="formatOnPaste",s[s.formatOnType=56]="formatOnType",s[s.glyphMargin=57]="glyphMargin",s[s.gotoLocation=58]="gotoLocation",s[s.hideCursorInOverviewRuler=59]="hideCursorInOverviewRuler",s[s.hover=60]="hover",s[s.inDiffEditor=61]="inDiffEditor",s[s.inlineSuggest=62]="inlineSuggest",s[s.inlineEdit=63]="inlineEdit",s[s.letterSpacing=64]="letterSpacing",s[s.lightbulb=65]="lightbulb",s[s.lineDecorationsWidth=66]="lineDecorationsWidth",s[s.lineHeight=67]="lineHeight",s[s.lineNumbers=68]="lineNumbers",s[s.lineNumbersMinChars=69]="lineNumbersMinChars",s[s.linkedEditing=70]="linkedEditing",s[s.links=71]="links",s[s.matchBrackets=72]="matchBrackets",s[s.minimap=73]="minimap",s[s.mouseStyle=74]="mouseStyle",s[s.mouseWheelScrollSensitivity=75]="mouseWheelScrollSensitivity",s[s.mouseWheelZoom=76]="mouseWheelZoom",s[s.multiCursorMergeOverlapping=77]="multiCursorMergeOverlapping",s[s.multiCursorModifier=78]="multiCursorModifier",s[s.multiCursorPaste=79]="multiCursorPaste",s[s.multiCursorLimit=80]="multiCursorLimit",s[s.occurrencesHighlight=81]="occurrencesHighlight",s[s.overviewRulerBorder=82]="overviewRulerBorder",s[s.overviewRulerLanes=83]="overviewRulerLanes",s[s.padding=84]="padding",s[s.pasteAs=85]="pasteAs",s[s.parameterHints=86]="parameterHints",s[s.peekWidgetDefaultFocus=87]="peekWidgetDefaultFocus",s[s.placeholder=88]="placeholder",s[s.definitionLinkOpensInPeek=89]="definitionLinkOpensInPeek",s[s.quickSuggestions=90]="quickSuggestions",s[s.quickSuggestionsDelay=91]="quickSuggestionsDelay",s[s.readOnly=92]="readOnly",s[s.readOnlyMessage=93]="readOnlyMessage",s[s.renameOnType=94]="renameOnType",s[s.renderControlCharacters=95]="renderControlCharacters",s[s.renderFinalNewline=96]="renderFinalNewline",s[s.renderLineHighlight=97]="renderLineHighlight",s[s.renderLineHighlightOnlyWhenFocus=98]="renderLineHighlightOnlyWhenFocus",s[s.renderValidationDecorations=99]="renderValidationDecorations",s[s.renderWhitespace=100]="renderWhitespace",s[s.revealHorizontalRightPadding=101]="revealHorizontalRightPadding",s[s.roundedSelection=102]="roundedSelection",s[s.rulers=103]="rulers",s[s.scrollbar=104]="scrollbar",s[s.scrollBeyondLastColumn=105]="scrollBeyondLastColumn",s[s.scrollBeyondLastLine=106]="scrollBeyondLastLine",s[s.scrollPredominantAxis=107]="scrollPredominantAxis",s[s.selectionClipboard=108]="selectionClipboard",s[s.selectionHighlight=109]="selectionHighlight",s[s.selectOnLineNumbers=110]="selectOnLineNumbers",s[s.showFoldingControls=111]="showFoldingControls",s[s.showUnused=112]="showUnused",s[s.snippetSuggestions=113]="snippetSuggestions",s[s.smartSelect=114]="smartSelect",s[s.smoothScrolling=115]="smoothScrolling",s[s.stickyScroll=116]="stickyScroll",s[s.stickyTabStops=117]="stickyTabStops",s[s.stopRenderingLineAfter=118]="stopRenderingLineAfter",s[s.suggest=119]="suggest",s[s.suggestFontSize=120]="suggestFontSize",s[s.suggestLineHeight=121]="suggestLineHeight",s[s.suggestOnTriggerCharacters=122]="suggestOnTriggerCharacters",s[s.suggestSelection=123]="suggestSelection",s[s.tabCompletion=124]="tabCompletion",s[s.tabIndex=125]="tabIndex",s[s.unicodeHighlighting=126]="unicodeHighlighting",s[s.unusualLineTerminators=127]="unusualLineTerminators",s[s.useShadowDOM=128]="useShadowDOM",s[s.useTabStops=129]="useTabStops",s[s.wordBreak=130]="wordBreak",s[s.wordSegmenterLocales=131]="wordSegmenterLocales",s[s.wordSeparators=132]="wordSeparators",s[s.wordWrap=133]="wordWrap",s[s.wordWrapBreakAfterCharacters=134]="wordWrapBreakAfterCharacters",s[s.wordWrapBreakBeforeCharacters=135]="wordWrapBreakBeforeCharacters",s[s.wordWrapColumn=136]="wordWrapColumn",s[s.wordWrapOverride1=137]="wordWrapOverride1",s[s.wordWrapOverride2=138]="wordWrapOverride2",s[s.wrappingIndent=139]="wrappingIndent",s[s.wrappingStrategy=140]="wrappingStrategy",s[s.showDeprecated=141]="showDeprecated",s[s.inlayHints=142]="inlayHints",s[s.editorClassName=143]="editorClassName",s[s.pixelRatio=144]="pixelRatio",s[s.tabFocusMode=145]="tabFocusMode",s[s.layoutInfo=146]="layoutInfo",s[s.wrappingInfo=147]="wrappingInfo",s[s.defaultColorDecorators=148]="defaultColorDecorators",s[s.colorDecoratorsActivatedOn=149]="colorDecoratorsActivatedOn",s[s.inlineCompletionsAccessibilityVerbose=150]="inlineCompletionsAccessibilityVerbose"})(bT||(bT={}));var vT;(function(s){s[s.TextDefined=0]="TextDefined",s[s.LF=1]="LF",s[s.CRLF=2]="CRLF"})(vT||(vT={}));var CT;(function(s){s[s.LF=0]="LF",s[s.CRLF=1]="CRLF"})(CT||(CT={}));var yT;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=3]="Right"})(yT||(yT={}));var wT;(function(s){s[s.Increase=0]="Increase",s[s.Decrease=1]="Decrease"})(wT||(wT={}));var ST;(function(s){s[s.None=0]="None",s[s.Indent=1]="Indent",s[s.IndentOutdent=2]="IndentOutdent",s[s.Outdent=3]="Outdent"})(ST||(ST={}));var LT;(function(s){s[s.Both=0]="Both",s[s.Right=1]="Right",s[s.Left=2]="Left",s[s.None=3]="None"})(LT||(LT={}));var xT;(function(s){s[s.Type=1]="Type",s[s.Parameter=2]="Parameter"})(xT||(xT={}));var kT;(function(s){s[s.Automatic=0]="Automatic",s[s.Explicit=1]="Explicit"})(kT||(kT={}));var DT;(function(s){s[s.Invoke=0]="Invoke",s[s.Automatic=1]="Automatic"})(DT||(DT={}));var IT;(function(s){s[s.DependsOnKbLayout=-1]="DependsOnKbLayout",s[s.Unknown=0]="Unknown",s[s.Backspace=1]="Backspace",s[s.Tab=2]="Tab",s[s.Enter=3]="Enter",s[s.Shift=4]="Shift",s[s.Ctrl=5]="Ctrl",s[s.Alt=6]="Alt",s[s.PauseBreak=7]="PauseBreak",s[s.CapsLock=8]="CapsLock",s[s.Escape=9]="Escape",s[s.Space=10]="Space",s[s.PageUp=11]="PageUp",s[s.PageDown=12]="PageDown",s[s.End=13]="End",s[s.Home=14]="Home",s[s.LeftArrow=15]="LeftArrow",s[s.UpArrow=16]="UpArrow",s[s.RightArrow=17]="RightArrow",s[s.DownArrow=18]="DownArrow",s[s.Insert=19]="Insert",s[s.Delete=20]="Delete",s[s.Digit0=21]="Digit0",s[s.Digit1=22]="Digit1",s[s.Digit2=23]="Digit2",s[s.Digit3=24]="Digit3",s[s.Digit4=25]="Digit4",s[s.Digit5=26]="Digit5",s[s.Digit6=27]="Digit6",s[s.Digit7=28]="Digit7",s[s.Digit8=29]="Digit8",s[s.Digit9=30]="Digit9",s[s.KeyA=31]="KeyA",s[s.KeyB=32]="KeyB",s[s.KeyC=33]="KeyC",s[s.KeyD=34]="KeyD",s[s.KeyE=35]="KeyE",s[s.KeyF=36]="KeyF",s[s.KeyG=37]="KeyG",s[s.KeyH=38]="KeyH",s[s.KeyI=39]="KeyI",s[s.KeyJ=40]="KeyJ",s[s.KeyK=41]="KeyK",s[s.KeyL=42]="KeyL",s[s.KeyM=43]="KeyM",s[s.KeyN=44]="KeyN",s[s.KeyO=45]="KeyO",s[s.KeyP=46]="KeyP",s[s.KeyQ=47]="KeyQ",s[s.KeyR=48]="KeyR",s[s.KeyS=49]="KeyS",s[s.KeyT=50]="KeyT",s[s.KeyU=51]="KeyU",s[s.KeyV=52]="KeyV",s[s.KeyW=53]="KeyW",s[s.KeyX=54]="KeyX",s[s.KeyY=55]="KeyY",s[s.KeyZ=56]="KeyZ",s[s.Meta=57]="Meta",s[s.ContextMenu=58]="ContextMenu",s[s.F1=59]="F1",s[s.F2=60]="F2",s[s.F3=61]="F3",s[s.F4=62]="F4",s[s.F5=63]="F5",s[s.F6=64]="F6",s[s.F7=65]="F7",s[s.F8=66]="F8",s[s.F9=67]="F9",s[s.F10=68]="F10",s[s.F11=69]="F11",s[s.F12=70]="F12",s[s.F13=71]="F13",s[s.F14=72]="F14",s[s.F15=73]="F15",s[s.F16=74]="F16",s[s.F17=75]="F17",s[s.F18=76]="F18",s[s.F19=77]="F19",s[s.F20=78]="F20",s[s.F21=79]="F21",s[s.F22=80]="F22",s[s.F23=81]="F23",s[s.F24=82]="F24",s[s.NumLock=83]="NumLock",s[s.ScrollLock=84]="ScrollLock",s[s.Semicolon=85]="Semicolon",s[s.Equal=86]="Equal",s[s.Comma=87]="Comma",s[s.Minus=88]="Minus",s[s.Period=89]="Period",s[s.Slash=90]="Slash",s[s.Backquote=91]="Backquote",s[s.BracketLeft=92]="BracketLeft",s[s.Backslash=93]="Backslash",s[s.BracketRight=94]="BracketRight",s[s.Quote=95]="Quote",s[s.OEM_8=96]="OEM_8",s[s.IntlBackslash=97]="IntlBackslash",s[s.Numpad0=98]="Numpad0",s[s.Numpad1=99]="Numpad1",s[s.Numpad2=100]="Numpad2",s[s.Numpad3=101]="Numpad3",s[s.Numpad4=102]="Numpad4",s[s.Numpad5=103]="Numpad5",s[s.Numpad6=104]="Numpad6",s[s.Numpad7=105]="Numpad7",s[s.Numpad8=106]="Numpad8",s[s.Numpad9=107]="Numpad9",s[s.NumpadMultiply=108]="NumpadMultiply",s[s.NumpadAdd=109]="NumpadAdd",s[s.NUMPAD_SEPARATOR=110]="NUMPAD_SEPARATOR",s[s.NumpadSubtract=111]="NumpadSubtract",s[s.NumpadDecimal=112]="NumpadDecimal",s[s.NumpadDivide=113]="NumpadDivide",s[s.KEY_IN_COMPOSITION=114]="KEY_IN_COMPOSITION",s[s.ABNT_C1=115]="ABNT_C1",s[s.ABNT_C2=116]="ABNT_C2",s[s.AudioVolumeMute=117]="AudioVolumeMute",s[s.AudioVolumeUp=118]="AudioVolumeUp",s[s.AudioVolumeDown=119]="AudioVolumeDown",s[s.BrowserSearch=120]="BrowserSearch",s[s.BrowserHome=121]="BrowserHome",s[s.BrowserBack=122]="BrowserBack",s[s.BrowserForward=123]="BrowserForward",s[s.MediaTrackNext=124]="MediaTrackNext",s[s.MediaTrackPrevious=125]="MediaTrackPrevious",s[s.MediaStop=126]="MediaStop",s[s.MediaPlayPause=127]="MediaPlayPause",s[s.LaunchMediaPlayer=128]="LaunchMediaPlayer",s[s.LaunchMail=129]="LaunchMail",s[s.LaunchApp2=130]="LaunchApp2",s[s.Clear=131]="Clear",s[s.MAX_VALUE=132]="MAX_VALUE"})(IT||(IT={}));var TT;(function(s){s[s.Hint=1]="Hint",s[s.Info=2]="Info",s[s.Warning=4]="Warning",s[s.Error=8]="Error"})(TT||(TT={}));var ET;(function(s){s[s.Unnecessary=1]="Unnecessary",s[s.Deprecated=2]="Deprecated"})(ET||(ET={}));var NT;(function(s){s[s.Inline=1]="Inline",s[s.Gutter=2]="Gutter"})(NT||(NT={}));var RT;(function(s){s[s.Normal=1]="Normal",s[s.Underlined=2]="Underlined"})(RT||(RT={}));var MT;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.TEXTAREA=1]="TEXTAREA",s[s.GUTTER_GLYPH_MARGIN=2]="GUTTER_GLYPH_MARGIN",s[s.GUTTER_LINE_NUMBERS=3]="GUTTER_LINE_NUMBERS",s[s.GUTTER_LINE_DECORATIONS=4]="GUTTER_LINE_DECORATIONS",s[s.GUTTER_VIEW_ZONE=5]="GUTTER_VIEW_ZONE",s[s.CONTENT_TEXT=6]="CONTENT_TEXT",s[s.CONTENT_EMPTY=7]="CONTENT_EMPTY",s[s.CONTENT_VIEW_ZONE=8]="CONTENT_VIEW_ZONE",s[s.CONTENT_WIDGET=9]="CONTENT_WIDGET",s[s.OVERVIEW_RULER=10]="OVERVIEW_RULER",s[s.SCROLLBAR=11]="SCROLLBAR",s[s.OVERLAY_WIDGET=12]="OVERLAY_WIDGET",s[s.OUTSIDE_EDITOR=13]="OUTSIDE_EDITOR"})(MT||(MT={}));var AT;(function(s){s[s.AIGenerated=1]="AIGenerated"})(AT||(AT={}));var PT;(function(s){s[s.Invoke=0]="Invoke",s[s.Automatic=1]="Automatic"})(PT||(PT={}));var OT;(function(s){s[s.TOP_RIGHT_CORNER=0]="TOP_RIGHT_CORNER",s[s.BOTTOM_RIGHT_CORNER=1]="BOTTOM_RIGHT_CORNER",s[s.TOP_CENTER=2]="TOP_CENTER"})(OT||(OT={}));var FT;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=4]="Right",s[s.Full=7]="Full"})(FT||(FT={}));var BT;(function(s){s[s.Word=0]="Word",s[s.Line=1]="Line",s[s.Suggest=2]="Suggest"})(BT||(BT={}));var WT;(function(s){s[s.Left=0]="Left",s[s.Right=1]="Right",s[s.None=2]="None",s[s.LeftOfInjectedText=3]="LeftOfInjectedText",s[s.RightOfInjectedText=4]="RightOfInjectedText"})(WT||(WT={}));var HT;(function(s){s[s.Off=0]="Off",s[s.On=1]="On",s[s.Relative=2]="Relative",s[s.Interval=3]="Interval",s[s.Custom=4]="Custom"})(HT||(HT={}));var VT;(function(s){s[s.None=0]="None",s[s.Text=1]="Text",s[s.Blocks=2]="Blocks"})(VT||(VT={}));var zT;(function(s){s[s.Smooth=0]="Smooth",s[s.Immediate=1]="Immediate"})(zT||(zT={}));var UT;(function(s){s[s.Auto=1]="Auto",s[s.Hidden=2]="Hidden",s[s.Visible=3]="Visible"})(UT||(UT={}));var $T;(function(s){s[s.LTR=0]="LTR",s[s.RTL=1]="RTL"})($T||($T={}));var jT;(function(s){s.Off="off",s.OnCode="onCode",s.On="on"})(jT||(jT={}));var ZT;(function(s){s[s.Invoke=1]="Invoke",s[s.TriggerCharacter=2]="TriggerCharacter",s[s.ContentChange=3]="ContentChange"})(ZT||(ZT={}));var KT;(function(s){s[s.File=0]="File",s[s.Module=1]="Module",s[s.Namespace=2]="Namespace",s[s.Package=3]="Package",s[s.Class=4]="Class",s[s.Method=5]="Method",s[s.Property=6]="Property",s[s.Field=7]="Field",s[s.Constructor=8]="Constructor",s[s.Enum=9]="Enum",s[s.Interface=10]="Interface",s[s.Function=11]="Function",s[s.Variable=12]="Variable",s[s.Constant=13]="Constant",s[s.String=14]="String",s[s.Number=15]="Number",s[s.Boolean=16]="Boolean",s[s.Array=17]="Array",s[s.Object=18]="Object",s[s.Key=19]="Key",s[s.Null=20]="Null",s[s.EnumMember=21]="EnumMember",s[s.Struct=22]="Struct",s[s.Event=23]="Event",s[s.Operator=24]="Operator",s[s.TypeParameter=25]="TypeParameter"})(KT||(KT={}));var qT;(function(s){s[s.Deprecated=1]="Deprecated"})(qT||(qT={}));var GT;(function(s){s[s.Hidden=0]="Hidden",s[s.Blink=1]="Blink",s[s.Smooth=2]="Smooth",s[s.Phase=3]="Phase",s[s.Expand=4]="Expand",s[s.Solid=5]="Solid"})(GT||(GT={}));var YT;(function(s){s[s.Line=1]="Line",s[s.Block=2]="Block",s[s.Underline=3]="Underline",s[s.LineThin=4]="LineThin",s[s.BlockOutline=5]="BlockOutline",s[s.UnderlineThin=6]="UnderlineThin"})(YT||(YT={}));var XT;(function(s){s[s.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",s[s.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",s[s.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",s[s.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"})(XT||(XT={}));var QT;(function(s){s[s.None=0]="None",s[s.Same=1]="Same",s[s.Indent=2]="Indent",s[s.DeepIndent=3]="DeepIndent"})(QT||(QT={}));let hee=class{static{this.CtrlCmd=2048}static{this.Shift=1024}static{this.Alt=512}static{this.WinCtrl=256}static chord(e,t){return Hi(e,t)}};function S6(){return{editor:void 0,languages:void 0,CancellationTokenSource:li,Emitter:O,KeyCode:IT,KeyMod:hee,Position:P,Range:k,Selection:me,SelectionDirection:$T,MarkerSeverity:TT,MarkerTag:ET,Uri:Se,Token:zb}}function uee(s,e){const t=s;typeof t.vscodeWindowId!="number"&&Object.defineProperty(t,"vscodeWindowId",{get:()=>e})}const Nt=window;function L6(s){return s}class gee{constructor(e,t){this.lastCache=void 0,this.lastArgKey=void 0,typeof e=="function"?(this._fn=e,this._computeKey=L6):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){const t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}}class R5{get cachedValues(){return this._map}constructor(e,t){this._map=new Map,this._map2=new Map,typeof e=="function"?(this._fn=e,this._computeKey=L6):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){const t=this._computeKey(e);if(this._map2.has(t))return this._map2.get(t);const i=this._fn(e);return this._map.set(e,i),this._map2.set(t,i),i}}class Fa{constructor(e){this.executor=e,this._didRun=!1}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}function x6(s){return!s||typeof s!="string"?!0:s.trim().length===0}const fee=/{(\d+)}/g;function zu(s,...e){return e.length===0?s:s.replace(fee,function(t,i){const n=parseInt(i,10);return isNaN(n)||n<0||n>=e.length?t:e[n]})}function pee(s){return s.replace(/[<>"'&]/g,e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return e})}function K_(s){return s.replace(/[<>&]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return e}})}function Uo(s){return s.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function mee(s,e=" "){const t=_C(s,e);return k6(t,e)}function _C(s,e){if(!s||!e)return s;const t=e.length;if(t===0||s.length===0)return s;let i=0;for(;s.indexOf(e,i)===i;)i=i+t;return s.substring(i)}function k6(s,e){if(!s||!e)return s;const t=e.length,i=s.length;if(t===0||i===0)return s;let n=i,o=-1;for(;o=s.lastIndexOf(e,n-1),!(o===-1||o+t!==n);){if(o===0)return"";n=o}return s.substring(0,n)}function _ee(s){return s.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*")}function bee(s){return s.replace(/\*/g,"")}function D6(s,e,t={}){if(!s)throw new Error("Cannot create regex from empty string");e||(s=Uo(s)),t.wholeWord&&(/\B/.test(s.charAt(0))||(s="\\b"+s),/\B/.test(s.charAt(s.length-1))||(s=s+"\\b"));let i="";return t.global&&(i+="g"),t.matchCase||(i+="i"),t.multiline&&(i+="m"),t.unicode&&(i+="u"),new RegExp(s,i)}function vee(s){return s.source==="^"||s.source==="^$"||s.source==="$"||s.source==="^\\s*$"?!1:!!(s.exec("")&&s.lastIndex===0)}function Fl(s){return s.split(/\r\n|\r|\n/)}function Cee(s){const e=[],t=s.split(/(\r\n|\r|\n)/);for(let i=0;i<Math.ceil(t.length/2);i++)e.push(t[2*i]+(t[2*i+1]??""));return e}function rs(s){for(let e=0,t=s.length;e<t;e++){const i=s.charCodeAt(e);if(i!==32&&i!==9)return e}return-1}function Mt(s,e=0,t=s.length){for(let i=e;i<t;i++){const n=s.charCodeAt(i);if(n!==32&&n!==9)return s.substring(e,i)}return s.substring(e,t)}function Na(s,e=s.length-1){for(let t=e;t>=0;t--){const i=s.charCodeAt(t);if(i!==32&&i!==9)return t}return-1}function Zb(s,e){return s<e?-1:s>e?1:0}function BP(s,e,t=0,i=s.length,n=0,o=e.length){for(;t<i&&n<o;t++,n++){const l=s.charCodeAt(t),c=e.charCodeAt(n);if(l<c)return-1;if(l>c)return 1}const r=i-t,a=o-n;return r<a?-1:r>a?1:0}function JT(s,e){return bC(s,e,0,s.length,0,e.length)}function bC(s,e,t=0,i=s.length,n=0,o=e.length){for(;t<i&&n<o;t++,n++){let l=s.charCodeAt(t),c=e.charCodeAt(n);if(l===c)continue;if(l>=128||c>=128)return BP(s.toLowerCase(),e.toLowerCase(),t,i,n,o);Td(l)&&(l-=32),Td(c)&&(c-=32);const d=l-c;if(d!==0)return d}const r=i-t,a=o-n;return r<a?-1:r>a?1:0}function _y(s){return s>=48&&s<=57}function Td(s){return s>=97&&s<=122}function gl(s){return s>=65&&s<=90}function Cf(s,e){return s.length===e.length&&bC(s,e)===0}function WP(s,e){const t=e.length;return e.length>s.length?!1:bC(s,e,0,t)===0}function th(s,e){const t=Math.min(s.length,e.length);let i;for(i=0;i<t;i++)if(s.charCodeAt(i)!==e.charCodeAt(i))return i;return t}function O1(s,e){const t=Math.min(s.length,e.length);let i;const n=s.length-1,o=e.length-1;for(i=0;i<t;i++)if(s.charCodeAt(n-i)!==e.charCodeAt(o-i))return i;return t}function Qi(s){return 55296<=s&&s<=56319}function Uu(s){return 56320<=s&&s<=57343}function HP(s,e){return(s-55296<<10)+(e-56320)+65536}function F1(s,e,t){const i=s.charCodeAt(t);if(Qi(i)&&t+1<e){const n=s.charCodeAt(t+1);if(Uu(n))return HP(i,n)}return i}function yee(s,e){const t=s.charCodeAt(e-1);if(Uu(t)&&e>1){const i=s.charCodeAt(e-2);if(Qi(i))return HP(i,t)}return t}class VP{get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){const e=yee(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){const e=F1(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}}class B1{get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new VP(e,t)}nextGraphemeLength(){const e=mu.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){const o=t.offset,r=e.getGraphemeBreakType(t.nextCodePoint());if(M5(n,r)){t.setOffset(o);break}n=r}return t.offset-i}prevGraphemeLength(){const e=mu.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){const o=t.offset,r=e.getGraphemeBreakType(t.prevCodePoint());if(M5(r,n)){t.setOffset(o);break}n=r}return i-t.offset}eol(){return this._iterator.eol()}}function zP(s,e){return new B1(s,e).nextGraphemeLength()}function I6(s,e){return new B1(s,e).prevGraphemeLength()}function wee(s,e){e>0&&Uu(s.charCodeAt(e))&&e--;const t=e+zP(s,e);return[t-I6(s,t),t]}let Pk;function See(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function Sp(s){return Pk||(Pk=See()),Pk.test(s)}const Lee=/^[\t\n\r\x20-\x7E]*$/;function vC(s){return Lee.test(s)}const T6=/[\u2028\u2029]/;function E6(s){return T6.test(s)}function ih(s){return s>=11904&&s<=55215||s>=63744&&s<=64255||s>=65281&&s<=65374}function UP(s){return s>=127462&&s<=127487||s===8986||s===8987||s===9200||s===9203||s>=9728&&s<=10175||s===11088||s===11093||s>=127744&&s<=128591||s>=128640&&s<=128764||s>=128992&&s<=129008||s>=129280&&s<=129535||s>=129648&&s<=129782}const xee="\uFEFF";function $P(s){return!!(s&&s.length>0&&s.charCodeAt(0)===65279)}function kee(s,e=!1){return s?(e&&(s=s.replace(/\\./g,"")),s.toLowerCase()!==s):!1}function N6(s){return s=s%(2*26),s<26?String.fromCharCode(97+s):String.fromCharCode(65+s-26)}function M5(s,e){return s===0?e!==5&&e!==7:s===2&&e===3?!1:s===4||s===2||s===3||e===4||e===2||e===3?!0:!(s===8&&(e===8||e===9||e===11||e===12)||(s===11||s===9)&&(e===9||e===10)||(s===12||s===10)&&e===10||e===5||e===13||e===7||s===1||s===13&&e===14||s===6&&e===6)}class mu{static{this._INSTANCE=null}static getInstance(){return mu._INSTANCE||(mu._INSTANCE=new mu),mu._INSTANCE}constructor(){this._data=Dee()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;const t=this._data,i=t.length/3;let n=1;for(;n<=i;)if(e<t[3*n])n=2*n;else if(e>t[3*n+1])n=2*n+1;else return t[3*n+2];return 0}}function Dee(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function Iee(s,e){if(s===0)return 0;const t=Tee(s,e);if(t!==void 0)return t;const i=new VP(e,s);return i.prevCodePoint(),i.offset}function Tee(s,e){const t=new VP(e,s);let i=t.prevCodePoint();for(;Eee(i)||i===65039||i===8419;){if(t.offset===0)return;i=t.prevCodePoint()}if(!UP(i))return;let n=t.offset;return n>0&&t.prevCodePoint()===8205&&(n=t.offset),n}function Eee(s){return 127995<=s&&s<=127999}const R6="";class Ed{static{this.ambiguousCharacterData=new Fa(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'))}static{this.cache=new gee({getCacheKey:JSON.stringify},e=>{function t(d){const h=new Map;for(let u=0;u<d.length;u+=2)h.set(d[u],d[u+1]);return h}function i(d,h){const u=new Map(d);for(const[g,f]of h)u.set(g,f);return u}function n(d,h){if(!d)return h;const u=new Map;for(const[g,f]of d)h.has(g)&&u.set(g,f);return u}const o=this.ambiguousCharacterData.value;let r=e.filter(d=>!d.startsWith("_")&&d in o);r.length===0&&(r=["_default"]);let a;for(const d of r){const h=t(o[d]);a=n(a,h)}const l=t(o._common),c=i(l,a);return new Ed(c)})}static getInstance(e){return Ed.cache.get(Array.from(e))}static{this._locales=new Fa(()=>Object.keys(Ed.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")))}static getLocales(){return Ed._locales.value}constructor(e){this.confusableDictionary=e}isAmbiguous(e){return this.confusableDictionary.has(e)}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}}class Tc{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static{this._data=void 0}static getData(){return this._data||(this._data=new Set(Tc.getRawData())),this._data}static isInvisibleCharacter(e){return Tc.getData().has(e)}static get codePoints(){return Tc.getData()}}class jP{constructor(){this.mapWindowIdToZoomFactor=new Map}static{this.INSTANCE=new jP}getZoomFactor(e){return this.mapWindowIdToZoomFactor.get(this.getWindowId(e))??1}getWindowId(e){return e.vscodeWindowId}}function M6(s,e,t){typeof e=="string"&&(e=s.matchMedia(e)),e.addEventListener("change",t)}function Nee(s){return jP.INSTANCE.getZoomFactor(s)}const fm=navigator.userAgent,vr=fm.indexOf("Firefox")>=0,xu=fm.indexOf("AppleWebKit")>=0,CC=fm.indexOf("Chrome")>=0,Fc=!CC&&fm.indexOf("Safari")>=0,A6=!CC&&!Fc&&xu;fm.indexOf("Electron/")>=0;const A5=fm.indexOf("Android")>=0;let Rw=!1;if(typeof Nt.matchMedia=="function"){const s=Nt.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),e=Nt.matchMedia("(display-mode: fullscreen)");Rw=s.matches,M6(Nt,s,({matches:t})=>{Rw&&e.matches||(Rw=t)})}function Ree(){return Rw}const ZP={clipboard:{writeText:Ia||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:Ia||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},keyboard:Ia||Ree()?0:navigator.keyboard||Fc?1:2,touch:"ontouchstart"in Nt||navigator.maxTouchPoints>0,pointerEvents:Nt.PointerEvent&&("ontouchstart"in Nt||navigator.maxTouchPoints>0)};function eE(s,e){if(typeof s=="number"){if(s===0)return null;const t=(s&65535)>>>0,i=(s&4294901760)>>>16;return i!==0?new Ok([by(t,e),by(i,e)]):new Ok([by(t,e)])}else{const t=[];for(let i=0;i<s.length;i++)t.push(by(s[i],e));return new Ok(t)}}function by(s,e){const t=!!(s&2048),i=!!(s&256),n=e===2?i:t,o=!!(s&1024),r=!!(s&512),a=e===2?t:i,l=s&255;return new Bc(n,o,r,a,l)}class Bc{constructor(e,t,i,n,o){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=n,this.keyCode=o}equals(e){return e instanceof Bc&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}}class Ok{constructor(e){if(e.length===0)throw mr("chords");this.chords=e}}class Mee{constructor(e,t,i,n,o,r){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=n,this.keyLabel=o,this.keyAriaLabel=r}}class Aee{}function Pee(s){if(s.charCode){const t=String.fromCharCode(s.charCode).toUpperCase();return fc.fromString(t)}const e=s.keyCode;if(e===3)return 7;if(vr)switch(e){case 59:return 85;case 60:if(ys)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(Qe)return 57;break}else if(xu){if(Qe&&e===93)return 57;if(!Qe&&e===92)return 57}return u6[e]||0}const Oee=Qe?256:2048,Fee=512,Bee=1024,Wee=Qe?2048:256;class Ft{constructor(e){this._standardKeyboardEventBrand=!0;const t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.altGraphKey=t.getModifierState?.("AltGraph"),this.keyCode=Pee(t),this.code=t.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=Oee),this.altKey&&(t|=Fee),this.shiftKey&&(t|=Bee),this.metaKey&&(t|=Wee),t|=e,t}_computeKeyCodeChord(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new Bc(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}}const P5=new WeakMap;function Hee(s){if(!s.parent||s.parent===s)return null;try{const e=s.location,t=s.parent.location;if(e.origin!=="null"&&t.origin!=="null"&&e.origin!==t.origin)return null}catch{return null}return s.parent}class Vee{static getSameOriginWindowChain(e){let t=P5.get(e);if(!t){t=[],P5.set(e,t);let i=e,n;do n=Hee(i),n?t.push({window:new WeakRef(i),iframeElement:i.frameElement||null}):t.push({window:new WeakRef(i),iframeElement:null}),i=n;while(i)}return t.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let i=0,n=0;const o=this.getSameOriginWindowChain(e);for(const r of o){const a=r.window.deref();if(i+=a?.scrollY??0,n+=a?.scrollX??0,a===t||!r.iframeElement)break;const l=r.iframeElement.getBoundingClientRect();i+=l.top,n+=l.left}return{top:i,left:n}}}class jr{constructor(e,t){this.timestamp=Date.now(),this.browserEvent=t,this.leftButton=t.button===0,this.middleButton=t.button===1,this.rightButton=t.button===2,this.buttons=t.buttons,this.target=t.target,this.detail=t.detail||1,t.type==="dblclick"&&(this.detail=2),this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,typeof t.pageX=="number"?(this.posx=t.pageX,this.posy=t.pageY):(this.posx=t.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=t.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);const i=Vee.getPositionOfChildWindowRelativeToAncestorWindow(e,t.view);this.posx-=i.left,this.posy-=i.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}}class $u{constructor(e,t=0,i=0){this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=i,this.deltaX=t;let n=!1;if(CC){const o=navigator.userAgent.match(/Chrome\/(\d+)/);n=(o?parseInt(o[1]):123)<=122}if(e){const o=e,r=e,a=e.view?.devicePixelRatio||1;if(typeof o.wheelDeltaY<"u")n?this.deltaY=o.wheelDeltaY/(120*a):this.deltaY=o.wheelDeltaY/120;else if(typeof r.VERTICAL_AXIS<"u"&&r.axis===r.VERTICAL_AXIS)this.deltaY=-r.detail/3;else if(e.type==="wheel"){const l=e;l.deltaMode===l.DOM_DELTA_LINE?vr&&!Qe?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof o.wheelDeltaX<"u")Fc&&An?this.deltaX=-(o.wheelDeltaX/120):n?this.deltaX=o.wheelDeltaX/(120*a):this.deltaX=o.wheelDeltaX/120;else if(typeof r.HORIZONTAL_AXIS<"u"&&r.axis===r.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){const l=e;l.deltaMode===l.DOM_DELTA_LINE?vr&&!Qe?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(n?this.deltaY=e.wheelDelta/(120*a):this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}}const P6=Symbol("MicrotaskDelay");function tE(s){return!!s&&typeof s.then=="function"}function en(s){const e=new li,t=s(e.token),i=new Promise((n,o)=>{const r=e.token.onCancellationRequested(()=>{r.dispose(),o(new Xr)});Promise.resolve(t).then(a=>{r.dispose(),e.dispose(),n(a)},a=>{r.dispose(),e.dispose(),o(a)})});return new class{cancel(){e.cancel(),e.dispose()}then(n,o){return i.then(n,o)}catch(n){return this.then(void 0,n)}finally(n){return i.finally(n)}}}function yC(s,e,t){return new Promise((i,n)=>{const o=e.onCancellationRequested(()=>{o.dispose(),i(t)});s.then(i,n).finally(()=>o.dispose())})}class zee{constructor(){this.isDisposed=!1,this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){const t=()=>{if(this.queuedPromise=null,this.isDisposed)return;const i=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,i};this.queuedPromise=new Promise(i=>{this.activePromise.then(t,t).then(i)})}return new Promise((t,i)=>{this.queuedPromise.then(t,i)})}return this.activePromise=e(),new Promise((t,i)=>{this.activePromise.then(n=>{this.activePromise=null,t(n)},n=>{this.activePromise=null,i(n)})})}dispose(){this.isDisposed=!0}}const Uee=(s,e)=>{let t=!0;const i=setTimeout(()=>{t=!1,e()},s);return{isTriggered:()=>t,dispose:()=>{clearTimeout(i),t=!1}}},$ee=s=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,s())}),{isTriggered:()=>e,dispose:()=>{e=!1}}};class Cr{constructor(e){this.defaultDelay=e,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((n,o)=>{this.doResolve=n,this.doReject=o}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const n=this.task;return this.task=null,n()}}));const i=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=t===P6?$ee(i):Uee(t,i),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new Xr),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}}class O6{constructor(e){this.delayer=new Cr(e),this.throttler=new zee}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}}function Wc(s,e){return e?new Promise((t,i)=>{const n=setTimeout(()=>{o.dispose(),t()},s),o=e.onCancellationRequested(()=>{clearTimeout(n),o.dispose(),i(new Xr)})}):en(t=>Wc(s,t))}function nh(s,e=0,t){const i=setTimeout(()=>{s(),t&&n.dispose()},e),n=Ce(()=>{clearTimeout(i),t?.deleteAndLeak(n)});return t?.add(n),n}function KP(s,e=i=>!!i,t=null){let i=0;const n=s.length,o=()=>{if(i>=n)return Promise.resolve(t);const r=s[i++];return Promise.resolve(r()).then(l=>e(l)?Promise.resolve(l):o())};return o()}class ia{constructor(e,t){this._isDisposed=!1,this._token=-1,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,t){if(this._isDisposed)throw new mt("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},t)}setIfNotSet(e,t){if(this._isDisposed)throw new mt("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},t))}}class qP{constructor(){this.disposable=void 0,this.isDisposed=!1}cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(e,t,i=globalThis){if(this.isDisposed)throw new mt("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();const n=i.setInterval(()=>{e()},t);this.disposable=Ce(()=>{i.clearInterval(n),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}}class It{constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}}let F6,q_;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?q_=(s,e)=>{i6(()=>{if(t)return;const i=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,i-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0)}}}:q_=(s,e,t)=>{const i=s.requestIdleCallback(e,typeof t=="number"?{timeout:t}:void 0);let n=!1;return{dispose(){n||(n=!0,s.cancelIdleCallback(i))}}},F6=s=>q_(globalThis,s)})();class B6{constructor(e,t){this._didRun=!1,this._executor=()=>{try{this._value=t()}catch(i){this._error=i}finally{this._didRun=!0}},this._handle=q_(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}class jee extends B6{constructor(e){super(globalThis,e)}}class pm{get isRejected(){return this.outcome?.outcome===1}get isSettled(){return!!this.outcome}constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new Xr)}}var iE;(function(s){async function e(i){let n;const o=await Promise.all(i.map(r=>r.then(a=>a,a=>{n||(n=a)})));if(typeof n<"u")throw n;return o}s.settled=e;function t(i){return new Promise(async(n,o)=>{try{await i(n,o)}catch(r){o(r)}})}s.withAsyncBody=t})(iE||(iE={}));class zi{static fromArray(e){return new zi(t=>{t.emitMany(e)})}static fromPromise(e){return new zi(async t=>{t.emitMany(await e)})}static fromPromises(e){return new zi(async t=>{await Promise.all(e.map(async i=>t.emitOne(await i)))})}static merge(e){return new zi(async t=>{await Promise.all(e.map(async i=>{for await(const n of i)t.emitOne(n)}))})}static{this.EMPTY=zi.fromArray([])}constructor(e,t){this._state=0,this._results=[],this._error=null,this._onReturn=t,this._onStateChanged=new O,queueMicrotask(async()=>{const i={emitOne:n=>this.emitOne(n),emitMany:n=>this.emitMany(n),reject:n=>this.reject(n)};try{await Promise.resolve(e(i)),this.resolve()}catch(n){this.reject(n)}finally{i.emitOne=void 0,i.emitMany=void 0,i.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await se.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(e,t){return new zi(async i=>{for await(const n of e)i.emitOne(t(n))})}map(e){return zi.map(this,e)}static filter(e,t){return new zi(async i=>{for await(const n of e)t(n)&&i.emitOne(n)})}filter(e){return zi.filter(this,e)}static coalesce(e){return zi.filter(e,t=>!!t)}coalesce(){return zi.coalesce(this)}static async toPromise(e){const t=[];for await(const i of e)t.push(i);return t}toPromise(){return zi.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}}class Zee extends zi{constructor(e,t){super(t),this._source=e}cancel(){this._source.cancel()}}function Kee(s){const e=new li,t=s(e.token);return new Zee(e,async i=>{const n=e.token.onCancellationRequested(()=>{n.dispose(),e.dispose(),i.reject(new Xr)});try{for await(const o of t){if(e.token.isCancellationRequested)return;i.emitOne(o)}n.dispose(),e.dispose()}catch(o){n.dispose(),e.dispose(),i.reject(o)}})}/*! @license DOMPurify 3.0.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.0.5/LICENSE */const{entries:W6,setPrototypeOf:O5,isFrozen:qee,getPrototypeOf:Gee,getOwnPropertyDescriptor:Yee}=Object;let{freeze:po,seal:Ba,create:Xee}=Object,{apply:nE,construct:sE}=typeof Reflect<"u"&&Reflect;nE||(nE=function(e,t,i){return e.apply(t,i)});po||(po=function(e){return e});Ba||(Ba=function(e){return e});sE||(sE=function(e,t){return new e(...t)});const Qee=Qr(Array.prototype.forEach),F5=Qr(Array.prototype.pop),Um=Qr(Array.prototype.push),Mw=Qr(String.prototype.toLowerCase),Fk=Qr(String.prototype.toString),Jee=Qr(String.prototype.match),la=Qr(String.prototype.replace),ete=Qr(String.prototype.indexOf),tte=Qr(String.prototype.trim),ir=Qr(RegExp.prototype.test),$m=ite(TypeError);function Qr(s){return function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return nE(s,e,i)}}function ite(s){return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return sE(s,t)}}function Tt(s,e,t){var i;t=(i=t)!==null&&i!==void 0?i:Mw,O5&&O5(s,null);let n=e.length;for(;n--;){let o=e[n];if(typeof o=="string"){const r=t(o);r!==o&&(qee(e)||(e[n]=r),o=r)}s[o]=!0}return s}function Bg(s){const e=Xee(null);for(const[t,i]of W6(s))e[t]=i;return e}function vy(s,e){for(;s!==null;){const i=Yee(s,e);if(i){if(i.get)return Qr(i.get);if(typeof i.value=="function")return Qr(i.value)}s=Gee(s)}function t(i){return console.warn("fallback value for",i),null}return t}const B5=po(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Bk=po(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Wk=po(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),nte=po(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Hk=po(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),ste=po(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),W5=po(["#text"]),H5=po(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Vk=po(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),V5=po(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Cy=po(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),ote=Ba(/\{\{[\w\W]*|[\w\W]*\}\}/gm),rte=Ba(/<%[\w\W]*|[\w\W]*%>/gm),ate=Ba(/\${[\w\W]*}/gm),lte=Ba(/^data-[\-\w.\u00B7-\uFFFF]/),cte=Ba(/^aria-[\-\w]+$/),H6=Ba(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),dte=Ba(/^(?:\w+script|data):/i),hte=Ba(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),V6=Ba(/^html$/i);var z5=Object.freeze({__proto__:null,MUSTACHE_EXPR:ote,ERB_EXPR:rte,TMPLIT_EXPR:ate,DATA_ATTR:lte,ARIA_ATTR:cte,IS_ALLOWED_URI:H6,IS_SCRIPT_OR_DATA:dte,ATTR_WHITESPACE:hte,DOCTYPE_NAME:V6});const ute=()=>typeof window>"u"?null:window,gte=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const n="data-tt-policy-suffix";t&&t.hasAttribute(n)&&(i=t.getAttribute(n));const o="dompurify"+(i?"#"+i:"");try{return e.createPolicy(o,{createHTML(r){return r},createScriptURL(r){return r}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function z6(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ute();const e=Be=>z6(Be);if(e.version="3.0.5",e.removed=[],!s||!s.document||s.document.nodeType!==9)return e.isSupported=!1,e;const t=s.document,i=t.currentScript;let{document:n}=s;const{DocumentFragment:o,HTMLTemplateElement:r,Node:a,Element:l,NodeFilter:c,NamedNodeMap:d=s.NamedNodeMap||s.MozNamedAttrMap,HTMLFormElement:h,DOMParser:u,trustedTypes:g}=s,f=l.prototype,m=vy(f,"cloneNode"),_=vy(f,"nextSibling"),b=vy(f,"childNodes"),v=vy(f,"parentNode");if(typeof r=="function"){const Be=n.createElement("template");Be.content&&Be.content.ownerDocument&&(n=Be.content.ownerDocument)}let C,y="";const{implementation:w,createNodeIterator:x,createDocumentFragment:L,getElementsByTagName:D}=n,{importNode:T}=t;let F={};e.isSupported=typeof W6=="function"&&typeof v=="function"&&w&&w.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:W,ERB_EXPR:H,TMPLIT_EXPR:$,DATA_ATTR:V,ARIA_ATTR:Y,IS_SCRIPT_OR_DATA:ie,ATTR_WHITESPACE:ue}=z5;let{IS_ALLOWED_URI:fe}=z5,oe=null;const be=Tt({},[...B5,...Bk,...Wk,...Hk,...W5]);let xe=null;const wt=Tt({},[...H5,...Vk,...V5,...Cy]);let pt=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Et=null,Ei=null,Fi=!0,Fn=!0,ei=!1,wo=!0,Es=!1,Tr=!1,Mg=!1,Er=!1,ra=!1,jl=!1,td=!1,Th=!0,Ag=!1;const Pg="user-content-";let aa=!0,Zl=!1,Jo={},Nr=null;const Eh=Tt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let id=null;const Og=Tt({},["audio","video","img","source","image","track"]);let Ya=null;const Nh=Tt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),er="http://www.w3.org/1998/Math/MathML",Bi="http://www.w3.org/2000/svg",hi="http://www.w3.org/1999/xhtml";let Ns=hi,nd=!1,Qs=null;const Rh=Tt({},[er,Bi,hi],Fk);let Xa;const Kl=["application/xhtml+xml","text/html"],si="text/html";let Sn,sd=null;const mk=n.createElement("form"),ly=function(K){return K instanceof RegExp||K instanceof Function},Vm=function(K){if(!(sd&&sd===K)){if((!K||typeof K!="object")&&(K={}),K=Bg(K),Xa=Kl.indexOf(K.PARSER_MEDIA_TYPE)===-1?Xa=si:Xa=K.PARSER_MEDIA_TYPE,Sn=Xa==="application/xhtml+xml"?Fk:Mw,oe="ALLOWED_TAGS"in K?Tt({},K.ALLOWED_TAGS,Sn):be,xe="ALLOWED_ATTR"in K?Tt({},K.ALLOWED_ATTR,Sn):wt,Qs="ALLOWED_NAMESPACES"in K?Tt({},K.ALLOWED_NAMESPACES,Fk):Rh,Ya="ADD_URI_SAFE_ATTR"in K?Tt(Bg(Nh),K.ADD_URI_SAFE_ATTR,Sn):Nh,id="ADD_DATA_URI_TAGS"in K?Tt(Bg(Og),K.ADD_DATA_URI_TAGS,Sn):Og,Nr="FORBID_CONTENTS"in K?Tt({},K.FORBID_CONTENTS,Sn):Eh,Et="FORBID_TAGS"in K?Tt({},K.FORBID_TAGS,Sn):{},Ei="FORBID_ATTR"in K?Tt({},K.FORBID_ATTR,Sn):{},Jo="USE_PROFILES"in K?K.USE_PROFILES:!1,Fi=K.ALLOW_ARIA_ATTR!==!1,Fn=K.ALLOW_DATA_ATTR!==!1,ei=K.ALLOW_UNKNOWN_PROTOCOLS||!1,wo=K.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Es=K.SAFE_FOR_TEMPLATES||!1,Tr=K.WHOLE_DOCUMENT||!1,ra=K.RETURN_DOM||!1,jl=K.RETURN_DOM_FRAGMENT||!1,td=K.RETURN_TRUSTED_TYPE||!1,Er=K.FORCE_BODY||!1,Th=K.SANITIZE_DOM!==!1,Ag=K.SANITIZE_NAMED_PROPS||!1,aa=K.KEEP_CONTENT!==!1,Zl=K.IN_PLACE||!1,fe=K.ALLOWED_URI_REGEXP||H6,Ns=K.NAMESPACE||hi,pt=K.CUSTOM_ELEMENT_HANDLING||{},K.CUSTOM_ELEMENT_HANDLING&&ly(K.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(pt.tagNameCheck=K.CUSTOM_ELEMENT_HANDLING.tagNameCheck),K.CUSTOM_ELEMENT_HANDLING&&ly(K.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(pt.attributeNameCheck=K.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),K.CUSTOM_ELEMENT_HANDLING&&typeof K.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(pt.allowCustomizedBuiltInElements=K.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Es&&(Fn=!1),jl&&(ra=!0),Jo&&(oe=Tt({},[...W5]),xe=[],Jo.html===!0&&(Tt(oe,B5),Tt(xe,H5)),Jo.svg===!0&&(Tt(oe,Bk),Tt(xe,Vk),Tt(xe,Cy)),Jo.svgFilters===!0&&(Tt(oe,Wk),Tt(xe,Vk),Tt(xe,Cy)),Jo.mathMl===!0&&(Tt(oe,Hk),Tt(xe,V5),Tt(xe,Cy))),K.ADD_TAGS&&(oe===be&&(oe=Bg(oe)),Tt(oe,K.ADD_TAGS,Sn)),K.ADD_ATTR&&(xe===wt&&(xe=Bg(xe)),Tt(xe,K.ADD_ATTR,Sn)),K.ADD_URI_SAFE_ATTR&&Tt(Ya,K.ADD_URI_SAFE_ATTR,Sn),K.FORBID_CONTENTS&&(Nr===Eh&&(Nr=Bg(Nr)),Tt(Nr,K.FORBID_CONTENTS,Sn)),aa&&(oe["#text"]=!0),Tr&&Tt(oe,["html","head","body"]),oe.table&&(Tt(oe,["tbody"]),delete Et.tbody),K.TRUSTED_TYPES_POLICY){if(typeof K.TRUSTED_TYPES_POLICY.createHTML!="function")throw $m('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof K.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw $m('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');C=K.TRUSTED_TYPES_POLICY,y=C.createHTML("")}else C===void 0&&(C=gte(g,i)),C!==null&&typeof y=="string"&&(y=C.createHTML(""));po&&po(K),sd=K}},cy=Tt({},["mi","mo","mn","ms","mtext"]),dy=Tt({},["foreignobject","desc","title","annotation-xml"]),_k=Tt({},["title","style","font","a","script"]),rt=Tt({},Bk);Tt(rt,Wk),Tt(rt,nte);const N=Tt({},Hk);Tt(N,ste);const R=function(K){let we=v(K);(!we||!we.tagName)&&(we={namespaceURI:Ns,tagName:"template"});const Ae=Mw(K.tagName),ui=Mw(we.tagName);return Qs[K.namespaceURI]?K.namespaceURI===Bi?we.namespaceURI===hi?Ae==="svg":we.namespaceURI===er?Ae==="svg"&&(ui==="annotation-xml"||cy[ui]):!!rt[Ae]:K.namespaceURI===er?we.namespaceURI===hi?Ae==="math":we.namespaceURI===Bi?Ae==="math"&&dy[ui]:!!N[Ae]:K.namespaceURI===hi?we.namespaceURI===Bi&&!dy[ui]||we.namespaceURI===er&&!cy[ui]?!1:!N[Ae]&&(_k[Ae]||!rt[Ae]):!!(Xa==="application/xhtml+xml"&&Qs[K.namespaceURI]):!1},A=function(K){Um(e.removed,{element:K});try{K.parentNode.removeChild(K)}catch{K.remove()}},z=function(K,we){try{Um(e.removed,{attribute:we.getAttributeNode(K),from:we})}catch{Um(e.removed,{attribute:null,from:we})}if(we.removeAttribute(K),K==="is"&&!xe[K])if(ra||jl)try{A(we)}catch{}else try{we.setAttribute(K,"")}catch{}},j=function(K){let we,Ae;if(Er)K="<remove></remove>"+K;else{const Rs=Jee(K,/^[\r\n\t ]+/);Ae=Rs&&Rs[0]}Xa==="application/xhtml+xml"&&Ns===hi&&(K='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+K+"</body></html>");const ui=C?C.createHTML(K):K;if(Ns===hi)try{we=new u().parseFromString(ui,Xa)}catch{}if(!we||!we.documentElement){we=w.createDocument(Ns,"template",null);try{we.documentElement.innerHTML=nd?y:ui}catch{}}const gn=we.body||we.documentElement;return K&&Ae&&gn.insertBefore(n.createTextNode(Ae),gn.childNodes[0]||null),Ns===hi?D.call(we,Tr?"html":"body")[0]:Tr?we.documentElement:gn},re=function(K){return x.call(K.ownerDocument||K,K,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},de=function(K){return K instanceof h&&(typeof K.nodeName!="string"||typeof K.textContent!="string"||typeof K.removeChild!="function"||!(K.attributes instanceof d)||typeof K.removeAttribute!="function"||typeof K.setAttribute!="function"||typeof K.namespaceURI!="string"||typeof K.insertBefore!="function"||typeof K.hasChildNodes!="function")},Te=function(K){return typeof a=="object"?K instanceof a:K&&typeof K=="object"&&typeof K.nodeType=="number"&&typeof K.nodeName=="string"},Ne=function(K,we,Ae){F[K]&&Qee(F[K],ui=>{ui.call(e,we,Ae,sd)})},at=function(K){let we;if(Ne("beforeSanitizeElements",K,null),de(K))return A(K),!0;const Ae=Sn(K.nodeName);if(Ne("uponSanitizeElement",K,{tagName:Ae,allowedTags:oe}),K.hasChildNodes()&&!Te(K.firstElementChild)&&(!Te(K.content)||!Te(K.content.firstElementChild))&&ir(/<[/\w]/g,K.innerHTML)&&ir(/<[/\w]/g,K.textContent))return A(K),!0;if(!oe[Ae]||Et[Ae]){if(!Et[Ae]&&Ci(Ae)&&(pt.tagNameCheck instanceof RegExp&&ir(pt.tagNameCheck,Ae)||pt.tagNameCheck instanceof Function&&pt.tagNameCheck(Ae)))return!1;if(aa&&!Nr[Ae]){const ui=v(K)||K.parentNode,gn=b(K)||K.childNodes;if(gn&&ui){const Rs=gn.length;for(let qi=Rs-1;qi>=0;--qi)ui.insertBefore(m(gn[qi],!0),_(K))}}return A(K),!0}return K instanceof l&&!R(K)||(Ae==="noscript"||Ae==="noembed"||Ae==="noframes")&&ir(/<\/no(script|embed|frames)/i,K.innerHTML)?(A(K),!0):(Es&&K.nodeType===3&&(we=K.textContent,we=la(we,W," "),we=la(we,H," "),we=la(we,$," "),K.textContent!==we&&(Um(e.removed,{element:K.cloneNode()}),K.textContent=we)),Ne("afterSanitizeElements",K,null),!1)},Rt=function(K,we,Ae){if(Th&&(we==="id"||we==="name")&&(Ae in n||Ae in mk))return!1;if(!(Fn&&!Ei[we]&&ir(V,we))){if(!(Fi&&ir(Y,we))){if(!xe[we]||Ei[we]){if(!(Ci(K)&&(pt.tagNameCheck instanceof RegExp&&ir(pt.tagNameCheck,K)||pt.tagNameCheck instanceof Function&&pt.tagNameCheck(K))&&(pt.attributeNameCheck instanceof RegExp&&ir(pt.attributeNameCheck,we)||pt.attributeNameCheck instanceof Function&&pt.attributeNameCheck(we))||we==="is"&&pt.allowCustomizedBuiltInElements&&(pt.tagNameCheck instanceof RegExp&&ir(pt.tagNameCheck,Ae)||pt.tagNameCheck instanceof Function&&pt.tagNameCheck(Ae))))return!1}else if(!Ya[we]){if(!ir(fe,la(Ae,ue,""))){if(!((we==="src"||we==="xlink:href"||we==="href")&&K!=="script"&&ete(Ae,"data:")===0&&id[K])){if(!(ei&&!ir(ie,la(Ae,ue,"")))){if(Ae)return!1}}}}}}return!0},Ci=function(K){return K.indexOf("-")>0},sn=function(K){let we,Ae,ui,gn;Ne("beforeSanitizeAttributes",K,null);const{attributes:Rs}=K;if(!Rs)return;const qi={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:xe};for(gn=Rs.length;gn--;){we=Rs[gn];const{name:Qa,namespaceURI:bk}=we;if(Ae=Qa==="value"?we.value:tte(we.value),ui=Sn(Qa),qi.attrName=ui,qi.attrValue=Ae,qi.keepAttr=!0,qi.forceKeepAttr=void 0,Ne("uponSanitizeAttribute",K,qi),Ae=qi.attrValue,qi.forceKeepAttr||(z(Qa,K),!qi.keepAttr))continue;if(!wo&&ir(/\/>/i,Ae)){z(Qa,K);continue}Es&&(Ae=la(Ae,W," "),Ae=la(Ae,H," "),Ae=la(Ae,$," "));const i5=Sn(K.nodeName);if(Rt(i5,ui,Ae)){if(Ag&&(ui==="id"||ui==="name")&&(z(Qa,K),Ae=Pg+Ae),C&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!bk)switch(g.getAttributeType(i5,ui)){case"TrustedHTML":{Ae=C.createHTML(Ae);break}case"TrustedScriptURL":{Ae=C.createScriptURL(Ae);break}}try{bk?K.setAttributeNS(bk,Qa,Ae):K.setAttribute(Qa,Ae),F5(e.removed)}catch{}}}Ne("afterSanitizeAttributes",K,null)},Ni=function Be(K){let we;const Ae=re(K);for(Ne("beforeSanitizeShadowDOM",K,null);we=Ae.nextNode();)Ne("uponSanitizeShadowNode",we,null),!at(we)&&(we.content instanceof o&&Be(we.content),sn(we));Ne("afterSanitizeShadowDOM",K,null)};return e.sanitize=function(Be){let K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},we,Ae,ui,gn;if(nd=!Be,nd&&(Be="<!-->"),typeof Be!="string"&&!Te(Be))if(typeof Be.toString=="function"){if(Be=Be.toString(),typeof Be!="string")throw $m("dirty is not a string, aborting")}else throw $m("toString is not a function");if(!e.isSupported)return Be;if(Mg||Vm(K),e.removed=[],typeof Be=="string"&&(Zl=!1),Zl){if(Be.nodeName){const Qa=Sn(Be.nodeName);if(!oe[Qa]||Et[Qa])throw $m("root node is forbidden and cannot be sanitized in-place")}}else if(Be instanceof a)we=j("<!---->"),Ae=we.ownerDocument.importNode(Be,!0),Ae.nodeType===1&&Ae.nodeName==="BODY"||Ae.nodeName==="HTML"?we=Ae:we.appendChild(Ae);else{if(!ra&&!Es&&!Tr&&Be.indexOf("<")===-1)return C&&td?C.createHTML(Be):Be;if(we=j(Be),!we)return ra?null:td?y:""}we&&Er&&A(we.firstChild);const Rs=re(Zl?Be:we);for(;ui=Rs.nextNode();)at(ui)||(ui.content instanceof o&&Ni(ui.content),sn(ui));if(Zl)return Be;if(ra){if(jl)for(gn=L.call(we.ownerDocument);we.firstChild;)gn.appendChild(we.firstChild);else gn=we;return(xe.shadowroot||xe.shadowrootmode)&&(gn=T.call(t,gn,!0)),gn}let qi=Tr?we.outerHTML:we.innerHTML;return Tr&&oe["!doctype"]&&we.ownerDocument&&we.ownerDocument.doctype&&we.ownerDocument.doctype.name&&ir(V6,we.ownerDocument.doctype.name)&&(qi="<!DOCTYPE "+we.ownerDocument.doctype.name+`>
`+qi),Es&&(qi=la(qi,W," "),qi=la(qi,H," "),qi=la(qi,$," ")),C&&td?C.createHTML(qi):qi},e.setConfig=function(Be){Vm(Be),Mg=!0},e.clearConfig=function(){sd=null,Mg=!1},e.isValidAttribute=function(Be,K,we){sd||Vm({});const Ae=Sn(Be),ui=Sn(K);return Rt(Ae,ui,we)},e.addHook=function(Be,K){typeof K=="function"&&(F[Be]=F[Be]||[],Um(F[Be],K))},e.removeHook=function(Be){if(F[Be])return F5(F[Be])},e.removeHooks=function(Be){F[Be]&&(F[Be]=[])},e.removeAllHooks=function(){F={}},e}var Bl=z6();Bl.version;Bl.isSupported;const U6=Bl.sanitize;Bl.setConfig;Bl.clearConfig;Bl.isValidAttribute;const $6=Bl.addHook,j6=Bl.removeHook;Bl.removeHooks;Bl.removeAllHooks;var Fe;(function(s){s.inMemory="inmemory",s.vscode="vscode",s.internal="private",s.walkThrough="walkThrough",s.walkThroughSnippet="walkThroughSnippet",s.http="http",s.https="https",s.file="file",s.mailto="mailto",s.untitled="untitled",s.data="data",s.command="command",s.vscodeRemote="vscode-remote",s.vscodeRemoteResource="vscode-remote-resource",s.vscodeManagedRemoteResource="vscode-managed-remote-resource",s.vscodeUserData="vscode-userdata",s.vscodeCustomEditor="vscode-custom-editor",s.vscodeNotebookCell="vscode-notebook-cell",s.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",s.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",s.vscodeNotebookCellOutput="vscode-notebook-cell-output",s.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",s.vscodeNotebookMetadata="vscode-notebook-metadata",s.vscodeInteractiveInput="vscode-interactive-input",s.vscodeSettings="vscode-settings",s.vscodeWorkspaceTrust="vscode-workspace-trust",s.vscodeTerminal="vscode-terminal",s.vscodeChatCodeBlock="vscode-chat-code-block",s.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",s.vscodeChatSesssion="vscode-chat-editor",s.webviewPanel="webview-panel",s.vscodeWebview="vscode-webview",s.extension="extension",s.vscodeFileResource="vscode-file",s.tmp="tmp",s.vsls="vsls",s.vscodeSourceControl="vscode-scm",s.commentsInput="comment",s.codeSetting="code-setting",s.outputChannel="output"})(Fe||(Fe={}));function bL(s,e){return Se.isUri(s)?Cf(s.scheme,e):WP(s,e+":")}function oE(s,...e){return e.some(t=>bL(s,t))}const fte="tkn";class pte{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._serverRootPath="/"}setPreferredWebSchema(e){this._preferredWebSchema=e}get _remoteResourcesPath(){return Ai.join(this._serverRootPath,Fe.vscodeRemoteResource)}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return Oe(a),e}const t=e.authority;let i=this._hosts[t];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);const n=this._ports[t],o=this._connectionTokens[t];let r=`path=${encodeURIComponent(e.path)}`;return typeof o=="string"&&(r+=`&${fte}=${encodeURIComponent(o)}`),Se.from({scheme:gg?this._preferredWebSchema:Fe.vscodeRemoteResource,authority:`${i}:${n}`,path:this._remoteResourcesPath,query:r})}}const Z6=new pte,mte="vscode-app";class W1{static{this.FALLBACK_AUTHORITY=mte}asBrowserUri(e){const t=this.toUri(e);return this.uriToBrowserUri(t)}uriToBrowserUri(e){return e.scheme===Fe.vscodeRemote?Z6.rewrite(e):e.scheme===Fe.file&&(Ia||wQ===`${Fe.vscodeFileResource}://${W1.FALLBACK_AUTHORITY}`)?e.with({scheme:Fe.vscodeFileResource,authority:e.authority||W1.FALLBACK_AUTHORITY,query:null,fragment:null}):e}toUri(e,t){if(Se.isUri(e))return e;if(globalThis._VSCODE_FILE_ROOT){const i=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(i))return Se.joinPath(Se.parse(i,!0),e);const n=ZJ(i,e);return Se.file(n)}return Se.parse(t.toUrl(e))}}const vL=new W1;var rE;(function(s){const e=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);s.CoopAndCoep=Object.freeze(e.get("3"));const t="vscode-coi";function i(o){let r;typeof o=="string"?r=new URL(o).searchParams:o instanceof URL?r=o.searchParams:Se.isUri(o)&&(r=new URL(o.toString(!0)).searchParams);const a=r?.get(t);if(a)return e.get(a)}s.getHeadersFromQuery=i;function n(o,r,a){if(!globalThis.crossOriginIsolated)return;const l=r&&a?"3":a?"2":"1";o instanceof URLSearchParams?o.set(t,l):o[t]=l}s.addSearchParam=n})(rE||(rE={}));function CL(s){return yL(s,0)}function yL(s,e){switch(typeof s){case"object":return s===null?vc(349,e):Array.isArray(s)?bte(s,e):vte(s,e);case"string":return GP(s,e);case"boolean":return _te(s,e);case"number":return vc(s,e);case"undefined":return vc(937,e);default:return vc(617,e)}}function vc(s,e){return(e<<5)-e+s|0}function _te(s,e){return vc(s?433:863,e)}function GP(s,e){e=vc(149417,e);for(let t=0,i=s.length;t<i;t++)e=vc(s.charCodeAt(t),e);return e}function bte(s,e){return e=vc(104579,e),s.reduce((t,i)=>yL(i,t),e)}function vte(s,e){return e=vc(181387,e),Object.keys(s).sort().reduce((t,i)=>(t=GP(i,t),yL(s[i],t)),e)}function zk(s,e,t=32){const i=t-e,n=~((1<<i)-1);return(s<<e|(n&s)>>>i)>>>0}function U5(s,e=0,t=s.byteLength,i=0){for(let n=0;n<t;n++)s[e+n]=i}function Cte(s,e,t="0"){for(;s.length<e;)s=t+s;return s}function jm(s,e=32){return s instanceof ArrayBuffer?Array.from(new Uint8Array(s)).map(t=>t.toString(16).padStart(2,"0")).join(""):Cte((s>>>0).toString(16),e/4)}class YP{static{this._bigBlock32=new DataView(new ArrayBuffer(320))}constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){const t=e.length;if(t===0)return;const i=this._buff;let n=this._buffLen,o=this._leftoverHighSurrogate,r,a;for(o!==0?(r=o,a=-1,o=0):(r=e.charCodeAt(0),a=0);;){let l=r;if(Qi(r))if(a+1<t){const c=e.charCodeAt(a+1);Uu(c)?(a++,l=HP(r,c)):l=65533}else{o=r;break}else Uu(r)&&(l=65533);if(n=this._push(i,n,l),a++,a<t)r=e.charCodeAt(a);else break}this._buffLen=n,this._leftoverHighSurrogate=o}_push(e,t,i){return i<128?e[t++]=i:i<2048?(e[t++]=192|(i&1984)>>>6,e[t++]=128|(i&63)>>>0):i<65536?(e[t++]=224|(i&61440)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0):(e[t++]=240|(i&1835008)>>>18,e[t++]=128|(i&258048)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),jm(this._h0)+jm(this._h1)+jm(this._h2)+jm(this._h3)+jm(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,U5(this._buff,this._buffLen),this._buffLen>56&&(this._step(),U5(this._buff));const e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){const e=YP._bigBlock32,t=this._buffDV;for(let h=0;h<64;h+=4)e.setUint32(h,t.getUint32(h,!1),!1);for(let h=64;h<320;h+=4)e.setUint32(h,zk(e.getUint32(h-12,!1)^e.getUint32(h-32,!1)^e.getUint32(h-56,!1)^e.getUint32(h-64,!1),1),!1);let i=this._h0,n=this._h1,o=this._h2,r=this._h3,a=this._h4,l,c,d;for(let h=0;h<80;h++)h<20?(l=n&o|~n&r,c=1518500249):h<40?(l=n^o^r,c=1859775393):h<60?(l=n&o|n&r|o&r,c=2400959708):(l=n^o^r,c=3395469782),d=zk(i,5)+l+a+c+e.getUint32(h*4,!1)&4294967295,a=r,r=o,o=zk(n,30),n=i,i=d;this._h0=this._h0+i&4294967295,this._h1=this._h1+n&4294967295,this._h2=this._h2+o&4294967295,this._h3=this._h3+r&4294967295,this._h4=this._h4+a&4294967295}}const{registerWindow:k2e,getWindow:ke,getDocument:D2e,getWindows:K6,getWindowsCount:yte,getWindowId:H1,getWindowById:$5,hasWindow:I2e,onDidRegisterWindow:wL,onWillUnregisterWindow:wte,onDidUnregisterWindow:Ste}=function(){const s=new Map;uee(Nt,1);const e={window:Nt,disposables:new Z};s.set(Nt.vscodeWindowId,e);const t=new O,i=new O,n=new O;function o(r,a){return(typeof r=="number"?s.get(r):void 0)??(a?e:void 0)}return{onDidRegisterWindow:t.event,onWillUnregisterWindow:n.event,onDidUnregisterWindow:i.event,registerWindow(r){if(s.has(r.vscodeWindowId))return B.None;const a=new Z,l={window:r,disposables:a.add(new Z)};return s.set(r.vscodeWindowId,l),a.add(Ce(()=>{s.delete(r.vscodeWindowId),i.fire(r)})),a.add(U(r,ee.BEFORE_UNLOAD,()=>{n.fire(r)})),t.fire(l),a},getWindows(){return s.values()},getWindowsCount(){return s.size},getWindowId(r){return r.vscodeWindowId},hasWindow(r){return s.has(r)},getWindowById:o,getWindow(r){const a=r;if(a?.ownerDocument?.defaultView)return a.ownerDocument.defaultView.window;const l=r;return l?.view?l.view.window:Nt},getDocument(r){return ke(r).document}}}();function Cn(s){for(;s.firstChild;)s.firstChild.remove()}class Lte{constructor(e,t,i,n){this._node=e,this._type=t,this._handler=i,this._options=n||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function U(s,e,t,i){return new Lte(s,e,t,i)}function q6(s,e){return function(t){return e(new jr(s,t))}}function xte(s){return function(e){return s(new Ft(e))}}const gi=function(e,t,i,n){let o=i;return t==="click"||t==="mousedown"||t==="contextmenu"?o=q6(ke(e),i):(t==="keydown"||t==="keypress"||t==="keyup")&&(o=xte(i)),U(e,t,o,n)},kte=function(e,t,i){const n=q6(ke(e),t);return Dte(e,n,i)};function Dte(s,e,t){return U(s,Oa&&ZP.pointerEvents?ee.POINTER_DOWN:ee.MOUSE_DOWN,e,t)}function v_(s,e,t){return q_(s,e,t)}class Uk extends B6{constructor(e,t){super(e,t)}}let V1,mo;class XP extends qP{constructor(e){super(),this.defaultTarget=e&&ke(e)}cancelAndSet(e,t,i){return super.cancelAndSet(e,t,i??this.defaultTarget)}}class $k{constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){Oe(e)}}static sort(e,t){return t.priority-e.priority}}(function(){const s=new Map,e=new Map,t=new Map,i=new Map,n=o=>{t.set(o,!1);const r=s.get(o)??[];for(e.set(o,r),s.set(o,[]),i.set(o,!0);r.length>0;)r.sort($k.sort),r.shift().execute();i.set(o,!1)};mo=(o,r,a=0)=>{const l=H1(o),c=new $k(r,a);let d=s.get(l);return d||(d=[],s.set(l,d)),d.push(c),t.get(l)||(t.set(l,!0),o.requestAnimationFrame(()=>n(l))),c},V1=(o,r,a)=>{const l=H1(o);if(i.get(l)){const c=new $k(r,a);let d=e.get(l);return d||(d=[],e.set(l,d)),d.push(c),c}else return mo(o,r,a)}})();function SL(s){return ke(s).getComputedStyle(s,null)}function sh(s,e){const t=ke(s),i=t.document;if(s!==i.body)return new bt(s.clientWidth,s.clientHeight);if(Oa&&t?.visualViewport)return new bt(t.visualViewport.width,t.visualViewport.height);if(t?.innerWidth&&t.innerHeight)return new bt(t.innerWidth,t.innerHeight);if(i.body&&i.body.clientWidth&&i.body.clientHeight)return new bt(i.body.clientWidth,i.body.clientHeight);if(i.documentElement&&i.documentElement.clientWidth&&i.documentElement.clientHeight)return new bt(i.documentElement.clientWidth,i.documentElement.clientHeight);throw new Error("Unable to figure out browser width and height")}class ki{static convertToPixels(e,t){return parseFloat(t)||0}static getDimension(e,t,i){const n=SL(e),o=n?n.getPropertyValue(t):"0";return ki.convertToPixels(e,o)}static getBorderLeftWidth(e){return ki.getDimension(e,"border-left-width","borderLeftWidth")}static getBorderRightWidth(e){return ki.getDimension(e,"border-right-width","borderRightWidth")}static getBorderTopWidth(e){return ki.getDimension(e,"border-top-width","borderTopWidth")}static getBorderBottomWidth(e){return ki.getDimension(e,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(e){return ki.getDimension(e,"padding-left","paddingLeft")}static getPaddingRight(e){return ki.getDimension(e,"padding-right","paddingRight")}static getPaddingTop(e){return ki.getDimension(e,"padding-top","paddingTop")}static getPaddingBottom(e){return ki.getDimension(e,"padding-bottom","paddingBottom")}static getMarginLeft(e){return ki.getDimension(e,"margin-left","marginLeft")}static getMarginTop(e){return ki.getDimension(e,"margin-top","marginTop")}static getMarginRight(e){return ki.getDimension(e,"margin-right","marginRight")}static getMarginBottom(e){return ki.getDimension(e,"margin-bottom","marginBottom")}}class bt{static{this.None=new bt(0,0)}constructor(e,t){this.width=e,this.height=t}with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new bt(e,t):this}static is(e){return typeof e=="object"&&typeof e.height=="number"&&typeof e.width=="number"}static lift(e){return e instanceof bt?e:new bt(e.width,e.height)}static equals(e,t){return e===t?!0:!e||!t?!1:e.width===t.width&&e.height===t.height}}function G6(s){let e=s.offsetParent,t=s.offsetTop,i=s.offsetLeft;for(;(s=s.parentNode)!==null&&s!==s.ownerDocument.body&&s!==s.ownerDocument.documentElement;){t-=s.scrollTop;const n=X6(s)?null:SL(s);n&&(i-=n.direction!=="rtl"?s.scrollLeft:-s.scrollLeft),s===e&&(i+=ki.getBorderLeftWidth(s),t+=ki.getBorderTopWidth(s),t+=s.offsetTop,i+=s.offsetLeft,e=s.offsetParent)}return{left:i,top:t}}function Ite(s,e,t){typeof e=="number"&&(s.style.width=`${e}px`),typeof t=="number"&&(s.style.height=`${t}px`)}function Si(s){const e=s.getBoundingClientRect(),t=ke(s);return{left:e.left+t.scrollX,top:e.top+t.scrollY,width:e.width,height:e.height}}function Y6(s){let e=s,t=1;do{const i=SL(e).zoom;i!=null&&i!=="1"&&(t*=i),e=e.parentElement}while(e!==null&&e!==e.ownerDocument.documentElement);return t}function io(s){const e=ki.getMarginLeft(s)+ki.getMarginRight(s);return s.offsetWidth+e}function jk(s){const e=ki.getBorderLeftWidth(s)+ki.getBorderRightWidth(s),t=ki.getPaddingLeft(s)+ki.getPaddingRight(s);return s.offsetWidth-e-t}function Tte(s){const e=ki.getBorderTopWidth(s)+ki.getBorderBottomWidth(s),t=ki.getPaddingTop(s)+ki.getPaddingBottom(s);return s.offsetHeight-e-t}function Cc(s){const e=ki.getMarginTop(s)+ki.getMarginBottom(s);return s.offsetHeight+e}function Ji(s,e){return!!e?.contains(s)}function Ete(s,e,t){for(;s&&s.nodeType===s.ELEMENT_NODE;){if(s.classList.contains(e))return s;if(t){if(typeof t=="string"){if(s.classList.contains(t))return null}else if(s===t)return null}s=s.parentNode}return null}function Zk(s,e,t){return!!Ete(s,e,t)}function X6(s){return s&&!!s.host&&!!s.mode}function z1(s){return!!ju(s)}function ju(s){for(;s.parentNode;){if(s===s.ownerDocument?.body)return null;s=s.parentNode}return X6(s)?s:null}function Rn(){let s=mm().activeElement;for(;s?.shadowRoot;)s=s.shadowRoot.activeElement;return s}function LL(s){return Rn()===s}function Q6(s){return Ji(Rn(),s)}function mm(){return yte()<=1?Nt.document:Array.from(K6()).map(({window:e})=>e.document).find(e=>e.hasFocus())??Nt.document}function C_(){return mm().defaultView?.window??Nt}const QP=new Map;function J6(){return new Nte}class Nte{constructor(){this._currentCssStyle="",this._styleSheet=void 0}setStyle(e){e!==this._currentCssStyle&&(this._currentCssStyle=e,this._styleSheet?this._styleSheet.innerText=e:this._styleSheet=$o(Nt.document.head,t=>t.innerText=e))}dispose(){this._styleSheet&&(this._styleSheet.remove(),this._styleSheet=void 0)}}function $o(s=Nt.document.head,e,t){const i=document.createElement("style");if(i.type="text/css",i.media="screen",e?.(i),s.appendChild(i),t&&t.add(Ce(()=>i.remove())),s===Nt.document.head){const n=new Set;QP.set(i,n);for(const{window:o,disposables:r}of K6()){if(o===Nt)continue;const a=r.add(Rte(i,n,o));t?.add(a)}}return i}function Rte(s,e,t){const i=new Z,n=s.cloneNode(!0);t.document.head.appendChild(n),i.add(Ce(()=>n.remove()));for(const o of tV(s))n.sheet?.insertRule(o.cssText,n.sheet?.cssRules.length);return i.add(Mte.observe(s,i,{childList:!0})(()=>{n.textContent=s.textContent})),e.add(n),i.add(Ce(()=>e.delete(n))),i}const Mte=new class{constructor(){this.mutationObservers=new Map}observe(s,e,t){let i=this.mutationObservers.get(s);i||(i=new Map,this.mutationObservers.set(s,i));const n=CL(t);let o=i.get(n);if(o)o.users+=1;else{const r=new O,a=new MutationObserver(c=>r.fire(c));a.observe(s,t);const l=o={users:1,observer:a,onDidMutate:r.event};e.add(Ce(()=>{l.users-=1,l.users===0&&(r.dispose(),a.disconnect(),i?.delete(n),i?.size===0&&this.mutationObservers.delete(s))})),i.set(n,o)}return o.onDidMutate}};let Kk=null;function eV(){return Kk||(Kk=$o()),Kk}function tV(s){return s?.sheet?.rules?s.sheet.rules:s?.sheet?.cssRules?s.sheet.cssRules:[]}function U1(s,e,t=eV()){if(!(!t||!e)){t.sheet?.insertRule(`${s} {${e}}`,0);for(const i of QP.get(t)??[])U1(s,e,i)}}function aE(s,e=eV()){if(!e)return;const t=tV(e),i=[];for(let n=0;n<t.length;n++){const o=t[n];Ate(o)&&o.selectorText.indexOf(s)!==-1&&i.push(n)}for(let n=i.length-1;n>=0;n--)e.sheet?.deleteRule(i[n]);for(const n of QP.get(e)??[])aE(s,n)}function Ate(s){return typeof s.selectorText=="string"}function tn(s){return s instanceof HTMLElement||s instanceof ke(s).HTMLElement}function j5(s){return s instanceof HTMLAnchorElement||s instanceof ke(s).HTMLAnchorElement}function Pte(s){return s instanceof SVGElement||s instanceof ke(s).SVGElement}function JP(s){return s instanceof MouseEvent||s instanceof ke(s).MouseEvent}function cc(s){return s instanceof KeyboardEvent||s instanceof ke(s).KeyboardEvent}const ee={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",PASTE:"paste",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:xu?"webkitAnimationStart":"animationstart",ANIMATION_END:xu?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:xu?"webkitAnimationIteration":"animationiteration"};function Ote(s){const e=s;return!!(e&&typeof e.preventDefault=="function"&&typeof e.stopPropagation=="function")}const it={stop:(s,e)=>(s.preventDefault(),e&&s.stopPropagation(),s)};function Fte(s){const e=[];for(let t=0;s&&s.nodeType===s.ELEMENT_NODE;t++)e[t]=s.scrollTop,s=s.parentNode;return e}function Bte(s,e){for(let t=0;s&&s.nodeType===s.ELEMENT_NODE;t++)s.scrollTop!==e[t]&&(s.scrollTop=e[t]),s=s.parentNode}class $1 extends B{static hasFocusWithin(e){if(tn(e)){const t=ju(e),i=t?t.activeElement:e.ownerDocument.activeElement;return Ji(i,e)}else{const t=e;return Ji(t.document.activeElement,t.document)}}constructor(e){super(),this._onDidFocus=this._register(new O),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new O),this.onDidBlur=this._onDidBlur.event;let t=$1.hasFocusWithin(e),i=!1;const n=()=>{i=!1,t||(t=!0,this._onDidFocus.fire())},o=()=>{t&&(i=!0,(tn(e)?ke(e):e).setTimeout(()=>{i&&(i=!1,t=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{$1.hasFocusWithin(e)!==t&&(t?o():n())},this._register(U(e,ee.FOCUS,n,!0)),this._register(U(e,ee.BLUR,o,!0)),tn(e)&&(this._register(U(e,ee.FOCUS_IN,()=>this._refreshStateHandler())),this._register(U(e,ee.FOCUS_OUT,()=>this._refreshStateHandler())))}}function Wa(s){return new $1(s)}function Wte(s,e){return s.after(e),e}function X(s,...e){if(s.append(...e),e.length===1&&typeof e[0]!="string")return e[0]}function e2(s,e){return s.insertBefore(e,s.firstChild),e}function yn(s,...e){s.innerText="",X(s,...e)}const Hte=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;var Kb;(function(s){s.HTML="http://www.w3.org/1999/xhtml",s.SVG="http://www.w3.org/2000/svg"})(Kb||(Kb={}));function iV(s,e,t,...i){const n=Hte.exec(e);if(!n)throw new Error("Bad use of emmet");const o=n[1]||"div";let r;return s!==Kb.HTML?r=document.createElementNS(s,o):r=document.createElement(o),n[3]&&(r.id=n[3]),n[4]&&(r.className=n[4].replace(/\./g," ").trim()),t&&Object.entries(t).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?r[a]=l:a==="selected"?l&&r.setAttribute(a,"true"):r.setAttribute(a,l))}),r.append(...i),r}function te(s,e,...t){return iV(Kb.HTML,s,e,...t)}te.SVG=function(s,e,...t){return iV(Kb.SVG,s,e,...t)};function Vte(s,...e){s?ro(...e):ds(...e)}function ro(...s){for(const e of s)e.style.display="",e.removeAttribute("aria-hidden")}function ds(...s){for(const e of s)e.style.display="none",e.setAttribute("aria-hidden","true")}function Z5(s,e){const t=s.devicePixelRatio*e;return Math.max(1,Math.floor(t))/s.devicePixelRatio}function nV(s){Nt.open(s,"_blank","noopener")}function zte(s,e){const t=()=>{e(),i=mo(s,t)};let i=mo(s,t);return Ce(()=>i.dispose())}Z6.setPreferredWebSchema(/^https:/.test(Nt.location.href)?"https":"http");function Hc(s){return s?`url('${vL.uriToBrowserUri(s).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function qk(s){return`'${s.replace(/'/g,"%27")}'`}function Ec(s,e){if(s!==void 0){const t=s.match(/^\s*var\((.+)\)$/);if(t){const i=t[1].split(",",2);return i.length===2&&(e=Ec(i[1].trim(),e)),`var(${i[0]}, ${e})`}return s}return e}function Ute(s,e=!1){const t=document.createElement("a");return $6("afterSanitizeAttributes",i=>{for(const n of["href","src"])if(i.hasAttribute(n)){const o=i.getAttribute(n);if(n==="href"&&o.startsWith("#"))continue;if(t.href=o,!s.includes(t.protocol.replace(/:$/,""))){if(e&&n==="src"&&t.href.startsWith("data:"))continue;i.removeAttribute(n)}}}),Ce(()=>{j6("afterSanitizeAttributes")})}const $te=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]);class yc extends O{constructor(){super(),this._subscriptions=new Z,this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(se.runAndSubscribe(wL,({window:e,disposables:t})=>this.registerListeners(e,t),{window:Nt,disposables:this._subscriptions}))}registerListeners(e,t){t.add(U(e,"keydown",i=>{if(i.defaultPrevented)return;const n=new Ft(i);if(!(n.keyCode===6&&i.repeat)){if(i.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(i.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(i.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(i.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(n.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=i.altKey,this._keyStatus.ctrlKey=i.ctrlKey,this._keyStatus.metaKey=i.metaKey,this._keyStatus.shiftKey=i.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=i,this.fire(this._keyStatus))}},!0)),t.add(U(e,"keyup",i=>{i.defaultPrevented||(!i.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!i.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!i.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!i.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=i.altKey,this._keyStatus.ctrlKey=i.ctrlKey,this._keyStatus.metaKey=i.metaKey,this._keyStatus.shiftKey=i.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=i,this.fire(this._keyStatus)))},!0)),t.add(U(e.document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(U(e.document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(U(e.document.body,"mousemove",i=>{i.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),t.add(U(e,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return yc.instance||(yc.instance=new yc),yc.instance}dispose(){super.dispose(),this._subscriptions.dispose()}}class jte extends B{constructor(e,t){super(),this.element=e,this.callbacks=t,this.counter=0,this.dragStartTime=0,this.registerListeners()}registerListeners(){this.callbacks.onDragStart&&this._register(U(this.element,ee.DRAG_START,e=>{this.callbacks.onDragStart?.(e)})),this.callbacks.onDrag&&this._register(U(this.element,ee.DRAG,e=>{this.callbacks.onDrag?.(e)})),this._register(U(this.element,ee.DRAG_ENTER,e=>{this.counter++,this.dragStartTime=e.timeStamp,this.callbacks.onDragEnter?.(e)})),this._register(U(this.element,ee.DRAG_OVER,e=>{e.preventDefault(),this.callbacks.onDragOver?.(e,e.timeStamp-this.dragStartTime)})),this._register(U(this.element,ee.DRAG_LEAVE,e=>{this.counter--,this.counter===0&&(this.dragStartTime=0,this.callbacks.onDragLeave?.(e))})),this._register(U(this.element,ee.DRAG_END,e=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDragEnd?.(e)})),this._register(U(this.element,ee.DROP,e=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDrop?.(e)}))}}const sV=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function Ye(s,...e){let t,i;Array.isArray(e[0])?(t={},i=e[0]):(t=e[0]||{},i=e[1]);const n=sV.exec(s);if(!n||!n.groups)throw new Error("Bad use of h");const o=n.groups.tag||"div",r=document.createElement(o);n.groups.id&&(r.id=n.groups.id);const a=[];if(n.groups.class)for(const c of n.groups.class.split("."))c!==""&&a.push(c);if(t.className!==void 0)for(const c of t.className.split("."))c!==""&&a.push(c);a.length>0&&(r.className=a.join(" "));const l={};if(n.groups.name&&(l[n.groups.name]=r),i)for(const c of i)tn(c)?r.appendChild(c):typeof c=="string"?r.append(c):"root"in c&&(Object.assign(l,c),r.appendChild(c.root));for(const[c,d]of Object.entries(t))if(c!=="className")if(c==="style")for(const[h,u]of Object.entries(d))r.style.setProperty(j1(h),typeof u=="number"?u+"px":""+u);else c==="tabIndex"?r.tabIndex=d:r.setAttribute(j1(c),d.toString());return l.root=r,l}function Wg(s,...e){let t,i;Array.isArray(e[0])?(t={},i=e[0]):(t=e[0]||{},i=e[1]);const n=sV.exec(s);if(!n||!n.groups)throw new Error("Bad use of h");const o=n.groups.tag||"div",r=document.createElementNS("http://www.w3.org/2000/svg",o);n.groups.id&&(r.id=n.groups.id);const a=[];if(n.groups.class)for(const c of n.groups.class.split("."))c!==""&&a.push(c);if(t.className!==void 0)for(const c of t.className.split("."))c!==""&&a.push(c);a.length>0&&(r.className=a.join(" "));const l={};if(n.groups.name&&(l[n.groups.name]=r),i)for(const c of i)tn(c)?r.appendChild(c):typeof c=="string"?r.append(c):"root"in c&&(Object.assign(l,c),r.appendChild(c.root));for(const[c,d]of Object.entries(t))if(c!=="className")if(c==="style")for(const[h,u]of Object.entries(d))r.style.setProperty(j1(h),typeof u=="number"?u+"px":""+u);else c==="tabIndex"?r.tabIndex=d:r.setAttribute(j1(c),d.toString());return l.root=r,l}function j1(s){return s.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}class Zte extends B{constructor(e){super(),this._onDidChange=this._register(new O),this.onDidChange=this._onDidChange.event,this._listener=()=>this._handleChange(e,!0),this._mediaQueryList=null,this._handleChange(e,!1)}_handleChange(e,t){this._mediaQueryList?.removeEventListener("change",this._listener),this._mediaQueryList=e.matchMedia(`(resolution: ${e.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),t&&this._onDidChange.fire()}}class Kte extends B{get value(){return this._value}constructor(e){super(),this._onDidChange=this._register(new O),this.onDidChange=this._onDidChange.event,this._value=this._getPixelRatio(e);const t=this._register(new Zte(e));this._register(t.onDidChange(()=>{this._value=this._getPixelRatio(e),this._onDidChange.fire(this._value)}))}_getPixelRatio(e){const t=document.createElement("canvas").getContext("2d"),i=e.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return i/n}}class qte{constructor(){this.mapWindowIdToPixelRatioMonitor=new Map}_getOrCreatePixelRatioMonitor(e){const t=H1(e);let i=this.mapWindowIdToPixelRatioMonitor.get(t);return i||(i=new Kte(e),this.mapWindowIdToPixelRatioMonitor.set(t,i),se.once(Ste)(({vscodeWindowId:n})=>{n===t&&(i?.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(t))})),i}getInstance(e){return this._getOrCreatePixelRatioMonitor(e)}}const qb=new qte;class oV{constructor(e){this.domNode=e,this._maxWidth="",this._width="",this._height="",this._top="",this._left="",this._bottom="",this._right="",this._paddingLeft="",this._fontFamily="",this._fontWeight="",this._fontSize="",this._fontStyle="",this._fontFeatureSettings="",this._fontVariationSettings="",this._textDecoration="",this._lineHeight="",this._letterSpacing="",this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(e){const t=ca(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){const t=ca(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){const t=ca(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){const t=ca(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){const t=ca(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){const t=ca(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){const t=ca(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingLeft(e){const t=ca(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){const t=ca(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){const t=ca(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){const t=ca(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}}function ca(s){return typeof s=="number"?`${s}px`:s}function Ct(s){return new oV(s)}function wn(s,e){s instanceof oV?(s.setFontFamily(e.getMassagedFontFamily()),s.setFontWeight(e.fontWeight),s.setFontSize(e.fontSize),s.setFontFeatureSettings(e.fontFeatureSettings),s.setFontVariationSettings(e.fontVariationSettings),s.setLineHeight(e.lineHeight),s.setLetterSpacing(e.letterSpacing)):(s.style.fontFamily=e.getMassagedFontFamily(),s.style.fontWeight=e.fontWeight,s.style.fontSize=e.fontSize+"px",s.style.fontFeatureSettings=e.fontFeatureSettings,s.style.fontVariationSettings=e.fontVariationSettings,s.style.lineHeight=e.lineHeight+"px",s.style.letterSpacing=e.letterSpacing+"px")}class Gte{constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}}class t2{constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(e){this._createDomElements(),e.document.body.appendChild(this._container),this._readFromDomElements(),this._container?.remove(),this._container=null,this._testElements=null}_createDomElements(){const e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";const t=document.createElement("div");wn(t,this._bareFontInfo),e.appendChild(t);const i=document.createElement("div");wn(i,this._bareFontInfo),i.style.fontWeight="bold",e.appendChild(i);const n=document.createElement("div");wn(n,this._bareFontInfo),n.style.fontStyle="italic",e.appendChild(n);const o=[];for(const r of this._requests){let a;r.type===0&&(a=t),r.type===2&&(a=i),r.type===1&&(a=n),a.appendChild(document.createElement("br"));const l=document.createElement("span");t2._render(l,r),a.appendChild(l),o.push(l)}this._container=e,this._testElements=o}static _render(e,t){if(t.chr===" "){let i="";for(let n=0;n<8;n++)i+=i;e.innerText=i}else{let i=t.chr;for(let n=0;n<8;n++)i+=i;e.textContent=i}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){const i=this._requests[e],n=this._testElements[e];i.fulfill(n.offsetWidth/256)}}}function Yte(s,e,t){new t2(e,t).read(s)}const lr=new class{constructor(){this._zoomLevel=0,this._onDidChangeZoomLevel=new O,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event}getZoomLevel(){return this._zoomLevel}setZoomLevel(s){s=Math.min(Math.max(-5,s),20),this._zoomLevel!==s&&(this._zoomLevel=s,this._onDidChangeZoomLevel.fire(this._zoomLevel))}},Xte=Qe?1.5:1.35,Gk=8;class ku{static createFromValidatedSettings(e,t,i){const n=e.get(49),o=e.get(53),r=e.get(52),a=e.get(51),l=e.get(54),c=e.get(67),d=e.get(64);return ku._create(n,o,r,a,l,c,d,t,i)}static _create(e,t,i,n,o,r,a,l,c){r===0?r=Xte*i:r<Gk&&(r=r*i),r=Math.round(r),r<Gk&&(r=Gk);const d=1+(c?0:lr.getZoomLevel()*.1);return i*=d,r*=d,o===gc.TRANSLATE&&(t==="normal"||t==="bold"?o=gc.OFF:(o=`'wght' ${parseInt(t,10)}`,t="normal")),new ku({pixelRatio:l,fontFamily:e,fontWeight:t,fontSize:i,fontFeatureSettings:n,fontVariationSettings:o,lineHeight:r,letterSpacing:a})}constructor(e){this._bareFontInfoBrand=void 0,this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.fontVariationSettings=e.fontVariationSettings,this.lineHeight=e.lineHeight|0,this.letterSpacing=e.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){const e=vs.fontFamily,t=ku._wrapInQuotes(this.fontFamily);return e&&this.fontFamily!==e?`${t}, ${e}`:t}static _wrapInQuotes(e){return/[,"']/.test(e)?e:/[+ ]/.test(e)?`"${e}"`:e}}const Qte=2;class lE extends ku{constructor(e,t){super(e),this._editorStylingBrand=void 0,this.version=Qte,this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}}class Jte extends B{constructor(){super(...arguments),this._cache=new Map,this._evictUntrustedReadingsTimeout=-1,this._onDidChange=this._register(new O),this.onDidChange=this._onDidChange.event}dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache.clear(),this._onDidChange.fire()}_ensureCache(e){const t=H1(e);let i=this._cache.get(t);return i||(i=new eie,this._cache.set(t,i)),i}_writeToCache(e,t,i){this._ensureCache(e).put(t,i),!i.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=e.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings(e)},5e3))}_evictUntrustedReadings(e){const t=this._ensureCache(e),i=t.getValues();let n=!1;for(const o of i)o.isTrusted||(n=!0,t.remove(o));n&&this._onDidChange.fire()}readFontInfo(e,t){const i=this._ensureCache(e);if(!i.has(t)){let n=this._actualReadFontInfo(e,t);(n.typicalHalfwidthCharacterWidth<=2||n.typicalFullwidthCharacterWidth<=2||n.spaceWidth<=2||n.maxDigitWidth<=2)&&(n=new lE({pixelRatio:qb.getInstance(e).value,fontFamily:n.fontFamily,fontWeight:n.fontWeight,fontSize:n.fontSize,fontFeatureSettings:n.fontFeatureSettings,fontVariationSettings:n.fontVariationSettings,lineHeight:n.lineHeight,letterSpacing:n.letterSpacing,isMonospace:n.isMonospace,typicalHalfwidthCharacterWidth:Math.max(n.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(n.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:n.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(n.spaceWidth,5),middotWidth:Math.max(n.middotWidth,5),wsmiddotWidth:Math.max(n.wsmiddotWidth,5),maxDigitWidth:Math.max(n.maxDigitWidth,5)},!1)),this._writeToCache(e,t,n)}return i.get(t)}_createRequest(e,t,i,n){const o=new Gte(e,t);return i.push(o),n?.push(o),o}_actualReadFontInfo(e,t){const i=[],n=[],o=this._createRequest("n",0,i,n),r=this._createRequest("",0,i,null),a=this._createRequest(" ",0,i,n),l=this._createRequest("0",0,i,n),c=this._createRequest("1",0,i,n),d=this._createRequest("2",0,i,n),h=this._createRequest("3",0,i,n),u=this._createRequest("4",0,i,n),g=this._createRequest("5",0,i,n),f=this._createRequest("6",0,i,n),m=this._createRequest("7",0,i,n),_=this._createRequest("8",0,i,n),b=this._createRequest("9",0,i,n),v=this._createRequest("",0,i,n),C=this._createRequest("",0,i,null),y=this._createRequest("",0,i,n),w=this._createRequest("",0,i,null),x="|/-_ilm%";for(let W=0,H=x.length;W<H;W++)this._createRequest(x.charAt(W),0,i,n),this._createRequest(x.charAt(W),1,i,n),this._createRequest(x.charAt(W),2,i,n);Yte(e,t,i);const L=Math.max(l.width,c.width,d.width,h.width,u.width,g.width,f.width,m.width,_.width,b.width);let D=t.fontFeatureSettings===Ur.OFF;const T=n[0].width;for(let W=1,H=n.length;D&&W<H;W++){const $=T-n[W].width;if($<-.001||$>.001){D=!1;break}}let F=!0;return D&&C.width!==T&&(F=!1),C.width>v.width&&(F=!1),new lE({pixelRatio:qb.getInstance(e).value,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,fontVariationSettings:t.fontVariationSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:D,typicalHalfwidthCharacterWidth:o.width,typicalFullwidthCharacterWidth:r.width,canUseHalfwidthRightwardsArrow:F,spaceWidth:a.width,middotWidth:y.width,wsmiddotWidth:w.width,maxDigitWidth:L},!0)}}class eie{constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){const t=e.getId();return!!this._values[t]}get(e){const t=e.getId();return this._values[t]}put(e,t){const i=e.getId();this._keys[i]=e,this._values[i]=t}remove(e){const t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map(e=>this._values[e])}}const cE=new Jte;var xa;(function(s){s.serviceIds=new Map,s.DI_TARGET="$di$target",s.DI_DEPENDENCIES="$di$dependencies";function e(t){return t[s.DI_DEPENDENCIES]||[]}s.getServiceDependencies=e})(xa||(xa={}));const ye=Je("instantiationService");function tie(s,e,t){e[xa.DI_TARGET]===e?e[xa.DI_DEPENDENCIES].push({id:s,index:t}):(e[xa.DI_DEPENDENCIES]=[{id:s,index:t}],e[xa.DI_TARGET]=e)}function Je(s){if(xa.serviceIds.has(s))return xa.serviceIds.get(s);const e=function(t,i,n){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");tie(e,t,n)};return e.toString=()=>s,xa.serviceIds.set(s,e),e}const ft=Je("codeEditorService"),Zt=Je("modelService"),qs=Je("textModelService");class ho extends B{constructor(e,t="",i="",n=!0,o){super(),this._onDidChange=this._register(new O),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._id=e,this._label=t,this._cssClass=i,this._enabled=n,this._actionCallback=o}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}}class Zu extends B{constructor(){super(...arguments),this._onWillRun=this._register(new O),this.onWillRun=this._onWillRun.event,this._onDidRun=this._register(new O),this.onDidRun=this._onDidRun.event}async run(e,t){if(!e.enabled)return;this._onWillRun.fire({action:e});let i;try{await this.runAction(e,t)}catch(n){i=n}this._onDidRun.fire({action:e,error:i})}async runAction(e,t){await e.run(t)}}class ji{constructor(){this.id=ji.ID,this.label="",this.tooltip="",this.class="separator",this.enabled=!1,this.checked=!1}static join(...e){let t=[];for(const i of e)i.length&&(t.length?t=[...t,new ji,...i]:t=i);return t}static{this.ID="vs.actions.separator"}async run(){}}class Lp{get actions(){return this._actions}constructor(e,t,i,n){this.tooltip="",this.enabled=!0,this.checked=void 0,this.id=e,this.label=t,this.class=n,this._actions=i}async run(){}}class i2 extends ho{static{this.ID="vs.actions.empty"}constructor(){super(i2.ID,p("submenu.empty","(empty)"),void 0,!1)}}function Du(s){return{id:s.id,label:s.label,tooltip:s.tooltip??s.label,class:s.class,enabled:s.enabled??!0,checked:s.checked,run:async(...e)=>s.run(...e)}}var dE;(function(s){function e(t){return t&&typeof t=="object"&&typeof t.id=="string"}s.isThemeColor=e})(dE||(dE={}));var Ie;(function(s){s.iconNameSegment="[A-Za-z0-9]+",s.iconNameExpression="[A-Za-z0-9-]+",s.iconModifierExpression="~[A-Za-z]+",s.iconNameCharacter="[A-Za-z0-9~-]";const e=new RegExp(`^(${s.iconNameExpression})(${s.iconModifierExpression})?$`);function t(u){const g=e.exec(u.id);if(!g)return t(J.error);const[,f,m]=g,_=["codicon","codicon-"+f];return m&&_.push("codicon-modifier-"+m.substring(1)),_}s.asClassNameArray=t;function i(u){return t(u).join(" ")}s.asClassName=i;function n(u){return"."+t(u).join(".")}s.asCSSSelector=n;function o(u){return u&&typeof u=="object"&&typeof u.id=="string"&&(typeof u.color>"u"||dE.isThemeColor(u.color))}s.isThemeIcon=o;const r=new RegExp(`^\\$\\((${s.iconNameExpression}(?:${s.iconModifierExpression})?)\\)$`);function a(u){const g=r.exec(u);if(!g)return;const[,f]=g;return{id:f}}s.fromString=a;function l(u){return{id:u}}s.fromId=l;function c(u,g){let f=u.id;const m=f.lastIndexOf("~");return m!==-1&&(f=f.substring(0,m)),g&&(f=`${f}~${g}`),{id:f}}s.modify=c;function d(u){const g=u.id.lastIndexOf("~");if(g!==-1)return u.id.substring(g+1)}s.getModifier=d;function h(u,g){return u.id===g.id&&u.color?.id===g.color?.id}s.isEqual=h})(Ie||(Ie={}));const Ht=Je("commandService"),ot=new class{constructor(){this._commands=new Map,this._onDidRegisterCommand=new O,this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(s,e){if(!s)throw new Error("invalid command");if(typeof s=="string"){if(!e)throw new Error("invalid command");return this.registerCommand({id:s,handler:e})}if(s.metadata&&Array.isArray(s.metadata.args)){const r=[];for(const l of s.metadata.args)r.push(l.constraint);const a=s.handler;s.handler=function(l,...c){return uQ(c,r),a(l,...c)}}const{id:t}=s;let i=this._commands.get(t);i||(i=new fs,this._commands.set(t,i));const n=i.unshift(s),o=Ce(()=>{n(),this._commands.get(t)?.isEmpty()&&this._commands.delete(t)});return this._onDidRegisterCommand.fire(t),o}registerCommandAlias(s,e){return ot.registerCommand(s,(t,...i)=>t.get(Ht).executeCommand(e,...i))}getCommand(s){const e=this._commands.get(s);if(!(!e||e.isEmpty()))return st.first(e)}getCommands(){const s=new Map;for(const e of this._commands.keys()){const t=this.getCommand(e);t&&s.set(e,t)}return s}};ot.registerCommand("noop",()=>{});function Yk(...s){switch(s.length){case 1:return p("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",s[0]);case 2:return p("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",s[0],s[1]);case 3:return p("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",s[0],s[1],s[2]);default:return}}const iie=p("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),nie=p("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'.");let Zm=class hE{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw NP(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}static{this._regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0)))}static{this._keywords=new Map([["not",14],["in",13],["false",12],["true",11]])}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){const t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){const t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(Yk("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(Yk("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(Yk("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){const t=this._start,i=this._input.substring(this._start,this._current),n={type:19,offset:this._start,lexeme:i};this._errors.push({offset:t,lexeme:i,additionalInfo:e}),this._tokens.push(n)}_string(){this.stringRe.lastIndex=this._start;const e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;const t=this._input.substring(this._start,this._current),i=hE._keywords.get(t);i?this._addToken(i):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(iie);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,i=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(nie);return}const o=this._input.charCodeAt(e);if(t)t=!1;else if(o===47&&!i){e++;break}else o===91?i=!0:o===92?t=!0:o===93&&(i=!1);e++}for(;e<this._input.length&&hE._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;const n=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:n,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};const Un=new Map;Un.set("false",!1);Un.set("true",!0);Un.set("isMac",Qe);Un.set("isLinux",ys);Un.set("isWindows",An);Un.set("isWeb",gg);Un.set("isMacNative",Qe&&!gg);Un.set("isEdge",DQ);Un.set("isFirefox",xQ);Un.set("isChrome",s6);Un.set("isSafari",kQ);const sie=Object.prototype.hasOwnProperty,oie={regexParsingWithErrorRecovery:!0},rie=p("contextkey.parser.error.emptyString","Empty context key expression"),aie=p("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),lie=p("contextkey.parser.error.noInAfterNot","'in' after 'not'."),K5=p("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),cie=p("contextkey.parser.error.unexpectedToken","Unexpected token"),die=p("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),hie=p("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),uie=p("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?");let gie=class y_{static{this._parseError=new Error}constructor(e=oie){this._config=e,this._scanner=new Zm,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(e){if(e===""){this._parsingErrors.push({message:rie,offset:0,lexeme:"",additionalInfo:aie});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{const t=this._expr();if(!this._isAtEnd()){const i=this._peek(),n=i.type===17?die:void 0;throw this._parsingErrors.push({message:cie,offset:i.offset,lexeme:Zm.getLexeme(i),additionalInfo:n}),y_._parseError}return t}catch(t){if(t!==y_._parseError)throw t;return}}_expr(){return this._or()}_or(){const e=[this._and()];for(;this._matchOne(16);){const t=this._and();e.push(t)}return e.length===1?e[0]:q.or(...e)}_and(){const e=[this._term()];for(;this._matchOne(15);){const t=this._term();e.push(t)}return e.length===1?e[0]:q.and(...e)}_term(){if(this._matchOne(2)){const e=this._peek();switch(e.type){case 11:return this._advance(),ws.INSTANCE;case 12:return this._advance(),$s.INSTANCE;case 0:{this._advance();const t=this._expr();return this._consume(1,K5),t?.negate()}case 17:return this._advance(),pg.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){const e=this._peek();switch(e.type){case 11:return this._advance(),q.true();case 12:return this._advance(),q.false();case 0:{this._advance();const t=this._expr();return this._consume(1,K5),t}case 17:{const t=e.lexeme;if(this._advance(),this._matchOne(9)){const n=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),n.type!==10)throw this._errExpectedButGot("REGEX",n);const o=n.lexeme,r=o.lastIndexOf("/"),a=r===o.length-1?void 0:this._removeFlagsGY(o.substring(r+1));let l;try{l=new RegExp(o.substring(1,r),a)}catch{throw this._errExpectedButGot("REGEX",n)}return Gb.create(t,l)}switch(n.type){case 10:case 19:{const o=[n.lexeme];this._advance();let r=this._peek(),a=0;for(let u=0;u<n.lexeme.length;u++)n.lexeme.charCodeAt(u)===40?a++:n.lexeme.charCodeAt(u)===41&&a--;for(;!this._isAtEnd()&&r.type!==15&&r.type!==16;){switch(r.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let u=0;u<r.lexeme.length;u++)r.lexeme.charCodeAt(u)===40?a++:n.lexeme.charCodeAt(u)===41&&a--}if(a<0)break;o.push(Zm.getLexeme(r)),this._advance(),r=this._peek()}const l=o.join(""),c=l.lastIndexOf("/"),d=c===l.length-1?void 0:this._removeFlagsGY(l.substring(c+1));let h;try{h=new RegExp(l.substring(1,c),d)}catch{throw this._errExpectedButGot("REGEX",n)}return q.regex(t,h)}case 18:{const o=n.lexeme;this._advance();let r=null;if(!x6(o)){const a=o.indexOf("/"),l=o.lastIndexOf("/");if(a!==l&&a>=0){const c=o.slice(a+1,l),d=o[l+1]==="i"?"i":"";try{r=new RegExp(c,d)}catch{throw this._errExpectedButGot("REGEX",n)}}}if(r===null)throw this._errExpectedButGot("REGEX",n);return Gb.create(t,r)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,lie);const n=this._value();return q.notIn(t,n)}switch(this._peek().type){case 3:{this._advance();const n=this._value();if(this._previous().type===18)return q.equals(t,n);switch(n){case"true":return q.has(t);case"false":return q.not(t);default:return q.equals(t,n)}}case 4:{this._advance();const n=this._value();if(this._previous().type===18)return q.notEquals(t,n);switch(n){case"true":return q.not(t);case"false":return q.has(t);default:return q.notEquals(t,n)}}case 5:return this._advance(),NL.create(t,this._value());case 6:return this._advance(),RL.create(t,this._value());case 7:return this._advance(),TL.create(t,this._value());case 8:return this._advance(),EL.create(t,this._value());case 13:return this._advance(),q.in(t,this._value());default:return q.has(t)}}case 20:throw this._parsingErrors.push({message:hie,offset:e.offset,lexeme:"",additionalInfo:uie}),y_._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,i){const n=p("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,e,Zm.getLexeme(t)),o=t.offset,r=Zm.getLexeme(t);return this._parsingErrors.push({message:n,offset:o,lexeme:r,additionalInfo:i}),y_._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}};class q{static false(){return ws.INSTANCE}static true(){return $s.INSTANCE}static has(e){return fg.create(e)}static equals(e,t){return _m.create(e,t)}static notEquals(e,t){return DL.create(e,t)}static regex(e,t){return Gb.create(e,t)}static in(e,t){return xL.create(e,t)}static notIn(e,t){return kL.create(e,t)}static not(e){return pg.create(e)}static and(...e){return _u.create(e,null,!0)}static or(...e){return pc.create(e,null,!0)}static{this._parser=new gie({regexParsingWithErrorRecovery:!1})}static deserialize(e){return e==null?void 0:this._parser.parse(e)}}function fie(s,e){const t=s?s.substituteConstants():void 0,i=e?e.substituteConstants():void 0;return!t&&!i?!0:!t||!i?!1:t.equals(i)}function G_(s,e){return s.cmp(e)}class ws{static{this.INSTANCE=new ws}constructor(){this.type=0}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}negate(){return $s.INSTANCE}}class $s{static{this.INSTANCE=new $s}constructor(){this.type=1}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}negate(){return ws.INSTANCE}}class fg{static create(e,t=null){const i=Un.get(e);return typeof i=="boolean"?i?$s.INSTANCE:ws.INSTANCE:new fg(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=2}cmp(e){return e.type!==this.type?this.type-e.type:aV(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=Un.get(this.key);return typeof e=="boolean"?e?$s.INSTANCE:ws.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}negate(){return this.negated||(this.negated=pg.create(this.key,this)),this.negated}}class _m{static create(e,t,i=null){if(typeof t=="boolean")return t?fg.create(e,i):pg.create(e,i);const n=Un.get(e);return typeof n=="boolean"?t===(n?"true":"false")?$s.INSTANCE:ws.INSTANCE:new _m(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=4}cmp(e){return e.type!==this.type?this.type-e.type:mg(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=Un.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?$s.INSTANCE:ws.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=DL.create(this.key,this.value,this)),this.negated}}class xL{static create(e,t){return new xL(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=10,this.negated=null}cmp(e){return e.type!==this.type?this.type-e.type:mg(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.valueKey),i=e.getValue(this.key);return Array.isArray(t)?t.includes(i):typeof i=="string"&&typeof t=="object"&&t!==null?sie.call(t,i):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}negate(){return this.negated||(this.negated=kL.create(this.key,this.valueKey)),this.negated}}class kL{static create(e,t){return new kL(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=11,this._negated=xL.create(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}negate(){return this._negated}}class DL{static create(e,t,i=null){if(typeof t=="boolean")return t?pg.create(e,i):fg.create(e,i);const n=Un.get(e);return typeof n=="boolean"?t===(n?"true":"false")?ws.INSTANCE:$s.INSTANCE:new DL(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=5}cmp(e){return e.type!==this.type?this.type-e.type:mg(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=Un.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?ws.INSTANCE:$s.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=_m.create(this.key,this.value,this)),this.negated}}class pg{static create(e,t=null){const i=Un.get(e);return typeof i=="boolean"?i?ws.INSTANCE:$s.INSTANCE:new pg(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=3}cmp(e){return e.type!==this.type?this.type-e.type:aV(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=Un.get(this.key);return typeof e=="boolean"?e?ws.INSTANCE:$s.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=fg.create(this.key,this)),this.negated}}function IL(s,e){if(typeof s=="string"){const t=parseFloat(s);isNaN(t)||(s=t)}return typeof s=="string"||typeof s=="number"?e(s):ws.INSTANCE}class TL{static create(e,t,i=null){return IL(t,n=>new TL(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=12}cmp(e){return e.type!==this.type?this.type-e.type:mg(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=RL.create(this.key,this.value,this)),this.negated}}class EL{static create(e,t,i=null){return IL(t,n=>new EL(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=13}cmp(e){return e.type!==this.type?this.type-e.type:mg(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=NL.create(this.key,this.value,this)),this.negated}}class NL{static create(e,t,i=null){return IL(t,n=>new NL(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=14}cmp(e){return e.type!==this.type?this.type-e.type:mg(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=EL.create(this.key,this.value,this)),this.negated}}class RL{static create(e,t,i=null){return IL(t,n=>new RL(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=15}cmp(e){return e.type!==this.type?this.type-e.type:mg(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=TL.create(this.key,this.value,this)),this.negated}}class Gb{static create(e,t){return new Gb(e,t)}constructor(e,t){this.key=e,this.regexp=t,this.type=7,this.negated=null}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return t<i?-1:t>i?1:0}equals(e){if(e.type===this.type){const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return this.key===e.key&&t===i}return!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=n2.create(this)),this.negated}}class n2{static create(e){return new n2(e)}constructor(e){this._actual=e,this.type=8}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}negate(){return this._actual}}function rV(s){let e=null;for(let t=0,i=s.length;t<i;t++){const n=s[t].substituteConstants();if(s[t]!==n&&e===null){e=[];for(let o=0;o<t;o++)e[o]=s[o]}e!==null&&(e[t]=n)}return e===null?s:e}class _u{static create(e,t,i){return _u._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=6}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const n=G_(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=rV(this.expr);return e===this.expr?this:_u.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,i){const n=[];let o=!1;for(const r of e)if(r){if(r.type===1){o=!0;continue}if(r.type===0)return ws.INSTANCE;if(r.type===6){n.push(...r.expr);continue}n.push(r)}if(n.length===0&&o)return $s.INSTANCE;if(n.length!==0){if(n.length===1)return n[0];n.sort(G_);for(let r=1;r<n.length;r++)n[r-1].equals(n[r])&&(n.splice(r,1),r--);if(n.length===1)return n[0];for(;n.length>1;){const r=n[n.length-1];if(r.type!==9)break;n.pop();const a=n.pop(),l=n.length===0,c=pc.create(r.expr.map(d=>_u.create([d,a],null,i)),null,l);c&&(n.push(c),n.sort(G_))}if(n.length===1)return n[0];if(i){for(let r=0;r<n.length;r++)for(let a=r+1;a<n.length;a++)if(n[r].negate().equals(n[a]))return ws.INSTANCE;if(n.length===1)return n[0]}return new _u(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());this.negated=pc.create(e,this,!0)}return this.negated}}class pc{static create(e,t,i){return pc._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=9}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const n=G_(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=rV(this.expr);return e===this.expr?this:pc.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,i){let n=[],o=!1;if(e){for(let r=0,a=e.length;r<a;r++){const l=e[r];if(l){if(l.type===0){o=!0;continue}if(l.type===1)return $s.INSTANCE;if(l.type===9){n=n.concat(l.expr);continue}n.push(l)}}if(n.length===0&&o)return ws.INSTANCE;n.sort(G_)}if(n.length!==0){if(n.length===1)return n[0];for(let r=1;r<n.length;r++)n[r-1].equals(n[r])&&(n.splice(r,1),r--);if(n.length===1)return n[0];if(i){for(let r=0;r<n.length;r++)for(let a=r+1;a<n.length;a++)if(n[r].negate().equals(n[a]))return $s.INSTANCE;if(n.length===1)return n[0]}return new pc(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());for(;e.length>1;){const t=e.shift(),i=e.shift(),n=[];for(const o of G5(t))for(const r of G5(i))n.push(_u.create([o,r],null,!1));e.unshift(pc.create(n,null,!1))}this.negated=pc.create(e,this,!0)}return this.negated}}class le extends fg{static{this._info=[]}static all(){return le._info.values()}constructor(e,t,i){super(e,null),this._defaultValue=t,typeof i=="object"?le._info.push({...i,key:e}):i!==!0&&le._info.push({key:e,description:i,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return _m.create(this.key,e)}}const Ee=Je("contextKeyService");function aV(s,e){return s<e?-1:s>e?1:0}function mg(s,e,t,i){return s<t?-1:s>t?1:e<i?-1:e>i?1:0}function uE(s,e){if(s.type===0||e.type===1)return!0;if(s.type===9)return e.type===9?q5(s.expr,e.expr):!1;if(e.type===9){for(const t of e.expr)if(uE(s,t))return!0;return!1}if(s.type===6){if(e.type===6)return q5(e.expr,s.expr);for(const t of s.expr)if(uE(t,e))return!0;return!1}return s.equals(e)}function q5(s,e){let t=0,i=0;for(;t<s.length&&i<e.length;){const n=s[t].cmp(e[i]);if(n<0)return!1;n===0&&t++,i++}return t===s.length}function G5(s){return s.type===9?s.expr:[s]}function Xk(s,e){if(!s)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function ML(s,e="Unreachable"){throw new Error(e)}function Y5(s){s||Oe(new mt("Soft Assertion Failed"))}function Ku(s){if(!s()){debugger;s(),Oe(new mt("Assertion Failed"))}}function s2(s,e){let t=0;for(;t<s.length-1;){const i=s[t],n=s[t+1];if(!e(i,n))return!1;t++}return!0}class pie{constructor(){this.data=new Map}add(e,t){Xk(zs(e)),Xk(dn(t)),Xk(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}as(e){return this.data.get(e)||null}}const ci=new pie;class o2{constructor(){this._coreKeybindings=new fs,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(lo===1){if(e&&e.win)return e.win}else if(lo===2){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){const t=o2.bindToCurrentPlatform(e),i=new Z;if(t&&t.primary){const n=eE(t.primary,lo);n&&i.add(this._registerDefaultKeybinding(n,e.id,e.args,e.weight,0,e.when))}if(t&&Array.isArray(t.secondary))for(let n=0,o=t.secondary.length;n<o;n++){const r=t.secondary[n],a=eE(r,lo);a&&i.add(this._registerDefaultKeybinding(a,e.id,e.args,e.weight,-n-1,e.when))}return i}registerCommandAndKeybindingRule(e){return Gr(this.registerKeybindingRule(e),ot.registerCommand(e))}_registerDefaultKeybinding(e,t,i,n,o,r){const a=this._coreKeybindings.push({keybinding:e,command:t,commandArgs:i,when:r,weight1:n,weight2:o,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,Ce(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(_ie)),this._cachedMergedKeybindings.slice(0)}}const Ss=new o2,mie={EditorModes:"platform.keybindingsRegistry"};ci.add(mie.EditorModes,Ss);function _ie(s,e){if(s.weight1!==e.weight1)return s.weight1-e.weight1;if(s.command&&e.command){if(s.command<e.command)return-1;if(s.command>e.command)return 1}return s.weight2-e.weight2}var bie=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},X5=function(s,e){return function(t,i){e(t,i,s)}},Aw;function Kf(s){return s.command!==void 0}function vie(s){return s.submenu!==void 0}class M{static{this._instances=new Map}static{this.CommandPalette=new M("CommandPalette")}static{this.DebugBreakpointsContext=new M("DebugBreakpointsContext")}static{this.DebugCallStackContext=new M("DebugCallStackContext")}static{this.DebugConsoleContext=new M("DebugConsoleContext")}static{this.DebugVariablesContext=new M("DebugVariablesContext")}static{this.NotebookVariablesContext=new M("NotebookVariablesContext")}static{this.DebugHoverContext=new M("DebugHoverContext")}static{this.DebugWatchContext=new M("DebugWatchContext")}static{this.DebugToolBar=new M("DebugToolBar")}static{this.DebugToolBarStop=new M("DebugToolBarStop")}static{this.DebugCallStackToolbar=new M("DebugCallStackToolbar")}static{this.DebugCreateConfiguration=new M("DebugCreateConfiguration")}static{this.EditorContext=new M("EditorContext")}static{this.SimpleEditorContext=new M("SimpleEditorContext")}static{this.EditorContent=new M("EditorContent")}static{this.EditorLineNumberContext=new M("EditorLineNumberContext")}static{this.EditorContextCopy=new M("EditorContextCopy")}static{this.EditorContextPeek=new M("EditorContextPeek")}static{this.EditorContextShare=new M("EditorContextShare")}static{this.EditorTitle=new M("EditorTitle")}static{this.EditorTitleRun=new M("EditorTitleRun")}static{this.EditorTitleContext=new M("EditorTitleContext")}static{this.EditorTitleContextShare=new M("EditorTitleContextShare")}static{this.EmptyEditorGroup=new M("EmptyEditorGroup")}static{this.EmptyEditorGroupContext=new M("EmptyEditorGroupContext")}static{this.EditorTabsBarContext=new M("EditorTabsBarContext")}static{this.EditorTabsBarShowTabsSubmenu=new M("EditorTabsBarShowTabsSubmenu")}static{this.EditorTabsBarShowTabsZenModeSubmenu=new M("EditorTabsBarShowTabsZenModeSubmenu")}static{this.EditorActionsPositionSubmenu=new M("EditorActionsPositionSubmenu")}static{this.ExplorerContext=new M("ExplorerContext")}static{this.ExplorerContextShare=new M("ExplorerContextShare")}static{this.ExtensionContext=new M("ExtensionContext")}static{this.GlobalActivity=new M("GlobalActivity")}static{this.CommandCenter=new M("CommandCenter")}static{this.CommandCenterCenter=new M("CommandCenterCenter")}static{this.LayoutControlMenuSubmenu=new M("LayoutControlMenuSubmenu")}static{this.LayoutControlMenu=new M("LayoutControlMenu")}static{this.MenubarMainMenu=new M("MenubarMainMenu")}static{this.MenubarAppearanceMenu=new M("MenubarAppearanceMenu")}static{this.MenubarDebugMenu=new M("MenubarDebugMenu")}static{this.MenubarEditMenu=new M("MenubarEditMenu")}static{this.MenubarCopy=new M("MenubarCopy")}static{this.MenubarFileMenu=new M("MenubarFileMenu")}static{this.MenubarGoMenu=new M("MenubarGoMenu")}static{this.MenubarHelpMenu=new M("MenubarHelpMenu")}static{this.MenubarLayoutMenu=new M("MenubarLayoutMenu")}static{this.MenubarNewBreakpointMenu=new M("MenubarNewBreakpointMenu")}static{this.PanelAlignmentMenu=new M("PanelAlignmentMenu")}static{this.PanelPositionMenu=new M("PanelPositionMenu")}static{this.ActivityBarPositionMenu=new M("ActivityBarPositionMenu")}static{this.MenubarPreferencesMenu=new M("MenubarPreferencesMenu")}static{this.MenubarRecentMenu=new M("MenubarRecentMenu")}static{this.MenubarSelectionMenu=new M("MenubarSelectionMenu")}static{this.MenubarShare=new M("MenubarShare")}static{this.MenubarSwitchEditorMenu=new M("MenubarSwitchEditorMenu")}static{this.MenubarSwitchGroupMenu=new M("MenubarSwitchGroupMenu")}static{this.MenubarTerminalMenu=new M("MenubarTerminalMenu")}static{this.MenubarViewMenu=new M("MenubarViewMenu")}static{this.MenubarHomeMenu=new M("MenubarHomeMenu")}static{this.OpenEditorsContext=new M("OpenEditorsContext")}static{this.OpenEditorsContextShare=new M("OpenEditorsContextShare")}static{this.ProblemsPanelContext=new M("ProblemsPanelContext")}static{this.SCMInputBox=new M("SCMInputBox")}static{this.SCMChangesSeparator=new M("SCMChangesSeparator")}static{this.SCMChangesContext=new M("SCMChangesContext")}static{this.SCMIncomingChanges=new M("SCMIncomingChanges")}static{this.SCMIncomingChangesContext=new M("SCMIncomingChangesContext")}static{this.SCMIncomingChangesSetting=new M("SCMIncomingChangesSetting")}static{this.SCMOutgoingChanges=new M("SCMOutgoingChanges")}static{this.SCMOutgoingChangesContext=new M("SCMOutgoingChangesContext")}static{this.SCMOutgoingChangesSetting=new M("SCMOutgoingChangesSetting")}static{this.SCMIncomingChangesAllChangesContext=new M("SCMIncomingChangesAllChangesContext")}static{this.SCMIncomingChangesHistoryItemContext=new M("SCMIncomingChangesHistoryItemContext")}static{this.SCMOutgoingChangesAllChangesContext=new M("SCMOutgoingChangesAllChangesContext")}static{this.SCMOutgoingChangesHistoryItemContext=new M("SCMOutgoingChangesHistoryItemContext")}static{this.SCMChangeContext=new M("SCMChangeContext")}static{this.SCMResourceContext=new M("SCMResourceContext")}static{this.SCMResourceContextShare=new M("SCMResourceContextShare")}static{this.SCMResourceFolderContext=new M("SCMResourceFolderContext")}static{this.SCMResourceGroupContext=new M("SCMResourceGroupContext")}static{this.SCMSourceControl=new M("SCMSourceControl")}static{this.SCMSourceControlInline=new M("SCMSourceControlInline")}static{this.SCMSourceControlTitle=new M("SCMSourceControlTitle")}static{this.SCMHistoryTitle=new M("SCMHistoryTitle")}static{this.SCMTitle=new M("SCMTitle")}static{this.SearchContext=new M("SearchContext")}static{this.SearchActionMenu=new M("SearchActionContext")}static{this.StatusBarWindowIndicatorMenu=new M("StatusBarWindowIndicatorMenu")}static{this.StatusBarRemoteIndicatorMenu=new M("StatusBarRemoteIndicatorMenu")}static{this.StickyScrollContext=new M("StickyScrollContext")}static{this.TestItem=new M("TestItem")}static{this.TestItemGutter=new M("TestItemGutter")}static{this.TestProfilesContext=new M("TestProfilesContext")}static{this.TestMessageContext=new M("TestMessageContext")}static{this.TestMessageContent=new M("TestMessageContent")}static{this.TestPeekElement=new M("TestPeekElement")}static{this.TestPeekTitle=new M("TestPeekTitle")}static{this.TestCallStack=new M("TestCallStack")}static{this.TouchBarContext=new M("TouchBarContext")}static{this.TitleBarContext=new M("TitleBarContext")}static{this.TitleBarTitleContext=new M("TitleBarTitleContext")}static{this.TunnelContext=new M("TunnelContext")}static{this.TunnelPrivacy=new M("TunnelPrivacy")}static{this.TunnelProtocol=new M("TunnelProtocol")}static{this.TunnelPortInline=new M("TunnelInline")}static{this.TunnelTitle=new M("TunnelTitle")}static{this.TunnelLocalAddressInline=new M("TunnelLocalAddressInline")}static{this.TunnelOriginInline=new M("TunnelOriginInline")}static{this.ViewItemContext=new M("ViewItemContext")}static{this.ViewContainerTitle=new M("ViewContainerTitle")}static{this.ViewContainerTitleContext=new M("ViewContainerTitleContext")}static{this.ViewTitle=new M("ViewTitle")}static{this.ViewTitleContext=new M("ViewTitleContext")}static{this.CommentEditorActions=new M("CommentEditorActions")}static{this.CommentThreadTitle=new M("CommentThreadTitle")}static{this.CommentThreadActions=new M("CommentThreadActions")}static{this.CommentThreadAdditionalActions=new M("CommentThreadAdditionalActions")}static{this.CommentThreadTitleContext=new M("CommentThreadTitleContext")}static{this.CommentThreadCommentContext=new M("CommentThreadCommentContext")}static{this.CommentTitle=new M("CommentTitle")}static{this.CommentActions=new M("CommentActions")}static{this.CommentsViewThreadActions=new M("CommentsViewThreadActions")}static{this.InteractiveToolbar=new M("InteractiveToolbar")}static{this.InteractiveCellTitle=new M("InteractiveCellTitle")}static{this.InteractiveCellDelete=new M("InteractiveCellDelete")}static{this.InteractiveCellExecute=new M("InteractiveCellExecute")}static{this.InteractiveInputExecute=new M("InteractiveInputExecute")}static{this.InteractiveInputConfig=new M("InteractiveInputConfig")}static{this.ReplInputExecute=new M("ReplInputExecute")}static{this.IssueReporter=new M("IssueReporter")}static{this.NotebookToolbar=new M("NotebookToolbar")}static{this.NotebookStickyScrollContext=new M("NotebookStickyScrollContext")}static{this.NotebookCellTitle=new M("NotebookCellTitle")}static{this.NotebookCellDelete=new M("NotebookCellDelete")}static{this.NotebookCellInsert=new M("NotebookCellInsert")}static{this.NotebookCellBetween=new M("NotebookCellBetween")}static{this.NotebookCellListTop=new M("NotebookCellTop")}static{this.NotebookCellExecute=new M("NotebookCellExecute")}static{this.NotebookCellExecuteGoTo=new M("NotebookCellExecuteGoTo")}static{this.NotebookCellExecutePrimary=new M("NotebookCellExecutePrimary")}static{this.NotebookDiffCellInputTitle=new M("NotebookDiffCellInputTitle")}static{this.NotebookDiffCellMetadataTitle=new M("NotebookDiffCellMetadataTitle")}static{this.NotebookDiffCellOutputsTitle=new M("NotebookDiffCellOutputsTitle")}static{this.NotebookOutputToolbar=new M("NotebookOutputToolbar")}static{this.NotebookOutlineFilter=new M("NotebookOutlineFilter")}static{this.NotebookOutlineActionMenu=new M("NotebookOutlineActionMenu")}static{this.NotebookEditorLayoutConfigure=new M("NotebookEditorLayoutConfigure")}static{this.NotebookKernelSource=new M("NotebookKernelSource")}static{this.BulkEditTitle=new M("BulkEditTitle")}static{this.BulkEditContext=new M("BulkEditContext")}static{this.TimelineItemContext=new M("TimelineItemContext")}static{this.TimelineTitle=new M("TimelineTitle")}static{this.TimelineTitleContext=new M("TimelineTitleContext")}static{this.TimelineFilterSubMenu=new M("TimelineFilterSubMenu")}static{this.AccountsContext=new M("AccountsContext")}static{this.SidebarTitle=new M("SidebarTitle")}static{this.PanelTitle=new M("PanelTitle")}static{this.AuxiliaryBarTitle=new M("AuxiliaryBarTitle")}static{this.AuxiliaryBarHeader=new M("AuxiliaryBarHeader")}static{this.TerminalInstanceContext=new M("TerminalInstanceContext")}static{this.TerminalEditorInstanceContext=new M("TerminalEditorInstanceContext")}static{this.TerminalNewDropdownContext=new M("TerminalNewDropdownContext")}static{this.TerminalTabContext=new M("TerminalTabContext")}static{this.TerminalTabEmptyAreaContext=new M("TerminalTabEmptyAreaContext")}static{this.TerminalStickyScrollContext=new M("TerminalStickyScrollContext")}static{this.WebviewContext=new M("WebviewContext")}static{this.InlineCompletionsActions=new M("InlineCompletionsActions")}static{this.InlineEditsActions=new M("InlineEditsActions")}static{this.InlineEditActions=new M("InlineEditActions")}static{this.NewFile=new M("NewFile")}static{this.MergeInput1Toolbar=new M("MergeToolbar1Toolbar")}static{this.MergeInput2Toolbar=new M("MergeToolbar2Toolbar")}static{this.MergeBaseToolbar=new M("MergeBaseToolbar")}static{this.MergeInputResultToolbar=new M("MergeToolbarResultToolbar")}static{this.InlineSuggestionToolbar=new M("InlineSuggestionToolbar")}static{this.InlineEditToolbar=new M("InlineEditToolbar")}static{this.ChatContext=new M("ChatContext")}static{this.ChatCodeBlock=new M("ChatCodeblock")}static{this.ChatCompareBlock=new M("ChatCompareBlock")}static{this.ChatMessageTitle=new M("ChatMessageTitle")}static{this.ChatExecute=new M("ChatExecute")}static{this.ChatExecuteSecondary=new M("ChatExecuteSecondary")}static{this.ChatInputSide=new M("ChatInputSide")}static{this.AccessibleView=new M("AccessibleView")}static{this.MultiDiffEditorFileToolbar=new M("MultiDiffEditorFileToolbar")}static{this.DiffEditorHunkToolbar=new M("DiffEditorHunkToolbar")}static{this.DiffEditorSelectionToolbar=new M("DiffEditorSelectionToolbar")}constructor(e){if(M._instances.has(e))throw new TypeError(`MenuId with identifier '${e}' already exists. Use MenuId.for(ident) or a unique identifier`);M._instances.set(e,this),this.id=e}}const qo=Je("menuService");class bd{static{this._all=new Map}static for(e){let t=this._all.get(e);return t||(t=new bd(e),this._all.set(e,t)),t}static merge(e){const t=new Set;for(const i of e)i instanceof bd&&t.add(i.id);return t}constructor(e){this.id=e,this.has=t=>t===e}}const hn=new class{constructor(){this._commands=new Map,this._menuItems=new Map,this._onDidChangeMenu=new MJ({merge:bd.merge}),this.onDidChangeMenu=this._onDidChangeMenu.event}addCommand(s){return this._commands.set(s.id,s),this._onDidChangeMenu.fire(bd.for(M.CommandPalette)),Ce(()=>{this._commands.delete(s.id)&&this._onDidChangeMenu.fire(bd.for(M.CommandPalette))})}getCommand(s){return this._commands.get(s)}getCommands(){const s=new Map;return this._commands.forEach((e,t)=>s.set(t,e)),s}appendMenuItem(s,e){let t=this._menuItems.get(s);t||(t=new fs,this._menuItems.set(s,t));const i=t.push(e);return this._onDidChangeMenu.fire(bd.for(s)),Ce(()=>{i(),this._onDidChangeMenu.fire(bd.for(s))})}appendMenuItems(s){const e=new Z;for(const{id:t,item:i}of s)e.add(this.appendMenuItem(t,i));return e}getMenuItems(s){let e;return this._menuItems.has(s)?e=[...this._menuItems.get(s)]:e=[],s===M.CommandPalette&&this._appendImplicitItems(e),e}_appendImplicitItems(s){const e=new Set;for(const t of s)Kf(t)&&(e.add(t.command.id),t.alt&&e.add(t.alt.id));this._commands.forEach((t,i)=>{e.has(i)||s.push({command:t})})}};class qf extends Lp{constructor(e,t,i){super(`submenuitem.${e.submenu.id}`,typeof e.title=="string"?e.title:e.title.value,i,"submenu"),this.item=e,this.hideActions=t}}let uo=Aw=class{static label(e,t){return t?.renderShortTitle&&e.shortTitle?typeof e.shortTitle=="string"?e.shortTitle:e.shortTitle.value:typeof e.title=="string"?e.title:e.title.value}constructor(e,t,i,n,o,r,a){this.hideActions=n,this.menuKeybinding=o,this._commandService=a,this.id=e.id,this.label=Aw.label(e,i),this.tooltip=(typeof e.tooltip=="string"?e.tooltip:e.tooltip?.value)??"",this.enabled=!e.precondition||r.contextMatchesRules(e.precondition),this.checked=void 0;let l;if(e.toggled){const c=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=r.contextMatchesRules(c.condition),this.checked&&c.tooltip&&(this.tooltip=typeof c.tooltip=="string"?c.tooltip:c.tooltip.value),this.checked&&Ie.isThemeIcon(c.icon)&&(l=c.icon),this.checked&&c.title&&(this.label=typeof c.title=="string"?c.title:c.title.value)}l||(l=Ie.isThemeIcon(e.icon)?e.icon:void 0),this.item=e,this.alt=t?new Aw(t,void 0,i,n,void 0,r,a):void 0,this._options=i,this.class=l&&Ie.asClassName(l)}run(...e){let t=[];return this._options?.arg&&(t=[...t,this._options.arg]),this._options?.shouldForwardArgs&&(t=[...t,...e]),this._commandService.executeCommand(this.id,...t)}};uo=Aw=bie([X5(5,Ee),X5(6,Ht)],uo);class ks{constructor(e){this.desc=e}}function Bt(s){const e=[],t=new s,{f1:i,menu:n,keybinding:o,...r}=t.desc;if(ot.getCommand(r.id))throw new Error(`Cannot register two commands with the same id: ${r.id}`);if(e.push(ot.registerCommand({id:r.id,handler:(a,...l)=>t.run(a,...l),metadata:r.metadata})),Array.isArray(n))for(const a of n)e.push(hn.appendMenuItem(a.id,{command:{...r,precondition:a.precondition===null?void 0:r.precondition},...a}));else n&&e.push(hn.appendMenuItem(n.id,{command:{...r,precondition:n.precondition===null?void 0:r.precondition},...n}));if(i&&(e.push(hn.appendMenuItem(M.CommandPalette,{command:r,when:r.precondition})),e.push(hn.addCommand(r))),Array.isArray(o))for(const a of o)e.push(Ss.registerKeybindingRule({...a,id:r.id,when:r.precondition?q.and(r.precondition,a.when):a.when}));else o&&e.push(Ss.registerKeybindingRule({...o,id:r.id,when:r.precondition?q.and(r.precondition,o.when):o.when}));return{dispose(){At(e)}}}const jn=Je("telemetryService"),Pn=Je("logService");var Fs;(function(s){s[s.Off=0]="Off",s[s.Trace=1]="Trace",s[s.Debug=2]="Debug",s[s.Info=3]="Info",s[s.Warning=4]="Warning",s[s.Error=5]="Error"})(Fs||(Fs={}));const lV=Fs.Info;class cV extends B{constructor(){super(...arguments),this.level=lV,this._onDidChangeLogLevel=this._register(new O),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(e){return this.level!==Fs.Off&&this.level<=e}}class Cie extends cV{constructor(e=lV,t=!0){super(),this.useColors=t,this.setLevel(e)}trace(e,...t){this.checkLogLevel(Fs.Trace)&&(this.useColors?console.log("%cTRACE","color: #888",e,...t):console.log(e,...t))}debug(e,...t){this.checkLogLevel(Fs.Debug)&&(this.useColors?console.log("%cDEBUG","background: #eee; color: #888",e,...t):console.log(e,...t))}info(e,...t){this.checkLogLevel(Fs.Info)&&(this.useColors?console.log("%c INFO","color: #33f",e,...t):console.log(e,...t))}warn(e,...t){this.checkLogLevel(Fs.Warning)&&(this.useColors?console.log("%c WARN","color: #993",e,...t):console.log(e,...t))}error(e,...t){this.checkLogLevel(Fs.Error)&&(this.useColors?console.log("%c  ERR","color: #f33",e,...t):console.error(e,...t))}}class yie extends cV{constructor(e){super(),this.loggers=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const t of this.loggers)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(const i of this.loggers)i.trace(e,...t)}debug(e,...t){for(const i of this.loggers)i.debug(e,...t)}info(e,...t){for(const i of this.loggers)i.info(e,...t)}warn(e,...t){for(const i of this.loggers)i.warn(e,...t)}error(e,...t){for(const i of this.loggers)i.error(e,...t)}dispose(){for(const e of this.loggers)e.dispose();super.dispose()}}function wie(s){switch(s){case Fs.Trace:return"trace";case Fs.Debug:return"debug";case Fs.Info:return"info";case Fs.Warning:return"warn";case Fs.Error:return"error";case Fs.Off:return"off"}}new le("logLevel",wie(Fs.Info));class AL{constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this.metadata=e.metadata}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){const e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(const t of e){let i=t.kbExpr;this.precondition&&(i?i=q.and(i,this.precondition):i=this.precondition);const n={id:this.id,weight:t.weight,args:t.args,when:i,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};Ss.registerKeybindingRule(n)}}ot.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),metadata:this.metadata})}_registerMenuItem(e){hn.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}}class bm extends AL{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t,i,n){return this._implementations.push({priority:e,name:t,implementation:i,when:n}),this._implementations.sort((o,r)=>r.priority-o.priority),{dispose:()=>{for(let o=0;o<this._implementations.length;o++)if(this._implementations[o].implementation===i){this._implementations.splice(o,1);return}}}}runCommand(e,t){const i=e.get(Pn),n=e.get(Ee);i.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(const o of this._implementations){if(o.when){const a=n.getContext(Rn());if(!o.when.evaluate(a))continue}const r=o.implementation(e,t);if(r)return i.trace(`Command '${this.id}' was handled by '${o.name}'.`),typeof r=="boolean"?void 0:r}i.trace(`The Command '${this.id}' was not handled by any implementation.`)}}class dV extends AL{constructor(e,t){super(t),this.command=e}runCommand(e,t){return this.command.runCommand(e,t)}}class Zi extends AL{static bindToContribution(e){return class extends Zi{constructor(i){super(i),this._callback=i.handler}runEditorCommand(i,n,o){const r=e(n);r&&this._callback(r,o)}}}static runEditorCommand(e,t,i,n){const o=e.get(ft),r=o.getFocusedCodeEditor()||o.getActiveCodeEditor();if(r)return r.invokeWithinContext(a=>{if(a.get(Ee).contextMatchesRules(i??void 0))return n(a,r,t)})}runCommand(e,t){return Zi.runEditorCommand(e,t,this.precondition,(i,n,o)=>this.runEditorCommand(i,n,o))}}class ge extends Zi{static convertOptions(e){let t;Array.isArray(e.menuOpts)?t=e.menuOpts:e.menuOpts?t=[e.menuOpts]:t=[];function i(n){return n.menuId||(n.menuId=M.EditorContext),n.title||(n.title=e.label),n.when=q.and(e.precondition,n.when),n}return Array.isArray(e.contextMenuOpts)?t.push(...e.contextMenuOpts.map(i)):e.contextMenuOpts&&t.push(i(e.contextMenuOpts)),e.menuOpts=t,e}constructor(e){super(ge.convertOptions(e)),this.label=e.label,this.alias=e.alias}runEditorCommand(e,t,i){return this.reportTelemetry(e,t),this.run(e,t,i||{})}reportTelemetry(e,t){e.get(jn).publicLog2("editorActionInvoked",{name:this.label,id:this.id})}}class hV extends ge{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t){return this._implementations.push([e,t]),this._implementations.sort((i,n)=>n[0]-i[0]),{dispose:()=>{for(let i=0;i<this._implementations.length;i++)if(this._implementations[i][1]===t){this._implementations.splice(i,1);return}}}}run(e,t,i){for(const n of this._implementations){const o=n[1](e,t,i);if(o)return typeof o=="boolean"?void 0:o}}}class Za extends ks{run(e,...t){const i=e.get(ft),n=i.getFocusedCodeEditor()||i.getActiveCodeEditor();if(n)return n.invokeWithinContext(o=>{const r=o.get(Ee),a=o.get(Pn);if(!r.contextMatchesRules(this.desc.precondition??void 0)){a.debug("[EditorAction2] NOT running command because its precondition is FALSE",this.desc.id,this.desc.precondition?.serialize());return}return this.runEditorCommand(o,n,...t)})}}function Gs(s,e){ot.registerCommand(s,function(t,...i){const n=t.get(ye),[o,r]=i;gt(Se.isUri(o)),gt(P.isIPosition(r));const a=t.get(Zt).getModel(o);if(a){const l=P.lift(r);return n.invokeFunction(e,a,l,...i.slice(2))}return t.get(qs).createModelReference(o).then(l=>new Promise((c,d)=>{try{const h=n.invokeFunction(e,l.object.textEditorModel,P.lift(r),i.slice(2));c(h)}catch(h){d(h)}}).finally(()=>{l.dispose()}))})}function ae(s){return cr.INSTANCE.registerEditorCommand(s),s}function Q(s){const e=new s;return cr.INSTANCE.registerEditorAction(e),e}function uV(s){return cr.INSTANCE.registerEditorAction(s),s}function Sie(s){cr.INSTANCE.registerEditorAction(s)}function ct(s,e,t){cr.INSTANCE.registerEditorContribution(s,e,t)}var Iu;(function(s){function e(r){return cr.INSTANCE.getEditorCommand(r)}s.getEditorCommand=e;function t(){return cr.INSTANCE.getEditorActions()}s.getEditorActions=t;function i(){return cr.INSTANCE.getEditorContributions()}s.getEditorContributions=i;function n(r){return cr.INSTANCE.getEditorContributions().filter(a=>r.indexOf(a.id)>=0)}s.getSomeEditorContributions=n;function o(){return cr.INSTANCE.getDiffEditorContributions()}s.getDiffEditorContributions=o})(Iu||(Iu={}));const Lie={EditorCommonContributions:"editor.contributions"};class cr{static{this.INSTANCE=new cr}constructor(){this.editorContributions=[],this.diffEditorContributions=[],this.editorActions=[],this.editorCommands=Object.create(null)}registerEditorContribution(e,t,i){this.editorContributions.push({id:e,ctor:t,instantiation:i})}getEditorContributions(){return this.editorContributions.slice(0)}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}}ci.add(Lie.EditorCommonContributions,cr.INSTANCE);function wC(s){return s.register(),s}const gV=wC(new bm({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:M.MenubarEditMenu,group:"1_do",title:p({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:M.CommandPalette,group:"",title:p("undo","Undo"),order:1}]}));wC(new dV(gV,{id:"default:undo",precondition:void 0}));const fV=wC(new bm({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:M.MenubarEditMenu,group:"1_do",title:p({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:M.CommandPalette,group:"",title:p("redo","Redo"),order:1}]}));wC(new dV(fV,{id:"default:redo",precondition:void 0}));const xie=wC(new bm({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:M.MenubarSelectionMenu,group:"1_basic",title:p({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:M.CommandPalette,group:"",title:p("selectAll","Select All"),order:1}]})),Q5="default",kie="$initialize";let J5=!1;function gE(s){gg&&(J5||(J5=!0,console.warn("Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq")),console.warn(s.message))}class Die{constructor(e,t,i,n,o){this.vsWorker=e,this.req=t,this.channel=i,this.method=n,this.args=o,this.type=0}}class e3{constructor(e,t,i,n){this.vsWorker=e,this.seq=t,this.res=i,this.err=n,this.type=1}}class Iie{constructor(e,t,i,n,o){this.vsWorker=e,this.req=t,this.channel=i,this.eventName=n,this.arg=o,this.type=2}}class Tie{constructor(e,t,i){this.vsWorker=e,this.req=t,this.event=i,this.type=3}}class Eie{constructor(e,t){this.vsWorker=e,this.req=t,this.type=4}}class Nie{constructor(e){this._workerId=-1,this._handler=e,this._lastSentReq=0,this._pendingReplies=Object.create(null),this._pendingEmitters=new Map,this._pendingEvents=new Map}setWorkerId(e){this._workerId=e}sendMessage(e,t,i){const n=String(++this._lastSentReq);return new Promise((o,r)=>{this._pendingReplies[n]={resolve:o,reject:r},this._send(new Die(this._workerId,n,e,t,i))})}listen(e,t,i){let n=null;const o=new O({onWillAddFirstListener:()=>{n=String(++this._lastSentReq),this._pendingEmitters.set(n,o),this._send(new Iie(this._workerId,n,e,t,i))},onDidRemoveLastListener:()=>{this._pendingEmitters.delete(n),this._send(new Eie(this._workerId,n)),n=null}});return o.event}handleMessage(e){!e||!e.vsWorker||this._workerId!==-1&&e.vsWorker!==this._workerId||this._handleMessage(e)}createProxyToRemoteChannel(e,t){const i={get:(n,o)=>(typeof o=="string"&&!n[o]&&(mV(o)?n[o]=r=>this.listen(e,o,r):pV(o)?n[o]=this.listen(e,o,void 0):o.charCodeAt(0)===36&&(n[o]=async(...r)=>(await t?.(),this.sendMessage(e,o,r)))),n[o])};return new Proxy(Object.create(null),i)}_handleMessage(e){switch(e.type){case 1:return this._handleReplyMessage(e);case 0:return this._handleRequestMessage(e);case 2:return this._handleSubscribeEventMessage(e);case 3:return this._handleEventMessage(e);case 4:return this._handleUnsubscribeEventMessage(e)}}_handleReplyMessage(e){if(!this._pendingReplies[e.seq]){console.warn("Got reply to unknown seq");return}const t=this._pendingReplies[e.seq];if(delete this._pendingReplies[e.seq],e.err){let i=e.err;e.err.$isError&&(i=new Error,i.name=e.err.name,i.message=e.err.message,i.stack=e.err.stack),t.reject(i);return}t.resolve(e.res)}_handleRequestMessage(e){const t=e.req;this._handler.handleMessage(e.channel,e.method,e.args).then(n=>{this._send(new e3(this._workerId,t,n,void 0))},n=>{n.detail instanceof Error&&(n.detail=D5(n.detail)),this._send(new e3(this._workerId,t,void 0,D5(n)))})}_handleSubscribeEventMessage(e){const t=e.req,i=this._handler.handleEvent(e.channel,e.eventName,e.arg)(n=>{this._send(new Tie(this._workerId,t,n))});this._pendingEvents.set(t,i)}_handleEventMessage(e){if(!this._pendingEmitters.has(e.req)){console.warn("Got event for unknown req");return}this._pendingEmitters.get(e.req).fire(e.event)}_handleUnsubscribeEventMessage(e){if(!this._pendingEvents.has(e.req)){console.warn("Got unsubscribe for unknown req");return}this._pendingEvents.get(e.req).dispose(),this._pendingEvents.delete(e.req)}_send(e){const t=[];if(e.type===0)for(let i=0;i<e.args.length;i++)e.args[i]instanceof ArrayBuffer&&t.push(e.args[i]);else e.type===1&&e.res instanceof ArrayBuffer&&t.push(e.res);this._handler.sendMessage(e,t)}}class Rie extends B{constructor(e,t){super(),this._localChannels=new Map,this._worker=this._register(e.create({amdModuleId:"vs/base/common/worker/simpleWorker",esmModuleLocation:t.esmModuleLocation,label:t.label},o=>{this._protocol.handleMessage(o)},o=>{Oe(o)})),this._protocol=new Nie({sendMessage:(o,r)=>{this._worker.postMessage(o,r)},handleMessage:(o,r,a)=>this._handleMessage(o,r,a),handleEvent:(o,r,a)=>this._handleEvent(o,r,a)}),this._protocol.setWorkerId(this._worker.getId());let i=null;const n=globalThis.require;typeof n<"u"&&typeof n.getConfig=="function"?i=n.getConfig():typeof globalThis.requirejs<"u"&&(i=globalThis.requirejs.s.contexts._.config),this._onModuleLoaded=this._protocol.sendMessage(Q5,kie,[this._worker.getId(),JSON.parse(JSON.stringify(i)),t.amdModuleId]),this.proxy=this._protocol.createProxyToRemoteChannel(Q5,async()=>{await this._onModuleLoaded}),this._onModuleLoaded.catch(o=>{this._onError("Worker failed to load "+t.amdModuleId,o)})}_handleMessage(e,t,i){const n=this._localChannels.get(e);if(!n)return Promise.reject(new Error(`Missing channel ${e} on main thread`));if(typeof n[t]!="function")return Promise.reject(new Error(`Missing method ${t} on main thread channel ${e}`));try{return Promise.resolve(n[t].apply(n,i))}catch(o){return Promise.reject(o)}}_handleEvent(e,t,i){const n=this._localChannels.get(e);if(!n)throw new Error(`Missing channel ${e} on main thread`);if(mV(t)){const o=n[t].call(n,i);if(typeof o!="function")throw new Error(`Missing dynamic event ${t} on main thread channel ${e}.`);return o}if(pV(t)){const o=n[t];if(typeof o!="function")throw new Error(`Missing event ${t} on main thread channel ${e}.`);return o}throw new Error(`Malformed event name ${t}`)}setChannel(e,t){this._localChannels.set(e,t)}_onError(e,t){console.error(e),console.info(t)}}function pV(s){return s[0]==="o"&&s[1]==="n"&&gl(s.charCodeAt(2))}function mV(s){return/^onDynamic/.test(s)&&gl(s.charCodeAt(9))}function Gc(s,e){const t=globalThis.MonacoEnvironment;if(t?.createTrustedTypesPolicy)try{return t.createTrustedTypesPolicy(s,e)}catch(i){Oe(i);return}try{return globalThis.trustedTypes?.createPolicy(s,e)}catch(i){Oe(i);return}}let yf;typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope"&&globalThis.workerttPolicy!==void 0?yf=globalThis.workerttPolicy:yf=Gc("defaultWorkerFactory",{createScriptURL:s=>s});function Mie(s,e){const t=globalThis.MonacoEnvironment;if(t){if(typeof t.getWorker=="function")return t.getWorker("workerMain.js",e);if(typeof t.getWorkerUrl=="function"){const i=t.getWorkerUrl("workerMain.js",e);return new Worker(yf?yf.createScriptURL(i):i,{name:e,type:"module"})}}if(s){const i=Aie(e,s.toString(!0)),n=new Worker(yf?yf.createScriptURL(i):i,{name:e,type:"module"});return Pie(n)}throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}function Aie(s,e,t){if(!(/^((http:)|(https:)|(file:)|(vscode-file:))/.test(e)&&e.substring(0,globalThis.origin.length)!==globalThis.origin)){const o=e.lastIndexOf("?"),r=e.lastIndexOf("#",o),a=o>0?new URLSearchParams(e.substring(o+1,~r?r:void 0)):new URLSearchParams;rE.addSearchParam(a,!0,!0),a.toString()?e=`${e}?${a.toString()}#${s}`:e=`${e}#${s}`}const n=new Blob([Yr([`/*${s}*/`,void 0,`globalThis._VSCODE_NLS_MESSAGES = ${JSON.stringify(XH())};`,`globalThis._VSCODE_NLS_LANGUAGE = ${JSON.stringify(kP())};`,`globalThis._VSCODE_FILE_ROOT = '${globalThis._VSCODE_FILE_ROOT}';`,"const ttPolicy = globalThis.trustedTypes?.createPolicy('defaultWorkerFactory', { createScriptURL: value => value });","globalThis.workerttPolicy = ttPolicy;",`await import(ttPolicy?.createScriptURL('${e}') ?? '${e}');`,"globalThis.postMessage({ type: 'vscode-worker-ready' });",`/*${s}*/`]).join("")],{type:"application/javascript"});return URL.createObjectURL(n)}function Pie(s){return new Promise((e,t)=>{s.onmessage=function(i){i.data.type==="vscode-worker-ready"&&(s.onmessage=null,e(s))},s.onerror=t})}function Oie(s){return typeof s.then=="function"}class Fie extends B{constructor(e,t,i,n,o,r){super(),this.id=i,this.label=n;const a=Mie(e,n);Oie(a)?this.worker=a:this.worker=Promise.resolve(a),this.postMessage(t,[]),this.worker.then(l=>{l.onmessage=function(c){o(c.data)},l.onmessageerror=r,typeof l.addEventListener=="function"&&l.addEventListener("error",r)}),this._register(Ce(()=>{this.worker?.then(l=>{l.onmessage=null,l.onmessageerror=null,l.removeEventListener("error",r),l.terminate()}),this.worker=null}))}getId(){return this.id}postMessage(e,t){this.worker?.then(i=>{try{i.postMessage(e,t)}catch(n){Oe(n),Oe(new Error(`FAILED to post message to '${this.label}'-worker`,{cause:n}))}})}}class Bie{constructor(e,t){this.amdModuleId=e,this.label=t,this.esmModuleLocation=vL.asBrowserUri(`${e}.esm.js`)}}class r2{static{this.LAST_WORKER_ID=0}constructor(){this._webWorkerFailedBeforeError=!1}create(e,t,i){const n=++r2.LAST_WORKER_ID;if(this._webWorkerFailedBeforeError)throw this._webWorkerFailedBeforeError;return new Fie(e.esmModuleLocation,e.amdModuleId,n,e.label||"anonymous"+n,t,o=>{gE(o),this._webWorkerFailedBeforeError=o,i(o)})}}function Wie(s,e){const t=typeof s=="string"?new Bie(s,e):s;return new Rie(new r2,t)}var Wi;(function(s){s[s.None=0]="None",s[s.Indent=1]="Indent",s[s.IndentOutdent=2]="IndentOutdent",s[s.Outdent=3]="Outdent"})(Wi||(Wi={}));class Qk{constructor(e){if(this._neutralCharacter=null,this._neutralCharacterSearched=!1,this.open=e.open,this.close=e.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(e.notIn))for(let t=0,i=e.notIn.length;t<i;t++)switch(e.notIn[t]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(e){switch(e){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(e,t){if(e.getTokenCount()===0)return!0;const i=e.findTokenIndexAtOffset(t-2),n=e.getStandardTokenType(i);return this.isOK(n)}_findNeutralCharacterInRange(e,t){for(let i=e;i<=t;i++){const n=String.fromCharCode(i);if(!this.open.includes(n)&&!this.close.includes(n))return n}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}}class Hie{constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(const t of e)Km(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),Km(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),Km(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),Km(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),t.close.length===1&&t.open.length===1&&Km(this.autoClosingPairsCloseSingleChar,t.close,t)}}function Km(s,e,t){s.has(e)?s.get(e).push(t):s.set(e,[t])}class Z1{static{this.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`}static{this.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`}constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map(t=>new Qk(t)):e.brackets?this._autoClosingPairs=e.brackets.map(t=>new Qk({open:t[0],close:t[1]})):this._autoClosingPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){const t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new Qk({open:t.open,close:t.close||""}))}this._autoCloseBeforeForQuotes=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:Z1.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:Z1.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(e){return e?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}}function bu(s,e){const t=s.getCount(),i=s.findTokenIndexAtOffset(e),n=s.getLanguageId(i);let o=i;for(;o+1<t&&s.getLanguageId(o+1)===n;)o++;let r=i;for(;r>0&&s.getLanguageId(r-1)===n;)r--;return new Vie(s,n,r,o+1,s.getStartOffset(r),s.getEndOffset(o))}class Vie{constructor(e,t,i,n,o,r){this._scopedLineTokensBrand=void 0,this._actual=e,this.languageId=t,this._firstTokenIndex=i,this._lastTokenIndex=n,this.firstCharOffset=o,this._lastCharOffset=r,this.languageIdCodec=e.languageIdCodec}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getLineLength(){return this._lastCharOffset-this.firstCharOffset}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}toIViewLineTokens(){return this._actual.sliceAndInflate(this.firstCharOffset,this._lastCharOffset,0)}}function rl(s){return(s&3)!==0}const t3=typeof Buffer<"u";let Jk;class PL{static wrap(e){return t3&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new PL(e)}constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}toString(){return t3?this.buffer.toString():(Jk||(Jk=new TextDecoder),Jk.decode(this.buffer))}}function zie(s,e){return s[e+0]<<0>>>0|s[e+1]<<8>>>0}function Uie(s,e,t){s[t+0]=e&255,e=e>>>8,s[t+1]=e&255}function ba(s,e){return s[e]*2**24+s[e+1]*2**16+s[e+2]*2**8+s[e+3]}function va(s,e,t){s[t+3]=e,e=e>>>8,s[t+2]=e,e=e>>>8,s[t+1]=e,e=e>>>8,s[t]=e}function i3(s,e){return s[e]}function n3(s,e,t){s[t]=e}let eD;function _V(){return eD||(eD=new TextDecoder("UTF-16LE")),eD}let tD;function $ie(){return tD||(tD=new TextDecoder("UTF-16BE")),tD}let iD;function bV(){return iD||(iD=n6()?_V():$ie()),iD}function jie(s,e,t){const i=new Uint16Array(s.buffer,e,t);return t>0&&(i[0]===65279||i[0]===65534)?Zie(s,e,t):_V().decode(i)}function Zie(s,e,t){const i=[];let n=0;for(let o=0;o<t;o++){const r=zie(s,e);e+=2,i[n++]=String.fromCharCode(r)}return i.join("")}class vm{constructor(e){this._capacity=e|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";const e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return bV().decode(e)}_flushBuffer(){const e=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}appendCharCode(e){const t=this._capacity-this._bufferLength;t<=1&&(t===0||Qi(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIICharCode(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendString(e){const t=e.length;if(this._bufferLength+t>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=e;return}for(let i=0;i<t;i++)this._buffer[this._bufferLength++]=e.charCodeAt(i)}}class K1{constructor(e,t,i,n,o,r){this._richEditBracketBrand=void 0,this.languageId=e,this.index=t,this.open=i,this.close=n,this.forwardRegex=o,this.reversedRegex=r,this._openSet=K1._toSet(this.open),this._closeSet=K1._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){const t=new Set;for(const i of e)t.add(i);return t}}function Kie(s){const e=s.length;s=s.map(r=>[r[0].toLowerCase(),r[1].toLowerCase()]);const t=[];for(let r=0;r<e;r++)t[r]=r;const i=(r,a)=>{const[l,c]=r,[d,h]=a;return l===d||l===h||c===d||c===h},n=(r,a)=>{const l=Math.min(r,a),c=Math.max(r,a);for(let d=0;d<e;d++)t[d]===c&&(t[d]=l)};for(let r=0;r<e;r++){const a=s[r];for(let l=r+1;l<e;l++){const c=s[l];i(a,c)&&n(t[r],t[l])}}const o=[];for(let r=0;r<e;r++){const a=[],l=[];for(let c=0;c<e;c++)if(t[c]===r){const[d,h]=s[c];a.push(d),l.push(h)}a.length>0&&o.push({open:a,close:l})}return o}class qie{constructor(e,t){this._richEditBracketsBrand=void 0;const i=Kie(t);this.brackets=i.map((n,o)=>new K1(e,o,n.open,n.close,Gie(n.open,n.close,i,o),Yie(n.open,n.close,i,o))),this.forwardRegex=Xie(this.brackets),this.reversedRegex=Qie(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(const n of this.brackets){for(const o of n.open)this.textIsBracket[o]=n,this.textIsOpenBracket[o]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,o.length);for(const o of n.close)this.textIsBracket[o]=n,this.textIsOpenBracket[o]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,o.length)}}}function vV(s,e,t,i){for(let n=0,o=e.length;n<o;n++){if(n===t)continue;const r=e[n];for(const a of r.open)a.indexOf(s)>=0&&i.push(a);for(const a of r.close)a.indexOf(s)>=0&&i.push(a)}}function CV(s,e){return s.length-e.length}function OL(s){if(s.length<=1)return s;const e=[],t=new Set;for(const i of s)t.has(i)||(e.push(i),t.add(i));return e}function Gie(s,e,t,i){let n=[];n=n.concat(s),n=n.concat(e);for(let o=0,r=n.length;o<r;o++)vV(n[o],t,i,n);return n=OL(n),n.sort(CV),n.reverse(),SC(n)}function Yie(s,e,t,i){let n=[];n=n.concat(s),n=n.concat(e);for(let o=0,r=n.length;o<r;o++)vV(n[o],t,i,n);return n=OL(n),n.sort(CV),n.reverse(),SC(n.map(a2))}function Xie(s){let e=[];for(const t of s){for(const i of t.open)e.push(i);for(const i of t.close)e.push(i)}return e=OL(e),SC(e)}function Qie(s){let e=[];for(const t of s){for(const i of t.open)e.push(i);for(const i of t.close)e.push(i)}return e=OL(e),SC(e.map(a2))}function Jie(s){const e=/^[\w ]+$/.test(s);return s=Uo(s),e?`\\b${s}\\b`:s}function SC(s,e){const t=`(${s.map(Jie).join(")|(")})`;return D6(t,!0,e)}const a2=function(){function s(i){const n=new Uint16Array(i.length);let o=0;for(let r=i.length-1;r>=0;r--)n[o++]=i.charCodeAt(r);return bV().decode(n)}let e=null,t=null;return function(n){return e!==n&&(e=n,t=s(e)),t}}();class Pr{static _findPrevBracketInText(e,t,i,n){const o=i.match(e);if(!o)return null;const r=i.length-(o.index||0),a=o[0].length,l=n+r;return new k(t,l-a+1,t,l+1)}static findPrevBracketInRange(e,t,i,n,o){const a=a2(i).substring(i.length-o,i.length-n);return this._findPrevBracketInText(e,t,a,n)}static findNextBracketInText(e,t,i,n){const o=i.match(e);if(!o)return null;const r=o.index||0,a=o[0].length;if(a===0)return null;const l=n+r;return new k(t,l+1,t,l+1+a)}static findNextBracketInRange(e,t,i,n,o){const r=i.substring(n,o);return this.findNextBracketInText(e,t,r,n)}}class ene{constructor(e){this._richEditBrackets=e}getElectricCharacters(){const e=[];if(this._richEditBrackets)for(const t of this._richEditBrackets.brackets)for(const i of t.close){const n=i.charAt(i.length-1);e.push(n)}return Pc(e)}onElectricCharacter(e,t,i){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;const n=t.findTokenIndexAtOffset(i-1);if(rl(t.getStandardTokenType(n)))return null;const o=this._richEditBrackets.reversedRegex,r=t.getLineContent().substring(0,i-1)+e,a=Pr.findPrevBracketInRange(o,1,r,0,r.length);if(!a)return null;const l=r.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;const d=t.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(d)?{matchOpenBracket:l}:null}}function yy(s){return s.global&&(s.lastIndex=0),!0}class tne{constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&yy(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&yy(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&yy(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&yy(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}}class wf{constructor(e){e=e||{},e.brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach(t=>{const i=wf._createOpenBracketRegExp(t[0]),n=wf._createCloseBracketRegExp(t[1]);i&&n&&this._brackets.push({open:t[0],openRegExp:i,close:t[1],closeRegExp:n})}),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,i,n){if(e>=3)for(let o=0,r=this._regExpRules.length;o<r;o++){const a=this._regExpRules[o];if([{reg:a.beforeText,text:i},{reg:a.afterText,text:n},{reg:a.previousLineText,text:t}].every(c=>c.reg?(c.reg.lastIndex=0,c.reg.test(c.text)):!0))return a.action}if(e>=2&&i.length>0&&n.length>0)for(let o=0,r=this._brackets.length;o<r;o++){const a=this._brackets[o];if(a.openRegExp.test(i)&&a.closeRegExp.test(n))return{indentAction:Wi.IndentOutdent}}if(e>=2&&i.length>0){for(let o=0,r=this._brackets.length;o<r;o++)if(this._brackets[o].openRegExp.test(i))return{indentAction:Wi.Indent}}return null}static _createOpenBracketRegExp(e){let t=Uo(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",wf._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=Uo(e);return/\B/.test(t.charAt(t.length-1))||(t=t+"\\b"),t="^\\s*"+t,wf._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return Oe(t),null}}}const Ke=Je("configurationService");function fE(s,e){const t=Object.create(null);for(const i in s)yV(t,i,s[i],e);return t}function yV(s,e,t,i){const n=e.split("."),o=n.pop();let r=s;for(let a=0;a<n.length;a++){const l=n[a];let c=r[l];switch(typeof c){case"undefined":c=r[l]=Object.create(null);break;case"object":if(c===null){i(`Ignoring ${e} as ${n.slice(0,a+1).join(".")} is null`);return}break;default:i(`Ignoring ${e} as ${n.slice(0,a+1).join(".")} is ${JSON.stringify(c)}`);return}r=c}if(typeof r=="object"&&r!==null)try{r[o]=t}catch{i(`Ignoring ${e} as ${n.join(".")} is ${JSON.stringify(r)}`)}else i(`Ignoring ${e} as ${n.join(".")} is ${JSON.stringify(r)}`)}function ine(s,e){const t=e.split(".");wV(s,t)}function wV(s,e){const t=e.shift();if(e.length===0){delete s[t];return}if(Object.keys(s).indexOf(t)!==-1){const i=s[t];typeof i=="object"&&!Array.isArray(i)&&(wV(i,e),Object.keys(i).length===0&&delete s[t])}}function s3(s,e,t){function i(r,a){let l=r;for(const c of a){if(typeof l!="object"||l===null)return;l=l[c]}return l}const n=e.split("."),o=i(s,n);return typeof o>"u"?t:o}function nne(s){return s.replace(/[\[\]]/g,"")}const ni=Je("languageService");class fl{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}}const SV=[];function nt(s,e,t){e instanceof fl||(e=new fl(e,[],!!t)),SV.push([s,e])}function o3(){return SV}const wi=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"}),FL={JSONContribution:"base.contributions.json"};function sne(s){return s.length>0&&s.charAt(s.length-1)==="#"?s.substring(0,s.length-1):s}class one{constructor(){this._onDidChangeSchema=new O,this.schemasById={}}registerSchema(e,t){this.schemasById[sne(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}}const rne=new one;ci.add(FL.JSONContribution,rne);const na={Configuration:"base.contributions.configuration"},qm="vscode://schemas/settings/resourceLanguage",r3=ci.as(FL.JSONContribution);class ane{constructor(){this.registeredConfigurationDefaults=[],this.overrideIdentifiers=new Set,this._onDidSchemaChange=new O,this._onDidUpdateConfiguration=new O,this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:p("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},r3.registerSchema(qm,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){const i=new Set;this.doRegisterConfigurations(e,t,i),r3.registerSchema(qm,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}registerDefaultConfigurations(e){const t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){this.registeredConfigurationDefaults.push(...e);const i=[];for(const{overrides:n,source:o}of e)for(const r in n){t.add(r);const a=this.configurationDefaultsOverrides.get(r)??this.configurationDefaultsOverrides.set(r,{configurationDefaultOverrides:[]}).get(r),l=n[r];if(a.configurationDefaultOverrides.push({value:l,source:o}),oh.test(r)){const c=this.mergeDefaultConfigurationsForOverrideIdentifier(r,l,o,a.configurationDefaultOverrideValue);if(!c)continue;a.configurationDefaultOverrideValue=c,this.updateDefaultOverrideProperty(r,c,o),i.push(...q1(r))}else{const c=this.mergeDefaultConfigurationsForConfigurationProperty(r,l,o,a.configurationDefaultOverrideValue);if(!c)continue;a.configurationDefaultOverrideValue=c;const d=this.configurationProperties[r];d&&(this.updatePropertyDefaultValue(r,d),this.updateSchema(r,d))}}this.doRegisterOverrideIdentifiers(i)}updateDefaultOverrideProperty(e,t,i){const n={type:"object",default:t.value,description:p("defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",nne(e)),$ref:qm,defaultDefaultValue:t.value,source:i,defaultValueSource:i};this.configurationProperties[e]=n,this.defaultLanguageConfigurationOverridesNode.properties[e]=n}mergeDefaultConfigurationsForOverrideIdentifier(e,t,i,n){const o=n?.value||{},r=n?.source??new Map;if(!(r instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(const a of Object.keys(t)){const l=t[a];if(dn(l)&&(ns(o[a])||dn(o[a]))){if(o[a]={...o[a]??{},...l},i)for(const d in l)r.set(`${a}.${d}`,i)}else o[a]=l,i?r.set(a,i):r.delete(a)}return{value:o,source:r}}mergeDefaultConfigurationsForConfigurationProperty(e,t,i,n){const o=this.configurationProperties[e],r=n?.value??o?.defaultDefaultValue;let a=i;if(dn(t)&&(o!==void 0&&o.type==="object"||o===void 0&&(ns(r)||dn(r)))){if(a=n?.source??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(const c in t)i&&a.set(`${e}.${c}`,i);t={...dn(r)?r:{},...t}}return{value:t,source:a}}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(const t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,i){e.forEach(n=>{this.validateAndRegisterProperties(n,t,n.extensionInfo,n.restrictedProperties,void 0,i),this.configurationContributors.push(n),this.registerJSONConfiguration(n)})}validateAndRegisterProperties(e,t=!0,i,n,o=3,r){o=Mo(e.scope)?o:e.scope;const a=e.properties;if(a)for(const c in a){const d=a[c];if(t&&dne(c,d)){delete a[c];continue}if(d.source=i,d.defaultDefaultValue=a[c].default,this.updatePropertyDefaultValue(c,d),oh.test(c)?d.scope=void 0:(d.scope=Mo(d.scope)?o:d.scope,d.restricted=Mo(d.restricted)?!!n?.includes(c):d.restricted),a[c].hasOwnProperty("included")&&!a[c].included){this.excludedConfigurationProperties[c]=a[c],delete a[c];continue}else this.configurationProperties[c]=a[c],a[c].policy?.name&&this.policyConfigurations.set(a[c].policy.name,c);!a[c].deprecationMessage&&a[c].markdownDeprecationMessage&&(a[c].deprecationMessage=a[c].markdownDeprecationMessage),r.add(c)}const l=e.allOf;if(l)for(const c of l)this.validateAndRegisterProperties(c,t,i,n,o,r)}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}registerJSONConfiguration(e){const t=i=>{const n=i.properties;if(n)for(const r in n)this.updateSchema(r,n[r]);i.allOf?.forEach(t)};t(e)}updateSchema(e,t){switch(t.scope){case 1:break;case 2:break;case 6:break;case 3:break;case 4:break;case 5:this.resourceLanguageSettingsSchema.properties[e]=t;break}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const t=`[${e}]`,i={type:"object",description:p("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:p("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:qm};this.updatePropertyDefaultValue(t,i)}}registerOverridePropertyPatternKey(){p("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),p("overrideSettings.errorMessage","This setting does not support per-language configuration."),this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){const i=this.configurationDefaultsOverrides.get(e)?.configurationDefaultOverrideValue;let n,o;i&&(!t.disallowConfigurationDefault||!i.source)&&(n=i.value,o=i.source),ns(n)&&(n=t.defaultDefaultValue,o=void 0),ns(n)&&(n=cne(t.type)),t.default=n,t.defaultValueSource=o}}const LV="\\[([^\\]]+)\\]",a3=new RegExp(LV,"g"),lne=`^(${LV})+$`,oh=new RegExp(lne);function q1(s){const e=[];if(oh.test(s)){let t=a3.exec(s);for(;t?.length;){const i=t[1].trim();i&&e.push(i),t=a3.exec(s)}}return Pc(e)}function cne(s){switch(Array.isArray(s)?s[0]:s){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const Pw=new ane;ci.add(na.Configuration,Pw);function dne(s,e){return s.trim()?oh.test(s)?p("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",s):Pw.getConfigurationProperties()[s]!==void 0?p("config.property.duplicate","Cannot register '{0}'. This property is already registered.",s):e.policy?.name&&Pw.getPolicyConfigurations().get(e.policy?.name)!==void 0?p("config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",s,e.policy?.name,Pw.getPolicyConfigurations().get(e.policy?.name)):null:p("config.property.empty","Cannot register an empty property")}const hne={ModesRegistry:"editor.modesRegistry"};class une{constructor(){this._onDidChangeLanguages=new O,this.onDidChangeLanguages=this._onDidChangeLanguages.event,this._languages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,i=this._languages.length;t<i;t++)if(this._languages[t]===e){this._languages.splice(t,1);return}}}}getLanguages(){return this._languages}}const xp=new une;ci.add(hne.ModesRegistry,xp);const Cs="plaintext",gne=".txt";xp.registerLanguage({id:Cs,extensions:[gne],aliases:[p("plainText.alias","Plain Text"),"text"],mimetypes:[wi.text]});ci.as(na.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);class fne{constructor(e,t){this.languageId=e;const i=t.brackets?l3(t.brackets):[],n=new R5(a=>{const l=new Set;return{info:new pne(this,a,l),closing:l}}),o=new R5(a=>{const l=new Set,c=new Set;return{info:new mne(this,a,l,c),opening:l,openingColorized:c}});for(const[a,l]of i){const c=n.get(a),d=o.get(l);c.closing.add(d.info),d.opening.add(c.info)}const r=t.colorizedBracketPairs?l3(t.colorizedBracketPairs):i.filter(a=>!(a[0]==="<"&&a[1]===">"));for(const[a,l]of r){const c=n.get(a),d=o.get(l);c.closing.add(d.info),d.openingColorized.add(c.info),d.opening.add(c.info)}this._openingBrackets=new Map([...n.cachedValues].map(([a,l])=>[a,l.info])),this._closingBrackets=new Map([...o.cachedValues].map(([a,l])=>[a,l.info]))}get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(e){return this._openingBrackets.get(e)}getClosingBracketInfo(e){return this._closingBrackets.get(e)}getBracketInfo(e){return this.getOpeningBracketInfo(e)||this.getClosingBracketInfo(e)}getBracketRegExp(e){const t=Array.from([...this._openingBrackets.keys(),...this._closingBrackets.keys()]);return SC(t,e)}}function l3(s){return s.filter(([e,t])=>e!==""&&t!=="")}class xV{constructor(e,t){this.config=e,this.bracketText=t}get languageId(){return this.config.languageId}}class pne extends xV{constructor(e,t,i){super(e,t),this.openedBrackets=i,this.isOpeningBracket=!0}}class mne extends xV{constructor(e,t,i,n){super(e,t),this.openingBrackets=i,this.openingColorizedBrackets=n,this.isOpeningBracket=!1}closes(e){return e.config!==this.config?!1:this.openingBrackets.has(e)}closesColorized(e){return e.config!==this.config?!1:this.openingColorizedBrackets.has(e)}getOpeningBrackets(){return[...this.openingBrackets]}}var _ne=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},c3=function(s,e){return function(t,i){e(t,i,s)}};class nD{constructor(e){this.languageId=e}affects(e){return this.languageId?this.languageId===e:!0}}const di=Je("languageConfigurationService");let pE=class extends B{constructor(e,t){super(),this.configurationService=e,this.languageService=t,this._registry=this._register(new yne),this.onDidChangeEmitter=this._register(new O),this.onDidChange=this.onDidChangeEmitter.event,this.configurations=new Map;const i=new Set(Object.values(mE));this._register(this.configurationService.onDidChangeConfiguration(n=>{const o=n.change.keys.some(a=>i.has(a)),r=n.change.overrides.filter(([a,l])=>l.some(c=>i.has(c))).map(([a])=>a);if(o)this.configurations.clear(),this.onDidChangeEmitter.fire(new nD(void 0));else for(const a of r)this.languageService.isRegisteredLanguageId(a)&&(this.configurations.delete(a),this.onDidChangeEmitter.fire(new nD(a)))})),this._register(this._registry.onDidChange(n=>{this.configurations.delete(n.languageId),this.onDidChangeEmitter.fire(new nD(n.languageId))}))}register(e,t,i){return this._registry.register(e,t,i)}getLanguageConfiguration(e){let t=this.configurations.get(e);return t||(t=bne(e,this._registry,this.configurationService,this.languageService),this.configurations.set(e,t)),t}};pE=_ne([c3(0,Ke),c3(1,ni)],pE);function bne(s,e,t,i){let n=e.getLanguageConfiguration(s);if(!n){if(!i.isRegisteredLanguageId(s))return new Gf(s,{});n=new Gf(s,{})}const o=vne(n.languageId,t),r=DV([n.underlyingConfig,o]);return new Gf(n.languageId,r)}const mE={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function vne(s,e){const t=e.getValue(mE.brackets,{overrideIdentifier:s}),i=e.getValue(mE.colorizedBracketPairs,{overrideIdentifier:s});return{brackets:d3(t),colorizedBracketPairs:d3(i)}}function d3(s){if(Array.isArray(s))return s.map(e=>{if(!(!Array.isArray(e)||e.length!==2))return[e[0],e[1]]}).filter(e=>!!e)}function kV(s,e,t){const i=s.getLineContent(e);let n=Mt(i);return n.length>t-1&&(n=n.substring(0,t-1)),n}class Cne{constructor(e){this.languageId=e,this._resolved=null,this._entries=[],this._order=0,this._resolved=null}register(e,t){const i=new h3(e,t,++this._order);return this._entries.push(i),this._resolved=null,Ce(()=>{for(let n=0;n<this._entries.length;n++)if(this._entries[n]===i){this._entries.splice(n,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){const e=this._resolve();e&&(this._resolved=new Gf(this.languageId,e))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(h3.cmp),DV(this._entries.map(e=>e.configuration)))}}function DV(s){let e={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(const t of s)e={comments:t.comments||e.comments,brackets:t.brackets||e.brackets,wordPattern:t.wordPattern||e.wordPattern,indentationRules:t.indentationRules||e.indentationRules,onEnterRules:t.onEnterRules||e.onEnterRules,autoClosingPairs:t.autoClosingPairs||e.autoClosingPairs,surroundingPairs:t.surroundingPairs||e.surroundingPairs,autoCloseBefore:t.autoCloseBefore||e.autoCloseBefore,folding:t.folding||e.folding,colorizedBracketPairs:t.colorizedBracketPairs||e.colorizedBracketPairs,__electricCharacterSupport:t.__electricCharacterSupport||e.__electricCharacterSupport};return e}class h3{constructor(e,t,i){this.configuration=e,this.priority=t,this.order=i}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}}class u3{constructor(e){this.languageId=e}}class yne extends B{constructor(){super(),this._entries=new Map,this._onDidChange=this._register(new O),this.onDidChange=this._onDidChange.event,this._register(this.register(Cs,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(e,t,i=0){let n=this._entries.get(e);n||(n=new Cne(e),this._entries.set(e,n));const o=n.register(t,i);return this._onDidChange.fire(new u3(e)),Ce(()=>{o.dispose(),this._onDidChange.fire(new u3(e))})}getLanguageConfiguration(e){return this._entries.get(e)?.getResolvedConfiguration()||null}}class Gf{constructor(e,t){this.languageId=e,this.underlyingConfig=t,this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new wf(this.underlyingConfig):null,this.comments=Gf._handleComments(this.underlyingConfig),this.characterPair=new Z1(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||TP,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new tne(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new fne(e,this.underlyingConfig)}getWordDefinition(){return EP(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new qie(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new ene(this.brackets)),this._electricCharacter}onEnter(e,t,i,n){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,i,n):null}getAutoClosingPairs(){return new Hie(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(e){return this.characterPair.getAutoCloseBeforeSet(e)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(e){const t=e.comments;if(!t)return null;const i={};if(t.lineComment&&(i.lineCommentToken=t.lineComment),t.blockComment){const[n,o]=t.blockComment;i.blockCommentStartToken=n,i.blockCommentEndToken=o}return i}}nt(di,pE,1);class hd{constructor(e,t,i,n){this.originalStart=e,this.originalLength=t,this.modifiedStart=i,this.modifiedLength=n}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}class g3{constructor(e){this.source=e}getElements(){const e=this.source,t=new Int32Array(e.length);for(let i=0,n=e.length;i<n;i++)t[i]=e.charCodeAt(i);return t}}function wne(s,e,t){return new bl(new g3(s),new g3(e)).ComputeDiff(t).changes}class Hg{static Assert(e,t){if(!e)throw new Error(t)}}class Vg{static Copy(e,t,i,n,o){for(let r=0;r<o;r++)i[n+r]=e[t+r]}static Copy2(e,t,i,n,o){for(let r=0;r<o;r++)i[n+r]=e[t+r]}}class f3{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new hd(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}class bl{constructor(e,t,i=null){this.ContinueProcessingPredicate=i,this._originalSequence=e,this._modifiedSequence=t;const[n,o,r]=bl._getElements(e),[a,l,c]=bl._getElements(t);this._hasStrings=r&&c,this._originalStringElements=n,this._originalElementsOrHash=o,this._modifiedStringElements=a,this._modifiedElementsOrHash=l,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){const t=e.getElements();if(bl._isStringArray(t)){const i=new Int32Array(t.length);for(let n=0,o=t.length;n<o;n++)i[n]=GP(t[n],0);return[t,i,!0]}return t instanceof Int32Array?[[],t,!1]:[[],new Int32Array(t),!1]}ElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[t]:!0}ElementsAreStrictEqual(e,t){if(!this.ElementsAreEqual(e,t))return!1;const i=bl._getStrictElement(this._originalSequence,e),n=bl._getStrictElement(this._modifiedSequence,t);return i===n}static _getStrictElement(e,t){return typeof e.getStrictElement=="function"?e.getStrictElement(t):null}OriginalElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[t]:!0}ModifiedElementsAreEqual(e,t){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[t]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,t,i,n,o){const r=[!1];let a=this.ComputeDiffRecursive(e,t,i,n,r);return o&&(a=this.PrettifyChanges(a)),{quitEarly:r[0],changes:a}}ComputeDiffRecursive(e,t,i,n,o){for(o[0]=!1;e<=t&&i<=n&&this.ElementsAreEqual(e,i);)e++,i++;for(;t>=e&&n>=i&&this.ElementsAreEqual(t,n);)t--,n--;if(e>t||i>n){let h;return i<=n?(Hg.Assert(e===t+1,"originalStart should only be one more than originalEnd"),h=[new hd(e,0,i,n-i+1)]):e<=t?(Hg.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),h=[new hd(e,t-e+1,i,0)]):(Hg.Assert(e===t+1,"originalStart should only be one more than originalEnd"),Hg.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),h=[]),h}const r=[0],a=[0],l=this.ComputeRecursionPoint(e,t,i,n,r,a,o),c=r[0],d=a[0];if(l!==null)return l;if(!o[0]){const h=this.ComputeDiffRecursive(e,c,i,d,o);let u=[];return o[0]?u=[new hd(c+1,t-(c+1)+1,d+1,n-(d+1)+1)]:u=this.ComputeDiffRecursive(c+1,t,d+1,n,o),this.ConcatenateChanges(h,u)}return[new hd(e,t-e+1,i,n-i+1)]}WALKTRACE(e,t,i,n,o,r,a,l,c,d,h,u,g,f,m,_,b,v){let C=null,y=null,w=new f3,x=t,L=i,D=g[0]-_[0]-n,T=-1073741824,F=this.m_forwardHistory.length-1;do{const W=D+e;W===x||W<L&&c[W-1]<c[W+1]?(h=c[W+1],f=h-D-n,h<T&&w.MarkNextChange(),T=h,w.AddModifiedElement(h+1,f),D=W+1-e):(h=c[W-1]+1,f=h-D-n,h<T&&w.MarkNextChange(),T=h-1,w.AddOriginalElement(h,f+1),D=W-1-e),F>=0&&(c=this.m_forwardHistory[F],e=c[0],x=1,L=c.length-1)}while(--F>=-1);if(C=w.getReverseChanges(),v[0]){let W=g[0]+1,H=_[0]+1;if(C!==null&&C.length>0){const $=C[C.length-1];W=Math.max(W,$.getOriginalEnd()),H=Math.max(H,$.getModifiedEnd())}y=[new hd(W,u-W+1,H,m-H+1)]}else{w=new f3,x=r,L=a,D=g[0]-_[0]-l,T=1073741824,F=b?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const W=D+o;W===x||W<L&&d[W-1]>=d[W+1]?(h=d[W+1]-1,f=h-D-l,h>T&&w.MarkNextChange(),T=h+1,w.AddOriginalElement(h+1,f+1),D=W+1-o):(h=d[W-1],f=h-D-l,h>T&&w.MarkNextChange(),T=h,w.AddModifiedElement(h+1,f+1),D=W-1-o),F>=0&&(d=this.m_reverseHistory[F],o=d[0],x=1,L=d.length-1)}while(--F>=-1);y=w.getChanges()}return this.ConcatenateChanges(C,y)}ComputeRecursionPoint(e,t,i,n,o,r,a){let l=0,c=0,d=0,h=0,u=0,g=0;e--,i--,o[0]=0,r[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const f=t-e+(n-i),m=f+1,_=new Int32Array(m),b=new Int32Array(m),v=n-i,C=t-e,y=e-i,w=t-n,L=(C-v)%2===0;_[v]=e,b[C]=t,a[0]=!1;for(let D=1;D<=f/2+1;D++){let T=0,F=0;d=this.ClipDiagonalBound(v-D,D,v,m),h=this.ClipDiagonalBound(v+D,D,v,m);for(let H=d;H<=h;H+=2){H===d||H<h&&_[H-1]<_[H+1]?l=_[H+1]:l=_[H-1]+1,c=l-(H-v)-y;const $=l;for(;l<t&&c<n&&this.ElementsAreEqual(l+1,c+1);)l++,c++;if(_[H]=l,l+c>T+F&&(T=l,F=c),!L&&Math.abs(H-C)<=D-1&&l>=b[H])return o[0]=l,r[0]=c,$<=b[H]&&D<=1448?this.WALKTRACE(v,d,h,y,C,u,g,w,_,b,l,t,o,c,n,r,L,a):null}const W=(T-e+(F-i)-D)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(T,W))return a[0]=!0,o[0]=T,r[0]=F,W>0&&D<=1448?this.WALKTRACE(v,d,h,y,C,u,g,w,_,b,l,t,o,c,n,r,L,a):(e++,i++,[new hd(e,t-e+1,i,n-i+1)]);u=this.ClipDiagonalBound(C-D,D,C,m),g=this.ClipDiagonalBound(C+D,D,C,m);for(let H=u;H<=g;H+=2){H===u||H<g&&b[H-1]>=b[H+1]?l=b[H+1]-1:l=b[H-1],c=l-(H-C)-w;const $=l;for(;l>e&&c>i&&this.ElementsAreEqual(l,c);)l--,c--;if(b[H]=l,L&&Math.abs(H-v)<=D&&l<=_[H])return o[0]=l,r[0]=c,$>=_[H]&&D<=1448?this.WALKTRACE(v,d,h,y,C,u,g,w,_,b,l,t,o,c,n,r,L,a):null}if(D<=1447){let H=new Int32Array(h-d+2);H[0]=v-d+1,Vg.Copy2(_,d,H,1,h-d+1),this.m_forwardHistory.push(H),H=new Int32Array(g-u+2),H[0]=C-u+1,Vg.Copy2(b,u,H,1,g-u+1),this.m_reverseHistory.push(H)}}return this.WALKTRACE(v,d,h,y,C,u,g,w,_,b,l,t,o,c,n,r,L,a)}PrettifyChanges(e){for(let t=0;t<e.length;t++){const i=e[t],n=t<e.length-1?e[t+1].originalStart:this._originalElementsOrHash.length,o=t<e.length-1?e[t+1].modifiedStart:this._modifiedElementsOrHash.length,r=i.originalLength>0,a=i.modifiedLength>0;for(;i.originalStart+i.originalLength<n&&i.modifiedStart+i.modifiedLength<o&&(!r||this.OriginalElementsAreEqual(i.originalStart,i.originalStart+i.originalLength))&&(!a||this.ModifiedElementsAreEqual(i.modifiedStart,i.modifiedStart+i.modifiedLength));){const c=this.ElementsAreStrictEqual(i.originalStart,i.modifiedStart);if(this.ElementsAreStrictEqual(i.originalStart+i.originalLength,i.modifiedStart+i.modifiedLength)&&!c)break;i.originalStart++,i.modifiedStart++}const l=[null];if(t<e.length-1&&this.ChangesOverlap(e[t],e[t+1],l)){e[t]=l[0],e.splice(t+1,1),t--;continue}}for(let t=e.length-1;t>=0;t--){const i=e[t];let n=0,o=0;if(t>0){const h=e[t-1];n=h.originalStart+h.originalLength,o=h.modifiedStart+h.modifiedLength}const r=i.originalLength>0,a=i.modifiedLength>0;let l=0,c=this._boundaryScore(i.originalStart,i.originalLength,i.modifiedStart,i.modifiedLength);for(let h=1;;h++){const u=i.originalStart-h,g=i.modifiedStart-h;if(u<n||g<o||r&&!this.OriginalElementsAreEqual(u,u+i.originalLength)||a&&!this.ModifiedElementsAreEqual(g,g+i.modifiedLength))break;const m=(u===n&&g===o?5:0)+this._boundaryScore(u,i.originalLength,g,i.modifiedLength);m>c&&(c=m,l=h)}i.originalStart-=l,i.modifiedStart-=l;const d=[null];if(t>0&&this.ChangesOverlap(e[t-1],e[t],d)){e[t-1]=d[0],e.splice(t,1),t++;continue}}if(this._hasStrings)for(let t=1,i=e.length;t<i;t++){const n=e[t-1],o=e[t],r=o.originalStart-n.originalStart-n.originalLength,a=n.originalStart,l=o.originalStart+o.originalLength,c=l-a,d=n.modifiedStart,h=o.modifiedStart+o.modifiedLength,u=h-d;if(r<5&&c<20&&u<20){const g=this._findBetterContiguousSequence(a,c,d,u,r);if(g){const[f,m]=g;(f!==n.originalStart+n.originalLength||m!==n.modifiedStart+n.modifiedLength)&&(n.originalLength=f-n.originalStart,n.modifiedLength=m-n.modifiedStart,o.originalStart=f+r,o.modifiedStart=m+r,o.originalLength=l-o.originalStart,o.modifiedLength=h-o.modifiedStart)}}}return e}_findBetterContiguousSequence(e,t,i,n,o){if(t<o||n<o)return null;const r=e+t-o+1,a=i+n-o+1;let l=0,c=0,d=0;for(let h=e;h<r;h++)for(let u=i;u<a;u++){const g=this._contiguousSequenceScore(h,u,o);g>0&&g>l&&(l=g,c=h,d=u)}return l>0?[c,d]:null}_contiguousSequenceScore(e,t,i){let n=0;for(let o=0;o<i;o++){if(!this.ElementsAreEqual(e+o,t+o))return 0;n+=this._originalStringElements[e+o].length}return n}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._OriginalIsBoundary(i-1)||this._OriginalIsBoundary(i))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._ModifiedIsBoundary(i-1)||this._ModifiedIsBoundary(i))return!0}return!1}_boundaryScore(e,t,i,n){const o=this._OriginalRegionIsBoundary(e,t)?1:0,r=this._ModifiedRegionIsBoundary(i,n)?1:0;return o+r}ConcatenateChanges(e,t){const i=[];if(e.length===0||t.length===0)return t.length>0?t:e;if(this.ChangesOverlap(e[e.length-1],t[0],i)){const n=new Array(e.length+t.length-1);return Vg.Copy(e,0,n,0,e.length-1),n[e.length-1]=i[0],Vg.Copy(t,1,n,e.length,t.length-1),n}else{const n=new Array(e.length+t.length);return Vg.Copy(e,0,n,0,e.length),Vg.Copy(t,0,n,e.length,t.length),n}}ChangesOverlap(e,t,i){if(Hg.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change"),Hg.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){const n=e.originalStart;let o=e.originalLength;const r=e.modifiedStart;let a=e.modifiedLength;return e.originalStart+e.originalLength>=t.originalStart&&(o=t.originalStart+t.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=t.modifiedStart&&(a=t.modifiedStart+t.modifiedLength-e.modifiedStart),i[0]=new hd(n,o,r,a),!0}else return i[0]=null,!1}ClipDiagonalBound(e,t,i,n){if(e>=0&&e<n)return e;const o=i,r=n-i-1,a=t%2===0;if(e<0){const l=o%2===0;return a===l?0:1}else{const l=r%2===0;return a===l?n-1:n-2}}}function G1(s){return s<0?0:s>255?255:s|0}function zg(s){return s<0?0:s>4294967295?4294967295:s|0}class Cm{constructor(e){const t=G1(e);this._defaultValue=t,this._asciiMap=Cm._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){const t=new Uint8Array(256);return t.fill(e),t}set(e,t){const i=G1(t);e>=0&&e<256?this._asciiMap[e]=i:this._map.set(e,i)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}}class Y1{constructor(){this._actual=new Cm(0)}add(e){this._actual.set(e,1)}has(e){return this._actual.get(e)===1}clear(){return this._actual.clear()}}class Sne{constructor(e,t,i){const n=new Uint8Array(e*t);for(let o=0,r=e*t;o<r;o++)n[o]=i;this._data=n,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,i){this._data[e*this.cols+t]=i}}class Lne{constructor(e){let t=0,i=0;for(let o=0,r=e.length;o<r;o++){const[a,l,c]=e[o];l>t&&(t=l),a>i&&(i=a),c>i&&(i=c)}t++,i++;const n=new Sne(i,t,0);for(let o=0,r=e.length;o<r;o++){const[a,l,c]=e[o];n.set(a,l,c)}this._states=n,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?0:this._states.get(e,t)}}let sD=null;function xne(){return sD===null&&(sD=new Lne([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),sD}let Gm=null;function kne(){if(Gm===null){Gm=new Cm(0);const s=` 	<>'"`;for(let t=0;t<s.length;t++)Gm.set(s.charCodeAt(t),1);const e=".,;:";for(let t=0;t<e.length;t++)Gm.set(e.charCodeAt(t),2)}return Gm}class X1{static _createLink(e,t,i,n,o){let r=o-1;do{const a=t.charCodeAt(r);if(e.get(a)!==2)break;r--}while(r>n);if(n>0){const a=t.charCodeAt(n-1),l=t.charCodeAt(r);(a===40&&l===41||a===91&&l===93||a===123&&l===125)&&r--}return{range:{startLineNumber:i,startColumn:n+1,endLineNumber:i,endColumn:r+2},url:t.substring(n,r+1)}}static computeLinks(e,t=xne()){const i=kne(),n=[];for(let o=1,r=e.getLineCount();o<=r;o++){const a=e.getLineContent(o),l=a.length;let c=0,d=0,h=0,u=1,g=!1,f=!1,m=!1,_=!1;for(;c<l;){let b=!1;const v=a.charCodeAt(c);if(u===13){let C;switch(v){case 40:g=!0,C=0;break;case 41:C=g?0:1;break;case 91:m=!0,f=!0,C=0;break;case 93:m=!1,C=f?0:1;break;case 123:_=!0,C=0;break;case 125:C=_?0:1;break;case 39:case 34:case 96:h===v?C=1:h===39||h===34||h===96?C=0:C=1;break;case 42:C=h===42?1:0;break;case 124:C=h===124?1:0;break;case 32:C=m?0:1;break;default:C=i.get(v)}C===1&&(n.push(X1._createLink(i,a,o,d,c)),b=!0)}else if(u===12){let C;v===91?(f=!0,C=0):C=i.get(v),C===1?b=!0:u=13}else u=t.nextState(u,v),u===0&&(b=!0);b&&(u=1,g=!1,f=!1,_=!1,d=c+1,h=v),c++}u===13&&n.push(X1._createLink(i,a,o,d,l))}return n}}function Dne(s){return!s||typeof s.getLineCount!="function"||typeof s.getLineContent!="function"?[]:X1.computeLinks(s)}class l2{constructor(){this._defaultValueSet=[["true","false"],["True","False"],["Private","Public","Friend","ReadOnly","Partial","Protected","WriteOnly"],["public","protected","private"]]}static{this.INSTANCE=new l2}navigateValueSet(e,t,i,n,o){if(e&&t){const r=this.doNavigateValueSet(t,o);if(r)return{range:e,value:r}}if(i&&n){const r=this.doNavigateValueSet(n,o);if(r)return{range:i,value:r}}return null}doNavigateValueSet(e,t){const i=this.numberReplace(e,t);return i!==null?i:this.textReplace(e,t)}numberReplace(e,t){const i=Math.pow(10,e.length-(e.lastIndexOf(".")+1));let n=Number(e);const o=parseFloat(e);return!isNaN(n)&&!isNaN(o)&&n===o?n===0&&!t?null:(n=Math.floor(n*i),n+=t?i:-i,String(n/i)):null}textReplace(e,t){return this.valueSetsReplace(this._defaultValueSet,e,t)}valueSetsReplace(e,t,i){let n=null;for(let o=0,r=e.length;n===null&&o<r;o++)n=this.valueSetReplace(e[o],t,i);return n}valueSetReplace(e,t,i){let n=e.indexOf(t);return n>=0?(n+=i?1:-1,n<0?n=e.length-1:n%=e.length,e[n]):null}}class Q1{static{this.CHANNEL_NAME="editorWorkerHost"}static getChannel(e){return e.getChannel(Q1.CHANNEL_NAME)}static setChannel(e,t){e.setChannel(Q1.CHANNEL_NAME,t)}}var p3,m3;class Ine{constructor(e,t){this.uri=e,this.value=t}}function Tne(s){return Array.isArray(s)}class Ui{static{this.defaultToKey=e=>e.toString()}constructor(e,t){if(this[p3]="ResourceMap",e instanceof Ui)this.map=new Map(e.map),this.toKey=t??Ui.defaultToKey;else if(Tne(e)){this.map=new Map,this.toKey=t??Ui.defaultToKey;for(const[i,n]of e)this.set(i,n)}else this.map=new Map,this.toKey=e??Ui.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new Ine(e,t)),this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(const[i,n]of this.map)e(n.value,n.uri,this)}*values(){for(const e of this.map.values())yield e.value}*keys(){for(const e of this.map.values())yield e.uri}*entries(){for(const e of this.map.values())yield[e.uri,e.value]}*[(p3=Symbol.toStringTag,Symbol.iterator)](){for(const[,e]of this.map)yield[e.uri,e.value]}}class Ene{constructor(){this[m3]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=0){const i=this._map.get(e);if(i)return t!==0&&this.touch(i,t),i.value}set(e,t,i=0){let n=this._map.get(e);if(n)n.value=t,i!==0&&this.touch(n,i);else{switch(n={key:e,value:t,next:void 0,previous:void 0},i){case 0:this.addItemLast(n);break;case 1:this.addItemFirst(n);break;case 2:this.addItemLast(n);break;default:this.addItemLast(n);break}this._map.set(e,n),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let n=this._head;for(;n;){if(t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");n=n.next}}keys(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const o={value:i.key,done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return n}values(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const o={value:i.value,done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return n}entries(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const o={value:[i.key,i.value],done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return n}[(m3=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.previous,i--;this._tail=t,this._size=i,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;const i=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(i.previous=n,n.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;const i=e.next,n=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=n,n.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}class Nne extends Ene{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}}class Wl extends Nne{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}}class Rne{constructor(e){if(this._m1=new Map,this._m2=new Map,e)for(const[t,i]of e)this.set(t,i)}clear(){this._m1.clear(),this._m2.clear()}set(e,t){this._m1.set(e,t),this._m2.set(t,e)}get(e){return this._m1.get(e)}getKey(e){return this._m2.get(e)}delete(e){const t=this._m1.get(e);return t===void 0?!1:(this._m1.delete(e),this._m2.delete(t),!0)}keys(){return this._m1.keys()}values(){return this._m1.values()}}class c2{constructor(){this.map=new Map}add(e,t){let i=this.map.get(e);i||(i=new Set,this.map.set(e,i)),i.add(t)}delete(e,t){const i=this.map.get(e);i&&(i.delete(t),i.size===0&&this.map.delete(e))}forEach(e,t){const i=this.map.get(e);i&&i.forEach(t)}get(e){const t=this.map.get(e);return t||new Set}}class Mne extends Cm{constructor(e,t){super(0),this._segmenter=null,this._cachedLine=null,this._cachedSegments=[],this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=new Intl.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let i=0,n=e.length;i<n;i++)this.set(e.charCodeAt(i),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let i=null;for(const n of this._getIntlSegmenterWordsOnLine(e)){if(n.index>t)break;i=n}return i}findNextIntlWordAtOrAfterOffset(e,t){for(const i of this._getIntlSegmenterWordsOnLine(e))if(!(i.index<t))return i;return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){const t=[];for(const i of e)this._isWordLike(i)&&t.push(i);return t}_isWordLike(e){return!!e.isWordLike}}const _3=new Wl(10);function yr(s,e){const t=`${s}/${e.join(",")}`;let i=_3.get(t);return i||(i=new Mne(s,e),_3.set(t,i)),i}var Ho;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=4]="Right",s[s.Full=7]="Full"})(Ho||(Ho={}));var Jr;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=3]="Right"})(Jr||(Jr={}));var Zr;(function(s){s[s.Both=0]="Both",s[s.Right=1]="Right",s[s.Left=2]="Left",s[s.None=3]="None"})(Zr||(Zr={}));class Ow{get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(e){this._textModelResolvedOptionsBrand=void 0,this.tabSize=Math.max(1,e.tabSize|0),e.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,e.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!e.insertSpaces,this.defaultEOL=e.defaultEOL|0,this.trimAutoWhitespace=!!e.trimAutoWhitespace,this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this._indentSizeIsTabSize===e._indentSizeIsTabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&co(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}}class Yb{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}}function Ane(s){return s&&typeof s.read=="function"}class oD{constructor(e,t,i,n,o,r){this.identifier=e,this.range=t,this.text=i,this.forceMoveMarkers=n,this.isAutoWhitespaceEdit=o,this._isTracked=r}}class Pne{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}}class One{constructor(e,t,i){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=i}}function IV(s){return!s.isTooLargeForSyncing()&&!s.isForSimpleWidget}const Fne=999;class Kh{constructor(e,t,i,n){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=n}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=Bne(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=D6(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new Pne(t,this.wordSeparators?yr(this.wordSeparators,[]):null,i?this.searchString:null)}}function Bne(s){if(!s||s.length===0)return!1;for(let e=0,t=s.length;e<t;e++){const i=s.charCodeAt(e);if(i===10)return!0;if(i===92){if(e++,e>=t)break;const n=s.charCodeAt(e);if(n===110||n===114||n===87)return!0}}return!1}function iu(s,e,t){if(!t)return new Yb(s,null);const i=[];for(let n=0,o=e.length;n<o;n++)i[n]=e[n];return new Yb(s,i)}class b3{constructor(e){const t=[];let i=0;for(let n=0,o=e.length;n<o;n++)e.charCodeAt(n)===10&&(t[i++]=n);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){const t=this._lineFeedsOffsets;let i=0,n=t.length-1;if(n===-1||e<=t[0])return 0;for(;i<n;){const o=i+((n-i)/2>>0);t[o]>=e?n=o-1:t[o+1]>=e?(i=o,n=o):i=o+1}return i+1}}class wy{static findMatches(e,t,i,n,o){const r=t.parseSearchRequest();return r?r.regex.multiline?this._doFindMatchesMultiline(e,i,new Sf(r.wordSeparators,r.regex),n,o):this._doFindMatchesLineByLine(e,i,r,n,o):[]}static _getMultilineMatchRange(e,t,i,n,o,r){let a,l=0;n?(l=n.findLineFeedCountBeforeOffset(o),a=t+o+l):a=t+o;let c;if(n){const g=n.findLineFeedCountBeforeOffset(o+r.length)-l;c=a+r.length+g}else c=a+r.length;const d=e.getPositionAt(a),h=e.getPositionAt(c);return new k(d.lineNumber,d.column,h.lineNumber,h.column)}static _doFindMatchesMultiline(e,t,i,n,o){const r=e.getOffsetAt(t.getStartPosition()),a=e.getValueInRange(t,1),l=e.getEOL()===`\r
`?new b3(a):null,c=[];let d=0,h;for(i.reset(0);h=i.next(a);)if(c[d++]=iu(this._getMultilineMatchRange(e,r,a,l,h.index,h[0]),h,n),d>=o)return c;return c}static _doFindMatchesLineByLine(e,t,i,n,o){const r=[];let a=0;if(t.startLineNumber===t.endLineNumber){const c=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return a=this._findMatchesInLine(i,c,t.startLineNumber,t.startColumn-1,a,r,n,o),r}const l=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);a=this._findMatchesInLine(i,l,t.startLineNumber,t.startColumn-1,a,r,n,o);for(let c=t.startLineNumber+1;c<t.endLineNumber&&a<o;c++)a=this._findMatchesInLine(i,e.getLineContent(c),c,0,a,r,n,o);if(a<o){const c=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);a=this._findMatchesInLine(i,c,t.endLineNumber,0,a,r,n,o)}return r}static _findMatchesInLine(e,t,i,n,o,r,a,l){const c=e.wordSeparators;if(!a&&e.simpleSearch){const u=e.simpleSearch,g=u.length,f=t.length;let m=-g;for(;(m=t.indexOf(u,m+g))!==-1;)if((!c||d2(c,t,f,m,g))&&(r[o++]=new Yb(new k(i,m+1+n,i,m+1+g+n),null),o>=l))return o;return o}const d=new Sf(e.wordSeparators,e.regex);let h;d.reset(0);do if(h=d.next(t),h&&(r[o++]=iu(new k(i,h.index+1+n,i,h.index+1+h[0].length+n),h,a),o>=l))return o;while(h);return o}static findNextMatch(e,t,i,n){const o=t.parseSearchRequest();if(!o)return null;const r=new Sf(o.wordSeparators,o.regex);return o.regex.multiline?this._doFindNextMatchMultiline(e,i,r,n):this._doFindNextMatchLineByLine(e,i,r,n)}static _doFindNextMatchMultiline(e,t,i,n){const o=new P(t.lineNumber,1),r=e.getOffsetAt(o),a=e.getLineCount(),l=e.getValueInRange(new k(o.lineNumber,o.column,a,e.getLineMaxColumn(a)),1),c=e.getEOL()===`\r
`?new b3(l):null;i.reset(t.column-1);const d=i.next(l);return d?iu(this._getMultilineMatchRange(e,r,l,c,d.index,d[0]),d,n):t.lineNumber!==1||t.column!==1?this._doFindNextMatchMultiline(e,new P(1,1),i,n):null}static _doFindNextMatchLineByLine(e,t,i,n){const o=e.getLineCount(),r=t.lineNumber,a=e.getLineContent(r),l=this._findFirstMatchInLine(i,a,r,t.column,n);if(l)return l;for(let c=1;c<=o;c++){const d=(r+c-1)%o,h=e.getLineContent(d+1),u=this._findFirstMatchInLine(i,h,d+1,1,n);if(u)return u}return null}static _findFirstMatchInLine(e,t,i,n,o){e.reset(n-1);const r=e.next(t);return r?iu(new k(i,r.index+1,i,r.index+1+r[0].length),r,o):null}static findPreviousMatch(e,t,i,n){const o=t.parseSearchRequest();if(!o)return null;const r=new Sf(o.wordSeparators,o.regex);return o.regex.multiline?this._doFindPreviousMatchMultiline(e,i,r,n):this._doFindPreviousMatchLineByLine(e,i,r,n)}static _doFindPreviousMatchMultiline(e,t,i,n){const o=this._doFindMatchesMultiline(e,new k(1,1,t.lineNumber,t.column),i,n,10*Fne);if(o.length>0)return o[o.length-1];const r=e.getLineCount();return t.lineNumber!==r||t.column!==e.getLineMaxColumn(r)?this._doFindPreviousMatchMultiline(e,new P(r,e.getLineMaxColumn(r)),i,n):null}static _doFindPreviousMatchLineByLine(e,t,i,n){const o=e.getLineCount(),r=t.lineNumber,a=e.getLineContent(r).substring(0,t.column-1),l=this._findLastMatchInLine(i,a,r,n);if(l)return l;for(let c=1;c<=o;c++){const d=(o+r-c-1)%o,h=e.getLineContent(d+1),u=this._findLastMatchInLine(i,h,d+1,n);if(u)return u}return null}static _findLastMatchInLine(e,t,i,n){let o=null,r;for(e.reset(0);r=e.next(t);)o=iu(new k(i,r.index+1,i,r.index+1+r[0].length),r,n);return o}}function Wne(s,e,t,i,n){if(i===0)return!0;const o=e.charCodeAt(i-1);if(s.get(o)!==0||o===13||o===10)return!0;if(n>0){const r=e.charCodeAt(i);if(s.get(r)!==0)return!0}return!1}function Hne(s,e,t,i,n){if(i+n===t)return!0;const o=e.charCodeAt(i+n);if(s.get(o)!==0||o===13||o===10)return!0;if(n>0){const r=e.charCodeAt(i+n-1);if(s.get(r)!==0)return!0}return!1}function d2(s,e,t,i,n){return Wne(s,e,t,i,n)&&Hne(s,e,t,i,n)}class Sf{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let i;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(i=this._searchRegex.exec(e),!i))return null;const n=i.index,o=i[0].length;if(n===this._prevMatchStartIndex&&o===this._prevMatchLength){if(o===0){F1(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=n,this._prevMatchLength=o,!this._wordSeparators||d2(this._wordSeparators,e,t,n,o))return i}while(i);return null}}class h2{static computeUnicodeHighlights(e,t,i){const n=i?i.startLineNumber:1,o=i?i.endLineNumber:e.getLineCount(),r=new v3(t),a=r.getCandidateCodePoints();let l;a==="allNonBasicAscii"?l=new RegExp("[^\\t\\n\\r\\x20-\\x7E]","g"):l=new RegExp(`${Vne(Array.from(a))}`,"g");const c=new Sf(null,l),d=[];let h=!1,u,g=0,f=0,m=0;e:for(let _=n,b=o;_<=b;_++){const v=e.getLineContent(_),C=v.length;c.reset(0);do if(u=c.next(v),u){let y=u.index,w=u.index+u[0].length;if(y>0){const T=v.charCodeAt(y-1);Qi(T)&&y--}if(w+1<C){const T=v.charCodeAt(w-1);Qi(T)&&w++}const x=v.substring(y,w);let L=Vb(y+1,TP,v,0);L&&L.endColumn<=y+1&&(L=null);const D=r.shouldHighlightNonBasicASCII(x,L?L.word:null);if(D!==0){if(D===3?g++:D===2?f++:D===1?m++:ML(),d.length>=1e3){h=!0;break e}d.push(new k(_,y+1,_,w+1))}}while(u)}return{ranges:d,hasMore:h,ambiguousCharacterCount:g,invisibleCharacterCount:f,nonBasicAsciiCharacterCount:m}}static computeUnicodeHighlightReason(e,t){const i=new v3(t);switch(i.shouldHighlightNonBasicASCII(e,null)){case 0:return null;case 2:return{kind:1};case 3:{const o=e.codePointAt(0),r=i.ambiguousCharacters.getPrimaryConfusable(o),a=Ed.getLocales().filter(l=>!Ed.getInstance(new Set([...t.allowedLocales,l])).isAmbiguous(o));return{kind:0,confusableWith:String.fromCodePoint(r),notAmbiguousInLocales:a}}case 1:return{kind:2}}}}function Vne(s,e){return`[${Uo(s.map(i=>String.fromCodePoint(i)).join(""))}]`}class v3{constructor(e){this.options=e,this.allowedCodePoints=new Set(e.allowedCodePoints),this.ambiguousCharacters=Ed.getInstance(new Set(e.allowedLocales))}getCandidateCodePoints(){if(this.options.nonBasicASCII)return"allNonBasicAscii";const e=new Set;if(this.options.invisibleCharacters)for(const t of Tc.codePoints)C3(String.fromCodePoint(t))||e.add(t);if(this.options.ambiguousCharacters)for(const t of this.ambiguousCharacters.getConfusableCodePoints())e.add(t);for(const t of this.allowedCodePoints)e.delete(t);return e}shouldHighlightNonBasicASCII(e,t){const i=e.codePointAt(0);if(this.allowedCodePoints.has(i))return 0;if(this.options.nonBasicASCII)return 1;let n=!1,o=!1;if(t)for(const r of t){const a=r.codePointAt(0),l=vC(r);n=n||l,!l&&!this.ambiguousCharacters.isAmbiguous(a)&&!Tc.isInvisibleCharacter(a)&&(o=!0)}return!n&&o?0:this.options.invisibleCharacters&&!C3(e)&&Tc.isInvisibleCharacter(i)?2:this.options.ambiguousCharacters&&this.ambiguousCharacters.isAmbiguous(i)?3:0}}function C3(s){return s===" "||s===`
`||s==="	"}class Fw{constructor(e,t,i){this.changes=e,this.moves=t,this.hitTimeout=i}}class TV{constructor(e,t){this.lineRangeMapping=e,this.changes=t}}class qe{static addRange(e,t){let i=0;for(;i<t.length&&t[i].endExclusive<e.start;)i++;let n=i;for(;n<t.length&&t[n].start<=e.endExclusive;)n++;if(i===n)t.splice(i,0,e);else{const o=Math.min(e.start,t[i].start),r=Math.max(e.endExclusive,t[n-1].endExclusive);t.splice(i,n-i,new qe(o,r))}}static tryCreate(e,t){if(!(e>t))return new qe(e,t)}static ofLength(e){return new qe(0,e)}static ofStartAndLength(e,t){return new qe(e,e+t)}constructor(e,t){if(this.start=e,this.endExclusive=t,e>t)throw new mt(`Invalid range: ${this.toString()}`)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new qe(this.start+e,this.endExclusive+e)}deltaStart(e){return new qe(this.start+e,this.endExclusive)}deltaEnd(e){return new qe(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new qe(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);if(t<=i)return new qe(t,i)}intersects(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);return t<i}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new mt(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new mt(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}forEach(e){for(let t=this.start;t<this.endExclusive;t++)e(t)}}class u2{constructor(){this._sortedRanges=[]}addRange(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<e.start;)t++;let i=t;for(;i<this._sortedRanges.length&&this._sortedRanges[i].start<=e.endExclusive;)i++;if(t===i)this._sortedRanges.splice(t,0,e);else{const n=Math.min(e.start,this._sortedRanges[t].start),o=Math.max(e.endExclusive,this._sortedRanges[i-1].endExclusive);this._sortedRanges.splice(t,i-t,new qe(n,o))}}toString(){return this._sortedRanges.map(e=>e.toString()).join(", ")}intersectsStrict(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<=e.start;)t++;return t<this._sortedRanges.length&&this._sortedRanges[t].start<e.endExclusive}intersectWithRange(e){const t=new u2;for(const i of this._sortedRanges){const n=i.intersect(e);n&&t.addRange(n)}return t}intersectWithRangeLength(e){return this.intersectWithRange(e).length}get length(){return this._sortedRanges.reduce((e,t)=>e+t.length,0)}}function Xb(s,e){const t=zne(s,e);if(t!==-1)return s[t]}function zne(s,e,t=s.length-1){for(let i=t;i>=0;i--){const n=s[i];if(e(n))return i}return-1}function kp(s,e){const t=Qb(s,e);return t===-1?void 0:s[t]}function Qb(s,e,t=0,i=s.length){let n=t,o=i;for(;n<o;){const r=Math.floor((n+o)/2);e(s[r])?n=r+1:o=r}return n-1}function Une(s,e){const t=Jb(s,e);return t===s.length?void 0:s[t]}function Jb(s,e,t=0,i=s.length){let n=t,o=i;for(;n<o;){const r=Math.floor((n+o)/2);e(s[r])?o=r:n=r+1}return n}class BL{static{this.assertInvariants=!1}constructor(e){this._array=e,this._findLastMonotonousLastIdx=0}findLastMonotonous(e){if(BL.assertInvariants){if(this._prevFindLastPredicate){for(const i of this._array)if(this._prevFindLastPredicate(i)&&!e(i))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}const t=Qb(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=t+1,t===-1?void 0:this._array[t]}}function g2(s,e){if(s.length===0)return;let t=s[0];for(let i=1;i<s.length;i++){const n=s[i];e(n,t)>0&&(t=n)}return t}function $ne(s,e){if(s.length===0)return;let t=s[0];for(let i=1;i<s.length;i++){const n=s[i];e(n,t)>=0&&(t=n)}return t}function jne(s,e){return g2(s,(t,i)=>-e(t,i))}function Zne(s,e){if(s.length===0)return-1;let t=0;for(let i=1;i<s.length;i++){const n=s[i];e(n,s[t])>0&&(t=i)}return t}function Kne(s,e){for(const t of s){const i=e(t);if(i!==void 0)return i}}let He=class tc{static fromRangeInclusive(e){return new tc(e.startLineNumber,e.endLineNumber+1)}static joinMany(e){if(e.length===0)return[];let t=new dr(e[0].slice());for(let i=1;i<e.length;i++)t=t.getUnion(new dr(e[i].slice()));return t.ranges}static join(e){if(e.length===0)throw new mt("lineRanges cannot be empty");let t=e[0].startLineNumber,i=e[0].endLineNumberExclusive;for(let n=1;n<e.length;n++)t=Math.min(t,e[n].startLineNumber),i=Math.max(i,e[n].endLineNumberExclusive);return new tc(t,i)}static ofLength(e,t){return new tc(e,e+t)}static deserialize(e){return new tc(e[0],e[1])}constructor(e,t){if(e>t)throw new mt(`startLineNumber ${e} cannot be after endLineNumberExclusive ${t}`);this.startLineNumber=e,this.endLineNumberExclusive=t}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new tc(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new tc(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new tc(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){const t=Math.max(this.startLineNumber,e.startLineNumber),i=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(t<=i)return new tc(t,i)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new k(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new k(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){const t=[];for(let i=this.startLineNumber;i<this.endLineNumberExclusive;i++)t.push(e(i));return t}forEach(e){for(let t=this.startLineNumber;t<this.endLineNumberExclusive;t++)e(t)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}toOffsetRange(){return new qe(this.startLineNumber-1,this.endLineNumberExclusive-1)}};class dr{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;const t=Jb(this._normalizedRanges,n=>n.endLineNumberExclusive>=e.startLineNumber),i=Qb(this._normalizedRanges,n=>n.startLineNumber<=e.endLineNumberExclusive)+1;if(t===i)this._normalizedRanges.splice(t,0,e);else if(t===i-1){const n=this._normalizedRanges[t];this._normalizedRanges[t]=n.join(e)}else{const n=this._normalizedRanges[t].join(this._normalizedRanges[i-1]).join(e);this._normalizedRanges.splice(t,i-t,n)}}contains(e){const t=kp(this._normalizedRanges,i=>i.startLineNumber<=e);return!!t&&t.endLineNumberExclusive>e}intersects(e){const t=kp(this._normalizedRanges,i=>i.startLineNumber<e.endLineNumberExclusive);return!!t&&t.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;const t=[];let i=0,n=0,o=null;for(;i<this._normalizedRanges.length||n<e._normalizedRanges.length;){let r=null;if(i<this._normalizedRanges.length&&n<e._normalizedRanges.length){const a=this._normalizedRanges[i],l=e._normalizedRanges[n];a.startLineNumber<l.startLineNumber?(r=a,i++):(r=l,n++)}else i<this._normalizedRanges.length?(r=this._normalizedRanges[i],i++):(r=e._normalizedRanges[n],n++);o===null?o=r:o.endLineNumberExclusive>=r.startLineNumber?o=new He(o.startLineNumber,Math.max(o.endLineNumberExclusive,r.endLineNumberExclusive)):(t.push(o),o=r)}return o!==null&&t.push(o),new dr(t)}subtractFrom(e){const t=Jb(this._normalizedRanges,r=>r.endLineNumberExclusive>=e.startLineNumber),i=Qb(this._normalizedRanges,r=>r.startLineNumber<=e.endLineNumberExclusive)+1;if(t===i)return new dr([e]);const n=[];let o=e.startLineNumber;for(let r=t;r<i;r++){const a=this._normalizedRanges[r];a.startLineNumber>o&&n.push(new He(o,a.startLineNumber)),o=a.endLineNumberExclusive}return o<e.endLineNumberExclusive&&n.push(new He(o,e.endLineNumberExclusive)),new dr(n)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){const t=[];let i=0,n=0;for(;i<this._normalizedRanges.length&&n<e._normalizedRanges.length;){const o=this._normalizedRanges[i],r=e._normalizedRanges[n],a=o.intersect(r);a&&!a.isEmpty&&t.push(a),o.endLineNumberExclusive<r.endLineNumberExclusive?i++:n++}return new dr(t)}getWithDelta(e){return new dr(this._normalizedRanges.map(t=>t.delta(e)))}}class Hs{static{this.zero=new Hs(0,0)}static betweenPositions(e,t){return e.lineNumber===t.lineNumber?new Hs(0,t.column-e.column):new Hs(t.lineNumber-e.lineNumber,t.column-1)}static ofRange(e){return Hs.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let t=0,i=0;for(const n of e)n===`
`?(t++,i=0):i++;return new Hs(t,i)}constructor(e,t){this.lineCount=e,this.columnCount=t}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}createRange(e){return this.lineCount===0?new k(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new k(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}addToPosition(e){return this.lineCount===0?new P(e.lineNumber,e.column+this.columnCount):new P(e.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}}class qne{constructor(e){this.text=e,this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)e.charAt(t)===`
`&&this.lineStartOffsetByLineIdx.push(t+1)}getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}getOffsetRange(e){return new qe(this.getOffset(e.getStartPosition()),this.getOffset(e.getEndPosition()))}get textLength(){const e=this.lineStartOffsetByLineIdx.length-1;return new Hs(e,this.text.length-this.lineStartOffsetByLineIdx[e])}}class f2{constructor(e){this.edits=e,Ku(()=>s2(e,(t,i)=>t.range.getEndPosition().isBeforeOrEqual(i.range.getStartPosition())))}apply(e){let t="",i=new P(1,1);for(const o of this.edits){const r=o.range,a=r.getStartPosition(),l=r.getEndPosition(),c=y3(i,a);c.isEmpty()||(t+=e.getValueOfRange(c)),t+=o.text,i=l}const n=y3(i,e.endPositionExclusive);return n.isEmpty()||(t+=e.getValueOfRange(n)),t}applyToString(e){const t=new Gne(e);return this.apply(t)}getNewRanges(){const e=[];let t=0,i=0,n=0;for(const o of this.edits){const r=Hs.ofText(o.text),a=P.lift({lineNumber:o.range.startLineNumber+i,column:o.range.startColumn+(o.range.startLineNumber===t?n:0)}),l=r.createRange(a);e.push(l),i=l.endLineNumber-o.range.endLineNumber,n=l.endColumn-o.range.endColumn,t=o.range.endLineNumber}return e}}class Il{constructor(e,t){this.range=e,this.text=t}toSingleEditOperation(){return{range:this.range,text:this.text}}}function y3(s,e){if(s.lineNumber===e.lineNumber&&s.column===Number.MAX_SAFE_INTEGER)return k.fromPositions(e,e);if(!s.isBeforeOrEqual(e))throw new mt("start must be before end");return new k(s.lineNumber,s.column,e.lineNumber,e.column)}class EV{get endPositionExclusive(){return this.length.addToPosition(new P(1,1))}}class Gne extends EV{constructor(e){super(),this.value=e,this._t=new qne(this.value)}getValueOfRange(e){return this._t.getOffsetRange(e).substring(this.value)}get length(){return this._t.textLength}}class is{static inverse(e,t,i){const n=[];let o=1,r=1;for(const l of e){const c=new is(new He(o,l.original.startLineNumber),new He(r,l.modified.startLineNumber));c.modified.isEmpty||n.push(c),o=l.original.endLineNumberExclusive,r=l.modified.endLineNumberExclusive}const a=new is(new He(o,t+1),new He(r,i+1));return a.modified.isEmpty||n.push(a),n}static clip(e,t,i){const n=[];for(const o of e){const r=o.original.intersect(t),a=o.modified.intersect(i);r&&!r.isEmpty&&a&&!a.isEmpty&&n.push(new is(r,a))}return n}constructor(e,t){this.original=e,this.modified=t}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new is(this.modified,this.original)}join(e){return new is(this.original.join(e.original),this.modified.join(e.modified))}toRangeMapping(){const e=this.original.toInclusiveRange(),t=this.modified.toInclusiveRange();if(e&&t)return new No(e,t);if(this.original.startLineNumber===1||this.modified.startLineNumber===1){if(!(this.modified.startLineNumber===1&&this.original.startLineNumber===1))throw new mt("not a valid diff");return new No(new k(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new k(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1))}else return new No(new k(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),new k(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER))}toRangeMapping2(e,t){if(w3(this.original.endLineNumberExclusive,e)&&w3(this.modified.endLineNumberExclusive,t))return new No(new k(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new k(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1));if(!this.original.isEmpty&&!this.modified.isEmpty)return new No(k.fromPositions(new P(this.original.startLineNumber,1),Ug(new P(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),k.fromPositions(new P(this.modified.startLineNumber,1),Ug(new P(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));if(this.original.startLineNumber>1&&this.modified.startLineNumber>1)return new No(k.fromPositions(Ug(new P(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER),e),Ug(new P(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),k.fromPositions(Ug(new P(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER),t),Ug(new P(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));throw new mt}}function Ug(s,e){if(s.lineNumber<1)return new P(1,1);if(s.lineNumber>e.length)return new P(e.length,e[e.length-1].length+1);const t=e[s.lineNumber-1];return s.column>t.length+1?new P(s.lineNumber,t.length+1):s}function w3(s,e){return s>=1&&s<=e.length}class Vo extends is{static fromRangeMappings(e){const t=He.join(e.map(n=>He.fromRangeInclusive(n.originalRange))),i=He.join(e.map(n=>He.fromRangeInclusive(n.modifiedRange)));return new Vo(t,i,e)}constructor(e,t,i){super(e,t),this.innerChanges=i}flip(){return new Vo(this.modified,this.original,this.innerChanges?.map(e=>e.flip()))}withInnerChangesFromLineRanges(){return new Vo(this.original,this.modified,[this.toRangeMapping()])}}class No{static assertSorted(e){for(let t=1;t<e.length;t++){const i=e[t-1],n=e[t];if(!(i.originalRange.getEndPosition().isBeforeOrEqual(n.originalRange.getStartPosition())&&i.modifiedRange.getEndPosition().isBeforeOrEqual(n.modifiedRange.getStartPosition())))throw new mt("Range mappings must be sorted")}}constructor(e,t){this.originalRange=e,this.modifiedRange=t}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new No(this.modifiedRange,this.originalRange)}toTextEdit(e){const t=e.getValueOfRange(this.modifiedRange);return new Il(this.originalRange,t)}}const Yne=3;class Xne{computeDiff(e,t,i){const o=new ese(e,t,{maxComputationTime:i.maxComputationTimeMs,shouldIgnoreTrimWhitespace:i.ignoreTrimWhitespace,shouldComputeCharChanges:!0,shouldMakePrettyDiff:!0,shouldPostProcessCharChanges:!0}).computeDiff(),r=[];let a=null;for(const l of o.changes){let c;l.originalEndLineNumber===0?c=new He(l.originalStartLineNumber+1,l.originalStartLineNumber+1):c=new He(l.originalStartLineNumber,l.originalEndLineNumber+1);let d;l.modifiedEndLineNumber===0?d=new He(l.modifiedStartLineNumber+1,l.modifiedStartLineNumber+1):d=new He(l.modifiedStartLineNumber,l.modifiedEndLineNumber+1);let h=new Vo(c,d,l.charChanges?.map(u=>new No(new k(u.originalStartLineNumber,u.originalStartColumn,u.originalEndLineNumber,u.originalEndColumn),new k(u.modifiedStartLineNumber,u.modifiedStartColumn,u.modifiedEndLineNumber,u.modifiedEndColumn))));a&&(a.modified.endLineNumberExclusive===h.modified.startLineNumber||a.original.endLineNumberExclusive===h.original.startLineNumber)&&(h=new Vo(a.original.join(h.original),a.modified.join(h.modified),a.innerChanges&&h.innerChanges?a.innerChanges.concat(h.innerChanges):void 0),r.pop()),r.push(h),a=h}return Ku(()=>s2(r,(l,c)=>c.original.startLineNumber-l.original.endLineNumberExclusive===c.modified.startLineNumber-l.modified.endLineNumberExclusive&&l.original.endLineNumberExclusive<c.original.startLineNumber&&l.modified.endLineNumberExclusive<c.modified.startLineNumber)),new Fw(r,[],o.quitEarly)}}function NV(s,e,t,i){return new bl(s,e,t).ComputeDiff(i)}let S3=class{constructor(e){const t=[],i=[];for(let n=0,o=e.length;n<o;n++)t[n]=_E(e[n],1),i[n]=bE(e[n],1);this.lines=e,this._startColumns=t,this._endColumns=i}getElements(){const e=[];for(let t=0,i=this.lines.length;t<i;t++)e[t]=this.lines[t].substring(this._startColumns[t]-1,this._endColumns[t]-1);return e}getStrictElement(e){return this.lines[e]}getStartLineNumber(e){return e+1}getEndLineNumber(e){return e+1}createCharSequence(e,t,i){const n=[],o=[],r=[];let a=0;for(let l=t;l<=i;l++){const c=this.lines[l],d=e?this._startColumns[l]:1,h=e?this._endColumns[l]:c.length+1;for(let u=d;u<h;u++)n[a]=c.charCodeAt(u-1),o[a]=l+1,r[a]=u,a++;!e&&l<i&&(n[a]=10,o[a]=l+1,r[a]=c.length+1,a++)}return new Qne(n,o,r)}};class Qne{constructor(e,t,i){this._charCodes=e,this._lineNumbers=t,this._columns=i}toString(){return"["+this._charCodes.map((e,t)=>(e===10?"\\n":String.fromCharCode(e))+`-(${this._lineNumbers[t]},${this._columns[t]})`).join(", ")+"]"}_assertIndex(e,t){if(e<0||e>=t.length)throw new Error("Illegal index")}getElements(){return this._charCodes}getStartLineNumber(e){return e>0&&e===this._lineNumbers.length?this.getEndLineNumber(e-1):(this._assertIndex(e,this._lineNumbers),this._lineNumbers[e])}getEndLineNumber(e){return e===-1?this.getStartLineNumber(e+1):(this._assertIndex(e,this._lineNumbers),this._charCodes[e]===10?this._lineNumbers[e]+1:this._lineNumbers[e])}getStartColumn(e){return e>0&&e===this._columns.length?this.getEndColumn(e-1):(this._assertIndex(e,this._columns),this._columns[e])}getEndColumn(e){return e===-1?this.getStartColumn(e+1):(this._assertIndex(e,this._columns),this._charCodes[e]===10?1:this._columns[e]+1)}}class Yf{constructor(e,t,i,n,o,r,a,l){this.originalStartLineNumber=e,this.originalStartColumn=t,this.originalEndLineNumber=i,this.originalEndColumn=n,this.modifiedStartLineNumber=o,this.modifiedStartColumn=r,this.modifiedEndLineNumber=a,this.modifiedEndColumn=l}static createFromDiffChange(e,t,i){const n=t.getStartLineNumber(e.originalStart),o=t.getStartColumn(e.originalStart),r=t.getEndLineNumber(e.originalStart+e.originalLength-1),a=t.getEndColumn(e.originalStart+e.originalLength-1),l=i.getStartLineNumber(e.modifiedStart),c=i.getStartColumn(e.modifiedStart),d=i.getEndLineNumber(e.modifiedStart+e.modifiedLength-1),h=i.getEndColumn(e.modifiedStart+e.modifiedLength-1);return new Yf(n,o,r,a,l,c,d,h)}}function Jne(s){if(s.length<=1)return s;const e=[s[0]];let t=e[0];for(let i=1,n=s.length;i<n;i++){const o=s[i],r=o.originalStart-(t.originalStart+t.originalLength),a=o.modifiedStart-(t.modifiedStart+t.modifiedLength);Math.min(r,a)<Yne?(t.originalLength=o.originalStart+o.originalLength-t.originalStart,t.modifiedLength=o.modifiedStart+o.modifiedLength-t.modifiedStart):(e.push(o),t=o)}return e}class Y_{constructor(e,t,i,n,o){this.originalStartLineNumber=e,this.originalEndLineNumber=t,this.modifiedStartLineNumber=i,this.modifiedEndLineNumber=n,this.charChanges=o}static createFromDiffResult(e,t,i,n,o,r,a){let l,c,d,h,u;if(t.originalLength===0?(l=i.getStartLineNumber(t.originalStart)-1,c=0):(l=i.getStartLineNumber(t.originalStart),c=i.getEndLineNumber(t.originalStart+t.originalLength-1)),t.modifiedLength===0?(d=n.getStartLineNumber(t.modifiedStart)-1,h=0):(d=n.getStartLineNumber(t.modifiedStart),h=n.getEndLineNumber(t.modifiedStart+t.modifiedLength-1)),r&&t.originalLength>0&&t.originalLength<20&&t.modifiedLength>0&&t.modifiedLength<20&&o()){const g=i.createCharSequence(e,t.originalStart,t.originalStart+t.originalLength-1),f=n.createCharSequence(e,t.modifiedStart,t.modifiedStart+t.modifiedLength-1);if(g.getElements().length>0&&f.getElements().length>0){let m=NV(g,f,o,!0).changes;a&&(m=Jne(m)),u=[];for(let _=0,b=m.length;_<b;_++)u.push(Yf.createFromDiffChange(m[_],g,f))}}return new Y_(l,c,d,h,u)}}class ese{constructor(e,t,i){this.shouldComputeCharChanges=i.shouldComputeCharChanges,this.shouldPostProcessCharChanges=i.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=i.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=i.shouldMakePrettyDiff,this.originalLines=e,this.modifiedLines=t,this.original=new S3(e),this.modified=new S3(t),this.continueLineDiff=L3(i.maxComputationTime),this.continueCharDiff=L3(i.maxComputationTime===0?0:Math.min(i.maxComputationTime,5e3))}computeDiff(){if(this.original.lines.length===1&&this.original.lines[0].length===0)return this.modified.lines.length===1&&this.modified.lines[0].length===0?{quitEarly:!1,changes:[]}:{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.lines.length,charChanges:void 0}]};if(this.modified.lines.length===1&&this.modified.lines[0].length===0)return{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:this.original.lines.length,modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:void 0}]};const e=NV(this.original,this.modified,this.continueLineDiff,this.shouldMakePrettyDiff),t=e.changes,i=e.quitEarly;if(this.shouldIgnoreTrimWhitespace){const a=[];for(let l=0,c=t.length;l<c;l++)a.push(Y_.createFromDiffResult(this.shouldIgnoreTrimWhitespace,t[l],this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges));return{quitEarly:i,changes:a}}const n=[];let o=0,r=0;for(let a=-1,l=t.length;a<l;a++){const c=a+1<l?t[a+1]:null,d=c?c.originalStart:this.originalLines.length,h=c?c.modifiedStart:this.modifiedLines.length;for(;o<d&&r<h;){const u=this.originalLines[o],g=this.modifiedLines[r];if(u!==g){{let f=_E(u,1),m=_E(g,1);for(;f>1&&m>1;){const _=u.charCodeAt(f-2),b=g.charCodeAt(m-2);if(_!==b)break;f--,m--}(f>1||m>1)&&this._pushTrimWhitespaceCharChange(n,o+1,1,f,r+1,1,m)}{let f=bE(u,1),m=bE(g,1);const _=u.length+1,b=g.length+1;for(;f<_&&m<b;){const v=u.charCodeAt(f-1),C=u.charCodeAt(m-1);if(v!==C)break;f++,m++}(f<_||m<b)&&this._pushTrimWhitespaceCharChange(n,o+1,f,_,r+1,m,b)}}o++,r++}c&&(n.push(Y_.createFromDiffResult(this.shouldIgnoreTrimWhitespace,c,this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges)),o+=c.originalLength,r+=c.modifiedLength)}return{quitEarly:i,changes:n}}_pushTrimWhitespaceCharChange(e,t,i,n,o,r,a){if(this._mergeTrimWhitespaceCharChange(e,t,i,n,o,r,a))return;let l;this.shouldComputeCharChanges&&(l=[new Yf(t,i,t,n,o,r,o,a)]),e.push(new Y_(t,t,o,o,l))}_mergeTrimWhitespaceCharChange(e,t,i,n,o,r,a){const l=e.length;if(l===0)return!1;const c=e[l-1];return c.originalEndLineNumber===0||c.modifiedEndLineNumber===0?!1:c.originalEndLineNumber===t&&c.modifiedEndLineNumber===o?(this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new Yf(t,i,t,n,o,r,o,a)),!0):c.originalEndLineNumber+1===t&&c.modifiedEndLineNumber+1===o?(c.originalEndLineNumber=t,c.modifiedEndLineNumber=o,this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new Yf(t,i,t,n,o,r,o,a)),!0):!1}}function _E(s,e){const t=rs(s);return t===-1?e:t+1}function bE(s,e){const t=Na(s);return t===-1?e:t+2}function L3(s){if(s===0)return()=>!0;const e=Date.now();return()=>Date.now()-e<s}class Nc{static trivial(e,t){return new Nc([new Xi(qe.ofLength(e.length),qe.ofLength(t.length))],!1)}static trivialTimedOut(e,t){return new Nc([new Xi(qe.ofLength(e.length),qe.ofLength(t.length))],!0)}constructor(e,t){this.diffs=e,this.hitTimeout=t}}class Xi{static invert(e,t){const i=[];return $H(e,(n,o)=>{i.push(Xi.fromOffsetPairs(n?n.getEndExclusives():ka.zero,o?o.getStarts():new ka(t,(n?n.seq2Range.endExclusive-n.seq1Range.endExclusive:0)+t)))}),i}static fromOffsetPairs(e,t){return new Xi(new qe(e.offset1,t.offset1),new qe(e.offset2,t.offset2))}static assertSorted(e){let t;for(const i of e){if(t&&!(t.seq1Range.endExclusive<=i.seq1Range.start&&t.seq2Range.endExclusive<=i.seq2Range.start))throw new mt("Sequence diffs must be sorted");t=i}}constructor(e,t){this.seq1Range=e,this.seq2Range=t}swap(){return new Xi(this.seq2Range,this.seq1Range)}toString(){return`${this.seq1Range} <-> ${this.seq2Range}`}join(e){return new Xi(this.seq1Range.join(e.seq1Range),this.seq2Range.join(e.seq2Range))}delta(e){return e===0?this:new Xi(this.seq1Range.delta(e),this.seq2Range.delta(e))}deltaStart(e){return e===0?this:new Xi(this.seq1Range.deltaStart(e),this.seq2Range.deltaStart(e))}deltaEnd(e){return e===0?this:new Xi(this.seq1Range.deltaEnd(e),this.seq2Range.deltaEnd(e))}intersect(e){const t=this.seq1Range.intersect(e.seq1Range),i=this.seq2Range.intersect(e.seq2Range);if(!(!t||!i))return new Xi(t,i)}getStarts(){return new ka(this.seq1Range.start,this.seq2Range.start)}getEndExclusives(){return new ka(this.seq1Range.endExclusive,this.seq2Range.endExclusive)}}class ka{static{this.zero=new ka(0,0)}static{this.max=new ka(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER)}constructor(e,t){this.offset1=e,this.offset2=t}toString(){return`${this.offset1} <-> ${this.offset2}`}delta(e){return e===0?this:new ka(this.offset1+e,this.offset2+e)}equals(e){return this.offset1===e.offset1&&this.offset2===e.offset2}}class LC{static{this.instance=new LC}isValid(){return!0}}class tse{constructor(e){if(this.timeout=e,this.startTime=Date.now(),this.valid=!0,e<=0)throw new mt("timeout must be positive")}isValid(){if(!(Date.now()-this.startTime<this.timeout)&&this.valid){this.valid=!1;debugger}return this.valid}}class rD{constructor(e,t){this.width=e,this.height=t,this.array=[],this.array=new Array(e*t)}get(e,t){return this.array[e+t*this.width]}set(e,t,i){this.array[e+t*this.width]=i}}function vE(s){return s===32||s===9}class ev{static{this.chrKeys=new Map}static getKey(e){let t=this.chrKeys.get(e);return t===void 0&&(t=this.chrKeys.size,this.chrKeys.set(e,t)),t}constructor(e,t,i){this.range=e,this.lines=t,this.source=i,this.histogram=[];let n=0;for(let o=e.startLineNumber-1;o<e.endLineNumberExclusive-1;o++){const r=t[o];for(let l=0;l<r.length;l++){n++;const c=r[l],d=ev.getKey(c);this.histogram[d]=(this.histogram[d]||0)+1}n++;const a=ev.getKey(`
`);this.histogram[a]=(this.histogram[a]||0)+1}this.totalCount=n}computeSimilarity(e){let t=0;const i=Math.max(this.histogram.length,e.histogram.length);for(let n=0;n<i;n++)t+=Math.abs((this.histogram[n]??0)-(e.histogram[n]??0));return 1-t/(this.totalCount+e.totalCount)}}class ise{compute(e,t,i=LC.instance,n){if(e.length===0||t.length===0)return Nc.trivial(e,t);const o=new rD(e.length,t.length),r=new rD(e.length,t.length),a=new rD(e.length,t.length);for(let f=0;f<e.length;f++)for(let m=0;m<t.length;m++){if(!i.isValid())return Nc.trivialTimedOut(e,t);const _=f===0?0:o.get(f-1,m),b=m===0?0:o.get(f,m-1);let v;e.getElement(f)===t.getElement(m)?(f===0||m===0?v=0:v=o.get(f-1,m-1),f>0&&m>0&&r.get(f-1,m-1)===3&&(v+=a.get(f-1,m-1)),v+=n?n(f,m):1):v=-1;const C=Math.max(_,b,v);if(C===v){const y=f>0&&m>0?a.get(f-1,m-1):0;a.set(f,m,y+1),r.set(f,m,3)}else C===_?(a.set(f,m,0),r.set(f,m,1)):C===b&&(a.set(f,m,0),r.set(f,m,2));o.set(f,m,C)}const l=[];let c=e.length,d=t.length;function h(f,m){(f+1!==c||m+1!==d)&&l.push(new Xi(new qe(f+1,c),new qe(m+1,d))),c=f,d=m}let u=e.length-1,g=t.length-1;for(;u>=0&&g>=0;)r.get(u,g)===3?(h(u,g),u--,g--):r.get(u,g)===1?u--:g--;return h(-1,-1),l.reverse(),new Nc(l,!1)}}class RV{compute(e,t,i=LC.instance){if(e.length===0||t.length===0)return Nc.trivial(e,t);const n=e,o=t;function r(m,_){for(;m<n.length&&_<o.length&&n.getElement(m)===o.getElement(_);)m++,_++;return m}let a=0;const l=new nse;l.set(0,r(0,0));const c=new sse;c.set(0,l.get(0)===0?null:new x3(null,0,0,l.get(0)));let d=0;e:for(;;){if(a++,!i.isValid())return Nc.trivialTimedOut(n,o);const m=-Math.min(a,o.length+a%2),_=Math.min(a,n.length+a%2);for(d=m;d<=_;d+=2){const b=d===_?-1:l.get(d+1),v=d===m?-1:l.get(d-1)+1,C=Math.min(Math.max(b,v),n.length),y=C-d;if(C>n.length||y>o.length)continue;const w=r(C,y);l.set(d,w);const x=C===b?c.get(d+1):c.get(d-1);if(c.set(d,w!==C?new x3(x,C,y,w-C):x),l.get(d)===n.length&&l.get(d)-d===o.length)break e}}let h=c.get(d);const u=[];let g=n.length,f=o.length;for(;;){const m=h?h.x+h.length:0,_=h?h.y+h.length:0;if((m!==g||_!==f)&&u.push(new Xi(new qe(m,g),new qe(_,f))),!h)break;g=h.x,f=h.y,h=h.prev}return u.reverse(),new Nc(u,!1)}}class x3{constructor(e,t,i,n){this.prev=e,this.x=t,this.y=i,this.length=n}}class nse{constructor(){this.positiveArr=new Int32Array(10),this.negativeArr=new Int32Array(10)}get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){if(e<0){if(e=-e-1,e>=this.negativeArr.length){const i=this.negativeArr;this.negativeArr=new Int32Array(i.length*2),this.negativeArr.set(i)}this.negativeArr[e]=t}else{if(e>=this.positiveArr.length){const i=this.positiveArr;this.positiveArr=new Int32Array(i.length*2),this.positiveArr.set(i)}this.positiveArr[e]=t}}}class sse{constructor(){this.positiveArr=[],this.negativeArr=[]}get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){e<0?(e=-e-1,this.negativeArr[e]=t):this.positiveArr[e]=t}}class J1{constructor(e,t,i){this.lines=e,this.range=t,this.considerWhitespaceChanges=i,this.elements=[],this.firstElementOffsetByLineIdx=[],this.lineStartOffsets=[],this.trimmedWsLengthsByLineIdx=[],this.firstElementOffsetByLineIdx.push(0);for(let n=this.range.startLineNumber;n<=this.range.endLineNumber;n++){let o=e[n-1],r=0;n===this.range.startLineNumber&&this.range.startColumn>1&&(r=this.range.startColumn-1,o=o.substring(r)),this.lineStartOffsets.push(r);let a=0;if(!i){const c=o.trimStart();a=o.length-c.length,o=c.trimEnd()}this.trimmedWsLengthsByLineIdx.push(a);const l=n===this.range.endLineNumber?Math.min(this.range.endColumn-1-r-a,o.length):o.length;for(let c=0;c<l;c++)this.elements.push(o.charCodeAt(c));n<this.range.endLineNumber&&(this.elements.push(10),this.firstElementOffsetByLineIdx.push(this.elements.length))}}toString(){return`Slice: "${this.text}"`}get text(){return this.getText(new qe(0,this.length))}getText(e){return this.elements.slice(e.start,e.endExclusive).map(t=>String.fromCharCode(t)).join("")}getElement(e){return this.elements[e]}get length(){return this.elements.length}getBoundaryScore(e){const t=D3(e>0?this.elements[e-1]:-1),i=D3(e<this.elements.length?this.elements[e]:-1);if(t===7&&i===8)return 0;if(t===8)return 150;let n=0;return t!==i&&(n+=10,t===0&&i===1&&(n+=1)),n+=k3(t),n+=k3(i),n}translateOffset(e,t="right"){const i=Qb(this.firstElementOffsetByLineIdx,o=>o<=e),n=e-this.firstElementOffsetByLineIdx[i];return new P(this.range.startLineNumber+i,1+this.lineStartOffsets[i]+n+(n===0&&t==="left"?0:this.trimmedWsLengthsByLineIdx[i]))}translateRange(e){const t=this.translateOffset(e.start,"right"),i=this.translateOffset(e.endExclusive,"left");return i.isBefore(t)?k.fromPositions(i,i):k.fromPositions(t,i)}findWordContaining(e){if(e<0||e>=this.elements.length||!aD(this.elements[e]))return;let t=e;for(;t>0&&aD(this.elements[t-1]);)t--;let i=e;for(;i<this.elements.length&&aD(this.elements[i]);)i++;return new qe(t,i)}countLinesIn(e){return this.translateOffset(e.endExclusive).lineNumber-this.translateOffset(e.start).lineNumber}isStronglyEqual(e,t){return this.elements[e]===this.elements[t]}extendToFullLines(e){const t=kp(this.firstElementOffsetByLineIdx,n=>n<=e.start)??0,i=Une(this.firstElementOffsetByLineIdx,n=>e.endExclusive<=n)??this.elements.length;return new qe(t,i)}}function aD(s){return s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57}const ose={0:0,1:0,2:0,3:10,4:2,5:30,6:3,7:10,8:10};function k3(s){return ose[s]}function D3(s){return s===10?8:s===13?7:vE(s)?6:s>=97&&s<=122?0:s>=65&&s<=90?1:s>=48&&s<=57?2:s===-1?3:s===44||s===59?5:4}function rse(s,e,t,i,n,o){let{moves:r,excludedChanges:a}=lse(s,e,t,o);if(!o.isValid())return[];const l=s.filter(d=>!a.has(d)),c=cse(l,i,n,e,t,o);return qI(r,c),r=dse(r),r=r.filter(d=>{const h=d.original.toOffsetRange().slice(e).map(g=>g.trim());return h.join(`
`).length>=15&&ase(h,g=>g.length>=2)>=2}),r=hse(s,r),r}function ase(s,e){let t=0;for(const i of s)e(i)&&t++;return t}function lse(s,e,t,i){const n=[],o=s.filter(l=>l.modified.isEmpty&&l.original.length>=3).map(l=>new ev(l.original,e,l)),r=new Set(s.filter(l=>l.original.isEmpty&&l.modified.length>=3).map(l=>new ev(l.modified,t,l))),a=new Set;for(const l of o){let c=-1,d;for(const h of r){const u=l.computeSimilarity(h);u>c&&(c=u,d=h)}if(c>.9&&d&&(r.delete(d),n.push(new is(l.range,d.range)),a.add(l.source),a.add(d.source)),!i.isValid())return{moves:n,excludedChanges:a}}return{moves:n,excludedChanges:a}}function cse(s,e,t,i,n,o){const r=[],a=new c2;for(const u of s)for(let g=u.original.startLineNumber;g<u.original.endLineNumberExclusive-2;g++){const f=`${e[g-1]}:${e[g+1-1]}:${e[g+2-1]}`;a.add(f,{range:new He(g,g+3)})}const l=[];s.sort(bs(u=>u.modified.startLineNumber,qr));for(const u of s){let g=[];for(let f=u.modified.startLineNumber;f<u.modified.endLineNumberExclusive-2;f++){const m=`${t[f-1]}:${t[f+1-1]}:${t[f+2-1]}`,_=new He(f,f+3),b=[];a.forEach(m,({range:v})=>{for(const y of g)if(y.originalLineRange.endLineNumberExclusive+1===v.endLineNumberExclusive&&y.modifiedLineRange.endLineNumberExclusive+1===_.endLineNumberExclusive){y.originalLineRange=new He(y.originalLineRange.startLineNumber,v.endLineNumberExclusive),y.modifiedLineRange=new He(y.modifiedLineRange.startLineNumber,_.endLineNumberExclusive),b.push(y);return}const C={modifiedLineRange:_,originalLineRange:v};l.push(C),b.push(C)}),g=b}if(!o.isValid())return[]}l.sort(KH(bs(u=>u.modifiedLineRange.length,qr)));const c=new dr,d=new dr;for(const u of l){const g=u.modifiedLineRange.startLineNumber-u.originalLineRange.startLineNumber,f=c.subtractFrom(u.modifiedLineRange),m=d.subtractFrom(u.originalLineRange).getWithDelta(g),_=f.getIntersection(m);for(const b of _.ranges){if(b.length<3)continue;const v=b,C=b.delta(-g);r.push(new is(C,v)),c.addRange(v),d.addRange(C)}}r.sort(bs(u=>u.original.startLineNumber,qr));const h=new BL(s);for(let u=0;u<r.length;u++){const g=r[u],f=h.findLastMonotonous(x=>x.original.startLineNumber<=g.original.startLineNumber),m=kp(s,x=>x.modified.startLineNumber<=g.modified.startLineNumber),_=Math.max(g.original.startLineNumber-f.original.startLineNumber,g.modified.startLineNumber-m.modified.startLineNumber),b=h.findLastMonotonous(x=>x.original.startLineNumber<g.original.endLineNumberExclusive),v=kp(s,x=>x.modified.startLineNumber<g.modified.endLineNumberExclusive),C=Math.max(b.original.endLineNumberExclusive-g.original.endLineNumberExclusive,v.modified.endLineNumberExclusive-g.modified.endLineNumberExclusive);let y;for(y=0;y<_;y++){const x=g.original.startLineNumber-y-1,L=g.modified.startLineNumber-y-1;if(x>i.length||L>n.length||c.contains(L)||d.contains(x)||!I3(i[x-1],n[L-1],o))break}y>0&&(d.addRange(new He(g.original.startLineNumber-y,g.original.startLineNumber)),c.addRange(new He(g.modified.startLineNumber-y,g.modified.startLineNumber)));let w;for(w=0;w<C;w++){const x=g.original.endLineNumberExclusive+w,L=g.modified.endLineNumberExclusive+w;if(x>i.length||L>n.length||c.contains(L)||d.contains(x)||!I3(i[x-1],n[L-1],o))break}w>0&&(d.addRange(new He(g.original.endLineNumberExclusive,g.original.endLineNumberExclusive+w)),c.addRange(new He(g.modified.endLineNumberExclusive,g.modified.endLineNumberExclusive+w))),(y>0||w>0)&&(r[u]=new is(new He(g.original.startLineNumber-y,g.original.endLineNumberExclusive+w),new He(g.modified.startLineNumber-y,g.modified.endLineNumberExclusive+w)))}return r}function I3(s,e,t){if(s.trim()===e.trim())return!0;if(s.length>300&&e.length>300)return!1;const n=new RV().compute(new J1([s],new k(1,1,1,s.length),!1),new J1([e],new k(1,1,1,e.length),!1),t);let o=0;const r=Xi.invert(n.diffs,s.length);for(const d of r)d.seq1Range.forEach(h=>{vE(s.charCodeAt(h))||o++});function a(d){let h=0;for(let u=0;u<s.length;u++)vE(d.charCodeAt(u))||h++;return h}const l=a(s.length>e.length?s:e);return o/l>.6&&l>10}function dse(s){if(s.length===0)return s;s.sort(bs(t=>t.original.startLineNumber,qr));const e=[s[0]];for(let t=1;t<s.length;t++){const i=e[e.length-1],n=s[t],o=n.original.startLineNumber-i.original.endLineNumberExclusive,r=n.modified.startLineNumber-i.modified.endLineNumberExclusive;if(o>=0&&r>=0&&o+r<=2){e[e.length-1]=i.join(n);continue}e.push(n)}return e}function hse(s,e){const t=new BL(s);return e=e.filter(i=>{const n=t.findLastMonotonous(a=>a.original.startLineNumber<i.original.endLineNumberExclusive)||new is(new He(1,1),new He(1,1)),o=kp(s,a=>a.modified.startLineNumber<i.modified.endLineNumberExclusive);return n!==o}),e}function CE(s,e,t){let i=t;return i=T3(s,e,i),i=T3(s,e,i),i=use(s,e,i),i}function T3(s,e,t){if(t.length===0)return t;const i=[];i.push(t[0]);for(let o=1;o<t.length;o++){const r=i[i.length-1];let a=t[o];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){const l=a.seq1Range.start-r.seq1Range.endExclusive;let c;for(c=1;c<=l&&!(s.getElement(a.seq1Range.start-c)!==s.getElement(a.seq1Range.endExclusive-c)||e.getElement(a.seq2Range.start-c)!==e.getElement(a.seq2Range.endExclusive-c));c++);if(c--,c===l){i[i.length-1]=new Xi(new qe(r.seq1Range.start,a.seq1Range.endExclusive-l),new qe(r.seq2Range.start,a.seq2Range.endExclusive-l));continue}a=a.delta(-c)}i.push(a)}const n=[];for(let o=0;o<i.length-1;o++){const r=i[o+1];let a=i[o];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){const l=r.seq1Range.start-a.seq1Range.endExclusive;let c;for(c=0;c<l&&!(!s.isStronglyEqual(a.seq1Range.start+c,a.seq1Range.endExclusive+c)||!e.isStronglyEqual(a.seq2Range.start+c,a.seq2Range.endExclusive+c));c++);if(c===l){i[o+1]=new Xi(new qe(a.seq1Range.start+l,r.seq1Range.endExclusive),new qe(a.seq2Range.start+l,r.seq2Range.endExclusive));continue}c>0&&(a=a.delta(c))}n.push(a)}return i.length>0&&n.push(i[i.length-1]),n}function use(s,e,t){if(!s.getBoundaryScore||!e.getBoundaryScore)return t;for(let i=0;i<t.length;i++){const n=i>0?t[i-1]:void 0,o=t[i],r=i+1<t.length?t[i+1]:void 0,a=new qe(n?n.seq1Range.endExclusive+1:0,r?r.seq1Range.start-1:s.length),l=new qe(n?n.seq2Range.endExclusive+1:0,r?r.seq2Range.start-1:e.length);o.seq1Range.isEmpty?t[i]=E3(o,s,e,a,l):o.seq2Range.isEmpty&&(t[i]=E3(o.swap(),e,s,l,a).swap())}return t}function E3(s,e,t,i,n){let r=1;for(;s.seq1Range.start-r>=i.start&&s.seq2Range.start-r>=n.start&&t.isStronglyEqual(s.seq2Range.start-r,s.seq2Range.endExclusive-r)&&r<100;)r++;r--;let a=0;for(;s.seq1Range.start+a<i.endExclusive&&s.seq2Range.endExclusive+a<n.endExclusive&&t.isStronglyEqual(s.seq2Range.start+a,s.seq2Range.endExclusive+a)&&a<100;)a++;if(r===0&&a===0)return s;let l=0,c=-1;for(let d=-r;d<=a;d++){const h=s.seq2Range.start+d,u=s.seq2Range.endExclusive+d,g=s.seq1Range.start+d,f=e.getBoundaryScore(g)+t.getBoundaryScore(h)+t.getBoundaryScore(u);f>c&&(c=f,l=d)}return s.delta(l)}function gse(s,e,t){const i=[];for(const n of t){const o=i[i.length-1];if(!o){i.push(n);continue}n.seq1Range.start-o.seq1Range.endExclusive<=2||n.seq2Range.start-o.seq2Range.endExclusive<=2?i[i.length-1]=new Xi(o.seq1Range.join(n.seq1Range),o.seq2Range.join(n.seq2Range)):i.push(n)}return i}function fse(s,e,t){const i=Xi.invert(t,s.length),n=[];let o=new ka(0,0);function r(l,c){if(l.offset1<o.offset1||l.offset2<o.offset2)return;const d=s.findWordContaining(l.offset1),h=e.findWordContaining(l.offset2);if(!d||!h)return;let u=new Xi(d,h);const g=u.intersect(c);let f=g.seq1Range.length,m=g.seq2Range.length;for(;i.length>0;){const _=i[0];if(!(_.seq1Range.intersects(u.seq1Range)||_.seq2Range.intersects(u.seq2Range)))break;const v=s.findWordContaining(_.seq1Range.start),C=e.findWordContaining(_.seq2Range.start),y=new Xi(v,C),w=y.intersect(_);if(f+=w.seq1Range.length,m+=w.seq2Range.length,u=u.join(y),u.seq1Range.endExclusive>=_.seq1Range.endExclusive)i.shift();else break}f+m<(u.seq1Range.length+u.seq2Range.length)*2/3&&n.push(u),o=u.getEndExclusives()}for(;i.length>0;){const l=i.shift();l.seq1Range.isEmpty||(r(l.getStarts(),l),r(l.getEndExclusives().delta(-1),l))}return pse(t,n)}function pse(s,e){const t=[];for(;s.length>0||e.length>0;){const i=s[0],n=e[0];let o;i&&(!n||i.seq1Range.start<n.seq1Range.start)?o=s.shift():o=e.shift(),t.length>0&&t[t.length-1].seq1Range.endExclusive>=o.seq1Range.start?t[t.length-1]=t[t.length-1].join(o):t.push(o)}return t}function mse(s,e,t){let i=t;if(i.length===0)return i;let n=0,o;do{o=!1;const r=[i[0]];for(let a=1;a<i.length;a++){let d=function(u,g){const f=new qe(c.seq1Range.endExclusive,l.seq1Range.start);return s.getText(f).replace(/\s/g,"").length<=4&&(u.seq1Range.length+u.seq2Range.length>5||g.seq1Range.length+g.seq2Range.length>5)};const l=i[a],c=r[r.length-1];d(c,l)?(o=!0,r[r.length-1]=r[r.length-1].join(l)):r.push(l)}i=r}while(n++<10&&o);return i}function _se(s,e,t){let i=t;if(i.length===0)return i;let n=0,o;do{o=!1;const a=[i[0]];for(let l=1;l<i.length;l++){let h=function(g,f){const m=new qe(d.seq1Range.endExclusive,c.seq1Range.start);if(s.countLinesIn(m)>5||m.length>500)return!1;const b=s.getText(m).trim();if(b.length>20||b.split(/\r\n|\r|\n/).length>1)return!1;const v=s.countLinesIn(g.seq1Range),C=g.seq1Range.length,y=e.countLinesIn(g.seq2Range),w=g.seq2Range.length,x=s.countLinesIn(f.seq1Range),L=f.seq1Range.length,D=e.countLinesIn(f.seq2Range),T=f.seq2Range.length,F=2*40+50;function W(H){return Math.min(H,F)}return Math.pow(Math.pow(W(v*40+C),1.5)+Math.pow(W(y*40+w),1.5),1.5)+Math.pow(Math.pow(W(x*40+L),1.5)+Math.pow(W(D*40+T),1.5),1.5)>(F**1.5)**1.5*1.3};const c=i[l],d=a[a.length-1];h(d,c)?(o=!0,a[a.length-1]=a[a.length-1].join(c)):a.push(c)}i=a}while(n++<10&&o);const r=[];return aQ(i,(a,l,c)=>{let d=l;function h(b){return b.length>0&&b.trim().length<=3&&l.seq1Range.length+l.seq2Range.length>100}const u=s.extendToFullLines(l.seq1Range),g=s.getText(new qe(u.start,l.seq1Range.start));h(g)&&(d=d.deltaStart(-g.length));const f=s.getText(new qe(l.seq1Range.endExclusive,u.endExclusive));h(f)&&(d=d.deltaEnd(f.length));const m=Xi.fromOffsetPairs(a?a.getEndExclusives():ka.zero,c?c.getStarts():ka.max),_=d.intersect(m);r.length>0&&_.getStarts().equals(r[r.length-1].getEndExclusives())?r[r.length-1]=r[r.length-1].join(_):r.push(_)}),r}class N3{constructor(e,t){this.trimmedHash=e,this.lines=t}getElement(e){return this.trimmedHash[e]}get length(){return this.trimmedHash.length}getBoundaryScore(e){const t=e===0?0:R3(this.lines[e-1]),i=e===this.lines.length?0:R3(this.lines[e]);return 1e3-(t+i)}getText(e){return this.lines.slice(e.start,e.endExclusive).join(`
`)}isStronglyEqual(e,t){return this.lines[e]===this.lines[t]}}function R3(s){let e=0;for(;e<s.length&&(s.charCodeAt(e)===32||s.charCodeAt(e)===9);)e++;return e}class MV{constructor(){this.dynamicProgrammingDiffing=new ise,this.myersDiffingAlgorithm=new RV}computeDiff(e,t,i){if(e.length<=1&&ii(e,t,(w,x)=>w===x))return new Fw([],[],!1);if(e.length===1&&e[0].length===0||t.length===1&&t[0].length===0)return new Fw([new Vo(new He(1,e.length+1),new He(1,t.length+1),[new No(new k(1,1,e.length,e[e.length-1].length+1),new k(1,1,t.length,t[t.length-1].length+1))])],[],!1);const n=i.maxComputationTimeMs===0?LC.instance:new tse(i.maxComputationTimeMs),o=!i.ignoreTrimWhitespace,r=new Map;function a(w){let x=r.get(w);return x===void 0&&(x=r.size,r.set(w,x)),x}const l=e.map(w=>a(w.trim())),c=t.map(w=>a(w.trim())),d=new N3(l,e),h=new N3(c,t),u=d.length+h.length<1700?this.dynamicProgrammingDiffing.compute(d,h,n,(w,x)=>e[w]===t[x]?t[x].length===0?.1:1+Math.log(1+t[x].length):.99):this.myersDiffingAlgorithm.compute(d,h,n);let g=u.diffs,f=u.hitTimeout;g=CE(d,h,g),g=mse(d,h,g);const m=[],_=w=>{if(o)for(let x=0;x<w;x++){const L=b+x,D=v+x;if(e[L]!==t[D]){const T=this.refineDiff(e,t,new Xi(new qe(L,L+1),new qe(D,D+1)),n,o);for(const F of T.mappings)m.push(F);T.hitTimeout&&(f=!0)}}};let b=0,v=0;for(const w of g){Ku(()=>w.seq1Range.start-b===w.seq2Range.start-v);const x=w.seq1Range.start-b;_(x),b=w.seq1Range.endExclusive,v=w.seq2Range.endExclusive;const L=this.refineDiff(e,t,w,n,o);L.hitTimeout&&(f=!0);for(const D of L.mappings)m.push(D)}_(e.length-b);const C=M3(m,e,t);let y=[];return i.computeMoves&&(y=this.computeMoves(C,e,t,l,c,n,o)),Ku(()=>{function w(L,D){if(L.lineNumber<1||L.lineNumber>D.length)return!1;const T=D[L.lineNumber-1];return!(L.column<1||L.column>T.length+1)}function x(L,D){return!(L.startLineNumber<1||L.startLineNumber>D.length+1||L.endLineNumberExclusive<1||L.endLineNumberExclusive>D.length+1)}for(const L of C){if(!L.innerChanges)return!1;for(const D of L.innerChanges)if(!(w(D.modifiedRange.getStartPosition(),t)&&w(D.modifiedRange.getEndPosition(),t)&&w(D.originalRange.getStartPosition(),e)&&w(D.originalRange.getEndPosition(),e)))return!1;if(!x(L.modified,t)||!x(L.original,e))return!1}return!0}),new Fw(C,y,f)}computeMoves(e,t,i,n,o,r,a){return rse(e,t,i,n,o,r).map(d=>{const h=this.refineDiff(t,i,new Xi(d.original.toOffsetRange(),d.modified.toOffsetRange()),r,a),u=M3(h.mappings,t,i,!0);return new TV(d,u)})}refineDiff(e,t,i,n,o){const a=vse(i).toRangeMapping2(e,t),l=new J1(e,a.originalRange,o),c=new J1(t,a.modifiedRange,o),d=l.length+c.length<500?this.dynamicProgrammingDiffing.compute(l,c,n):this.myersDiffingAlgorithm.compute(l,c,n);let h=d.diffs;return h=CE(l,c,h),h=fse(l,c,h),h=gse(l,c,h),h=_se(l,c,h),{mappings:h.map(g=>new No(l.translateRange(g.seq1Range),c.translateRange(g.seq2Range))),hitTimeout:d.hitTimeout}}}function M3(s,e,t,i=!1){const n=[];for(const o of SP(s.map(r=>bse(r,e,t)),(r,a)=>r.original.overlapOrTouch(a.original)||r.modified.overlapOrTouch(a.modified))){const r=o[0],a=o[o.length-1];n.push(new Vo(r.original.join(a.original),r.modified.join(a.modified),o.map(l=>l.innerChanges[0])))}return Ku(()=>!i&&n.length>0&&(n[0].modified.startLineNumber!==n[0].original.startLineNumber||t.length-n[n.length-1].modified.endLineNumberExclusive!==e.length-n[n.length-1].original.endLineNumberExclusive)?!1:s2(n,(o,r)=>r.original.startLineNumber-o.original.endLineNumberExclusive===r.modified.startLineNumber-o.modified.endLineNumberExclusive&&o.original.endLineNumberExclusive<r.original.startLineNumber&&o.modified.endLineNumberExclusive<r.modified.startLineNumber)),n}function bse(s,e,t){let i=0,n=0;s.modifiedRange.endColumn===1&&s.originalRange.endColumn===1&&s.originalRange.startLineNumber+i<=s.originalRange.endLineNumber&&s.modifiedRange.startLineNumber+i<=s.modifiedRange.endLineNumber&&(n=-1),s.modifiedRange.startColumn-1>=t[s.modifiedRange.startLineNumber-1].length&&s.originalRange.startColumn-1>=e[s.originalRange.startLineNumber-1].length&&s.originalRange.startLineNumber<=s.originalRange.endLineNumber+n&&s.modifiedRange.startLineNumber<=s.modifiedRange.endLineNumber+n&&(i=1);const o=new He(s.originalRange.startLineNumber+i,s.originalRange.endLineNumber+1+n),r=new He(s.modifiedRange.startLineNumber+i,s.modifiedRange.endLineNumber+1+n);return new Vo(o,r,[s])}function vse(s){return new is(new He(s.seq1Range.start+1,s.seq1Range.endExclusive+1),new He(s.seq2Range.start+1,s.seq2Range.endExclusive+1))}const A3={getLegacy:()=>new Xne,getDefault:()=>new MV};function Zd(s,e){const t=Math.pow(10,e);return Math.round(s*t)/t}class dt{constructor(e,t,i,n=1){this._rgbaBrand=void 0,this.r=Math.min(255,Math.max(0,e))|0,this.g=Math.min(255,Math.max(0,t))|0,this.b=Math.min(255,Math.max(0,i))|0,this.a=Zd(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}}class Hr{constructor(e,t,i,n){this._hslaBrand=void 0,this.h=Math.max(Math.min(360,e),0)|0,this.s=Zd(Math.max(Math.min(1,t),0),3),this.l=Zd(Math.max(Math.min(1,i),0),3),this.a=Zd(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,n=e.b/255,o=e.a,r=Math.max(t,i,n),a=Math.min(t,i,n);let l=0,c=0;const d=(a+r)/2,h=r-a;if(h>0){switch(c=Math.min(d<=.5?h/(2*d):h/(2-2*d),1),r){case t:l=(i-n)/h+(i<n?6:0);break;case i:l=(n-t)/h+2;break;case n:l=(t-i)/h+4;break}l*=60,l=Math.round(l)}return new Hr(l,c,d,o)}static _hue2rgb(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}static toRGBA(e){const t=e.h/360,{s:i,l:n,a:o}=e;let r,a,l;if(i===0)r=a=l=n;else{const c=n<.5?n*(1+i):n+i-n*i,d=2*n-c;r=Hr._hue2rgb(d,c,t+1/3),a=Hr._hue2rgb(d,c,t),l=Hr._hue2rgb(d,c,t-1/3)}return new dt(Math.round(r*255),Math.round(a*255),Math.round(l*255),o)}}class yl{constructor(e,t,i,n){this._hsvaBrand=void 0,this.h=Math.max(Math.min(360,e),0)|0,this.s=Zd(Math.max(Math.min(1,t),0),3),this.v=Zd(Math.max(Math.min(1,i),0),3),this.a=Zd(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,n=e.b/255,o=Math.max(t,i,n),r=Math.min(t,i,n),a=o-r,l=o===0?0:a/o;let c;return a===0?c=0:o===t?c=((i-n)/a%6+6)%6:o===i?c=(n-t)/a+2:c=(t-i)/a+4,new yl(Math.round(c*60),l,o,e.a)}static toRGBA(e){const{h:t,s:i,v:n,a:o}=e,r=n*i,a=r*(1-Math.abs(t/60%2-1)),l=n-r;let[c,d,h]=[0,0,0];return t<60?(c=r,d=a):t<120?(c=a,d=r):t<180?(d=r,h=a):t<240?(d=a,h=r):t<300?(c=a,h=r):t<=360&&(c=r,h=a),c=Math.round((c+l)*255),d=Math.round((d+l)*255),h=Math.round((h+l)*255),new dt(c,d,h,o)}}let G=class Ln{static fromHex(e){return Ln.Format.CSS.parseHex(e)||Ln.red}static equals(e,t){return!e&&!t?!0:!e||!t?!1:e.equals(t)}get hsla(){return this._hsla?this._hsla:Hr.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:yl.fromRGBA(this.rgba)}constructor(e){if(e)if(e instanceof dt)this.rgba=e;else if(e instanceof Hr)this._hsla=e,this.rgba=Hr.toRGBA(e);else if(e instanceof yl)this._hsva=e,this.rgba=yl.toRGBA(e);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(e){return!!e&&dt.equals(this.rgba,e.rgba)&&Hr.equals(this.hsla,e.hsla)&&yl.equals(this.hsva,e.hsva)}getRelativeLuminance(){const e=Ln._relativeLuminanceForComponent(this.rgba.r),t=Ln._relativeLuminanceForComponent(this.rgba.g),i=Ln._relativeLuminanceForComponent(this.rgba.b),n=.2126*e+.7152*t+.0722*i;return Zd(n,4)}static _relativeLuminanceForComponent(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t>i}isDarkerThan(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t<i}lighten(e){return new Ln(new Hr(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new Ln(new Hr(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){const{r:t,g:i,b:n,a:o}=this.rgba;return new Ln(new dt(t,i,n,o*e))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new Ln(new dt(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}makeOpaque(e){if(this.isOpaque()||e.rgba.a!==1)return this;const{r:t,g:i,b:n,a:o}=this.rgba;return new Ln(new dt(e.rgba.r-o*(e.rgba.r-t),e.rgba.g-o*(e.rgba.g-i),e.rgba.b-o*(e.rgba.b-n),1))}toString(){return this._toString||(this._toString=Ln.Format.CSS.format(this)),this._toString}static getLighterColor(e,t,i){if(e.isLighterThan(t))return e;i=i||.5;const n=e.getRelativeLuminance(),o=t.getRelativeLuminance();return i=i*(o-n)/o,e.lighten(i)}static getDarkerColor(e,t,i){if(e.isDarkerThan(t))return e;i=i||.5;const n=e.getRelativeLuminance(),o=t.getRelativeLuminance();return i=i*(n-o)/n,e.darken(i)}static{this.white=new Ln(new dt(255,255,255,1))}static{this.black=new Ln(new dt(0,0,0,1))}static{this.red=new Ln(new dt(255,0,0,1))}static{this.blue=new Ln(new dt(0,0,255,1))}static{this.green=new Ln(new dt(0,255,0,1))}static{this.cyan=new Ln(new dt(0,255,255,1))}static{this.lightgrey=new Ln(new dt(211,211,211,1))}static{this.transparent=new Ln(new dt(0,0,0,0))}};(function(s){(function(e){(function(t){function i(g){return g.rgba.a===1?`rgb(${g.rgba.r}, ${g.rgba.g}, ${g.rgba.b})`:s.Format.CSS.formatRGBA(g)}t.formatRGB=i;function n(g){return`rgba(${g.rgba.r}, ${g.rgba.g}, ${g.rgba.b}, ${+g.rgba.a.toFixed(2)})`}t.formatRGBA=n;function o(g){return g.hsla.a===1?`hsl(${g.hsla.h}, ${(g.hsla.s*100).toFixed(2)}%, ${(g.hsla.l*100).toFixed(2)}%)`:s.Format.CSS.formatHSLA(g)}t.formatHSL=o;function r(g){return`hsla(${g.hsla.h}, ${(g.hsla.s*100).toFixed(2)}%, ${(g.hsla.l*100).toFixed(2)}%, ${g.hsla.a.toFixed(2)})`}t.formatHSLA=r;function a(g){const f=g.toString(16);return f.length!==2?"0"+f:f}function l(g){return`#${a(g.rgba.r)}${a(g.rgba.g)}${a(g.rgba.b)}`}t.formatHex=l;function c(g,f=!1){return f&&g.rgba.a===1?s.Format.CSS.formatHex(g):`#${a(g.rgba.r)}${a(g.rgba.g)}${a(g.rgba.b)}${a(Math.round(g.rgba.a*255))}`}t.formatHexA=c;function d(g){return g.isOpaque()?s.Format.CSS.formatHex(g):s.Format.CSS.formatRGBA(g)}t.format=d;function h(g){const f=g.length;if(f===0||g.charCodeAt(0)!==35)return null;if(f===7){const m=16*u(g.charCodeAt(1))+u(g.charCodeAt(2)),_=16*u(g.charCodeAt(3))+u(g.charCodeAt(4)),b=16*u(g.charCodeAt(5))+u(g.charCodeAt(6));return new s(new dt(m,_,b,1))}if(f===9){const m=16*u(g.charCodeAt(1))+u(g.charCodeAt(2)),_=16*u(g.charCodeAt(3))+u(g.charCodeAt(4)),b=16*u(g.charCodeAt(5))+u(g.charCodeAt(6)),v=16*u(g.charCodeAt(7))+u(g.charCodeAt(8));return new s(new dt(m,_,b,v/255))}if(f===4){const m=u(g.charCodeAt(1)),_=u(g.charCodeAt(2)),b=u(g.charCodeAt(3));return new s(new dt(16*m+m,16*_+_,16*b+b))}if(f===5){const m=u(g.charCodeAt(1)),_=u(g.charCodeAt(2)),b=u(g.charCodeAt(3)),v=u(g.charCodeAt(4));return new s(new dt(16*m+m,16*_+_,16*b+b,(16*v+v)/255))}return null}t.parseHex=h;function u(g){switch(g){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(e.CSS||(e.CSS={}))})(s.Format||(s.Format={}))})(G||(G={}));function AV(s){const e=[];for(const t of s){const i=Number(t);(i||i===0&&t.replace(/\s/g,"")!=="")&&e.push(i)}return e}function p2(s,e,t,i){return{red:s/255,blue:t/255,green:e/255,alpha:i}}function Ym(s,e){const t=e.index,i=e[0].length;if(!t)return;const n=s.positionAt(t);return{startLineNumber:n.lineNumber,startColumn:n.column,endLineNumber:n.lineNumber,endColumn:n.column+i}}function Cse(s,e){if(!s)return;const t=G.Format.CSS.parseHex(e);if(t)return{range:s,color:p2(t.rgba.r,t.rgba.g,t.rgba.b,t.rgba.a)}}function P3(s,e,t){if(!s||e.length!==1)return;const n=e[0].values(),o=AV(n);return{range:s,color:p2(o[0],o[1],o[2],t?o[3]:1)}}function O3(s,e,t){if(!s||e.length!==1)return;const n=e[0].values(),o=AV(n),r=new G(new Hr(o[0],o[1]/100,o[2]/100,t?o[3]:1));return{range:s,color:p2(r.rgba.r,r.rgba.g,r.rgba.b,r.rgba.a)}}function Xm(s,e){return typeof s=="string"?[...s.matchAll(e)]:s.findMatches(e)}function yse(s){const e=[],i=Xm(s,/\b(rgb|rgba|hsl|hsla)(\([0-9\s,.\%]*\))|(#)([A-Fa-f0-9]{3})\b|(#)([A-Fa-f0-9]{4})\b|(#)([A-Fa-f0-9]{6})\b|(#)([A-Fa-f0-9]{8})\b/gm);if(i.length>0)for(const n of i){const o=n.filter(c=>c!==void 0),r=o[1],a=o[2];if(!a)continue;let l;if(r==="rgb"){const c=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*\)$/gm;l=P3(Ym(s,n),Xm(a,c),!1)}else if(r==="rgba"){const c=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;l=P3(Ym(s,n),Xm(a,c),!0)}else if(r==="hsl"){const c=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*\)$/gm;l=O3(Ym(s,n),Xm(a,c),!1)}else if(r==="hsla"){const c=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;l=O3(Ym(s,n),Xm(a,c),!0)}else r==="#"&&(l=Cse(Ym(s,n),r+a));l&&e.push(l)}return e}function wse(s){return!s||typeof s.getValue!="function"||typeof s.positionAt!="function"?[]:yse(s)}const F3=new RegExp("\\bMARK:\\s*(.*)$","d"),Sse=/^-+|-+$/g;function Lse(s,e){let t=[];if(e.findRegionSectionHeaders&&e.foldingRules?.markers){const i=xse(s,e);t=t.concat(i)}if(e.findMarkSectionHeaders){const i=kse(s);t=t.concat(i)}return t}function xse(s,e){const t=[],i=s.getLineCount();for(let n=1;n<=i;n++){const o=s.getLineContent(n),r=o.match(e.foldingRules.markers.start);if(r){const a={startLineNumber:n,startColumn:r[0].length+1,endLineNumber:n,endColumn:o.length+1};if(a.endColumn>a.startColumn){const l={range:a,...PV(o.substring(r[0].length)),shouldBeInComments:!1};(l.text||l.hasSeparatorLine)&&t.push(l)}}}return t}function kse(s){const e=[],t=s.getLineCount();for(let i=1;i<=t;i++){const n=s.getLineContent(i);Dse(n,i,e)}return e}function Dse(s,e,t){F3.lastIndex=0;const i=F3.exec(s);if(i){const n=i.indices[1][0]+1,o=i.indices[1][1]+1,r={startLineNumber:e,startColumn:n,endLineNumber:e,endColumn:o};if(r.endColumn>r.startColumn){const a={range:r,...PV(i[1]),shouldBeInComments:!0};(a.text||a.hasSeparatorLine)&&t.push(a)}}}function PV(s){s=s.trim();const e=s.startsWith("-");return s=s.replace(Sse,""),{text:s,hasSeparatorLine:e}}class Ise{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}insertValues(e,t){e=zg(e);const i=this.values,n=this.prefixSum,o=t.length;return o===0?!1:(this.values=new Uint32Array(i.length+o),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e),e+o),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,t){return e=zg(e),t=zg(t),this.values[e]===t?!1:(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=zg(e),t=zg(t);const i=this.values,n=this.prefixSum;if(e>=i.length)return!1;const o=i.length-e;return t>=o&&(t=o),t===0?!1:(this.values=new Uint32Array(i.length-t),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=zg(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;t===0&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let i=t;i<=e;i++)this.prefixSum[i]=this.prefixSum[i-1]+this.values[i];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,i=this.values.length-1,n=0,o=0,r=0;for(;t<=i;)if(n=t+(i-t)/2|0,o=this.prefixSum[n],r=o-this.values[n],e<r)i=n-1;else if(e>=o)t=n+1;else break;return new OV(n,e-r)}}class Tse{constructor(e){this._values=e,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(e){return this._ensureValid(),e===0?0:this._prefixSum[e-1]}getIndexOf(e){this._ensureValid();const t=this._indexBySum[e],i=t>0?this._prefixSum[t-1]:0;return new OV(t,e-i)}removeValues(e,t){this._values.splice(e,t),this._invalidate(e)}insertValues(e,t){this._values=gL(this._values,e,t),this._invalidate(e)}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._values.length;e<t;e++){const i=this._values[e],n=e>0?this._prefixSum[e-1]:0;this._prefixSum[e]=n+i;for(let o=0;o<i;o++)this._indexBySum[n+o]=e}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(e,t){this._values[e]!==t&&(this._values[e]=t,this._invalidate(e))}}class OV{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}}class Ese{constructor(e,t,i,n){this._uri=e,this._lines=t,this._eol=i,this._versionId=n,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const i of t)this._acceptDeleteRange(i.range),this._acceptInsertText(new P(i.range.startLineNumber,i.range.startColumn),i.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t);for(let n=0;n<t;n++)i[n]=this._lines[n].length+e;this._lineStarts=new Ise(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){if(t.length===0)return;const i=Fl(t);if(i.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]);const n=new Uint32Array(i.length-1);for(let o=1;o<i.length;o++)this._lines.splice(e.lineNumber+o-1,0,i[o]),n[o-1]=i[o].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,n)}}const B3=60*1e3;class Nse extends B{constructor(e,t,i=!1){if(super(),this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),this._proxy=e,this._modelService=t,!i){const n=new qP;n.cancelAndSet(()=>this._checkStopModelSync(),Math.round(B3/2)),this._register(n)}}dispose(){for(const e in this._syncedModels)At(this._syncedModels[e]);this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),super.dispose()}ensureSyncedResources(e,t=!1){for(const i of e){const n=i.toString();this._syncedModels[n]||this._beginModelSync(i,t),this._syncedModels[n]&&(this._syncedModelsLastUsedTime[n]=new Date().getTime())}}_checkStopModelSync(){const e=new Date().getTime(),t=[];for(const i in this._syncedModelsLastUsedTime)e-this._syncedModelsLastUsedTime[i]>B3&&t.push(i);for(const i of t)this._stopModelSync(i)}_beginModelSync(e,t){const i=this._modelService.getModel(e);if(!i||!t&&i.isTooLargeForSyncing())return;const n=e.toString();this._proxy.$acceptNewModel({url:i.uri.toString(),lines:i.getLinesContent(),EOL:i.getEOL(),versionId:i.getVersionId()});const o=new Z;o.add(i.onDidChangeContent(r=>{this._proxy.$acceptModelChanged(n.toString(),r)})),o.add(i.onWillDispose(()=>{this._stopModelSync(n)})),o.add(Ce(()=>{this._proxy.$acceptRemovedModel(n)})),this._syncedModels[n]=o}_stopModelSync(e){const t=this._syncedModels[e];delete this._syncedModels[e],delete this._syncedModelsLastUsedTime[e],At(t)}}class Rse{constructor(){this._models=Object.create(null)}getModel(e){return this._models[e]}getModels(){const e=[];return Object.keys(this._models).forEach(t=>e.push(this._models[t])),e}$acceptNewModel(e){this._models[e.url]=new Mse(Se.parse(e.url),e.lines,e.EOL,e.versionId)}$acceptModelChanged(e,t){if(!this._models[e])return;this._models[e].onEvents(t)}$acceptRemovedModel(e){this._models[e]&&delete this._models[e]}}class Mse extends Ese{get uri(){return this._uri}get eol(){return this._eol}getValue(){return this.getText()}findMatches(e){const t=[];for(let i=0;i<this._lines.length;i++){const n=this._lines[i],o=this.offsetAt(new P(i+1,1)),r=n.matchAll(e);for(const a of r)(a.index||a.index===0)&&(a.index=a.index+o),t.push(a)}return t}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(e){return this._lines[e-1]}getWordAtPosition(e,t){const i=Vb(e.column,EP(t),this._lines[e.lineNumber-1],0);return i?new k(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn):null}words(e){const t=this._lines,i=this._wordenize.bind(this);let n=0,o="",r=0,a=[];return{*[Symbol.iterator](){for(;;)if(r<a.length){const l=o.substring(a[r].start,a[r].end);r+=1,yield l}else if(n<t.length)o=t[n],a=i(o,e),r=0,n+=1;else break}}}getLineWords(e,t){const i=this._lines[e-1],n=this._wordenize(i,t),o=[];for(const r of n)o.push({word:i.substring(r.start,r.end),startColumn:r.start+1,endColumn:r.end+1});return o}_wordenize(e,t){const i=[];let n;for(t.lastIndex=0;(n=t.exec(e))&&n[0].length!==0;)i.push({start:n.index,end:n.index+n[0].length});return i}getValueInRange(e){if(e=this._validateRange(e),e.startLineNumber===e.endLineNumber)return this._lines[e.startLineNumber-1].substring(e.startColumn-1,e.endColumn-1);const t=this._eol,i=e.startLineNumber-1,n=e.endLineNumber-1,o=[];o.push(this._lines[i].substring(e.startColumn-1));for(let r=i+1;r<n;r++)o.push(this._lines[r]);return o.push(this._lines[n].substring(0,e.endColumn-1)),o.join(t)}offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.lineNumber-2)+(e.column-1)}positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length;return{lineNumber:1+t.index,column:1+Math.min(t.remainder,i)}}_validateRange(e){const t=this._validatePosition({lineNumber:e.startLineNumber,column:e.startColumn}),i=this._validatePosition({lineNumber:e.endLineNumber,column:e.endColumn});return t.lineNumber!==e.startLineNumber||t.column!==e.startColumn||i.lineNumber!==e.endLineNumber||i.column!==e.endColumn?{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:i.lineNumber,endColumn:i.column}:e}_validatePosition(e){if(!P.isIPosition(e))throw new Error("bad position");let{lineNumber:t,column:i}=e,n=!1;if(t<1)t=1,i=1,n=!0;else if(t>this._lines.length)t=this._lines.length,i=this._lines[t-1].length+1,n=!0;else{const o=this._lines[t-1].length+1;i<1?(i=1,n=!0):i>o&&(i=o,n=!0)}return n?{lineNumber:t,column:i}:e}}class Ase{constructor(){this._workerTextModelSyncServer=new Rse}dispose(){}_getModel(e){return this._workerTextModelSyncServer.getModel(e)}_getModels(){return this._workerTextModelSyncServer.getModels()}$acceptNewModel(e){this._workerTextModelSyncServer.$acceptNewModel(e)}$acceptModelChanged(e,t){this._workerTextModelSyncServer.$acceptModelChanged(e,t)}$acceptRemovedModel(e){this._workerTextModelSyncServer.$acceptRemovedModel(e)}async $computeUnicodeHighlights(e,t,i){const n=this._getModel(e);return n?h2.computeUnicodeHighlights(n,t,i):{ranges:[],hasMore:!1,ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0}}async $findSectionHeaders(e,t){const i=this._getModel(e);return i?Lse(i,t):[]}async $computeDiff(e,t,i,n){const o=this._getModel(e),r=this._getModel(t);return!o||!r?null:Bw.computeDiff(o,r,i,n)}static computeDiff(e,t,i,n){const o=n==="advanced"?A3.getDefault():A3.getLegacy(),r=e.getLinesContent(),a=t.getLinesContent(),l=o.computeDiff(r,a,i),c=l.changes.length>0?!1:this._modelsAreIdentical(e,t);function d(h){return h.map(u=>[u.original.startLineNumber,u.original.endLineNumberExclusive,u.modified.startLineNumber,u.modified.endLineNumberExclusive,u.innerChanges?.map(g=>[g.originalRange.startLineNumber,g.originalRange.startColumn,g.originalRange.endLineNumber,g.originalRange.endColumn,g.modifiedRange.startLineNumber,g.modifiedRange.startColumn,g.modifiedRange.endLineNumber,g.modifiedRange.endColumn])])}return{identical:c,quitEarly:l.hitTimeout,changes:d(l.changes),moves:l.moves.map(h=>[h.lineRangeMapping.original.startLineNumber,h.lineRangeMapping.original.endLineNumberExclusive,h.lineRangeMapping.modified.startLineNumber,h.lineRangeMapping.modified.endLineNumberExclusive,d(h.changes)])}}static _modelsAreIdentical(e,t){const i=e.getLineCount(),n=t.getLineCount();if(i!==n)return!1;for(let o=1;o<=i;o++){const r=e.getLineContent(o),a=t.getLineContent(o);if(r!==a)return!1}return!0}static{this._diffLimit=1e5}async $computeMoreMinimalEdits(e,t,i){const n=this._getModel(e);if(!n)return t;const o=[];let r;t=t.slice(0).sort((l,c)=>{if(l.range&&c.range)return k.compareRangesUsingStarts(l.range,c.range);const d=l.range?0:1,h=c.range?0:1;return d-h});let a=0;for(let l=1;l<t.length;l++)k.getEndPosition(t[a].range).equals(k.getStartPosition(t[l].range))?(t[a].range=k.fromPositions(k.getStartPosition(t[a].range),k.getEndPosition(t[l].range)),t[a].text+=t[l].text):(a++,t[a]=t[l]);t.length=a+1;for(let{range:l,text:c,eol:d}of t){if(typeof d=="number"&&(r=d),k.isEmpty(l)&&!c)continue;const h=n.getValueInRange(l);if(c=c.replace(/\r\n|\n|\r/g,n.eol),h===c)continue;if(Math.max(c.length,h.length)>Bw._diffLimit){o.push({range:l,text:c});continue}const u=wne(h,c,i),g=n.offsetAt(k.lift(l).getStartPosition());for(const f of u){const m=n.positionAt(g+f.originalStart),_=n.positionAt(g+f.originalStart+f.originalLength),b={text:c.substr(f.modifiedStart,f.modifiedLength),range:{startLineNumber:m.lineNumber,startColumn:m.column,endLineNumber:_.lineNumber,endColumn:_.column}};n.getValueInRange(b.range)!==b.text&&o.push(b)}}return typeof r=="number"&&o.push({eol:r,text:"",range:{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0}}),o}async $computeLinks(e){const t=this._getModel(e);return t?Dne(t):null}async $computeDefaultDocumentColors(e){const t=this._getModel(e);return t?wse(t):null}static{this._suggestionsLimit=1e4}async $textualSuggest(e,t,i,n){const o=new un,r=new RegExp(i,n),a=new Set;e:for(const l of e){const c=this._getModel(l);if(c){for(const d of c.words(r))if(!(d===t||!isNaN(Number(d)))&&(a.add(d),a.size>Bw._suggestionsLimit))break e}}return{words:Array.from(a),duration:o.elapsed()}}async $computeWordRanges(e,t,i,n){const o=this._getModel(e);if(!o)return Object.create(null);const r=new RegExp(i,n),a=Object.create(null);for(let l=t.startLineNumber;l<t.endLineNumber;l++){const c=o.getLineWords(l,r);for(const d of c){if(!isNaN(Number(d.word)))continue;let h=a[d.word];h||(h=[],a[d.word]=h),h.push({startLineNumber:l,startColumn:d.startColumn,endLineNumber:l,endColumn:d.endColumn})}}return a}async $navigateValueSet(e,t,i,n,o){const r=this._getModel(e);if(!r)return null;const a=new RegExp(n,o);t.startColumn===t.endColumn&&(t={startLineNumber:t.startLineNumber,startColumn:t.startColumn,endLineNumber:t.endLineNumber,endColumn:t.endColumn+1});const l=r.getValueInRange(t),c=r.getWordAtPosition({lineNumber:t.startLineNumber,column:t.startColumn},a);if(!c)return null;const d=r.getValueInRange(c);return l2.INSTANCE.navigateValueSet(t,l,c,d,i)}}class Bw extends Ase{constructor(e,t){super(),this._host=e,this._foreignModuleFactory=t,this._foreignModule=null}async $ping(){return"pong"}$loadForeignModule(e,t,i){const r={host:mQ(i,(a,l)=>this._host.$fhr(a,l)),getMirrorModels:()=>this._getModels()};return this._foreignModuleFactory?(this._foreignModule=this._foreignModuleFactory(r,t),Promise.resolve(YI(this._foreignModule))):new Promise((a,l)=>{const c=d=>{this._foreignModule=d.create(r,t),a(YI(this._foreignModule))};{const d=vL.asBrowserUri(`${e}.js`).toString(!0);Le(()=>import(`${d}`),[],import.meta.url).then(c).catch(l)}})}$fmr(e,t){if(!this._foreignModule||typeof this._foreignModule[e]!="function")return Promise.reject(new Error("Missing requestHandler or method: "+e));try{return Promise.resolve(this._foreignModule[e].apply(this._foreignModule,t))}catch(i){return Promise.reject(i)}}}typeof importScripts=="function"&&(globalThis.monaco=S6());const WL=Je("textResourceConfigurationService"),FV=Je("textResourcePropertiesService"),pe=Je("ILanguageFeaturesService");var m2=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},nu=function(s,e){return function(t,i){e(t,i,s)}};const W3=5*60*1e3;function su(s,e){const t=s.getModel(e);return!(!t||t.isTooLargeForSyncing())}let yE=class extends B{constructor(e,t,i,n,o,r){super(),this._languageConfigurationService=o,this._modelService=t,this._workerManager=this._register(new wE(e,this._modelService)),this._logService=n,this._register(r.linkProvider.register({language:"*",hasAccessToAllModels:!0},{provideLinks:async(a,l)=>{if(!su(this._modelService,a.uri))return Promise.resolve({links:[]});const d=await(await this._workerWithResources([a.uri])).$computeLinks(a.uri.toString());return d&&{links:d}}})),this._register(r.completionProvider.register("*",new Pse(this._workerManager,i,this._modelService,this._languageConfigurationService)))}dispose(){super.dispose()}canComputeUnicodeHighlights(e){return su(this._modelService,e)}async computedUnicodeHighlights(e,t,i){return(await this._workerWithResources([e])).$computeUnicodeHighlights(e.toString(),t,i)}async computeDiff(e,t,i,n){const r=await(await this._workerWithResources([e,t],!0)).$computeDiff(e.toString(),t.toString(),i,n);if(!r)return null;return{identical:r.identical,quitEarly:r.quitEarly,changes:l(r.changes),moves:r.moves.map(c=>new TV(new is(new He(c[0],c[1]),new He(c[2],c[3])),l(c[4])))};function l(c){return c.map(d=>new Vo(new He(d[0],d[1]),new He(d[2],d[3]),d[4]?.map(h=>new No(new k(h[0],h[1],h[2],h[3]),new k(h[4],h[5],h[6],h[7])))))}}async computeMoreMinimalEdits(e,t,i=!1){if(os(t)){if(!su(this._modelService,e))return Promise.resolve(t);const n=un.create(),o=this._workerWithResources([e]).then(r=>r.$computeMoreMinimalEdits(e.toString(),t,i));return o.finally(()=>this._logService.trace("FORMAT#computeMoreMinimalEdits",e.toString(!0),n.elapsed())),Promise.race([o,Wc(1e3).then(()=>t)])}else return Promise.resolve(void 0)}canNavigateValueSet(e){return su(this._modelService,e)}async navigateValueSet(e,t,i){const n=this._modelService.getModel(e);if(!n)return null;const o=this._languageConfigurationService.getLanguageConfiguration(n.getLanguageId()).getWordDefinition(),r=o.source,a=o.flags;return(await this._workerWithResources([e])).$navigateValueSet(e.toString(),t,i,r,a)}canComputeWordRanges(e){return su(this._modelService,e)}async computeWordRanges(e,t){const i=this._modelService.getModel(e);if(!i)return Promise.resolve(null);const n=this._languageConfigurationService.getLanguageConfiguration(i.getLanguageId()).getWordDefinition(),o=n.source,r=n.flags;return(await this._workerWithResources([e])).$computeWordRanges(e.toString(),t,o,r)}async findSectionHeaders(e,t){return(await this._workerWithResources([e])).$findSectionHeaders(e.toString(),t)}async computeDefaultDocumentColors(e){return(await this._workerWithResources([e])).$computeDefaultDocumentColors(e.toString())}async _workerWithResources(e,t=!1){return await(await this._workerManager.withWorker()).workerWithSyncedResources(e,t)}};yE=m2([nu(1,Zt),nu(2,WL),nu(3,Pn),nu(4,di),nu(5,pe)],yE);class Pse{constructor(e,t,i,n){this.languageConfigurationService=n,this._debugDisplayName="wordbasedCompletions",this._workerManager=e,this._configurationService=t,this._modelService=i}async provideCompletionItems(e,t){const i=this._configurationService.getValue(e.uri,t,"editor");if(i.wordBasedSuggestions==="off")return;const n=[];if(i.wordBasedSuggestions==="currentDocument")su(this._modelService,e.uri)&&n.push(e.uri);else for(const h of this._modelService.getModels())su(this._modelService,h.uri)&&(h===e?n.unshift(h.uri):(i.wordBasedSuggestions==="allDocuments"||h.getLanguageId()===e.getLanguageId())&&n.push(h.uri));if(n.length===0)return;const o=this.languageConfigurationService.getLanguageConfiguration(e.getLanguageId()).getWordDefinition(),r=e.getWordAtPosition(t),a=r?new k(t.lineNumber,r.startColumn,t.lineNumber,r.endColumn):k.fromPositions(t),l=a.setEndPosition(t.lineNumber,t.column),d=await(await this._workerManager.withWorker()).textualSuggest(n,r?.word,o);if(d)return{duration:d.duration,suggestions:d.words.map(h=>({kind:18,label:h,insertText:h,range:{insert:l,replace:a}}))}}}let wE=class extends B{constructor(e,t){super(),this._workerDescriptor=e,this._modelService=t,this._editorWorkerClient=null,this._lastWorkerUsedTime=new Date().getTime(),this._register(new XP).cancelAndSet(()=>this._checkStopIdleWorker(),Math.round(W3/2),Nt),this._register(this._modelService.onModelRemoved(n=>this._checkStopEmptyWorker()))}dispose(){this._editorWorkerClient&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null),super.dispose()}_checkStopEmptyWorker(){if(!this._editorWorkerClient)return;this._modelService.getModels().length===0&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}_checkStopIdleWorker(){if(!this._editorWorkerClient)return;new Date().getTime()-this._lastWorkerUsedTime>W3&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}withWorker(){return this._lastWorkerUsedTime=new Date().getTime(),this._editorWorkerClient||(this._editorWorkerClient=new e0(this._workerDescriptor,!1,this._modelService)),Promise.resolve(this._editorWorkerClient)}};wE=m2([nu(1,Zt)],wE);class Ose{constructor(e){this._instance=e,this.proxy=this._instance}dispose(){this._instance.dispose()}setChannel(e,t){throw new Error("Not supported")}}let e0=class extends B{constructor(e,t,i){super(),this._workerDescriptor=e,this._disposed=!1,this._modelService=i,this._keepIdleModels=t,this._worker=null,this._modelManager=null}fhr(e,t){throw new Error("Not implemented!")}_getOrCreateWorker(){if(!this._worker)try{this._worker=this._register(Wie(this._workerDescriptor)),Q1.setChannel(this._worker,this._createEditorWorkerHost())}catch(e){gE(e),this._worker=this._createFallbackLocalWorker()}return this._worker}async _getProxy(){try{const e=this._getOrCreateWorker().proxy;return await e.$ping(),e}catch(e){return gE(e),this._worker=this._createFallbackLocalWorker(),this._worker.proxy}}_createFallbackLocalWorker(){return new Ose(new Bw(this._createEditorWorkerHost(),null))}_createEditorWorkerHost(){return{$fhr:(e,t)=>this.fhr(e,t)}}_getOrCreateModelManager(e){return this._modelManager||(this._modelManager=this._register(new Nse(e,this._modelService,this._keepIdleModels))),this._modelManager}async workerWithSyncedResources(e,t=!1){if(this._disposed)return Promise.reject(SJ());const i=await this._getProxy();return this._getOrCreateModelManager(i).ensureSyncedResources(e,t),i}async textualSuggest(e,t,i){const n=await this.workerWithSyncedResources(e),o=i.source,r=i.flags;return n.$textualSuggest(e.map(a=>a.toString()),t,o,r)}dispose(){super.dispose(),this._disposed=!0}};e0=m2([nu(2,Zt)],e0);var gr;(function(s){s.DARK="dark",s.LIGHT="light",s.HIGH_CONTRAST_DARK="hcDark",s.HIGH_CONTRAST_LIGHT="hcLight"})(gr||(gr={}));function Ra(s){return s===gr.HIGH_CONTRAST_DARK||s===gr.HIGH_CONTRAST_LIGHT}function Dp(s){return s===gr.DARK||s===gr.HIGH_CONTRAST_DARK}const Ki=Je("themeService");function _i(s){return{id:s}}function SE(s){switch(s){case gr.DARK:return"vs-dark";case gr.HIGH_CONTRAST_DARK:return"hc-black";case gr.HIGH_CONTRAST_LIGHT:return"hc-light";default:return"vs"}}const BV={ThemingContribution:"base.contributions.theming"};class Fse{constructor(){this.themingParticipants=[],this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new O}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),Ce(()=>{const t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)})}getThemingParticipants(){return this.themingParticipants}}const WV=new Fse;ci.add(BV.ThemingContribution,WV);function kr(s){return WV.onColorThemeChange(s)}class Bse extends B{constructor(e){super(),this.themeService=e,this.theme=e.getColorTheme(),this._register(this.themeService.onDidColorThemeChange(t=>this.onThemeChange(t)))}onThemeChange(e){this.theme=e,this.updateStyles()}updateStyles(){}}var Wse=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Hse=function(s,e){return function(t,i){e(t,i,s)}};let LE=class extends B{constructor(e){super(),this._themeService=e,this._onWillCreateCodeEditor=this._register(new O),this._onCodeEditorAdd=this._register(new O),this.onCodeEditorAdd=this._onCodeEditorAdd.event,this._onCodeEditorRemove=this._register(new O),this.onCodeEditorRemove=this._onCodeEditorRemove.event,this._onWillCreateDiffEditor=this._register(new O),this._onDiffEditorAdd=this._register(new O),this.onDiffEditorAdd=this._onDiffEditorAdd.event,this._onDiffEditorRemove=this._register(new O),this.onDiffEditorRemove=this._onDiffEditorRemove.event,this._decorationOptionProviders=new Map,this._codeEditorOpenHandlers=new fs,this._modelProperties=new Map,this._codeEditors=Object.create(null),this._diffEditors=Object.create(null),this._globalStyleSheet=null}willCreateCodeEditor(){this._onWillCreateCodeEditor.fire()}addCodeEditor(e){this._codeEditors[e.getId()]=e,this._onCodeEditorAdd.fire(e)}removeCodeEditor(e){delete this._codeEditors[e.getId()]&&this._onCodeEditorRemove.fire(e)}listCodeEditors(){return Object.keys(this._codeEditors).map(e=>this._codeEditors[e])}willCreateDiffEditor(){this._onWillCreateDiffEditor.fire()}addDiffEditor(e){this._diffEditors[e.getId()]=e,this._onDiffEditorAdd.fire(e)}listDiffEditors(){return Object.keys(this._diffEditors).map(e=>this._diffEditors[e])}getFocusedCodeEditor(){let e=null;const t=this.listCodeEditors();for(const i of t){if(i.hasTextFocus())return i;i.hasWidgetFocus()&&(e=i)}return e}removeDecorationType(e){const t=this._decorationOptionProviders.get(e);t&&(t.refCount--,t.refCount<=0&&(this._decorationOptionProviders.delete(e),t.dispose(),this.listCodeEditors().forEach(i=>i.removeDecorationsByType(e))))}setModelProperty(e,t,i){const n=e.toString();let o;this._modelProperties.has(n)?o=this._modelProperties.get(n):(o=new Map,this._modelProperties.set(n,o)),o.set(t,i)}getModelProperty(e,t){const i=e.toString();if(this._modelProperties.has(i))return this._modelProperties.get(i).get(t)}async openCodeEditor(e,t,i){for(const n of this._codeEditorOpenHandlers){const o=await n(e,t,i);if(o!==null)return o}return null}registerCodeEditorOpenHandler(e){const t=this._codeEditorOpenHandlers.unshift(e);return Ce(t)}};LE=Wse([Hse(0,Ki)],LE);var Vse=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},H3=function(s,e){return function(t,i){e(t,i,s)}};let t0=class extends LE{constructor(e,t){super(t),this._register(this.onCodeEditorAdd(()=>this._checkContextKey())),this._register(this.onCodeEditorRemove(()=>this._checkContextKey())),this._editorIsOpen=e.createKey("editorIsOpen",!1),this._activeCodeEditor=null,this._register(this.registerCodeEditorOpenHandler(async(i,n,o)=>n?this.doOpenEditor(n,i):null))}_checkContextKey(){let e=!1;for(const t of this.listCodeEditors())if(!t.isSimpleWidget){e=!0;break}this._editorIsOpen.set(e)}setActiveCodeEditor(e){this._activeCodeEditor=e}getActiveCodeEditor(){return this._activeCodeEditor}doOpenEditor(e,t){if(!this.findModel(e,t.resource)){if(t.resource){const o=t.resource.scheme;if(o===Fe.http||o===Fe.https)return nV(t.resource.toString()),e}return null}const n=t.options?t.options.selection:null;if(n)if(typeof n.endLineNumber=="number"&&typeof n.endColumn=="number")e.setSelection(n),e.revealRangeInCenter(n,1);else{const o={lineNumber:n.startLineNumber,column:n.startColumn};e.setPosition(o),e.revealPositionInCenter(o,1)}return e}findModel(e,t){const i=e.getModel();return i&&i.uri.toString()!==t.toString()?null:i}};t0=Vse([H3(0,Ee),H3(1,Ki)],t0);nt(ft,t0,0);const vh=Je("layoutService");var HV=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},VV=function(s,e){return function(t,i){e(t,i,s)}};let i0=class{get mainContainer(){return LP(this._codeEditorService.listCodeEditors())?.getContainerDomNode()??Nt.document.body}get activeContainer(){return(this._codeEditorService.getFocusedCodeEditor()??this._codeEditorService.getActiveCodeEditor())?.getContainerDomNode()??this.mainContainer}get mainContainerDimension(){return sh(this.mainContainer)}get activeContainerDimension(){return sh(this.activeContainer)}get containers(){return Yr(this._codeEditorService.listCodeEditors().map(e=>e.getContainerDomNode()))}getContainer(){return this.activeContainer}whenContainerStylesLoaded(){}focus(){this._codeEditorService.getFocusedCodeEditor()?.focus()}constructor(e){this._codeEditorService=e,this.onDidLayoutMainContainer=se.None,this.onDidLayoutActiveContainer=se.None,this.onDidLayoutContainer=se.None,this.onDidChangeActiveContainer=se.None,this.onDidAddContainer=se.None,this.mainContainerOffset={top:0,quickPickTop:0},this.activeContainerOffset={top:0,quickPickTop:0}}};i0=HV([VV(0,ft)],i0);let xE=class extends i0{get mainContainer(){return this._container}constructor(e,t){super(t),this._container=e}};xE=HV([VV(1,ft)],xE);nt(vh,i0,1);var tv;(function(s){s[s.Ignore=0]="Ignore",s[s.Info=1]="Info",s[s.Warning=2]="Warning",s[s.Error=3]="Error"})(tv||(tv={}));(function(s){const e="error",t="warning",i="warn",n="info",o="ignore";function r(l){return l?Cf(e,l)?s.Error:Cf(t,l)||Cf(i,l)?s.Warning:Cf(n,l)?s.Info:s.Ignore:s.Ignore}s.fromValue=r;function a(l){switch(l){case s.Error:return e;case s.Warning:return t;case s.Info:return n;default:return o}}s.toString=a})(tv||(tv={}));const Di=tv,xC=Je("dialogService");var HL=Di;const Ii=Je("notificationService");class zse{}const _2=Je("undoRedoService");class zV{constructor(e,t){this.resource=e,this.elements=t}}class n0{static{this._ID=0}constructor(){this.id=n0._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static{this.None=new n0}}class vd{static{this._ID=0}constructor(){this.id=vd._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static{this.None=new vd}}var Use=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},V3=function(s,e){return function(t,i){e(t,i,s)}};function Sy(s){return s.scheme===Fe.file?s.fsPath:s.path}let UV=0;class Ly{constructor(e,t,i,n,o,r,a){this.id=++UV,this.type=0,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabel=t,this.strResource=i,this.resourceLabels=[this.resourceLabel],this.strResources=[this.strResource],this.groupId=n,this.groupOrder=o,this.sourceId=r,this.sourceOrder=a,this.isValid=!0}setValid(e){this.isValid=e}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.isValid?"  VALID":"INVALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class z3{constructor(e,t){this.resourceLabel=e,this.reason=t}}class U3{constructor(){this.elements=new Map}createMessage(){const e=[],t=[];for(const[,n]of this.elements)(n.reason===0?e:t).push(n.resourceLabel);const i=[];return e.length>0&&i.push(p({key:"externalRemoval",comment:["{0} is a list of filenames"]},"The following files have been closed and modified on disk: {0}.",e.join(", "))),t.length>0&&i.push(p({key:"noParallelUniverses",comment:["{0} is a list of filenames"]},"The following files have been modified in an incompatible way: {0}.",t.join(", "))),i.join(`
`)}get size(){return this.elements.size}has(e){return this.elements.has(e)}set(e,t){this.elements.set(e,t)}delete(e){return this.elements.delete(e)}}class $se{constructor(e,t,i,n,o,r,a){this.id=++UV,this.type=1,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabels=t,this.strResources=i,this.groupId=n,this.groupOrder=o,this.sourceId=r,this.sourceOrder=a,this.removedResources=null,this.invalidatedResources=null}canSplit(){return typeof this.actual.split=="function"}removeResource(e,t,i){this.removedResources||(this.removedResources=new U3),this.removedResources.has(t)||this.removedResources.set(t,new z3(e,i))}setValid(e,t,i){i?this.invalidatedResources&&(this.invalidatedResources.delete(t),this.invalidatedResources.size===0&&(this.invalidatedResources=null)):(this.invalidatedResources||(this.invalidatedResources=new U3),this.invalidatedResources.has(t)||this.invalidatedResources.set(t,new z3(e,0)))}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.invalidatedResources?"INVALID":"  VALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class $V{constructor(e,t){this.resourceLabel=e,this.strResource=t,this._past=[],this._future=[],this.locked=!1,this.versionId=1}dispose(){for(const e of this._past)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);for(const e of this._future)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);this.versionId++}toString(){const e=[];e.push(`* ${this.strResource}:`);for(let t=0;t<this._past.length;t++)e.push(`   * [UNDO] ${this._past[t]}`);for(let t=this._future.length-1;t>=0;t--)e.push(`   * [REDO] ${this._future[t]}`);return e.join(`
`)}flushAllElements(){this._past=[],this._future=[],this.versionId++}_setElementValidFlag(e,t){e.type===1?e.setValid(this.resourceLabel,this.strResource,t):e.setValid(t)}setElementsValidFlag(e,t){for(const i of this._past)t(i.actual)&&this._setElementValidFlag(i,e);for(const i of this._future)t(i.actual)&&this._setElementValidFlag(i,e)}pushElement(e){for(const t of this._future)t.type===1&&t.removeResource(this.resourceLabel,this.strResource,1);this._future=[],this._past.push(e),this.versionId++}createSnapshot(e){const t=[];for(let i=0,n=this._past.length;i<n;i++)t.push(this._past[i].id);for(let i=this._future.length-1;i>=0;i--)t.push(this._future[i].id);return new zV(e,t)}restoreSnapshot(e){const t=e.elements.length;let i=!0,n=0,o=-1;for(let a=0,l=this._past.length;a<l;a++,n++){const c=this._past[a];i&&(n>=t||c.id!==e.elements[n])&&(i=!1,o=0),!i&&c.type===1&&c.removeResource(this.resourceLabel,this.strResource,0)}let r=-1;for(let a=this._future.length-1;a>=0;a--,n++){const l=this._future[a];i&&(n>=t||l.id!==e.elements[n])&&(i=!1,r=a),!i&&l.type===1&&l.removeResource(this.resourceLabel,this.strResource,0)}o!==-1&&(this._past=this._past.slice(0,o)),r!==-1&&(this._future=this._future.slice(r+1)),this.versionId++}getElements(){const e=[],t=[];for(const i of this._past)e.push(i.actual);for(const i of this._future)t.push(i.actual);return{past:e,future:t}}getClosestPastElement(){return this._past.length===0?null:this._past[this._past.length-1]}getSecondClosestPastElement(){return this._past.length<2?null:this._past[this._past.length-2]}getClosestFutureElement(){return this._future.length===0?null:this._future[this._future.length-1]}hasPastElements(){return this._past.length>0}hasFutureElements(){return this._future.length>0}splitPastWorkspaceElement(e,t){for(let i=this._past.length-1;i>=0;i--)if(this._past[i]===e){t.has(this.strResource)?this._past[i]=t.get(this.strResource):this._past.splice(i,1);break}this.versionId++}splitFutureWorkspaceElement(e,t){for(let i=this._future.length-1;i>=0;i--)if(this._future[i]===e){t.has(this.strResource)?this._future[i]=t.get(this.strResource):this._future.splice(i,1);break}this.versionId++}moveBackward(e){this._past.pop(),this._future.push(e),this.versionId++}moveForward(e){this._future.pop(),this._past.push(e),this.versionId++}}class lD{constructor(e){this.editStacks=e,this._versionIds=[];for(let t=0,i=this.editStacks.length;t<i;t++)this._versionIds[t]=this.editStacks[t].versionId}isValid(){for(let e=0,t=this.editStacks.length;e<t;e++)if(this._versionIds[e]!==this.editStacks[e].versionId)return!1;return!0}}const jV=new $V("","");jV.locked=!0;let kE=class{constructor(e,t){this._dialogService=e,this._notificationService=t,this._editStacks=new Map,this._uriComparisonKeyComputers=[]}getUriComparisonKey(e){for(const t of this._uriComparisonKeyComputers)if(t[0]===e.scheme)return t[1].getComparisonKey(e);return e.toString()}_print(e){console.log("------------------------------------"),console.log(`AFTER ${e}: `);const t=[];for(const i of this._editStacks)t.push(i[1].toString());console.log(t.join(`
`))}pushElement(e,t=n0.None,i=vd.None){if(e.type===0){const n=Sy(e.resource),o=this.getUriComparisonKey(e.resource);this._pushElement(new Ly(e,n,o,t.id,t.nextOrder(),i.id,i.nextOrder()))}else{const n=new Set,o=[],r=[];for(const a of e.resources){const l=Sy(a),c=this.getUriComparisonKey(a);n.has(c)||(n.add(c),o.push(l),r.push(c))}o.length===1?this._pushElement(new Ly(e,o[0],r[0],t.id,t.nextOrder(),i.id,i.nextOrder())):this._pushElement(new $se(e,o,r,t.id,t.nextOrder(),i.id,i.nextOrder()))}}_pushElement(e){for(let t=0,i=e.strResources.length;t<i;t++){const n=e.resourceLabels[t],o=e.strResources[t];let r;this._editStacks.has(o)?r=this._editStacks.get(o):(r=new $V(n,o),this._editStacks.set(o,r)),r.pushElement(e)}}getLastElement(e){const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){const i=this._editStacks.get(t);if(i.hasFutureElements())return null;const n=i.getClosestPastElement();return n?n.actual:null}return null}_splitPastWorkspaceElement(e,t){const i=e.actual.split(),n=new Map;for(const o of i){const r=Sy(o.resource),a=this.getUriComparisonKey(o.resource),l=new Ly(o,r,a,0,0,0,0);n.set(l.strResource,l)}for(const o of e.strResources){if(t&&t.has(o))continue;this._editStacks.get(o).splitPastWorkspaceElement(e,n)}}_splitFutureWorkspaceElement(e,t){const i=e.actual.split(),n=new Map;for(const o of i){const r=Sy(o.resource),a=this.getUriComparisonKey(o.resource),l=new Ly(o,r,a,0,0,0,0);n.set(l.strResource,l)}for(const o of e.strResources){if(t&&t.has(o))continue;this._editStacks.get(o).splitFutureWorkspaceElement(e,n)}}removeElements(e){const t=typeof e=="string"?e:this.getUriComparisonKey(e);this._editStacks.has(t)&&(this._editStacks.get(t).dispose(),this._editStacks.delete(t))}setElementsValidFlag(e,t,i){const n=this.getUriComparisonKey(e);this._editStacks.has(n)&&this._editStacks.get(n).setElementsValidFlag(t,i)}createSnapshot(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).createSnapshot(e):new zV(e,[])}restoreSnapshot(e){const t=this.getUriComparisonKey(e.resource);if(this._editStacks.has(t)){const i=this._editStacks.get(t);i.restoreSnapshot(e),!i.hasPastElements()&&!i.hasFutureElements()&&(i.dispose(),this._editStacks.delete(t))}}getElements(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).getElements():{past:[],future:[]}}_findClosestUndoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[n,o]of this._editStacks){const r=o.getClosestPastElement();r&&r.sourceId===e&&(!t||r.sourceOrder>t.sourceOrder)&&(t=r,i=n)}return[t,i]}canUndo(e){if(e instanceof vd){const[,i]=this._findClosestUndoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasPastElements():!1}_onError(e,t){Oe(e);for(const i of t.strResources)this.removeElements(i);this._notificationService.error(e)}_acquireLocks(e){for(const t of e.editStacks)if(t.locked)throw new Error("Cannot acquire edit stack lock");for(const t of e.editStacks)t.locked=!0;return()=>{for(const t of e.editStacks)t.locked=!1}}_safeInvokeWithLocks(e,t,i,n,o){const r=this._acquireLocks(i);let a;try{a=t()}catch(l){return r(),n.dispose(),this._onError(l,e)}return a?a.then(()=>(r(),n.dispose(),o()),l=>(r(),n.dispose(),this._onError(l,e))):(r(),n.dispose(),o())}async _invokeWorkspacePrepare(e){if(typeof e.actual.prepareUndoRedo>"u")return B.None;const t=e.actual.prepareUndoRedo();return typeof t>"u"?B.None:t}_invokeResourcePrepare(e,t){if(e.actual.type!==1||typeof e.actual.prepareUndoRedo>"u")return t(B.None);const i=e.actual.prepareUndoRedo();return i?mL(i)?t(i):i.then(n=>t(n)):t(B.None)}_getAffectedEditStacks(e){const t=[];for(const i of e.strResources)t.push(this._editStacks.get(i)||jV);return new lD(t)}_tryToSplitAndUndo(e,t,i,n){if(t.canSplit())return this._splitPastWorkspaceElement(t,i),this._notificationService.warn(n),new xy(this._undo(e,0,!0));for(const o of t.strResources)this.removeElements(o);return this._notificationService.warn(n),new xy}_checkWorkspaceUndo(e,t,i,n){if(t.removedResources)return this._tryToSplitAndUndo(e,t,t.removedResources,p({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(n&&t.invalidatedResources)return this._tryToSplitAndUndo(e,t,t.invalidatedResources,p({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const o=[];for(const a of i.editStacks)a.getClosestPastElement()!==t&&o.push(a.resourceLabel);if(o.length>0)return this._tryToSplitAndUndo(e,t,null,p({key:"cannotWorkspaceUndoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because changes were made to {1}",t.label,o.join(", ")));const r=[];for(const a of i.editStacks)a.locked&&r.push(a.resourceLabel);return r.length>0?this._tryToSplitAndUndo(e,t,null,p({key:"cannotWorkspaceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,r.join(", "))):i.isValid()?null:this._tryToSplitAndUndo(e,t,null,p({key:"cannotWorkspaceUndoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceUndo(e,t,i){const n=this._getAffectedEditStacks(t),o=this._checkWorkspaceUndo(e,t,n,!1);return o?o.returnValue:this._confirmAndExecuteWorkspaceUndo(e,t,n,i)}_isPartOfUndoGroup(e){if(!e.groupId)return!1;for(const[,t]of this._editStacks){const i=t.getClosestPastElement();if(i){if(i===e){const n=t.getSecondClosestPastElement();if(n&&n.groupId===e.groupId)return!0}if(i.groupId===e.groupId)return!0}}return!1}async _confirmAndExecuteWorkspaceUndo(e,t,i,n){if(t.canSplit()&&!this._isPartOfUndoGroup(t)){let a;(function(d){d[d.All=0]="All",d[d.This=1]="This",d[d.Cancel=2]="Cancel"})(a||(a={}));const{result:l}=await this._dialogService.prompt({type:Di.Info,message:p("confirmWorkspace","Would you like to undo '{0}' across all files?",t.label),buttons:[{label:p({key:"ok",comment:["{0} denotes a number that is > 1, && denotes a mnemonic"]},"&&Undo in {0} Files",i.editStacks.length),run:()=>a.All},{label:p({key:"nok",comment:["&& denotes a mnemonic"]},"Undo this &&File"),run:()=>a.This}],cancelButton:{run:()=>a.Cancel}});if(l===a.Cancel)return;if(l===a.This)return this._splitPastWorkspaceElement(t,null),this._undo(e,0,!0);const c=this._checkWorkspaceUndo(e,t,i,!1);if(c)return c.returnValue;n=!0}let o;try{o=await this._invokeWorkspacePrepare(t)}catch(a){return this._onError(a,t)}const r=this._checkWorkspaceUndo(e,t,i,!0);if(r)return o.dispose(),r.returnValue;for(const a of i.editStacks)a.moveBackward(t);return this._safeInvokeWithLocks(t,()=>t.actual.undo(),i,o,()=>this._continueUndoInGroup(t.groupId,n))}_resourceUndo(e,t,i){if(!t.isValid){e.flushAllElements();return}if(e.locked){const n=p({key:"cannotResourceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not undo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(n);return}return this._invokeResourcePrepare(t,n=>(e.moveBackward(t),this._safeInvokeWithLocks(t,()=>t.actual.undo(),new lD([e]),n,()=>this._continueUndoInGroup(t.groupId,i))))}_findClosestUndoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[n,o]of this._editStacks){const r=o.getClosestPastElement();r&&r.groupId===e&&(!t||r.groupOrder>t.groupOrder)&&(t=r,i=n)}return[t,i]}_continueUndoInGroup(e,t){if(!e)return;const[,i]=this._findClosestUndoElementInGroup(e);if(i)return this._undo(i,0,t)}undo(e){if(e instanceof vd){const[,t]=this._findClosestUndoElementWithSource(e.id);return t?this._undo(t,e.id,!1):void 0}return typeof e=="string"?this._undo(e,0,!1):this._undo(this.getUriComparisonKey(e),0,!1)}_undo(e,t=0,i){if(!this._editStacks.has(e))return;const n=this._editStacks.get(e),o=n.getClosestPastElement();if(!o)return;if(o.groupId){const[a,l]=this._findClosestUndoElementInGroup(o.groupId);if(o!==a&&l)return this._undo(l,t,i)}if((o.sourceId!==t||o.confirmBeforeUndo)&&!i)return this._confirmAndContinueUndo(e,t,o);try{return o.type===1?this._workspaceUndo(e,o,i):this._resourceUndo(n,o,i)}finally{}}async _confirmAndContinueUndo(e,t,i){if((await this._dialogService.confirm({message:p("confirmDifferentSource","Would you like to undo '{0}'?",i.label),primaryButton:p({key:"confirmDifferentSource.yes",comment:["&& denotes a mnemonic"]},"&&Yes"),cancelButton:p("confirmDifferentSource.no","No")})).confirmed)return this._undo(e,t,!0)}_findClosestRedoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[n,o]of this._editStacks){const r=o.getClosestFutureElement();r&&r.sourceId===e&&(!t||r.sourceOrder<t.sourceOrder)&&(t=r,i=n)}return[t,i]}canRedo(e){if(e instanceof vd){const[,i]=this._findClosestRedoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasFutureElements():!1}_tryToSplitAndRedo(e,t,i,n){if(t.canSplit())return this._splitFutureWorkspaceElement(t,i),this._notificationService.warn(n),new xy(this._redo(e));for(const o of t.strResources)this.removeElements(o);return this._notificationService.warn(n),new xy}_checkWorkspaceRedo(e,t,i,n){if(t.removedResources)return this._tryToSplitAndRedo(e,t,t.removedResources,p({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(n&&t.invalidatedResources)return this._tryToSplitAndRedo(e,t,t.invalidatedResources,p({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const o=[];for(const a of i.editStacks)a.getClosestFutureElement()!==t&&o.push(a.resourceLabel);if(o.length>0)return this._tryToSplitAndRedo(e,t,null,p({key:"cannotWorkspaceRedoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because changes were made to {1}",t.label,o.join(", ")));const r=[];for(const a of i.editStacks)a.locked&&r.push(a.resourceLabel);return r.length>0?this._tryToSplitAndRedo(e,t,null,p({key:"cannotWorkspaceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,r.join(", "))):i.isValid()?null:this._tryToSplitAndRedo(e,t,null,p({key:"cannotWorkspaceRedoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceRedo(e,t){const i=this._getAffectedEditStacks(t),n=this._checkWorkspaceRedo(e,t,i,!1);return n?n.returnValue:this._executeWorkspaceRedo(e,t,i)}async _executeWorkspaceRedo(e,t,i){let n;try{n=await this._invokeWorkspacePrepare(t)}catch(r){return this._onError(r,t)}const o=this._checkWorkspaceRedo(e,t,i,!0);if(o)return n.dispose(),o.returnValue;for(const r of i.editStacks)r.moveForward(t);return this._safeInvokeWithLocks(t,()=>t.actual.redo(),i,n,()=>this._continueRedoInGroup(t.groupId))}_resourceRedo(e,t){if(!t.isValid){e.flushAllElements();return}if(e.locked){const i=p({key:"cannotResourceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not redo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(i);return}return this._invokeResourcePrepare(t,i=>(e.moveForward(t),this._safeInvokeWithLocks(t,()=>t.actual.redo(),new lD([e]),i,()=>this._continueRedoInGroup(t.groupId))))}_findClosestRedoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[n,o]of this._editStacks){const r=o.getClosestFutureElement();r&&r.groupId===e&&(!t||r.groupOrder<t.groupOrder)&&(t=r,i=n)}return[t,i]}_continueRedoInGroup(e){if(!e)return;const[,t]=this._findClosestRedoElementInGroup(e);if(t)return this._redo(t)}redo(e){if(e instanceof vd){const[,t]=this._findClosestRedoElementWithSource(e.id);return t?this._redo(t):void 0}return typeof e=="string"?this._redo(e):this._redo(this.getUriComparisonKey(e))}_redo(e){if(!this._editStacks.has(e))return;const t=this._editStacks.get(e),i=t.getClosestFutureElement();if(i){if(i.groupId){const[n,o]=this._findClosestRedoElementInGroup(i.groupId);if(i!==n&&o)return this._redo(o)}try{return i.type===1?this._workspaceRedo(e,i):this._resourceRedo(t,i)}finally{}}}};kE=Use([V3(0,xC),V3(1,Ii)],kE);class xy{constructor(e){this.returnValue=e}}nt(_2,kE,1);function cs(s,e,t){return Math.min(Math.max(s,e),t)}class ZV{constructor(){this._n=1,this._val=0}update(e){return this._val=this._val+(e-this._val)/this._n,this._n+=1,this._val}get value(){return this._val}}class jse{constructor(e){this._n=0,this._val=0,this._values=[],this._index=0,this._sum=0,this._values=new Array(e),this._values.fill(0,0,e)}update(e){const t=this._values[this._index];return this._values[this._index]=e,this._index=(this._index+1)%this._values.length,this._sum-=t,this._sum+=e,this._n<this._values.length&&(this._n+=1),this._val=this._sum/this._n,this._val}get value(){return this._val}}const b2=Je("environmentService");var Zse=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},$3=function(s,e){return function(t,i){e(t,i,s)}};const Go=Je("ILanguageFeatureDebounceService");var s0;(function(s){const e=new WeakMap;let t=0;function i(n){let o=e.get(n);return o===void 0&&(o=++t,e.set(n,o)),o}s.of=i})(s0||(s0={}));class Kse{constructor(e){this._default=e}get(e){return this._default}update(e,t){return this._default}default(){return this._default}}class qse{constructor(e,t,i,n,o,r){this._logService=e,this._name=t,this._registry=i,this._default=n,this._min=o,this._max=r,this._cache=new Wl(50,.7)}_key(e){return e.id+this._registry.all(e).reduce((t,i)=>yL(s0.of(i),t),0)}get(e){const t=this._key(e),i=this._cache.get(t);return i?cs(i.value,this._min,this._max):this.default()}update(e,t){const i=this._key(e);let n=this._cache.get(i);n||(n=new jse(6),this._cache.set(i,n));const o=cs(n.update(t),this._min,this._max);return bL(e.uri,"output")||this._logService.trace(`[DEBOUNCE: ${this._name}] for ${e.uri.toString()} is ${o}ms`),o}_overall(){const e=new ZV;for(const[,t]of this._cache)e.update(t.value);return e.value}default(){const e=this._overall()|0||this._default;return cs(e,this._min,this._max)}}let DE=class{constructor(e,t){this._logService=e,this._data=new Map,this._isDev=t.isExtensionDevelopment||!t.isBuilt}for(e,t,i){const n=i?.min??50,o=i?.max??n**2,r=i?.key??void 0,a=`${s0.of(e)},${n}${r?","+r:""}`;let l=this._data.get(a);return l||(this._isDev?(this._logService.debug(`[DEBOUNCE: ${t}] is disabled in developed mode`),l=new Kse(n*1.5)):l=new qse(this._logService,t,e,this._overallAverage()|0||n*1.5,n,o),this._data.set(a,l)),l}_overallAverage(){const e=new ZV;for(const t of this._data.values())e.update(t.default());return e.value}};DE=Zse([$3(0,Pn),$3(1,b2)],DE);nt(Go,DE,1);class Bs{static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static getClassNameFromMetadata(e){let i="mtk"+this.getForeground(e);const n=this.getFontStyle(e);return n&1&&(i+=" mtki"),n&2&&(i+=" mtkb"),n&4&&(i+=" mtku"),n&8&&(i+=" mtks"),i}static getInlineStyleFromMetadata(e,t){const i=this.getForeground(e),n=this.getFontStyle(e);let o=`color: ${t[i]};`;n&1&&(o+="font-style: italic;"),n&2&&(o+="font-weight: bold;");let r="";return n&4&&(r+=" underline"),n&8&&(r+=" line-through"),r&&(o+=`text-decoration:${r};`),o}static getPresentationFromMetadata(e){const t=this.getForeground(e),i=this.getFontStyle(e);return{foreground:t,italic:!!(i&1),bold:!!(i&2),underline:!!(i&4),strikethrough:!!(i&8)}}}function rh(s){let e=0,t=0,i=0,n=0;for(let o=0,r=s.length;o<r;o++){const a=s.charCodeAt(o);a===13?(e===0&&(t=o),e++,o+1<r&&s.charCodeAt(o+1)===10?(n|=2,o++):n|=3,i=o+1):a===10&&(n|=1,e===0&&(t=o),e++,i=o+1)}return e===0&&(t=s.length),[e,t,s.length-i,n]}class X_{static create(e,t){return new X_(e,new o0(t))}get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._endLineNumber}constructor(e,t){this._startLineNumber=e,this._tokens=t,this._endLineNumber=this._startLineNumber+this._tokens.getMaxDeltaLine()}toString(){return this._tokens.toString(this._startLineNumber)}_updateEndLineNumber(){this._endLineNumber=this._startLineNumber+this._tokens.getMaxDeltaLine()}isEmpty(){return this._tokens.isEmpty()}getLineTokens(e){return this._startLineNumber<=e&&e<=this._endLineNumber?this._tokens.getLineTokens(e-this._startLineNumber):null}getRange(){const e=this._tokens.getRange();return e&&new k(this._startLineNumber+e.startLineNumber,e.startColumn,this._startLineNumber+e.endLineNumber,e.endColumn)}removeTokens(e){const t=e.startLineNumber-this._startLineNumber,i=e.endLineNumber-this._startLineNumber;this._startLineNumber+=this._tokens.removeTokens(t,e.startColumn-1,i,e.endColumn-1),this._updateEndLineNumber()}split(e){const t=e.startLineNumber-this._startLineNumber,i=e.endLineNumber-this._startLineNumber,[n,o,r]=this._tokens.split(t,e.startColumn-1,i,e.endColumn-1);return[new X_(this._startLineNumber,n),new X_(this._startLineNumber+r,o)]}applyEdit(e,t){const[i,n,o]=rh(t);this.acceptEdit(e,i,n,o,t.length>0?t.charCodeAt(0):0)}acceptEdit(e,t,i,n,o){this._acceptDeleteRange(e),this._acceptInsertText(new P(e.startLineNumber,e.startColumn),t,i,n,o),this._updateEndLineNumber()}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return;const t=e.startLineNumber-this._startLineNumber,i=e.endLineNumber-this._startLineNumber;if(i<0){const o=i-t;this._startLineNumber-=o;return}const n=this._tokens.getMaxDeltaLine();if(!(t>=n+1)){if(t<0&&i>=n+1){this._startLineNumber=0,this._tokens.clear();return}if(t<0){const o=-t;this._startLineNumber-=o,this._tokens.acceptDeleteRange(e.startColumn-1,0,0,i,e.endColumn-1)}else this._tokens.acceptDeleteRange(0,t,e.startColumn-1,i,e.endColumn-1)}}_acceptInsertText(e,t,i,n,o){if(t===0&&i===0)return;const r=e.lineNumber-this._startLineNumber;if(r<0){this._startLineNumber+=t;return}const a=this._tokens.getMaxDeltaLine();r>=a+1||this._tokens.acceptInsertText(r,e.column-1,t,i,n,o)}}class o0{constructor(e){this._tokens=e,this._tokenCount=e.length/4}toString(e){const t=[];for(let i=0;i<this._tokenCount;i++)t.push(`(${this._getDeltaLine(i)+e},${this._getStartCharacter(i)}-${this._getEndCharacter(i)})`);return`[${t.join(",")}]`}getMaxDeltaLine(){const e=this._getTokenCount();return e===0?-1:this._getDeltaLine(e-1)}getRange(){const e=this._getTokenCount();if(e===0)return null;const t=this._getStartCharacter(0),i=this._getDeltaLine(e-1),n=this._getEndCharacter(e-1);return new k(0,t+1,i,n+1)}_getTokenCount(){return this._tokenCount}_getDeltaLine(e){return this._tokens[4*e]}_getStartCharacter(e){return this._tokens[4*e+1]}_getEndCharacter(e){return this._tokens[4*e+2]}isEmpty(){return this._getTokenCount()===0}getLineTokens(e){let t=0,i=this._getTokenCount()-1;for(;t<i;){const n=t+Math.floor((i-t)/2),o=this._getDeltaLine(n);if(o<e)t=n+1;else if(o>e)i=n-1;else{let r=n;for(;r>t&&this._getDeltaLine(r-1)===e;)r--;let a=n;for(;a<i&&this._getDeltaLine(a+1)===e;)a++;return new j3(this._tokens.subarray(4*r,4*a+4))}}return this._getDeltaLine(t)===e?new j3(this._tokens.subarray(4*t,4*t+4)):null}clear(){this._tokenCount=0}removeTokens(e,t,i,n){const o=this._tokens,r=this._tokenCount;let a=0,l=!1,c=0;for(let d=0;d<r;d++){const h=4*d,u=o[h],g=o[h+1],f=o[h+2],m=o[h+3];if((u>e||u===e&&f>=t)&&(u<i||u===i&&g<=n))l=!0;else{if(a===0&&(c=u),l){const _=4*a;o[_]=u-c,o[_+1]=g,o[_+2]=f,o[_+3]=m}a++}}return this._tokenCount=a,c}split(e,t,i,n){const o=this._tokens,r=this._tokenCount,a=[],l=[];let c=a,d=0,h=0;for(let u=0;u<r;u++){const g=4*u,f=o[g],m=o[g+1],_=o[g+2],b=o[g+3];if(f>e||f===e&&_>=t){if(f<i||f===i&&m<=n)continue;c!==l&&(c=l,d=0,h=f)}c[d++]=f-h,c[d++]=m,c[d++]=_,c[d++]=b}return[new o0(new Uint32Array(a)),new o0(new Uint32Array(l)),h]}acceptDeleteRange(e,t,i,n,o){const r=this._tokens,a=this._tokenCount,l=n-t;let c=0,d=!1;for(let h=0;h<a;h++){const u=4*h;let g=r[u],f=r[u+1],m=r[u+2];const _=r[u+3];if(g<t||g===t&&m<=i){c++;continue}else if(g===t&&f<i)g===n&&m>o?m-=o-i:m=i;else if(g===t&&f===i)if(g===n&&m>o)m-=o-i;else{d=!0;continue}else if(g<n||g===n&&f<o)if(g===n&&m>o)g=t,f=i,m=f+(m-o);else{d=!0;continue}else if(g>n){if(l===0&&!d){c=a;break}g-=l}else if(g===n&&f>=o)e&&g===0&&(f+=e,m+=e),g-=l,f-=o-i,m-=o-i;else throw new Error("Not possible!");const b=4*c;r[b]=g,r[b+1]=f,r[b+2]=m,r[b+3]=_,c++}this._tokenCount=c}acceptInsertText(e,t,i,n,o,r){const a=i===0&&n===1&&(r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122),l=this._tokens,c=this._tokenCount;for(let d=0;d<c;d++){const h=4*d;let u=l[h],g=l[h+1],f=l[h+2];if(!(u<e||u===e&&f<t)){if(u===e&&f===t)if(a)f+=1;else continue;else if(u===e&&g<t&&t<f)i===0?f+=n:f=t;else{if(u===e&&g===t&&a)continue;if(u===e)if(u+=i,i===0)g+=n,f+=n;else{const m=f-g;g=o+(g-t),f=g+m}else u+=i}l[h]=u,l[h+1]=g,l[h+2]=f}}}}class j3{constructor(e){this._tokens=e}getCount(){return this._tokens.length/4}getStartCharacter(e){return this._tokens[4*e+1]}getEndCharacter(e){return this._tokens[4*e+2]}getMetadata(e){return this._tokens[4*e+3]}}var Gse=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},cD=function(s,e){return function(t,i){e(t,i,s)}};let IE=class{constructor(e,t,i,n){this._legend=e,this._themeService=t,this._languageService=i,this._logService=n,this._hasWarnedOverlappingTokens=!1,this._hasWarnedInvalidLengthTokens=!1,this._hasWarnedInvalidEditStart=!1,this._hashTable=new pd}getMetadata(e,t,i){const n=this._languageService.languageIdCodec.encodeLanguageId(i),o=this._hashTable.get(e,t,n);let r;if(o)r=o.metadata;else{let a=this._legend.tokenTypes[e];const l=[];if(a){let c=t;for(let h=0;c>0&&h<this._legend.tokenModifiers.length;h++)c&1&&l.push(this._legend.tokenModifiers[h]),c=c>>1;const d=this._themeService.getColorTheme().getTokenStyleMetadata(a,l,i);if(typeof d>"u")r=2147483647;else{if(r=0,typeof d.italic<"u"){const h=(d.italic?1:0)<<11;r|=h|1}if(typeof d.bold<"u"){const h=(d.bold?2:0)<<11;r|=h|2}if(typeof d.underline<"u"){const h=(d.underline?4:0)<<11;r|=h|4}if(typeof d.strikethrough<"u"){const h=(d.strikethrough?8:0)<<11;r|=h|8}if(d.foreground){const h=d.foreground<<15;r|=h|16}r===0&&(r=2147483647)}}else r=2147483647,a="not-in-legend";this._hashTable.add(e,t,n,r)}return r}warnOverlappingSemanticTokens(e,t){this._hasWarnedOverlappingTokens||(this._hasWarnedOverlappingTokens=!0,this._logService.warn(`Overlapping semantic tokens detected at lineNumber ${e}, column ${t}`))}warnInvalidLengthSemanticTokens(e,t){this._hasWarnedInvalidLengthTokens||(this._hasWarnedInvalidLengthTokens=!0,this._logService.warn(`Semantic token with invalid length detected at lineNumber ${e}, column ${t}`))}warnInvalidEditStart(e,t,i,n,o){this._hasWarnedInvalidEditStart||(this._hasWarnedInvalidEditStart=!0,this._logService.warn(`Invalid semantic tokens edit detected (previousResultId: ${e}, resultId: ${t}) at edit #${i}: The provided start offset ${n} is outside the previous data (length ${o}).`))}};IE=Gse([cD(1,Ki),cD(2,ni),cD(3,Pn)],IE);function KV(s,e,t){const i=s.data,n=s.data.length/5|0,o=Math.max(Math.ceil(n/1024),400),r=[];let a=0,l=1,c=0;for(;a<n;){const d=a;let h=Math.min(d+o,n);if(h<n){let v=h;for(;v-1>d&&i[5*v]===0;)v--;if(v-1===d){let C=h;for(;C+1<n&&i[5*C]===0;)C++;h=C}else h=v}let u=new Uint32Array((h-d)*4),g=0,f=0,m=0,_=0;for(;a<h;){const v=5*a,C=i[v],y=i[v+1],w=l+C|0,x=C===0?c+y|0:y,L=i[v+2],D=x+L|0,T=i[v+3],F=i[v+4];if(D<=x)e.warnInvalidLengthSemanticTokens(w,x+1);else if(m===w&&_>x)e.warnOverlappingSemanticTokens(w,x+1);else{const W=e.getMetadata(T,F,t);W!==2147483647&&(f===0&&(f=w),u[g]=w-f,u[g+1]=x,u[g+2]=D,u[g+3]=W,g+=4,m=w,_=D)}l=w,c=x,a++}g!==u.length&&(u=u.subarray(0,g));const b=X_.create(f,u);r.push(b)}return r}class Yse{constructor(e,t,i,n){this.tokenTypeIndex=e,this.tokenModifierSet=t,this.languageId=i,this.metadata=n,this.next=null}}class pd{static{this._SIZES=[3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143]}constructor(){this._elementsCount=0,this._currentLengthIndex=0,this._currentLength=pd._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<pd._SIZES.length?2/3*this._currentLength:0),this._elements=[],pd._nullOutEntries(this._elements,this._currentLength)}static _nullOutEntries(e,t){for(let i=0;i<t;i++)e[i]=null}_hash2(e,t){return(e<<5)-e+t|0}_hashFunc(e,t,i){return this._hash2(this._hash2(e,t),i)%this._currentLength}get(e,t,i){const n=this._hashFunc(e,t,i);let o=this._elements[n];for(;o;){if(o.tokenTypeIndex===e&&o.tokenModifierSet===t&&o.languageId===i)return o;o=o.next}return null}add(e,t,i,n){if(this._elementsCount++,this._growCount!==0&&this._elementsCount>=this._growCount){const o=this._elements;this._currentLengthIndex++,this._currentLength=pd._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<pd._SIZES.length?2/3*this._currentLength:0),this._elements=[],pd._nullOutEntries(this._elements,this._currentLength);for(const r of o){let a=r;for(;a;){const l=a.next;a.next=null,this._add(a),a=l}}}this._add(new Yse(e,t,i,n))}_add(e){const t=this._hashFunc(e.tokenTypeIndex,e.tokenModifierSet,e.languageId);e.next=this._elements[t],this._elements[t]=e}}const VL=Je("semanticTokensStylingService");var Xse=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},dD=function(s,e){return function(t,i){e(t,i,s)}};let TE=class extends B{constructor(e,t,i){super(),this._themeService=e,this._logService=t,this._languageService=i,this._caches=new WeakMap,this._register(this._themeService.onDidColorThemeChange(()=>{this._caches=new WeakMap}))}getStyling(e){return this._caches.has(e)||this._caches.set(e,new IE(e.getLegend(),this._themeService,this._languageService,this._logService)),this._caches.get(e)}};TE=Xse([dD(0,Ki),dD(1,Pn),dD(2,ni)],TE);nt(VL,TE,1);function ad(s){return s===47||s===92}function qV(s){return s.replace(/[\\/]/g,Ai.sep)}function Qse(s){return s.indexOf("/")===-1&&(s=qV(s)),/^[a-zA-Z]:(\/|$)/.test(s)&&(s="/"+s),s}function Z3(s,e=Ai.sep){if(!s)return"";const t=s.length,i=s.charCodeAt(0);if(ad(i)){if(ad(s.charCodeAt(1))&&!ad(s.charCodeAt(2))){let o=3;const r=o;for(;o<t&&!ad(s.charCodeAt(o));o++);if(r!==o&&!ad(s.charCodeAt(o+1))){for(o+=1;o<t;o++)if(ad(s.charCodeAt(o)))return s.slice(0,o+1).replace(/[\\/]/g,e)}}return e}else if(GV(i)&&s.charCodeAt(1)===58)return ad(s.charCodeAt(2))?s.slice(0,2)+e:s.slice(0,2);let n=s.indexOf("://");if(n!==-1){for(n+=3;n<t;n++)if(ad(s.charCodeAt(n)))return s.slice(0,n+1)}return""}function EE(s,e,t,i=Ta){if(s===e)return!0;if(!s||!e||e.length>s.length)return!1;if(t){if(!WP(s,e))return!1;if(e.length===s.length)return!0;let o=e.length;return e.charAt(e.length-1)===i&&o--,s.charAt(o)===i}return e.charAt(e.length-1)!==i&&(e+=i),s.indexOf(e)===0}function GV(s){return s>=65&&s<=90||s>=97&&s<=122}function Jse(s,e=An){return e?GV(s.charCodeAt(0))&&s.charCodeAt(1)===58:!1}const ky="**",K3="/",Ww="[/\\\\]",Hw="[^/\\\\]",eoe=/\//g;function q3(s,e){switch(s){case 0:return"";case 1:return`${Hw}*?`;default:return`(?:${Ww}|${Hw}+${Ww}${e?`|${Ww}${Hw}+`:""})*?`}}function G3(s,e){if(!s)return[];const t=[];let i=!1,n=!1,o="";for(const r of s){switch(r){case e:if(!i&&!n){t.push(o),o="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":n=!0;break;case"]":n=!1;break}o+=r}return o&&t.push(o),t}function YV(s){if(!s)return"";let e="";const t=G3(s,K3);if(t.every(i=>i===ky))e=".*";else{let i=!1;t.forEach((n,o)=>{if(n===ky){if(i)return;e+=q3(2,o===t.length-1)}else{let r=!1,a="",l=!1,c="";for(const d of n){if(d!=="}"&&r){a+=d;continue}if(l&&(d!=="]"||!c)){let h;d==="-"?h=d:(d==="^"||d==="!")&&!c?h="^":d===K3?h="":h=Uo(d),c+=h;continue}switch(d){case"{":r=!0;continue;case"[":l=!0;continue;case"}":{const u=`(?:${G3(a,",").map(g=>YV(g)).join("|")})`;e+=u,r=!1,a="";break}case"]":{e+="["+c+"]",l=!1,c="";break}case"?":e+=Hw;continue;case"*":e+=q3(1);continue;default:e+=Uo(d)}}o<t.length-1&&(t[o+1]!==ky||o+2<t.length)&&(e+=Ww)}i=n===ky})}return e}const toe=/^\*\*\/\*\.[\w\.-]+$/,ioe=/^\*\*\/([\w\.-]+)\/?$/,noe=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,soe=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,ooe=/^\*\*((\/[\w\.-]+)+)\/?$/,roe=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,Y3=new Wl(1e4),X3=function(){return!1},xl=function(){return null};function v2(s,e){if(!s)return xl;let t;typeof s!="string"?t=s.pattern:t=s,t=t.trim();const i=`${t}_${!!e.trimForExclusions}`;let n=Y3.get(i);if(n)return Q3(n,s);let o;return toe.test(t)?n=aoe(t.substr(4),t):(o=ioe.exec(hD(t,e)))?n=loe(o[1],t):(e.trimForExclusions?soe:noe).test(t)?n=coe(t,e):(o=ooe.exec(hD(t,e)))?n=J3(o[1].substr(1),t,!0):(o=roe.exec(hD(t,e)))?n=J3(o[1],t,!1):n=doe(t),Y3.set(i,n),Q3(n,s)}function Q3(s,e){if(typeof e=="string")return s;const t=function(i,n){return EE(i,e.base,!ys)?s(_C(i.substr(e.base.length),Ta),n):null};return t.allBasenames=s.allBasenames,t.allPaths=s.allPaths,t.basenames=s.basenames,t.patterns=s.patterns,t}function hD(s,e){return e.trimForExclusions&&s.endsWith("/**")?s.substr(0,s.length-2):s}function aoe(s,e){return function(t,i){return typeof t=="string"&&t.endsWith(s)?e:null}}function loe(s,e){const t=`/${s}`,i=`\\${s}`,n=function(r,a){return typeof r!="string"?null:a?a===s?e:null:r===s||r.endsWith(t)||r.endsWith(i)?e:null},o=[s];return n.basenames=o,n.patterns=[e],n.allBasenames=o,n}function coe(s,e){const t=QV(s.slice(1,-1).split(",").map(a=>v2(a,e)).filter(a=>a!==xl),s),i=t.length;if(!i)return xl;if(i===1)return t[0];const n=function(a,l){for(let c=0,d=t.length;c<d;c++)if(t[c](a,l))return s;return null},o=t.find(a=>!!a.allBasenames);o&&(n.allBasenames=o.allBasenames);const r=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return r.length&&(n.allPaths=r),n}function J3(s,e,t){const i=Ta===Ai.sep,n=i?s:s.replace(eoe,Ta),o=Ta+n,r=Ai.sep+s;let a;return t?a=function(l,c){return typeof l=="string"&&(l===n||l.endsWith(o)||!i&&(l===s||l.endsWith(r)))?e:null}:a=function(l,c){return typeof l=="string"&&(l===n||!i&&l===s)?e:null},a.allPaths=[(t?"*/":"./")+s],a}function doe(s){try{const e=new RegExp(`^${YV(s)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?s:null}}catch{return xl}}function hoe(s,e,t){return!s||typeof e!="string"?!1:XV(s)(e,void 0,t)}function XV(s,e={}){if(!s)return X3;if(typeof s=="string"||uoe(s)){const t=v2(s,e);if(t===xl)return X3;const i=function(n,o){return!!t(n,o)};return t.allBasenames&&(i.allBasenames=t.allBasenames),t.allPaths&&(i.allPaths=t.allPaths),i}return goe(s,e)}function uoe(s){const e=s;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function goe(s,e){const t=QV(Object.getOwnPropertyNames(s).map(a=>foe(a,s[a],e)).filter(a=>a!==xl)),i=t.length;if(!i)return xl;if(!t.some(a=>!!a.requiresSiblings)){if(i===1)return t[0];const a=function(d,h){let u;for(let g=0,f=t.length;g<f;g++){const m=t[g](d,h);if(typeof m=="string")return m;tE(m)&&(u||(u=[]),u.push(m))}return u?(async()=>{for(const g of u){const f=await g;if(typeof f=="string")return f}return null})():null},l=t.find(d=>!!d.allBasenames);l&&(a.allBasenames=l.allBasenames);const c=t.reduce((d,h)=>h.allPaths?d.concat(h.allPaths):d,[]);return c.length&&(a.allPaths=c),a}const n=function(a,l,c){let d,h;for(let u=0,g=t.length;u<g;u++){const f=t[u];f.requiresSiblings&&c&&(l||(l=jd(a)),d||(d=l.substr(0,l.length-GJ(a).length)));const m=f(a,l,d,c);if(typeof m=="string")return m;tE(m)&&(h||(h=[]),h.push(m))}return h?(async()=>{for(const u of h){const g=await u;if(typeof g=="string")return g}return null})():null},o=t.find(a=>!!a.allBasenames);o&&(n.allBasenames=o.allBasenames);const r=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return r.length&&(n.allPaths=r),n}function foe(s,e,t){if(e===!1)return xl;const i=v2(s,t);if(i===xl)return xl;if(typeof e=="boolean")return i;if(e){const n=e.when;if(typeof n=="string"){const o=(r,a,l,c)=>{if(!c||!i(r,a))return null;const d=n.replace("$(basename)",()=>l),h=c(d);return tE(h)?h.then(u=>u?s:null):h?s:null};return o.requiresSiblings=!0,o}}return i}function QV(s,e){const t=s.filter(a=>!!a.basenames);if(t.length<2)return s;const i=t.reduce((a,l)=>{const c=l.basenames;return c?a.concat(c):a},[]);let n;if(e){n=[];for(let a=0,l=i.length;a<l;a++)n.push(e)}else n=t.reduce((a,l)=>{const c=l.patterns;return c?a.concat(c):a},[]);const o=function(a,l){if(typeof a!="string")return null;if(!l){let d;for(d=a.length;d>0;d--){const h=a.charCodeAt(d-1);if(h===47||h===92)break}l=a.substr(d)}const c=i.indexOf(l);return c!==-1?n[c]:null};o.basenames=i,o.patterns=n,o.allBasenames=i;const r=s.filter(a=>!a.basenames);return r.push(o),r}function C2(s,e,t,i,n,o){if(Array.isArray(s)){let r=0;for(const a of s){const l=C2(a,e,t,i,n,o);if(l===10)return l;l>r&&(r=l)}return r}else{if(typeof s=="string")return i?s==="*"?5:s===t?10:0:0;if(s){const{language:r,pattern:a,scheme:l,hasAccessToAllModels:c,notebookType:d}=s;if(!i&&!c)return 0;d&&n&&(e=n);let h=0;if(l)if(l===e.scheme)h=10;else if(l==="*")h=5;else return 0;if(r)if(r===t)h=10;else if(r==="*")h=Math.max(h,5);else return 0;if(d)if(d===o)h=10;else if(d==="*"&&o!==void 0)h=Math.max(h,5);else return 0;if(a){let u;if(typeof a=="string"?u=a:u={...a,base:p6(a.base)},u===e.fsPath||hoe(u,e.fsPath))h=10;else return 0}return h}else return 0}}function JV(s){return typeof s=="string"?!1:Array.isArray(s)?s.every(JV):!!s.exclusive}class eB{constructor(e,t,i,n,o){this.uri=e,this.languageId=t,this.notebookUri=i,this.notebookType=n,this.recursive=o}equals(e){return this.notebookType===e.notebookType&&this.languageId===e.languageId&&this.uri.toString()===e.uri.toString()&&this.notebookUri?.toString()===e.notebookUri?.toString()&&this.recursive===e.recursive}}class oi{constructor(e){this._notebookInfoResolver=e,this._clock=0,this._entries=[],this._onDidChange=new O,this.onDidChange=this._onDidChange.event}register(e,t){let i={selector:e,provider:t,_score:-1,_time:this._clock++};return this._entries.push(i),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),Ce(()=>{if(i){const n=this._entries.indexOf(i);n>=0&&(this._entries.splice(n,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),i=void 0)}})}has(e){return this.all(e).length>0}all(e){if(!e)return[];this._updateScores(e,!1);const t=[];for(const i of this._entries)i._score>0&&t.push(i.provider);return t}ordered(e,t=!1){const i=[];return this._orderedForEach(e,t,n=>i.push(n.provider)),i}orderedGroups(e){const t=[];let i,n;return this._orderedForEach(e,!1,o=>{i&&n===o._score?i.push(o.provider):(n=o._score,i=[o.provider],t.push(i))}),t}_orderedForEach(e,t,i){this._updateScores(e,t);for(const n of this._entries)n._score>0&&i(n)}_updateScores(e,t){const i=this._notebookInfoResolver?.(e.uri),n=i?new eB(e.uri,e.getLanguageId(),i.uri,i.type,t):new eB(e.uri,e.getLanguageId(),void 0,void 0,t);if(!this._lastCandidate?.equals(n)){this._lastCandidate=n;for(const o of this._entries)if(o._score=C2(o.selector,n.uri,n.languageId,IV(e),n.notebookUri,n.notebookType),JV(o.selector)&&o._score>0)if(t)o._score=0;else{for(const r of this._entries)r._score=0;o._score=1e3;break}this._entries.sort(oi._compareByScoreAndTime)}}static _compareByScoreAndTime(e,t){return e._score<t._score?1:e._score>t._score?-1:w_(e.selector)&&!w_(t.selector)?1:!w_(e.selector)&&w_(t.selector)?-1:e._time<t._time?1:e._time>t._time?-1:0}}function w_(s){return typeof s=="string"?!1:Array.isArray(s)?s.some(w_):!!s.isBuiltin}class poe{constructor(){this.referenceProvider=new oi(this._score.bind(this)),this.renameProvider=new oi(this._score.bind(this)),this.newSymbolNamesProvider=new oi(this._score.bind(this)),this.codeActionProvider=new oi(this._score.bind(this)),this.definitionProvider=new oi(this._score.bind(this)),this.typeDefinitionProvider=new oi(this._score.bind(this)),this.declarationProvider=new oi(this._score.bind(this)),this.implementationProvider=new oi(this._score.bind(this)),this.documentSymbolProvider=new oi(this._score.bind(this)),this.inlayHintsProvider=new oi(this._score.bind(this)),this.colorProvider=new oi(this._score.bind(this)),this.codeLensProvider=new oi(this._score.bind(this)),this.documentFormattingEditProvider=new oi(this._score.bind(this)),this.documentRangeFormattingEditProvider=new oi(this._score.bind(this)),this.onTypeFormattingEditProvider=new oi(this._score.bind(this)),this.signatureHelpProvider=new oi(this._score.bind(this)),this.hoverProvider=new oi(this._score.bind(this)),this.documentHighlightProvider=new oi(this._score.bind(this)),this.multiDocumentHighlightProvider=new oi(this._score.bind(this)),this.selectionRangeProvider=new oi(this._score.bind(this)),this.foldingRangeProvider=new oi(this._score.bind(this)),this.linkProvider=new oi(this._score.bind(this)),this.inlineCompletionsProvider=new oi(this._score.bind(this)),this.inlineEditProvider=new oi(this._score.bind(this)),this.completionProvider=new oi(this._score.bind(this)),this.linkedEditingRangeProvider=new oi(this._score.bind(this)),this.documentRangeSemanticTokensProvider=new oi(this._score.bind(this)),this.documentSemanticTokensProvider=new oi(this._score.bind(this)),this.documentDropEditProvider=new oi(this._score.bind(this)),this.documentPasteEditProvider=new oi(this._score.bind(this))}_score(e){return this._notebookTypeResolver?.(e)}}nt(pe,poe,1);function y2(s){return`--vscode-${s.replace(/\./g,"-")}`}function he(s){return`var(${y2(s)})`}function moe(s,e){return`var(${y2(s)}, ${e})`}function _oe(s){return s!==null&&typeof s=="object"&&"light"in s&&"dark"in s}const ez={ColorContribution:"base.contributions.colors"},boe="default";class voe{constructor(){this._onDidChangeSchema=new O,this.onDidChangeSchema=this._onDidChangeSchema.event,this.colorSchema={type:"object",properties:{}},this.colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]},this.colorsById={}}registerColor(e,t,i,n=!1,o){const r={id:e,description:i,defaults:t,needsTransparency:n,deprecationMessage:o};this.colorsById[e]=r;const a={type:"string",format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return o&&(a.deprecationMessage=o),n&&(a.pattern="^#(?:(?<rgba>[0-9a-fA-f]{3}[0-9a-eA-E])|(?:[0-9a-fA-F]{6}(?:(?![fF]{2})(?:[0-9a-fA-F]{2}))))?$",a.patternErrorMessage=p("transparecyRequired","This color must be transparent or it will obscure content")),this.colorSchema.properties[e]={description:i,oneOf:[a,{type:"string",const:boe,description:p("useDefault","Use the default color.")}]},this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(i),this._onDidChangeSchema.fire(),e}getColors(){return Object.keys(this.colorsById).map(e=>this.colorsById[e])}resolveDefaultColor(e,t){const i=this.colorsById[e];if(i?.defaults){const n=_oe(i.defaults)?i.defaults[t.type]:i.defaults;return da(n,t)}}getColorSchema(){return this.colorSchema}toString(){const e=(t,i)=>{const n=t.indexOf(".")===-1?0:1,o=i.indexOf(".")===-1?0:1;return n!==o?n-o:t.localeCompare(i)};return Object.keys(this.colorsById).sort(e).map(t=>`- \`${t}\`: ${this.colorsById[t].description}`).join(`
`)}}const zL=new voe;ci.add(ez.ColorContribution,zL);function E(s,e,t,i,n){return zL.registerColor(s,e,t,i,n)}function Coe(s,e){switch(s.op){case 0:return da(s.value,e)?.darken(s.factor);case 1:return da(s.value,e)?.lighten(s.factor);case 2:return da(s.value,e)?.transparent(s.factor);case 3:{const t=da(s.background,e);return t?da(s.value,e)?.makeOpaque(t):da(s.value,e)}case 4:for(const t of s.values){const i=da(t,e);if(i)return i}return;case 6:return da(e.defines(s.if)?s.then:s.else,e);case 5:{const t=da(s.value,e);if(!t)return;const i=da(s.background,e);return i?t.isDarkerThan(i)?G.getLighterColor(t,i,s.factor).transparent(s.transparency):G.getDarkerColor(t,i,s.factor).transparent(s.transparency):t.transparent(s.factor*s.transparency)}default:throw ML()}}function _g(s,e){return{op:0,value:s,factor:e}}function Ma(s,e){return{op:1,value:s,factor:e}}function je(s,e){return{op:2,value:s,factor:e}}function iv(...s){return{op:4,values:s}}function yoe(s,e,t){return{op:6,if:s,then:e,else:t}}function tB(s,e,t,i){return{op:5,value:s,background:e,factor:t,transparency:i}}function da(s,e){if(s!==null){if(typeof s=="string")return s[0]==="#"?G.fromHex(s):e.getColor(s);if(s instanceof G)return s;if(typeof s=="object")return Coe(s,e)}}const tz="vscode://schemas/workbench-colors",iz=ci.as(FL.JSONContribution);iz.registerSchema(tz,zL.getColorSchema());const iB=new It(()=>iz.notifySchemaChanged(tz),200);zL.onDidChangeSchema(()=>{iB.isScheduled()||iB.schedule()});const Ge=E("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},p("foreground","Overall foreground color. This color is only used if not overridden by a component."));E("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},p("disabledForeground","Overall foreground for disabled elements. This color is only used if not overridden by a component."));E("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},p("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component."));E("descriptionForeground",{light:"#717171",dark:je(Ge,.7),hcDark:je(Ge,.7),hcLight:je(Ge,.7)},p("descriptionForeground","Foreground color for description text providing additional information, for example for a label."));const r0=E("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},p("iconForeground","The default color for icons in the workbench.")),Tl=E("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},p("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),lt=E("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},p("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),Xt=E("contrastActiveBorder",{light:null,dark:null,hcDark:Tl,hcLight:Tl},p("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast."));E("selection.background",null,p("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor."));const woe=E("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},p("textLinkForeground","Foreground color for links in text."));E("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},p("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover."));E("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:G.black,hcLight:"#292929"},p("textSeparatorForeground","Color for text separators."));E("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#000000",hcLight:"#FFFFFF"},p("textPreformatForeground","Foreground color for preformatted text segments."));E("textPreformat.background",{light:"#0000001A",dark:"#FFFFFF1A",hcDark:"#FFFFFF",hcLight:"#09345f"},p("textPreformatBackground","Background color for preformatted text segments."));E("textBlockQuote.background",{light:"#f2f2f2",dark:"#222222",hcDark:null,hcLight:"#F2F2F2"},p("textBlockQuoteBackground","Background color for block quotes in text."));E("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:G.white,hcLight:"#292929"},p("textBlockQuoteBorder","Border color for block quotes in text."));E("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:G.black,hcLight:"#F2F2F2"},p("textCodeBlockBackground","Background color for code blocks in text."));E("sash.hoverBorder",Tl,p("sashActiveBorder","Border color of active sashes."));const Vw=E("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:G.black,hcLight:"#0F4A85"},p("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),Soe=E("badge.foreground",{dark:G.white,light:"#333",hcDark:G.white,hcLight:G.white},p("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),w2=E("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},p("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),nz=E("scrollbarSlider.background",{dark:G.fromHex("#797979").transparent(.4),light:G.fromHex("#646464").transparent(.4),hcDark:je(lt,.6),hcLight:je(lt,.4)},p("scrollbarSliderBackground","Scrollbar slider background color.")),sz=E("scrollbarSlider.hoverBackground",{dark:G.fromHex("#646464").transparent(.7),light:G.fromHex("#646464").transparent(.7),hcDark:je(lt,.8),hcLight:je(lt,.8)},p("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),oz=E("scrollbarSlider.activeBackground",{dark:G.fromHex("#BFBFBF").transparent(.4),light:G.fromHex("#000000").transparent(.6),hcDark:lt,hcLight:lt},p("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),Loe=E("progressBar.background",{dark:G.fromHex("#0E70C0"),light:G.fromHex("#0E70C0"),hcDark:lt,hcLight:lt},p("progressBarBackground","Background color of the progress bar that can show for long running operations.")),ea=E("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:G.black,hcLight:G.white},p("editorBackground","Editor background color.")),Hl=E("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:G.white,hcLight:Ge},p("editorForeground","Editor default foreground color."));E("editorStickyScroll.background",ea,p("editorStickyScrollBackground","Background color of sticky scroll in the editor"));E("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:G.fromHex("#0F4A85").transparent(.1)},p("editorStickyScrollHoverBackground","Background color of sticky scroll on hover in the editor"));E("editorStickyScroll.border",{dark:null,light:null,hcDark:lt,hcLight:lt},p("editorStickyScrollBorder","Border color of sticky scroll in the editor"));E("editorStickyScroll.shadow",w2,p("editorStickyScrollShadow"," Shadow color of sticky scroll in the editor"));const Bo=E("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:G.white},p("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),UL=E("editorWidget.foreground",Ge,p("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),S2=E("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:lt,hcLight:lt},p("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget."));E("editorWidget.resizeBorder",null,p("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget."));E("editorError.background",null,p("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const $L=E("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},p("editorError.foreground","Foreground color of error squigglies in the editor.")),xoe=E("editorError.border",{dark:null,light:null,hcDark:G.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},p("errorBorder","If set, color of double underlines for errors in the editor.")),koe=E("editorWarning.background",null,p("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),Vc=E("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},p("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),nv=E("editorWarning.border",{dark:null,light:null,hcDark:G.fromHex("#FFCC00").transparent(.8),hcLight:G.fromHex("#FFCC00").transparent(.8)},p("warningBorder","If set, color of double underlines for warnings in the editor."));E("editorInfo.background",null,p("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const El=E("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},p("editorInfo.foreground","Foreground color of info squigglies in the editor.")),sv=E("editorInfo.border",{dark:null,light:null,hcDark:G.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},p("infoBorder","If set, color of double underlines for infos in the editor.")),Doe=E("editorHint.foreground",{dark:G.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},p("editorHint.foreground","Foreground color of hint squigglies in the editor."));E("editorHint.border",{dark:null,light:null,hcDark:G.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},p("hintBorder","If set, color of double underlines for hints in the editor."));const Ioe=E("editorLink.activeForeground",{dark:"#4E94CE",light:G.blue,hcDark:G.cyan,hcLight:"#292929"},p("activeLinkForeground","Color of active links.")),Nd=E("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},p("editorSelectionBackground","Color of the editor selection.")),Toe=E("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:G.white},p("editorSelectionForeground","Color of the selected text for high contrast.")),rz=E("editor.inactiveSelectionBackground",{light:je(Nd,.5),dark:je(Nd,.5),hcDark:je(Nd,.7),hcLight:je(Nd,.5)},p("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),L2=E("editor.selectionHighlightBackground",{light:tB(Nd,ea,.3,.6),dark:tB(Nd,ea,.3,.6),hcDark:null,hcLight:null},p("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0);E("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:Xt,hcLight:Xt},p("editorSelectionHighlightBorder","Border color for regions with the same content as the selection."));E("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},p("editorFindMatch","Color of the current search match."));const Eoe=E("editor.findMatchForeground",null,p("editorFindMatchForeground","Text color of the current search match.")),wc=E("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},p("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),Noe=E("editor.findMatchHighlightForeground",null,p("findMatchHighlightForeground","Foreground color of the other search matches."),!0);E("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},p("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);E("editor.findMatchBorder",{light:null,dark:null,hcDark:Xt,hcLight:Xt},p("editorFindMatchBorder","Border color of the current search match."));const Rd=E("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:Xt,hcLight:Xt},p("findMatchHighlightBorder","Border color of the other search matches.")),Roe=E("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:je(Xt,.4),hcLight:je(Xt,.4)},p("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);E("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},p("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0);const a0=E("editorHoverWidget.background",Bo,p("hoverBackground","Background color of the editor hover."));E("editorHoverWidget.foreground",UL,p("hoverForeground","Foreground color of the editor hover."));const az=E("editorHoverWidget.border",S2,p("hoverBorder","Border color of the editor hover."));E("editorHoverWidget.statusBarBackground",{dark:Ma(a0,.2),light:_g(a0,.05),hcDark:Bo,hcLight:Bo},p("statusBarBackground","Background color of the editor hover status bar."));const x2=E("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:G.white,hcLight:G.black},p("editorInlayHintForeground","Foreground color of inline hints")),k2=E("editorInlayHint.background",{dark:je(Vw,.1),light:je(Vw,.1),hcDark:je(G.white,.1),hcLight:je(Vw,.1)},p("editorInlayHintBackground","Background color of inline hints")),Moe=E("editorInlayHint.typeForeground",x2,p("editorInlayHintForegroundTypes","Foreground color of inline hints for types")),Aoe=E("editorInlayHint.typeBackground",k2,p("editorInlayHintBackgroundTypes","Background color of inline hints for types")),Poe=E("editorInlayHint.parameterForeground",x2,p("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters")),Ooe=E("editorInlayHint.parameterBackground",k2,p("editorInlayHintBackgroundParameter","Background color of inline hints for parameters")),Foe=E("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},p("editorLightBulbForeground","The color used for the lightbulb actions icon."));E("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},p("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon."));E("editorLightBulbAi.foreground",Foe,p("editorLightBulbAiForeground","The color used for the lightbulb AI icon."));E("editor.snippetTabstopHighlightBackground",{dark:new G(new dt(124,124,124,.3)),light:new G(new dt(10,50,100,.2)),hcDark:new G(new dt(124,124,124,.3)),hcLight:new G(new dt(10,50,100,.2))},p("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop."));E("editor.snippetTabstopHighlightBorder",null,p("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop."));E("editor.snippetFinalTabstopHighlightBackground",null,p("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet."));E("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new G(new dt(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},p("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet."));const NE=new G(new dt(155,185,85,.2)),RE=new G(new dt(255,0,0,.2)),Boe=E("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},p("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),Woe=E("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},p("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);E("diffEditor.insertedLineBackground",{dark:NE,light:NE,hcDark:null,hcLight:null},p("diffEditorInsertedLines","Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0);E("diffEditor.removedLineBackground",{dark:RE,light:RE,hcDark:null,hcLight:null},p("diffEditorRemovedLines","Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);E("diffEditorGutter.insertedLineBackground",null,p("diffEditorInsertedLineGutter","Background color for the margin where lines got inserted."));E("diffEditorGutter.removedLineBackground",null,p("diffEditorRemovedLineGutter","Background color for the margin where lines got removed."));const Hoe=E("diffEditorOverview.insertedForeground",null,p("diffEditorOverviewInserted","Diff overview ruler foreground for inserted content.")),Voe=E("diffEditorOverview.removedForeground",null,p("diffEditorOverviewRemoved","Diff overview ruler foreground for removed content."));E("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},p("diffEditorInsertedOutline","Outline color for the text that got inserted."));E("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},p("diffEditorRemovedOutline","Outline color for text that got removed."));E("diffEditor.border",{dark:null,light:null,hcDark:lt,hcLight:lt},p("diffEditorBorder","Border color between the two text editors."));E("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},p("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views."));E("diffEditor.unchangedRegionBackground","sideBar.background",p("diffEditor.unchangedRegionBackground","The background color of unchanged blocks in the diff editor."));E("diffEditor.unchangedRegionForeground","foreground",p("diffEditor.unchangedRegionForeground","The foreground color of unchanged blocks in the diff editor."));E("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},p("diffEditor.unchangedCodeBackground","The background color of unchanged code in the diff editor."));const ym=E("widget.shadow",{dark:je(G.black,.36),light:je(G.black,.16),hcDark:null,hcLight:null},p("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),lz=E("widget.border",{dark:null,light:null,hcDark:lt,hcLight:lt},p("widgetBorder","Border color of widgets such as find/replace inside the editor.")),nB=E("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},p("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse"));E("toolbar.hoverOutline",{dark:null,light:null,hcDark:Xt,hcLight:Xt},p("toolbarHoverOutline","Toolbar outline when hovering over actions using the mouse"));E("toolbar.activeBackground",{dark:Ma(nB,.1),light:_g(nB,.1),hcDark:null,hcLight:null},p("toolbarActiveBackground","Toolbar background when holding the mouse over actions"));const zoe=E("breadcrumb.foreground",je(Ge,.8),p("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),Uoe=E("breadcrumb.background",ea,p("breadcrumbsBackground","Background color of breadcrumb items.")),sB=E("breadcrumb.focusForeground",{light:_g(Ge,.2),dark:Ma(Ge,.1),hcDark:Ma(Ge,.1),hcLight:Ma(Ge,.1)},p("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),$oe=E("breadcrumb.activeSelectionForeground",{light:_g(Ge,.2),dark:Ma(Ge,.1),hcDark:Ma(Ge,.1),hcLight:Ma(Ge,.1)},p("breadcrumbsSelectedForeground","Color of selected breadcrumb items."));E("breadcrumbPicker.background",Bo,p("breadcrumbsSelectedBackground","Background color of breadcrumb item picker."));const cz=.5,oB=G.fromHex("#40C8AE").transparent(cz),rB=G.fromHex("#40A6FF").transparent(cz),aB=G.fromHex("#606060").transparent(.4),D2=.4,Ip=1,ME=E("merge.currentHeaderBackground",{dark:oB,light:oB,hcDark:null,hcLight:null},p("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);E("merge.currentContentBackground",je(ME,D2),p("mergeCurrentContentBackground","Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const AE=E("merge.incomingHeaderBackground",{dark:rB,light:rB,hcDark:null,hcLight:null},p("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);E("merge.incomingContentBackground",je(AE,D2),p("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const PE=E("merge.commonHeaderBackground",{dark:aB,light:aB,hcDark:null,hcLight:null},p("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);E("merge.commonContentBackground",je(PE,D2),p("mergeCommonContentBackground","Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const Tp=E("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},p("mergeBorder","Border color on headers and the splitter in inline merge-conflicts."));E("editorOverviewRuler.currentContentForeground",{dark:je(ME,Ip),light:je(ME,Ip),hcDark:Tp,hcLight:Tp},p("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts."));E("editorOverviewRuler.incomingContentForeground",{dark:je(AE,Ip),light:je(AE,Ip),hcDark:Tp,hcLight:Tp},p("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts."));E("editorOverviewRuler.commonContentForeground",{dark:je(PE,Ip),light:je(PE,Ip),hcDark:Tp,hcLight:Tp},p("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts."));const uD=E("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:"#AB5A00"},p("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),dz=E("editorOverviewRuler.selectionHighlightForeground","#A0A0A0CC",p("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),joe=E("problemsErrorIcon.foreground",$L,p("problemsErrorIconForeground","The color used for the problems error icon.")),Zoe=E("problemsWarningIcon.foreground",Vc,p("problemsWarningIconForeground","The color used for the problems warning icon.")),Koe=E("problemsInfoIcon.foreground",El,p("problemsInfoIconForeground","The color used for the problems info icon.")),OE=E("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},p("minimapFindMatchHighlight","Minimap marker color for find matches."),!0),jL=E("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},p("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0),lB=E("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},p("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),qoe=E("minimap.infoHighlight",{dark:El,light:El,hcDark:sv,hcLight:sv},p("minimapInfo","Minimap marker color for infos.")),Goe=E("minimap.warningHighlight",{dark:Vc,light:Vc,hcDark:nv,hcLight:nv},p("overviewRuleWarning","Minimap marker color for warnings.")),Yoe=E("minimap.errorHighlight",{dark:new G(new dt(255,18,18,.7)),light:new G(new dt(255,18,18,.7)),hcDark:new G(new dt(255,50,50,1)),hcLight:"#B5200D"},p("minimapError","Minimap marker color for errors.")),Xoe=E("minimap.background",null,p("minimapBackground","Minimap background color.")),Qoe=E("minimap.foregroundOpacity",G.fromHex("#000f"),p("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.'));E("minimapSlider.background",je(nz,.5),p("minimapSliderBackground","Minimap slider background color."));E("minimapSlider.hoverBackground",je(sz,.5),p("minimapSliderHoverBackground","Minimap slider background color when hovering."));E("minimapSlider.activeBackground",je(oz,.5),p("minimapSliderActiveBackground","Minimap slider background color when clicked on."));E("charts.foreground",Ge,p("chartsForeground","The foreground color used in charts."));E("charts.lines",je(Ge,.5),p("chartsLines","The color used for horizontal lines in charts."));E("charts.red",$L,p("chartsRed","The red color used in chart visualizations."));E("charts.blue",El,p("chartsBlue","The blue color used in chart visualizations."));E("charts.yellow",Vc,p("chartsYellow","The yellow color used in chart visualizations."));E("charts.orange",OE,p("chartsOrange","The orange color used in chart visualizations."));E("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},p("chartsGreen","The green color used in chart visualizations."));E("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},p("chartsPurple","The purple color used in chart visualizations."));const FE=E("input.background",{dark:"#3C3C3C",light:G.white,hcDark:G.black,hcLight:G.white},p("inputBoxBackground","Input box background.")),hz=E("input.foreground",Ge,p("inputBoxForeground","Input box foreground.")),uz=E("input.border",{dark:null,light:null,hcDark:lt,hcLight:lt},p("inputBoxBorder","Input box border.")),ZL=E("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:lt,hcLight:lt},p("inputBoxActiveOptionBorder","Border color of activated options in input fields.")),Joe=E("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},p("inputOption.hoverBackground","Background color of activated options in input fields.")),kC=E("inputOption.activeBackground",{dark:je(Tl,.4),light:je(Tl,.2),hcDark:G.transparent,hcLight:G.transparent},p("inputOption.activeBackground","Background hover color of options in input fields.")),KL=E("inputOption.activeForeground",{dark:G.white,light:G.black,hcDark:Ge,hcLight:Ge},p("inputOption.activeForeground","Foreground color of activated options in input fields."));E("input.placeholderForeground",{light:je(Ge,.5),dark:je(Ge,.5),hcDark:je(Ge,.7),hcLight:je(Ge,.7)},p("inputPlaceholderForeground","Input box foreground color for placeholder text."));const ere=E("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:G.black,hcLight:G.white},p("inputValidationInfoBackground","Input validation background color for information severity.")),tre=E("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:Ge},p("inputValidationInfoForeground","Input validation foreground color for information severity.")),ire=E("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:lt,hcLight:lt},p("inputValidationInfoBorder","Input validation border color for information severity.")),nre=E("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:G.black,hcLight:G.white},p("inputValidationWarningBackground","Input validation background color for warning severity.")),sre=E("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:Ge},p("inputValidationWarningForeground","Input validation foreground color for warning severity.")),ore=E("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:lt,hcLight:lt},p("inputValidationWarningBorder","Input validation border color for warning severity.")),rre=E("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:G.black,hcLight:G.white},p("inputValidationErrorBackground","Input validation background color for error severity.")),are=E("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:Ge},p("inputValidationErrorForeground","Input validation foreground color for error severity.")),lre=E("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:lt,hcLight:lt},p("inputValidationErrorBorder","Input validation border color for error severity.")),qL=E("dropdown.background",{dark:"#3C3C3C",light:G.white,hcDark:G.black,hcLight:G.white},p("dropdownBackground","Dropdown background.")),cre=E("dropdown.listBackground",{dark:null,light:null,hcDark:G.black,hcLight:G.white},p("dropdownListBackground","Dropdown list background.")),I2=E("dropdown.foreground",{dark:"#F0F0F0",light:Ge,hcDark:G.white,hcLight:Ge},p("dropdownForeground","Dropdown foreground.")),T2=E("dropdown.border",{dark:qL,light:"#CECECE",hcDark:lt,hcLight:lt},p("dropdownBorder","Dropdown border.")),gz=E("button.foreground",G.white,p("buttonForeground","Button foreground color.")),dre=E("button.separator",je(gz,.4),p("buttonSeparator","Button separator color.")),S_=E("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:null,hcLight:"#0F4A85"},p("buttonBackground","Button background color.")),hre=E("button.hoverBackground",{dark:Ma(S_,.2),light:_g(S_,.2),hcDark:S_,hcLight:S_},p("buttonHoverBackground","Button background color when hovering.")),ure=E("button.border",lt,p("buttonBorder","Button border color.")),gre=E("button.secondaryForeground",{dark:G.white,light:G.white,hcDark:G.white,hcLight:Ge},p("buttonSecondaryForeground","Secondary button foreground color.")),BE=E("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:G.white},p("buttonSecondaryBackground","Secondary button background color.")),fre=E("button.secondaryHoverBackground",{dark:Ma(BE,.2),light:_g(BE,.2),hcDark:null,hcLight:null},p("buttonSecondaryHoverBackground","Secondary button background color when hovering.")),L_=E("radio.activeForeground",KL,p("radioActiveForeground","Foreground color of active radio option.")),pre=E("radio.activeBackground",kC,p("radioBackground","Background color of active radio option.")),mre=E("radio.activeBorder",ZL,p("radioActiveBorder","Border color of the active radio option.")),_re=E("radio.inactiveForeground",null,p("radioInactiveForeground","Foreground color of inactive radio option.")),bre=E("radio.inactiveBackground",null,p("radioInactiveBackground","Background color of inactive radio option.")),vre=E("radio.inactiveBorder",{light:je(L_,.2),dark:je(L_,.2),hcDark:je(L_,.4),hcLight:je(L_,.2)},p("radioInactiveBorder","Border color of the inactive radio option.")),Cre=E("radio.inactiveHoverBackground",Joe,p("radioHoverBackground","Background color of inactive active radio option when hovering.")),yre=E("checkbox.background",qL,p("checkbox.background","Background color of checkbox widget."));E("checkbox.selectBackground",Bo,p("checkbox.select.background","Background color of checkbox widget when the element it's in is selected."));const wre=E("checkbox.foreground",I2,p("checkbox.foreground","Foreground color of checkbox widget.")),Sre=E("checkbox.border",T2,p("checkbox.border","Border color of checkbox widget."));E("checkbox.selectBorder",r0,p("checkbox.select.border","Border color of checkbox widget when the element it's in is selected."));const Lre=E("keybindingLabel.background",{dark:new G(new dt(128,128,128,.17)),light:new G(new dt(221,221,221,.4)),hcDark:G.transparent,hcLight:G.transparent},p("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),xre=E("keybindingLabel.foreground",{dark:G.fromHex("#CCCCCC"),light:G.fromHex("#555555"),hcDark:G.white,hcLight:Ge},p("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),kre=E("keybindingLabel.border",{dark:new G(new dt(51,51,51,.6)),light:new G(new dt(204,204,204,.4)),hcDark:new G(new dt(111,195,223)),hcLight:lt},p("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),Dre=E("keybindingLabel.bottomBorder",{dark:new G(new dt(68,68,68,.6)),light:new G(new dt(187,187,187,.4)),hcDark:new G(new dt(111,195,223)),hcLight:Ge},p("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut.")),Ire=E("list.focusBackground",null,p("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Tre=E("list.focusForeground",null,p("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Ere=E("list.focusOutline",{dark:Tl,light:Tl,hcDark:Xt,hcLight:Xt},p("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Nre=E("list.focusAndSelectionOutline",null,p("listFocusAndSelectionOutline","List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),qu=E("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:G.fromHex("#0F4A85").transparent(.1)},p("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),ov=E("list.activeSelectionForeground",{dark:G.white,light:G.white,hcDark:null,hcLight:null},p("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),fz=E("list.activeSelectionIconForeground",null,p("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Rre=E("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:G.fromHex("#0F4A85").transparent(.1)},p("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),Mre=E("list.inactiveSelectionForeground",null,p("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),Are=E("list.inactiveSelectionIconForeground",null,p("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),Pre=E("list.inactiveFocusBackground",null,p("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),Ore=E("list.inactiveFocusOutline",null,p("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),pz=E("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:G.white.transparent(.1),hcLight:G.fromHex("#0F4A85").transparent(.1)},p("listHoverBackground","List/Tree background when hovering over items using the mouse.")),mz=E("list.hoverForeground",null,p("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),Fre=E("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},p("listDropBackground","List/Tree drag and drop background when moving items over other items when using the mouse.")),Bre=E("list.dropBetweenBackground",{dark:r0,light:r0,hcDark:null,hcLight:null},p("listDropBetweenBackground","List/Tree drag and drop border color when moving items between items when using the mouse.")),Lf=E("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:Tl,hcLight:Tl},p("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree.")),Wre=E("list.focusHighlightForeground",{dark:Lf,light:yoe(qu,Lf,"#BBE7FF"),hcDark:Lf,hcLight:Lf},p("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree."));E("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},p("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer."));E("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},p("listErrorForeground","Foreground color of list items containing errors."));E("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},p("listWarningForeground","Foreground color of list items containing warnings."));const Hre=E("listFilterWidget.background",{light:_g(Bo,0),dark:Ma(Bo,0),hcDark:Bo,hcLight:Bo},p("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),Vre=E("listFilterWidget.outline",{dark:G.transparent,light:G.transparent,hcDark:"#f38518",hcLight:"#007ACC"},p("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),zre=E("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:lt,hcLight:lt},p("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches.")),Ure=E("listFilterWidget.shadow",ym,p("listFilterWidgetShadow","Shadow color of the type filter widget in lists and trees."));E("list.filterMatchBackground",{dark:wc,light:wc,hcDark:null,hcLight:null},p("listFilterMatchHighlight","Background color of the filtered match."));E("list.filterMatchBorder",{dark:Rd,light:Rd,hcDark:lt,hcLight:Xt},p("listFilterMatchHighlightBorder","Border color of the filtered match."));E("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},p("listDeemphasizedForeground","List/Tree foreground color for items that are deemphasized."));const _z=E("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},p("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),$re=E("tree.inactiveIndentGuidesStroke",je(_z,.4),p("treeInactiveIndentGuidesStroke","Tree stroke color for the indentation guides that are not active.")),jre=E("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},p("tableColumnsBorder","Table border color between columns.")),Zre=E("tree.tableOddRowsBackground",{dark:je(Ge,.04),light:je(Ge,.04),hcDark:null,hcLight:null},p("tableOddRowsBackgroundColor","Background color for odd table rows."));E("editorActionList.background",Bo,p("editorActionListBackground","Action List background color."));E("editorActionList.foreground",UL,p("editorActionListForeground","Action List foreground color."));E("editorActionList.focusForeground",ov,p("editorActionListFocusForeground","Action List foreground color for the focused item."));E("editorActionList.focusBackground",qu,p("editorActionListFocusBackground","Action List background color for the focused item."));const Kre=E("menu.border",{dark:null,light:null,hcDark:lt,hcLight:lt},p("menuBorder","Border color of menus.")),qre=E("menu.foreground",I2,p("menuForeground","Foreground color of menu items.")),Gre=E("menu.background",qL,p("menuBackground","Background color of menu items.")),Yre=E("menu.selectionForeground",ov,p("menuSelectionForeground","Foreground color of the selected menu item in menus.")),Xre=E("menu.selectionBackground",qu,p("menuSelectionBackground","Background color of the selected menu item in menus.")),Qre=E("menu.selectionBorder",{dark:null,light:null,hcDark:Xt,hcLight:Xt},p("menuSelectionBorder","Border color of the selected menu item in menus.")),Jre=E("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:lt,hcLight:lt},p("menuSeparatorBackground","Color of a separator menu item in menus.")),cB=E("quickInput.background",Bo,p("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),eae=E("quickInput.foreground",UL,p("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),tae=E("quickInputTitle.background",{dark:new G(new dt(255,255,255,.105)),light:new G(new dt(0,0,0,.06)),hcDark:"#000000",hcLight:G.white},p("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),bz=E("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:G.white,hcLight:"#0F4A85"},p("pickerGroupForeground","Quick picker color for grouping labels.")),iae=E("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:G.white,hcLight:"#0F4A85"},p("pickerGroupBorder","Quick picker color for grouping borders.")),dB=E("quickInput.list.focusBackground",null,"",void 0,p("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),rv=E("quickInputList.focusForeground",ov,p("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),E2=E("quickInputList.focusIconForeground",fz,p("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),av=E("quickInputList.focusBackground",{dark:iv(dB,qu),light:iv(dB,qu),hcDark:null,hcLight:null},p("quickInput.listFocusBackground","Quick picker background color for the focused item."));E("search.resultsInfoForeground",{light:Ge,dark:je(Ge,.65),hcDark:Ge,hcLight:Ge},p("search.resultsInfoForeground","Color of the text in the search viewlet's completion message."));E("searchEditor.findMatchBackground",{light:je(wc,.66),dark:je(wc,.66),hcDark:wc,hcLight:wc},p("searchEditor.queryMatch","Color of the Search Editor query matches."));E("searchEditor.findMatchBorder",{light:je(Rd,.66),dark:je(Rd,.66),hcDark:Rd,hcLight:Rd},p("searchEditor.editorFindMatchBorder","Border color of the Search Editor query matches."));var nae=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},hB=function(s,e){return function(t,i){e(t,i,s)}};const Vl=Je("hoverService");let Ep=class extends B{get delay(){return this.isInstantlyHovering()?0:this._delay}constructor(e,t,i={},n,o){super(),this.placement=e,this.instantHover=t,this.overrideOptions=i,this.configurationService=n,this.hoverService=o,this.lastHoverHideTime=0,this.timeLimit=200,this.hoverDisposables=this._register(new Z),this._delay=this.configurationService.getValue("workbench.hover.delay"),this._register(this.configurationService.onDidChangeConfiguration(r=>{r.affectsConfiguration("workbench.hover.delay")&&(this._delay=this.configurationService.getValue("workbench.hover.delay"))}))}showHover(e,t){const i=typeof this.overrideOptions=="function"?this.overrideOptions(e,t):this.overrideOptions;this.hoverDisposables.clear();const n=tn(e.target)?[e.target]:e.target.targetElements;for(const r of n)this.hoverDisposables.add(gi(r,"keydown",a=>{a.equals(9)&&this.hoverService.hideHover()}));const o=tn(e.content)?void 0:e.content.toString();return this.hoverService.showHover({...e,...i,persistence:{hideOnKeyDown:!0,...i.persistence},id:o,appearance:{...e.appearance,compact:!0,skipFadeInAnimation:this.isInstantlyHovering(),...i.appearance}},t)}isInstantlyHovering(){return this.instantHover&&Date.now()-this.lastHoverHideTime<this.timeLimit}onDidHideHover(){this.hoverDisposables.clear(),this.instantHover&&(this.lastHoverHideTime=Date.now())}};Ep=nae([hB(3,Ke),hB(4,Vl)],Ep);const Yc=Je("contextViewService"),bo=Je("contextMenuService"),yt=Je("keybindingService");class wm{constructor(){this._hooks=new Z,this._pointerMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;const i=this._onStopCallback;this._onStopCallback=null,e&&i&&i(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,i,n,o){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=n,this._onStopCallback=o;let r=e;try{e.setPointerCapture(t),this._hooks.add(Ce(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{r=ke(e)}this._hooks.add(U(r,ee.POINTER_MOVE,a=>{if(a.buttons!==i){this.stopMonitoring(!0);return}a.preventDefault(),this._pointerMoveCallback(a)})),this._hooks.add(U(r,ee.POINTER_UP,a=>this.stopMonitoring(!0)))}}function Ti(s,e,t){let i=null,n=null;if(typeof t.value=="function"?(i="value",n=t.value,n.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof t.get=="function"&&(i="get",n=t.get),!n)throw new Error("not supported");const o=`$memoize$${e}`;t[i]=function(...r){return this.hasOwnProperty(o)||Object.defineProperty(this,o,{configurable:!1,enumerable:!1,writable:!1,value:n.apply(this,r)}),this[o]}}var sae=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Wt;(function(s){s.Tap="-monaco-gesturetap",s.Change="-monaco-gesturechange",s.Start="-monaco-gesturestart",s.End="-monaco-gesturesend",s.Contextmenu="-monaco-gesturecontextmenu"})(Wt||(Wt={}));class ti extends B{static{this.SCROLL_FRICTION=-.005}static{this.HOLD_DELAY=700}static{this.CLEAR_TAP_COUNT_TIME=400}constructor(){super(),this.dispatched=!1,this.targets=new fs,this.ignoreTargets=new fs,this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(se.runAndSubscribe(wL,({window:e,disposables:t})=>{t.add(U(e.document,"touchstart",i=>this.onTouchStart(i),{passive:!1})),t.add(U(e.document,"touchend",i=>this.onTouchEnd(e,i))),t.add(U(e.document,"touchmove",i=>this.onTouchMove(i),{passive:!1}))},{window:Nt,disposables:this._store}))}static addTarget(e){if(!ti.isTouchDevice())return B.None;ti.INSTANCE||(ti.INSTANCE=new ti);const t=ti.INSTANCE.targets.push(e);return Ce(t)}static ignoreTarget(e){if(!ti.isTouchDevice())return B.None;ti.INSTANCE||(ti.INSTANCE=new ti);const t=ti.INSTANCE.ignoreTargets.push(e);return Ce(t)}static isTouchDevice(){return"ontouchstart"in Nt||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){const t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let i=0,n=e.targetTouches.length;i<n;i++){const o=e.targetTouches.item(i);this.activeTouches[o.identifier]={id:o.identifier,initialTarget:o.target,initialTimeStamp:t,initialPageX:o.pageX,initialPageY:o.pageY,rollingTimestamps:[t],rollingPageX:[o.pageX],rollingPageY:[o.pageY]};const r=this.newGestureEvent(Wt.Start,o.target);r.pageX=o.pageX,r.pageY=o.pageY,this.dispatchEvent(r)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e,t){const i=Date.now(),n=Object.keys(this.activeTouches).length;for(let o=0,r=t.changedTouches.length;o<r;o++){const a=t.changedTouches.item(o);if(!this.activeTouches.hasOwnProperty(String(a.identifier))){console.warn("move of an UNKNOWN touch",a);continue}const l=this.activeTouches[a.identifier],c=Date.now()-l.initialTimeStamp;if(c<ti.HOLD_DELAY&&Math.abs(l.initialPageX-tr(l.rollingPageX))<30&&Math.abs(l.initialPageY-tr(l.rollingPageY))<30){const d=this.newGestureEvent(Wt.Tap,l.initialTarget);d.pageX=tr(l.rollingPageX),d.pageY=tr(l.rollingPageY),this.dispatchEvent(d)}else if(c>=ti.HOLD_DELAY&&Math.abs(l.initialPageX-tr(l.rollingPageX))<30&&Math.abs(l.initialPageY-tr(l.rollingPageY))<30){const d=this.newGestureEvent(Wt.Contextmenu,l.initialTarget);d.pageX=tr(l.rollingPageX),d.pageY=tr(l.rollingPageY),this.dispatchEvent(d)}else if(n===1){const d=tr(l.rollingPageX),h=tr(l.rollingPageY),u=tr(l.rollingTimestamps)-l.rollingTimestamps[0],g=d-l.rollingPageX[0],f=h-l.rollingPageY[0],m=[...this.targets].filter(_=>l.initialTarget instanceof Node&&_.contains(l.initialTarget));this.inertia(e,m,i,Math.abs(g)/u,g>0?1:-1,d,Math.abs(f)/u,f>0?1:-1,h)}this.dispatchEvent(this.newGestureEvent(Wt.End,l.initialTarget)),delete this.activeTouches[a.identifier]}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){const i=document.createEvent("CustomEvent");return i.initEvent(e,!1,!0),i.initialTarget=t,i.tapCount=0,i}dispatchEvent(e){if(e.type===Wt.Tap){const t=new Date().getTime();let i=0;t-this._lastSetTapCountTime>ti.CLEAR_TAP_COUNT_TIME?i=1:i=2,this._lastSetTapCountTime=t,e.tapCount=i}else(e.type===Wt.Change||e.type===Wt.Contextmenu)&&(this._lastSetTapCountTime=0);if(e.initialTarget instanceof Node){for(const i of this.ignoreTargets)if(i.contains(e.initialTarget))return;const t=[];for(const i of this.targets)if(i.contains(e.initialTarget)){let n=0,o=e.initialTarget;for(;o&&o!==i;)n++,o=o.parentElement;t.push([n,i])}t.sort((i,n)=>i[0]-n[0]);for(const[i,n]of t)n.dispatchEvent(e),this.dispatched=!0}}inertia(e,t,i,n,o,r,a,l,c){this.handle=mo(e,()=>{const d=Date.now(),h=d-i;let u=0,g=0,f=!0;n+=ti.SCROLL_FRICTION*h,a+=ti.SCROLL_FRICTION*h,n>0&&(f=!1,u=o*n*h),a>0&&(f=!1,g=l*a*h);const m=this.newGestureEvent(Wt.Change);m.translationX=u,m.translationY=g,t.forEach(_=>_.dispatchEvent(m)),f||this.inertia(e,t,d,n,o,r+u,a,l,c+g)})}onTouchMove(e){const t=Date.now();for(let i=0,n=e.changedTouches.length;i<n;i++){const o=e.changedTouches.item(i);if(!this.activeTouches.hasOwnProperty(String(o.identifier))){console.warn("end of an UNKNOWN touch",o);continue}const r=this.activeTouches[o.identifier],a=this.newGestureEvent(Wt.Change,r.initialTarget);a.translationX=o.pageX-tr(r.rollingPageX),a.translationY=o.pageY-tr(r.rollingPageY),a.pageX=o.pageX,a.pageY=o.pageY,this.dispatchEvent(a),r.rollingPageX.length>3&&(r.rollingPageX.shift(),r.rollingPageY.shift(),r.rollingTimestamps.shift()),r.rollingPageX.push(o.pageX),r.rollingPageY.push(o.pageY),r.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}}sae([Ti],ti,"isTouchDevice",null);let Yo=class extends B{onclick(e,t){this._register(U(e,ee.CLICK,i=>t(new jr(ke(e),i))))}onmousedown(e,t){this._register(U(e,ee.MOUSE_DOWN,i=>t(new jr(ke(e),i))))}onmouseover(e,t){this._register(U(e,ee.MOUSE_OVER,i=>t(new jr(ke(e),i))))}onmouseleave(e,t){this._register(U(e,ee.MOUSE_LEAVE,i=>t(new jr(ke(e),i))))}onkeydown(e,t){this._register(U(e,ee.KEY_DOWN,i=>t(new Ft(i))))}onkeyup(e,t){this._register(U(e,ee.KEY_UP,i=>t(new Ft(i))))}oninput(e,t){this._register(U(e,ee.INPUT,t))}onblur(e,t){this._register(U(e,ee.BLUR,t))}onfocus(e,t){this._register(U(e,ee.FOCUS,t))}ignoreGesture(e){return ti.ignoreTarget(e)}};const Np=11;class oae extends Yo{constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...Ie.asClassNameArray(e.icon)),this.domNode.style.position="absolute",this.domNode.style.width=Np+"px",this.domNode.style.height=Np+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new wm),this._register(gi(this.bgDomNode,ee.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(gi(this.domNode,ee.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new XP),this._pointerdownScheduleRepeatTimer=this._register(new ia)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,ke(e))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,i=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}}class rae extends B{constructor(e,t,i){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=i,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new ia)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){const e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(e){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(e?" fade":"")))}}const aae=140;class vz extends Yo{constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new rae(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new wm),this._shouldRender=!0,this.domNode=Ct(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(U(this.domNode.domNode,ee.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){const t=this._register(new oae(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,i,n){this.slider=Ct(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof i=="number"&&this.slider.setWidth(i),typeof n=="number"&&this.slider.setHeight(n),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(U(this.slider.domNode,ee.POINTER_DOWN,o=>{o.button===0&&(o.preventDefault(),this._sliderPointerDown(o))})),this.onclick(this.slider.domNode,o=>{o.leftButton&&o.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){const t=this.domNode.domNode.getClientRects()[0].top,i=t+this._scrollbarState.getSliderPosition(),n=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),o=this._sliderPointerPosition(e);i<=o&&o<=n?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,i;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,i=e.offsetY;else{const o=Si(this.domNode.domNode);t=e.pageX-o.left,i=e.pageY-o.top}const n=this._pointerDownRelativePosition(t,i);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(n):this._scrollbarState.getDesiredScrollPositionFromOffset(n)),e.button===0&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=this._sliderPointerPosition(e),i=this._sliderOrthogonalPointerPosition(e),n=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,o=>{const r=this._sliderOrthogonalPointerPosition(o),a=Math.abs(r-i);if(An&&a>aae){this._setDesiredScrollPositionNow(n.getScrollPosition());return}const c=this._sliderPointerPosition(o)-t;this._setDesiredScrollPositionNow(n.getDesiredScrollPositionFromDelta(c))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){const t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}}const lae=20;class Rp{constructor(e,t,i,n,o,r){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(i),this._arrowSize=Math.round(e),this._visibleSize=n,this._scrollSize=o,this._scrollPosition=r,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new Rp(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){const t=Math.round(e);return this._visibleSize!==t?(this._visibleSize=t,this._refreshComputedValues(),!0):!1}setScrollSize(e){const t=Math.round(e);return this._scrollSize!==t?(this._scrollSize=t,this._refreshComputedValues(),!0):!1}setScrollPosition(e){const t=Math.round(e);return this._scrollPosition!==t?(this._scrollPosition=t,this._refreshComputedValues(),!0):!1}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,i,n,o){const r=Math.max(0,i-e),a=Math.max(0,r-2*t),l=n>0&&n>i;if(!l)return{computedAvailableSize:Math.round(r),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};const c=Math.round(Math.max(lae,Math.floor(i*a/n))),d=(a-c)/(n-i),h=o*d;return{computedAvailableSize:Math.round(r),computedIsNeeded:l,computedSliderSize:Math.round(c),computedSliderRatio:d,computedSliderPosition:Math.round(h)}}_refreshComputedValues(){const e=Rp._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize;let i=this._scrollPosition;return t<this._computedSliderPosition?i-=this._visibleSize:i+=this._visibleSize,i}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;const t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}}class cae extends vz{constructor(e,t,i){const n=e.getScrollDimensions(),o=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new Rp(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,n.width,n.scrollWidth,o.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){const r=(t.arrowSize-Np)/2,a=(t.horizontalScrollbarSize-Np)/2;this._createArrow({className:"scra",icon:J.scrollbarButtonLeft,top:a,left:r,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new $u(null,1,0))}),this._createArrow({className:"scra",icon:J.scrollbarButtonRight,top:a,left:void 0,bottom:void 0,right:r,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new $u(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}}class dae extends vz{constructor(e,t,i){const n=e.getScrollDimensions(),o=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new Rp(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,n.height,n.scrollHeight,o.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){const r=(t.arrowSize-Np)/2,a=(t.verticalScrollbarSize-Np)/2;this._createArrow({className:"scra",icon:J.scrollbarButtonUp,top:r,left:a,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new $u(null,0,1))}),this._createArrow({className:"scra",icon:J.scrollbarButtonDown,top:void 0,left:a,bottom:r,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new $u(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}}class l0{constructor(e,t,i,n,o,r,a){this._forceIntegerValues=e,this._scrollStateBrand=void 0,this._forceIntegerValues&&(t=t|0,i=i|0,n=n|0,o=o|0,r=r|0,a=a|0),this.rawScrollLeft=n,this.rawScrollTop=a,t<0&&(t=0),n+t>i&&(n=i-t),n<0&&(n=0),o<0&&(o=0),a+o>r&&(a=r-o),a<0&&(a=0),this.width=t,this.scrollWidth=i,this.scrollLeft=n,this.height=o,this.scrollHeight=r,this.scrollTop=a}equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new l0(this._forceIntegerValues,typeof e.width<"u"?e.width:this.width,typeof e.scrollWidth<"u"?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,typeof e.height<"u"?e.height:this.height,typeof e.scrollHeight<"u"?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new l0(this._forceIntegerValues,this.width,this.scrollWidth,typeof e.scrollLeft<"u"?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof e.scrollTop<"u"?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){const i=this.width!==e.width,n=this.scrollWidth!==e.scrollWidth,o=this.scrollLeft!==e.scrollLeft,r=this.height!==e.height,a=this.scrollHeight!==e.scrollHeight,l=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:i,scrollWidthChanged:n,scrollLeftChanged:o,heightChanged:r,scrollHeightChanged:a,scrollTopChanged:l}}}class Sm extends B{constructor(e){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new O),this.onScroll=this._onScroll.event,this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new l0(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){const i=this._state.withScrollDimensions(e,t);this._setState(i,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){const t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};const i=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===i.scrollLeft&&this._smoothScrolling.to.scrollTop===i.scrollTop)return;let n;t?n=new lv(this._smoothScrolling.from,i,this._smoothScrolling.startTime,this._smoothScrolling.duration):n=this._smoothScrolling.combine(this._state,i,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=n}else{const i=this._state.withScrollPosition(e);this._smoothScrolling=lv.start(this._state,i,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;const e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){const i=this._state;i.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(i,t)))}}class uB{constructor(e,t,i){this.scrollLeft=e,this.scrollTop=t,this.isDone=i}}function gD(s,e){const t=e-s;return function(i){return s+t*gae(i)}}function hae(s,e,t){return function(i){return i<t?s(i/t):e((i-t)/(1-t))}}class lv{constructor(e,t,i,n){this.from=e,this.to=t,this.duration=n,this.startTime=i,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,i){if(Math.abs(e-t)>2.5*i){let o,r;return e<t?(o=e+.75*i,r=t-.75*i):(o=e-.75*i,r=t+.75*i),hae(gD(e,o),gD(r,t),.33)}return gD(e,t)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){const t=(e-this.startTime)/this.duration;if(t<1){const i=this.scrollLeft(t),n=this.scrollTop(t);return new uB(i,n,!1)}return new uB(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,i){return lv.start(e,t,i)}static start(e,t,i){i=i+10;const n=Date.now()-10;return new lv(e,t,n,i)}}function uae(s){return Math.pow(s,3)}function gae(s){return 1-uae(1-s)}const fae=500,gB=50;class pae{constructor(e,t,i){this.timestamp=e,this.deltaX=t,this.deltaY=i,this.score=0}}class GL{static{this.INSTANCE=new GL}constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let e=1,t=0,i=1,n=this._rear;do{const o=n===this._front?e:Math.pow(2,-i);if(e-=o,t+=this._memory[n].score*o,n===this._front)break;n=(this._capacity+n-1)%this._capacity,i++}while(!0);return t<=.5}acceptStandardWheelEvent(e){if(CC){const t=ke(e.browserEvent),i=Nee(t);this.accept(Date.now(),e.deltaX*i,e.deltaY*i)}else this.accept(Date.now(),e.deltaX,e.deltaY)}accept(e,t,i){let n=null;const o=new pae(e,t,i);this._front===-1&&this._rear===-1?(this._memory[0]=o,this._front=0,this._rear=0):(n=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=o),o.score=this._computeScore(o,n)}_computeScore(e,t){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let i=.5;if((!this._isAlmostInt(e.deltaX)||!this._isAlmostInt(e.deltaY))&&(i+=.25),t){const n=Math.abs(e.deltaX),o=Math.abs(e.deltaY),r=Math.abs(t.deltaX),a=Math.abs(t.deltaY),l=Math.max(Math.min(n,r),1),c=Math.max(Math.min(o,a),1),d=Math.max(n,r),h=Math.max(o,a);d%l===0&&h%c===0&&(i-=.5)}return Math.min(Math.max(i,0),1)}_isAlmostInt(e){return Math.abs(Math.round(e)-e)<.01}}class N2 extends Yo{get options(){return this._options}constructor(e,t,i){super(),this._onScroll=this._register(new O),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new O),e.style.overflow="hidden",this._options=mae(t),this._scrollable=i,this._register(this._scrollable.onScroll(o=>{this._onWillScroll.fire(o),this._onDidScroll(o),this._onScroll.fire(o)}));const n={onMouseWheel:o=>this._onMouseWheel(o),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new dae(this._scrollable,this._options,n)),this._horizontalScrollbar=this._register(new cae(this._scrollable,this._options,n)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=Ct(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=Ct(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=Ct(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,o=>this._onMouseOver(o)),this.onmouseleave(this._listenOnDomNode,o=>this._onMouseLeave(o)),this._hideTimeout=this._register(new ia),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=At(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,Qe&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new $u(e))}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=At(this._mouseWheelToDispose),e)){const i=n=>{this._onMouseWheel(new $u(n))};this._mouseWheelToDispose.push(U(this._listenOnDomNode,ee.MOUSE_WHEEL,i,{passive:!1}))}}_onMouseWheel(e){if(e.browserEvent?.defaultPrevented)return;const t=GL.INSTANCE;t.acceptStandardWheelEvent(e);let i=!1;if(e.deltaY||e.deltaX){let o=e.deltaY*this._options.mouseWheelScrollSensitivity,r=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&r+o===0?r=o=0:Math.abs(o)>=Math.abs(r)?r=0:o=0),this._options.flipAxes&&([o,r]=[r,o]);const a=!Qe&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||a)&&!r&&(r=o,o=0),e.browserEvent&&e.browserEvent.altKey&&(r=r*this._options.fastScrollSensitivity,o=o*this._options.fastScrollSensitivity);const l=this._scrollable.getFutureScrollPosition();let c={};if(o){const d=gB*o,h=l.scrollTop-(d<0?Math.floor(d):Math.ceil(d));this._verticalScrollbar.writeScrollPosition(c,h)}if(r){const d=gB*r,h=l.scrollLeft-(d<0?Math.floor(d):Math.ceil(d));this._horizontalScrollbar.writeScrollPosition(c,h)}c=this._scrollable.validateScrollPosition(c),(l.scrollLeft!==c.scrollLeft||l.scrollTop!==c.scrollTop)&&(this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(c):this._scrollable.setScrollPositionNow(c),i=!0)}let n=i;!n&&this._options.alwaysConsumeMouseWheel&&(n=!0),!n&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(n=!0),n&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){const e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,i=e.scrollLeft>0,n=i?" left":"",o=t?" top":"",r=i||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${n}`),this._topShadowDomNode.setClassName(`shadow${o}`),this._topLeftShadowDomNode.setClassName(`shadow${r}${o}${n}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),fae)}}class Cz extends N2{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;const i=new Sm({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:n=>mo(ke(e),n)});super(e,t,i),this._register(i)}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}}class YL extends N2{constructor(e,t,i){super(e,t,i)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}}class DC extends N2{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;const i=new Sm({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:n=>mo(ke(e),n)});super(e,t,i),this._register(i),this._element=e,this._register(this.onScroll(n=>{n.scrollTopChanged&&(this._element.scrollTop=n.scrollTop),n.scrollLeftChanged&&(this._element.scrollLeft=n.scrollLeft)})),this.scanDomNode()}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}}function mae(s){const e={lazyRender:typeof s.lazyRender<"u"?s.lazyRender:!1,className:typeof s.className<"u"?s.className:"",useShadows:typeof s.useShadows<"u"?s.useShadows:!0,handleMouseWheel:typeof s.handleMouseWheel<"u"?s.handleMouseWheel:!0,flipAxes:typeof s.flipAxes<"u"?s.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof s.consumeMouseWheelIfScrollbarIsNeeded<"u"?s.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof s.alwaysConsumeMouseWheel<"u"?s.alwaysConsumeMouseWheel:!1,scrollYToX:typeof s.scrollYToX<"u"?s.scrollYToX:!1,mouseWheelScrollSensitivity:typeof s.mouseWheelScrollSensitivity<"u"?s.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof s.fastScrollSensitivity<"u"?s.fastScrollSensitivity:5,scrollPredominantAxis:typeof s.scrollPredominantAxis<"u"?s.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof s.mouseWheelSmoothScroll<"u"?s.mouseWheelSmoothScroll:!0,arrowSize:typeof s.arrowSize<"u"?s.arrowSize:11,listenOnDomNode:typeof s.listenOnDomNode<"u"?s.listenOnDomNode:null,horizontal:typeof s.horizontal<"u"?s.horizontal:1,horizontalScrollbarSize:typeof s.horizontalScrollbarSize<"u"?s.horizontalScrollbarSize:10,horizontalSliderSize:typeof s.horizontalSliderSize<"u"?s.horizontalSliderSize:0,horizontalHasArrows:typeof s.horizontalHasArrows<"u"?s.horizontalHasArrows:!1,vertical:typeof s.vertical<"u"?s.vertical:1,verticalScrollbarSize:typeof s.verticalScrollbarSize<"u"?s.verticalScrollbarSize:10,verticalHasArrows:typeof s.verticalHasArrows<"u"?s.verticalHasArrows:!1,verticalSliderSize:typeof s.verticalSliderSize<"u"?s.verticalSliderSize:0,scrollByPage:typeof s.scrollByPage<"u"?s.scrollByPage:!1};return e.horizontalSliderSize=typeof s.horizontalSliderSize<"u"?s.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=typeof s.verticalSliderSize<"u"?s.verticalSliderSize:e.verticalScrollbarSize,Qe&&(e.className+=" mac"),e}const Dy=te;let R2=class extends B{constructor(){super(),this.containerDomNode=document.createElement("div"),this.containerDomNode.className="monaco-hover",this.containerDomNode.tabIndex=0,this.containerDomNode.setAttribute("role","tooltip"),this.contentsDomNode=document.createElement("div"),this.contentsDomNode.className="monaco-hover-content",this.scrollbar=this._register(new DC(this.contentsDomNode,{consumeMouseWheelIfScrollbarIsNeeded:!0})),this.containerDomNode.appendChild(this.scrollbar.getDomNode())}onContentsChanged(){this.scrollbar.scanDomNode()}};class XL extends B{static render(e,t,i){return new XL(e,t,i)}constructor(e,t,i){super(),this.actionLabel=t.label,this.actionKeybindingLabel=i,this.actionContainer=X(e,Dy("div.action-container")),this.actionContainer.setAttribute("tabindex","0"),this.action=X(this.actionContainer,Dy("a.action")),this.action.setAttribute("role","button"),t.iconClass&&X(this.action,Dy(`span.icon.${t.iconClass}`));const n=X(this.action,Dy("span"));n.textContent=i?`${t.label} (${i})`:t.label,this._store.add(new wz(this.actionContainer,t.run)),this._store.add(new Sz(this.actionContainer,t.run,[3,10])),this.setEnabled(!0)}setEnabled(e){e?(this.actionContainer.classList.remove("disabled"),this.actionContainer.removeAttribute("aria-disabled")):(this.actionContainer.classList.add("disabled"),this.actionContainer.setAttribute("aria-disabled","true"))}}function yz(s,e){return s&&e?p("acessibleViewHint","Inspect this in the accessible view with {0}.",e):s?p("acessibleViewHintNoKbOpen","Inspect this in the accessible view via the command Open Accessible View which is currently not triggerable via keybinding."):""}class wz extends B{constructor(e,t){super(),this._register(U(e,ee.CLICK,i=>{i.stopPropagation(),i.preventDefault(),t(e)}))}}class Sz extends B{constructor(e,t,i){super(),this._register(U(e,ee.KEY_DOWN,n=>{const o=new Ft(n);i.some(r=>o.equals(r))&&(n.stopPropagation(),n.preventDefault(),t(e))}))}}const Ys=Je("openerService");function _ae(s){let e;const t=/^L?(\d+)(?:,(\d+))?(-L?(\d+)(?:,(\d+))?)?/.exec(s.fragment);return t&&(e={startLineNumber:parseInt(t[1]),startColumn:t[2]?parseInt(t[2]):1,endLineNumber:t[4]?parseInt(t[4]):void 0,endColumn:t[4]?t[5]?parseInt(t[5]):1:void 0},s=s.with({fragment:""})),{selection:e,uri:s}}class tt{get event(){return this.emitter.event}constructor(e,t,i){const n=o=>this.emitter.fire(o);this.emitter=new O({onWillAddFirstListener:()=>e.addEventListener(t,n,i),onDidRemoveLastListener:()=>e.removeEventListener(t,n,i)})}dispose(){this.emitter.dispose()}}function bae(s,e={}){const t=M2(e);return t.textContent=s,t}function vae(s,e={}){const t=M2(e);return Lz(t,yae(s,!!e.renderCodeSegments),e.actionHandler,e.renderCodeSegments),t}function M2(s){const e=s.inline?"span":"div",t=document.createElement(e);return s.className&&(t.className=s.className),t}class Cae{constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){const e=this.peek();return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}}function Lz(s,e,t,i){let n;if(e.type===2)n=document.createTextNode(e.content||"");else if(e.type===3)n=document.createElement("b");else if(e.type===4)n=document.createElement("i");else if(e.type===7&&i)n=document.createElement("code");else if(e.type===5&&t){const o=document.createElement("a");t.disposables.add(gi(o,"click",r=>{t.callback(String(e.index),r)})),n=o}else e.type===8?n=document.createElement("br"):e.type===1&&(n=s);n&&s!==n&&s.appendChild(n),n&&Array.isArray(e.children)&&e.children.forEach(o=>{Lz(n,o,t,i)})}function yae(s,e){const t={type:1,children:[]};let i=0,n=t;const o=[],r=new Cae(s);for(;!r.eos();){let a=r.next();const l=a==="\\"&&WE(r.peek(),e)!==0;if(l&&(a=r.next()),!l&&wae(a,e)&&a===r.peek()){r.advance(),n.type===2&&(n=o.pop());const c=WE(a,e);if(n.type===c||n.type===5&&c===6)n=o.pop();else{const d={type:c,children:[]};c===5&&(d.index=i,i++),n.children.push(d),o.push(n),n=d}}else if(a===`
`)n.type===2&&(n=o.pop()),n.children.push({type:8});else if(n.type!==2){const c={type:2,content:a};n.children.push(c),o.push(n),n=c}else n.content+=a}return n.type===2&&(n=o.pop()),t}function wae(s,e){return WE(s,e)!==0}function WE(s,e){switch(s){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return e?7:0;default:return 0}}const Sae=new RegExp(`(\\\\)?\\$\\((${Ie.iconNameExpression}(?:${Ie.iconModifierExpression})?)\\)`,"g");function Kd(s){const e=new Array;let t,i=0,n=0;for(;(t=Sae.exec(s))!==null;){n=t.index||0,i<n&&e.push(s.substring(i,n)),i=(t.index||0)+t[0].length;const[,o,r]=t;e.push(o?`$(${r})`:Gu({id:r}))}return i<s.length&&e.push(s.substring(i)),e}function Gu(s){const e=te("span");return e.classList.add(...Ie.asClassNameArray(s)),e}function Lae(s){const e=xae(s);if(e&&e.length>0)return new Uint32Array(e)}let Do=0;const Cd=new Uint32Array(10);function xae(s){if(Do=0,Ja(s,fD,4352),Do>0||(Ja(s,pD,4449),Do>0)||(Ja(s,mD,4520),Do>0)||(Ja(s,Mh,12593),Do))return Cd.subarray(0,Do);if(s>=44032&&s<=55203){const e=s-44032,t=e%588,i=Math.floor(e/588),n=Math.floor(t/28),o=t%28-1;if(i<fD.length?Ja(i,fD,0):4352+i-12593<Mh.length&&Ja(4352+i,Mh,12593),n<pD.length?Ja(n,pD,0):4449+n-12593<Mh.length&&Ja(4449+n-12593,Mh,12593),o>=0&&(o<mD.length?Ja(o,mD,0):4520+o-12593<Mh.length&&Ja(4520+o-12593,Mh,12593)),Do>0)return Cd.subarray(0,Do)}}function Ja(s,e,t){s>=t&&s<t+e.length&&kae(e[s-t])}function kae(s){s!==0&&(Cd[Do++]=s&255,s>>8&&(Cd[Do++]=s>>8&255),s>>16&&(Cd[Do++]=s>>16&255))}const fD=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),pD=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),mD=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),Mh=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function A2(...s){return function(e,t){for(let i=0,n=s.length;i<n;i++){const o=s[i](e,t);if(o)return o}return null}}xz.bind(void 0,!1);const cv=xz.bind(void 0,!0);function xz(s,e,t){if(!t||t.length<e.length)return null;let i;return s?i=WP(t,e):i=t.indexOf(e)===0,i?e.length>0?[{start:0,end:e.length}]:[]:null}function kz(s,e){const t=e.toLowerCase().indexOf(s.toLowerCase());return t===-1?null:[{start:t,end:t+s.length}]}function Dz(s,e){return HE(s.toLowerCase(),e.toLowerCase(),0,0)}function HE(s,e,t,i){if(t===s.length)return[];if(i===e.length)return null;if(s[t]===e[i]){let n=null;return(n=HE(s,e,t+1,i+1))?F2({start:i,end:i+1},n):null}return HE(s,e,t,i+1)}function P2(s){return 97<=s&&s<=122}function QL(s){return 65<=s&&s<=90}function O2(s){return 48<=s&&s<=57}function Iz(s){return s===32||s===9||s===10||s===13}const Tz=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(s=>Tz.add(s.charCodeAt(0)));function c0(s){return Iz(s)||Tz.has(s)}function fB(s,e){return s===e||c0(s)&&c0(e)}const _D=new Map;function pB(s){if(_D.has(s))return _D.get(s);let e;const t=Lae(s);return t&&(e=t),_D.set(s,e),e}function Ez(s){return P2(s)||QL(s)||O2(s)}function F2(s,e){return e.length===0?e=[s]:s.end===e[0].start?e[0].start=s.start:e.unshift(s),e}function Nz(s,e){for(let t=e;t<s.length;t++){const i=s.charCodeAt(t);if(QL(i)||O2(i)||t>0&&!Ez(s.charCodeAt(t-1)))return t}return s.length}function VE(s,e,t,i){if(t===s.length)return[];if(i===e.length)return null;if(s[t]!==e[i].toLowerCase())return null;{let n=null,o=i+1;for(n=VE(s,e,t+1,i+1);!n&&(o=Nz(e,o))<e.length;)n=VE(s,e,t+1,o),o++;return n===null?null:F2({start:i,end:i+1},n)}}function Dae(s){let e=0,t=0,i=0,n=0,o=0;for(let d=0;d<s.length;d++)o=s.charCodeAt(d),QL(o)&&e++,P2(o)&&t++,Ez(o)&&i++,O2(o)&&n++;const r=e/s.length,a=t/s.length,l=i/s.length,c=n/s.length;return{upperPercent:r,lowerPercent:a,alphaPercent:l,numericPercent:c}}function Iae(s){const{upperPercent:e,lowerPercent:t}=s;return t===0&&e>.6}function Tae(s){const{upperPercent:e,lowerPercent:t,alphaPercent:i,numericPercent:n}=s;return t>.2&&e<.8&&i>.6&&n<.2}function Eae(s){let e=0,t=0,i=0,n=0;for(let o=0;o<s.length;o++)i=s.charCodeAt(o),QL(i)&&e++,P2(i)&&t++,Iz(i)&&n++;return(e===0||t===0)&&n===0?s.length<=30:e<=5}function Rz(s,e){if(!e||(e=e.trim(),e.length===0)||!Eae(s))return null;e.length>60&&(e=e.substring(0,60));const t=Dae(e);if(!Tae(t)){if(!Iae(t))return null;e=e.toLowerCase()}let i=null,n=0;for(s=s.toLowerCase();n<e.length&&(i=VE(s,e,0,n))===null;)n=Nz(e,n+1);return i}function Nae(s,e,t=!1){if(!e||e.length===0)return null;let i=null,n=0;for(s=s.toLowerCase(),e=e.toLowerCase();n<e.length&&(i=zE(s,e,0,n,t),i===null);)n=Mz(e,n+1);return i}function zE(s,e,t,i,n){let o=0;if(t===s.length)return[];if(i===e.length)return null;if(!fB(s.charCodeAt(t),e.charCodeAt(i))){const l=pB(s.charCodeAt(t));if(!l)return null;for(let c=0;c<l.length;c++)if(!fB(l[c],e.charCodeAt(i+c)))return null;o+=l.length-1}let r=null,a=i+o+1;if(r=zE(s,e,t+1,a,n),!n)for(;!r&&(a=Mz(e,a))<e.length;)r=zE(s,e,t+1,a,n),a++;if(!r)return null;if(s.charCodeAt(t)!==e.charCodeAt(i)){const l=pB(s.charCodeAt(t));if(!l)return r;for(let c=0;c<l.length;c++)if(l[c]!==e.charCodeAt(i+c))return r}return F2({start:i,end:i+o+1},r)}function Mz(s,e){for(let t=e;t<s.length;t++)if(c0(s.charCodeAt(t))||t>0&&c0(s.charCodeAt(t-1)))return t;return s.length}const Rae=A2(cv,Rz,kz),Mae=A2(cv,Rz,Dz),mB=new Wl(1e4);function _B(s,e,t=!1){if(typeof s!="string"||typeof e!="string")return null;let i=mB.get(s);i||(i=new RegExp(_ee(s),"i"),mB.set(s,i));const n=i.exec(e);return n?[{start:n.index,end:n.index+n[0].length}]:t?Mae(s,e):Rae(s,e)}function Aae(s,e){const t=Yu(s,s.toLowerCase(),0,e,e.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return t?IC(t):null}function Pae(s,e,t,i,n,o){const r=Math.min(13,s.length);for(;t<r;t++){const a=Yu(s,e,t,i,n,o,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(a)return a}return[0,o]}function IC(s){if(typeof s>"u")return[];const e=[],t=s[1];for(let i=s.length-1;i>1;i--){const n=s[i]+t,o=e[e.length-1];o&&o.end===n?o.end=n+1:e.push({start:n,end:n+1})}return e}const Md=128;function B2(){const s=[],e=[];for(let t=0;t<=Md;t++)e[t]=0;for(let t=0;t<=Md;t++)s.push(e.slice(0));return s}function Az(s){const e=[];for(let t=0;t<=s;t++)e[t]=0;return e}const Pz=Az(2*Md),UE=Az(2*Md),ql=B2(),Ah=B2(),Iy=B2();function Ty(s,e){if(e<0||e>=s.length)return!1;const t=s.codePointAt(e);switch(t){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!UP(t)}}function bB(s,e){if(e<0||e>=s.length)return!1;switch(s.charCodeAt(e)){case 32:case 9:return!0;default:return!1}}function zw(s,e,t){return e[s]!==t[s]}function Oae(s,e,t,i,n,o,r=!1){for(;e<t&&n<o;)s[e]===i[n]&&(r&&(Pz[e]=n),e+=1),n+=1;return e===t}var Aa;(function(s){s.Default=[-100,0];function e(t){return!t||t.length===2&&t[0]===-100&&t[1]===0}s.isDefault=e})(Aa||(Aa={}));class W2{static{this.default={boostFullMatch:!0,firstMatchCanBeWeak:!1}}constructor(e,t){this.firstMatchCanBeWeak=e,this.boostFullMatch=t}}function Yu(s,e,t,i,n,o,r=W2.default){const a=s.length>Md?Md:s.length,l=i.length>Md?Md:i.length;if(t>=a||o>=l||a-t>l-o||!Oae(e,t,a,n,o,l,!0))return;Fae(a,l,t,o,e,n);let c=1,d=1,h=t,u=o;const g=[!1];for(c=1,h=t;h<a;c++,h++){const v=Pz[h],C=UE[h],y=h+1<a?UE[h+1]:l;for(d=v-o+1,u=v;u<y;d++,u++){let w=Number.MIN_SAFE_INTEGER,x=!1;u<=C&&(w=Bae(s,e,h,t,i,n,u,l,o,ql[c-1][d-1]===0,g));let L=0;w!==Number.MAX_SAFE_INTEGER&&(x=!0,L=w+Ah[c-1][d-1]);const D=u>v,T=D?Ah[c][d-1]+(ql[c][d-1]>0?-5:0):0,F=u>v+1&&ql[c][d-1]>0,W=F?Ah[c][d-2]+(ql[c][d-2]>0?-5:0):0;if(F&&(!D||W>=T)&&(!x||W>=L))Ah[c][d]=W,Iy[c][d]=3,ql[c][d]=0;else if(D&&(!x||T>=L))Ah[c][d]=T,Iy[c][d]=2,ql[c][d]=0;else if(x)Ah[c][d]=L,Iy[c][d]=1,ql[c][d]=ql[c-1][d-1]+1;else throw new Error("not possible")}}if(!g[0]&&!r.firstMatchCanBeWeak)return;c--,d--;const f=[Ah[c][d],o];let m=0,_=0;for(;c>=1;){let v=d;do{const C=Iy[c][v];if(C===3)v=v-2;else if(C===2)v=v-1;else break}while(v>=1);m>1&&e[t+c-1]===n[o+d-1]&&!zw(v+o-1,i,n)&&m+1>ql[c][v]&&(v=d),v===d?m++:m=1,_||(_=v),c--,d=v-1,f.push(d)}l-o===a&&r.boostFullMatch&&(f[0]+=2);const b=_-a;return f[0]-=b,f}function Fae(s,e,t,i,n,o){let r=s-1,a=e-1;for(;r>=t&&a>=i;)n[r]===o[a]&&(UE[r]=a,r--),a--}function Bae(s,e,t,i,n,o,r,a,l,c,d){if(e[t]!==o[r])return Number.MIN_SAFE_INTEGER;let h=1,u=!1;return r===t-i?h=s[t]===n[r]?7:5:zw(r,n,o)&&(r===0||!zw(r-1,n,o))?(h=s[t]===n[r]?7:5,u=!0):Ty(o,r)&&(r===0||!Ty(o,r-1))?h=5:(Ty(o,r-1)||bB(o,r-1))&&(h=5,u=!0),h>1&&t===i&&(d[0]=!0),u||(u=zw(r,n,o)||Ty(o,r-1)||bB(o,r-1)),t===i?r>l&&(h-=u?3:5):c?h+=u?2:0:h+=u?0:1,r+1===a&&(h-=u?3:5),h}function Wae(s,e,t,i,n,o,r){return Hae(s,e,t,i,n,o,!0,r)}function Hae(s,e,t,i,n,o,r,a){let l=Yu(s,e,t,i,n,o,a);if(l&&!r)return l;if(s.length>=3){const c=Math.min(7,s.length-1);for(let d=t+1;d<c;d++){const h=Vae(s,d);if(h){const u=Yu(h,h.toLowerCase(),t,i,n,o,a);u&&(u[0]-=3,(!l||u[0]>l[0])&&(l=u))}}}return l}function Vae(s,e){if(e+1>=s.length)return;const t=s[e],i=s[e+1];if(t!==i)return s.slice(0,e)+i+t+s.slice(e+2)}const zae="$(",H2=new RegExp(`\\$\\(${Ie.iconNameExpression}(?:${Ie.iconModifierExpression})?\\)`,"g"),Uae=new RegExp(`(\\\\)?${H2.source}`,"g");function $ae(s){return s.replace(Uae,(e,t)=>t?e:`\\${e}`)}const jae=new RegExp(`\\\\${H2.source}`,"g");function Zae(s){return s.replace(jae,e=>`\\${e}`)}const Kae=new RegExp(`(\\s)?(\\\\)?${H2.source}(\\s)?`,"g");function V2(s){return s.indexOf(zae)===-1?s:s.replace(Kae,(e,t,i,n)=>i?e:t||n||"")}function qae(s){return s?s.replace(/\$\((.*?)\)/g,(e,t)=>` ${t} `).trim():""}const bD=new RegExp(`\\$\\(${Ie.iconNameCharacter}+\\)`,"g");function x_(s){bD.lastIndex=0;let e="";const t=[];let i=0;for(;;){const n=bD.lastIndex,o=bD.exec(s),r=s.substring(n,o?.index);if(r.length>0){e+=r;for(let a=0;a<r.length;a++)t.push(i)}if(!o)break;i+=o[0].length}return{text:e,iconOffsets:t}}function vD(s,e,t=!1){const{text:i,iconOffsets:n}=e;if(!n||n.length===0)return _B(s,i,t);const o=_C(i," "),r=i.length-o.length,a=_B(s,o,t);if(a)for(const l of a){const c=n[l.start+r]+r;l.start+=c,l.end+=c}return a}function al(s){return R1(s,!0)}class Gae{constructor(e){this._ignorePathCasing=e}compare(e,t,i=!1){return e===t?0:Zb(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}isEqualOrParent(e,t,i=!1){if(e.scheme===t.scheme){if(e.scheme===Fe.file)return EE(al(e),al(t),this._ignorePathCasing(e))&&e.query===t.query&&(i||e.fragment===t.fragment);if(CB(e.authority,t.authority))return EE(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(i||e.fragment===t.fragment)}return!1}joinPath(e,...t){return Se.joinPath(e,...t)}basenameOrAuthority(e){return wr(e)||e.authority}basename(e){return Ai.basename(e.path)}extname(e){return Ai.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===Fe.file?t=Se.file(m6(al(e))).path:(t=Ai.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===Fe.file?t=Se.file(p6(al(e))).path:t=Ai.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!CB(e.authority,t.authority))return;if(e.scheme===Fe.file){const o=qJ(al(e),al(t));return An?qV(o):o}let i=e.path||"/";const n=t.path||"/";if(this._ignorePathCasing(e)){let o=0;for(const r=Math.min(i.length,n.length);o<r&&!(i.charCodeAt(o)!==n.charCodeAt(o)&&i.charAt(o).toLowerCase()!==n.charAt(o).toLowerCase());o++);i=n.substr(0,o)+i.substr(o)}return Ai.relative(i,n)}resolvePath(e,t){if(e.scheme===Fe.file){const i=Se.file(KJ(al(e),t));return e.with({authority:i.authority,path:i.path})}return t=Qse(t),e.with({path:Ai.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&Cf(e,t)}hasTrailingPathSeparator(e,t=Ta){if(e.scheme===Fe.file){const i=al(e);return i.length>Z3(i).length&&i[i.length-1]===t}else{const i=e.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=Ta){return yB(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=Ta){let i=!1;if(e.scheme===Fe.file){const n=al(e);i=n!==void 0&&n.length===Z3(n).length&&n[n.length-1]===t}else{t="/";const n=e.path;i=n.length===1&&n.charCodeAt(n.length-1)===47}return!i&&!yB(e,t)?e.with({path:e.path+"/"}):e}}const Qt=new Gae(()=>!1),dv=Qt.isEqual.bind(Qt);Qt.isEqualOrParent.bind(Qt);Qt.getComparisonKey.bind(Qt);const Yae=Qt.basenameOrAuthority.bind(Qt),wr=Qt.basename.bind(Qt),Xae=Qt.extname.bind(Qt),JL=Qt.dirname.bind(Qt),Qae=Qt.joinPath.bind(Qt),Jae=Qt.normalizePath.bind(Qt),ele=Qt.relativePath.bind(Qt),vB=Qt.resolvePath.bind(Qt);Qt.isAbsolutePath.bind(Qt);const CB=Qt.isEqualAuthority.bind(Qt),yB=Qt.hasTrailingPathSeparator.bind(Qt);Qt.removeTrailingPathSeparator.bind(Qt);Qt.addTrailingPathSeparator.bind(Qt);var ah;(function(s){s.META_DATA_LABEL="label",s.META_DATA_DESCRIPTION="description",s.META_DATA_SIZE="size",s.META_DATA_MIME="mime";function e(t){const i=new Map;t.path.substring(t.path.indexOf(";")+1,t.path.lastIndexOf(";")).split(";").forEach(r=>{const[a,l]=r.split(":");a&&l&&i.set(a,l)});const o=t.path.substring(0,t.path.indexOf(";"));return o&&i.set(s.META_DATA_MIME,o),i}s.parseMetaData=e})(ah||(ah={}));class zn{constructor(e="",t=!1){if(this.value=e,typeof this.value!="string")throw mr("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=t.isTrusted??void 0,this.supportThemeIcons=t.supportThemeIcons??!1,this.supportHtml=t.supportHtml??!1)}appendText(e,t=0){return this.value+=ile(this.supportThemeIcons?$ae(e):e).replace(/([ \t]+)/g,(i,n)=>"&nbsp;".repeat(n.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+=`
${nle(t,e)}
`,this}appendLink(e,t,i){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),i&&(this.value+=` "${this._escape(this._escape(i,'"'),")")}"`),this.value+=")",this}_escape(e,t){const i=new RegExp(Uo(t),"g");return e.replace(i,(n,o)=>e.charAt(o-1)!=="\\"?`\\${n}`:n)}}function Mp(s){return Pa(s)?!s.value:Array.isArray(s)?s.every(Mp):!0}function Pa(s){return s instanceof zn?!0:s&&typeof s=="object"?typeof s.value=="string"&&(typeof s.isTrusted=="boolean"||typeof s.isTrusted=="object"||s.isTrusted===void 0)&&(typeof s.supportThemeIcons=="boolean"||s.supportThemeIcons===void 0):!1}function tle(s,e){return s===e?!0:!s||!e?!1:s.value===e.value&&s.isTrusted===e.isTrusted&&s.supportThemeIcons===e.supportThemeIcons&&s.supportHtml===e.supportHtml&&(s.baseUri===e.baseUri||!!s.baseUri&&!!e.baseUri&&dv(Se.from(s.baseUri),Se.from(e.baseUri)))}function ile(s){return s.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function nle(s,e){const t=s.match(/^`+/gm)?.reduce((n,o)=>n.length>o.length?n:o).length??0,i=t>=3?t+1:3;return[`${"`".repeat(i)}${e}`,s,`${"`".repeat(i)}`].join(`
`)}function Ey(s){return s.replace(/"/g,"&quot;")}function CD(s){return s&&s.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function sle(s){const e=[],t=s.split("|").map(n=>n.trim());s=t[0];const i=t[1];if(i){const n=/height=(\d+)/.exec(i),o=/width=(\d+)/.exec(i),r=n?n[1]:"",a=o?o[1]:"",l=isFinite(parseInt(a)),c=isFinite(parseInt(r));l&&e.push(`width="${a}"`),c&&e.push(`height="${r}"`)}return{href:s,dimensions:e}}class z2{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const $E=new z2("id#");let Zn={};(function(){function s(e,t){t(Zn)}s.amd=!0,function(e,t){typeof s=="function"&&s.amd?s(["exports"],t):typeof exports=="object"&&typeof module<"u"?t(exports):(e=typeof globalThis<"u"?globalThis:e||self,t(e.marked={}))}(this,function(e){function t(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}e.defaults=t();function i(rt){e.defaults=rt}const n=/[&<>"']/,o=new RegExp(n.source,"g"),r=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,a=new RegExp(r.source,"g"),l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},c=rt=>l[rt];function d(rt,N){if(N){if(n.test(rt))return rt.replace(o,c)}else if(r.test(rt))return rt.replace(a,c);return rt}const h=/(^|[^\[])\^/g;function u(rt,N){let R=typeof rt=="string"?rt:rt.source;N=N||"";const A={replace:(z,j)=>{let re=typeof j=="string"?j:j.source;return re=re.replace(h,"$1"),R=R.replace(z,re),A},getRegex:()=>new RegExp(R,N)};return A}function g(rt){try{rt=encodeURI(rt).replace(/%25/g,"%")}catch{return null}return rt}const f={exec:()=>null};function m(rt,N){const R=rt.replace(/\|/g,(j,re,de)=>{let Te=!1,Ne=re;for(;--Ne>=0&&de[Ne]==="\\";)Te=!Te;return Te?"|":" |"}),A=R.split(/ \|/);let z=0;if(A[0].trim()||A.shift(),A.length>0&&!A[A.length-1].trim()&&A.pop(),N)if(A.length>N)A.splice(N);else for(;A.length<N;)A.push("");for(;z<A.length;z++)A[z]=A[z].trim().replace(/\\\|/g,"|");return A}function _(rt,N,R){const A=rt.length;if(A===0)return"";let z=0;for(;z<A;){const j=rt.charAt(A-z-1);if(j===N&&!R)z++;else if(j!==N&&R)z++;else break}return rt.slice(0,A-z)}function b(rt,N){if(rt.indexOf(N[1])===-1)return-1;let R=0;for(let A=0;A<rt.length;A++)if(rt[A]==="\\")A++;else if(rt[A]===N[0])R++;else if(rt[A]===N[1]&&(R--,R<0))return A;return-1}function v(rt,N,R,A){const z=N.href,j=N.title?d(N.title):null,re=rt[1].replace(/\\([\[\]])/g,"$1");if(rt[0].charAt(0)!=="!"){A.state.inLink=!0;const de={type:"link",raw:R,href:z,title:j,text:re,tokens:A.inlineTokens(re)};return A.state.inLink=!1,de}return{type:"image",raw:R,href:z,title:j,text:d(re)}}function C(rt,N){const R=rt.match(/^(\s+)(?:```)/);if(R===null)return N;const A=R[1];return N.split(`
`).map(z=>{const j=z.match(/^\s+/);if(j===null)return z;const[re]=j;return re.length>=A.length?z.slice(A.length):z}).join(`
`)}class y{options;rules;lexer;constructor(N){this.options=N||e.defaults}space(N){const R=this.rules.block.newline.exec(N);if(R&&R[0].length>0)return{type:"space",raw:R[0]}}code(N){const R=this.rules.block.code.exec(N);if(R){const A=R[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:R[0],codeBlockStyle:"indented",text:this.options.pedantic?A:_(A,`
`)}}}fences(N){const R=this.rules.block.fences.exec(N);if(R){const A=R[0],z=C(A,R[3]||"");return{type:"code",raw:A,lang:R[2]?R[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):R[2],text:z}}}heading(N){const R=this.rules.block.heading.exec(N);if(R){let A=R[2].trim();if(/#$/.test(A)){const z=_(A,"#");(this.options.pedantic||!z||/ $/.test(z))&&(A=z.trim())}return{type:"heading",raw:R[0],depth:R[1].length,text:A,tokens:this.lexer.inline(A)}}}hr(N){const R=this.rules.block.hr.exec(N);if(R)return{type:"hr",raw:_(R[0],`
`)}}blockquote(N){const R=this.rules.block.blockquote.exec(N);if(R){let A=_(R[0],`
`).split(`
`),z="",j="";const re=[];for(;A.length>0;){let de=!1;const Te=[];let Ne;for(Ne=0;Ne<A.length;Ne++)if(/^ {0,3}>/.test(A[Ne]))Te.push(A[Ne]),de=!0;else if(!de)Te.push(A[Ne]);else break;A=A.slice(Ne);const at=Te.join(`
`),Rt=at.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");z=z?`${z}
${at}`:at,j=j?`${j}
${Rt}`:Rt;const Ci=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(Rt,re,!0),this.lexer.state.top=Ci,A.length===0)break;const sn=re[re.length-1];if(sn?.type==="code")break;if(sn?.type==="blockquote"){const Ni=sn,Be=Ni.raw+`
`+A.join(`
`),K=this.blockquote(Be);re[re.length-1]=K,z=z.substring(0,z.length-Ni.raw.length)+K.raw,j=j.substring(0,j.length-Ni.text.length)+K.text;break}else if(sn?.type==="list"){const Ni=sn,Be=Ni.raw+`
`+A.join(`
`),K=this.list(Be);re[re.length-1]=K,z=z.substring(0,z.length-sn.raw.length)+K.raw,j=j.substring(0,j.length-Ni.raw.length)+K.raw,A=Be.substring(re[re.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:z,tokens:re,text:j}}}list(N){let R=this.rules.block.list.exec(N);if(R){let A=R[1].trim();const z=A.length>1,j={type:"list",raw:"",ordered:z,start:z?+A.slice(0,-1):"",loose:!1,items:[]};A=z?`\\d{1,9}\\${A.slice(-1)}`:`\\${A}`,this.options.pedantic&&(A=z?A:"[*+-]");const re=new RegExp(`^( {0,3}${A})((?:[	 ][^\\n]*)?(?:\\n|$))`);let de=!1;for(;N;){let Te=!1,Ne="",at="";if(!(R=re.exec(N))||this.rules.block.hr.test(N))break;Ne=R[0],N=N.substring(Ne.length);let Rt=R[2].split(`
`,1)[0].replace(/^\t+/,we=>" ".repeat(3*we.length)),Ci=N.split(`
`,1)[0],sn=!Rt.trim(),Ni=0;if(this.options.pedantic?(Ni=2,at=Rt.trimStart()):sn?Ni=R[1].length+1:(Ni=R[2].search(/[^ ]/),Ni=Ni>4?1:Ni,at=Rt.slice(Ni),Ni+=R[1].length),sn&&/^ *$/.test(Ci)&&(Ne+=Ci+`
`,N=N.substring(Ci.length+1),Te=!0),!Te){const we=new RegExp(`^ {0,${Math.min(3,Ni-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),Ae=new RegExp(`^ {0,${Math.min(3,Ni-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),ui=new RegExp(`^ {0,${Math.min(3,Ni-1)}}(?:\`\`\`|~~~)`),gn=new RegExp(`^ {0,${Math.min(3,Ni-1)}}#`);for(;N;){const Rs=N.split(`
`,1)[0];if(Ci=Rs,this.options.pedantic&&(Ci=Ci.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),ui.test(Ci)||gn.test(Ci)||we.test(Ci)||Ae.test(N))break;if(Ci.search(/[^ ]/)>=Ni||!Ci.trim())at+=`
`+Ci.slice(Ni);else{if(sn||Rt.search(/[^ ]/)>=4||ui.test(Rt)||gn.test(Rt)||Ae.test(Rt))break;at+=`
`+Ci}!sn&&!Ci.trim()&&(sn=!0),Ne+=Rs+`
`,N=N.substring(Rs.length+1),Rt=Ci.slice(Ni)}}j.loose||(de?j.loose=!0:/\n *\n *$/.test(Ne)&&(de=!0));let Be=null,K;this.options.gfm&&(Be=/^\[[ xX]\] /.exec(at),Be&&(K=Be[0]!=="[ ] ",at=at.replace(/^\[[ xX]\] +/,""))),j.items.push({type:"list_item",raw:Ne,task:!!Be,checked:K,loose:!1,text:at,tokens:[]}),j.raw+=Ne}j.items[j.items.length-1].raw=j.items[j.items.length-1].raw.trimEnd(),j.items[j.items.length-1].text=j.items[j.items.length-1].text.trimEnd(),j.raw=j.raw.trimEnd();for(let Te=0;Te<j.items.length;Te++)if(this.lexer.state.top=!1,j.items[Te].tokens=this.lexer.blockTokens(j.items[Te].text,[]),!j.loose){const Ne=j.items[Te].tokens.filter(Rt=>Rt.type==="space"),at=Ne.length>0&&Ne.some(Rt=>/\n.*\n/.test(Rt.raw));j.loose=at}if(j.loose)for(let Te=0;Te<j.items.length;Te++)j.items[Te].loose=!0;return j}}html(N){const R=this.rules.block.html.exec(N);if(R)return{type:"html",block:!0,raw:R[0],pre:R[1]==="pre"||R[1]==="script"||R[1]==="style",text:R[0]}}def(N){const R=this.rules.block.def.exec(N);if(R){const A=R[1].toLowerCase().replace(/\s+/g," "),z=R[2]?R[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",j=R[3]?R[3].substring(1,R[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):R[3];return{type:"def",tag:A,raw:R[0],href:z,title:j}}}table(N){const R=this.rules.block.table.exec(N);if(!R||!/[:|]/.test(R[2]))return;const A=m(R[1]),z=R[2].replace(/^\||\| *$/g,"").split("|"),j=R[3]&&R[3].trim()?R[3].replace(/\n[ \t]*$/,"").split(`
`):[],re={type:"table",raw:R[0],header:[],align:[],rows:[]};if(A.length===z.length){for(const de of z)/^ *-+: *$/.test(de)?re.align.push("right"):/^ *:-+: *$/.test(de)?re.align.push("center"):/^ *:-+ *$/.test(de)?re.align.push("left"):re.align.push(null);for(let de=0;de<A.length;de++)re.header.push({text:A[de],tokens:this.lexer.inline(A[de]),header:!0,align:re.align[de]});for(const de of j)re.rows.push(m(de,re.header.length).map((Te,Ne)=>({text:Te,tokens:this.lexer.inline(Te),header:!1,align:re.align[Ne]})));return re}}lheading(N){const R=this.rules.block.lheading.exec(N);if(R)return{type:"heading",raw:R[0],depth:R[2].charAt(0)==="="?1:2,text:R[1],tokens:this.lexer.inline(R[1])}}paragraph(N){const R=this.rules.block.paragraph.exec(N);if(R){const A=R[1].charAt(R[1].length-1)===`
`?R[1].slice(0,-1):R[1];return{type:"paragraph",raw:R[0],text:A,tokens:this.lexer.inline(A)}}}text(N){const R=this.rules.block.text.exec(N);if(R)return{type:"text",raw:R[0],text:R[0],tokens:this.lexer.inline(R[0])}}escape(N){const R=this.rules.inline.escape.exec(N);if(R)return{type:"escape",raw:R[0],text:d(R[1])}}tag(N){const R=this.rules.inline.tag.exec(N);if(R)return!this.lexer.state.inLink&&/^<a /i.test(R[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(R[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(R[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(R[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:R[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:R[0]}}link(N){const R=this.rules.inline.link.exec(N);if(R){const A=R[2].trim();if(!this.options.pedantic&&/^</.test(A)){if(!/>$/.test(A))return;const re=_(A.slice(0,-1),"\\");if((A.length-re.length)%2===0)return}else{const re=b(R[2],"()");if(re>-1){const Te=(R[0].indexOf("!")===0?5:4)+R[1].length+re;R[2]=R[2].substring(0,re),R[0]=R[0].substring(0,Te).trim(),R[3]=""}}let z=R[2],j="";if(this.options.pedantic){const re=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(z);re&&(z=re[1],j=re[3])}else j=R[3]?R[3].slice(1,-1):"";return z=z.trim(),/^</.test(z)&&(this.options.pedantic&&!/>$/.test(A)?z=z.slice(1):z=z.slice(1,-1)),v(R,{href:z&&z.replace(this.rules.inline.anyPunctuation,"$1"),title:j&&j.replace(this.rules.inline.anyPunctuation,"$1")},R[0],this.lexer)}}reflink(N,R){let A;if((A=this.rules.inline.reflink.exec(N))||(A=this.rules.inline.nolink.exec(N))){const z=(A[2]||A[1]).replace(/\s+/g," "),j=R[z.toLowerCase()];if(!j){const re=A[0].charAt(0);return{type:"text",raw:re,text:re}}return v(A,j,A[0],this.lexer)}}emStrong(N,R,A=""){let z=this.rules.inline.emStrongLDelim.exec(N);if(!z||z[3]&&A.match(/[\p{L}\p{N}]/u))return;if(!(z[1]||z[2]||"")||!A||this.rules.inline.punctuation.exec(A)){const re=[...z[0]].length-1;let de,Te,Ne=re,at=0;const Rt=z[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(Rt.lastIndex=0,R=R.slice(-1*N.length+re);(z=Rt.exec(R))!=null;){if(de=z[1]||z[2]||z[3]||z[4]||z[5]||z[6],!de)continue;if(Te=[...de].length,z[3]||z[4]){Ne+=Te;continue}else if((z[5]||z[6])&&re%3&&!((re+Te)%3)){at+=Te;continue}if(Ne-=Te,Ne>0)continue;Te=Math.min(Te,Te+Ne+at);const Ci=[...z[0]][0].length,sn=N.slice(0,re+z.index+Ci+Te);if(Math.min(re,Te)%2){const Be=sn.slice(1,-1);return{type:"em",raw:sn,text:Be,tokens:this.lexer.inlineTokens(Be)}}const Ni=sn.slice(2,-2);return{type:"strong",raw:sn,text:Ni,tokens:this.lexer.inlineTokens(Ni)}}}}codespan(N){const R=this.rules.inline.code.exec(N);if(R){let A=R[2].replace(/\n/g," ");const z=/[^ ]/.test(A),j=/^ /.test(A)&&/ $/.test(A);return z&&j&&(A=A.substring(1,A.length-1)),A=d(A,!0),{type:"codespan",raw:R[0],text:A}}}br(N){const R=this.rules.inline.br.exec(N);if(R)return{type:"br",raw:R[0]}}del(N){const R=this.rules.inline.del.exec(N);if(R)return{type:"del",raw:R[0],text:R[2],tokens:this.lexer.inlineTokens(R[2])}}autolink(N){const R=this.rules.inline.autolink.exec(N);if(R){let A,z;return R[2]==="@"?(A=d(R[1]),z="mailto:"+A):(A=d(R[1]),z=A),{type:"link",raw:R[0],text:A,href:z,tokens:[{type:"text",raw:A,text:A}]}}}url(N){let R;if(R=this.rules.inline.url.exec(N)){let A,z;if(R[2]==="@")A=d(R[0]),z="mailto:"+A;else{let j;do j=R[0],R[0]=this.rules.inline._backpedal.exec(R[0])?.[0]??"";while(j!==R[0]);A=d(R[0]),R[1]==="www."?z="http://"+R[0]:z=R[0]}return{type:"link",raw:R[0],text:A,href:z,tokens:[{type:"text",raw:A,text:A}]}}}inlineText(N){const R=this.rules.inline.text.exec(N);if(R){let A;return this.lexer.state.inRawBlock?A=R[0]:A=d(R[0]),{type:"text",raw:R[0],text:A}}}}const w=/^(?: *(?:\n|$))+/,x=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,L=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,D=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,T=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,F=/(?:[*+-]|\d{1,9}[.)])/,W=u(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,F).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),H=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,$=/^[^\n]+/,V=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Y=u(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",V).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),ie=u(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,F).getRegex(),ue="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",fe=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,oe=u("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",fe).replace("tag",ue).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),be=u(H).replace("hr",D).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ue).getRegex(),wt={blockquote:u(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",be).getRegex(),code:x,def:Y,fences:L,heading:T,hr:D,html:oe,lheading:W,list:ie,newline:w,paragraph:be,table:f,text:$},pt=u("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",D).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ue).getRegex(),Et={...wt,table:pt,paragraph:u(H).replace("hr",D).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",pt).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ue).getRegex()},Ei={...wt,html:u(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",fe).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:f,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:u(H).replace("hr",D).replace("heading",` *#{1,6} *[^
]`).replace("lheading",W).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Fi=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Fn=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,ei=/^( {2,}|\\)\n(?!\s*$)/,wo=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Es="\\p{P}\\p{S}",Tr=u(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,Es).getRegex(),Mg=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,Er=u(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,Es).getRegex(),ra=u("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,Es).getRegex(),jl=u("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,Es).getRegex(),td=u(/\\([punct])/,"gu").replace(/punct/g,Es).getRegex(),Th=u(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Ag=u(fe).replace("(?:-->|$)","-->").getRegex(),Pg=u("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Ag).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),aa=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Zl=u(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",aa).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Jo=u(/^!?\[(label)\]\[(ref)\]/).replace("label",aa).replace("ref",V).getRegex(),Nr=u(/^!?\[(ref)\](?:\[\])?/).replace("ref",V).getRegex(),Eh=u("reflink|nolink(?!\\()","g").replace("reflink",Jo).replace("nolink",Nr).getRegex(),id={_backpedal:f,anyPunctuation:td,autolink:Th,blockSkip:Mg,br:ei,code:Fn,del:f,emStrongLDelim:Er,emStrongRDelimAst:ra,emStrongRDelimUnd:jl,escape:Fi,link:Zl,nolink:Nr,punctuation:Tr,reflink:Jo,reflinkSearch:Eh,tag:Pg,text:wo,url:f},Og={...id,link:u(/^!?\[(label)\]\((.*?)\)/).replace("label",aa).getRegex(),reflink:u(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",aa).getRegex()},Ya={...id,escape:u(Fi).replace("])","~|])").getRegex(),url:u(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Nh={...Ya,br:u(ei).replace("{2,}","*").getRegex(),text:u(Ya.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},er={normal:wt,gfm:Et,pedantic:Ei},Bi={normal:id,gfm:Ya,breaks:Nh,pedantic:Og};class hi{tokens;options;state;tokenizer;inlineQueue;constructor(N){this.tokens=[],this.tokens.links=Object.create(null),this.options=N||e.defaults,this.options.tokenizer=this.options.tokenizer||new y,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const R={block:er.normal,inline:Bi.normal};this.options.pedantic?(R.block=er.pedantic,R.inline=Bi.pedantic):this.options.gfm&&(R.block=er.gfm,this.options.breaks?R.inline=Bi.breaks:R.inline=Bi.gfm),this.tokenizer.rules=R}static get rules(){return{block:er,inline:Bi}}static lex(N,R){return new hi(R).lex(N)}static lexInline(N,R){return new hi(R).inlineTokens(N)}lex(N){N=N.replace(/\r\n|\r/g,`
`),this.blockTokens(N,this.tokens);for(let R=0;R<this.inlineQueue.length;R++){const A=this.inlineQueue[R];this.inlineTokens(A.src,A.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(N,R=[],A=!1){this.options.pedantic?N=N.replace(/\t/g,"    ").replace(/^ +$/gm,""):N=N.replace(/^( *)(\t+)/gm,(de,Te,Ne)=>Te+"    ".repeat(Ne.length));let z,j,re;for(;N;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(de=>(z=de.call({lexer:this},N,R))?(N=N.substring(z.raw.length),R.push(z),!0):!1))){if(z=this.tokenizer.space(N)){N=N.substring(z.raw.length),z.raw.length===1&&R.length>0?R[R.length-1].raw+=`
`:R.push(z);continue}if(z=this.tokenizer.code(N)){N=N.substring(z.raw.length),j=R[R.length-1],j&&(j.type==="paragraph"||j.type==="text")?(j.raw+=`
`+z.raw,j.text+=`
`+z.text,this.inlineQueue[this.inlineQueue.length-1].src=j.text):R.push(z);continue}if(z=this.tokenizer.fences(N)){N=N.substring(z.raw.length),R.push(z);continue}if(z=this.tokenizer.heading(N)){N=N.substring(z.raw.length),R.push(z);continue}if(z=this.tokenizer.hr(N)){N=N.substring(z.raw.length),R.push(z);continue}if(z=this.tokenizer.blockquote(N)){N=N.substring(z.raw.length),R.push(z);continue}if(z=this.tokenizer.list(N)){N=N.substring(z.raw.length),R.push(z);continue}if(z=this.tokenizer.html(N)){N=N.substring(z.raw.length),R.push(z);continue}if(z=this.tokenizer.def(N)){N=N.substring(z.raw.length),j=R[R.length-1],j&&(j.type==="paragraph"||j.type==="text")?(j.raw+=`
`+z.raw,j.text+=`
`+z.raw,this.inlineQueue[this.inlineQueue.length-1].src=j.text):this.tokens.links[z.tag]||(this.tokens.links[z.tag]={href:z.href,title:z.title});continue}if(z=this.tokenizer.table(N)){N=N.substring(z.raw.length),R.push(z);continue}if(z=this.tokenizer.lheading(N)){N=N.substring(z.raw.length),R.push(z);continue}if(re=N,this.options.extensions&&this.options.extensions.startBlock){let de=1/0;const Te=N.slice(1);let Ne;this.options.extensions.startBlock.forEach(at=>{Ne=at.call({lexer:this},Te),typeof Ne=="number"&&Ne>=0&&(de=Math.min(de,Ne))}),de<1/0&&de>=0&&(re=N.substring(0,de+1))}if(this.state.top&&(z=this.tokenizer.paragraph(re))){j=R[R.length-1],A&&j?.type==="paragraph"?(j.raw+=`
`+z.raw,j.text+=`
`+z.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=j.text):R.push(z),A=re.length!==N.length,N=N.substring(z.raw.length);continue}if(z=this.tokenizer.text(N)){N=N.substring(z.raw.length),j=R[R.length-1],j&&j.type==="text"?(j.raw+=`
`+z.raw,j.text+=`
`+z.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=j.text):R.push(z);continue}if(N){const de="Infinite loop on byte: "+N.charCodeAt(0);if(this.options.silent){console.error(de);break}else throw new Error(de)}}return this.state.top=!0,R}inline(N,R=[]){return this.inlineQueue.push({src:N,tokens:R}),R}inlineTokens(N,R=[]){let A,z,j,re=N,de,Te,Ne;if(this.tokens.links){const at=Object.keys(this.tokens.links);if(at.length>0)for(;(de=this.tokenizer.rules.inline.reflinkSearch.exec(re))!=null;)at.includes(de[0].slice(de[0].lastIndexOf("[")+1,-1))&&(re=re.slice(0,de.index)+"["+"a".repeat(de[0].length-2)+"]"+re.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(de=this.tokenizer.rules.inline.blockSkip.exec(re))!=null;)re=re.slice(0,de.index)+"["+"a".repeat(de[0].length-2)+"]"+re.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(de=this.tokenizer.rules.inline.anyPunctuation.exec(re))!=null;)re=re.slice(0,de.index)+"++"+re.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;N;)if(Te||(Ne=""),Te=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(at=>(A=at.call({lexer:this},N,R))?(N=N.substring(A.raw.length),R.push(A),!0):!1))){if(A=this.tokenizer.escape(N)){N=N.substring(A.raw.length),R.push(A);continue}if(A=this.tokenizer.tag(N)){N=N.substring(A.raw.length),z=R[R.length-1],z&&A.type==="text"&&z.type==="text"?(z.raw+=A.raw,z.text+=A.text):R.push(A);continue}if(A=this.tokenizer.link(N)){N=N.substring(A.raw.length),R.push(A);continue}if(A=this.tokenizer.reflink(N,this.tokens.links)){N=N.substring(A.raw.length),z=R[R.length-1],z&&A.type==="text"&&z.type==="text"?(z.raw+=A.raw,z.text+=A.text):R.push(A);continue}if(A=this.tokenizer.emStrong(N,re,Ne)){N=N.substring(A.raw.length),R.push(A);continue}if(A=this.tokenizer.codespan(N)){N=N.substring(A.raw.length),R.push(A);continue}if(A=this.tokenizer.br(N)){N=N.substring(A.raw.length),R.push(A);continue}if(A=this.tokenizer.del(N)){N=N.substring(A.raw.length),R.push(A);continue}if(A=this.tokenizer.autolink(N)){N=N.substring(A.raw.length),R.push(A);continue}if(!this.state.inLink&&(A=this.tokenizer.url(N))){N=N.substring(A.raw.length),R.push(A);continue}if(j=N,this.options.extensions&&this.options.extensions.startInline){let at=1/0;const Rt=N.slice(1);let Ci;this.options.extensions.startInline.forEach(sn=>{Ci=sn.call({lexer:this},Rt),typeof Ci=="number"&&Ci>=0&&(at=Math.min(at,Ci))}),at<1/0&&at>=0&&(j=N.substring(0,at+1))}if(A=this.tokenizer.inlineText(j)){N=N.substring(A.raw.length),A.raw.slice(-1)!=="_"&&(Ne=A.raw.slice(-1)),Te=!0,z=R[R.length-1],z&&z.type==="text"?(z.raw+=A.raw,z.text+=A.text):R.push(A);continue}if(N){const at="Infinite loop on byte: "+N.charCodeAt(0);if(this.options.silent){console.error(at);break}else throw new Error(at)}}return R}}class Ns{options;parser;constructor(N){this.options=N||e.defaults}space(N){return""}code({text:N,lang:R,escaped:A}){const z=(R||"").match(/^\S*/)?.[0],j=N.replace(/\n$/,"")+`
`;return z?'<pre><code class="language-'+d(z)+'">'+(A?j:d(j,!0))+`</code></pre>
`:"<pre><code>"+(A?j:d(j,!0))+`</code></pre>
`}blockquote({tokens:N}){return`<blockquote>
${this.parser.parse(N)}</blockquote>
`}html({text:N}){return N}heading({tokens:N,depth:R}){return`<h${R}>${this.parser.parseInline(N)}</h${R}>
`}hr(N){return`<hr>
`}list(N){const R=N.ordered,A=N.start;let z="";for(let de=0;de<N.items.length;de++){const Te=N.items[de];z+=this.listitem(Te)}const j=R?"ol":"ul",re=R&&A!==1?' start="'+A+'"':"";return"<"+j+re+`>
`+z+"</"+j+`>
`}listitem(N){let R="";if(N.task){const A=this.checkbox({checked:!!N.checked});N.loose?N.tokens.length>0&&N.tokens[0].type==="paragraph"?(N.tokens[0].text=A+" "+N.tokens[0].text,N.tokens[0].tokens&&N.tokens[0].tokens.length>0&&N.tokens[0].tokens[0].type==="text"&&(N.tokens[0].tokens[0].text=A+" "+N.tokens[0].tokens[0].text)):N.tokens.unshift({type:"text",raw:A+" ",text:A+" "}):R+=A+" "}return R+=this.parser.parse(N.tokens,!!N.loose),`<li>${R}</li>
`}checkbox({checked:N}){return"<input "+(N?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:N}){return`<p>${this.parser.parseInline(N)}</p>
`}table(N){let R="",A="";for(let j=0;j<N.header.length;j++)A+=this.tablecell(N.header[j]);R+=this.tablerow({text:A});let z="";for(let j=0;j<N.rows.length;j++){const re=N.rows[j];A="";for(let de=0;de<re.length;de++)A+=this.tablecell(re[de]);z+=this.tablerow({text:A})}return z&&(z=`<tbody>${z}</tbody>`),`<table>
<thead>
`+R+`</thead>
`+z+`</table>
`}tablerow({text:N}){return`<tr>
${N}</tr>
`}tablecell(N){const R=this.parser.parseInline(N.tokens),A=N.header?"th":"td";return(N.align?`<${A} align="${N.align}">`:`<${A}>`)+R+`</${A}>
`}strong({tokens:N}){return`<strong>${this.parser.parseInline(N)}</strong>`}em({tokens:N}){return`<em>${this.parser.parseInline(N)}</em>`}codespan({text:N}){return`<code>${N}</code>`}br(N){return"<br>"}del({tokens:N}){return`<del>${this.parser.parseInline(N)}</del>`}link({href:N,title:R,tokens:A}){const z=this.parser.parseInline(A),j=g(N);if(j===null)return z;N=j;let re='<a href="'+N+'"';return R&&(re+=' title="'+R+'"'),re+=">"+z+"</a>",re}image({href:N,title:R,text:A}){const z=g(N);if(z===null)return A;N=z;let j=`<img src="${N}" alt="${A}"`;return R&&(j+=` title="${R}"`),j+=">",j}text(N){return"tokens"in N&&N.tokens?this.parser.parseInline(N.tokens):N.text}}class nd{strong({text:N}){return N}em({text:N}){return N}codespan({text:N}){return N}del({text:N}){return N}html({text:N}){return N}text({text:N}){return N}link({text:N}){return""+N}image({text:N}){return""+N}br(){return""}}class Qs{options;renderer;textRenderer;constructor(N){this.options=N||e.defaults,this.options.renderer=this.options.renderer||new Ns,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new nd}static parse(N,R){return new Qs(R).parse(N)}static parseInline(N,R){return new Qs(R).parseInline(N)}parse(N,R=!0){let A="";for(let z=0;z<N.length;z++){const j=N[z];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[j.type]){const de=j,Te=this.options.extensions.renderers[de.type].call({parser:this},de);if(Te!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(de.type)){A+=Te||"";continue}}const re=j;switch(re.type){case"space":{A+=this.renderer.space(re);continue}case"hr":{A+=this.renderer.hr(re);continue}case"heading":{A+=this.renderer.heading(re);continue}case"code":{A+=this.renderer.code(re);continue}case"table":{A+=this.renderer.table(re);continue}case"blockquote":{A+=this.renderer.blockquote(re);continue}case"list":{A+=this.renderer.list(re);continue}case"html":{A+=this.renderer.html(re);continue}case"paragraph":{A+=this.renderer.paragraph(re);continue}case"text":{let de=re,Te=this.renderer.text(de);for(;z+1<N.length&&N[z+1].type==="text";)de=N[++z],Te+=`
`+this.renderer.text(de);R?A+=this.renderer.paragraph({type:"paragraph",raw:Te,text:Te,tokens:[{type:"text",raw:Te,text:Te}]}):A+=Te;continue}default:{const de='Token with "'+re.type+'" type was not found.';if(this.options.silent)return console.error(de),"";throw new Error(de)}}}return A}parseInline(N,R){R=R||this.renderer;let A="";for(let z=0;z<N.length;z++){const j=N[z];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[j.type]){const de=this.options.extensions.renderers[j.type].call({parser:this},j);if(de!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(j.type)){A+=de||"";continue}}const re=j;switch(re.type){case"escape":{A+=R.text(re);break}case"html":{A+=R.html(re);break}case"link":{A+=R.link(re);break}case"image":{A+=R.image(re);break}case"strong":{A+=R.strong(re);break}case"em":{A+=R.em(re);break}case"codespan":{A+=R.codespan(re);break}case"br":{A+=R.br(re);break}case"del":{A+=R.del(re);break}case"text":{A+=R.text(re);break}default:{const de='Token with "'+re.type+'" type was not found.';if(this.options.silent)return console.error(de),"";throw new Error(de)}}}return A}}class Rh{options;constructor(N){this.options=N||e.defaults}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(N){return N}postprocess(N){return N}processAllTokens(N){return N}}class Xa{defaults=t();options=this.setOptions;parse=this.parseMarkdown(hi.lex,Qs.parse);parseInline=this.parseMarkdown(hi.lexInline,Qs.parseInline);Parser=Qs;Renderer=Ns;TextRenderer=nd;Lexer=hi;Tokenizer=y;Hooks=Rh;constructor(...N){this.use(...N)}walkTokens(N,R){let A=[];for(const z of N)switch(A=A.concat(R.call(this,z)),z.type){case"table":{const j=z;for(const re of j.header)A=A.concat(this.walkTokens(re.tokens,R));for(const re of j.rows)for(const de of re)A=A.concat(this.walkTokens(de.tokens,R));break}case"list":{const j=z;A=A.concat(this.walkTokens(j.items,R));break}default:{const j=z;this.defaults.extensions?.childTokens?.[j.type]?this.defaults.extensions.childTokens[j.type].forEach(re=>{const de=j[re].flat(1/0);A=A.concat(this.walkTokens(de,R))}):j.tokens&&(A=A.concat(this.walkTokens(j.tokens,R)))}}return A}use(...N){const R=this.defaults.extensions||{renderers:{},childTokens:{}};return N.forEach(A=>{const z={...A};if(z.async=this.defaults.async||z.async||!1,A.extensions&&(A.extensions.forEach(j=>{if(!j.name)throw new Error("extension name required");if("renderer"in j){const re=R.renderers[j.name];re?R.renderers[j.name]=function(...de){let Te=j.renderer.apply(this,de);return Te===!1&&(Te=re.apply(this,de)),Te}:R.renderers[j.name]=j.renderer}if("tokenizer"in j){if(!j.level||j.level!=="block"&&j.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const re=R[j.level];re?re.unshift(j.tokenizer):R[j.level]=[j.tokenizer],j.start&&(j.level==="block"?R.startBlock?R.startBlock.push(j.start):R.startBlock=[j.start]:j.level==="inline"&&(R.startInline?R.startInline.push(j.start):R.startInline=[j.start]))}"childTokens"in j&&j.childTokens&&(R.childTokens[j.name]=j.childTokens)}),z.extensions=R),A.renderer){const j=this.defaults.renderer||new Ns(this.defaults);for(const re in A.renderer){if(!(re in j))throw new Error(`renderer '${re}' does not exist`);if(["options","parser"].includes(re))continue;const de=re,Te=A.renderer[de],Ne=j[de];j[de]=(...at)=>{let Rt=Te.apply(j,at);return Rt===!1&&(Rt=Ne.apply(j,at)),Rt||""}}z.renderer=j}if(A.tokenizer){const j=this.defaults.tokenizer||new y(this.defaults);for(const re in A.tokenizer){if(!(re in j))throw new Error(`tokenizer '${re}' does not exist`);if(["options","rules","lexer"].includes(re))continue;const de=re,Te=A.tokenizer[de],Ne=j[de];j[de]=(...at)=>{let Rt=Te.apply(j,at);return Rt===!1&&(Rt=Ne.apply(j,at)),Rt}}z.tokenizer=j}if(A.hooks){const j=this.defaults.hooks||new Rh;for(const re in A.hooks){if(!(re in j))throw new Error(`hook '${re}' does not exist`);if(re==="options")continue;const de=re,Te=A.hooks[de],Ne=j[de];Rh.passThroughHooks.has(re)?j[de]=at=>{if(this.defaults.async)return Promise.resolve(Te.call(j,at)).then(Ci=>Ne.call(j,Ci));const Rt=Te.call(j,at);return Ne.call(j,Rt)}:j[de]=(...at)=>{let Rt=Te.apply(j,at);return Rt===!1&&(Rt=Ne.apply(j,at)),Rt}}z.hooks=j}if(A.walkTokens){const j=this.defaults.walkTokens,re=A.walkTokens;z.walkTokens=function(de){let Te=[];return Te.push(re.call(this,de)),j&&(Te=Te.concat(j.call(this,de))),Te}}this.defaults={...this.defaults,...z}}),this}setOptions(N){return this.defaults={...this.defaults,...N},this}lexer(N,R){return hi.lex(N,R??this.defaults)}parser(N,R){return Qs.parse(N,R??this.defaults)}parseMarkdown(N,R){return(z,j)=>{const re={...j},de={...this.defaults,...re},Te=this.onError(!!de.silent,!!de.async);if(this.defaults.async===!0&&re.async===!1)return Te(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof z>"u"||z===null)return Te(new Error("marked(): input parameter is undefined or null"));if(typeof z!="string")return Te(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(z)+", string expected"));if(de.hooks&&(de.hooks.options=de),de.async)return Promise.resolve(de.hooks?de.hooks.preprocess(z):z).then(Ne=>N(Ne,de)).then(Ne=>de.hooks?de.hooks.processAllTokens(Ne):Ne).then(Ne=>de.walkTokens?Promise.all(this.walkTokens(Ne,de.walkTokens)).then(()=>Ne):Ne).then(Ne=>R(Ne,de)).then(Ne=>de.hooks?de.hooks.postprocess(Ne):Ne).catch(Te);try{de.hooks&&(z=de.hooks.preprocess(z));let Ne=N(z,de);de.hooks&&(Ne=de.hooks.processAllTokens(Ne)),de.walkTokens&&this.walkTokens(Ne,de.walkTokens);let at=R(Ne,de);return de.hooks&&(at=de.hooks.postprocess(at)),at}catch(Ne){return Te(Ne)}}}onError(N,R){return A=>{if(A.message+=`
Please report this to https://github.com/markedjs/marked.`,N){const z="<p>An error occurred:</p><pre>"+d(A.message+"",!0)+"</pre>";return R?Promise.resolve(z):z}if(R)return Promise.reject(A);throw A}}}const Kl=new Xa;function si(rt,N){return Kl.parse(rt,N)}si.options=si.setOptions=function(rt){return Kl.setOptions(rt),si.defaults=Kl.defaults,i(si.defaults),si},si.getDefaults=t,si.defaults=e.defaults,si.use=function(...rt){return Kl.use(...rt),si.defaults=Kl.defaults,i(si.defaults),si},si.walkTokens=function(rt,N){return Kl.walkTokens(rt,N)},si.parseInline=Kl.parseInline,si.Parser=Qs,si.parser=Qs.parse,si.Renderer=Ns,si.TextRenderer=nd,si.Lexer=hi,si.lexer=hi.lex,si.Tokenizer=y,si.Hooks=Rh,si.parse=si;const Sn=si.options,sd=si.setOptions,mk=si.use,ly=si.walkTokens,Vm=si.parseInline,cy=si,dy=Qs.parse,_k=hi.lex;e.Hooks=Rh,e.Lexer=hi,e.Marked=Xa,e.Parser=Qs,e.Renderer=Ns,e.TextRenderer=nd,e.Tokenizer=y,e.getDefaults=t,e.lexer=_k,e.marked=si,e.options=Sn,e.parse=cy,e.parseInline=Vm,e.parser=dy,e.setOptions=sd,e.use=mk,e.walkTokens=ly})})();Zn.Hooks||exports.Hooks;Zn.Lexer||exports.Lexer;Zn.Marked||exports.Marked;Zn.Parser||exports.Parser;var Oz=Zn.Renderer||exports.Renderer;Zn.TextRenderer||exports.TextRenderer;Zn.Tokenizer||exports.Tokenizer;var ole=Zn.defaults||exports.defaults;Zn.getDefaults||exports.getDefaults;var ex=Zn.lexer||exports.lexer;Zn.marked||exports.marked;Zn.options||exports.options;var Fz=Zn.parse||exports.parse;Zn.parseInline||exports.parseInline;var rle=Zn.parser||exports.parser;Zn.setOptions||exports.setOptions;Zn.use||exports.use;Zn.walkTokens||exports.walkTokens;function ale(s){return JSON.stringify(s,lle)}function jE(s){let e=JSON.parse(s);return e=ZE(e),e}function lle(s,e){return e instanceof RegExp?{$mid:2,source:e.source,flags:e.flags}:e}function ZE(s,e=0){if(!s||e>200)return s;if(typeof s=="object"){switch(s.$mid){case 1:return Se.revive(s);case 2:return new RegExp(s.source,s.flags);case 17:return new Date(s.source)}if(s instanceof PL||s instanceof Uint8Array)return s;if(Array.isArray(s))for(let t=0;t<s.length;++t)s[t]=ZE(s[t],e+1);else for(const t in s)Object.hasOwnProperty.call(s,t)&&(s[t]=ZE(s[t],e+1))}return s}const yD=Object.freeze({image:({href:s,title:e,text:t})=>{let i=[],n=[];return s&&({href:s,dimensions:i}=sle(s),n.push(`src="${Ey(s)}"`)),t&&n.push(`alt="${Ey(t)}"`),e&&n.push(`title="${Ey(e)}"`),i.length&&(n=n.concat(i)),"<img "+n.join(" ")+">"},paragraph({tokens:s}){return`<p>${this.parser.parseInline(s)}</p>`},link({href:s,title:e,tokens:t}){let i=this.parser.parseInline(t);return typeof s!="string"?"":(s===i&&(i=CD(i)),e=typeof e=="string"?Ey(CD(e)):"",s=CD(s),s=s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${s}" title="${e||s}" draggable="false">${i}</a>`)}});function tx(s,e={},t={}){const i=new Z;let n=!1;const o=M2(e),r=function(m){let _;try{_=jE(decodeURIComponent(m))}catch{}return _?(_=YH(_,b=>{if(s.uris&&s.uris[b])return Se.revive(s.uris[b])}),encodeURIComponent(JSON.stringify(_))):m},a=function(m,_){const b=s.uris&&s.uris[m];let v=Se.revive(b);return _?m.startsWith(Fe.data+":")?m:(v||(v=Se.parse(m)),vL.uriToBrowserUri(v).toString(!0)):!v||Se.parse(m).toString()===v.toString()?m:(v.query&&(v=v.with({query:r(v.query)})),v.toString())},l=new Oz;l.image=yD.image,l.link=yD.link,l.paragraph=yD.paragraph;const c=[],d=[];if(e.codeBlockRendererSync?l.code=({text:m,lang:_})=>{const b=$E.nextId(),v=e.codeBlockRendererSync(wB(_),m);return d.push([b,v]),`<div class="code" data-code="${b}">${K_(m)}</div>`}:e.codeBlockRenderer&&(l.code=({text:m,lang:_})=>{const b=$E.nextId(),v=e.codeBlockRenderer(wB(_),m);return c.push(v.then(C=>[b,C])),`<div class="code" data-code="${b}">${K_(m)}</div>`}),e.actionHandler){const m=function(v){let C=v.target;if(!(C.tagName!=="A"&&(C=C.parentElement,!C||C.tagName!=="A")))try{let y=C.dataset.href;y&&(s.baseUri&&(y=wD(Se.from(s.baseUri),y)),e.actionHandler.callback(y,v))}catch(y){Oe(y)}finally{v.preventDefault()}},_=e.actionHandler.disposables.add(new tt(o,"click")),b=e.actionHandler.disposables.add(new tt(o,"auxclick"));e.actionHandler.disposables.add(se.any(_.event,b.event)(v=>{const C=new jr(ke(o),v);!C.leftButton&&!C.middleButton||m(C)})),e.actionHandler.disposables.add(U(o,"keydown",v=>{const C=new Ft(v);!C.equals(10)&&!C.equals(3)||m(C)}))}s.supportHtml||(l.html=({text:m})=>e.sanitizerOptions?.replaceWithPlaintext?K_(m):(s.isTrusted?m.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?m:""),t.renderer=l;let h=s.value??"";h.length>1e5&&(h=`${h.substr(0,1e5)}`),s.supportThemeIcons&&(h=Zae(h));let u;if(e.fillInIncompleteTokens){const m={...ole,...t},_=ex(h,m),b=yle(_);u=rle(b,m)}else u=Fz(h,{...t,async:!1});s.supportThemeIcons&&(u=Kd(u).map(_=>typeof _=="string"?_:_.outerHTML).join(""));const f=new DOMParser().parseFromString(KE({isTrusted:s.isTrusted,...e.sanitizerOptions},u),"text/html");if(f.body.querySelectorAll("img, audio, video, source").forEach(m=>{const _=m.getAttribute("src");if(_){let b=_;try{s.baseUri&&(b=wD(Se.from(s.baseUri),b))}catch{}if(m.setAttribute("src",a(b,!0)),e.remoteImageIsAllowed){const v=Se.parse(b);v.scheme!==Fe.file&&v.scheme!==Fe.data&&!e.remoteImageIsAllowed(v)&&m.replaceWith(te("",void 0,m.outerHTML))}}}),f.body.querySelectorAll("a").forEach(m=>{const _=m.getAttribute("href");if(m.setAttribute("href",""),!_||/^data:|javascript:/i.test(_)||/^command:/i.test(_)&&!s.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(_))m.replaceWith(...m.childNodes);else{let b=a(_,!1);s.baseUri&&(b=wD(Se.from(s.baseUri),_)),m.dataset.href=b}}),o.innerHTML=KE({isTrusted:s.isTrusted,...e.sanitizerOptions},f.body.innerHTML),c.length>0)Promise.all(c).then(m=>{if(n)return;const _=new Map(m),b=o.querySelectorAll("div[data-code]");for(const v of b){const C=_.get(v.dataset.code??"");C&&yn(v,C)}e.asyncRenderCallback?.()});else if(d.length>0){const m=new Map(d),_=o.querySelectorAll("div[data-code]");for(const b of _){const v=m.get(b.dataset.code??"");v&&yn(b,v)}}if(e.asyncRenderCallback)for(const m of o.getElementsByTagName("img")){const _=i.add(U(m,"load",()=>{_.dispose(),e.asyncRenderCallback()}))}return{element:o,dispose:()=>{n=!0,i.dispose()}}}function wB(s){if(!s)return"";const e=s.split(/[\s+|:|,|\{|\?]/,1);return e.length?e[0]:s}function wD(s,e){return/^\w[\w\d+.-]*:/.test(e)?e:s.path.endsWith("/")?vB(s,e).toString():vB(JL(s),e).toString()}const cle=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function KE(s,e){const{config:t,allowedSchemes:i}=hle(s),n=new Z;n.add(SB("uponSanitizeAttribute",(o,r)=>{if(r.attrName==="style"||r.attrName==="class"){if(o.tagName==="SPAN"){if(r.attrName==="style"){r.keepAttr=/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z]+)+\));)?(border-radius:[0-9]+px;)?$/.test(r.attrValue);return}else if(r.attrName==="class"){r.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(r.attrValue);return}}r.keepAttr=!1;return}else if(o.tagName==="INPUT"&&o.attributes.getNamedItem("type")?.value==="checkbox"){if(r.attrName==="type"&&r.attrValue==="checkbox"||r.attrName==="disabled"||r.attrName==="checked"){r.keepAttr=!0;return}r.keepAttr=!1}})),n.add(SB("uponSanitizeElement",(o,r)=>{if(r.tagName==="input"&&(o.attributes.getNamedItem("type")?.value==="checkbox"?o.setAttribute("disabled",""):s.replaceWithPlaintext||o.remove()),s.replaceWithPlaintext&&!r.allowedTags[r.tagName]&&r.tagName!=="body"&&o.parentElement){let a,l;if(r.tagName==="#comment")a=`<!--${o.textContent}-->`;else{const u=cle.includes(r.tagName),g=o.attributes.length?" "+Array.from(o.attributes).map(f=>`${f.name}="${f.value}"`).join(" "):"";a=`<${r.tagName}${g}>`,u||(l=`</${r.tagName}>`)}const c=document.createDocumentFragment(),d=o.parentElement.ownerDocument.createTextNode(a);c.appendChild(d);const h=l?o.parentElement.ownerDocument.createTextNode(l):void 0;for(;o.firstChild;)c.appendChild(o.firstChild);h&&c.appendChild(h),o.parentElement.replaceChild(c,o)}})),n.add(Ute(i));try{return U6(e,{...t,RETURN_TRUSTED_TYPE:!0})}finally{n.dispose()}}const dle=["align","autoplay","alt","checked","class","colspan","controls","data-code","data-href","disabled","draggable","height","href","loop","muted","playsinline","poster","rowspan","src","style","target","title","type","width","start"];function hle(s){const e=[Fe.http,Fe.https,Fe.mailto,Fe.data,Fe.file,Fe.vscodeFileResource,Fe.vscodeRemote,Fe.vscodeRemoteResource];return s.isTrusted&&e.push(Fe.command),{config:{ALLOWED_TAGS:s.allowedTags??[...$te],ALLOWED_ATTR:dle,ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:e}}function ule(s){return typeof s=="string"?s:gle(s)}function gle(s,e){let t=s.value??"";t.length>1e5&&(t=`${t.substr(0,1e5)}`);const i=Fz(t,{async:!1,renderer:mle.value}).replace(/&(#\d+|[a-zA-Z]+);/g,n=>fle.get(n)??n);return KE({isTrusted:!1},i).toString()}const fle=new Map([["&quot;",'"'],["&nbsp;"," "],["&amp;","&"],["&#39;","'"],["&lt;","<"],["&gt;",">"]]);function ple(){const s=new Oz;return s.code=({text:e})=>e,s.blockquote=({text:e})=>e+`
`,s.html=e=>"",s.heading=function({tokens:e}){return this.parser.parseInline(e)+`
`},s.hr=()=>"",s.list=function({items:e}){return e.map(t=>this.listitem(t)).join(`
`)+`
`},s.listitem=({text:e})=>e+`
`,s.paragraph=function({tokens:e}){return this.parser.parseInline(e)+`
`},s.table=function({header:e,rows:t}){return e.map(i=>this.tablecell(i)).join(" ")+`
`+t.map(i=>i.map(n=>this.tablecell(n)).join(" ")).join(`
`)+`
`},s.tablerow=({text:e})=>e,s.tablecell=function({tokens:e}){return this.parser.parseInline(e)},s.strong=({text:e})=>e,s.em=({text:e})=>e,s.codespan=({text:e})=>e,s.br=e=>`
`,s.del=({text:e})=>e,s.image=e=>"",s.text=({text:e})=>e,s.link=({text:e})=>e,s}const mle=new Fa(s=>ple());function d0(s){let e="";return s.forEach(t=>{e+=t.raw}),e}function Bz(s){if(s.tokens)for(let e=s.tokens.length-1;e>=0;e--){const t=s.tokens[e];if(t.type==="text"){const i=t.raw.split(`
`),n=i[i.length-1];if(n.includes("`"))return Sle(s);if(n.includes("**"))return Tle(s);if(n.match(/\*\w/))return Lle(s);if(n.match(/(^|\s)__\w/))return Ele(s);if(n.match(/(^|\s)_\w/))return xle(s);if(_le(n)||ble(n)&&s.tokens.slice(0,e).some(o=>o.type==="text"&&o.raw.match(/\[[^\]]*$/))){const o=s.tokens.slice(e+1);return o[0]?.type==="link"&&o[1]?.type==="text"&&o[1].raw.match(/^ *"[^"]*$/)||n.match(/^[^"]* +"[^"]*$/)?Dle(s):kle(s)}else if(n.match(/(^|\s)\[\w*/))return Ile(s)}}}function _le(s){return!!s.match(/(^|\s)\[.*\]\(\w*/)}function ble(s){return!!s.match(/^[^\[]*\]\([^\)]*$/)}function vle(s){const e=s.items[s.items.length-1],t=e.tokens?e.tokens[e.tokens.length-1]:void 0;let i;if(t?.type==="text"&&!("inRawBlock"in e)&&(i=Bz(t)),!i||i.type!=="paragraph")return;const n=d0(s.items.slice(0,-1)),o=e.raw.match(/^(\s*(-|\d+\.|\*) +)/)?.[0];if(!o)return;const r=o+d0(e.tokens.slice(0,-1))+i.raw,a=ex(n+r)[0];if(a.type==="list")return a}const Cle=3;function yle(s){for(let e=0;e<Cle;e++){const t=wle(s);if(t)s=t;else break}return s}function wle(s){let e,t;for(e=0;e<s.length;e++){const i=s[e];if(i.type==="paragraph"&&i.raw.match(/(\n|^)\|/)){t=Nle(s.slice(e));break}if(e===s.length-1&&i.type==="list"){const n=vle(i);if(n){t=[n];break}}if(e===s.length-1&&i.type==="paragraph"){const n=Bz(i);if(n){t=[n];break}}}if(t){const i=[...s.slice(0,e),...t];return i.links=s.links,i}return null}function Sle(s){return Ch(s,"`")}function Lle(s){return Ch(s,"*")}function xle(s){return Ch(s,"_")}function kle(s){return Ch(s,")")}function Dle(s){return Ch(s,'")')}function Ile(s){return Ch(s,"](https://microsoft.com)")}function Tle(s){return Ch(s,"**")}function Ele(s){return Ch(s,"__")}function Ch(s,e){const t=d0(Array.isArray(s)?s:[s]);return ex(t+e)[0]}function Nle(s){const e=d0(s),t=e.split(`
`);let i,n=!1;for(let o=0;o<t.length;o++){const r=t[o].trim();if(typeof i>"u"&&r.match(/^\s*\|/)){const a=r.match(/(\|[^\|]+)(?=\||$)/g);a&&(i=a.length)}else if(typeof i=="number")if(r.match(/^\s*\|/)){if(o!==t.length-1)return;n=!0}else return}if(typeof i=="number"&&i>0){const o=n?t.slice(0,-1).join(`
`):e,r=!!o.match(/\|\s*$/),a=o+(r?"":"|")+`
|${" --- |".repeat(i)}`;return ex(a)}}function SB(s,e){return $6(s,e),Ce(()=>j6(s))}class Pi{static{this.defaultTokenMetadata=(32768|2<<24)>>>0}static createEmpty(e,t){const i=Pi.defaultTokenMetadata,n=new Uint32Array(2);return n[0]=e.length,n[1]=i,new Pi(n,e,t)}static createFromTextAndMetadata(e,t){let i=0,n="";const o=new Array;for(const{text:r,metadata:a}of e)o.push(i+r.length,a),i+=r.length,n+=r;return new Pi(new Uint32Array(o),n,t)}constructor(e,t,i){this._lineTokensBrand=void 0,this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this.languageIdCodec=i}equals(e){return e instanceof Pi?this.slicedEquals(e,0,this._tokensCount):!1}slicedEquals(e,t,i){if(this._text!==e._text||this._tokensCount!==e._tokensCount)return!1;const n=t<<1,o=n+(i<<1);for(let r=n;r<o;r++)if(this._tokens[r]!==e._tokens[r])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[(e<<1)+1]}getLanguageId(e){const t=this._tokens[(e<<1)+1],i=Bs.getLanguageId(t);return this.languageIdCodec.decodeLanguageId(i)}getStandardTokenType(e){const t=this._tokens[(e<<1)+1];return Bs.getTokenType(t)}getForeground(e){const t=this._tokens[(e<<1)+1];return Bs.getForeground(t)}getClassName(e){const t=this._tokens[(e<<1)+1];return Bs.getClassNameFromMetadata(t)}getInlineStyle(e,t){const i=this._tokens[(e<<1)+1];return Bs.getInlineStyleFromMetadata(i,t)}getPresentation(e){const t=this._tokens[(e<<1)+1];return Bs.getPresentationFromMetadata(t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return Pi.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,i){return new U2(this,e,t,i)}static convertToEndOffset(e,t){const n=(e.length>>>1)-1;for(let o=0;o<n;o++)e[o<<1]=e[o+1<<1];e[n<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let i=0,n=(e.length>>>1)-1;for(;i<n;){const o=i+Math.floor((n-i)/2),r=e[o<<1];if(r===t)return o+1;r<t?i=o+1:r>t&&(n=o)}return i}withInserted(e){if(e.length===0)return this;let t=0,i=0,n="";const o=new Array;let r=0;for(;;){const a=t<this._tokensCount?this._tokens[t<<1]:-1,l=i<e.length?e[i]:null;if(a!==-1&&(l===null||a<=l.offset)){n+=this._text.substring(r,a);const c=this._tokens[(t<<1)+1];o.push(n.length,c),t++,r=a}else if(l){if(l.offset>r){n+=this._text.substring(r,l.offset);const c=this._tokens[(t<<1)+1];o.push(n.length,c),r=l.offset}n+=l.text,o.push(n.length,l.tokenMetadata),i++}else break}return new Pi(new Uint32Array(o),n,this.languageIdCodec)}getTokenText(e){const t=this.getStartOffset(e),i=this.getEndOffset(e);return this._text.substring(t,i)}forEach(e){const t=this.getCount();for(let i=0;i<t;i++)e(i)}}class U2{constructor(e,t,i,n){this._source=e,this._startOffset=t,this._endOffset=i,this._deltaOffset=n,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this.languageIdCodec=e.languageIdCodec,this._tokensCount=0;for(let o=this._firstTokenIndex,r=e.getCount();o<r&&!(e.getStartOffset(o)>=i);o++)this._tokensCount++}getMetadata(e){return this._source.getMetadata(this._firstTokenIndex+e)}getLanguageId(e){return this._source.getLanguageId(this._firstTokenIndex+e)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof U2?this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getStandardTokenType(e){return this._source.getStandardTokenType(this._firstTokenIndex+e)}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){const t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}getPresentation(e){return this._source.getPresentation(this._firstTokenIndex+e)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}getTokenText(e){const t=this._firstTokenIndex+e,i=this._source.getStartOffset(t),n=this._source.getEndOffset(t);let o=this._source.getTokenText(t);return i<this._startOffset&&(o=o.substring(this._startOffset-i)),n>this._endOffset&&(o=o.substring(0,o.length-(n-this._endOffset))),o}forEach(e){for(let t=0;t<this.getCount();t++)e(t)}}function Rle(s,e){const t=e.lineNumber;if(!s.tokenization.isCheapToTokenize(t))return;s.tokenization.forceTokenization(t);const i=s.tokenization.getLineTokens(t),n=i.findTokenIndexAtOffset(e.column-1);return i.getStandardTokenType(n)}const Ap=new class{clone(){return this}equals(s){return this===s}};function $2(s,e){return new FP([new zb(0,"",s)],e)}function ix(s,e){const t=new Uint32Array(2);return t[0]=0,t[1]=(s<<0|0|0|32768|2<<24)>>>0,new _L(t,e===null?Ap:e)}const LB={getInitialState:()=>Ap,tokenizeEncoded:(s,e,t)=>ix(0,t)};async function Mle(s,e,t){if(!t)return xB(e,s.languageIdCodec,LB);const i=await mi.getOrCreate(t);return xB(e,s.languageIdCodec,i||LB)}function Ale(s,e,t,i,n,o,r){let a="<div>",l=i,c=0,d=!0;for(let h=0,u=e.getCount();h<u;h++){const g=e.getEndOffset(h);if(g<=i)continue;let f="";for(;l<g&&l<n;l++){const m=s.charCodeAt(l);switch(m){case 9:{let _=o-(l+c)%o;for(c+=_-1;_>0;)r&&d?(f+="&#160;",d=!1):(f+=" ",d=!0),_--;break}case 60:f+="&lt;",d=!1;break;case 62:f+="&gt;",d=!1;break;case 38:f+="&amp;",d=!1;break;case 0:f+="&#00;",d=!1;break;case 65279:case 8232:case 8233:case 133:f+="",d=!1;break;case 13:f+="&#8203",d=!1;break;case 32:r&&d?(f+="&#160;",d=!1):(f+=" ",d=!0);break;default:f+=String.fromCharCode(m),d=!1}}if(a+=`<span style="${e.getInlineStyle(h,t)}">${f}</span>`,g>n||l>=n)break}return a+="</div>",a}function xB(s,e,t){let i='<div class="monaco-tokenized-source">';const n=Fl(s);let o=t.getInitialState();for(let r=0,a=n.length;r<a;r++){const l=n[r];r>0&&(i+="<br/>");const c=t.tokenizeEncoded(l,!0,o);Pi.convertToEndOffset(c.tokens,l.length);const h=new Pi(c.tokens,l,e).inflate();let u=0;for(let g=0,f=h.getCount();g<f;g++){const m=h.getClassName(g),_=h.getEndOffset(g);i+=`<span class="${m}">${K_(l.substring(u,_))}</span>`,u=_}o=c.endState}return i+="</div>",i}var Ple=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},kB=function(s,e){return function(t,i){e(t,i,s)}},qE;let zc=class{static{qE=this}static{this._ttpTokenizer=Gc("tokenizeToString",{createHTML(e){return e}})}constructor(e,t,i){this._options=e,this._languageService=t,this._openerService=i,this._onDidRenderAsync=new O,this.onDidRenderAsync=this._onDidRenderAsync.event}dispose(){this._onDidRenderAsync.dispose()}render(e,t,i){if(!e)return{element:document.createElement("span"),dispose:()=>{}};const n=new Z,o=n.add(tx(e,{...this._getRenderOptions(e,n),...t},i));return o.element.classList.add("rendered-markdown"),{element:o.element,dispose:()=>n.dispose()}}_getRenderOptions(e,t){return{codeBlockRenderer:async(i,n)=>{let o;i?o=this._languageService.getLanguageIdByLanguageName(i):this._options.editor&&(o=this._options.editor.getModel()?.getLanguageId()),o||(o=Cs);const r=await Mle(this._languageService,n,o),a=document.createElement("span");if(a.innerHTML=qE._ttpTokenizer?.createHTML(r)??r,this._options.editor){const l=this._options.editor.getOption(50);wn(a,l)}else this._options.codeBlockFontFamily&&(a.style.fontFamily=this._options.codeBlockFontFamily);return this._options.codeBlockFontSize!==void 0&&(a.style.fontSize=this._options.codeBlockFontSize),a},asyncRenderCallback:()=>this._onDidRenderAsync.fire(),actionHandler:{callback:i=>j2(this._openerService,i,e.isTrusted),disposables:t}}}};zc=qE=Ple([kB(1,ni),kB(2,Ys)],zc);async function j2(s,e,t){try{return await s.open(e,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:Ole(t)})}catch(i){return Oe(i),!1}}function Ole(s){return s===!0?!0:s&&Array.isArray(s.enabledCommands)?s.enabledCommands:!1}const vo=Je("accessibilityService"),TC=new le("accessibilityModeEnabled",!1),DB=2e4;let ou,Uw,GE,$w,YE;function Fle(s){ou=document.createElement("div"),ou.className="monaco-aria-container";const e=()=>{const i=document.createElement("div");return i.className="monaco-alert",i.setAttribute("role","alert"),i.setAttribute("aria-atomic","true"),ou.appendChild(i),i};Uw=e(),GE=e();const t=()=>{const i=document.createElement("div");return i.className="monaco-status",i.setAttribute("aria-live","polite"),i.setAttribute("aria-atomic","true"),ou.appendChild(i),i};$w=t(),YE=t(),s.appendChild(ou)}function Ls(s){ou&&(Uw.textContent!==s?(Cn(GE),h0(Uw,s)):(Cn(Uw),h0(GE,s)))}function Nl(s){ou&&($w.textContent!==s?(Cn(YE),h0($w,s)):(Cn($w),h0(YE,s)))}function h0(s,e){Cn(s),e.length>DB&&(e=e.substr(0,DB)),s.textContent=e,s.style.visibility="hidden",s.style.visibility="visible"}var Ble=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Qm=function(s,e){return function(t,i){e(t,i,s)}};const el=te;let XE=class extends Yo{get _targetWindow(){return ke(this._target.targetElements[0])}get _targetDocumentElement(){return ke(this._target.targetElements[0]).document.documentElement}get isDisposed(){return this._isDisposed}get isMouseIn(){return this._lockMouseTracker.isMouseIn}get domNode(){return this._hover.containerDomNode}get onDispose(){return this._onDispose.event}get onRequestLayout(){return this._onRequestLayout.event}get anchor(){return this._hoverPosition===2?0:1}get x(){return this._x}get y(){return this._y}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked!==e&&(this._isLocked=e,this._hoverContainer.classList.toggle("locked",this._isLocked))}constructor(e,t,i,n,o,r){super(),this._keybindingService=t,this._configurationService=i,this._openerService=n,this._instantiationService=o,this._accessibilityService=r,this._messageListeners=new Z,this._isDisposed=!1,this._forcePosition=!1,this._x=0,this._y=0,this._isLocked=!1,this._enableFocusTraps=!1,this._addedFocusTrap=!1,this._onDispose=this._register(new O),this._onRequestLayout=this._register(new O),this._linkHandler=e.linkHandler||(u=>j2(this._openerService,u,Pa(e.content)?e.content.isTrusted:void 0)),this._target="targetElements"in e.target?e.target:new Wle(e.target),this._hoverPointer=e.appearance?.showPointer?el("div.workbench-hover-pointer"):void 0,this._hover=this._register(new R2),this._hover.containerDomNode.classList.add("workbench-hover","fadeIn"),e.appearance?.compact&&this._hover.containerDomNode.classList.add("workbench-hover","compact"),e.appearance?.skipFadeInAnimation&&this._hover.containerDomNode.classList.add("skip-fade-in"),e.additionalClasses&&this._hover.containerDomNode.classList.add(...e.additionalClasses),e.position?.forcePosition&&(this._forcePosition=!0),e.trapFocus&&(this._enableFocusTraps=!0),this._hoverPosition=e.position?.hoverPosition??3,this.onmousedown(this._hover.containerDomNode,u=>u.stopPropagation()),this.onkeydown(this._hover.containerDomNode,u=>{u.equals(9)&&this.dispose()}),this._register(U(this._targetWindow,"blur",()=>this.dispose()));const a=el("div.hover-row.markdown-hover"),l=el("div.hover-contents");if(typeof e.content=="string")l.textContent=e.content,l.style.whiteSpace="pre-wrap";else if(tn(e.content))l.appendChild(e.content),l.classList.add("html-hover-contents");else{const u=e.content,g=this._instantiationService.createInstance(zc,{codeBlockFontFamily:this._configurationService.getValue("editor").fontFamily||vs.fontFamily}),{element:f}=g.render(u,{actionHandler:{callback:m=>this._linkHandler(m),disposables:this._messageListeners},asyncRenderCallback:()=>{l.classList.add("code-hover-contents"),this.layout(),this._onRequestLayout.fire()}});l.appendChild(f)}if(a.appendChild(l),this._hover.contentsDomNode.appendChild(a),e.actions&&e.actions.length>0){const u=el("div.hover-row.status-bar"),g=el("div.actions");e.actions.forEach(f=>{const m=this._keybindingService.lookupKeybinding(f.commandId),_=m?m.getLabel():null;XL.render(g,{label:f.label,commandId:f.commandId,run:b=>{f.run(b),this.dispose()},iconClass:f.iconClass},_)}),u.appendChild(g),this._hover.containerDomNode.appendChild(u)}this._hoverContainer=el("div.workbench-hover-container"),this._hoverPointer&&this._hoverContainer.appendChild(this._hoverPointer),this._hoverContainer.appendChild(this._hover.containerDomNode);let c;if(e.actions&&e.actions.length>0?c=!1:e.persistence?.hideOnHover===void 0?c=typeof e.content=="string"||Pa(e.content)&&!e.content.value.includes("](")&&!e.content.value.includes("</a>"):c=e.persistence.hideOnHover,e.appearance?.showHoverHint){const u=el("div.hover-row.status-bar"),g=el("div.info");g.textContent=p("hoverhint","Hold {0} key to mouse over",Qe?"Option":"Alt"),u.appendChild(g),this._hover.containerDomNode.appendChild(u)}const d=[...this._target.targetElements];c||d.push(this._hoverContainer);const h=this._register(new IB(d));if(this._register(h.onMouseOut(()=>{this._isLocked||this.dispose()})),c){const u=[...this._target.targetElements,this._hoverContainer];this._lockMouseTracker=this._register(new IB(u)),this._register(this._lockMouseTracker.onMouseOut(()=>{this._isLocked||this.dispose()}))}else this._lockMouseTracker=h}addFocusTrap(){if(!this._enableFocusTraps||this._addedFocusTrap)return;this._addedFocusTrap=!0;const e=this._hover.containerDomNode,t=this.findLastFocusableChild(this._hover.containerDomNode);if(t){const i=e2(this._hoverContainer,el("div")),n=X(this._hoverContainer,el("div"));i.tabIndex=0,n.tabIndex=0,this._register(U(n,"focus",o=>{e.focus(),o.preventDefault()})),this._register(U(i,"focus",o=>{t.focus(),o.preventDefault()}))}}findLastFocusableChild(e){if(e.hasChildNodes())for(let t=0;t<e.childNodes.length;t++){const i=e.childNodes.item(e.childNodes.length-t-1);if(i.nodeType===i.ELEMENT_NODE){const o=i;if(typeof o.tabIndex=="number"&&o.tabIndex>=0)return o}const n=this.findLastFocusableChild(i);if(n)return n}}render(e){e.appendChild(this._hoverContainer);const i=this._hoverContainer.contains(this._hoverContainer.ownerDocument.activeElement)&&yz(this._configurationService.getValue("accessibility.verbosity.hover")===!0&&this._accessibilityService.isScreenReaderOptimized(),this._keybindingService.lookupKeybinding("editor.action.accessibleView")?.getAriaLabel());i&&Nl(i),this.layout(),this.addFocusTrap()}layout(){this._hover.containerDomNode.classList.remove("right-aligned"),this._hover.contentsDomNode.style.maxHeight="";const e=d=>{const h=Y6(d),u=d.getBoundingClientRect();return{top:u.top*h,bottom:u.bottom*h,right:u.right*h,left:u.left*h}},t=this._target.targetElements.map(d=>e(d)),{top:i,right:n,bottom:o,left:r}=t[0],a=n-r,l=o-i,c={top:i,right:n,bottom:o,left:r,width:a,height:l,center:{x:r+a/2,y:i+l/2}};if(this.adjustHorizontalHoverPosition(c),this.adjustVerticalHoverPosition(c),this.adjustHoverMaxHeight(c),this._hoverContainer.style.padding="",this._hoverContainer.style.margin="",this._hoverPointer){switch(this._hoverPosition){case 1:c.left+=3,c.right+=3,this._hoverContainer.style.paddingLeft="3px",this._hoverContainer.style.marginLeft="-3px";break;case 0:c.left-=3,c.right-=3,this._hoverContainer.style.paddingRight="3px",this._hoverContainer.style.marginRight="-3px";break;case 2:c.top+=3,c.bottom+=3,this._hoverContainer.style.paddingTop="3px",this._hoverContainer.style.marginTop="-3px";break;case 3:c.top-=3,c.bottom-=3,this._hoverContainer.style.paddingBottom="3px",this._hoverContainer.style.marginBottom="-3px";break}c.center.x=c.left+a/2,c.center.y=c.top+l/2}this.computeXCordinate(c),this.computeYCordinate(c),this._hoverPointer&&(this._hoverPointer.classList.remove("top"),this._hoverPointer.classList.remove("left"),this._hoverPointer.classList.remove("right"),this._hoverPointer.classList.remove("bottom"),this.setHoverPointerPosition(c)),this._hover.onContentsChanged()}computeXCordinate(e){const t=this._hover.containerDomNode.clientWidth+2;this._target.x!==void 0?this._x=this._target.x:this._hoverPosition===1?this._x=e.right:this._hoverPosition===0?this._x=e.left-t:(this._hoverPointer?this._x=e.center.x-this._hover.containerDomNode.clientWidth/2:this._x=e.left,this._x+t>=this._targetDocumentElement.clientWidth&&(this._hover.containerDomNode.classList.add("right-aligned"),this._x=Math.max(this._targetDocumentElement.clientWidth-t-2,this._targetDocumentElement.clientLeft))),this._x<this._targetDocumentElement.clientLeft&&(this._x=e.left+2)}computeYCordinate(e){this._target.y!==void 0?this._y=this._target.y:this._hoverPosition===3?this._y=e.top:this._hoverPosition===2?this._y=e.bottom-2:this._hoverPointer?this._y=e.center.y+this._hover.containerDomNode.clientHeight/2:this._y=e.bottom,this._y>this._targetWindow.innerHeight&&(this._y=e.bottom)}adjustHorizontalHoverPosition(e){if(this._target.x!==void 0)return;const t=this._hoverPointer?3:0;if(this._forcePosition){const i=t+2;this._hoverPosition===1?this._hover.containerDomNode.style.maxWidth=`${this._targetDocumentElement.clientWidth-e.right-i}px`:this._hoverPosition===0&&(this._hover.containerDomNode.style.maxWidth=`${e.left-i}px`);return}this._hoverPosition===1?this._targetDocumentElement.clientWidth-e.right<this._hover.containerDomNode.clientWidth+t&&(e.left>=this._hover.containerDomNode.clientWidth+t?this._hoverPosition=0:this._hoverPosition=2):this._hoverPosition===0&&(e.left<this._hover.containerDomNode.clientWidth+t&&(this._targetDocumentElement.clientWidth-e.right>=this._hover.containerDomNode.clientWidth+t?this._hoverPosition=1:this._hoverPosition=2),e.left-this._hover.containerDomNode.clientWidth-t<=this._targetDocumentElement.clientLeft&&(this._hoverPosition=1))}adjustVerticalHoverPosition(e){if(this._target.y!==void 0||this._forcePosition)return;const t=this._hoverPointer?3:0;this._hoverPosition===3?e.top-this._hover.containerDomNode.clientHeight-t<0&&(this._hoverPosition=2):this._hoverPosition===2&&e.bottom+this._hover.containerDomNode.clientHeight+t>this._targetWindow.innerHeight&&(this._hoverPosition=3)}adjustHoverMaxHeight(e){let t=this._targetWindow.innerHeight/2;if(this._forcePosition){const i=(this._hoverPointer?3:0)+2;this._hoverPosition===3?t=Math.min(t,e.top-i):this._hoverPosition===2&&(t=Math.min(t,this._targetWindow.innerHeight-e.bottom-i))}if(this._hover.containerDomNode.style.maxHeight=`${t}px`,this._hover.contentsDomNode.clientHeight<this._hover.contentsDomNode.scrollHeight){const i=`${this._hover.scrollbar.options.verticalScrollbarSize}px`;this._hover.contentsDomNode.style.paddingRight!==i&&(this._hover.contentsDomNode.style.paddingRight=i)}}setHoverPointerPosition(e){if(this._hoverPointer)switch(this._hoverPosition){case 0:case 1:{this._hoverPointer.classList.add(this._hoverPosition===0?"right":"left");const t=this._hover.containerDomNode.clientHeight;t>e.height?this._hoverPointer.style.top=`${e.center.y-(this._y-t)-3}px`:this._hoverPointer.style.top=`${Math.round(t/2)-3}px`;break}case 3:case 2:{this._hoverPointer.classList.add(this._hoverPosition===3?"bottom":"top");const t=this._hover.containerDomNode.clientWidth;let i=Math.round(t/2)-3;const n=this._x+i;(n<e.left||n>e.right)&&(i=e.center.x-this._x-3),this._hoverPointer.style.left=`${i}px`;break}}}focus(){this._hover.containerDomNode.focus()}dispose(){this._isDisposed||(this._onDispose.fire(),this._hoverContainer.remove(),this._messageListeners.dispose(),this._target.dispose(),super.dispose()),this._isDisposed=!0}};XE=Ble([Qm(1,yt),Qm(2,Ke),Qm(3,Ys),Qm(4,ye),Qm(5,vo)],XE);class IB extends Yo{get onMouseOut(){return this._onMouseOut.event}get isMouseIn(){return this._isMouseIn}constructor(e){super(),this._elements=e,this._isMouseIn=!0,this._onMouseOut=this._register(new O),this._elements.forEach(t=>this.onmouseover(t,()=>this._onTargetMouseOver(t))),this._elements.forEach(t=>this.onmouseleave(t,()=>this._onTargetMouseLeave(t)))}_onTargetMouseOver(e){this._isMouseIn=!0,this._clearEvaluateMouseStateTimeout(e)}_onTargetMouseLeave(e){this._isMouseIn=!1,this._evaluateMouseState(e)}_evaluateMouseState(e){this._clearEvaluateMouseStateTimeout(e),this._mouseTimeout=ke(e).setTimeout(()=>this._fireIfMouseOutside(),0)}_clearEvaluateMouseStateTimeout(e){this._mouseTimeout&&(ke(e).clearTimeout(this._mouseTimeout),this._mouseTimeout=void 0)}_fireIfMouseOutside(){this._isMouseIn||this._onMouseOut.fire()}}class Wle{constructor(e){this._element=e,this.targetElements=[this._element]}dispose(){}}var Wn;(function(s){function e(o,r){if(o.start>=r.end||r.start>=o.end)return{start:0,end:0};const a=Math.max(o.start,r.start),l=Math.min(o.end,r.end);return l-a<=0?{start:0,end:0}:{start:a,end:l}}s.intersect=e;function t(o){return o.end-o.start<=0}s.isEmpty=t;function i(o,r){return!t(e(o,r))}s.intersects=i;function n(o,r){const a=[],l={start:o.start,end:Math.min(r.start,o.end)},c={start:Math.max(r.end,o.start),end:o.end};return t(l)||a.push(l),t(c)||a.push(c),a}s.relativeComplement=n})(Wn||(Wn={}));function Hle(s){const e=s;return!!e&&typeof e.x=="number"&&typeof e.y=="number"}var Ad;(function(s){s[s.AVOID=0]="AVOID",s[s.ALIGN=1]="ALIGN"})(Ad||(Ad={}));function xf(s,e,t){const i=t.mode===Ad.ALIGN?t.offset:t.offset+t.size,n=t.mode===Ad.ALIGN?t.offset+t.size:t.offset;return t.position===0?e<=s-i?i:e<=n?n-e:Math.max(s-e,0):e<=n?n-e:e<=s-i?i:0}class u0 extends B{static{this.BUBBLE_UP_EVENTS=["click","keydown","focus","blur"]}static{this.BUBBLE_DOWN_EVENTS=["click"]}constructor(e,t){super(),this.container=null,this.useFixedPosition=!1,this.useShadowDOM=!1,this.delegate=null,this.toDisposeOnClean=B.None,this.toDisposeOnSetContainer=B.None,this.shadowRoot=null,this.shadowRootHostElement=null,this.view=te(".context-view"),ds(this.view),this.setContainer(e,t),this._register(Ce(()=>this.setContainer(null,1)))}setContainer(e,t){this.useFixedPosition=t!==1;const i=this.useShadowDOM;if(this.useShadowDOM=t===3,!(e===this.container&&i===this.useShadowDOM)&&(this.container&&(this.toDisposeOnSetContainer.dispose(),this.view.remove(),this.shadowRoot&&(this.shadowRoot=null,this.shadowRootHostElement?.remove(),this.shadowRootHostElement=null),this.container=null),e)){if(this.container=e,this.useShadowDOM){this.shadowRootHostElement=te(".shadow-root-host"),this.container.appendChild(this.shadowRootHostElement),this.shadowRoot=this.shadowRootHostElement.attachShadow({mode:"open"});const o=document.createElement("style");o.textContent=Vle,this.shadowRoot.appendChild(o),this.shadowRoot.appendChild(this.view),this.shadowRoot.appendChild(te("slot"))}else this.container.appendChild(this.view);const n=new Z;u0.BUBBLE_UP_EVENTS.forEach(o=>{n.add(gi(this.container,o,r=>{this.onDOMEvent(r,!1)}))}),u0.BUBBLE_DOWN_EVENTS.forEach(o=>{n.add(gi(this.container,o,r=>{this.onDOMEvent(r,!0)},!0))}),this.toDisposeOnSetContainer=n}}show(e){this.isVisible()&&this.hide(),Cn(this.view),this.view.className="context-view monaco-component",this.view.style.top="0px",this.view.style.left="0px",this.view.style.zIndex=`${2575+(e.layer??0)}`,this.view.style.position=this.useFixedPosition?"fixed":"absolute",ro(this.view),this.toDisposeOnClean=e.render(this.view)||B.None,this.delegate=e,this.doLayout(),this.delegate.focus?.()}getViewElement(){return this.view}layout(){if(this.isVisible()){if(this.delegate.canRelayout===!1&&!(Oa&&ZP.pointerEvents)){this.hide();return}this.delegate?.layout?.(),this.doLayout()}}doLayout(){if(!this.isVisible())return;const e=this.delegate.getAnchor();let t;if(tn(e)){const u=Si(e),g=Y6(e);t={top:u.top*g,left:u.left*g,width:u.width*g,height:u.height*g}}else Hle(e)?t={top:e.y,left:e.x,width:e.width||1,height:e.height||2}:t={top:e.posy,left:e.posx,width:2,height:2};const i=io(this.view),n=Cc(this.view),o=this.delegate.anchorPosition||0,r=this.delegate.anchorAlignment||0,a=this.delegate.anchorAxisAlignment||0;let l,c;const d=C_();if(a===0){const u={offset:t.top-d.pageYOffset,size:t.height,position:o===0?0:1},g={offset:t.left,size:t.width,position:r===0?0:1,mode:Ad.ALIGN};l=xf(d.innerHeight,n,u)+d.pageYOffset,Wn.intersects({start:l,end:l+n},{start:u.offset,end:u.offset+u.size})&&(g.mode=Ad.AVOID),c=xf(d.innerWidth,i,g)}else{const u={offset:t.left,size:t.width,position:r===0?0:1},g={offset:t.top,size:t.height,position:o===0?0:1,mode:Ad.ALIGN};c=xf(d.innerWidth,i,u),Wn.intersects({start:c,end:c+i},{start:u.offset,end:u.offset+u.size})&&(g.mode=Ad.AVOID),l=xf(d.innerHeight,n,g)+d.pageYOffset}this.view.classList.remove("top","bottom","left","right"),this.view.classList.add(o===0?"bottom":"top"),this.view.classList.add(r===0?"left":"right"),this.view.classList.toggle("fixed",this.useFixedPosition);const h=Si(this.container);this.view.style.top=`${l-(this.useFixedPosition?Si(this.view).top:h.top)}px`,this.view.style.left=`${c-(this.useFixedPosition?Si(this.view).left:h.left)}px`,this.view.style.width="initial"}hide(e){const t=this.delegate;this.delegate=null,t?.onHide&&t.onHide(e),this.toDisposeOnClean.dispose(),ds(this.view)}isVisible(){return!!this.delegate}onDOMEvent(e,t){this.delegate&&(this.delegate.onDOMEvent?this.delegate.onDOMEvent(e,ke(e).document.activeElement):t&&!Ji(e.target,this.container)&&this.hide())}dispose(){this.hide(),super.dispose()}}const Vle=`
	:host {
		all: initial; /* 1st rule so subsequent properties are reset. */
	}

	.codicon[class*='codicon-'] {
		font: normal normal normal 16px/1 codicon;
		display: inline-block;
		text-decoration: none;
		text-rendering: auto;
		text-align: center;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}

	:host {
		font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "HelveticaNeue-Light", system-ui, "Ubuntu", "Droid Sans", sans-serif;
	}

	:host-context(.mac) { font-family: -apple-system, BlinkMacSystemFont, sans-serif; }
	:host-context(.mac:lang(zh-Hans)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", sans-serif; }
	:host-context(.mac:lang(zh-Hant)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", sans-serif; }
	:host-context(.mac:lang(ja)) { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic Pro", sans-serif; }
	:host-context(.mac:lang(ko)) { font-family: -apple-system, BlinkMacSystemFont, "Nanum Gothic", "Apple SD Gothic Neo", "AppleGothic", sans-serif; }

	:host-context(.windows) { font-family: "Segoe WPC", "Segoe UI", sans-serif; }
	:host-context(.windows:lang(zh-Hans)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft YaHei", sans-serif; }
	:host-context(.windows:lang(zh-Hant)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft Jhenghei", sans-serif; }
	:host-context(.windows:lang(ja)) { font-family: "Segoe WPC", "Segoe UI", "Yu Gothic UI", "Meiryo UI", sans-serif; }
	:host-context(.windows:lang(ko)) { font-family: "Segoe WPC", "Segoe UI", "Malgun Gothic", "Dotom", sans-serif; }

	:host-context(.linux) { font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hans)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans SC", "Source Han Sans CN", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hant)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans TC", "Source Han Sans TW", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ja)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans J", "Source Han Sans JP", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ko)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans K", "Source Han Sans JR", "Source Han Sans", "UnDotum", "FBaekmuk Gulim", sans-serif; }
`;var zle=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Ule=function(s,e){return function(t,i){e(t,i,s)}};let g0=class extends B{constructor(e){super(),this.layoutService=e,this.contextView=this._register(new u0(this.layoutService.mainContainer,1)),this.layout(),this._register(e.onDidLayoutContainer(()=>this.layout()))}showContextView(e,t,i){let n;t?t===this.layoutService.getContainer(ke(t))?n=1:i?n=3:n=2:n=1,this.contextView.setContainer(t??this.layoutService.activeContainer,n),this.contextView.show(e);const o={close:()=>{this.openContextView===o&&this.hideContextView()}};return this.openContextView=o,o}layout(){this.contextView.layout()}hideContextView(e){this.contextView.hide(e),this.openContextView=void 0}};g0=zle([Ule(0,vh)],g0);class $le extends g0{getContextViewElement(){return this.contextView.getViewElement()}}class jle{constructor(e,t,i){this.hoverDelegate=e,this.target=t,this.fadeInAnimation=i}async update(e,t,i){if(this._cancellationTokenSource&&(this._cancellationTokenSource.dispose(!0),this._cancellationTokenSource=void 0),this.isDisposed)return;let n;if(e===void 0||zs(e)||tn(e))n=e;else if(!Hb(e.markdown))n=e.markdown??e.markdownNotSupportedFallback;else{this._hoverWidget||this.show(p("iconLabel.loading","Loading..."),t,i),this._cancellationTokenSource=new li;const o=this._cancellationTokenSource.token;if(n=await e.markdown(o),n===void 0&&(n=e.markdownNotSupportedFallback),this.isDisposed||o.isCancellationRequested)return}this.show(n,t,i)}show(e,t,i){const n=this._hoverWidget;if(this.hasContent(e)){const o={content:e,target:this.target,actions:i?.actions,linkHandler:i?.linkHandler,trapFocus:i?.trapFocus,appearance:{showPointer:this.hoverDelegate.placement==="element",skipFadeInAnimation:!this.fadeInAnimation||!!n,showHoverHint:i?.appearance?.showHoverHint},position:{hoverPosition:2}};this._hoverWidget=this.hoverDelegate.showHover(o,t)}n?.dispose()}hasContent(e){return e?Pa(e)?!!e.value:!0:!1}get isDisposed(){return this._hoverWidget?.isDisposed}dispose(){this._hoverWidget?.dispose(),this._cancellationTokenSource?.dispose(!0),this._cancellationTokenSource=void 0}}var Zle=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Jm=function(s,e){return function(t,i){e(t,i,s)}};let QE=class extends B{constructor(e,t,i,n,o){super(),this._instantiationService=e,this._keybindingService=i,this._layoutService=n,this._accessibilityService=o,this._managedHovers=new Map,t.onDidShowContextMenu(()=>this.hideHover()),this._contextViewHandler=this._register(new g0(this._layoutService))}showHover(e,t,i){if(TB(this._currentHoverOptions)===TB(e)||this._currentHover&&this._currentHoverOptions?.persistence?.sticky)return;this._currentHoverOptions=e,this._lastHoverOptions=e;const n=e.trapFocus||this._accessibilityService.isScreenReaderOptimized(),o=Rn();i||(n&&o?o.classList.contains("monaco-hover")||(this._lastFocusedElementBeforeOpen=o):this._lastFocusedElementBeforeOpen=void 0);const r=new Z,a=this._instantiationService.createInstance(XE,e);if(e.persistence?.sticky&&(a.isLocked=!0),a.onDispose(()=>{this._currentHover?.domNode&&Q6(this._currentHover.domNode)&&this._lastFocusedElementBeforeOpen?.focus(),this._currentHoverOptions===e&&(this._currentHoverOptions=void 0),r.dispose()},void 0,r),!e.container){const l=tn(e.target)?e.target:e.target.targetElements[0];e.container=this._layoutService.getContainer(ke(l))}if(this._contextViewHandler.showContextView(new Kle(a,t),e.container),a.onRequestLayout(()=>this._contextViewHandler.layout(),void 0,r),e.persistence?.sticky)r.add(U(ke(e.container).document,ee.MOUSE_DOWN,l=>{Ji(l.target,a.domNode)||this.doHideHover()}));else{if("targetElements"in e.target)for(const c of e.target.targetElements)r.add(U(c,ee.CLICK,()=>this.hideHover()));else r.add(U(e.target,ee.CLICK,()=>this.hideHover()));const l=Rn();if(l){const c=ke(l).document;r.add(U(l,ee.KEY_DOWN,d=>this._keyDown(d,a,!!e.persistence?.hideOnKeyDown))),r.add(U(c,ee.KEY_DOWN,d=>this._keyDown(d,a,!!e.persistence?.hideOnKeyDown))),r.add(U(l,ee.KEY_UP,d=>this._keyUp(d,a))),r.add(U(c,ee.KEY_UP,d=>this._keyUp(d,a)))}}if("IntersectionObserver"in Nt){const l=new IntersectionObserver(d=>this._intersectionChange(d,a),{threshold:0}),c="targetElements"in e.target?e.target.targetElements[0]:e.target;l.observe(c),r.add(Ce(()=>l.disconnect()))}return this._currentHover=a,a}hideHover(){this._currentHover?.isLocked||!this._currentHoverOptions||this.doHideHover()}doHideHover(){this._currentHover=void 0,this._currentHoverOptions=void 0,this._contextViewHandler.hideContextView()}_intersectionChange(e,t){e[e.length-1].isIntersecting||t.dispose()}showAndFocusLastHover(){this._lastHoverOptions&&this.showHover(this._lastHoverOptions,!0,!0)}_keyDown(e,t,i){if(e.key==="Alt"){t.isLocked=!0;return}const n=new Ft(e);this._keybindingService.resolveKeyboardEvent(n).getSingleModifierDispatchChords().some(r=>!!r)||this._keybindingService.softDispatch(n,n.target).kind!==0||i&&(!this._currentHoverOptions?.trapFocus||e.key!=="Tab")&&(this.hideHover(),this._lastFocusedElementBeforeOpen?.focus())}_keyUp(e,t){e.key==="Alt"&&(t.isLocked=!1,t.isMouseIn||(this.hideHover(),this._lastFocusedElementBeforeOpen?.focus()))}setupManagedHover(e,t,i,n){t.setAttribute("custom-hover","true"),t.title!==""&&(console.warn("HTML element already has a title attribute, which will conflict with the custom hover. Please remove the title attribute."),console.trace("Stack trace:",t.title),t.title="");let o,r;const a=(C,y)=>{const w=r!==void 0;C&&(r?.dispose(),r=void 0),y&&(o?.dispose(),o=void 0),w&&(e.onDidHideHover?.(),r=void 0)},l=(C,y,w,x)=>new ia(async()=>{(!r||r.isDisposed)&&(r=new jle(e,w||t,C>0),await r.update(typeof i=="function"?i():i,y,{...n,trapFocus:x}))},C);let c=!1;const d=U(t,ee.MOUSE_DOWN,()=>{c=!0,a(!0,!0)},!0),h=U(t,ee.MOUSE_UP,()=>{c=!1},!0),u=U(t,ee.MOUSE_LEAVE,C=>{c=!1,a(!1,C.fromElement===t)},!0),g=C=>{if(o)return;const y=new Z,w={targetElements:[t],dispose:()=>{}};if(e.placement===void 0||e.placement==="mouse"){const x=L=>{w.x=L.x+10,tn(L.target)&&EB(L.target,t)!==t&&a(!0,!0)};y.add(U(t,ee.MOUSE_MOVE,x,!0))}o=y,!(tn(C.target)&&EB(C.target,t)!==t)&&y.add(l(e.delay,!1,w))},f=U(t,ee.MOUSE_OVER,g,!0),m=()=>{if(c||o)return;const C={targetElements:[t],dispose:()=>{}},y=new Z,w=()=>a(!0,!0);y.add(U(t,ee.BLUR,w,!0)),y.add(l(e.delay,!1,C)),o=y};let _;const b=t.tagName.toLowerCase();b!=="input"&&b!=="textarea"&&(_=U(t,ee.FOCUS,m,!0));const v={show:C=>{a(!1,!0),l(0,C,void 0,C)},hide:()=>{a(!0,!0)},update:async(C,y)=>{i=C,await r?.update(i,void 0,y)},dispose:()=>{this._managedHovers.delete(t),f.dispose(),u.dispose(),d.dispose(),h.dispose(),_?.dispose(),a(!0,!0)}};return this._managedHovers.set(t,v),v}showManagedHover(e){const t=this._managedHovers.get(e);t&&t.show(!0)}dispose(){this._managedHovers.forEach(e=>e.dispose()),super.dispose()}};QE=Zle([Jm(0,ye),Jm(1,bo),Jm(2,yt),Jm(3,vh),Jm(4,vo)],QE);function TB(s){if(s!==void 0)return s?.id??s}class Kle{get anchorPosition(){return this._hover.anchor}constructor(e,t=!1){this._hover=e,this._focus=t,this.layer=1}render(e){return this._hover.render(e),this._focus&&this._hover.focus(),this._hover}getAnchor(){return{x:this._hover.x,y:this._hover.y}}layout(){this._hover.layout()}}function EB(s,e){for(e=e??ke(s).document.body;!s.hasAttribute("custom-hover")&&s!==e;)s=s.parentElement;return s}nt(Vl,QE,1);kr((s,e)=>{const t=s.getColor(az);t&&(e.addRule(`.monaco-workbench .workbench-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-workbench .workbench-hover hr { border-top: 1px solid ${t.transparent(.5)}; }`))});const EC=Je("IWorkspaceEditService");class Z2{constructor(e){this.metadata=e}static convert(e){return e.edits.map(t=>{if(qd.is(t))return qd.lift(t);if(Xf.is(t))return Xf.lift(t);throw new Error("Unsupported edit")})}}class qd extends Z2{static is(e){return e instanceof qd?!0:dn(e)&&Se.isUri(e.resource)&&dn(e.textEdit)}static lift(e){return e instanceof qd?e:new qd(e.resource,e.textEdit,e.versionId,e.metadata)}constructor(e,t,i=void 0,n){super(n),this.resource=e,this.textEdit=t,this.versionId=i}}class Xf extends Z2{static is(e){return e instanceof Xf?!0:dn(e)&&(!!e.newResource||!!e.oldResource)}static lift(e){return e instanceof Xf?e:new Xf(e.oldResource,e.newResource,e.options,e.metadata)}constructor(e,t,i={},n){super(n),this.oldResource=e,this.newResource=t,this.options=i}}const xn={enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,renderGutterMenu:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{showMoves:!1,showEmptyDecorations:!0,useTrueInlineView:!1},hideUnchangedRegions:{enabled:!1,contextLineCount:3,minimumLineCount:3,revealLineCount:20},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1,renderSideBySideInlineBreakpoint:900,useInlineViewWhenSpaceIsLimited:!0,compactMode:!1},NC=Object.freeze({id:"editor",order:5,type:"object",title:p("editorConfigurationTitle","Editor"),scope:5}),f0={...NC,properties:{"editor.tabSize":{type:"number",default:Vn.tabSize,minimum:1,markdownDescription:p("tabSize","The number of spaces a tab is equal to. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.indentSize":{anyOf:[{type:"string",enum:["tabSize"]},{type:"number",minimum:1}],default:"tabSize",markdownDescription:p("indentSize",'The number of spaces used for indentation or `"tabSize"` to use the value from `#editor.tabSize#`. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.')},"editor.insertSpaces":{type:"boolean",default:Vn.insertSpaces,markdownDescription:p("insertSpaces","Insert spaces when pressing `Tab`. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.detectIndentation":{type:"boolean",default:Vn.detectIndentation,markdownDescription:p("detectIndentation","Controls whether {0} and {1} will be automatically detected when a file is opened based on the file contents.","`#editor.tabSize#`","`#editor.insertSpaces#`")},"editor.trimAutoWhitespace":{type:"boolean",default:Vn.trimAutoWhitespace,description:p("trimAutoWhitespace","Remove trailing auto inserted whitespace.")},"editor.largeFileOptimizations":{type:"boolean",default:Vn.largeFileOptimizations,description:p("largeFileOptimizations","Special handling for large files to disable certain memory intensive features.")},"editor.wordBasedSuggestions":{enum:["off","currentDocument","matchingDocuments","allDocuments"],default:"matchingDocuments",enumDescriptions:[p("wordBasedSuggestions.off","Turn off Word Based Suggestions."),p("wordBasedSuggestions.currentDocument","Only suggest words from the active document."),p("wordBasedSuggestions.matchingDocuments","Suggest words from all open documents of the same language."),p("wordBasedSuggestions.allDocuments","Suggest words from all open documents.")],description:p("wordBasedSuggestions","Controls whether completions should be computed based on words in the document and from which documents they are computed.")},"editor.semanticHighlighting.enabled":{enum:[!0,!1,"configuredByTheme"],enumDescriptions:[p("semanticHighlighting.true","Semantic highlighting enabled for all color themes."),p("semanticHighlighting.false","Semantic highlighting disabled for all color themes."),p("semanticHighlighting.configuredByTheme","Semantic highlighting is configured by the current color theme's `semanticHighlighting` setting.")],default:"configuredByTheme",description:p("semanticHighlighting.enabled","Controls whether the semanticHighlighting is shown for the languages that support it.")},"editor.stablePeek":{type:"boolean",default:!1,markdownDescription:p("stablePeek","Keep peek editors open even when double-clicking their content or when hitting `Escape`.")},"editor.maxTokenizationLineLength":{type:"integer",default:2e4,description:p("maxTokenizationLineLength","Lines above this length will not be tokenized for performance reasons")},"editor.experimental.asyncTokenization":{type:"boolean",default:!0,description:p("editor.experimental.asyncTokenization","Controls whether the tokenization should happen asynchronously on a web worker."),tags:["experimental"]},"editor.experimental.asyncTokenizationLogging":{type:"boolean",default:!1,description:p("editor.experimental.asyncTokenizationLogging","Controls whether async tokenization should be logged. For debugging only.")},"editor.experimental.asyncTokenizationVerification":{type:"boolean",default:!1,description:p("editor.experimental.asyncTokenizationVerification","Controls whether async tokenization should be verified against legacy background tokenization. Might slow down tokenization. For debugging only."),tags:["experimental"]},"editor.experimental.treeSitterTelemetry":{type:"boolean",default:!1,markdownDescription:p("editor.experimental.treeSitterTelemetry","Controls whether tree sitter parsing should be turned on and telemetry collected. Setting `editor.experimental.preferTreeSitter` for specific languages will take precedence."),tags:["experimental"]},"editor.language.brackets":{type:["array","null"],default:null,description:p("schema.brackets","Defines the bracket symbols that increase or decrease the indentation."),items:{type:"array",items:[{type:"string",description:p("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:p("schema.closeBracket","The closing bracket character or string sequence.")}]}},"editor.language.colorizedBracketPairs":{type:["array","null"],default:null,description:p("schema.colorizedBracketPairs","Defines the bracket pairs that are colorized by their nesting level if bracket pair colorization is enabled."),items:{type:"array",items:[{type:"string",description:p("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:p("schema.closeBracket","The closing bracket character or string sequence.")}]}},"diffEditor.maxComputationTime":{type:"number",default:xn.maxComputationTime,description:p("maxComputationTime","Timeout in milliseconds after which diff computation is cancelled. Use 0 for no timeout.")},"diffEditor.maxFileSize":{type:"number",default:xn.maxFileSize,description:p("maxFileSize","Maximum file size in MB for which to compute diffs. Use 0 for no limit.")},"diffEditor.renderSideBySide":{type:"boolean",default:xn.renderSideBySide,description:p("sideBySide","Controls whether the diff editor shows the diff side by side or inline.")},"diffEditor.renderSideBySideInlineBreakpoint":{type:"number",default:xn.renderSideBySideInlineBreakpoint,description:p("renderSideBySideInlineBreakpoint","If the diff editor width is smaller than this value, the inline view is used.")},"diffEditor.useInlineViewWhenSpaceIsLimited":{type:"boolean",default:xn.useInlineViewWhenSpaceIsLimited,description:p("useInlineViewWhenSpaceIsLimited","If enabled and the editor width is too small, the inline view is used.")},"diffEditor.renderMarginRevertIcon":{type:"boolean",default:xn.renderMarginRevertIcon,description:p("renderMarginRevertIcon","When enabled, the diff editor shows arrows in its glyph margin to revert changes.")},"diffEditor.renderGutterMenu":{type:"boolean",default:xn.renderGutterMenu,description:p("renderGutterMenu","When enabled, the diff editor shows a special gutter for revert and stage actions.")},"diffEditor.ignoreTrimWhitespace":{type:"boolean",default:xn.ignoreTrimWhitespace,description:p("ignoreTrimWhitespace","When enabled, the diff editor ignores changes in leading or trailing whitespace.")},"diffEditor.renderIndicators":{type:"boolean",default:xn.renderIndicators,description:p("renderIndicators","Controls whether the diff editor shows +/- indicators for added/removed changes.")},"diffEditor.codeLens":{type:"boolean",default:xn.diffCodeLens,description:p("codeLens","Controls whether the editor shows CodeLens.")},"diffEditor.wordWrap":{type:"string",enum:["off","on","inherit"],default:xn.diffWordWrap,markdownEnumDescriptions:[p("wordWrap.off","Lines will never wrap."),p("wordWrap.on","Lines will wrap at the viewport width."),p("wordWrap.inherit","Lines will wrap according to the {0} setting.","`#editor.wordWrap#`")]},"diffEditor.diffAlgorithm":{type:"string",enum:["legacy","advanced"],default:xn.diffAlgorithm,markdownEnumDescriptions:[p("diffAlgorithm.legacy","Uses the legacy diffing algorithm."),p("diffAlgorithm.advanced","Uses the advanced diffing algorithm.")],tags:["experimental"]},"diffEditor.hideUnchangedRegions.enabled":{type:"boolean",default:xn.hideUnchangedRegions.enabled,markdownDescription:p("hideUnchangedRegions.enabled","Controls whether the diff editor shows unchanged regions.")},"diffEditor.hideUnchangedRegions.revealLineCount":{type:"integer",default:xn.hideUnchangedRegions.revealLineCount,markdownDescription:p("hideUnchangedRegions.revealLineCount","Controls how many lines are used for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.minimumLineCount":{type:"integer",default:xn.hideUnchangedRegions.minimumLineCount,markdownDescription:p("hideUnchangedRegions.minimumLineCount","Controls how many lines are used as a minimum for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.contextLineCount":{type:"integer",default:xn.hideUnchangedRegions.contextLineCount,markdownDescription:p("hideUnchangedRegions.contextLineCount","Controls how many lines are used as context when comparing unchanged regions."),minimum:1},"diffEditor.experimental.showMoves":{type:"boolean",default:xn.experimental.showMoves,markdownDescription:p("showMoves","Controls whether the diff editor should show detected code moves.")},"diffEditor.experimental.showEmptyDecorations":{type:"boolean",default:xn.experimental.showEmptyDecorations,description:p("showEmptyDecorations","Controls whether the diff editor shows empty decorations to see where characters got inserted or deleted.")},"diffEditor.experimental.useTrueInlineView":{type:"boolean",default:xn.experimental.useTrueInlineView,description:p("useTrueInlineView","If enabled and the editor uses the inline view, word changes are rendered inline.")}}};function qle(s){return typeof s.type<"u"||typeof s.anyOf<"u"}for(const s of vf){const e=s.schema;if(typeof e<"u")if(qle(e))f0.properties[`editor.${s.name}`]=e;else for(const t in e)Object.hasOwnProperty.call(e,t)&&(f0.properties[t]=e[t])}let Ny=null;function Wz(){return Ny===null&&(Ny=Object.create(null),Object.keys(f0.properties).forEach(s=>{Ny[s]=!0})),Ny}function Gle(s){return Wz()[`editor.${s}`]||!1}function Yle(s){return Wz()[`diffEditor.${s}`]||!1}const Xle=ci.as(na.Configuration);Xle.registerConfiguration(f0);class ri{static insert(e,t){return{range:new k(e.lineNumber,e.column,e.lineNumber,e.column),text:t,forceMoveMarkers:!0}}static delete(e){return{range:e,text:null}}static replace(e,t){return{range:e,text:t}}static replaceMove(e,t){return{range:e,text:t,forceMoveMarkers:!0}}}function Ry(s){return Object.isFrozen(s)?s:fQ(s)}class vn{static createEmptyModel(e){return new vn({},[],[],void 0,e)}constructor(e,t,i,n,o){this._contents=e,this._keys=t,this._overrides=i,this.raw=n,this.logService=o,this.overrideConfigurations=new Map}get rawConfiguration(){if(!this._rawConfiguration)if(this.raw?.length){const e=this.raw.map(t=>{if(t instanceof vn)return t;const i=new Qle("",this.logService);return i.parseRaw(t),i.configurationModel});this._rawConfiguration=e.reduce((t,i)=>i===t?i:t.merge(i),e[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?s3(this.contents,e):this.contents}inspect(e,t){const i=this;return{get value(){return Ry(i.rawConfiguration.getValue(e))},get override(){return t?Ry(i.rawConfiguration.getOverrideValue(e,t)):void 0},get merged(){return Ry(t?i.rawConfiguration.override(t).getValue(e):i.rawConfiguration.getValue(e))},get overrides(){const n=[];for(const{contents:o,identifiers:r,keys:a}of i.rawConfiguration.overrides){const l=new vn(o,a,[],void 0,i.logService).getValue(e);l!==void 0&&n.push({identifiers:r,value:l})}return n.length?Ry(n):void 0}}}getOverrideValue(e,t){const i=this.getContentsForOverrideIdentifer(t);return i?e?s3(i,e):i:void 0}override(e){let t=this.overrideConfigurations.get(e);return t||(t=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,t)),t}merge(...e){const t=lc(this.contents),i=lc(this.overrides),n=[...this.keys],o=this.raw?.length?[...this.raw]:[this];for(const r of e)if(o.push(...r.raw?.length?r.raw:[r]),!r.isEmpty()){this.mergeContents(t,r.contents);for(const a of r.overrides){const[l]=i.filter(c=>ii(c.identifiers,a.identifiers));l?(this.mergeContents(l.contents,a.contents),l.keys.push(...a.keys),l.keys=Pc(l.keys)):i.push(lc(a))}for(const a of r.keys)n.indexOf(a)===-1&&n.push(a)}return new vn(t,n,i,o.every(r=>r instanceof vn)?void 0:o,this.logService)}createOverrideConfigurationModel(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||typeof t!="object"||!Object.keys(t).length)return this;const i={};for(const n of Pc([...Object.keys(this.contents),...Object.keys(t)])){let o=this.contents[n];const r=t[n];r&&(typeof o=="object"&&typeof r=="object"?(o=lc(o),this.mergeContents(o,r)):o=r),i[n]=o}return new vn(i,this.keys,this.overrides,void 0,this.logService)}mergeContents(e,t){for(const i of Object.keys(t)){if(i in e&&dn(e[i])&&dn(t[i])){this.mergeContents(e[i],t[i]);continue}e[i]=lc(t[i])}}getContentsForOverrideIdentifer(e){let t=null,i=null;const n=o=>{o&&(i?this.mergeContents(i,o):i=lc(o))};for(const o of this.overrides)o.identifiers.length===1&&o.identifiers[0]===e?t=o.contents:o.identifiers.includes(e)&&n(o.contents);return n(t),i}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}setValue(e,t){this.updateValue(e,t,!1)}removeValue(e){const t=this.keys.indexOf(e);t!==-1&&(this.keys.splice(t,1),ine(this.contents,e),oh.test(e)&&this.overrides.splice(this.overrides.findIndex(i=>ii(i.identifiers,q1(e))),1))}updateValue(e,t,i){if(yV(this.contents,e,t,n=>this.logService.error(n)),i=i||this.keys.indexOf(e)===-1,i&&this.keys.push(e),oh.test(e)){const n=q1(e),o={identifiers:n,keys:Object.keys(this.contents[e]),contents:fE(this.contents[e],a=>this.logService.error(a))},r=this.overrides.findIndex(a=>ii(a.identifiers,n));r!==-1?this.overrides[r]=o:this.overrides.push(o)}}}class Qle{constructor(e,t){this._name=e,this.logService=t,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[]}get configurationModel(){return this._configurationModel||vn.createEmptyModel(this.logService)}parseRaw(e,t){this._raw=e;const{contents:i,keys:n,overrides:o,restricted:r,hasExcludedProperties:a}=this.doParseRaw(e,t);this._configurationModel=new vn(i,n,o,a?[e]:void 0,this.logService),this._restrictedConfigurations=r||[]}doParseRaw(e,t){const i=ci.as(na.Configuration).getConfigurationProperties(),n=this.filter(e,i,!0,t);e=n.raw;const o=fE(e,l=>this.logService.error(`Conflict in settings file ${this._name}: ${l}`)),r=Object.keys(e),a=this.toOverrides(e,l=>this.logService.error(`Conflict in settings file ${this._name}: ${l}`));return{contents:o,keys:r,overrides:a,restricted:n.restricted,hasExcludedProperties:n.hasExcludedProperties}}filter(e,t,i,n){let o=!1;if(!n?.scopes&&!n?.skipRestricted&&!n?.exclude?.length)return{raw:e,restricted:[],hasExcludedProperties:o};const r={},a=[];for(const l in e)if(oh.test(l)&&i){const c=this.filter(e[l],t,!1,n);r[l]=c.raw,o=o||c.hasExcludedProperties,a.push(...c.restricted)}else{const c=t[l],d=c?typeof c.scope<"u"?c.scope:3:void 0;c?.restricted&&a.push(l),!n.exclude?.includes(l)&&(n.include?.includes(l)||(d===void 0||n.scopes===void 0||n.scopes.includes(d))&&!(n.skipRestricted&&c?.restricted))?r[l]=e[l]:o=!0}return{raw:r,restricted:a,hasExcludedProperties:o}}toOverrides(e,t){const i=[];for(const n of Object.keys(e))if(oh.test(n)){const o={};for(const r in e[n])o[r]=e[n][r];i.push({identifiers:q1(n),keys:Object.keys(o),contents:fE(o,t)})}return i}}class Jle{constructor(e,t,i,n,o,r,a,l,c,d,h,u,g){this.key=e,this.overrides=t,this._value=i,this.overrideIdentifiers=n,this.defaultConfiguration=o,this.policyConfiguration=r,this.applicationConfiguration=a,this.userConfiguration=l,this.localUserConfiguration=c,this.remoteUserConfiguration=d,this.workspaceConfiguration=h,this.folderConfigurationModel=u,this.memoryConfigurationModel=g}toInspectValue(e){return e?.value!==void 0||e?.override!==void 0||e?.overrides!==void 0?e:void 0}get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get user(){return this.toInspectValue(this.userInspectValue)}}class nx{constructor(e,t,i,n,o,r,a,l,c,d){this._defaultConfiguration=e,this._policyConfiguration=t,this._applicationConfiguration=i,this._localUserConfiguration=n,this._remoteUserConfiguration=o,this._workspaceConfiguration=r,this._folderConfigurations=a,this._memoryConfiguration=l,this._memoryConfigurationByResource=c,this.logService=d,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new Ui,this._userConfiguration=null}getValue(e,t,i){return this.getConsolidatedConfigurationModel(e,t,i).getValue(e)}updateValue(e,t,i={}){let n;i.resource?(n=this._memoryConfigurationByResource.get(i.resource),n||(n=vn.createEmptyModel(this.logService),this._memoryConfigurationByResource.set(i.resource,n))):n=this._memoryConfiguration,t===void 0?n.removeValue(e):n.setValue(e,t),i.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,t,i){const n=this.getConsolidatedConfigurationModel(e,t,i),o=this.getFolderConfigurationModelForResource(t.resource,i),r=t.resource?this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration:this._memoryConfiguration,a=new Set;for(const l of n.overrides)for(const c of l.identifiers)n.getOverrideValue(e,c)!==void 0&&a.add(c);return new Jle(e,t,n.getValue(e),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,i?this._workspaceConfiguration:void 0,o||void 0,r)}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration)),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}getConsolidatedConfigurationModel(e,t,i){let n=this.getConsolidatedConfigurationModelForResource(t,i);return t.overrideIdentifier&&(n=n.override(t.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(e)!==void 0&&(n=n.merge(this._policyConfiguration)),n}getConsolidatedConfigurationModelForResource({resource:e},t){let i=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const n=t.getFolder(e);n&&(i=this.getFolderConsolidatedConfiguration(n.uri)||i);const o=this._memoryConfigurationByResource.get(e);o&&(i=i.merge(o))}return i}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const i=this.getWorkspaceConsolidatedConfiguration(),n=this._folderConfigurations.get(e);n?(t=i.merge(n),this._foldersConsolidatedConfigurations.set(e,t)):t=i}return t}getFolderConfigurationModelForResource(e,t){if(t&&e){const i=t.getFolder(e);if(i)return this._folderConfigurations.get(i.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,t)=>{const{contents:i,overrides:n,keys:o}=this._folderConfigurations.get(t);return e.push([t,{contents:i,overrides:n,keys:o}]),e},[])}}static parse(e,t){const i=this.parseConfigurationModel(e.defaults,t),n=this.parseConfigurationModel(e.policy,t),o=this.parseConfigurationModel(e.application,t),r=this.parseConfigurationModel(e.user,t),a=this.parseConfigurationModel(e.workspace,t),l=e.folders.reduce((c,d)=>(c.set(Se.revive(d[0]),this.parseConfigurationModel(d[1],t)),c),new Ui);return new nx(i,n,o,r,vn.createEmptyModel(t),a,l,vn.createEmptyModel(t),new Ui,t)}static parseConfigurationModel(e,t){return new vn(e.contents,e.keys,e.overrides,void 0,t)}}class ece{constructor(e,t,i,n,o){this.change=e,this.previous=t,this.currentConfiguraiton=i,this.currentWorkspace=n,this.logService=o,this._marker=`
`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=46,this.affectedKeys=new Set,this._previousConfiguration=void 0;for(const r of e.keys)this.affectedKeys.add(r);for(const[,r]of e.overrides)for(const a of r)this.affectedKeys.add(a);this._affectsConfigStr=this._marker;for(const r of this.affectedKeys)this._affectsConfigStr+=r+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=nx.parse(this.previous.data,this.logService)),this._previousConfiguration}affectsConfiguration(e,t){const i=this._marker+e,n=this._affectsConfigStr.indexOf(i);if(n<0)return!1;const o=n+i.length;if(o>=this._affectsConfigStr.length)return!1;const r=this._affectsConfigStr.charCodeAt(o);if(r!==this._markerCode1&&r!==this._markerCode2)return!1;if(t){const a=this.previousConfiguration?this.previousConfiguration.getValue(e,t,this.previous?.workspace):void 0,l=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!co(a,l)}return!0}}class tce{constructor(){this._onDidChange=new O,this.onDidChange=this._onDidChange.event,this._enabled=!0}get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}}const Q_=new tce,p0={kind:0},ice={kind:1};function nce(s,e,t){return{kind:2,commandId:s,commandArgs:e,isBubble:t}}class J_{constructor(e,t,i){this._log=i,this._defaultKeybindings=e,this._defaultBoundCommands=new Map;for(const n of e){const o=n.command;o&&o.charAt(0)!=="-"&&this._defaultBoundCommands.set(o,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=J_.handleRemovals([].concat(e).concat(t));for(let n=0,o=this._keybindings.length;n<o;n++){const r=this._keybindings[n];if(r.chords.length===0)continue;const a=r.when?.substituteConstants();a&&a.type===0||this._addKeyPress(r.chords[0],r)}}static _isTargetedForRemoval(e,t,i){if(t){for(let n=0;n<t.length;n++)if(t[n]!==e.chords[n])return!1}return!(i&&i.type!==1&&(!e.when||!fie(i,e.when)))}static handleRemovals(e){const t=new Map;for(let n=0,o=e.length;n<o;n++){const r=e[n];if(r.command&&r.command.charAt(0)==="-"){const a=r.command.substring(1);t.has(a)?t.get(a).push(r):t.set(a,[r])}}if(t.size===0)return e;const i=[];for(let n=0,o=e.length;n<o;n++){const r=e[n];if(!r.command||r.command.length===0){i.push(r);continue}if(r.command.charAt(0)==="-")continue;const a=t.get(r.command);if(!a||!r.isDefault){i.push(r);continue}let l=!1;for(const c of a){const d=c.when;if(this._isTargetedForRemoval(r,c.chords,d)){l=!0;break}}if(!l){i.push(r);continue}}return i}_addKeyPress(e,t){const i=this._map.get(e);if(typeof i>"u"){this._map.set(e,[t]),this._addToLookupMap(t);return}for(let n=i.length-1;n>=0;n--){const o=i[n];if(o.command===t.command)continue;let r=!0;for(let a=1;a<o.chords.length&&a<t.chords.length;a++)if(o.chords[a]!==t.chords[a]){r=!1;break}r&&J_.whenIsEntirelyIncluded(o.when,t.when)&&this._removeFromLookupMap(o)}i.push(t),this._addToLookupMap(t)}_addToLookupMap(e){if(!e.command)return;let t=this._lookupMap.get(e.command);typeof t>"u"?(t=[e],this._lookupMap.set(e.command,t)):t.push(e)}_removeFromLookupMap(e){if(!e.command)return;const t=this._lookupMap.get(e.command);if(!(typeof t>"u")){for(let i=0,n=t.length;i<n;i++)if(t[i]===e){t.splice(i,1);return}}}static whenIsEntirelyIncluded(e,t){return!t||t.type===1?!0:!e||e.type===1?!1:uE(e,t)}getKeybindings(){return this._keybindings}lookupPrimaryKeybinding(e,t){const i=this._lookupMap.get(e);if(typeof i>"u"||i.length===0)return null;if(i.length===1)return i[0];for(let n=i.length-1;n>=0;n--){const o=i[n];if(t.contextMatchesRules(o.when))return o}return i[i.length-1]}resolve(e,t,i){const n=[...t,i];this._log(`| Resolving ${n}`);const o=this._map.get(n[0]);if(o===void 0)return this._log("\\ No keybinding entries."),p0;let r=null;if(n.length<2)r=o;else{r=[];for(let l=0,c=o.length;l<c;l++){const d=o[l];if(n.length>d.chords.length)continue;let h=!0;for(let u=1;u<n.length;u++)if(d.chords[u]!==n[u]){h=!1;break}h&&r.push(d)}}const a=this._findCommand(e,r);return a?n.length<a.chords.length?(this._log(`\\ From ${r.length} keybinding entries, awaiting ${a.chords.length-n.length} more chord(s), when: ${NB(a.when)}, source: ${RB(a)}.`),ice):(this._log(`\\ From ${r.length} keybinding entries, matched ${a.command}, when: ${NB(a.when)}, source: ${RB(a)}.`),nce(a.command,a.commandArgs,a.bubble)):(this._log(`\\ From ${r.length} keybinding entries, no when clauses matched the context.`),p0)}_findCommand(e,t){for(let i=t.length-1;i>=0;i--){const n=t[i];if(J_._contextMatchesRules(e,n.when))return n}return null}static _contextMatchesRules(e,t){return t?t.evaluate(e):!0}}function NB(s){return s?`${s.serialize()}`:"no when condition"}function RB(s){return s.extensionId?s.isBuiltinExtension?`built-in extension ${s.extensionId}`:`user extension ${s.extensionId}`:s.isDefault?"built-in":"user"}const sce=/^(cursor|delete|undo|redo|tab|editor\.action\.clipboard)/;class oce extends B{get onDidUpdateKeybindings(){return this._onDidUpdateKeybindings?this._onDidUpdateKeybindings.event:se.None}get inChordMode(){return this._currentChords.length>0}constructor(e,t,i,n,o){super(),this._contextKeyService=e,this._commandService=t,this._telemetryService=i,this._notificationService=n,this._logService=o,this._onDidUpdateKeybindings=this._register(new O),this._currentChords=[],this._currentChordChecker=new qP,this._currentChordStatusMessage=null,this._ignoreSingleModifiers=kf.EMPTY,this._currentSingleModifier=null,this._currentSingleModifierClearTimeout=new ia,this._currentlyDispatchingCommandId=null,this._logging=!1}dispose(){super.dispose()}_log(e){this._logging&&this._logService.info(`[KeybindingService]: ${e}`)}getKeybindings(){return this._getResolver().getKeybindings()}lookupKeybinding(e,t){const i=this._getResolver().lookupPrimaryKeybinding(e,t||this._contextKeyService);if(i)return i.resolvedKeybinding}dispatchEvent(e,t){return this._dispatch(e,t)}softDispatch(e,t){this._log("/ Soft dispatching keyboard event");const i=this.resolveKeyboardEvent(e);if(i.hasMultipleChords())return console.warn("keyboard event should not be mapped to multiple chords"),p0;const[n]=i.getDispatchChords();if(n===null)return this._log("\\ Keyboard event cannot be dispatched"),p0;const o=this._contextKeyService.getContext(t),r=this._currentChords.map(({keypress:a})=>a);return this._getResolver().resolve(o,r,n)}_scheduleLeaveChordMode(){const e=Date.now();this._currentChordChecker.cancelAndSet(()=>{if(!this._documentHasFocus()){this._leaveChordMode();return}Date.now()-e>5e3&&this._leaveChordMode()},500)}_expectAnotherChord(e,t){switch(this._currentChords.push({keypress:e,label:t}),this._currentChords.length){case 0:throw NP("impossible");case 1:this._currentChordStatusMessage=this._notificationService.status(p("first.chord","({0}) was pressed. Waiting for second key of chord...",t));break;default:{const i=this._currentChords.map(({label:n})=>n).join(", ");this._currentChordStatusMessage=this._notificationService.status(p("next.chord","({0}) was pressed. Waiting for next key of chord...",i))}}this._scheduleLeaveChordMode(),Q_.enabled&&Q_.disable()}_leaveChordMode(){this._currentChordStatusMessage&&(this._currentChordStatusMessage.dispose(),this._currentChordStatusMessage=null),this._currentChordChecker.cancel(),this._currentChords=[],Q_.enable()}_dispatch(e,t){return this._doDispatch(this.resolveKeyboardEvent(e),t,!1)}_singleModifierDispatch(e,t){const i=this.resolveKeyboardEvent(e),[n]=i.getSingleModifierDispatchChords();if(n)return this._ignoreSingleModifiers.has(n)?(this._log(`+ Ignoring single modifier ${n} due to it being pressed together with other keys.`),this._ignoreSingleModifiers=kf.EMPTY,this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1):(this._ignoreSingleModifiers=kf.EMPTY,this._currentSingleModifier===null?(this._log(`+ Storing single modifier for possible chord ${n}.`),this._currentSingleModifier=n,this._currentSingleModifierClearTimeout.cancelAndSet(()=>{this._log("+ Clearing single modifier due to 300ms elapsed."),this._currentSingleModifier=null},300),!1):n===this._currentSingleModifier?(this._log(`/ Dispatching single modifier chord ${n} ${n}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,this._doDispatch(i,t,!0)):(this._log(`+ Clearing single modifier due to modifier mismatch: ${this._currentSingleModifier} ${n}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1));const[o]=i.getChords();return this._ignoreSingleModifiers=new kf(o),this._currentSingleModifier!==null&&this._log("+ Clearing single modifier due to other key up."),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1}_doDispatch(e,t,i=!1){let n=!1;if(e.hasMultipleChords())return console.warn("Unexpected keyboard event mapped to multiple chords"),!1;let o=null,r=null;if(i){const[d]=e.getSingleModifierDispatchChords();o=d,r=d?[d]:[]}else[o]=e.getDispatchChords(),r=this._currentChords.map(({keypress:d})=>d);if(o===null)return this._log("\\ Keyboard event cannot be dispatched in keydown phase."),n;const a=this._contextKeyService.getContext(t),l=e.getLabel(),c=this._getResolver().resolve(a,r,o);switch(c.kind){case 0:{if(this._logService.trace("KeybindingService#dispatch",l,"[ No matching keybinding ]"),this.inChordMode){const d=this._currentChords.map(({label:h})=>h).join(", ");this._log(`+ Leaving multi-chord mode: Nothing bound to "${d}, ${l}".`),this._notificationService.status(p("missing.chord","The key combination ({0}, {1}) is not a command.",d,l),{hideAfter:10*1e3}),this._leaveChordMode(),n=!0}return n}case 1:return this._logService.trace("KeybindingService#dispatch",l,"[ Several keybindings match - more chords needed ]"),n=!0,this._expectAnotherChord(o,l),this._log(this._currentChords.length===1?"+ Entering multi-chord mode...":"+ Continuing multi-chord mode..."),n;case 2:{if(this._logService.trace("KeybindingService#dispatch",l,`[ Will dispatch command ${c.commandId} ]`),c.commandId===null||c.commandId===""){if(this.inChordMode){const d=this._currentChords.map(({label:h})=>h).join(", ");this._log(`+ Leaving chord mode: Nothing bound to "${d}, ${l}".`),this._notificationService.status(p("missing.chord","The key combination ({0}, {1}) is not a command.",d,l),{hideAfter:10*1e3}),this._leaveChordMode(),n=!0}}else{this.inChordMode&&this._leaveChordMode(),c.isBubble||(n=!0),this._log(`+ Invoking command ${c.commandId}.`),this._currentlyDispatchingCommandId=c.commandId;try{typeof c.commandArgs>"u"?this._commandService.executeCommand(c.commandId).then(void 0,d=>this._notificationService.warn(d)):this._commandService.executeCommand(c.commandId,c.commandArgs).then(void 0,d=>this._notificationService.warn(d))}finally{this._currentlyDispatchingCommandId=null}sce.test(c.commandId)||this._telemetryService.publicLog2("workbenchActionExecuted",{id:c.commandId,from:"keybinding",detail:e.getUserSettingsLabel()??void 0})}return n}}}mightProducePrintableCharacter(e){return e.ctrlKey||e.metaKey?!1:e.keyCode>=31&&e.keyCode<=56||e.keyCode>=21&&e.keyCode<=30}}class kf{static{this.EMPTY=new kf(null)}constructor(e){this._ctrlKey=e?e.ctrlKey:!1,this._shiftKey=e?e.shiftKey:!1,this._altKey=e?e.altKey:!1,this._metaKey=e?e.metaKey:!1}has(e){switch(e){case"ctrl":return this._ctrlKey;case"shift":return this._shiftKey;case"alt":return this._altKey;case"meta":return this._metaKey}}}class MB{constructor(e,t,i,n,o,r,a){this._resolvedKeybindingItemBrand=void 0,this.resolvedKeybinding=e,this.chords=e?JE(e.getDispatchChords()):[],e&&this.chords.length===0&&(this.chords=JE(e.getSingleModifierDispatchChords())),this.bubble=t?t.charCodeAt(0)===94:!1,this.command=this.bubble?t.substr(1):t,this.commandArgs=i,this.when=n,this.isDefault=o,this.extensionId=r,this.isBuiltinExtension=a}}function JE(s){const e=[];for(let t=0,i=s.length;t<i;t++){const n=s[t];if(!n)return[];e.push(n)}return e}class sx{constructor(e,t,i=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=i}toLabel(e,t,i){if(t.length===0)return null;const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=i(a);if(l===null)return null;n[o]=cce(a,l,this.modifierLabels[e])}return n.join(" ")}}const K2=new sx({ctrlKey:"",shiftKey:"",altKey:"",metaKey:"",separator:""},{ctrlKey:p({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:p({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:p({key:"windowsKey",comment:["This is the short form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:p({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:p({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:p({key:"superKey",comment:["This is the short form for the Super key on the keyboard"]},"Super"),separator:"+"}),rce=new sx({ctrlKey:p({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:p({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"optKey.long",comment:["This is the long form for the Alt/Option key on the keyboard"]},"Option"),metaKey:p({key:"cmdKey.long",comment:["This is the long form for the Command key on the keyboard"]},"Command"),separator:"+"},{ctrlKey:p({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:p({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:p({key:"windowsKey.long",comment:["This is the long form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:p({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:p({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:p({key:"superKey.long",comment:["This is the long form for the Super key on the keyboard"]},"Super"),separator:"+"}),ace=new sx({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),lce=new sx({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function cce(s,e,t){if(e===null)return"";const i=[];return s.ctrlKey&&i.push(t.ctrlKey),s.shiftKey&&i.push(t.shiftKey),s.altKey&&i.push(t.altKey),s.metaKey&&i.push(t.metaKey),e!==""&&i.push(e),i.join(t.separator)}class dce extends Aee{constructor(e,t){if(super(),t.length===0)throw mr("chords");this._os=e,this._chords=t}getLabel(){return K2.toLabel(this._os,this._chords,e=>this._getLabel(e))}getAriaLabel(){return rce.toLabel(this._os,this._chords,e=>this._getAriaLabel(e))}getElectronAccelerator(){return this._chords.length>1||this._chords[0].isDuplicateModifierCase()?null:ace.toLabel(this._os,this._chords,e=>this._getElectronAccelerator(e))}getUserSettingsLabel(){return lce.toLabel(this._os,this._chords,e=>this._getUserSettingsLabel(e))}hasMultipleChords(){return this._chords.length>1}getChords(){return this._chords.map(e=>this._getChord(e))}_getChord(e){return new Mee(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,this._getLabel(e),this._getAriaLabel(e))}getDispatchChords(){return this._chords.map(e=>this._getChordDispatch(e))}getSingleModifierDispatchChords(){return this._chords.map(e=>this._getSingleModifierChordDispatch(e))}}class hv extends dce{constructor(e,t){super(t,e)}_keyCodeToUILabel(e){if(this._os===2)switch(e){case 15:return"";case 16:return"";case 17:return"";case 18:return""}return fc.toString(e)}_getLabel(e){return e.isDuplicateModifierCase()?"":this._keyCodeToUILabel(e.keyCode)}_getAriaLabel(e){return e.isDuplicateModifierCase()?"":fc.toString(e.keyCode)}_getElectronAccelerator(e){return fc.toElectronAccelerator(e.keyCode)}_getUserSettingsLabel(e){if(e.isDuplicateModifierCase())return"";const t=fc.toUserSettingsUS(e.keyCode);return t&&t.toLowerCase()}_getChordDispatch(e){return hv.getDispatchStr(e)}static getDispatchStr(e){if(e.isModifierKey())return null;let t="";return e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),e.metaKey&&(t+="meta+"),t+=fc.toString(e.keyCode),t}_getSingleModifierChordDispatch(e){return e.keyCode===5&&!e.shiftKey&&!e.altKey&&!e.metaKey?"ctrl":e.keyCode===4&&!e.ctrlKey&&!e.altKey&&!e.metaKey?"shift":e.keyCode===6&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey?"alt":e.keyCode===57&&!e.ctrlKey&&!e.shiftKey&&!e.altKey?"meta":null}static _scanCodeToKeyCode(e){const t=OP[e];if(t!==-1)return t;switch(e){case 10:return 31;case 11:return 32;case 12:return 33;case 13:return 34;case 14:return 35;case 15:return 36;case 16:return 37;case 17:return 38;case 18:return 39;case 19:return 40;case 20:return 41;case 21:return 42;case 22:return 43;case 23:return 44;case 24:return 45;case 25:return 46;case 26:return 47;case 27:return 48;case 28:return 49;case 29:return 50;case 30:return 51;case 31:return 52;case 32:return 53;case 33:return 54;case 34:return 55;case 35:return 56;case 36:return 22;case 37:return 23;case 38:return 24;case 39:return 25;case 40:return 26;case 41:return 27;case 42:return 28;case 43:return 29;case 44:return 30;case 45:return 21;case 51:return 88;case 52:return 86;case 53:return 92;case 54:return 94;case 55:return 93;case 56:return 0;case 57:return 85;case 58:return 95;case 59:return 91;case 60:return 87;case 61:return 89;case 62:return 90;case 106:return 97}return 0}static _toKeyCodeChord(e){if(!e)return null;if(e instanceof Bc)return e;const t=this._scanCodeToKeyCode(e.scanCode);return t===0?null:new Bc(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,t)}static resolveKeybinding(e,t){const i=JE(e.chords.map(n=>this._toKeyCodeChord(n)));return i.length>0?[new hv(i,t)]:[]}}const Pp=Je("labelService"),Hz=Je("progressService");class Sc{static{this.None=Object.freeze({report(){}})}constructor(e){this.callback=e}report(e){this._value=e,this.callback(this._value)}}const yh=Je("editorProgressService");class hce{constructor(){this._value="",this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){const t=e.charCodeAt(0),i=this._value.charCodeAt(this._pos);return t-i}value(){return this._value[this._pos]}}class uce{constructor(e=!0){this._caseSensitive=e}reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(e)this._from++;else break;else e=!1;return this}cmp(e){return this._caseSensitive?BP(e,this._value,0,e.length,this._from,this._to):bC(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class gce{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){this._from=0,this._to=0,this._value=e,this._valueLen=e.length;for(let t=e.length-1;t>=0;t--,this._valueLen--){const i=this._value.charCodeAt(t);if(!(i===47||this._splitOnBackslash&&i===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=!0;for(;this._to<this._valueLen;this._to++){const t=this._value.charCodeAt(this._to);if(t===47||this._splitOnBackslash&&t===92)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?BP(e,this._value,0,e.length,this._from,this._to):bC(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class fce{constructor(e,t){this._ignorePathCasing=e,this._ignoreQueryAndFragment=t,this._states=[],this._stateIdx=0}reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new gce(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(e)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===1)return JT(e,this._value.scheme);if(this._states[this._stateIdx]===2)return JT(e,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(e);if(this._states[this._stateIdx]===4)return Zb(e,this._value.query);if(this._states[this._stateIdx]===5)return Zb(e,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}}class My{constructor(){this.height=1}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){return this.left?.height??0}get heightRight(){return this.right?.height??0}}class Qf{static forUris(e=()=>!1,t=()=>!1){return new Qf(new fce(e,t))}static forStrings(){return new Qf(new hce)}static forConfigKeys(){return new Qf(new uce)}constructor(e){this._iter=e}clear(){this._root=void 0}set(e,t){const i=this._iter.reset(e);let n;this._root||(this._root=new My,this._root.segment=i.value());const o=[];for(n=this._root;;){const a=i.cmp(n.segment);if(a>0)n.left||(n.left=new My,n.left.segment=i.value()),o.push([-1,n]),n=n.left;else if(a<0)n.right||(n.right=new My,n.right.segment=i.value()),o.push([1,n]),n=n.right;else if(i.hasNext())i.next(),n.mid||(n.mid=new My,n.mid.segment=i.value()),o.push([0,n]),n=n.mid;else break}const r=n.value;n.value=t,n.key=e;for(let a=o.length-1;a>=0;a--){const l=o[a][1];l.updateHeight();const c=l.balanceFactor();if(c<-1||c>1){const d=o[a][0],h=o[a+1][0];if(d===1&&h===1)o[a][1]=l.rotateLeft();else if(d===-1&&h===-1)o[a][1]=l.rotateRight();else if(d===1&&h===-1)l.right=o[a+1][1]=o[a+1][1].rotateRight(),o[a][1]=l.rotateLeft();else if(d===-1&&h===1)l.left=o[a+1][1]=o[a+1][1].rotateLeft(),o[a][1]=l.rotateRight();else throw new Error;if(a>0)switch(o[a-1][0]){case-1:o[a-1][1].left=o[a][1];break;case 1:o[a-1][1].right=o[a][1];break;case 0:o[a-1][1].mid=o[a][1];break}else this._root=o[0][1]}}return r}get(e){return this._getNode(e)?.value}_getNode(e){const t=this._iter.reset(e);let i=this._root;for(;i;){const n=t.cmp(i.segment);if(n>0)i=i.left;else if(n<0)i=i.right;else if(t.hasNext())t.next(),i=i.mid;else break}return i}has(e){const t=this._getNode(e);return!(t?.value===void 0&&t?.mid===void 0)}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){const i=this._iter.reset(e),n=[];let o=this._root;for(;o;){const r=i.cmp(o.segment);if(r>0)n.push([-1,o]),o=o.left;else if(r<0)n.push([1,o]),o=o.right;else if(i.hasNext())i.next(),n.push([0,o]),o=o.mid;else break}if(o){if(t?(o.left=void 0,o.mid=void 0,o.right=void 0,o.height=1):(o.key=void 0,o.value=void 0),!o.mid&&!o.value)if(o.left&&o.right){const r=this._min(o.right);if(r.key){const{key:a,value:l,segment:c}=r;this._delete(r.key,!1),o.key=a,o.value=l,o.segment=c}}else{const r=o.left??o.right;if(n.length>0){const[a,l]=n[n.length-1];switch(a){case-1:l.left=r;break;case 0:l.mid=r;break;case 1:l.right=r;break}}else this._root=r}for(let r=n.length-1;r>=0;r--){const a=n[r][1];a.updateHeight();const l=a.balanceFactor();if(l>1?(a.right.balanceFactor()>=0||(a.right=a.right.rotateRight()),n[r][1]=a.rotateLeft()):l<-1&&(a.left.balanceFactor()<=0||(a.left=a.left.rotateLeft()),n[r][1]=a.rotateRight()),r>0)switch(n[r-1][0]){case-1:n[r-1][1].left=n[r][1];break;case 1:n[r-1][1].right=n[r][1];break;case 0:n[r-1][1].mid=n[r][1];break}else this._root=n[0][1]}}}_min(e){for(;e.left;)e=e.left;return e}findSubstr(e){const t=this._iter.reset(e);let i=this._root,n;for(;i;){const o=t.cmp(i.segment);if(o>0)i=i.left;else if(o<0)i=i.right;else if(t.hasNext())t.next(),n=i.value||n,i=i.mid;else break}return i&&i.value||n}findSuperstr(e){return this._findSuperstrOrElement(e,!1)}_findSuperstrOrElement(e,t){const i=this._iter.reset(e);let n=this._root;for(;n;){const o=i.cmp(n.segment);if(o>0)n=n.left;else if(o<0)n=n.right;else if(i.hasNext())i.next(),n=n.mid;else return n.mid?this._entries(n.mid):t?n.value:void 0}}forEach(e){for(const[t,i]of this)e(i,t)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(e){const t=[];return this._dfsEntries(e,t),t[Symbol.iterator]()}_dfsEntries(e,t){e&&(e.left&&this._dfsEntries(e.left,t),e.value&&t.push([e.key,e.value]),e.mid&&this._dfsEntries(e.mid,t),e.right&&this._dfsEntries(e.right,t))}}const Xu=Je("contextService");function eN(s){const e=s;return typeof e?.id=="string"&&Se.isUri(e.uri)}function pce(s){return typeof s?.id=="string"&&!eN(s)&&!bce(s)}const mce={id:"empty-window"};function _ce(s,e){if(typeof s=="string"||typeof s>"u")return typeof s=="string"?{id:jd(s)}:mce;const t=s;return t.configuration?{id:t.id,configPath:t.configuration}:t.folders.length===1?{id:t.id,uri:t.folders[0].uri}:{id:t.id}}function bce(s){const e=s;return typeof e?.id=="string"&&Se.isUri(e.configPath)}class vce{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}const tN="code-workspace";p("codeWorkspace","Code Workspace");const Vz="4064f6ec-cb38-4ad0-af64-ee6467e63c82";function Cce(s){return s.id===Vz}var iN;(function(s){s.inspectTokensAction=p("inspectTokens","Developer: Inspect Tokens")})(iN||(iN={}));var m0;(function(s){s.gotoLineActionLabel=p("gotoLineActionLabel","Go to Line/Column...")})(m0||(m0={}));var nN;(function(s){s.helpQuickAccessActionLabel=p("helpQuickAccess","Show all Quick Access Providers")})(nN||(nN={}));var _0;(function(s){s.quickCommandActionLabel=p("quickCommandActionLabel","Command Palette"),s.quickCommandHelp=p("quickCommandActionHelp","Show And Run Commands")})(_0||(_0={}));var uv;(function(s){s.quickOutlineActionLabel=p("quickOutlineActionLabel","Go to Symbol..."),s.quickOutlineByCategoryActionLabel=p("quickOutlineByCategoryActionLabel","Go to Symbol by Category...")})(uv||(uv={}));var sN;(function(s){s.editorViewAccessibleLabel=p("editorViewAccessibleLabel","Editor content")})(sN||(sN={}));var oN;(function(s){s.toggleHighContrast=p("toggleHighContrast","Toggle High Contrast Theme")})(oN||(oN={}));var rN;(function(s){s.bulkEditServiceSummary=p("bulkEditServiceSummary","Made {0} edits in {1} files")})(rN||(rN={}));const zz=Je("workspaceTrustManagementService");let Op=[],q2=[],Uz=[];function Ay(s,e=!1){yce(s,!1,e)}function yce(s,e,t){const i=wce(s,e);Op.push(i),i.userConfigured?Uz.push(i):q2.push(i),t&&!i.userConfigured&&Op.forEach(n=>{n.mime===i.mime||n.userConfigured||(i.extension&&n.extension===i.extension&&console.warn(`Overwriting extension <<${i.extension}>> to now point to mime <<${i.mime}>>`),i.filename&&n.filename===i.filename&&console.warn(`Overwriting filename <<${i.filename}>> to now point to mime <<${i.mime}>>`),i.filepattern&&n.filepattern===i.filepattern&&console.warn(`Overwriting filepattern <<${i.filepattern}>> to now point to mime <<${i.mime}>>`),i.firstline&&n.firstline===i.firstline&&console.warn(`Overwriting firstline <<${i.firstline}>> to now point to mime <<${i.mime}>>`))})}function wce(s,e){return{id:s.id,mime:s.mime,filename:s.filename,extension:s.extension,filepattern:s.filepattern,firstline:s.firstline,userConfigured:e,filenameLowercase:s.filename?s.filename.toLowerCase():void 0,extensionLowercase:s.extension?s.extension.toLowerCase():void 0,filepatternLowercase:s.filepattern?XV(s.filepattern.toLowerCase()):void 0,filepatternOnPath:s.filepattern?s.filepattern.indexOf(Ai.sep)>=0:!1}}function Sce(){Op=Op.filter(s=>s.userConfigured),q2=[]}function Lce(s,e){return xce(s,e).map(t=>t.id)}function xce(s,e){let t;if(s)switch(s.scheme){case Fe.file:t=s.fsPath;break;case Fe.data:{t=ah.parseMetaData(s).get(ah.META_DATA_LABEL);break}case Fe.vscodeNotebookCell:t=void 0;break;default:t=s.path}if(!t)return[{id:"unknown",mime:wi.unknown}];t=t.toLowerCase();const i=jd(t),n=AB(t,i,Uz);if(n)return[n,{id:Cs,mime:wi.text}];const o=AB(t,i,q2);if(o)return[o,{id:Cs,mime:wi.text}];if(e){const r=kce(e);if(r)return[r,{id:Cs,mime:wi.text}]}return[{id:"unknown",mime:wi.unknown}]}function AB(s,e,t){let i,n,o;for(let r=t.length-1;r>=0;r--){const a=t[r];if(e===a.filenameLowercase){i=a;break}if(a.filepattern&&(!n||a.filepattern.length>n.filepattern.length)){const l=a.filepatternOnPath?s:e;a.filepatternLowercase?.(l)&&(n=a)}a.extension&&(!o||a.extension.length>o.extension.length)&&e.endsWith(a.extensionLowercase)&&(o=a)}if(i)return i;if(n)return n;if(o)return o}function kce(s){if($P(s)&&(s=s.substr(1)),s.length>0)for(let e=Op.length-1;e>=0;e--){const t=Op[e];if(!t.firstline)continue;const i=s.match(t.firstline);if(i&&i.length>0)return t}}const Py=Object.prototype.hasOwnProperty,PB="vs.editor.nullLanguage";class Dce{constructor(){this._languageIdToLanguage=[],this._languageToLanguageId=new Map,this._register(PB,0),this._register(Cs,1),this._nextLanguageId=2}_register(e,t){this._languageIdToLanguage[t]=e,this._languageToLanguageId.set(e,t)}register(e){if(this._languageToLanguageId.has(e))return;const t=this._nextLanguageId++;this._register(e,t)}encodeLanguageId(e){return this._languageToLanguageId.get(e)||0}decodeLanguageId(e){return this._languageIdToLanguage[e]||PB}}class b0 extends B{static{this.instanceCount=0}constructor(e=!0,t=!1){super(),this._onDidChange=this._register(new O),this.onDidChange=this._onDidChange.event,b0.instanceCount++,this._warnOnOverwrite=t,this.languageIdCodec=new Dce,this._dynamicLanguages=[],this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},e&&(this._initializeFromRegistry(),this._register(xp.onDidChangeLanguages(i=>{this._initializeFromRegistry()})))}dispose(){b0.instanceCount--,super.dispose()}_initializeFromRegistry(){this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Sce();const e=[].concat(xp.getLanguages()).concat(this._dynamicLanguages);this._registerLanguages(e)}_registerLanguages(e){for(const t of e)this._registerLanguage(t);this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach(t=>{const i=this._languages[t];i.name&&(this._nameMap[i.name]=i.identifier),i.aliases.forEach(n=>{this._lowercaseNameMap[n.toLowerCase()]=i.identifier}),i.mimetypes.forEach(n=>{this._mimeTypesMap[n]=i.identifier})}),ci.as(na.Configuration).registerOverrideIdentifiers(this.getRegisteredLanguageIds()),this._onDidChange.fire()}_registerLanguage(e){const t=e.id;let i;Py.call(this._languages,t)?i=this._languages[t]:(this.languageIdCodec.register(t),i={identifier:t,name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[],icons:[]},this._languages[t]=i),this._mergeLanguage(i,e)}_mergeLanguage(e,t){const i=t.id;let n=null;if(Array.isArray(t.mimetypes)&&t.mimetypes.length>0&&(e.mimetypes.push(...t.mimetypes),n=t.mimetypes[0]),n||(n=`text/x-${i}`,e.mimetypes.push(n)),Array.isArray(t.extensions)){t.configuration?e.extensions=t.extensions.concat(e.extensions):e.extensions=e.extensions.concat(t.extensions);for(const a of t.extensions)Ay({id:i,mime:n,extension:a},this._warnOnOverwrite)}if(Array.isArray(t.filenames))for(const a of t.filenames)Ay({id:i,mime:n,filename:a},this._warnOnOverwrite),e.filenames.push(a);if(Array.isArray(t.filenamePatterns))for(const a of t.filenamePatterns)Ay({id:i,mime:n,filepattern:a},this._warnOnOverwrite);if(typeof t.firstLine=="string"&&t.firstLine.length>0){let a=t.firstLine;a.charAt(0)!=="^"&&(a="^"+a);try{const l=new RegExp(a);vee(l)||Ay({id:i,mime:n,firstline:l},this._warnOnOverwrite)}catch(l){console.warn(`[${t.id}]: Invalid regular expression \`${a}\`: `,l)}}e.aliases.push(i);let o=null;if(typeof t.aliases<"u"&&Array.isArray(t.aliases)&&(t.aliases.length===0?o=[null]:o=t.aliases),o!==null)for(const a of o)!a||a.length===0||e.aliases.push(a);const r=o!==null&&o.length>0;if(!(r&&o[0]===null)){const a=(r?o[0]:null)||i;(r||!e.name)&&(e.name=a)}t.configuration&&e.configurationFiles.push(t.configuration),t.icon&&e.icons.push(t.icon)}isRegisteredLanguageId(e){return e?Py.call(this._languages,e):!1}getRegisteredLanguageIds(){return Object.keys(this._languages)}getLanguageIdByLanguageName(e){const t=e.toLowerCase();return Py.call(this._lowercaseNameMap,t)?this._lowercaseNameMap[t]:null}getLanguageIdByMimeType(e){return e&&Py.call(this._mimeTypesMap,e)?this._mimeTypesMap[e]:null}guessLanguageIdByFilepathOrFirstLine(e,t){return!e&&!t?[]:Lce(e,t)}}const jo=(s,e)=>s===e;function v0(s=jo){return(e,t)=>ii(e,t,s)}function Ice(){return(s,e)=>s.equals(e)}function aN(s,e,t){if(t!==void 0){const i=s;return i==null||e===void 0||e===null?e===i:t(i,e)}else{const i=s;return(n,o)=>n==null||o===void 0||o===null?o===n:i(n,o)}}function C0(s,e){if(s===e)return!0;if(Array.isArray(s)&&Array.isArray(e)){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(!C0(s[t],e[t]))return!1;return!0}if(s&&typeof s=="object"&&e&&typeof e=="object"&&Object.getPrototypeOf(s)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){const t=s,i=e,n=Object.keys(t),o=Object.keys(i),r=new Set(o);if(n.length!==o.length)return!1;for(const a of n)if(!r.has(a)||!C0(t[a],i[a]))return!1;return!0}return!1}class $n{constructor(e,t,i){this.owner=e,this.debugNameSource=t,this.referenceFn=i}getDebugName(e){return Tce(e,this)}}const OB=new Map,lN=new WeakMap;function Tce(s,e){const t=lN.get(s);if(t)return t;const i=Ece(s,e);if(i){let n=OB.get(i)??0;n++,OB.set(i,n);const o=n===1?i:`${i}#${n}`;return lN.set(s,o),o}}function Ece(s,e){const t=lN.get(s);if(t)return t;const i=e.owner?Rce(e.owner)+".":"";let n;const o=e.debugNameSource;if(o!==void 0)if(typeof o=="function"){if(n=o(),n!==void 0)return i+n}else return i+o;const r=e.referenceFn;if(r!==void 0&&(n=G2(r),n!==void 0))return i+n;if(e.owner!==void 0){const a=Nce(e.owner,s);if(a!==void 0)return i+a}}function Nce(s,e){for(const t in s)if(s[t]===e)return t}const FB=new Map,BB=new WeakMap;function Rce(s){const e=BB.get(s);if(e)return e;const t=Mce(s);let i=FB.get(t)??0;i++,FB.set(t,i);const n=i===1?t:`${t}#${i}`;return BB.set(s,n),n}function Mce(s){const e=s.constructor;return e?e.name:"Object"}function G2(s){const e=s.toString(),i=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e);return(i?i[1]:void 0)?.trim()}let Ace;function $z(){return Ace}let jz;function Pce(s){jz=s}let Zz;function Oce(s){Zz=s}let cN;function Fce(s){cN=s}class Kz{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){const i=t===void 0?void 0:e,n=t===void 0?e:t;return cN({owner:i,debugName:()=>{const o=G2(n);if(o!==void 0)return o;const a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(n.toString());if(a)return`${this.debugName}.${a[2]}`;if(!i)return`${this.debugName} (mapped)`},debugReferenceFn:n},o=>n(this.read(o),o))}flatten(){return cN({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(jz(this,t)),this}keepObserved(e){return e.add(Zz(this)),this}}class Lm extends Kz{constructor(){super(...arguments),this.observers=new Set}addObserver(e){const t=this.observers.size;this.observers.add(e),t===0&&this.onFirstObserverAdded()}removeObserver(e){this.observers.delete(e)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}}function ai(s,e){const t=new xm(s,e);try{s(t)}finally{t.finish()}}let Oy;function k_(s){if(Oy)s(Oy);else{const e=new xm(s,void 0);Oy=e;try{s(e)}finally{e.finish(),Oy=void 0}}}async function qz(s,e){const t=new xm(s,e);try{await s(t)}finally{t.finish()}}function Qu(s,e,t){s?e(s):ai(e,t)}class xm{constructor(e,t){this._fn=e,this._getDebugName=t,this.updatingObservers=[]}getDebugName(){return this._getDebugName?this._getDebugName():G2(this._fn)}updateObserver(e,t){this.updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){const e=this.updatingObservers;for(let t=0;t<e.length;t++){const{observer:i,observable:n}=e[t];i.endUpdate(n)}this.updatingObservers=null}}function Ze(s,e){let t;return typeof s=="string"?t=new $n(void 0,s,void 0):t=new $n(s,void 0,void 0),new Y2(t,e,jo)}class Y2 extends Lm{get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}constructor(e,t,i){super(),this._debugNameData=e,this._equalityComparator=i,this._value=t}get(){return this._value}set(e,t,i){if(i===void 0&&this._equalityComparator(this._value,e))return;let n;t||(t=n=new xm(()=>{},()=>`Setting ${this.debugName}`));try{const o=this._value;this._setValue(e),$z()?.handleObservableChanged(this,{oldValue:o,newValue:e,change:i,didChange:!0,hadValue:!0});for(const r of this.observers)t.updateObserver(r,this),r.handleChange(this,i)}finally{n&&n.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}}function gv(s,e){let t;return typeof s=="string"?t=new $n(void 0,s,void 0):t=new $n(s,void 0,void 0),new Bce(t,e,jo)}class Bce extends Y2{_setValue(e){this._value!==e&&(this._value&&this._value.dispose(),this._value=e)}dispose(){this._value?.dispose()}}function _e(s,e){return e!==void 0?new Ju(new $n(s,void 0,e),e,void 0,void 0,void 0,jo):new Ju(new $n(void 0,void 0,s),s,void 0,void 0,void 0,jo)}function RC(s,e,t){return new Wce(new $n(s,void 0,e),e,void 0,void 0,void 0,jo,t)}function Ao(s,e){return new Ju(new $n(s.owner,s.debugName,s.debugReferenceFn),e,void 0,void 0,s.onLastObserverRemoved,s.equalsFn??jo)}Fce(Ao);function Gz(s,e){return new Ju(new $n(s.owner,s.debugName,void 0),e,s.createEmptyChangeSummary,s.handleChange,void 0,s.equalityComparer??jo)}function wh(s,e){let t,i;e===void 0?(t=s,i=void 0):(i=s,t=e);const n=new Z;return new Ju(new $n(i,void 0,t),o=>(n.clear(),t(o,n)),void 0,void 0,()=>n.dispose(),jo)}function Jn(s,e){let t,i;e===void 0?(t=s,i=void 0):(i=s,t=e);let n;return new Ju(new $n(i,void 0,t),o=>{n?n.clear():n=new Z;const r=t(o);return r&&n.add(r),r},void 0,void 0,()=>{n&&(n.dispose(),n=void 0)},jo)}class Ju extends Lm{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,n,o=void 0,r){super(),this._debugNameData=e,this._computeFn=t,this.createChangeSummary=i,this._handleChange=n,this._handleLastObserverRemoved=o,this._equalityComparator=r,this.state=0,this.value=void 0,this.updateCount=0,this.dependencies=new Set,this.dependenciesToBeRemoved=new Set,this.changeSummary=void 0,this.changeSummary=this.createChangeSummary?.()}onLastObserverRemoved(){this.state=0,this.value=void 0;for(const e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this.observers.size===0){const e=this._computeFn(this,this.createChangeSummary?.());return this.onLastObserverRemoved(),e}else{do{if(this.state===1){for(const e of this.dependencies)if(e.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){if(this.state===3)return;const e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e;const t=this.state!==0,i=this.value;this.state=3;const n=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this.value=this._computeFn(this,n)}finally{for(const r of this.dependenciesToBeRemoved)r.removeObserver(this);this.dependenciesToBeRemoved.clear()}if(t&&!this._equalityComparator(i,this.value))for(const r of this.observers)r.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){this.updateCount++;const t=this.updateCount===1;if(this.state===3&&(this.state=1,!t))for(const i of this.observers)i.handlePossibleChange(this);if(t)for(const i of this.observers)i.beginUpdate(this)}endUpdate(e){if(this.updateCount--,this.updateCount===0){const t=[...this.observers];for(const i of t)i.endUpdate(this)}Ku(()=>this.updateCount>=0)}handlePossibleChange(e){if(this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)){this.state=1;for(const t of this.observers)t.handlePossibleChange(this)}}handleChange(e,t){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)){const i=this._handleChange?this._handleChange({changedObservable:e,change:t,didChange:o=>o===e},this.changeSummary):!0,n=this.state===3;if(i&&(this.state===1||n)&&(this.state=2,n))for(const o of this.observers)o.handlePossibleChange(this)}}readObservable(e){e.addObserver(this);const t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}addObserver(e){const t=!this.observers.has(e)&&this.updateCount>0;super.addObserver(e),t&&e.beginUpdate(this)}removeObserver(e){const t=this.observers.has(e)&&this.updateCount>0;super.removeObserver(e),t&&e.endUpdate(this)}}class Wce extends Ju{constructor(e,t,i,n,o=void 0,r,a){super(e,t,i,n,o,r),this.set=a}}function Pe(s){return new ox(new $n(void 0,void 0,s),s,void 0,void 0)}function MC(s,e){return new ox(new $n(s.owner,s.debugName,s.debugReferenceFn??e),e,void 0,void 0)}function AC(s,e){return new ox(new $n(s.owner,s.debugName,s.debugReferenceFn??e),e,s.createEmptyChangeSummary,s.handleChange)}function Hce(s,e){const t=new Z,i=AC({owner:s.owner,debugName:s.debugName,debugReferenceFn:s.debugReferenceFn??e,createEmptyChangeSummary:s.createEmptyChangeSummary,handleChange:s.handleChange},(n,o)=>{t.clear(),e(n,o,t)});return Ce(()=>{i.dispose(),t.dispose()})}function Us(s){const e=new Z,t=MC({owner:void 0,debugName:void 0,debugReferenceFn:s},i=>{e.clear(),s(i,e)});return Ce(()=>{t.dispose(),e.dispose()})}class ox{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,n){this._debugNameData=e,this._runFn=t,this.createChangeSummary=i,this._handleChange=n,this.state=2,this.updateCount=0,this.disposed=!1,this.dependencies=new Set,this.dependenciesToBeRemoved=new Set,this.changeSummary=this.createChangeSummary?.(),this._runIfNeeded()}dispose(){this.disposed=!0;for(const e of this.dependencies)e.removeObserver(this);this.dependencies.clear()}_runIfNeeded(){if(this.state===3)return;const e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e,this.state=3;const t=this.disposed;try{if(!t){$z()?.handleAutorunTriggered(this);const i=this.changeSummary;this.changeSummary=this.createChangeSummary?.(),this._runFn(this,i)}}finally{for(const i of this.dependenciesToBeRemoved)i.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){if(this.updateCount===1)do{if(this.state===1){this.state=3;for(const e of this.dependencies)if(e.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3);this.updateCount--,Ku(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=1)}handleChange(e,t){this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(!this._handleChange||this._handleChange({changedObservable:e,change:t,didChange:n=>n===e},this.changeSummary))&&(this.state=2)}readObservable(e){if(this.disposed)return e.get();e.addObserver(this);const t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}}(function(s){s.Observer=ox})(Pe||(Pe={}));function fr(s){return new Vce(s)}class Vce extends Kz{constructor(e){super(),this.value=e}get debugName(){return this.toString()}get(){return this.value}addObserver(e){}removeObserver(e){}toString(){return`Const: ${this.value}`}}function kt(...s){let e,t,i;return s.length===3?[e,t,i]=s:[t,i]=s,new Pd(new $n(e,void 0,i),t,i,()=>Pd.globalTransaction,jo)}function zce(s,e,t){return new Pd(new $n(s.owner,s.debugName,s.debugReferenceFn??t),e,t,()=>Pd.globalTransaction,s.equalsFn??jo)}class Pd extends Lm{constructor(e,t,i,n,o){super(),this._debugNameData=e,this.event=t,this._getValue=i,this._getTransaction=n,this._equalityComparator=o,this.hasValue=!1,this.handleEvent=r=>{const a=this._getValue(r),l=this.value;(!this.hasValue||!this._equalityComparator(l,a))&&(this.value=a,this.hasValue&&Qu(this._getTransaction(),d=>{for(const h of this.observers)d.updateObserver(h,this),h.handleChange(this,void 0)},()=>{const d=this.getDebugName();return"Event fired"+(d?`: ${d}`:"")}),this.hasValue=!0)}}getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){const e=this.getDebugName();return"From Event"+(e?`: ${e}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}}(function(s){s.Observer=Pd;function e(t,i){let n=!1;Pd.globalTransaction===void 0&&(Pd.globalTransaction=t,n=!0);try{i()}finally{n&&(Pd.globalTransaction=void 0)}}s.batchEventsGlobally=e})(kt||(kt={}));function En(s,e){return new Uce(s,e)}class Uce extends Lm{constructor(e,t){super(),this.debugName=e,this.event=t,this.handleEvent=()=>{ai(i=>{for(const n of this.observers)i.updateObserver(n,this),n.handleChange(this,void 0)},()=>this.debugName)}}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}}function km(s){return typeof s=="string"?new WB(s):new WB(void 0,s)}class WB extends Lm{get debugName(){return new $n(this._owner,this._debugName,void 0).getDebugName(this)??"Observable Signal"}toString(){return this.debugName}constructor(e,t){super(),this._debugName=e,this._owner=t}trigger(e,t){if(!e){ai(i=>{this.trigger(i,t)},()=>`Trigger signal ${this.debugName}`);return}for(const i of this.observers)e.updateObserver(i,this),i.handleChange(this,t)}get(){}}function $ce(s){const e=new Yz(!1,void 0);return s.addObserver(e),Ce(()=>{s.removeObserver(e)})}Oce($ce);function Dm(s,e){const t=new Yz(!0,e);return s.addObserver(t),e?e(s.get()):s.reportChanges(),Ce(()=>{s.removeObserver(t)})}Pce(Dm);class Yz{constructor(e,t){this._forceRecompute=e,this._handleValue=t,this._counter=0}beginUpdate(e){this._counter++}endUpdate(e){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges())}handlePossibleChange(e){}handleChange(e,t){}}function PC(s,e){let t;return Ao({owner:s,debugReferenceFn:e},n=>(t=e(n,t),t))}function jce(s,e,t,i){let n=new HB(t,i);return Ao({debugReferenceFn:t,owner:s,onLastObserverRemoved:()=>{n.dispose(),n=new HB(t)}},r=>(n.setItems(e.read(r)),n.getItems()))}class HB{constructor(e,t){this._map=e,this._keySelector=t,this._cache=new Map,this._items=[]}dispose(){this._cache.forEach(e=>e.store.dispose()),this._cache.clear()}setItems(e){const t=[],i=new Set(this._cache.keys());for(const n of e){const o=this._keySelector?this._keySelector(n):n;let r=this._cache.get(o);if(r)i.delete(o);else{const a=new Z;r={out:this._map(n,a),store:a},this._cache.set(o,r)}t.push(r.out)}for(const n of i)this._cache.get(n).store.dispose(),this._cache.delete(n);this._items=t}getItems(){return this._items}}function Zce(s,e){return PC(s,(t,i)=>i??e(t))}class rx{static fromFn(e){return new rx(e())}constructor(e){this._value=Ze(this,void 0),this.promiseResult=this._value,this.promise=e.then(t=>(ai(i=>{this._value.set(new VB(t,void 0),i)}),t),t=>{throw ai(i=>{this._value.set(new VB(void 0,t),i)}),t})}}class VB{constructor(e,t){this.data=e,this.error=t}}function Xz(s,e,t,i){return e||(e=n=>n!=null),new Promise((n,o)=>{let r=!0,a=!1;const l=s.map(d=>({isFinished:e(d),error:t?t(d):!1,state:d})),c=Pe(d=>{const{isFinished:h,error:u,state:g}=l.read(d);(h||u)&&(r?a=!0:c.dispose(),u?o(u===!0?g:u):n(g))});if(i){const d=i.onCancellationRequested(()=>{c.dispose(),d.dispose(),o(new Xr)});if(i.isCancellationRequested){c.dispose(),d.dispose(),o(new Xr);return}}r=!1,a&&c.dispose()})}class Kce extends Lm{get debugName(){return this._debugNameData.getDebugName(this)??"LazyObservableValue"}constructor(e,t,i){super(),this._debugNameData=e,this._equalityComparator=i,this._isUpToDate=!0,this._deltas=[],this._updateCounter=0,this._value=t}get(){return this._update(),this._value}_update(){if(!this._isUpToDate)if(this._isUpToDate=!0,this._deltas.length>0){for(const e of this.observers)for(const t of this._deltas)e.handleChange(this,t);this._deltas.length=0}else for(const e of this.observers)e.handleChange(this,void 0)}_beginUpdate(){if(this._updateCounter++,this._updateCounter===1)for(const e of this.observers)e.beginUpdate(this)}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){this._update();const e=[...this.observers];for(const t of e)t.endUpdate(this)}}addObserver(e){const t=!this.observers.has(e)&&this._updateCounter>0;super.addObserver(e),t&&e.beginUpdate(this)}removeObserver(e){const t=this.observers.has(e)&&this._updateCounter>0;super.removeObserver(e),t&&e.endUpdate(this)}set(e,t,i){if(i===void 0&&this._equalityComparator(this._value,e))return;let n;t||(t=n=new xm(()=>{},()=>`Setting ${this.debugName}`));try{if(this._isUpToDate=!1,this._setValue(e),i!==void 0&&this._deltas.push(i),t.updateObserver({beginUpdate:()=>this._beginUpdate(),endUpdate:()=>this._endUpdate(),handleChange:(o,r)=>{},handlePossibleChange:o=>{}},this),this._updateCounter>1)for(const o of this.observers)o.handlePossibleChange(this)}finally{n&&n.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}}function dN(s,e){return s.lazy?new Kce(new $n(s.owner,s.debugName,void 0),e,s.equalsFn??jo):new Y2(new $n(s.owner,s.debugName,void 0),e,s.equalsFn??jo)}class y0 extends B{static{this.instanceCount=0}constructor(e=!1){super(),this._onDidRequestBasicLanguageFeatures=this._register(new O),this.onDidRequestBasicLanguageFeatures=this._onDidRequestBasicLanguageFeatures.event,this._onDidRequestRichLanguageFeatures=this._register(new O),this.onDidRequestRichLanguageFeatures=this._onDidRequestRichLanguageFeatures.event,this._onDidChange=this._register(new O({leakWarningThreshold:200})),this.onDidChange=this._onDidChange.event,this._requestedBasicLanguages=new Set,this._requestedRichLanguages=new Set,y0.instanceCount++,this._registry=this._register(new b0(!0,e)),this.languageIdCodec=this._registry.languageIdCodec,this._register(this._registry.onDidChange(()=>this._onDidChange.fire()))}dispose(){y0.instanceCount--,super.dispose()}isRegisteredLanguageId(e){return this._registry.isRegisteredLanguageId(e)}getLanguageIdByLanguageName(e){return this._registry.getLanguageIdByLanguageName(e)}getLanguageIdByMimeType(e){return this._registry.getLanguageIdByMimeType(e)}guessLanguageIdByFilepathOrFirstLine(e,t){const i=this._registry.guessLanguageIdByFilepathOrFirstLine(e,t);return LP(i,null)}createById(e){return new zB(this.onDidChange,()=>this._createAndGetLanguageIdentifier(e))}createByFilepathOrFirstLine(e,t){return new zB(this.onDidChange,()=>{const i=this.guessLanguageIdByFilepathOrFirstLine(e,t);return this._createAndGetLanguageIdentifier(i)})}_createAndGetLanguageIdentifier(e){return(!e||!this.isRegisteredLanguageId(e))&&(e=Cs),e}requestBasicLanguageFeatures(e){this._requestedBasicLanguages.has(e)||(this._requestedBasicLanguages.add(e),this._onDidRequestBasicLanguageFeatures.fire(e))}requestRichLanguageFeatures(e){this._requestedRichLanguages.has(e)||(this._requestedRichLanguages.add(e),this.requestBasicLanguageFeatures(e),mi.getOrCreate(e),this._onDidRequestRichLanguageFeatures.fire(e))}}class zB{constructor(e,t){this._value=kt(this,e,()=>t()),this.onDidChange=se.fromObservable(this._value)}get languageId(){return this._value.get()}}const fv={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:wi.text,INTERNAL_URI_LIST:"application/vnd.code.uri-list"},qce=()=>({get delay(){return-1},dispose:()=>{},showHover:()=>{}});let ax=qce;const Gce=new Fa(()=>ax("mouse",!1)),Yce=new Fa(()=>ax("element",!1));function Xce(s){ax=s}function Ds(s){return s==="element"?Yce.value:Gce.value}function Fp(){return ax("element",!0)}let Qz={showHover:()=>{},hideHover:()=>{},showAndFocusLastHover:()=>{},setupManagedHover:()=>null,showManagedHover:()=>{}};function Qce(s){Qz=s}function Ka(){return Qz}class Jce{constructor(e){this.spliceables=e}splice(e,t,i){this.spliceables.forEach(n=>n.splice(e,t,i))}}class Ph extends Error{constructor(e,t){super(`ListError [${e}] ${t}`)}}function UB(s,e){const t=[];for(const i of e){if(s.start>=i.range.end)continue;if(s.end<i.range.start)break;const n=Wn.intersect(s,i.range);Wn.isEmpty(n)||t.push({range:n,size:i.size})}return t}function hN({start:s,end:e},t){return{start:s+t,end:e+t}}function ede(s){const e=[];let t=null;for(const i of s){const n=i.range.start,o=i.range.end,r=i.size;if(t&&r===t.size){t.range.end=o;continue}t={range:{start:n,end:o},size:r},e.push(t)}return e}function tde(...s){return ede(s.reduce((e,t)=>e.concat(t),[]))}class ide{get paddingTop(){return this._paddingTop}set paddingTop(e){this._size=this._size+e-this._paddingTop,this._paddingTop=e}constructor(e){this.groups=[],this._size=0,this._paddingTop=0,this._paddingTop=e??0,this._size=this._paddingTop}splice(e,t,i=[]){const n=i.length-t,o=UB({start:0,end:e},this.groups),r=UB({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map(l=>({range:hN(l.range,n),size:l.size})),a=i.map((l,c)=>({range:{start:e+c,end:e+c+1},size:l.size}));this.groups=tde(o,a,r),this._size=this._paddingTop+this.groups.reduce((l,c)=>l+c.size*(c.range.end-c.range.start),0)}get count(){const e=this.groups.length;return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1;if(e<this._paddingTop)return 0;let t=0,i=this._paddingTop;for(const n of this.groups){const o=n.range.end-n.range.start,r=i+o*n.size;if(e<r)return t+Math.floor((e-i)/n.size);t+=o,i=r}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1;let t=0,i=0;for(const n of this.groups){const o=n.range.end-n.range.start,r=i+o;if(e<r)return this._paddingTop+t+(e-i)*n.size;t+=o*n.size,i=r}return-1}}class nde{constructor(e){this.renderers=e,this.cache=new Map,this.transactionNodesPendingRemoval=new Set,this.inTransaction=!1}alloc(e){let t=this.getTemplateCache(e).pop(),i=!1;if(t)i=this.transactionNodesPendingRemoval.has(t.domNode),i&&this.transactionNodesPendingRemoval.delete(t.domNode);else{const n=te(".monaco-list-row"),r=this.getRenderer(e).renderTemplate(n);t={domNode:n,templateId:e,templateData:r}}return{row:t,isReusingConnectedDomNode:i}}release(e){e&&this.releaseRow(e)}transact(e){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{e()}finally{for(const t of this.transactionNodesPendingRemoval)this.doRemoveNode(t);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(e){const{domNode:t,templateId:i}=e;t&&(this.inTransaction?this.transactionNodesPendingRemoval.add(t):this.doRemoveNode(t)),this.getTemplateCache(i).push(e)}doRemoveNode(e){e.classList.remove("scrolling"),e.remove()}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach((e,t)=>{for(const i of e)this.getRenderer(t).disposeTemplate(i.templateData),i.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(e){const t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}}var Xc=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o};const Oh={CurrentDragAndDropData:void 0},tl={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(s){return[s]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0};class OC{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class sde{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class ode{constructor(){this.types=[],this.files=[]}update(e){if(e.types&&this.types.splice(0,this.types.length,...e.types),e.files){this.files.splice(0,this.files.length);for(let t=0;t<e.files.length;t++){const i=e.files.item(t);i&&(i.size||i.type)&&this.files.push(i)}}}getData(){return{types:this.types,files:this.files}}}function rde(s,e){return Array.isArray(s)&&Array.isArray(e)?ii(s,e):s===e}class ade{constructor(e){e?.getSetSize?this.getSetSize=e.getSetSize.bind(e):this.getSetSize=(t,i,n)=>n,e?.getPosInSet?this.getPosInSet=e.getPosInSet.bind(e):this.getPosInSet=(t,i)=>i+1,e?.getRole?this.getRole=e.getRole.bind(e):this.getRole=t=>"listitem",e?.isChecked?this.isChecked=e.isChecked.bind(e):this.isChecked=t=>{}}}class sa{static{this.InstanceCount=0}get contentHeight(){return this.rangeMap.size}get onDidScroll(){return this.scrollableElement.onScroll}get scrollableElementDomNode(){return this.scrollableElement.getDomNode()}get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(e){if(e!==this._horizontalScrolling){if(e&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=e,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(const t of this.items)this.measureItemWidth(t);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:jk(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}constructor(e,t,i,n=tl){if(this.virtualDelegate=t,this.domId=`list_id_${++sa.InstanceCount}`,this.renderers=new Map,this.renderWidth=0,this._scrollHeight=0,this.scrollableElementUpdateDisposable=null,this.scrollableElementWidthDelayer=new Cr(50),this.splicing=!1,this.dragOverAnimationStopDisposable=B.None,this.dragOverMouseY=0,this.canDrop=!1,this.currentDragFeedbackDisposable=B.None,this.onDragLeaveTimeout=B.None,this.disposables=new Z,this._onDidChangeContentHeight=new O,this._onDidChangeContentWidth=new O,this.onDidChangeContentHeight=se.latch(this._onDidChangeContentHeight.event,void 0,this.disposables),this._horizontalScrolling=!1,n.horizontalScrolling&&n.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=this.createRangeMap(n.paddingTop??0);for(const r of i)this.renderers.set(r.templateId,r);this.cache=this.disposables.add(new nde(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof n.mouseSupport=="boolean"?n.mouseSupport:!0),this._horizontalScrolling=n.horizontalScrolling??tl.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=typeof n.paddingBottom>"u"?0:n.paddingBottom,this.accessibilityProvider=new ade(n.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",(n.transformOptimization??tl.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(ti.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new Sm({forceIntegerValues:!0,smoothScrollDuration:n.smoothScrolling??!1?125:0,scheduleAtNextAnimationFrame:r=>mo(ke(this.domNode),r)})),this.scrollableElement=this.disposables.add(new YL(this.rowsContainer,{alwaysConsumeMouseWheel:n.alwaysConsumeMouseWheel??tl.alwaysConsumeMouseWheel,horizontal:1,vertical:n.verticalScrollMode??tl.verticalScrollMode,useShadows:n.useShadows??tl.useShadows,mouseWheelScrollSensitivity:n.mouseWheelScrollSensitivity,fastScrollSensitivity:n.fastScrollSensitivity,scrollByPage:n.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(U(this.rowsContainer,Wt.Change,r=>this.onTouchChange(r))),this.disposables.add(U(this.scrollableElement.getDomNode(),"scroll",r=>r.target.scrollTop=0)),this.disposables.add(U(this.domNode,"dragover",r=>this.onDragOver(this.toDragEvent(r)))),this.disposables.add(U(this.domNode,"drop",r=>this.onDrop(this.toDragEvent(r)))),this.disposables.add(U(this.domNode,"dragleave",r=>this.onDragLeave(this.toDragEvent(r)))),this.disposables.add(U(this.domNode,"dragend",r=>this.onDragEnd(r))),this.setRowLineHeight=n.setRowLineHeight??tl.setRowLineHeight,this.setRowHeight=n.setRowHeight??tl.setRowHeight,this.supportDynamicHeights=n.supportDynamicHeights??tl.supportDynamicHeights,this.dnd=n.dnd??this.disposables.add(tl.dnd),this.layout(n.initialSize?.height,n.initialSize?.width)}updateOptions(e){e.paddingBottom!==void 0&&(this.paddingBottom=e.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),e.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(e.smoothScrolling?125:0),e.horizontalScrolling!==void 0&&(this.horizontalScrolling=e.horizontalScrolling);let t;if(e.scrollByPage!==void 0&&(t={...t??{},scrollByPage:e.scrollByPage}),e.mouseWheelScrollSensitivity!==void 0&&(t={...t??{},mouseWheelScrollSensitivity:e.mouseWheelScrollSensitivity}),e.fastScrollSensitivity!==void 0&&(t={...t??{},fastScrollSensitivity:e.fastScrollSensitivity}),t&&this.scrollableElement.updateOptions(t),e.paddingTop!==void 0&&e.paddingTop!==this.rangeMap.paddingTop){const i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),n=e.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=e.paddingTop,this.render(i,Math.max(0,this.lastRenderTop+n),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}createRangeMap(e){return new ide(e)}splice(e,t,i=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(e,t,i)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(e,t,i=[]){const n=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),o={start:e,end:e+t},r=Wn.intersect(n,o),a=new Map;for(let w=r.end-1;w>=r.start;w--){const x=this.items[w];if(x.dragStartDisposable.dispose(),x.checkedDisposable.dispose(),x.row){let L=a.get(x.templateId);L||(L=[],a.set(x.templateId,L));const D=this.renderers.get(x.templateId);D&&D.disposeElement&&D.disposeElement(x.element,w,x.row.templateData,x.size),L.unshift(x.row)}x.row=null,x.stale=!0}const l={start:e+t,end:this.items.length},c=Wn.intersect(l,n),d=Wn.relativeComplement(l,n),h=i.map(w=>({id:String(this.itemId++),element:w,templateId:this.virtualDelegate.getTemplateId(w),size:this.virtualDelegate.getHeight(w),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(w),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:B.None,checkedDisposable:B.None,stale:!1}));let u;e===0&&t>=this.items.length?(this.rangeMap=this.createRangeMap(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,h),u=this.items,this.items=h):(this.rangeMap.splice(e,t,h),u=this.items.splice(e,t,...h));const g=i.length-t,f=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),m=hN(c,g),_=Wn.intersect(f,m);for(let w=_.start;w<_.end;w++)this.updateItemInDOM(this.items[w],w);const b=Wn.relativeComplement(m,f);for(const w of b)for(let x=w.start;x<w.end;x++)this.removeItemFromDOM(x);const v=d.map(w=>hN(w,g)),y=[{start:e,end:e+i.length},...v].map(w=>Wn.intersect(f,w)).reverse();for(const w of y)for(let x=w.end-1;x>=w.start;x--){const L=this.items[x],T=a.get(L.templateId)?.pop();this.insertItemInDOM(x,T)}for(const w of a.values())for(const x of w)this.cache.release(x);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),u.map(w=>w.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=mo(ke(this.domNode),()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let e=0;for(const t of this.items)typeof t.width<"u"&&(e=Math.max(e,t.width));this.scrollWidth=e,this.scrollableElement.setScrollDimensions({scrollWidth:e===0?0:e+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}rerender(){if(this.supportDynamicHeights){for(const e of this.items)e.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).start}element(e){return this.items[e].element}indexOf(e){return this.items.findIndex(t=>t.element===e)}domElement(e){const t=this.items[e].row;return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e,t){const i={height:typeof e=="number"?e:Tte(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,i.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(i),typeof t<"u"&&(this.renderWidth=t,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof t=="number"?t:jk(this.domNode)})}render(e,t,i,n,o,r=!1){const a=this.getRenderRange(t,i),l=Wn.relativeComplement(a,e).reverse(),c=Wn.relativeComplement(e,a);if(r){const d=Wn.intersect(e,a);for(let h=d.start;h<d.end;h++)this.updateItemInDOM(this.items[h],h)}this.cache.transact(()=>{for(const d of c)for(let h=d.start;h<d.end;h++)this.removeItemFromDOM(h);for(const d of l)for(let h=d.end-1;h>=d.start;h--)this.insertItemInDOM(h)}),n!==void 0&&(this.rowsContainer.style.left=`-${n}px`),this.rowsContainer.style.top=`-${t}px`,this.horizontalScrolling&&o!==void 0&&(this.rowsContainer.style.width=`${Math.max(o,this.renderWidth)}px`),this.lastRenderTop=t,this.lastRenderHeight=i}insertItemInDOM(e,t){const i=this.items[e];if(!i.row)if(t)i.row=t,i.stale=!0;else{const l=this.cache.alloc(i.templateId);i.row=l.row,i.stale||=l.isReusingConnectedDomNode}const n=this.accessibilityProvider.getRole(i.element)||"listitem";i.row.domNode.setAttribute("role",n);const o=this.accessibilityProvider.isChecked(i.element);if(typeof o=="boolean")i.row.domNode.setAttribute("aria-checked",String(!!o));else if(o){const l=c=>i.row.domNode.setAttribute("aria-checked",String(!!c));l(o.value),i.checkedDisposable=o.onDidChange(()=>l(o.value))}if(i.stale||!i.row.domNode.parentElement){const l=this.items.at(e+1)?.row?.domNode??null;(i.row.domNode.parentElement!==this.rowsContainer||i.row.domNode.nextElementSibling!==l)&&this.rowsContainer.insertBefore(i.row.domNode,l),i.stale=!1}this.updateItemInDOM(i,e);const r=this.renderers.get(i.templateId);if(!r)throw new Error(`No renderer found for template id ${i.templateId}`);r?.renderElement(i.element,e,i.row.templateData,i.size);const a=this.dnd.getDragURI(i.element);i.dragStartDisposable.dispose(),i.row.domNode.draggable=!!a,a&&(i.dragStartDisposable=U(i.row.domNode,"dragstart",l=>this.onDragStart(i.element,a,l))),this.horizontalScrolling&&(this.measureItemWidth(i),this.eventuallyUpdateScrollWidth())}measureItemWidth(e){if(!e.row||!e.row.domNode)return;e.row.domNode.style.width="fit-content",e.width=jk(e.row.domNode);const t=ke(e.row.domNode).getComputedStyle(e.row.domNode);t.paddingLeft&&(e.width+=parseFloat(t.paddingLeft)),t.paddingRight&&(e.width+=parseFloat(t.paddingRight)),e.row.domNode.style.width=""}updateItemInDOM(e,t){e.row.domNode.style.top=`${this.elementTop(t)}px`,this.setRowHeight&&(e.row.domNode.style.height=`${e.size}px`),this.setRowLineHeight&&(e.row.domNode.style.lineHeight=`${e.size}px`),e.row.domNode.setAttribute("data-index",`${t}`),e.row.domNode.setAttribute("data-last-element",t===this.length-1?"true":"false"),e.row.domNode.setAttribute("data-parity",t%2===0?"even":"odd"),e.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e.element,t,this.length))),e.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e.element,t))),e.row.domNode.setAttribute("id",this.getElementDomId(t)),e.row.domNode.classList.toggle("drop-target",e.dropTarget)}removeItemFromDOM(e){const t=this.items[e];if(t.dragStartDisposable.dispose(),t.checkedDisposable.dispose(),t.row){const i=this.renderers.get(t.templateId);i&&i.disposeElement&&i.disposeElement(t.element,e,t.row.templateData,t.size),this.cache.release(t.row),t.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e,t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:e,reuseAnimation:t})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return se.map(this.disposables.add(new tt(this.domNode,"click")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDblClick(){return se.map(this.disposables.add(new tt(this.domNode,"dblclick")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMiddleClick(){return se.filter(se.map(this.disposables.add(new tt(this.domNode,"auxclick")).event,e=>this.toMouseEvent(e),this.disposables),e=>e.browserEvent.button===1,this.disposables)}get onMouseDown(){return se.map(this.disposables.add(new tt(this.domNode,"mousedown")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOver(){return se.map(this.disposables.add(new tt(this.domNode,"mouseover")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOut(){return se.map(this.disposables.add(new tt(this.domNode,"mouseout")).event,e=>this.toMouseEvent(e),this.disposables)}get onContextMenu(){return se.any(se.map(this.disposables.add(new tt(this.domNode,"contextmenu")).event,e=>this.toMouseEvent(e),this.disposables),se.map(this.disposables.add(new tt(this.domNode,Wt.Contextmenu)).event,e=>this.toGestureEvent(e),this.disposables))}get onTouchStart(){return se.map(this.disposables.add(new tt(this.domNode,"touchstart")).event,e=>this.toTouchEvent(e),this.disposables)}get onTap(){return se.map(this.disposables.add(new tt(this.rowsContainer,Wt.Tap)).event,e=>this.toGestureEvent(e),this.disposables)}toMouseEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toTouchEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toGestureEvent(e){const t=this.getItemIndexFromEventTarget(e.initialTarget||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toDragEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element,o=this.getTargetSector(e,t);return{browserEvent:e,index:t,element:n,sector:o}}onScroll(e){try{const t=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(t,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(t){throw console.error("Got bad scroll event:",e),t}}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onDragStart(e,t,i){if(!i.dataTransfer)return;const n=this.dnd.getDragElements(e);if(i.dataTransfer.effectAllowed="copyMove",i.dataTransfer.setData(fv.TEXT,t),i.dataTransfer.setDragImage){let o;this.dnd.getDragLabel&&(o=this.dnd.getDragLabel(n,i)),typeof o>"u"&&(o=String(n.length));const r=te(".monaco-drag-image");r.textContent=o,(c=>{for(;c&&!c.classList.contains("monaco-workbench");)c=c.parentElement;return c||this.domNode.ownerDocument})(this.domNode).appendChild(r),i.dataTransfer.setDragImage(r,-10,-10),setTimeout(()=>r.remove(),0)}this.domNode.classList.add("dragging"),this.currentDragData=new OC(n),Oh.CurrentDragAndDropData=new sde(n),this.dnd.onDragStart?.(this.currentDragData,i)}onDragOver(e){if(e.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),Oh.CurrentDragAndDropData&&Oh.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(e.browserEvent),!e.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(Oh.CurrentDragAndDropData)this.currentDragData=Oh.CurrentDragAndDropData;else{if(!e.browserEvent.dataTransfer.types)return!1;this.currentDragData=new ode}const t=this.dnd.onDragOver(this.currentDragData,e.element,e.index,e.sector,e.browserEvent);if(this.canDrop=typeof t=="boolean"?t:t.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;e.browserEvent.dataTransfer.dropEffect=typeof t!="boolean"&&t.effect?.type===0?"copy":"move";let i;typeof t!="boolean"&&t.feedback?i=t.feedback:typeof e.index>"u"?i=[-1]:i=[e.index],i=Pc(i).filter(o=>o>=-1&&o<this.length).sort((o,r)=>o-r),i=i[0]===-1?[-1]:i;let n=typeof t!="boolean"&&t.effect&&t.effect.position?t.effect.position:"drop-target";if(rde(this.currentDragFeedback,i)&&this.currentDragFeedbackPosition===n)return!0;if(this.currentDragFeedback=i,this.currentDragFeedbackPosition=n,this.currentDragFeedbackDisposable.dispose(),i[0]===-1)this.domNode.classList.add(n),this.rowsContainer.classList.add(n),this.currentDragFeedbackDisposable=Ce(()=>{this.domNode.classList.remove(n),this.rowsContainer.classList.remove(n)});else{if(i.length>1&&n!=="drop-target")throw new Error("Can't use multiple feedbacks with position different than 'over'");n==="drop-target-after"&&i[0]<this.length-1&&(i[0]+=1,n="drop-target-before");for(const o of i){const r=this.items[o];r.dropTarget=!0,r.row?.domNode.classList.add(n)}this.currentDragFeedbackDisposable=Ce(()=>{for(const o of i){const r=this.items[o];r.dropTarget=!1,r.row?.domNode.classList.remove(n)}})}return!0}onDragLeave(e){this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=nh(()=>this.clearDragOverFeedback(),100,this.disposables),this.currentDragData&&this.dnd.onDragLeave?.(this.currentDragData,e.element,e.index,e.browserEvent)}onDrop(e){if(!this.canDrop)return;const t=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,Oh.CurrentDragAndDropData=void 0,!(!t||!e.browserEvent.dataTransfer)&&(e.browserEvent.preventDefault(),t.update(e.browserEvent.dataTransfer),this.dnd.drop(t,e.element,e.index,e.sector,e.browserEvent))}onDragEnd(e){this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,Oh.CurrentDragAndDropData=void 0,this.dnd.onDragEnd?.(e)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackPosition=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=B.None}setupDragAndDropScrollTopAnimation(e){if(!this.dragOverAnimationDisposable){const t=G6(this.domNode).top;this.dragOverAnimationDisposable=zte(ke(this.domNode),this.animateDragAndDropScrollTop.bind(this,t))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=nh(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3,this.disposables),this.dragOverMouseY=e.pageY}animateDragAndDropScrollTop(e){if(this.dragOverMouseY===void 0)return;const t=this.dragOverMouseY-e,i=this.renderHeight-35;t<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(t-35))):t>i&&(this.scrollTop+=Math.min(14,Math.floor(.3*(t-i))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getTargetSector(e,t){if(t===void 0)return;const i=e.offsetY/this.items[t].size,n=Math.floor(i/.25);return cs(n,0,3)}getItemIndexFromEventTarget(e){const t=this.scrollableElement.getDomNode();let i=e;for(;(tn(i)||Pte(i))&&i!==this.rowsContainer&&t.contains(i);){const n=i.getAttribute("data-index");if(n){const o=Number(n);if(!isNaN(o))return o}i=i.parentElement}}getRenderRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}_rerender(e,t,i){const n=this.getRenderRange(e,t);let o,r;e===this.elementTop(n.start)?(o=n.start,r=0):n.end-n.start>1&&(o=n.start+1,r=this.elementTop(o)-e);let a=0;for(;;){const l=this.getRenderRange(e,t);let c=!1;for(let d=l.start;d<l.end;d++){const h=this.probeDynamicHeight(d);h!==0&&this.rangeMap.splice(d,1,[this.items[d]]),a+=h,c=c||h!==0}if(!c){a!==0&&this.eventuallyUpdateScrollDimensions();const d=Wn.relativeComplement(n,l);for(const u of d)for(let g=u.start;g<u.end;g++)this.items[g].row&&this.removeItemFromDOM(g);const h=Wn.relativeComplement(l,n).reverse();for(const u of h)for(let g=u.end-1;g>=u.start;g--)this.insertItemInDOM(g);for(let u=l.start;u<l.end;u++)this.items[u].row&&this.updateItemInDOM(this.items[u],u);if(typeof o=="number"){const u=this.scrollable.getFutureScrollPosition().scrollTop-e,g=this.elementTop(o)-r+u;this.setScrollTop(g,i)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(e){const t=this.items[e];if(this.virtualDelegate.getDynamicHeight){const r=this.virtualDelegate.getDynamicHeight(t.element);if(r!==null){const a=t.size;return t.size=r,t.lastDynamicHeightWidth=this.renderWidth,r-a}}if(!t.hasDynamicHeight||t.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(t.element))return 0;const i=t.size;if(t.row)return t.row.domNode.style.height="",t.size=t.row.domNode.offsetHeight,t.size===0&&!Ji(t.row.domNode,ke(t.row.domNode).document.body)&&console.warn("Measuring item node that is not in DOM! Add ListView to the DOM before measuring row height!",new Error().stack),t.lastDynamicHeightWidth=this.renderWidth,t.size-i;const{row:n}=this.cache.alloc(t.templateId);n.domNode.style.height="",this.rowsContainer.appendChild(n.domNode);const o=this.renderers.get(t.templateId);if(!o)throw new mt("Missing renderer for templateId: "+t.templateId);return o.renderElement(t.element,e,n.templateData,void 0),t.size=n.domNode.offsetHeight,o.disposeElement?.(t.element,e,n.templateData,void 0),this.virtualDelegate.setDynamicHeight?.(t.element,t.size),t.lastDynamicHeightWidth=this.renderWidth,n.domNode.remove(),this.cache.release(n),t.size-i}getElementDomId(e){return`${this.domId}_${e}`}dispose(){for(const e of this.items)if(e.dragStartDisposable.dispose(),e.checkedDisposable.dispose(),e.row){const t=this.renderers.get(e.row.templateId);t&&(t.disposeElement?.(e.element,-1,e.row.templateData,void 0),t.disposeTemplate(e.row.templateData))}this.items=[],this.domNode?.remove(),this.dragOverAnimationDisposable?.dispose(),this.disposables.dispose()}}Xc([Ti],sa.prototype,"onMouseClick",null);Xc([Ti],sa.prototype,"onMouseDblClick",null);Xc([Ti],sa.prototype,"onMouseMiddleClick",null);Xc([Ti],sa.prototype,"onMouseDown",null);Xc([Ti],sa.prototype,"onMouseOver",null);Xc([Ti],sa.prototype,"onMouseOut",null);Xc([Ti],sa.prototype,"onContextMenu",null);Xc([Ti],sa.prototype,"onTouchStart",null);Xc([Ti],sa.prototype,"onTap",null);var Sh=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o};class lde{constructor(e){this.trait=e,this.renderedElements=[]}get templateId(){return`template:${this.trait.name}`}renderTemplate(e){return e}renderElement(e,t,i){const n=this.renderedElements.findIndex(o=>o.templateData===i);if(n>=0){const o=this.renderedElements[n];this.trait.unrender(i),o.index=t}else{const o={index:t,templateData:i};this.renderedElements.push(o)}this.trait.renderIndex(t,i)}splice(e,t,i){const n=[];for(const o of this.renderedElements)o.index<e?n.push(o):o.index>=e+t&&n.push({index:o.index+i-t,templateData:o.templateData});this.renderedElements=n}renderIndexes(e){for(const{index:t,templateData:i}of this.renderedElements)e.indexOf(t)>-1&&this.trait.renderIndex(t,i)}disposeTemplate(e){const t=this.renderedElements.findIndex(i=>i.templateData===e);t<0||this.renderedElements.splice(t,1)}}let w0=class{get name(){return this._trait}get renderer(){return new lde(this)}constructor(e){this._trait=e,this.indexes=[],this.sortedIndexes=[],this._onChange=new O,this.onChange=this._onChange.event}splice(e,t,i){const n=i.length-t,o=e+t,r=[];let a=0;for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]<e;)r.push(this.sortedIndexes[a++]);for(let l=0;l<i.length;l++)i[l]&&r.push(l+e);for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]>=o;)r.push(this.sortedIndexes[a++]+n);this.renderer.splice(e,t,i.length),this._set(r,r)}renderIndex(e,t){t.classList.toggle(this._trait,this.contains(e))}unrender(e){e.classList.remove(this._trait)}set(e,t){return this._set(e,[...e].sort(jB),t)}_set(e,t,i){const n=this.indexes,o=this.sortedIndexes;this.indexes=e,this.sortedIndexes=t;const r=uN(o,e);return this.renderer.renderIndexes(r),this._onChange.fire({indexes:e,browserEvent:i}),n}get(){return this.indexes}contains(e){return Bb(this.sortedIndexes,e,jB)>=0}dispose(){At(this._onChange)}};Sh([Ti],w0.prototype,"renderer",null);class cde extends w0{constructor(e){super("selected"),this.setAriaSelected=e}renderIndex(e,t){super.renderIndex(e,t),this.setAriaSelected&&(this.contains(e)?t.setAttribute("aria-selected","true"):t.setAttribute("aria-selected","false"))}}class SD{constructor(e,t,i){this.trait=e,this.view=t,this.identityProvider=i}splice(e,t,i){if(!this.identityProvider)return this.trait.splice(e,t,new Array(i.length).fill(!1));const n=this.trait.get().map(a=>this.identityProvider.getId(this.view.element(a)).toString());if(n.length===0)return this.trait.splice(e,t,new Array(i.length).fill(!1));const o=new Set(n),r=i.map(a=>o.has(this.identityProvider.getId(a).toString()));this.trait.splice(e,t,r)}}function Gd(s){return s.tagName==="INPUT"||s.tagName==="TEXTAREA"}function FC(s,e){return s.classList.contains(e)?!0:s.classList.contains("monaco-list")||!s.parentElement?!1:FC(s.parentElement,e)}function D_(s){return FC(s,"monaco-editor")}function dde(s){return FC(s,"monaco-custom-toggle")}function hde(s){return FC(s,"action-item")}function eb(s){return FC(s,"monaco-tree-sticky-row")}function pv(s){return s.classList.contains("monaco-tree-sticky-container")}function Jz(s){return s.tagName==="A"&&s.classList.contains("monaco-button")||s.tagName==="DIV"&&s.classList.contains("monaco-button-dropdown")?!0:s.classList.contains("monaco-list")||!s.parentElement?!1:Jz(s.parentElement)}class eU{get onKeyDown(){return se.chain(this.disposables.add(new tt(this.view.domNode,"keydown")).event,e=>e.filter(t=>!Gd(t.target)).map(t=>new Ft(t)))}constructor(e,t,i){this.list=e,this.view=t,this.disposables=new Z,this.multipleSelectionDisposables=new Z,this.multipleSelectionSupport=i.multipleSelectionSupport,this.disposables.add(this.onKeyDown(n=>{switch(n.keyCode){case 3:return this.onEnter(n);case 16:return this.onUpArrow(n);case 18:return this.onDownArrow(n);case 11:return this.onPageUpArrow(n);case 12:return this.onPageDownArrow(n);case 9:return this.onEscape(n);case 31:this.multipleSelectionSupport&&(Qe?n.metaKey:n.ctrlKey)&&this.onCtrlA(n)}}))}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=e.multipleSelectionSupport)}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(As(this.list.length),e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}}Sh([Ti],eU.prototype,"onKeyDown",null);var vl;(function(s){s[s.Automatic=0]="Automatic",s[s.Trigger=1]="Trigger"})(vl||(vl={}));var Df;(function(s){s[s.Idle=0]="Idle",s[s.Typing=1]="Typing"})(Df||(Df={}));const ude=new class{mightProducePrintableCharacter(s){return s.ctrlKey||s.metaKey||s.altKey?!1:s.keyCode>=31&&s.keyCode<=56||s.keyCode>=21&&s.keyCode<=30||s.keyCode>=98&&s.keyCode<=107||s.keyCode>=85&&s.keyCode<=95}};class gde{constructor(e,t,i,n,o){this.list=e,this.view=t,this.keyboardNavigationLabelProvider=i,this.keyboardNavigationEventFilter=n,this.delegate=o,this.enabled=!1,this.state=Df.Idle,this.mode=vl.Automatic,this.triggered=!1,this.previouslyFocused=-1,this.enabledDisposables=new Z,this.disposables=new Z,this.updateOptions(e.options)}updateOptions(e){e.typeNavigationEnabled??!0?this.enable():this.disable(),this.mode=e.typeNavigationMode??vl.Automatic}enable(){if(this.enabled)return;let e=!1;const t=se.chain(this.enabledDisposables.add(new tt(this.view.domNode,"keydown")).event,o=>o.filter(r=>!Gd(r.target)).filter(()=>this.mode===vl.Automatic||this.triggered).map(r=>new Ft(r)).filter(r=>e||this.keyboardNavigationEventFilter(r)).filter(r=>this.delegate.mightProducePrintableCharacter(r)).forEach(r=>it.stop(r,!0)).map(r=>r.browserEvent.key)),i=se.debounce(t,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);se.reduce(se.any(t,i),(o,r)=>r===null?null:(o||"")+r,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),i(this.onClear,this,this.enabledDisposables),t(()=>e=!0,void 0,this.enabledDisposables),i(()=>e=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){const e=this.list.getFocus();if(e.length>0&&e[0]===this.previouslyFocused){const t=this.list.options.accessibilityProvider?.getAriaLabel(this.list.element(e[0]));typeof t=="string"?Ls(t):t&&Ls(t.get())}this.previouslyFocused=-1}onInput(e){if(!e){this.state=Df.Idle,this.triggered=!1;return}const t=this.list.getFocus(),i=t.length>0?t[0]:0,n=this.state===Df.Idle?1:0;this.state=Df.Typing;for(let o=0;o<this.list.length;o++){const r=(i+o+n)%this.list.length,a=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(r)),l=a&&a.toString();if(this.list.options.typeNavigationEnabled){if(typeof l<"u"){if(cv(e,l)){this.previouslyFocused=i,this.list.setFocus([r]),this.list.reveal(r);return}const c=Aae(e,l);if(c&&c[0].end-c[0].start>1&&c.length===1){this.previouslyFocused=i,this.list.setFocus([r]),this.list.reveal(r);return}}}else if(typeof l>"u"||cv(e,l)){this.previouslyFocused=i,this.list.setFocus([r]),this.list.reveal(r);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}}class fde{constructor(e,t){this.list=e,this.view=t,this.disposables=new Z;const i=se.chain(this.disposables.add(new tt(t.domNode,"keydown")).event,o=>o.filter(r=>!Gd(r.target)).map(r=>new Ft(r)));se.chain(i,o=>o.filter(r=>r.keyCode===2&&!r.ctrlKey&&!r.metaKey&&!r.shiftKey&&!r.altKey))(this.onTab,this,this.disposables)}onTab(e){if(e.target!==this.view.domNode)return;const t=this.list.getFocus();if(t.length===0)return;const i=this.view.domElement(t[0]);if(!i)return;const n=i.querySelector("[tabIndex]");if(!n||!tn(n)||n.tabIndex===-1)return;const o=ke(n).getComputedStyle(n);o.visibility==="hidden"||o.display==="none"||(e.preventDefault(),e.stopPropagation(),n.focus())}dispose(){this.disposables.dispose()}}function tU(s){return Qe?s.browserEvent.metaKey:s.browserEvent.ctrlKey}function iU(s){return s.browserEvent.shiftKey}function pde(s){return JP(s)&&s.button===2}const $B={isSelectionSingleChangeEvent:tU,isSelectionRangeChangeEvent:iU};class nU{constructor(e){this.list=e,this.disposables=new Z,this._onPointer=new O,this.onPointer=this._onPointer.event,e.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||$B),this.mouseSupport=typeof e.options.mouseSupport>"u"||!!e.options.mouseSupport,this.mouseSupport&&(e.onMouseDown(this.onMouseDown,this,this.disposables),e.onContextMenu(this.onContextMenu,this,this.disposables),e.onMouseDblClick(this.onDoubleClick,this,this.disposables),e.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(ti.addTarget(e.getHTMLElement()))),se.any(e.onMouseClick,e.onMouseMiddleClick,e.onTap)(this.onViewPointer,this,this.disposables)}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,e.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||$B))}isSelectionSingleChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(e):!1}isSelectionRangeChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(e):!1}isSelectionChangeEvent(e){return this.isSelectionSingleChangeEvent(e)||this.isSelectionRangeChangeEvent(e)}onMouseDown(e){D_(e.browserEvent.target)||Rn()!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(Gd(e.browserEvent.target)||D_(e.browserEvent.target))return;const t=typeof e.index>"u"?[]:[e.index];this.list.setFocus(t,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport||Gd(e.browserEvent.target)||D_(e.browserEvent.target)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;const t=e.index;if(typeof t>"u"){this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionChangeEvent(e))return this.changeSelection(e);this.list.setFocus([t],e.browserEvent),this.list.setAnchor(t),pde(e.browserEvent)||this.list.setSelection([t],e.browserEvent),this._onPointer.fire(e)}onDoubleClick(e){if(Gd(e.browserEvent.target)||D_(e.browserEvent.target)||this.isSelectionChangeEvent(e)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;const t=this.list.getFocus();this.list.setSelection(t,e.browserEvent)}changeSelection(e){const t=e.index;let i=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){typeof i>"u"&&(i=this.list.getFocus()[0]??t,this.list.setAnchor(i));const n=Math.min(i,t),o=Math.max(i,t),r=As(n,o+1),a=this.list.getSelection(),l=bde(uN(a,[i]),i);if(l.length===0)return;const c=uN(r,vde(a,l));this.list.setSelection(c,e.browserEvent),this.list.setFocus([t],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){const n=this.list.getSelection(),o=n.filter(r=>r!==t);this.list.setFocus([t]),this.list.setAnchor(t),n.length===o.length?this.list.setSelection([...o,t],e.browserEvent):this.list.setSelection(o,e.browserEvent)}}dispose(){this.disposables.dispose()}}class sU{constructor(e,t){this.styleElement=e,this.selectorSuffix=t}style(e){const t=this.selectorSuffix&&`.${this.selectorSuffix}`,i=[];e.listBackground&&i.push(`.monaco-list${t} .monaco-list-rows { background: ${e.listBackground}; }`),e.listFocusBackground&&(i.push(`.monaco-list${t}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),i.push(`.monaco-list${t}:focus .monaco-list-row.focused:hover { background-color: ${e.listFocusBackground}; }`)),e.listFocusForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(i.push(`.monaco-list${t}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),i.push(`.monaco-list${t}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listActiveSelectionIconForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.selected .codicon { color: ${e.listActiveSelectionIconForeground}; }`),e.listFocusAndSelectionBackground&&i.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }
			`),e.listFocusAndSelectionForeground&&i.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }
			`),e.listInactiveFocusForeground&&(i.push(`.monaco-list${t} .monaco-list-row.focused { color:  ${e.listInactiveFocusForeground}; }`),i.push(`.monaco-list${t} .monaco-list-row.focused:hover { color:  ${e.listInactiveFocusForeground}; }`)),e.listInactiveSelectionIconForeground&&i.push(`.monaco-list${t} .monaco-list-row.focused .codicon { color:  ${e.listInactiveSelectionIconForeground}; }`),e.listInactiveFocusBackground&&(i.push(`.monaco-list${t} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),i.push(`.monaco-list${t} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(i.push(`.monaco-list${t} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),i.push(`.monaco-list${t} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&i.push(`.monaco-list${t} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&i.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&i.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${e.listHoverForeground}; }`);const n=Ec(e.listFocusAndSelectionOutline,Ec(e.listSelectionOutline,e.listFocusOutline??""));n&&i.push(`.monaco-list${t}:focus .monaco-list-row.focused.selected { outline: 1px solid ${n}; outline-offset: -1px;}`),e.listFocusOutline&&i.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
				.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
			`);const o=Ec(e.listSelectionOutline,e.listInactiveFocusOutline??"");o&&i.push(`.monaco-list${t} .monaco-list-row.focused.selected { outline: 1px dotted ${o}; outline-offset: -1px; }`),e.listSelectionOutline&&i.push(`.monaco-list${t} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listInactiveFocusOutline&&i.push(`.monaco-list${t} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&i.push(`.monaco-list${t} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),e.listDropOverBackground&&i.push(`
				.monaco-list${t}.drop-target,
				.monaco-list${t} .monaco-list-rows.drop-target,
				.monaco-list${t} .monaco-list-row.drop-target { background-color: ${e.listDropOverBackground} !important; color: inherit !important; }
			`),e.listDropBetweenBackground&&(i.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,
			.monaco-list${t} .monaco-list-row.drop-target-before::before {
				content: ""; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`),i.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,
			.monaco-list${t} .monaco-list-row.drop-target-after::after {
				content: ""; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`)),e.tableColumnsBorder&&i.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${e.tableColumnsBorder};
				}

				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),e.tableOddRowsBackgroundColor&&i.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${e.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=i.join(`
`)}}const mde={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropOverBackground:"#383B3D",listDropBetweenBackground:"#EEEEEE",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:G.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:G.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:G.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},_de={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}}};function bde(s,e){const t=s.indexOf(e);if(t===-1)return[];const i=[];let n=t-1;for(;n>=0&&s[n]===e-(t-n);)i.push(s[n--]);for(i.reverse(),n=t;n<s.length&&s[n]===e+(n-t);)i.push(s[n++]);return i}function uN(s,e){const t=[];let i=0,n=0;for(;i<s.length||n<e.length;)if(i>=s.length)t.push(e[n++]);else if(n>=e.length)t.push(s[i++]);else if(s[i]===e[n]){t.push(s[i]),i++,n++;continue}else s[i]<e[n]?t.push(s[i++]):t.push(e[n++]);return t}function vde(s,e){const t=[];let i=0,n=0;for(;i<s.length||n<e.length;)if(i>=s.length)t.push(e[n++]);else if(n>=e.length)t.push(s[i++]);else if(s[i]===e[n]){i++,n++;continue}else s[i]<e[n]?t.push(s[i++]):n++;return t}const jB=(s,e)=>s-e;class Cde{constructor(e,t){this._templateId=e,this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map(t=>t.renderTemplate(e))}renderElement(e,t,i,n){let o=0;for(const r of this.renderers)r.renderElement(e,t,i[o++],n)}disposeElement(e,t,i,n){let o=0;for(const r of this.renderers)r.disposeElement?.(e,t,i[o],n),o+=1}disposeTemplate(e){let t=0;for(const i of this.renderers)i.disposeTemplate(e[t++])}}class yde{constructor(e){this.accessibilityProvider=e,this.templateId="a18n"}renderTemplate(e){return{container:e,disposables:new Z}}renderElement(e,t,i){const n=this.accessibilityProvider.getAriaLabel(e),o=n&&typeof n!="string"?n:fr(n);i.disposables.add(Pe(a=>{this.setAriaLabel(a.readObservable(o),i.container)}));const r=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);typeof r=="number"?i.container.setAttribute("aria-level",`${r}`):i.container.removeAttribute("aria-level")}setAriaLabel(e,t){e?t.setAttribute("aria-label",e):t.removeAttribute("aria-label")}disposeElement(e,t,i,n){i.disposables.clear()}disposeTemplate(e){e.disposables.dispose()}}class wde{constructor(e,t){this.list=e,this.dnd=t}getDragElements(e){const t=this.list.getSelectedElements();return t.indexOf(e)>-1?t:[e]}getDragURI(e){return this.dnd.getDragURI(e)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e,t)}onDragStart(e,t){this.dnd.onDragStart?.(e,t)}onDragOver(e,t,i,n,o){return this.dnd.onDragOver(e,t,i,n,o)}onDragLeave(e,t,i,n){this.dnd.onDragLeave?.(e,t,i,n)}onDragEnd(e){this.dnd.onDragEnd?.(e)}drop(e,t,i,n,o){this.dnd.drop(e,t,i,n,o)}dispose(){this.dnd.dispose()}}class Xo{get onDidChangeFocus(){return se.map(this.eventBufferer.wrapEvent(this.focus.onChange),e=>this.toListEvent(e),this.disposables)}get onDidChangeSelection(){return se.map(this.eventBufferer.wrapEvent(this.selection.onChange),e=>this.toListEvent(e),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let e=!1;const t=se.chain(this.disposables.add(new tt(this.view.domNode,"keydown")).event,o=>o.map(r=>new Ft(r)).filter(r=>e=r.keyCode===58||r.shiftKey&&r.keyCode===68).map(r=>it.stop(r,!0)).filter(()=>!1)),i=se.chain(this.disposables.add(new tt(this.view.domNode,"keyup")).event,o=>o.forEach(()=>e=!1).map(r=>new Ft(r)).filter(r=>r.keyCode===58||r.shiftKey&&r.keyCode===68).map(r=>it.stop(r,!0)).map(({browserEvent:r})=>{const a=this.getFocus(),l=a.length?a[0]:void 0,c=typeof l<"u"?this.view.element(l):void 0,d=typeof l<"u"?this.view.domElement(l):this.view.domNode;return{index:l,element:c,anchor:d,browserEvent:r}})),n=se.chain(this.view.onContextMenu,o=>o.filter(r=>!e).map(({element:r,index:a,browserEvent:l})=>({element:r,index:a,anchor:new jr(ke(this.view.domNode),l),browserEvent:l})));return se.any(t,i,n)}get onKeyDown(){return this.disposables.add(new tt(this.view.domNode,"keydown")).event}get onDidFocus(){return se.signal(this.disposables.add(new tt(this.view.domNode,"focus",!0)).event)}get onDidBlur(){return se.signal(this.disposables.add(new tt(this.view.domNode,"blur",!0)).event)}constructor(e,t,i,n,o=_de){this.user=e,this._options=o,this.focus=new w0("focused"),this.anchor=new w0("anchor"),this.eventBufferer=new mC,this._ariaLabel="",this.disposables=new Z,this._onDidDispose=new O,this.onDidDispose=this._onDidDispose.event;const r=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?this._options.accessibilityProvider?.getWidgetRole():"list";this.selection=new cde(r!=="listbox");const a=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=o.accessibilityProvider,this.accessibilityProvider&&(a.push(new yde(this.accessibilityProvider)),this.accessibilityProvider.onDidChangeActiveDescendant?.(this.onDidChangeActiveDescendant,this,this.disposables)),n=n.map(c=>new Cde(c.templateId,[...a,c]));const l={...o,dnd:o.dnd&&new wde(this,o.dnd)};if(this.view=this.createListView(t,i,n,l),this.view.domNode.setAttribute("role",r),o.styleController)this.styleController=o.styleController(this.view.domId);else{const c=$o(this.view.domNode);this.styleController=new sU(c,this.view.domId)}if(this.spliceable=new Jce([new SD(this.focus,this.view,o.identityProvider),new SD(this.selection,this.view,o.identityProvider),new SD(this.anchor,this.view,o.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new fde(this,this.view)),(typeof o.keyboardSupport!="boolean"||o.keyboardSupport)&&(this.keyboardController=new eU(this,this.view,o),this.disposables.add(this.keyboardController)),o.keyboardNavigationLabelProvider){const c=o.keyboardNavigationDelegate||ude;this.typeNavigationController=new gde(this,this.view,o.keyboardNavigationLabelProvider,o.keyboardNavigationEventFilter??(()=>!0),c),this.disposables.add(this.typeNavigationController)}this.mouseController=this.createMouseController(o),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}createListView(e,t,i,n){return new sa(e,t,i,n)}createMouseController(e){return new nU(this)}updateOptions(e={}){this._options={...this._options,...e},this.typeNavigationController?.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(e),this.keyboardController?.updateOptions(e),this.view.updateOptions(e)}get options(){return this._options}splice(e,t,i=[]){if(e<0||e>this.view.length)throw new Ph(this.user,`Invalid start index: ${e}`);if(t<0)throw new Ph(this.user,`Invalid delete count: ${t}`);t===0&&i.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(e,t,i))}rerender(){this.view.rerender()}element(e){return this.view.element(e)}indexOf(e){return this.view.indexOf(e)}indexAt(e){return this.view.indexAt(e)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.view.domNode.setAttribute("aria-label",e)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(e,t){this.view.layout(e,t)}setSelection(e,t){for(const i of e)if(i<0||i>=this.length)throw new Ph(this.user,`Invalid index ${i}`);this.selection.set(e,t)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(e=>this.view.element(e))}setAnchor(e){if(typeof e>"u"){this.anchor.set([]);return}if(e<0||e>=this.length)throw new Ph(this.user,`Invalid index ${e}`);this.anchor.set([e])}getAnchor(){return LP(this.anchor.get(),void 0)}getAnchorElement(){const e=this.getAnchor();return typeof e>"u"?void 0:this.element(e)}setFocus(e,t){for(const i of e)if(i<0||i>=this.length)throw new Ph(this.user,`Invalid index ${i}`);this.focus.set(e,t)}focusNext(e=1,t=!1,i,n){if(this.length===0)return;const o=this.focus.get(),r=this.findNextIndex(o.length>0?o[0]+e:0,t,n);r>-1&&this.setFocus([r],i)}focusPrevious(e=1,t=!1,i,n){if(this.length===0)return;const o=this.focus.get(),r=this.findPreviousIndex(o.length>0?o[0]-e:0,t,n);r>-1&&this.setFocus([r],i)}async focusNextPage(e,t){let i=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);i=i===0?0:i-1;const n=this.getFocus()[0];if(n!==i&&(n===void 0||i>n)){const o=this.findPreviousIndex(i,!1,t);o>-1&&n!==o?this.setFocus([o],e):this.setFocus([i],e)}else{const o=this.view.getScrollTop();let r=o+this.view.renderHeight;i>n&&(r-=this.view.elementHeight(i)),this.view.setScrollTop(r),this.view.getScrollTop()!==o&&(this.setFocus([]),await Wc(0),await this.focusNextPage(e,t))}}async focusPreviousPage(e,t,i=()=>0){let n;const o=i(),r=this.view.getScrollTop()+o;r===0?n=this.view.indexAt(r):n=this.view.indexAfter(r-1);const a=this.getFocus()[0];if(a!==n&&(a===void 0||a>=n)){const l=this.findNextIndex(n,!1,t);l>-1&&a!==l?this.setFocus([l],e):this.setFocus([n],e)}else{const l=r;this.view.setScrollTop(r-this.view.renderHeight-o),this.view.getScrollTop()+i()!==l&&(this.setFocus([]),await Wc(0),await this.focusPreviousPage(e,t,i))}}focusLast(e,t){if(this.length===0)return;const i=this.findPreviousIndex(this.length-1,!1,t);i>-1&&this.setFocus([i],e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,i){if(this.length===0)return;const n=this.findNextIndex(e,!1,i);n>-1&&this.setFocus([n],t)}findNextIndex(e,t=!1,i){for(let n=0;n<this.length;n++){if(e>=this.length&&!t)return-1;if(e=e%this.length,!i||i(this.element(e)))return e;e++}return-1}findPreviousIndex(e,t=!1,i){for(let n=0;n<this.length;n++){if(e<0&&!t)return-1;if(e=(this.length+e%this.length)%this.length,!i||i(this.element(e)))return e;e--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(e=>this.view.element(e))}reveal(e,t,i=0){if(e<0||e>=this.length)throw new Ph(this.user,`Invalid index ${e}`);const n=this.view.getScrollTop(),o=this.view.elementTop(e),r=this.view.elementHeight(e);if(Jd(t)){const a=r-this.view.renderHeight+i;this.view.setScrollTop(a*cs(t,0,1)+o-i)}else{const a=o+r,l=n+this.view.renderHeight;o<n+i&&a>=l||(o<n+i||a>=l&&r>=this.view.renderHeight?this.view.setScrollTop(o-i):a>=l&&this.view.setScrollTop(a-this.view.renderHeight))}}getRelativeTop(e,t=0){if(e<0||e>=this.length)throw new Ph(this.user,`Invalid index ${e}`);const i=this.view.getScrollTop(),n=this.view.elementTop(e),o=this.view.elementHeight(e);if(n<i+t||n+o>i+this.view.renderHeight)return null;const r=o-this.view.renderHeight+t;return Math.abs((i+t-n)/r)}getHTMLElement(){return this.view.domNode}getScrollableElement(){return this.view.scrollableElementDomNode}getElementID(e){return this.view.getElementDomId(e)}getElementTop(e){return this.view.elementTop(e)}style(e){this.styleController.style(e)}toListEvent({indexes:e,browserEvent:t}){return{indexes:e,elements:e.map(i=>this.view.element(i)),browserEvent:t}}_onFocusChange(){const e=this.focus.get();this.view.domNode.classList.toggle("element-focused",e.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){const e=this.focus.get();if(e.length>0){let t;this.accessibilityProvider?.getActiveDescendantId&&(t=this.accessibilityProvider.getActiveDescendantId(this.view.element(e[0]))),this.view.domNode.setAttribute("aria-activedescendant",t||this.view.getElementDomId(e[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){const e=this.selection.get();this.view.domNode.classList.toggle("selection-none",e.length===0),this.view.domNode.classList.toggle("selection-single",e.length===1),this.view.domNode.classList.toggle("selection-multiple",e.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}}Sh([Ti],Xo.prototype,"onDidChangeFocus",null);Sh([Ti],Xo.prototype,"onDidChangeSelection",null);Sh([Ti],Xo.prototype,"onContextMenu",null);Sh([Ti],Xo.prototype,"onKeyDown",null);Sh([Ti],Xo.prototype,"onDidFocus",null);Sh([Ti],Xo.prototype,"onDidBlur",null);const vu=te,oU="selectOption.entry.template";class Sde{get templateId(){return oU}renderTemplate(e){const t=Object.create(null);return t.root=e,t.text=X(e,vu(".option-text")),t.detail=X(e,vu(".option-detail")),t.decoratorRight=X(e,vu(".option-decorator-right")),t}renderElement(e,t,i){const n=i,o=e.text,r=e.detail,a=e.decoratorRight,l=e.isDisabled;n.text.textContent=o,n.detail.textContent=r||"",n.decoratorRight.innerText=a||"",l?n.root.classList.add("option-disabled"):n.root.classList.remove("option-disabled")}disposeTemplate(e){}}class ru extends B{static{this.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32}static{this.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2}static{this.DEFAULT_MINIMUM_VISIBLE_OPTIONS=3}constructor(e,t,i,n,o){super(),this.options=[],this._currentSelection=0,this._hasDetails=!1,this._skipLayout=!1,this._sticky=!1,this._isVisible=!1,this.styles=n,this.selectBoxOptions=o||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=ru.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new O,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(i),this.selected=t||0,e&&this.setOptions(e,t),this.initStyleSheet()}setTitle(e){!this._hover&&e?this._hover=this._register(Ka().setupManagedHover(Ds("mouse"),this.selectElement,e)):this._hover&&this._hover.update(e)}getHeight(){return 22}getTemplateId(){return oU}constructSelectDropDown(e){this.contextViewProvider=e,this.selectDropDownContainer=te(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=X(this.selectDropDownContainer,vu(".select-box-details-pane"));const t=X(this.selectDropDownContainer,vu(".select-box-dropdown-container-width-control")),i=X(t,vu(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",X(i,this.widthControlElement),this._dropDownPosition=0,this.styleElement=$o(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(U(this.selectDropDownContainer,ee.DRAG_START,n=>{it.stop(n,!0)}))}registerListeners(){this._register(gi(this.selectElement,"change",t=>{this.selected=t.target.selectedIndex,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)})),this._register(U(this.selectElement,ee.CLICK,t=>{it.stop(t),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(U(this.selectElement,ee.MOUSE_DOWN,t=>{it.stop(t)}));let e;this._register(U(this.selectElement,"touchstart",t=>{e=this._isVisible})),this._register(U(this.selectElement,"touchend",t=>{it.stop(t),e?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(U(this.selectElement,ee.KEY_DOWN,t=>{const i=new Ft(t);let n=!1;Qe?(i.keyCode===18||i.keyCode===16||i.keyCode===10||i.keyCode===3)&&(n=!0):(i.keyCode===18&&i.altKey||i.keyCode===16&&i.altKey||i.keyCode===10||i.keyCode===3)&&(n=!0),n&&(this.showSelectDropDown(),it.stop(t,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){ii(this.options,e)||(this.options=e,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((i,n)=>{this.selectElement.add(this.createOption(i.text,n,i.isDisabled)),typeof i.description=="string"&&(this._hasDetails=!0)})),t!==void 0&&(this.select(t),this._currentSelection=this.selected)}setOptionsList(){this.selectList?.splice(0,this.selectList.length,this.options)}select(e){e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){this.container=e,e.classList.add("select-container"),e.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){const e=[];this.styles.listFocusBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(e.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=e.join(`
`)}styleSelectElement(){const e=this.styles.selectBackground??"",t=this.styles.selectForeground??"",i=this.styles.selectBorder??"";this.selectElement.style.backgroundColor=e,this.selectElement.style.color=t,this.selectElement.style.borderColor=i}styleList(){const e=this.styles.selectBackground??"",t=Ec(this.styles.selectListBackground,e);this.selectDropDownListContainer.style.backgroundColor=t,this.selectionDetailsPane.style.backgroundColor=t;const i=this.styles.focusBorder??"";this.selectDropDownContainer.style.outlineColor=i,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(e,t,i){const n=document.createElement("option");return n.value=e,n.text=e,n.disabled=!!i,n}showSelectDropDown(){this.selectionDetailsPane.innerText="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(e){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),e&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(e,t){return e.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(t),{dispose:()=>{this.selectDropDownContainer.remove()}}}measureMaxDetailsHeight(){let e=0;return this.options.forEach((t,i)=>{this.updateDetail(i),this.selectionDetailsPane.offsetHeight>e&&(e=this.selectionDetailsPane.offsetHeight)}),e}layoutSelectDropDown(e){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");const t=ke(this.selectElement),i=Si(this.selectElement),n=ke(this.selectElement).getComputedStyle(this.selectElement),o=parseFloat(n.getPropertyValue("--dropdown-padding-top"))+parseFloat(n.getPropertyValue("--dropdown-padding-bottom")),r=t.innerHeight-i.top-i.height-(this.selectBoxOptions.minBottomMargin||0),a=i.top-ru.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,l=this.selectElement.offsetWidth,c=this.setWidthControlElement(this.widthControlElement),d=Math.max(c,Math.round(l)).toString()+"px";this.selectDropDownContainer.style.width=d,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let h=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());const u=this._hasDetails?this._cachedMaxDetailsHeight:0,g=h+o+u,f=Math.floor((r-o-u)/this.getHeight()),m=Math.floor((a-o-u)/this.getHeight());if(e)return i.top+i.height>t.innerHeight-22||i.top<ru.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||f<1&&m<1?!1:(f<ru.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&m>f&&this.options.length>f?(this._dropDownPosition=1,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(i.top+i.height>t.innerHeight-22||i.top<ru.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&f<1||this._dropDownPosition===1&&m<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&f+m<1)return this.hideSelectDropDown(!0),!1;g>r&&(h=f*this.getHeight())}else g>a&&(h=m*this.getHeight());return this.selectList.layout(h),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=h+o+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=h+o+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=d,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(e){let t=0;if(e){let i=0,n=0;this.options.forEach((o,r)=>{const a=o.detail?o.detail.length:0,l=o.decoratorRight?o.decoratorRight.length:0,c=o.text.length+a+l;c>n&&(i=r,n=c)}),e.textContent=this.options[i].text+(this.options[i].decoratorRight?this.options[i].decoratorRight+" ":""),t=io(e)}return t}createSelectList(e){if(this.selectList)return;this.selectDropDownListContainer=X(e,vu(".select-box-dropdown-list-container")),this.listRenderer=new Sde,this.selectList=this._register(new Xo("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:n=>{let o=n.text;return n.detail&&(o+=`. ${n.detail}`),n.decoratorRight&&(o+=`. ${n.decoratorRight}`),n.description&&(o+=`. ${n.description}`),o},getWidgetAriaLabel:()=>p({key:"selectBox",comment:["Behave like native select dropdown element."]},"Select Box"),getRole:()=>Qe?"":"option",getWidgetRole:()=>"listbox"}})),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);const t=this._register(new tt(this.selectDropDownListContainer,"keydown")),i=se.chain(t.event,n=>n.filter(()=>this.selectList.length>0).map(o=>new Ft(o)));this._register(se.chain(i,n=>n.filter(o=>o.keyCode===3))(this.onEnter,this)),this._register(se.chain(i,n=>n.filter(o=>o.keyCode===2))(this.onEnter,this)),this._register(se.chain(i,n=>n.filter(o=>o.keyCode===9))(this.onEscape,this)),this._register(se.chain(i,n=>n.filter(o=>o.keyCode===16))(this.onUpArrow,this)),this._register(se.chain(i,n=>n.filter(o=>o.keyCode===18))(this.onDownArrow,this)),this._register(se.chain(i,n=>n.filter(o=>o.keyCode===12))(this.onPageDown,this)),this._register(se.chain(i,n=>n.filter(o=>o.keyCode===11))(this.onPageUp,this)),this._register(se.chain(i,n=>n.filter(o=>o.keyCode===14))(this.onHome,this)),this._register(se.chain(i,n=>n.filter(o=>o.keyCode===13))(this.onEnd,this)),this._register(se.chain(i,n=>n.filter(o=>o.keyCode>=21&&o.keyCode<=56||o.keyCode>=85&&o.keyCode<=113))(this.onCharacter,this)),this._register(U(this.selectList.getHTMLElement(),ee.POINTER_UP,n=>this.onPointerUp(n))),this._register(this.selectList.onMouseOver(n=>typeof n.index<"u"&&this.selectList.setFocus([n.index]))),this._register(this.selectList.onDidChangeFocus(n=>this.onListFocus(n))),this._register(U(this.selectDropDownContainer,ee.FOCUS_OUT,n=>{!this._isVisible||Ji(n.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(e){if(!this.selectList.length)return;it.stop(e);const t=e.target;if(!t||t.classList.contains("slider"))return;const i=t.closest(".monaco-list-row");if(!i)return;const n=Number(i.getAttribute("data-index")),o=i.classList.contains("option-disabled");n>=0&&n<this.options.length&&!o&&(this.selected=n,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(e,t){const i=o=>{for(let r=0;r<o.childNodes.length;r++){const a=o.childNodes.item(r);(a.tagName&&a.tagName.toLowerCase())==="img"?a.remove():i(a)}},n=tx({value:e,supportThemeIcons:!0},{actionHandler:t});return n.element.classList.add("select-box-description-markdown"),i(n.element),n.element}onListFocus(e){!this._isVisible||!this._hasDetails||this.updateDetail(e.indexes[0])}updateDetail(e){this.selectionDetailsPane.innerText="";const t=this.options[e],i=t?.description??"",n=t?.descriptionIsMarkdown??!1;if(i){if(n){const o=t.descriptionMarkdownActionHandler;this.selectionDetailsPane.appendChild(this.renderDescriptionMarkdown(i,o))}else this.selectionDetailsPane.innerText=i;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(e){it.stop(e),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(e){it.stop(e),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(e){if(this.selected<this.options.length-1){it.stop(e,!0);const t=this.options[this.selected+1].isDisabled;if(t&&this.options.length>this.selected+2)this.selected+=2;else{if(t)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(e){this.selected>0&&(it.stop(e,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(e){it.stop(e),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(e){it.stop(e),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(e){it.stop(e),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(e){it.stop(e),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(e){const t=fc.toString(e.keyCode);let i=-1;for(let n=0;n<this.options.length-1;n++)if(i=(n+this.selected+1)%this.options.length,this.options[i].text.charAt(0).toUpperCase()===t&&!this.options[i].isDisabled){this.select(i),this.selectList.setFocus([i]),this.selectList.reveal(this.selectList.getFocus()[0]),it.stop(e);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}}class Lde extends B{constructor(e,t,i,n){super(),this.selected=0,this.selectBoxOptions=n||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new O),this.styles=i,this.registerListeners(),this.setOptions(e,t)}registerListeners(){this._register(ti.addTarget(this.selectElement)),[Wt.Tap].forEach(e=>{this._register(U(this.selectElement,e,t=>{this.selectElement.focus()}))}),this._register(gi(this.selectElement,"click",e=>{it.stop(e,!0)})),this._register(gi(this.selectElement,"change",e=>{this.selectElement.title=e.target.value,this._onDidSelect.fire({index:e.target.selectedIndex,selected:e.target.value})})),this._register(gi(this.selectElement,"keydown",e=>{let t=!1;Qe?(e.keyCode===18||e.keyCode===16||e.keyCode===10)&&(t=!0):(e.keyCode===18&&e.altKey||e.keyCode===10||e.keyCode===3)&&(t=!0),t&&e.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){(!this.options||!ii(this.options,e))&&(this.options=e,this.selectElement.options.length=0,this.options.forEach((i,n)=>{this.selectElement.add(this.createOption(i.text,n,i.isDisabled))})),t!==void 0&&this.select(t)}select(e){this.options.length===0?this.selected=0:e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){e.classList.add("select-container"),e.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}applyStyles(){this.selectElement&&(this.selectElement.style.backgroundColor=this.styles.selectBackground??"",this.selectElement.style.color=this.styles.selectForeground??"",this.selectElement.style.borderColor=this.styles.selectBorder??"")}createOption(e,t,i){const n=document.createElement("option");return n.value=e,n.text=e,n.disabled=!!i,n}}class xde extends Yo{constructor(e,t,i,n,o){super(),Qe&&!o?.useCustomDrawn?this.selectBoxDelegate=new Lde(e,t,n,o):this.selectBoxDelegate=new ru(e,t,i,n,o),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(e,t){this.selectBoxDelegate.setOptions(e,t)}select(e){this.selectBoxDelegate.select(e)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(e){this.selectBoxDelegate.setFocusable(e)}render(e){this.selectBoxDelegate.render(e)}}class La extends B{get action(){return this._action}constructor(e,t,i={}){super(),this.options=i,this._context=e||this,this._action=t,t instanceof ho&&this._register(t.onDidChange(n=>{this.element&&this.handleActionChangeEvent(n)}))}handleActionChangeEvent(e){e.enabled!==void 0&&this.updateEnabled(),e.checked!==void 0&&this.updateChecked(),e.class!==void 0&&this.updateClass(),e.label!==void 0&&(this.updateLabel(),this.updateTooltip()),e.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new Zu)),this._actionRunner}set actionRunner(e){this._actionRunner=e}isEnabled(){return this._action.enabled}setActionContext(e){this._context=e}render(e){const t=this.element=e;this._register(ti.addTarget(e));const i=this.options&&this.options.draggable;i&&(e.draggable=!0,vr&&this._register(U(e,ee.DRAG_START,n=>n.dataTransfer?.setData(fv.TEXT,this._action.label)))),this._register(U(t,Wt.Tap,n=>this.onClick(n,!0))),this._register(U(t,ee.MOUSE_DOWN,n=>{i||it.stop(n,!0),this._action.enabled&&n.button===0&&t.classList.add("active")})),Qe&&this._register(U(t,ee.CONTEXT_MENU,n=>{n.button===0&&n.ctrlKey===!0&&this.onClick(n)})),this._register(U(t,ee.CLICK,n=>{it.stop(n,!0),this.options&&this.options.isMenu||this.onClick(n)})),this._register(U(t,ee.DBLCLICK,n=>{it.stop(n,!0)})),[ee.MOUSE_UP,ee.MOUSE_OUT].forEach(n=>{this._register(U(t,n,o=>{it.stop(o),t.classList.remove("active")}))})}onClick(e,t=!1){it.stop(e,!0);const i=Mo(this._context)?this.options?.useEventAsContext?e:{preserveFocus:t}:this._context;this.actionRunner.run(this._action,i)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(e){this.element&&(this.element.tabIndex=e?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getClass(){return this.action.class}getTooltip(){return this.action.tooltip}updateTooltip(){if(!this.element)return;const e=this.getTooltip()??"";if(this.updateAriaLabel(),this.options.hoverDelegate?.showNativeHover)this.element.title=e;else if(!this.customHover&&e!==""){const t=this.options.hoverDelegate??Ds("element");this.customHover=this._store.add(Ka().setupManagedHover(t,this.element,e))}else this.customHover&&this.customHover.update(e)}updateAriaLabel(){if(this.element){const e=this.getTooltip()??"";this.element.setAttribute("aria-label",e)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}}class Bp extends La{constructor(e,t,i){super(e,t,i),this.options=i,this.options.icon=i.icon!==void 0?i.icon:!1,this.options.label=i.label!==void 0?i.label:!0,this.cssClass=""}render(e){super.render(e),gt(this.element);const t=document.createElement("a");if(t.classList.add("action-label"),t.setAttribute("role",this.getDefaultAriaRole()),this.label=t,this.element.appendChild(t),this.options.label&&this.options.keybinding){const i=document.createElement("span");i.classList.add("keybinding"),i.textContent=this.options.keybinding,this.element.appendChild(i)}this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===ji.ID?"presentation":this.options.isMenu?"menuitem":this.options.isTabList?"tab":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(e){this.label&&(this.label.tabIndex=e?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:!this.options.label&&this.action.label&&this.options.icon&&(e=this.action.label,this.options.keybinding&&(e=p({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",e,this.options.keybinding))),e??void 0}updateClass(){this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getClass(),this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):this.label?.classList.remove("codicon")}updateEnabled(){this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),this.element?.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),this.element?.classList.add("disabled"))}updateAriaLabel(){if(this.label){const e=this.getTooltip()??"";this.label.setAttribute("aria-label",e)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.options.isTabList?this.label.setAttribute("aria-selected",this.action.checked?"true":"false"):(this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox"))):(this.label.classList.remove("checked"),this.label.removeAttribute(this.options.isTabList?"aria-selected":"aria-checked"),this.label.setAttribute("role",this.getDefaultAriaRole())))}}class kde extends La{constructor(e,t,i,n,o,r,a){super(e,t),this.selectBox=new xde(i,n,o,r,a),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}select(e){this.selectBox.select(e)}registerListeners(){this._register(this.selectBox.onDidSelect(e=>this.runAction(e.selected,e.index)))}runAction(e,t){this.actionRunner.run(this._action,this.getActionContext(e,t))}getActionContext(e,t){return e}setFocusable(e){this.selectBox.setFocusable(e)}focus(){this.selectBox?.focus()}blur(){this.selectBox?.blur()}render(e){this.selectBox.render(e)}}class Dde extends Zu{constructor(e,t){super(),this._onDidChangeVisibility=this._register(new O),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._element=X(e,te(".monaco-dropdown")),this._label=X(this._element,te(".dropdown-label"));let i=t.labelRenderer;i||(i=o=>(o.textContent=t.label||"",null));for(const o of[ee.CLICK,ee.MOUSE_DOWN,Wt.Tap])this._register(U(this.element,o,r=>it.stop(r,!0)));for(const o of[ee.MOUSE_DOWN,Wt.Tap])this._register(U(this._label,o,r=>{JP(r)&&(r.detail>1||r.button!==0)||(this.visible?this.hide():this.show())}));this._register(U(this._label,ee.KEY_UP,o=>{const r=new Ft(o);(r.equals(3)||r.equals(10))&&(it.stop(o,!0),this.visible?this.hide():this.show())}));const n=i(this._label);n&&this._register(n),this._register(ti.addTarget(this._label))}get element(){return this._element}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}}class Ide extends Dde{constructor(e,t){super(e,t),this._options=t,this._actions=[],this.actions=t.actions||[]}set menuOptions(e){this._menuOptions=e}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(e){this._actions=e}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(e,t)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(e,t):void 0,getKeyBinding:e=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(e):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}}class S0 extends La{constructor(e,t,i,n=Object.create(null)){super(null,e,n),this.actionItem=null,this._onDidChangeVisibility=this._register(new O),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this.menuActionsOrProvider=t,this.contextMenuProvider=i,this.options=n,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;const t=o=>{this.element=X(o,te("a.action-label"));let r=[];return typeof this.options.classNames=="string"?r=this.options.classNames.split(/\s+/g).filter(a=>!!a):this.options.classNames&&(r=this.options.classNames),r.find(a=>a==="icon")||r.push("codicon"),this.element.classList.add(...r),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this._action.label&&this._register(Ka().setupManagedHover(this.options.hoverDelegate??Ds("mouse"),this.element,this._action.label)),this.element.ariaLabel=this._action.label||"",null},i=Array.isArray(this.menuActionsOrProvider),n={contextMenuProvider:this.contextMenuProvider,labelRenderer:t,menuAsChild:this.options.menuAsChild,actions:i?this.menuActionsOrProvider:void 0,actionProvider:i?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new Ide(e,n)),this._register(this.dropdownMenu.onDidChangeVisibility(o=>{this.element?.setAttribute("aria-expanded",`${o}`),this._onDidChangeVisibility.fire(o)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){const o=this;this.dropdownMenu.menuOptions={...this.dropdownMenu.menuOptions,get anchorAlignment(){return o.options.anchorAlignmentProvider()}}}this.updateTooltip(),this.updateEnabled()}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:this.action.label&&(e=this.action.label),e??void 0}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}show(){this.dropdownMenu?.show()}updateEnabled(){const e=!this.action.enabled;this.actionItem?.classList.toggle("disabled",e),this.element?.classList.toggle("disabled",e)}}function Tde(s){return s&&typeof s=="object"&&typeof s.original=="string"&&typeof s.value=="string"}function Ede(s){return s?s.condition!==void 0:!1}var Jf;(function(s){s[s.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST",s[s.STORAGE_IN_MEMORY=1]="STORAGE_IN_MEMORY"})(Jf||(Jf={}));var If;(function(s){s[s.None=0]="None",s[s.Initialized=1]="Initialized",s[s.Closed=2]="Closed"})(If||(If={}));class tb extends B{static{this.DEFAULT_FLUSH_DELAY=100}constructor(e,t=Object.create(null)){super(),this.database=e,this.options=t,this._onDidChangeStorage=this._register(new Vu),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=If.None,this.cache=new Map,this.flushDelayer=this._register(new O6(tb.DEFAULT_FLUSH_DELAY)),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(e=>this.onDidChangeItemsExternal(e)))}onDidChangeItemsExternal(e){this._onDidChangeStorage.pause();try{e.changed?.forEach((t,i)=>this.acceptExternal(i,t)),e.deleted?.forEach(t=>this.acceptExternal(t,void 0))}finally{this._onDidChangeStorage.resume()}}acceptExternal(e,t){if(this.state===If.Closed)return;let i=!1;Mo(t)?i=this.cache.delete(e):this.cache.get(e)!==t&&(this.cache.set(e,t),i=!0),i&&this._onDidChangeStorage.fire({key:e,external:!0})}get(e,t){const i=this.cache.get(e);return Mo(i)?t:i}getBoolean(e,t){const i=this.get(e);return Mo(i)?t:i==="true"}getNumber(e,t){const i=this.get(e);return Mo(i)?t:parseInt(i,10)}async set(e,t,i=!1){if(this.state===If.Closed)return;if(Mo(t))return this.delete(e,i);const n=dn(t)||Array.isArray(t)?ale(t):String(t);if(this.cache.get(e)!==n)return this.cache.set(e,n),this.pendingInserts.set(e,n),this.pendingDeletes.delete(e),this._onDidChangeStorage.fire({key:e,external:i}),this.doFlush()}async delete(e,t=!1){if(!(this.state===If.Closed||!this.cache.delete(e)))return this.pendingDeletes.has(e)||this.pendingDeletes.add(e),this.pendingInserts.delete(e),this._onDidChangeStorage.fire({key:e,external:t}),this.doFlush()}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending)return;const e={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(e).finally(()=>{if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)this.whenFlushedCallbacks.pop()?.()})}async doFlush(e){return this.options.hint===Jf.STORAGE_IN_MEMORY?this.flushPending():this.flushDelayer.trigger(()=>this.flushPending(),e)}}class LD{constructor(){this.onDidChangeItemsExternal=se.None,this.items=new Map}async updateItems(e){e.insert?.forEach((t,i)=>this.items.set(i,t)),e.delete?.forEach(t=>this.items.delete(t))}}const jw="__$__targetStorageMarker",oa=Je("storageService");var mv;(function(s){s[s.NONE=0]="NONE",s[s.SHUTDOWN=1]="SHUTDOWN"})(mv||(mv={}));function Nde(s){const e=s.get(jw);if(e)try{return JSON.parse(e)}catch{}return Object.create(null)}class X2 extends B{static{this.DEFAULT_FLUSH_INTERVAL=60*1e3}constructor(e={flushInterval:X2.DEFAULT_FLUSH_INTERVAL}){super(),this.options=e,this._onDidChangeValue=this._register(new Vu),this._onDidChangeTarget=this._register(new Vu),this._onWillSaveState=this._register(new O),this.onWillSaveState=this._onWillSaveState.event,this._workspaceKeyTargets=void 0,this._profileKeyTargets=void 0,this._applicationKeyTargets=void 0}onDidChangeValue(e,t,i){return se.filter(this._onDidChangeValue.event,n=>n.scope===e&&(t===void 0||n.key===t),i)}emitDidChangeValue(e,t){const{key:i,external:n}=t;if(i===jw){switch(e){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:e})}else this._onDidChangeValue.fire({scope:e,key:i,target:this.getKeyTargets(e)[i],external:n})}get(e,t,i){return this.getStorage(t)?.get(e,i)}getBoolean(e,t,i){return this.getStorage(t)?.getBoolean(e,i)}getNumber(e,t,i){return this.getStorage(t)?.getNumber(e,i)}store(e,t,i,n,o=!1){if(Mo(t)){this.remove(e,i,o);return}this.withPausedEmitters(()=>{this.updateKeyTarget(e,i,n),this.getStorage(i)?.set(e,t,o)})}remove(e,t,i=!1){this.withPausedEmitters(()=>{this.updateKeyTarget(e,t,void 0),this.getStorage(t)?.delete(e,i)})}withPausedEmitters(e){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}updateKeyTarget(e,t,i,n=!1){const o=this.getKeyTargets(t);typeof i=="number"?o[e]!==i&&(o[e]=i,this.getStorage(t)?.set(jw,JSON.stringify(o),n)):typeof o[e]=="number"&&(delete o[e],this.getStorage(t)?.set(jw,JSON.stringify(o),n))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(e){switch(e){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(e){const t=this.getStorage(e);return t?Nde(t):Object.create(null)}}class Rde extends X2{constructor(){super(),this.applicationStorage=this._register(new tb(new LD,{hint:Jf.STORAGE_IN_MEMORY})),this.profileStorage=this._register(new tb(new LD,{hint:Jf.STORAGE_IN_MEMORY})),this.workspaceStorage=this._register(new tb(new LD,{hint:Jf.STORAGE_IN_MEMORY})),this._register(this.workspaceStorage.onDidChangeStorage(e=>this.emitDidChangeValue(1,e))),this._register(this.profileStorage.onDidChangeStorage(e=>this.emitDidChangeValue(0,e))),this._register(this.applicationStorage.onDidChangeStorage(e=>this.emitDidChangeValue(-1,e)))}getStorage(e){switch(e){case-1:return this.applicationStorage;case 0:return this.profileStorage;default:return this.workspaceStorage}}}function Mde(s,e){const t={...e};for(const i in s){const n=s[i];t[i]=n!==void 0?he(n):void 0}return t}const Ade={keybindingLabelBackground:he(Lre),keybindingLabelForeground:he(xre),keybindingLabelBorder:he(kre),keybindingLabelBottomBorder:he(Dre),keybindingLabelShadow:he(ym)},Pde={buttonForeground:he(gz),buttonSeparator:he(dre),buttonBackground:he(S_),buttonHoverBackground:he(hre),buttonSecondaryForeground:he(gre),buttonSecondaryBackground:he(BE),buttonSecondaryHoverBackground:he(fre),buttonBorder:he(ure)},Ode={progressBarBackground:he(Loe)},L0={inputActiveOptionBorder:he(ZL),inputActiveOptionForeground:he(KL),inputActiveOptionBackground:he(kC)};he(L_),he(pre),he(mre),he(_re),he(bre),he(vre),he(Cre);he(yre),he(Sre),he(wre);he(Bo),he(UL),he(ym),he(lt),he(joe),he(Zoe),he(Koe),he(woe);const x0={inputBackground:he(FE),inputForeground:he(hz),inputBorder:he(uz),inputValidationInfoBorder:he(ire),inputValidationInfoBackground:he(ere),inputValidationInfoForeground:he(tre),inputValidationWarningBorder:he(ore),inputValidationWarningBackground:he(nre),inputValidationWarningForeground:he(sre),inputValidationErrorBorder:he(lre),inputValidationErrorBackground:he(rre),inputValidationErrorForeground:he(are)},Fde={listFilterWidgetBackground:he(Hre),listFilterWidgetOutline:he(Vre),listFilterWidgetNoMatchesOutline:he(zre),listFilterWidgetShadow:he(Ure),inputBoxStyles:x0,toggleStyles:L0},rU={badgeBackground:he(Vw),badgeForeground:he(Soe),badgeBorder:he(lt)};he(Uoe),he(zoe),he(sB),he(sB),he($oe);const bg={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:he(Ire),listFocusForeground:he(Tre),listFocusOutline:he(Ere),listActiveSelectionBackground:he(qu),listActiveSelectionForeground:he(ov),listActiveSelectionIconForeground:he(fz),listFocusAndSelectionOutline:he(Nre),listFocusAndSelectionBackground:he(qu),listFocusAndSelectionForeground:he(ov),listInactiveSelectionBackground:he(Rre),listInactiveSelectionIconForeground:he(Are),listInactiveSelectionForeground:he(Mre),listInactiveFocusBackground:he(Pre),listInactiveFocusOutline:he(Ore),listHoverBackground:he(pz),listHoverForeground:he(mz),listDropOverBackground:he(Fre),listDropBetweenBackground:he(Bre),listSelectionOutline:he(Xt),listHoverOutline:he(Xt),treeIndentGuidesStroke:he(_z),treeInactiveIndentGuidesStroke:he($re),treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:he(w2),tableColumnsBorder:he(jre),tableOddRowsBackgroundColor:he(Zre)};function vg(s){return Mde(s,bg)}const Bde={selectBackground:he(qL),selectListBackground:he(cre),selectForeground:he(I2),decoratorRightForeground:he(bz),selectBorder:he(T2),focusBorder:he(Tl),listFocusBackground:he(av),listInactiveSelectionIconForeground:he(E2),listFocusForeground:he(rv),listFocusOutline:moe(Xt,G.transparent.toString()),listHoverBackground:he(pz),listHoverForeground:he(mz),listHoverOutline:he(Xt),selectListBorder:he(S2),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropOverBackground:void 0,listDropBetweenBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},Wde={shadowColor:he(ym),borderColor:he(Kre),foregroundColor:he(qre),backgroundColor:he(Gre),selectionForegroundColor:he(Yre),selectionBackgroundColor:he(Xre),selectionBorderColor:he(Qre),separatorColor:he(Jre),scrollbarShadow:he(w2),scrollbarSliderBackground:he(nz),scrollbarSliderHoverBackground:he(sz),scrollbarSliderActiveBackground:he(oz)};var lx=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Ws=function(s,e){return function(t,i){e(t,i,s)}};function Hde(s,e,t,i){let n,o,r;if(Array.isArray(s))r=s,n=e,o=t;else{const c=e;r=s.getActions(c),n=t,o=i}const a=yc.getInstance(),l=a.keyStatus.altKey||(An||ys)&&a.keyStatus.shiftKey;aU(r,n,l,o?c=>c===o:c=>c==="navigation")}function cx(s,e,t,i,n,o){let r,a,l,c,d;if(Array.isArray(s))d=s,r=e,a=t,l=i,c=n;else{const u=e;d=s.getActions(u),r=t,a=i,l=n,c=o}aU(d,r,!1,typeof a=="string"?u=>u===a:a,l,c)}function aU(s,e,t,i=r=>r==="navigation",n=()=>!1,o=!1){let r,a;Array.isArray(e)?(r=e,a=e):(r=e.primary,a=e.secondary);const l=new Set;for(const[c,d]of s){let h;i(c)?(h=r,h.length>0&&o&&h.push(new ji)):(h=a,h.length>0&&h.push(new ji));for(let u of d){t&&(u=u instanceof uo&&u.alt?u.alt:u);const g=h.push(u);u instanceof Lp&&l.add({group:c,action:u,index:g-1})}}for(const{group:c,action:d,index:h}of l){const u=i(c)?r:a,g=d.actions;n(d,c,u.length)&&u.splice(h,1,...g)}}let lh=class extends Bp{constructor(e,t,i,n,o,r,a,l){super(void 0,e,{icon:!!(e.class||e.item.icon),label:!e.class&&!e.item.icon,draggable:t?.draggable,keybinding:t?.keybinding,hoverDelegate:t?.hoverDelegate}),this._options=t,this._keybindingService=i,this._notificationService=n,this._contextKeyService=o,this._themeService=r,this._contextMenuService=a,this._accessibilityService=l,this._wantsAltCommand=!1,this._itemClassDispose=this._register(new nn),this._altKey=yc.getInstance()}get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}async onClick(e){e.preventDefault(),e.stopPropagation();try{await this.actionRunner.run(this._commandAction,this._context)}catch(t){this._notificationService.error(t)}}render(e){if(super.render(e),e.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let t=!1;const i=()=>{const n=!!this._menuItemAction.alt?.enabled&&(!this._accessibilityService.isMotionReduced()||t)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&t);n!==this._wantsAltCommand&&(this._wantsAltCommand=n,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(i)),this._register(U(e,"mouseleave",n=>{t=!1,i()})),this._register(U(e,"mouseenter",n=>{t=!0,i()})),i()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){const e=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),t=e&&e.getLabel(),i=this._commandAction.tooltip||this._commandAction.label;let n=t?p("titleAndKb","{0} ({1})",i,t):i;if(!this._wantsAltCommand&&this._menuItemAction.alt?.enabled){const o=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,r=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),a=r&&r.getLabel(),l=a?p("titleAndKb","{0} ({1})",o,a):o;n=p("titleAndKbAndAlt",`{0}
[{1}] {2}`,n,K2.modifierLabels[lo].altKey,l)}return n}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(e){this._itemClassDispose.value=void 0;const{element:t,label:i}=this;if(!t||!i)return;const n=this._commandAction.checked&&Ede(e.toggled)&&e.toggled.icon?e.toggled.icon:e.icon;if(n)if(Ie.isThemeIcon(n)){const o=Ie.asClassNameArray(n);i.classList.add(...o),this._itemClassDispose.value=Ce(()=>{i.classList.remove(...o)})}else i.style.backgroundImage=Dp(this._themeService.getColorTheme().type)?Hc(n.dark):Hc(n.light),i.classList.add("icon"),this._itemClassDispose.value=Gr(Ce(()=>{i.style.backgroundImage="",i.classList.remove("icon")}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}};lh=lx([Ws(2,yt),Ws(3,Ii),Ws(4,Ee),Ws(5,Ki),Ws(6,bo),Ws(7,vo)],lh);class Q2 extends lh{render(e){this.options.label=!0,this.options.icon=!1,super.render(e),e.classList.add("text-only"),e.classList.toggle("use-comma",this._options?.useComma??!1)}updateLabel(){const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){const t=Q2._symbolPrintEnter(e);this._options?.conversational?this.label.textContent=p({key:"content2",comment:['A label with keybindg like "ESC to dismiss"']},"{1} to {0}",this._action.label,t):this.label.textContent=p({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",this._action.label,t)}}static _symbolPrintEnter(e){return e.getLabel()?.replace(/\benter\b/gi,"").replace(/\bEscape\b/gi,"Esc")}}let gN=class extends S0{constructor(e,t,i,n,o){const r={...t,menuAsChild:t?.menuAsChild??!1,classNames:t?.classNames??(Ie.isThemeIcon(e.item.icon)?Ie.asClassName(e.item.icon):void 0),keybindingProvider:t?.keybindingProvider??(a=>i.lookupKeybinding(a.id))};super(e,{getActions:()=>e.actions},n,r),this._keybindingService=i,this._contextMenuService=n,this._themeService=o}render(e){super.render(e),gt(this.element),e.classList.add("menu-entry");const t=this._action,{icon:i}=t.item;if(i&&!Ie.isThemeIcon(i)){this.element.classList.add("icon");const n=()=>{this.element&&(this.element.style.backgroundImage=Dp(this._themeService.getColorTheme().type)?Hc(i.dark):Hc(i.light))};n(),this._register(this._themeService.onDidColorThemeChange(()=>{n()}))}}};gN=lx([Ws(2,yt),Ws(3,bo),Ws(4,Ki)],gN);let fN=class extends La{constructor(e,t,i,n,o,r,a,l){super(null,e),this._keybindingService=i,this._notificationService=n,this._contextMenuService=o,this._menuService=r,this._instaService=a,this._storageService=l,this._container=null,this._options=t,this._storageKey=`${e.item.submenu.id}_lastActionId`;let c;const d=t?.persistLastActionId?l.get(this._storageKey,1):void 0;d&&(c=e.actions.find(u=>d===u.id)),c||(c=e.actions[0]),this._defaultAction=this._instaService.createInstance(lh,c,{keybinding:this._getDefaultActionKeybindingLabel(c)});const h={keybindingProvider:u=>this._keybindingService.lookupKeybinding(u.id),...t,menuAsChild:t?.menuAsChild??!0,classNames:t?.classNames??["codicon","codicon-chevron-down"],actionRunner:t?.actionRunner??new Zu};this._dropdown=new S0(e,e.actions,this._contextMenuService,h),this._register(this._dropdown.actionRunner.onDidRun(u=>{u.action instanceof uo&&this.update(u.action)}))}update(e){this._options?.persistLastActionId&&this._storageService.store(this._storageKey,e.id,1,1),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(lh,e,{keybinding:this._getDefaultActionKeybindingLabel(e)}),this._defaultAction.actionRunner=new class extends Zu{async runAction(t,i){await t.run(void 0)}},this._container&&this._defaultAction.render(e2(this._container,te(".action-container")))}_getDefaultActionKeybindingLabel(e){let t;if(this._options?.renderKeybindingWithDefaultActionLabel){const i=this._keybindingService.lookupKeybinding(e.id);i&&(t=`(${i.getLabel()})`)}return t}setActionContext(e){super.setActionContext(e),this._defaultAction.setActionContext(e),this._dropdown.setActionContext(e)}render(e){this._container=e,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");const t=te(".action-container");this._defaultAction.render(X(this._container,t)),this._register(U(t,ee.KEY_DOWN,n=>{const o=new Ft(n);o.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),o.stopPropagation())}));const i=te(".dropdown-action-container");this._dropdown.render(X(this._container,i)),this._register(U(i,ee.KEY_DOWN,n=>{const o=new Ft(n);o.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),this._defaultAction.element?.focus(),o.stopPropagation())}))}focus(e){e?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(e){e?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};fN=lx([Ws(2,yt),Ws(3,Ii),Ws(4,bo),Ws(5,qo),Ws(6,ye),Ws(7,oa)],fN);let pN=class extends kde{constructor(e,t){super(null,e,e.actions.map(i=>({text:i.id===ji.ID?"":i.label,isDisabled:!i.enabled})),0,t,Bde,{ariaLabel:e.tooltip,optionsAsChildren:!0}),this.select(Math.max(0,e.actions.findIndex(i=>i.checked)))}render(e){super.render(e),e.style.borderColor=he(T2)}runAction(e,t){const i=this.action.actions[t];i&&this.actionRunner.run(i)}};pN=lx([Ws(1,Yc)],pN);function lU(s,e,t){return e instanceof uo?s.createInstance(lh,e,t):e instanceof qf?e.item.isSelection?s.createInstance(pN,e):e.item.rememberDefaultAction?s.createInstance(fN,e,{...t,persistLastActionId:!0}):s.createInstance(gN,e,t):void 0}class zo extends B{constructor(e,t={}){super(),this._actionRunnerDisposables=this._register(new Z),this.viewItemDisposables=this._register(new RP),this.triggerKeyDown=!1,this.focusable=!0,this._onDidBlur=this._register(new O),this.onDidBlur=this._onDidBlur.event,this._onDidCancel=this._register(new O({onWillAddFirstListener:()=>this.cancelHasListener=!0})),this.onDidCancel=this._onDidCancel.event,this.cancelHasListener=!1,this._onDidRun=this._register(new O),this.onDidRun=this._onDidRun.event,this._onWillRun=this._register(new O),this.onWillRun=this._onWillRun.event,this.options=t,this._context=t.context??null,this._orientation=this.options.orientation??0,this._triggerKeys={keyDown:this.options.triggerKeys?.keyDown??!1,keys:this.options.triggerKeys?.keys??[3,10]},this._hoverDelegate=t.hoverDelegate??this._register(Fp()),this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new Zu,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(o=>this._onDidRun.fire(o))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(o=>this._onWillRun.fire(o))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar";let i,n;switch(this._orientation){case 0:i=[15],n=[17];break;case 1:i=[16],n=[18],this.domNode.className+=" vertical";break}this._register(U(this.domNode,ee.KEY_DOWN,o=>{const r=new Ft(o);let a=!0;const l=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;i&&(r.equals(i[0])||r.equals(i[1]))?a=this.focusPrevious():n&&(r.equals(n[0])||r.equals(n[1]))?a=this.focusNext():r.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():r.equals(14)?a=this.focusFirst():r.equals(13)?a=this.focusLast():r.equals(2)&&l instanceof La&&l.trapsArrowNavigation?a=this.focusNext(void 0,!0):this.isTriggerKeyEvent(r)?this._triggerKeys.keyDown?this.doTrigger(r):this.triggerKeyDown=!0:a=!1,a&&(r.preventDefault(),r.stopPropagation())})),this._register(U(this.domNode,ee.KEY_UP,o=>{const r=new Ft(o);this.isTriggerKeyEvent(r)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(r)),r.preventDefault(),r.stopPropagation()):(r.equals(2)||r.equals(1026)||r.equals(16)||r.equals(18)||r.equals(15)||r.equals(17))&&this.updateFocusedItem()})),this.focusTracker=this._register(Wa(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(Rn()===this.domNode||!Ji(Rn(),this.domNode))&&(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e.appendChild(this.domNode)}refreshRole(){this.length()>=1?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setFocusable(e){if(this.focusable=e,this.focusable){const t=this.viewItems.find(i=>i instanceof La&&i.isEnabled());t instanceof La&&t.setFocusable(!0)}else this.viewItems.forEach(t=>{t instanceof La&&t.setFocusable(!1)})}isTriggerKeyEvent(e){let t=!1;return this._triggerKeys.keys.forEach(i=>{t=t||e.equals(i)}),t}updateFocusedItem(){for(let e=0;e<this.actionsList.children.length;e++){const t=this.actionsList.children[e];if(Ji(Rn(),t)){this.focusedItem=e,this.viewItems[this.focusedItem]?.showHover?.();break}}}get context(){return this._context}set context(e){this._context=e,this.viewItems.forEach(t=>t.setActionContext(e))}get actionRunner(){return this._actionRunner}set actionRunner(e){this._actionRunner=e,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(t=>this._onDidRun.fire(t))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(t=>this._onWillRun.fire(t))),this.viewItems.forEach(t=>t.actionRunner=e)}getContainer(){return this.domNode}getAction(e){if(typeof e=="number")return this.viewItems[e]?.action;if(tn(e)){for(;e.parentElement!==this.actionsList;){if(!e.parentElement)return;e=e.parentElement}for(let t=0;t<this.actionsList.childNodes.length;t++)if(this.actionsList.childNodes[t]===e)return this.viewItems[t].action}}push(e,t={}){const i=Array.isArray(e)?e:[e];let n=Jd(t.index)?t.index:null;i.forEach(o=>{const r=document.createElement("li");r.className="action-item",r.setAttribute("role","presentation");let a;const l={hoverDelegate:this._hoverDelegate,...t,isTabList:this.options.ariaRole==="tablist"};this.options.actionViewItemProvider&&(a=this.options.actionViewItemProvider(o,l)),a||(a=new Bp(this.context,o,l)),this.options.allowContextMenu||this.viewItemDisposables.set(a,U(r,ee.CONTEXT_MENU,c=>{it.stop(c,!0)})),a.actionRunner=this._actionRunner,a.setActionContext(this.context),a.render(r),this.focusable&&a instanceof La&&this.viewItems.length===0&&a.setFocusable(!0),n===null||n<0||n>=this.actionsList.children.length?(this.actionsList.appendChild(r),this.viewItems.push(a)):(this.actionsList.insertBefore(r,this.actionsList.children[n]),this.viewItems.splice(n,0,a),n++)}),typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}clear(){this.isEmpty()||(this.viewItems=At(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),Cn(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(e){let t=!1,i;if(e===void 0?t=!0:typeof e=="number"?i=e:typeof e=="boolean"&&(t=e),t&&typeof this.focusedItem>"u"){const n=this.viewItems.findIndex(o=>o.isEnabled());this.focusedItem=n===-1?void 0:n,this.updateFocus(void 0,void 0,!0)}else i!==void 0&&(this.focusedItem=i),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(e,t){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;const i=this.focusedItem;let n;do{if(!e&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=i,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,n=this.viewItems[this.focusedItem]}while(this.focusedItem!==i&&(this.options.focusOnlyEnabledItems&&!n.isEnabled()||n.action.id===ji.ID));return this.updateFocus(void 0,void 0,t),!0}focusPrevious(e){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;const t=this.focusedItem;let i;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!e&&this.options.preventLoopNavigation)return this.focusedItem=t,!1;this.focusedItem=this.viewItems.length-1}i=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===ji.ID));return this.updateFocus(!0),!0}updateFocus(e,t,i=!1){typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&this.viewItems[this.previouslyFocusedItem]?.blur();const n=this.focusedItem!==void 0?this.viewItems[this.focusedItem]:void 0;if(n){let o=!0;Hb(n.focus)||(o=!1),this.options.focusOnlyEnabledItems&&Hb(n.isEnabled)&&!n.isEnabled()&&(o=!1),n.action.id===ji.ID&&(o=!1),o?(i||this.previouslyFocusedItem!==this.focusedItem)&&(n.focus(e),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem=void 0),o&&n.showHover?.()}}doTrigger(e){if(typeof this.focusedItem>"u")return;const t=this.viewItems[this.focusedItem];if(t instanceof La){const i=t._context===null||t._context===void 0?e:t._context;this.run(t._action,i)}}async run(e,t){await this._actionRunner.run(e,t)}dispose(){this._context=void 0,this.viewItems=At(this.viewItems),this.getContainer().remove(),super.dispose()}}const mN=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,xD=/(&amp;)?(&amp;)([^\s&])/g;var k0;(function(s){s[s.Right=0]="Right",s[s.Left=1]="Left"})(k0||(k0={}));var _N;(function(s){s[s.Above=0]="Above",s[s.Below=1]="Below"})(_N||(_N={}));class ep extends zo{constructor(e,t,i,n){e.classList.add("monaco-menu-container"),e.setAttribute("role","presentation");const o=document.createElement("div");o.classList.add("monaco-menu"),o.setAttribute("role","presentation"),super(o,{orientation:1,actionViewItemProvider:c=>this.doGetActionViewItem(c,i,r),context:i.context,actionRunner:i.actionRunner,ariaLabel:i.ariaLabel,ariaRole:"menu",focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,...Qe||ys?[10]:[]],keyDown:!0}}),this.menuStyles=n,this.menuElement=o,this.actionsList.tabIndex=0,this.initializeOrUpdateStyleSheet(e,n),this._register(ti.addTarget(o)),this._register(U(o,ee.KEY_DOWN,c=>{new Ft(c).equals(2)&&c.preventDefault()})),i.enableMnemonics&&this._register(U(o,ee.KEY_DOWN,c=>{const d=c.key.toLocaleLowerCase();if(this.mnemonics.has(d)){it.stop(c,!0);const h=this.mnemonics.get(d);if(h.length===1&&(h[0]instanceof ZB&&h[0].container&&this.focusItemByElement(h[0].container),h[0].onClick(c)),h.length>1){const u=h.shift();u&&u.container&&(this.focusItemByElement(u.container),h.push(u)),this.mnemonics.set(d,h)}}})),ys&&this._register(U(o,ee.KEY_DOWN,c=>{const d=new Ft(c);d.equals(14)||d.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),it.stop(c,!0)):(d.equals(13)||d.equals(12))&&(this.focusedItem=0,this.focusPrevious(),it.stop(c,!0))})),this._register(U(this.domNode,ee.MOUSE_OUT,c=>{const d=c.relatedTarget;Ji(d,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),c.stopPropagation())})),this._register(U(this.actionsList,ee.MOUSE_OVER,c=>{let d=c.target;if(!(!d||!Ji(d,this.actionsList)||d===this.actionsList)){for(;d.parentElement!==this.actionsList&&d.parentElement!==null;)d=d.parentElement;if(d.classList.contains("action-item")){const h=this.focusedItem;this.setFocusedItem(d),h!==this.focusedItem&&this.updateFocus()}}})),this._register(ti.addTarget(this.actionsList)),this._register(U(this.actionsList,Wt.Tap,c=>{let d=c.initialTarget;if(!(!d||!Ji(d,this.actionsList)||d===this.actionsList)){for(;d.parentElement!==this.actionsList&&d.parentElement!==null;)d=d.parentElement;if(d.classList.contains("action-item")){const h=this.focusedItem;this.setFocusedItem(d),h!==this.focusedItem&&this.updateFocus()}}}));const r={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new DC(o,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));const a=this.scrollableElement.getDomNode();a.style.position="",this.styleScrollElement(a,n),this._register(U(o,Wt.Change,c=>{it.stop(c,!0);const d=this.scrollableElement.getScrollPosition().scrollTop;this.scrollableElement.setScrollPosition({scrollTop:d-c.translationY})})),this._register(U(a,ee.MOUSE_UP,c=>{c.preventDefault()}));const l=ke(e);o.style.maxHeight=`${Math.max(10,l.innerHeight-e.getBoundingClientRect().top-35)}px`,t=t.filter((c,d)=>i.submenuIds?.has(c.id)?(console.warn(`Found submenu cycle: ${c.id}`),!1):!(c instanceof ji&&(d===t.length-1||d===0||t[d-1]instanceof ji))),this.push(t,{icon:!0,label:!0,isMenu:!0}),e.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter(c=>!(c instanceof KB)).forEach((c,d,h)=>{c.updatePositionInSet(d+1,h.length)})}initializeOrUpdateStyleSheet(e,t){this.styleSheet||(z1(e)?this.styleSheet=$o(e):(ep.globalStyleSheet||(ep.globalStyleSheet=$o()),this.styleSheet=ep.globalStyleSheet)),this.styleSheet.textContent=zde(t,z1(e))}styleScrollElement(e,t){const i=t.foregroundColor??"",n=t.backgroundColor??"",o=t.borderColor?`1px solid ${t.borderColor}`:"",r="5px",a=t.shadowColor?`0 2px 8px ${t.shadowColor}`:"";e.style.outline=o,e.style.borderRadius=r,e.style.color=i,e.style.backgroundColor=n,e.style.boxShadow=a}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}focusItemByElement(e){const t=this.focusedItem;this.setFocusedItem(e),t!==this.focusedItem&&this.updateFocus()}setFocusedItem(e){for(let t=0;t<this.actionsList.children.length;t++){const i=this.actionsList.children[t];if(e===i){this.focusedItem=t;break}}}updateFocus(e){super.updateFocus(e,!0,!0),typeof this.focusedItem<"u"&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(e,t,i){if(e instanceof ji)return new KB(t.context,e,{icon:!0},this.menuStyles);if(e instanceof Lp){const n=new ZB(e,e.actions,i,{...t,submenuIds:new Set([...t.submenuIds||[],e.id])},this.menuStyles);if(t.enableMnemonics){const o=n.getMnemonic();if(o&&n.isEnabled()){let r=[];this.mnemonics.has(o)&&(r=this.mnemonics.get(o)),r.push(n),this.mnemonics.set(o,r)}}return n}else{const n={enableMnemonics:t.enableMnemonics,useEventAsContext:t.useEventAsContext};if(t.getKeyBinding){const r=t.getKeyBinding(e);if(r){const a=r.getLabel();a&&(n.keybinding=a)}}const o=new cU(t.context,e,n,this.menuStyles);if(t.enableMnemonics){const r=o.getMnemonic();if(r&&o.isEnabled()){let a=[];this.mnemonics.has(r)&&(a=this.mnemonics.get(r)),a.push(o),this.mnemonics.set(r,a)}}return o}}}class cU extends La{constructor(e,t,i,n){if(i.isMenu=!0,super(t,t,i),this.menuStyle=n,this.options=i,this.options.icon=i.icon!==void 0?i.icon:!1,this.options.label=i.label!==void 0?i.label:!0,this.cssClass="",this.options.label&&i.enableMnemonics){const o=this.action.label;if(o){const r=mN.exec(o);r&&(this.mnemonic=(r[1]?r[1]:r[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new It(()=>{this.element&&(this._register(U(this.element,ee.MOUSE_UP,o=>{if(it.stop(o,!0),vr){if(new jr(ke(this.element),o).rightButton)return;this.onClick(o)}else setTimeout(()=>{this.onClick(o)},0)})),this._register(U(this.element,ee.CONTEXT_MENU,o=>{it.stop(o,!0)})))},100),this._register(this.runOnceToEnableMouseUp)}render(e){super.render(e),this.element&&(this.container=e,this.item=X(this.element,te("a.action-menu-item")),this._action.id===ji.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=X(this.item,te("span.menu-item-check"+Ie.asCSSSelector(J.menuSelection))),this.check.setAttribute("role","none"),this.label=X(this.item,te("span.action-label")),this.options.label&&this.options.keybinding&&(X(this.item,te("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked(),this.applyStyle())}blur(){super.blur(),this.applyStyle()}focus(){super.focus(),this.item?.focus(),this.applyStyle()}updatePositionInSet(e,t){this.item&&(this.item.setAttribute("aria-posinset",`${e}`),this.item.setAttribute("aria-setsize",`${t}`))}updateLabel(){if(this.label&&this.options.label){Cn(this.label);let e=V2(this.action.label);if(e){const t=Vde(e);this.options.enableMnemonics||(e=t),this.label.setAttribute("aria-label",t.replace(/&&/g,"&"));const i=mN.exec(e);if(i){e=K_(e),xD.lastIndex=0;let n=xD.exec(e);for(;n&&n[1];)n=xD.exec(e);const o=r=>r.replace(/&amp;&amp;/g,"&amp;");n?this.label.append(_C(o(e.substr(0,n.index))," "),te("u",{"aria-hidden":"true"},n[3]),k6(o(e.substr(n.index+n[0].length))," ")):this.label.innerText=o(e).trim(),this.item?.setAttribute("aria-keyshortcuts",(i[1]?i[1]:i[3]).toLocaleLowerCase())}else this.label.innerText=e.replace(/&&/g,"&").trim()}}}updateTooltip(){}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.action.class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.action.enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){if(!this.item)return;const e=this.action.checked;this.item.classList.toggle("checked",!!e),e!==void 0?(this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked",e?"true":"false")):(this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked",""))}getMnemonic(){return this.mnemonic}applyStyle(){const e=this.element&&this.element.classList.contains("focused"),t=e&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,i=e&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,n=e&&this.menuStyle.selectionBorderColor?`1px solid ${this.menuStyle.selectionBorderColor}`:"",o=e&&this.menuStyle.selectionBorderColor?"-1px":"";this.item&&(this.item.style.color=t??"",this.item.style.backgroundColor=i??"",this.item.style.outline=n,this.item.style.outlineOffset=o),this.check&&(this.check.style.color=t??"")}}class ZB extends cU{constructor(e,t,i,n,o){super(e,e,n,o),this.submenuActions=t,this.parentData=i,this.submenuOptions=n,this.mysubmenu=null,this.submenuDisposables=this._register(new Z),this.mouseOver=!1,this.expandDirection=n&&n.expandDirection!==void 0?n.expandDirection:{horizontal:k0.Right,vertical:_N.Below},this.showScheduler=new It(()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))},250),this.hideScheduler=new It(()=>{this.element&&!Ji(Rn(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))},750)}render(e){super.render(e),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=X(this.item,te("span.submenu-indicator"+Ie.asCSSSelector(J.menuSubmenu))),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register(U(this.element,ee.KEY_UP,t=>{const i=new Ft(t);(i.equals(17)||i.equals(3))&&(it.stop(t,!0),this.createSubmenu(!0))})),this._register(U(this.element,ee.KEY_DOWN,t=>{const i=new Ft(t);Rn()===this.item&&(i.equals(17)||i.equals(3))&&it.stop(t,!0)})),this._register(U(this.element,ee.MOUSE_OVER,t=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())})),this._register(U(this.element,ee.MOUSE_LEAVE,t=>{this.mouseOver=!1})),this._register(U(this.element,ee.FOCUS_OUT,t=>{this.element&&!Ji(Rn(),this.element)&&this.hideScheduler.schedule()})),this._register(this.parentData.parent.onScroll(()=>{this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))})))}updateEnabled(){}onClick(e){it.stop(e,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(e){if(this.parentData.submenu&&(e||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch{}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(e,t,i,n){const o={top:0,left:0};return o.left=xf(e.width,t.width,{position:n.horizontal===k0.Right?0:1,offset:i.left,size:i.width}),o.left>=i.left&&o.left<i.left+i.width&&(i.left+10+t.width<=e.width&&(o.left=i.left+10),i.top+=10,i.height=0),o.top=xf(e.height,t.height,{position:0,offset:i.top,size:0}),o.top+t.height===i.top&&o.top+i.height+t.height<=e.height&&(o.top+=i.height),o}createSubmenu(e=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=X(this.element,te("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");const t=ke(this.parentData.parent.domNode).getComputedStyle(this.parentData.parent.domNode),i=parseFloat(t.paddingTop||"0")||0;this.submenuContainer.style.zIndex="1",this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.parentData.submenu=new ep(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new i2],this.submenuOptions,this.menuStyle);const n=this.element.getBoundingClientRect(),o={top:n.top-i,left:n.left,height:n.height+2*i,width:n.width},r=this.submenuContainer.getBoundingClientRect(),a=ke(this.element),{top:l,left:c}=this.calculateSubmenuMenuLayout(new bt(a.innerWidth,a.innerHeight),bt.lift(r),o,this.expandDirection);this.submenuContainer.style.left=`${c-r.left}px`,this.submenuContainer.style.top=`${l-r.top}px`,this.submenuDisposables.add(U(this.submenuContainer,ee.KEY_UP,d=>{new Ft(d).equals(15)&&(it.stop(d,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))})),this.submenuDisposables.add(U(this.submenuContainer,ee.KEY_DOWN,d=>{new Ft(d).equals(15)&&it.stop(d,!0)})),this.submenuDisposables.add(this.parentData.submenu.onDidCancel(()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)})),this.parentData.submenu.focus(e),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(e){this.item&&this.item?.setAttribute("aria-expanded",e)}applyStyle(){super.applyStyle();const t=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=t??"")}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}}class KB extends Bp{constructor(e,t,i,n){super(e,t,i),this.menuStyles=n}render(e){super.render(e),this.label&&(this.label.style.borderBottomColor=this.menuStyles.separatorColor?`${this.menuStyles.separatorColor}`:"")}}function Vde(s){const e=mN,t=e.exec(s);if(!t)return s;const i=!t[1];return s.replace(e,i?"$2$3":"").trim()}function qB(s){const e=C6()[s.id];return`.codicon-${s.id}:before { content: '\\${e.toString(16)}'; }`}function zde(s,e){let t=`
.monaco-menu {
	font-size: 13px;
	border-radius: 5px;
	min-width: 160px;
}

${qB(J.menuSelection)}
${qB(J.menuSubmenu)}

.monaco-menu .monaco-action-bar {
	text-align: right;
	overflow: hidden;
	white-space: nowrap;
}

.monaco-menu .monaco-action-bar .actions-container {
	display: flex;
	margin: 0 auto;
	padding: 0;
	width: 100%;
	justify-content: flex-end;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: inline-block;
}

.monaco-menu .monaco-action-bar.reverse .actions-container {
	flex-direction: row-reverse;
}

.monaco-menu .monaco-action-bar .action-item {
	cursor: pointer;
	display: inline-block;
	transition: transform 50ms ease;
	position: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */
}

.monaco-menu .monaco-action-bar .action-item.disabled {
	cursor: default;
}

.monaco-menu .monaco-action-bar .action-item .icon,
.monaco-menu .monaco-action-bar .action-item .codicon {
	display: inline-block;
}

.monaco-menu .monaco-action-bar .action-item .codicon {
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar .action-label {
	font-size: 11px;
	margin-right: 4px;
}

.monaco-menu .monaco-action-bar .action-item.disabled .action-label,
.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {
	color: var(--vscode-disabledForeground);
}

/* Vertical actions */

.monaco-menu .monaco-action-bar.vertical {
	text-align: left;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	display: block;
	border-bottom: 1px solid var(--vscode-menu-separatorBackground);
	padding-top: 1px;
	padding: 30px;
}

.monaco-menu .secondary-actions .monaco-action-bar .action-label {
	margin-left: 6px;
}

/* Action Items */
.monaco-menu .monaco-action-bar .action-item.select-container {
	overflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */
	flex: 1;
	max-width: 170px;
	min-width: 60px;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-right: 10px;
}

.monaco-menu .monaco-action-bar.vertical {
	margin-left: 0;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	padding: 0;
	transform: none;
	display: flex;
}

.monaco-menu .monaco-action-bar.vertical .action-item.active {
	transform: none;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	flex: 1 1 auto;
	display: flex;
	height: 2em;
	align-items: center;
	position: relative;
	margin: 0 4px;
	border-radius: 4px;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .keybinding {
	opacity: unset;
}

.monaco-menu .monaco-action-bar.vertical .action-label {
	flex: 1 1 auto;
	text-decoration: none;
	padding: 0 1em;
	background: none;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .keybinding,
.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	display: inline-block;
	flex: 2 1 auto;
	padding: 0 1em;
	text-align: right;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {
	font-size: 16px !important;
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {
	margin-left: auto;
	margin-right: -20px;
}

.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {
	opacity: 0.4;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {
	display: inline-block;
	box-sizing: border-box;
	margin: 0;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	position: static;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {
	position: absolute;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	width: 100%;
	height: 0px !important;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {
	padding: 0.7em 1em 0.1em 1em;
	font-weight: bold;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label:hover {
	color: inherit;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	position: absolute;
	visibility: hidden;
	width: 1em;
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {
	visibility: visible;
	display: flex;
	align-items: center;
	justify-content: center;
}

/* Context Menu */

.context-view.monaco-menu-container {
	outline: 0;
	border: none;
	animation: fadeIn 0.083s linear;
	-webkit-app-region: no-drag;
}

.context-view.monaco-menu-container :focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {
	outline: 0;
}

.hc-black .context-view.monaco-menu-container,
.hc-light .context-view.monaco-menu-container,
:host-context(.hc-black) .context-view.monaco-menu-container,
:host-context(.hc-light) .context-view.monaco-menu-container {
	box-shadow: none;
}

.hc-black .monaco-menu .monaco-action-bar.vertical .action-item.focused,
.hc-light .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-light) .monaco-menu .monaco-action-bar.vertical .action-item.focused {
	background: none;
}

/* Vertical Action Bar Styles */

.monaco-menu .monaco-action-bar.vertical {
	padding: 4px 0;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	height: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),
.monaco-menu .monaco-action-bar.vertical .keybinding {
	font-size: inherit;
	padding: 0 2em;
	max-height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	font-size: inherit;
	width: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	font-size: inherit;
	margin: 5px 0 !important;
	padding: 0;
	border-radius: 0;
}

.linux .monaco-menu .monaco-action-bar.vertical .action-label.separator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {
	margin-left: 0;
	margin-right: 0;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	font-size: 60%;
	padding: 0 1.8em;
}

.linux .monaco-menu .monaco-action-bar.vertical .submenu-indicator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
	mask-size: 10px 10px;
	-webkit-mask-size: 10px 10px;
}

.monaco-menu .action-item {
	cursor: default;
}`;if(e){t+=`
			/* Arrows */
			.monaco-scrollable-element > .scrollbar > .scra {
				cursor: pointer;
				font-size: 11px !important;
			}

			.monaco-scrollable-element > .visible {
				opacity: 1;

				/* Background rule added for IE9 - to allow clicks on dom node */
				background:rgba(0,0,0,0);

				transition: opacity 100ms linear;
			}
			.monaco-scrollable-element > .invisible {
				opacity: 0;
				pointer-events: none;
			}
			.monaco-scrollable-element > .invisible.fade {
				transition: opacity 800ms linear;
			}

			/* Scrollable Content Inset Shadow */
			.monaco-scrollable-element > .shadow {
				position: absolute;
				display: none;
			}
			.monaco-scrollable-element > .shadow.top {
				display: block;
				top: 0;
				left: 3px;
				height: 3px;
				width: 100%;
			}
			.monaco-scrollable-element > .shadow.left {
				display: block;
				top: 3px;
				left: 0;
				height: 100%;
				width: 3px;
			}
			.monaco-scrollable-element > .shadow.top-left-corner {
				display: block;
				top: 0;
				left: 0;
				height: 3px;
				width: 3px;
			}
		`;const i=s.scrollbarShadow;i&&(t+=`
				.monaco-scrollable-element > .shadow.top {
					box-shadow: ${i} 0 6px 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.left {
					box-shadow: ${i} 6px 0 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.top.left {
					box-shadow: ${i} 6px 6px 6px -6px inset;
				}
			`);const n=s.scrollbarSliderBackground;n&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider {
					background: ${n};
				}
			`);const o=s.scrollbarSliderHoverBackground;o&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider:hover {
					background: ${o};
				}
			`);const r=s.scrollbarSliderActiveBackground;r&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider.active {
					background: ${r};
				}
			`)}return t}class Ude{constructor(e,t,i,n){this.contextViewService=e,this.telemetryService=t,this.notificationService=i,this.keybindingService=n,this.focusToReturn=null,this.lastContainer=null,this.block=null,this.blockDisposable=null,this.options={blockMouse:!0}}configure(e){this.options=e}showContextMenu(e){const t=e.getActions();if(!t.length)return;this.focusToReturn=Rn();let i;const n=tn(e.domForShadowRoot)?e.domForShadowRoot:void 0;this.contextViewService.showContextView({getAnchor:()=>e.getAnchor(),canRelayout:!1,anchorAlignment:e.anchorAlignment,anchorAxisAlignment:e.anchorAxisAlignment,render:o=>{this.lastContainer=o;const r=e.getMenuClassName?e.getMenuClassName():"";r&&(o.className+=" "+r),this.options.blockMouse&&(this.block=o.appendChild(te(".context-view-block")),this.block.style.position="fixed",this.block.style.cursor="initial",this.block.style.left="0",this.block.style.top="0",this.block.style.width="100%",this.block.style.height="100%",this.block.style.zIndex="-1",this.blockDisposable?.dispose(),this.blockDisposable=U(this.block,ee.MOUSE_DOWN,d=>d.stopPropagation()));const a=new Z,l=e.actionRunner||new Zu;l.onWillRun(d=>this.onActionRun(d,!e.skipTelemetry),this,a),l.onDidRun(this.onDidActionRun,this,a),i=new ep(o,t,{actionViewItemProvider:e.getActionViewItem,context:e.getActionsContext?e.getActionsContext():null,actionRunner:l,getKeyBinding:e.getKeyBinding?e.getKeyBinding:d=>this.keybindingService.lookupKeybinding(d.id)},Wde),i.onDidCancel(()=>this.contextViewService.hideContextView(!0),null,a),i.onDidBlur(()=>this.contextViewService.hideContextView(!0),null,a);const c=ke(o);return a.add(U(c,ee.BLUR,()=>this.contextViewService.hideContextView(!0))),a.add(U(c,ee.MOUSE_DOWN,d=>{if(d.defaultPrevented)return;const h=new jr(c,d);let u=h.target;if(!h.rightButton){for(;u;){if(u===o)return;u=u.parentElement}this.contextViewService.hideContextView(!0)}})),Gr(a,i)},focus:()=>{i?.focus(!!e.autoSelectFirstItem)},onHide:o=>{e.onHide?.(!!o),this.block&&(this.block.remove(),this.block=null),this.blockDisposable?.dispose(),this.blockDisposable=null,this.lastContainer&&(Rn()===this.lastContainer||Ji(Rn(),this.lastContainer))&&this.focusToReturn?.focus(),this.lastContainer=null}},n,!!n)}onActionRun(e,t){t&&this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.action.id,from:"contextMenu"}),this.contextViewService.hideContextView(!1)}onDidActionRun(e){e.error&&!xr(e.error)&&this.notificationService.error(e.error)}}var $de=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},$g=function(s,e){return function(t,i){e(t,i,s)}};let bN=class extends B{get contextMenuHandler(){return this._contextMenuHandler||(this._contextMenuHandler=new Ude(this.contextViewService,this.telemetryService,this.notificationService,this.keybindingService)),this._contextMenuHandler}constructor(e,t,i,n,o,r){super(),this.telemetryService=e,this.notificationService=t,this.contextViewService=i,this.keybindingService=n,this.menuService=o,this.contextKeyService=r,this._contextMenuHandler=void 0,this._onDidShowContextMenu=this._store.add(new O),this.onDidShowContextMenu=this._onDidShowContextMenu.event,this._onDidHideContextMenu=this._store.add(new O)}configure(e){this.contextMenuHandler.configure(e)}showContextMenu(e){e=vN.transform(e,this.menuService,this.contextKeyService),this.contextMenuHandler.showContextMenu({...e,onHide:t=>{e.onHide?.(t),this._onDidHideContextMenu.fire()}}),yc.getInstance().resetKeyStatus(),this._onDidShowContextMenu.fire()}};bN=$de([$g(0,jn),$g(1,Ii),$g(2,Yc),$g(3,yt),$g(4,qo),$g(5,Ee)],bN);var vN;(function(s){function e(i){return i&&i.menuId instanceof M}function t(i,n,o){if(!e(i))return i;const{menuId:r,menuActionOptions:a,contextKeyService:l}=i;return{...i,getActions:()=>{const c=[];if(r){const d=n.getMenuActions(r,l??o,a);Hde(d,c)}return i.getActions?ji.join(i.getActions(),c):c}}}s.transform=t})(vN||(vN={}));var D0;(function(s){s[s.API=0]="API",s[s.USER=1]="USER"})(D0||(D0={}));var J2=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},I0=function(s,e){return function(t,i){e(t,i,s)}};let CN=class{constructor(e){this._commandService=e}async open(e,t){if(!bL(e,Fe.command))return!1;if(!t?.allowCommands||(typeof e=="string"&&(e=Se.parse(e)),Array.isArray(t.allowCommands)&&!t.allowCommands.includes(e.path)))return!0;let i=[];try{i=jE(decodeURIComponent(e.query))}catch{try{i=jE(e.query)}catch{}}return Array.isArray(i)||(i=[i]),await this._commandService.executeCommand(e.path,...i),!0}};CN=J2([I0(0,Ht)],CN);let yN=class{constructor(e){this._editorService=e}async open(e,t){typeof e=="string"&&(e=Se.parse(e));const{selection:i,uri:n}=_ae(e);return e=n,e.scheme===Fe.file&&(e=Jae(e)),await this._editorService.openCodeEditor({resource:e,options:{selection:i,source:t?.fromUserGesture?D0.USER:D0.API,...t?.editorOptions}},this._editorService.getFocusedCodeEditor(),t?.openToSide),!0}};yN=J2([I0(0,ft)],yN);let wN=class{constructor(e,t){this._openers=new fs,this._validators=new fs,this._resolvers=new fs,this._resolvedUriTargets=new Ui(i=>i.with({path:null,fragment:null,query:null}).toString()),this._externalOpeners=new fs,this._defaultExternalOpener={openExternal:async i=>(oE(i,Fe.http,Fe.https)?nV(i):Nt.location.href=i,!0)},this._openers.push({open:async(i,n)=>n?.openExternal||oE(i,Fe.mailto,Fe.http,Fe.https,Fe.vsls)?(await this._doOpenExternal(i,n),!0):!1}),this._openers.push(new CN(t)),this._openers.push(new yN(e))}registerOpener(e){return{dispose:this._openers.unshift(e)}}async open(e,t){const i=typeof e=="string"?Se.parse(e):e,n=this._resolvedUriTargets.get(i)??e;for(const o of this._validators)if(!await o.shouldOpen(n,t))return!1;for(const o of this._openers)if(await o.open(e,t))return!0;return!1}async resolveExternalUri(e,t){for(const i of this._resolvers)try{const n=await i.resolveExternalUri(e,t);if(n)return this._resolvedUriTargets.has(n.resolved)||this._resolvedUriTargets.set(n.resolved,e),n}catch{}throw new Error("Could not resolve external URI: "+e.toString())}async _doOpenExternal(e,t){const i=typeof e=="string"?Se.parse(e):e;let n;try{n=(await this.resolveExternalUri(i,t)).resolved}catch{n=i}let o;if(typeof e=="string"&&i.toString()===n.toString()?o=e:o=encodeURI(n.toString(!0)),t?.allowContributedOpeners){const r=typeof t?.allowContributedOpeners=="string"?t?.allowContributedOpeners:void 0;for(const a of this._externalOpeners)if(await a.openExternal(o,{sourceUri:i,preferredOpenerId:r},Ue.None))return!0}return this._defaultExternalOpener.openExternal(o,{sourceUri:i},Ue.None)}dispose(){this._validators.clear()}};wN=J2([I0(0,ft),I0(1,Ht)],wN);const Xs=Je("editorWorkerService");var bi;(function(s){s[s.Hint=1]="Hint",s[s.Info=2]="Info",s[s.Warning=4]="Warning",s[s.Error=8]="Error"})(bi||(bi={}));(function(s){function e(r,a){return a-r}s.compare=e;const t=Object.create(null);t[s.Error]=p("sev.error","Error"),t[s.Warning]=p("sev.warning","Warning"),t[s.Info]=p("sev.info","Info");function i(r){return t[r]||""}s.toString=i;function n(r){switch(r){case Di.Error:return s.Error;case Di.Warning:return s.Warning;case Di.Info:return s.Info;case Di.Ignore:return s.Hint}}s.fromSeverity=n;function o(r){switch(r){case s.Error:return Di.Error;case s.Warning:return Di.Warning;case s.Info:return Di.Info;case s.Hint:return Di.Ignore}}s.toSeverity=o})(bi||(bi={}));var T0;(function(s){const e="";function t(n){return i(n,!0)}s.makeKey=t;function i(n,o){const r=[e];return n.source?r.push(n.source.replace("","\\")):r.push(e),n.code?typeof n.code=="string"?r.push(n.code.replace("","\\")):r.push(n.code.value.replace("","\\")):r.push(e),n.severity!==void 0&&n.severity!==null?r.push(bi.toString(n.severity)):r.push(e),n.message&&o?r.push(n.message.replace("","\\")):r.push(e),n.startLineNumber!==void 0&&n.startLineNumber!==null?r.push(n.startLineNumber.toString()):r.push(e),n.startColumn!==void 0&&n.startColumn!==null?r.push(n.startColumn.toString()):r.push(e),n.endLineNumber!==void 0&&n.endLineNumber!==null?r.push(n.endLineNumber.toString()):r.push(e),n.endColumn!==void 0&&n.endColumn!==null?r.push(n.endColumn.toString()):r.push(e),r.push(e),r.join("")}s.makeKeyOptionalMessage=i})(T0||(T0={}));const zl=Je("markerService"),dU=E("editor.lineHighlightBackground",null,p("lineHighlight","Background color for the highlight of line at the cursor position.")),GB=E("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:lt},p("lineHighlightBorderBox","Background color for the border around the line at the cursor position."));E("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},p("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0);E("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:Xt,hcLight:Xt},p("rangeHighlightBorder","Background color of the border around highlighted ranges."));E("editor.symbolHighlightBackground",{dark:wc,light:wc,hcDark:null,hcLight:null},p("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0);E("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:Xt,hcLight:Xt},p("symbolHighlightBorder","Background color of the border around highlighted symbols."));const dx=E("editorCursor.foreground",{dark:"#AEAFAD",light:G.black,hcDark:G.white,hcLight:"#0F4A85"},p("caret","Color of the editor cursor.")),eO=E("editorCursor.background",null,p("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),hU=E("editorMultiCursor.primary.foreground",dx,p("editorMultiCursorPrimaryForeground","Color of the primary editor cursor when multiple cursors are present.")),jde=E("editorMultiCursor.primary.background",eO,p("editorMultiCursorPrimaryBackground","The background color of the primary editor cursor when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),uU=E("editorMultiCursor.secondary.foreground",dx,p("editorMultiCursorSecondaryForeground","Color of secondary editor cursors when multiple cursors are present.")),Zde=E("editorMultiCursor.secondary.background",eO,p("editorMultiCursorSecondaryBackground","The background color of secondary editor cursors when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),tO=E("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},p("editorWhitespaces","Color of whitespace characters in the editor.")),Kde=E("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:G.white,hcLight:"#292929"},p("editorLineNumbers","Color of editor line numbers.")),qde=E("editorIndentGuide.background",tO,p("editorIndentGuides","Color of the editor indentation guides."),!1,p("deprecatedEditorIndentGuides","'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),Gde=E("editorIndentGuide.activeBackground",tO,p("editorActiveIndentGuide","Color of the active editor indentation guides."),!1,p("deprecatedEditorActiveIndentGuide","'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),BC=E("editorIndentGuide.background1",qde,p("editorIndentGuides1","Color of the editor indentation guides (1).")),Yde=E("editorIndentGuide.background2","#00000000",p("editorIndentGuides2","Color of the editor indentation guides (2).")),Xde=E("editorIndentGuide.background3","#00000000",p("editorIndentGuides3","Color of the editor indentation guides (3).")),Qde=E("editorIndentGuide.background4","#00000000",p("editorIndentGuides4","Color of the editor indentation guides (4).")),Jde=E("editorIndentGuide.background5","#00000000",p("editorIndentGuides5","Color of the editor indentation guides (5).")),ehe=E("editorIndentGuide.background6","#00000000",p("editorIndentGuides6","Color of the editor indentation guides (6).")),WC=E("editorIndentGuide.activeBackground1",Gde,p("editorActiveIndentGuide1","Color of the active editor indentation guides (1).")),the=E("editorIndentGuide.activeBackground2","#00000000",p("editorActiveIndentGuide2","Color of the active editor indentation guides (2).")),ihe=E("editorIndentGuide.activeBackground3","#00000000",p("editorActiveIndentGuide3","Color of the active editor indentation guides (3).")),nhe=E("editorIndentGuide.activeBackground4","#00000000",p("editorActiveIndentGuide4","Color of the active editor indentation guides (4).")),she=E("editorIndentGuide.activeBackground5","#00000000",p("editorActiveIndentGuide5","Color of the active editor indentation guides (5).")),ohe=E("editorIndentGuide.activeBackground6","#00000000",p("editorActiveIndentGuide6","Color of the active editor indentation guides (6).")),rhe=E("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:Xt,hcLight:Xt},p("editorActiveLineNumber","Color of editor active line number"),!1,p("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead."));E("editorLineNumber.activeForeground",rhe,p("editorActiveLineNumber","Color of editor active line number"));const ahe=E("editorLineNumber.dimmedForeground",null,p("editorDimmedLineNumber","Color of the final editor line when editor.renderFinalNewline is set to dimmed."));E("editorRuler.foreground",{dark:"#5A5A5A",light:G.lightgrey,hcDark:G.white,hcLight:"#292929"},p("editorRuler","Color of the editor rulers."));E("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},p("editorCodeLensForeground","Foreground color of editor CodeLens"));E("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},p("editorBracketMatchBackground","Background color behind matching brackets"));E("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:lt,hcLight:lt},p("editorBracketMatchBorder","Color for matching brackets boxes"));const lhe=E("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},p("editorOverviewRulerBorder","Color of the overview ruler border.")),che=E("editorOverviewRuler.background",null,p("editorOverviewRulerBackground","Background color of the editor overview ruler."));E("editorGutter.background",ea,p("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers."));E("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:G.fromHex("#fff").transparent(.8),hcLight:lt},p("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor."));const dhe=E("editorUnnecessaryCode.opacity",{dark:G.fromHex("#000a"),light:G.fromHex("#0007"),hcDark:null,hcLight:null},p("unnecessaryCodeOpacity",`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`));E("editorGhostText.border",{dark:null,light:null,hcDark:G.fromHex("#fff").transparent(.8),hcLight:G.fromHex("#292929").transparent(.8)},p("editorGhostTextBorder","Border color of ghost text in the editor."));const hhe=E("editorGhostText.foreground",{dark:G.fromHex("#ffffff56"),light:G.fromHex("#0007"),hcDark:null,hcLight:null},p("editorGhostTextForeground","Foreground color of the ghost text in the editor."));E("editorGhostText.background",null,p("editorGhostTextBackground","Background color of the ghost text in the editor."));const uhe=new G(new dt(0,122,204,.6)),gU=E("editorOverviewRuler.rangeHighlightForeground",uhe,p("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),ghe=E("editorOverviewRuler.errorForeground",{dark:new G(new dt(255,18,18,.7)),light:new G(new dt(255,18,18,.7)),hcDark:new G(new dt(255,50,50,1)),hcLight:"#B5200D"},p("overviewRuleError","Overview ruler marker color for errors.")),fhe=E("editorOverviewRuler.warningForeground",{dark:Vc,light:Vc,hcDark:nv,hcLight:nv},p("overviewRuleWarning","Overview ruler marker color for warnings.")),phe=E("editorOverviewRuler.infoForeground",{dark:El,light:El,hcDark:sv,hcLight:sv},p("overviewRuleInfo","Overview ruler marker color for infos.")),fU=E("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},p("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),pU=E("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},p("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),mU=E("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},p("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),_U=E("editorBracketHighlight.foreground4","#00000000",p("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),bU=E("editorBracketHighlight.foreground5","#00000000",p("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),vU=E("editorBracketHighlight.foreground6","#00000000",p("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),mhe=E("editorBracketHighlight.unexpectedBracket.foreground",{dark:new G(new dt(255,18,18,.8)),light:new G(new dt(255,18,18,.8)),hcDark:"new Color(new RGBA(255, 50, 50, 1))",hcLight:"#B5200D"},p("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),_he=E("editorBracketPairGuide.background1","#00000000",p("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),bhe=E("editorBracketPairGuide.background2","#00000000",p("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),vhe=E("editorBracketPairGuide.background3","#00000000",p("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),Che=E("editorBracketPairGuide.background4","#00000000",p("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),yhe=E("editorBracketPairGuide.background5","#00000000",p("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),whe=E("editorBracketPairGuide.background6","#00000000",p("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),She=E("editorBracketPairGuide.activeBackground1","#00000000",p("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),Lhe=E("editorBracketPairGuide.activeBackground2","#00000000",p("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),xhe=E("editorBracketPairGuide.activeBackground3","#00000000",p("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),khe=E("editorBracketPairGuide.activeBackground4","#00000000",p("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),Dhe=E("editorBracketPairGuide.activeBackground5","#00000000",p("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),Ihe=E("editorBracketPairGuide.activeBackground6","#00000000",p("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides."));E("editorUnicodeHighlight.border",Vc,p("editorUnicodeHighlight.border","Border color used to highlight unicode characters."));E("editorUnicodeHighlight.background",koe,p("editorUnicodeHighlight.background","Background color used to highlight unicode characters."));kr((s,e)=>{const t=s.getColor(ea),i=s.getColor(dU),n=i&&!i.isTransparent()?i:t;n&&e.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${n}; }`)});function The(s,e){const t=[],i=[];for(const n of s)e.has(n)||t.push(n);for(const n of e)s.has(n)||i.push(n);return{removed:t,added:i}}function Ehe(s,e){const t=new Set;for(const i of e)s.has(i)&&t.add(i);return t}var Nhe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},YB=function(s,e){return function(t,i){e(t,i,s)}};let SN=class extends B{constructor(e,t){super(),this._markerService=t,this._onDidChangeMarker=this._register(new O),this._markerDecorations=new Ui,e.getModels().forEach(i=>this._onModelAdded(i)),this._register(e.onModelAdded(this._onModelAdded,this)),this._register(e.onModelRemoved(this._onModelRemoved,this)),this._register(this._markerService.onMarkerChanged(this._handleMarkerChange,this))}dispose(){super.dispose(),this._markerDecorations.forEach(e=>e.dispose()),this._markerDecorations.clear()}getMarker(e,t){const i=this._markerDecorations.get(e);return i&&i.getMarker(t)||null}_handleMarkerChange(e){e.forEach(t=>{const i=this._markerDecorations.get(t);i&&this._updateDecorations(i)})}_onModelAdded(e){const t=new Rhe(e);this._markerDecorations.set(e.uri,t),this._updateDecorations(t)}_onModelRemoved(e){const t=this._markerDecorations.get(e.uri);t&&(t.dispose(),this._markerDecorations.delete(e.uri)),(e.uri.scheme===Fe.inMemory||e.uri.scheme===Fe.internal||e.uri.scheme===Fe.vscode)&&this._markerService?.read({resource:e.uri}).map(i=>i.owner).forEach(i=>this._markerService.remove(i,[e.uri]))}_updateDecorations(e){const t=this._markerService.read({resource:e.model.uri,take:500});e.update(t)&&this._onDidChangeMarker.fire(e.model)}};SN=Nhe([YB(0,Zt),YB(1,zl)],SN);class Rhe extends B{constructor(e){super(),this.model=e,this._map=new Rne,this._register(Ce(()=>{this.model.deltaDecorations([...this._map.values()],[]),this._map.clear()}))}update(e){const{added:t,removed:i}=The(new Set(this._map.keys()),new Set(e));if(t.length===0&&i.length===0)return!1;const n=i.map(a=>this._map.get(a)),o=t.map(a=>({range:this._createDecorationRange(this.model,a),options:this._createDecorationOption(a)})),r=this.model.deltaDecorations(n,o);for(const a of i)this._map.delete(a);for(let a=0;a<r.length;a++)this._map.set(t[a],r[a]);return!0}getMarker(e){return this._map.getKey(e.id)}_createDecorationRange(e,t){let i=k.lift(t);if(t.severity===bi.Hint&&!this._hasMarkerTag(t,1)&&!this._hasMarkerTag(t,2)&&(i=i.setEndPosition(i.startLineNumber,i.startColumn+2)),i=e.validateRange(i),i.isEmpty()){const n=e.getLineLastNonWhitespaceColumn(i.startLineNumber)||e.getLineMaxColumn(i.startLineNumber);if(n===1||i.endColumn>=n)return i;const o=e.getWordAtPosition(i.getStartPosition());o&&(i=new k(i.startLineNumber,o.startColumn,i.endLineNumber,o.endColumn))}else if(t.endColumn===Number.MAX_VALUE&&t.startColumn===1&&i.startLineNumber===i.endLineNumber){const n=e.getLineFirstNonWhitespaceColumn(t.startLineNumber);n<i.endColumn&&(i=new k(i.startLineNumber,n,i.endLineNumber,i.endColumn),t.startColumn=n)}return i}_createDecorationOption(e){let t,i,n,o,r;switch(e.severity){case bi.Hint:this._hasMarkerTag(e,2)?t=void 0:this._hasMarkerTag(e,1)?t="squiggly-unnecessary":t="squiggly-hint",n=0;break;case bi.Info:t="squiggly-info",i=_i(phe),n=10,r={color:_i(qoe),position:1};break;case bi.Warning:t="squiggly-warning",i=_i(fhe),n=20,r={color:_i(Goe),position:1};break;case bi.Error:default:t="squiggly-error",i=_i(ghe),n=30,r={color:_i(Yoe),position:1};break}return e.tags&&(e.tags.indexOf(1)!==-1&&(o="squiggly-inline-unnecessary"),e.tags.indexOf(2)!==-1&&(o="squiggly-inline-deprecated")),{description:"marker-decoration",stickiness:1,className:t,showIfCollapsed:!0,overviewRuler:{color:i,position:Ho.Right},minimap:r,zIndex:n,inlineClassName:o}}_hasMarkerTag(e,t){return e.tags?e.tags.indexOf(t)>=0:!1}}const iO=Je("markerDecorationsService");class $i{static _nextVisibleColumn(e,t,i){return e===9?$i.nextRenderTabStop(t,i):ih(e)||UP(e)?t+2:t+1}static visibleColumnFromColumn(e,t,i){const n=Math.min(t-1,e.length),o=e.substring(0,n),r=new B1(o);let a=0;for(;!r.eol();){const l=F1(o,n,r.offset);r.nextGraphemeLength(),a=this._nextVisibleColumn(l,a,i)}return a}static columnFromVisibleColumn(e,t,i){if(t<=0)return 1;const n=e.length,o=new B1(e);let r=0,a=1;for(;!o.eol();){const l=F1(e,n,o.offset);o.nextGraphemeLength();const c=this._nextVisibleColumn(l,r,i),d=o.offset+1;if(c>=t){const h=t-r;return c-t<h?d:a}r=c,a=d}return n+1}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return e+t-e%t}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}}function Mhe(s,e,t){let i=0;for(let o=0;o<s.length;o++)s.charAt(o)==="	"?i=$i.nextIndentTabStop(i,e):i++;let n="";if(!t){const o=Math.floor(i/e);i=i%e;for(let r=0;r<o;r++)n+="	"}for(let o=0;o<i;o++)n+=" ";return n}function nO(s,e,t){let i=rs(s);return i===-1&&(i=s.length),Mhe(s.substring(0,i),e,t)+s.substring(i)}class XB{constructor(e,t,i,n){this.range=e,this.nestingLevel=t,this.nestingLevelOfEqualBracketType=i,this.isInvalid=n}}class Ahe{constructor(e,t,i,n,o,r){this.range=e,this.openingBracketRange=t,this.closingBracketRange=i,this.nestingLevel=n,this.nestingLevelOfEqualBracketType=o,this.bracketPairNode=r}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}}class Phe extends Ahe{constructor(e,t,i,n,o,r,a){super(e,t,i,n,o,r),this.minVisibleColumnIndentation=a}}function Ohe(s,e,t,i){return s!==t?Mi(t-s,i):Mi(0,i-e)}const ps=0;function E0(s){return s===0}const Wo=2**26;function Mi(s,e){return s*Wo+e}function _r(s){const e=s,t=Math.floor(e/Wo),i=e-t*Wo;return new Hs(t,i)}function Fhe(s){return Math.floor(s/Wo)}function vi(s,e){let t=s+e;return e>=Wo&&(t=t-s%Wo),t}function Bhe(s,e){return s.reduce((t,i)=>vi(t,e(i)),ps)}function CU(s,e){return s===e}function _v(s,e){const t=s,i=e;if(i-t<=0)return ps;const o=Math.floor(t/Wo),r=Math.floor(i/Wo),a=i-r*Wo;if(o===r){const l=t-o*Wo;return Mi(0,a-l)}else return Mi(r-o,a)}function tp(s,e){return s<e}function ip(s,e){return s<=e}function I_(s,e){return s>=e}function Tf(s){return Mi(s.lineNumber-1,s.column-1)}function Tu(s,e){const t=s,i=Math.floor(t/Wo),n=t-i*Wo,o=e,r=Math.floor(o/Wo),a=o-r*Wo;return new k(i+1,n+1,r+1,a+1)}function Whe(s){const e=Fl(s);return Mi(e.length-1,e[e.length-1].length)}class Lc{static fromModelContentChanges(e){return e.map(i=>{const n=k.lift(i.range);return new Lc(Tf(n.getStartPosition()),Tf(n.getEndPosition()),Whe(i.text))}).reverse()}constructor(e,t,i){this.startOffset=e,this.endOffset=t,this.newLength=i}toString(){return`[${_r(this.startOffset)}...${_r(this.endOffset)}) -> ${_r(this.newLength)}`}}class Hhe{constructor(e){this.nextEditIdx=0,this.deltaOldToNewLineCount=0,this.deltaOldToNewColumnCount=0,this.deltaLineIdxInOld=-1,this.edits=e.map(t=>sO.from(t))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);const t=this.edits[this.nextEditIdx],i=t?this.translateOldToCur(t.offsetObj):null;return i===null?null:_v(e,i)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?Mi(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):Mi(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){const t=_r(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?Mi(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):Mi(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){const t=this.edits[this.nextEditIdx],i=this.translateOldToCur(t.endOffsetAfterObj);if(ip(i,e)){this.nextEditIdx++;const n=_r(i),o=_r(this.translateOldToCur(t.endOffsetBeforeObj)),r=n.lineCount-o.lineCount;this.deltaOldToNewLineCount+=r;const a=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=n.columnCount-o.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}else break}}}class sO{static from(e){return new sO(e.startOffset,e.endOffset,e.newLength)}constructor(e,t,i){this.endOffsetBeforeObj=_r(t),this.endOffsetAfterObj=_r(vi(e,i)),this.offsetObj=_r(e)}}const Fy=[];class Yi{static{this.cache=new Array(129)}static create(e,t){if(e<=128&&t.length===0){let i=Yi.cache[e];return i||(i=new Yi(e,t),Yi.cache[e]=i),i}return new Yi(e,t)}static{this.empty=Yi.create(0,Fy)}static getEmpty(){return this.empty}constructor(e,t){this.items=e,this.additionalItems=t}add(e,t){const i=t.getKey(e);let n=i>>5;if(n===0){const r=1<<i|this.items;return r===this.items?this:Yi.create(r,this.additionalItems)}n--;const o=this.additionalItems.slice(0);for(;o.length<n;)o.push(0);return o[n]|=1<<(i&31),Yi.create(this.items,o)}merge(e){const t=this.items|e.items;if(this.additionalItems===Fy&&e.additionalItems===Fy)return t===this.items?this:t===e.items?e:Yi.create(t,Fy);const i=[];for(let n=0;n<Math.max(this.additionalItems.length,e.additionalItems.length);n++){const o=this.additionalItems[n]||0,r=e.additionalItems[n]||0;i.push(o|r)}return Yi.create(t,i)}intersects(e){if(this.items&e.items)return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if(this.additionalItems[t]&e.additionalItems[t])return!0;return!1}}const QB={getKey(s){return s}};class yU{constructor(){this.items=new Map}getKey(e){let t=this.items.get(e);return t===void 0&&(t=this.items.size,this.items.set(e,t)),t}}class oO{get length(){return this._length}constructor(e){this._length=e}}class bv extends oO{static create(e,t,i){let n=e.length;return t&&(n=vi(n,t.length)),i&&(n=vi(n,i.length)),new bv(n,e,t,i,t?t.missingOpeningBracketIds:Yi.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(e){switch(e){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){const e=[];return e.push(this.openingBracket),this.child&&e.push(this.child),this.closingBracket&&e.push(this.closingBracket),e}constructor(e,t,i,n,o){super(e),this.openingBracket=t,this.child=i,this.closingBracket=n,this.missingOpeningBracketIds=o}canBeReused(e){return!(this.closingBracket===null||e.intersects(this.missingOpeningBracketIds))}deepClone(){return new bv(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(e,t){return this.child?this.child.computeMinIndentation(vi(e,this.openingBracket.length),t):Number.MAX_SAFE_INTEGER}}class Rl extends oO{static create23(e,t,i,n=!1){let o=e.length,r=e.missingOpeningBracketIds;if(e.listHeight!==t.listHeight)throw new Error("Invalid list heights");if(o=vi(o,t.length),r=r.merge(t.missingOpeningBracketIds),i){if(e.listHeight!==i.listHeight)throw new Error("Invalid list heights");o=vi(o,i.length),r=r.merge(i.missingOpeningBracketIds)}return n?new Vhe(o,e.listHeight+1,e,t,i,r):new vv(o,e.listHeight+1,e,t,i,r)}static getEmpty(){return new zhe(ps,0,[],Yi.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}constructor(e,t,i){super(e),this.listHeight=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();const e=this.childrenLength;if(e===0)return;const t=this.getChild(e-1),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(e-1,i),i}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;const t=this.getChild(0),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(0,i),i}canBeReused(e){if(e.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let t=this;for(;t.kind===4;){const i=t.childrenLength;if(i===0)throw new mt;t=t.getChild(i-1)}return t.canBeReused(e)}handleChildrenChanged(){this.throwIfImmutable();const e=this.childrenLength;let t=this.getChild(0).length,i=this.getChild(0).missingOpeningBracketIds;for(let n=1;n<e;n++){const o=this.getChild(n);t=vi(t,o.length),i=i.merge(o.missingOpeningBracketIds)}this._length=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}computeMinIndentation(e,t){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let i=Number.MAX_SAFE_INTEGER,n=e;for(let o=0;o<this.childrenLength;o++){const r=this.getChild(o);r&&(i=Math.min(i,r.computeMinIndentation(n,t)),n=vi(n,r.length))}return this.cachedMinIndentation=i,i}}class vv extends Rl{get childrenLength(){return this._item3!==null?3:2}getChild(e){switch(e){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(e,t){switch(e){case 0:this._item1=t;return;case 1:this._item2=t;return;case 2:this._item3=t;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}constructor(e,t,i,n,o,r){super(e,t,r),this._item1=i,this._item2=n,this._item3=o}deepClone(){return new vv(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=e,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item3;return this._item3=null,this.handleChildrenChanged(),e}prependChildOfSameHeight(e){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=e,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),e}toMutable(){return this}}class Vhe extends vv{toMutable(){return new vv(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}class N0 extends Rl{get childrenLength(){return this._children.length}getChild(e){return this._children[e]}setChild(e,t){this._children[e]=t}get children(){return this._children}constructor(e,t,i,n){super(e,t,n),this._children=i}deepClone(){const e=new Array(this._children.length);for(let t=0;t<this._children.length;t++)e[t]=this._children[t].deepClone();return new N0(this.length,this.listHeight,e,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){this.throwIfImmutable(),this._children.push(e),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();const e=this._children.pop();return this.handleChildrenChanged(),e}prependChildOfSameHeight(e){this.throwIfImmutable(),this._children.unshift(e),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();const e=this._children.shift();return this.handleChildrenChanged(),e}toMutable(){return this}}class zhe extends N0{toMutable(){return new N0(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}const Uhe=[];class rO extends oO{get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return Uhe}deepClone(){return this}}class au extends rO{get kind(){return 0}get missingOpeningBracketIds(){return Yi.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){const i=_r(e),n=(i.columnCount===0?i.lineCount:i.lineCount+1)+1,o=Fhe(vi(e,this.length))+1;let r=Number.MAX_SAFE_INTEGER;for(let a=n;a<=o;a++){const l=t.getLineFirstNonWhitespaceColumn(a),c=t.getLineContent(a);if(l===0)continue;const d=$i.visibleColumnFromColumn(c,l,t.getOptions().tabSize);r=Math.min(r,d)}return r}}class R0 extends rO{static create(e,t,i){return new R0(e,t,i)}get kind(){return 1}get missingOpeningBracketIds(){return Yi.getEmpty()}constructor(e,t,i){super(e),this.bracketInfo=t,this.bracketIds=i}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(e){return!1}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}class $he extends rO{get kind(){return 3}constructor(e,t){super(t),this.missingOpeningBracketIds=e}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}let yd=class{constructor(e,t,i,n,o){this.length=e,this.kind=t,this.bracketId=i,this.bracketIds=n,this.astNode=o}};class wU{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.reader=new jhe(this.textModel,this.bracketTokens),this._offset=ps,this.didPeek=!1,this.peeked=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}get offset(){return this._offset}get length(){return Mi(this.textBufferLineCount-1,this.textBufferLastLineLength)}skip(e){this.didPeek=!1,this._offset=vi(this._offset,e);const t=_r(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=vi(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}}class jhe{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.lineIdx=0,this.line=null,this.lineCharOffset=0,this.lineTokens=null,this.lineTokenOffset=0,this.peekedToken=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}read(){if(this.peekedToken){const o=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=o.length,o}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));const e=this.lineIdx,t=this.lineCharOffset;let i=0;for(;;){const o=this.lineTokens,r=o.getCount();let a=null;if(this.lineTokenOffset<r){const l=o.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<r&&l===o.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;const c=Bs.getTokenType(l)===0,d=Bs.containsBalancedBrackets(l),h=o.getEndOffset(this.lineTokenOffset);if(d&&c&&this.lineCharOffset<h){const u=o.getLanguageId(this.lineTokenOffset),g=this.line.substring(this.lineCharOffset,h),f=this.bracketTokens.getSingleLanguageBracketTokens(u),m=f.regExpGlobal;if(m){m.lastIndex=0;const _=m.exec(g);_&&(a=f.getToken(_[0]),a&&(this.lineCharOffset+=_.index))}}if(i+=h-this.lineCharOffset,a)if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=h}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,i+=33,i>1e3))break;if(i>1500)break}const n=Ohe(e,t,this.lineIdx,this.lineCharOffset);return new yd(n,0,-1,Yi.getEmpty(),new au(n))}}class Zhe{constructor(e,t){this.text=e,this._offset=ps,this.idx=0;const i=t.getRegExpStr(),n=i?new RegExp(i+`|
`,"gi"):null,o=[];let r,a=0,l=0,c=0,d=0;const h=[];for(let f=0;f<60;f++)h.push(new yd(Mi(0,f),0,-1,Yi.getEmpty(),new au(Mi(0,f))));const u=[];for(let f=0;f<60;f++)u.push(new yd(Mi(1,f),0,-1,Yi.getEmpty(),new au(Mi(1,f))));if(n)for(n.lastIndex=0;(r=n.exec(e))!==null;){const f=r.index,m=r[0];if(m===`
`)a++,l=f+1;else{if(c!==f){let _;if(d===a){const b=f-c;if(b<h.length)_=h[b];else{const v=Mi(0,b);_=new yd(v,0,-1,Yi.getEmpty(),new au(v))}}else{const b=a-d,v=f-l;if(b===1&&v<u.length)_=u[v];else{const C=Mi(b,v);_=new yd(C,0,-1,Yi.getEmpty(),new au(C))}}o.push(_)}o.push(t.getToken(m)),c=f+m.length,d=a}}const g=e.length;if(c!==g){const f=d===a?Mi(0,g-c):Mi(a-d,g-l);o.push(new yd(f,0,-1,Yi.getEmpty(),new au(f)))}this.length=Mi(a,g-l),this.tokens=o}get offset(){return this._offset}read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new LJ}}class aO{static createFromLanguage(e,t){function i(o){return t.getKey(`${o.languageId}:::${o.bracketText}`)}const n=new Map;for(const o of e.bracketsNew.openingBrackets){const r=Mi(0,o.bracketText.length),a=i(o),l=Yi.getEmpty().add(a,QB);n.set(o.bracketText,new yd(r,1,a,l,R0.create(r,o,l)))}for(const o of e.bracketsNew.closingBrackets){const r=Mi(0,o.bracketText.length);let a=Yi.getEmpty();const l=o.getOpeningBrackets();for(const c of l)a=a.add(i(c),QB);n.set(o.bracketText,new yd(r,2,i(l[0]),a,R0.create(r,o,a)))}return new aO(n)}constructor(e){this.map=e,this.hasRegExp=!1,this._regExpGlobal=null}getRegExpStr(){if(this.isEmpty)return null;{const e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(t=>Khe(t)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){const e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e.toLowerCase())}findClosingTokenText(e){for(const[t,i]of this.map)if(i.kind===2&&i.bracketIds.intersects(e))return t}get isEmpty(){return this.map.size===0}}function Khe(s){let e=Uo(s);return/^[\w ]+/.test(s)&&(e=`\\b${e}`),/[\w ]+$/.test(s)&&(e=`${e}\\b`),e}class SU{constructor(e,t){this.denseKeyProvider=e,this.getLanguageConfiguration=t,this.languageIdToBracketTokens=new Map}didLanguageChange(e){return this.languageIdToBracketTokens.has(e)}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=aO.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}}function qhe(s){if(s.length===0)return null;if(s.length===1)return s[0];let e=0;function t(){if(e>=s.length)return null;const r=e,a=s[r].listHeight;for(e++;e<s.length&&s[e].listHeight===a;)e++;return e-r>=2?LU(r===0&&e===s.length?s:s.slice(r,e),!1):s[r]}let i=t(),n=t();if(!n)return i;for(let r=t();r;r=t())JB(i,n)<=JB(n,r)?(i=kD(i,n),n=r):n=kD(n,r);return kD(i,n)}function LU(s,e=!1){if(s.length===0)return null;if(s.length===1)return s[0];let t=s.length;for(;t>3;){const i=t>>1;for(let n=0;n<i;n++){const o=n<<1;s[n]=Rl.create23(s[o],s[o+1],o+3===t?s[o+2]:null,e)}t=i}return Rl.create23(s[0],s[1],t>=3?s[2]:null,e)}function JB(s,e){return Math.abs(s.listHeight-e.listHeight)}function kD(s,e){return s.listHeight===e.listHeight?Rl.create23(s,e,null,!1):s.listHeight>e.listHeight?Ghe(s,e):Yhe(e,s)}function Ghe(s,e){s=s.toMutable();let t=s;const i=[];let n;for(;;){if(e.listHeight===t.listHeight){n=e;break}if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeLastElementMutable()}for(let o=i.length-1;o>=0;o--){const r=i[o];n?r.childrenLength>=3?n=Rl.create23(r.unappendChild(),n,null,!1):(r.appendChildOfSameHeight(n),n=void 0):r.handleChildrenChanged()}return n?Rl.create23(s,n,null,!1):s}function Yhe(s,e){s=s.toMutable();let t=s;const i=[];for(;e.listHeight!==t.listHeight;){if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeFirstElementMutable()}let n=e;for(let o=i.length-1;o>=0;o--){const r=i[o];n?r.childrenLength>=3?n=Rl.create23(n,r.unprependChild(),null,!1):(r.prependChildOfSameHeight(n),n=void 0):r.handleChildrenChanged()}return n?Rl.create23(n,s,null,!1):s}class Xhe{constructor(e){this.lastOffset=ps,this.nextNodes=[e],this.offsets=[ps],this.idxs=[]}readLongestNodeAt(e,t){if(tp(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){const i=e_(this.nextNodes);if(!i)return;const n=e_(this.offsets);if(tp(e,n))return;if(tp(n,e))if(vi(n,i.length)<=e)this.nextNodeAfterCurrent();else{const o=DD(i);o!==-1?(this.nextNodes.push(i.getChild(o)),this.offsets.push(n),this.idxs.push(o)):this.nextNodeAfterCurrent()}else{if(t(i))return this.nextNodeAfterCurrent(),i;{const o=DD(i);if(o===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(i.getChild(o)),this.offsets.push(n),this.idxs.push(o)}}}}nextNodeAfterCurrent(){for(;;){const e=e_(this.offsets),t=e_(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;const i=e_(this.nextNodes),n=DD(i,this.idxs[this.idxs.length-1]);if(n!==-1){this.nextNodes.push(i.getChild(n)),this.offsets.push(vi(e,t.length)),this.idxs[this.idxs.length-1]=n;break}else this.idxs.pop()}}}function DD(s,e=-1){for(;;){if(e++,e>=s.childrenLength)return-1;if(s.getChild(e))return e}}function e_(s){return s.length>0?s[s.length-1]:void 0}function LN(s,e,t,i){return new Qhe(s,e,t,i).parseDocument()}class Qhe{constructor(e,t,i,n){if(this.tokenizer=e,this.createImmutableLists=n,this._itemsConstructed=0,this._itemsFromCache=0,i&&n)throw new Error("Not supported");this.oldNodeReader=i?new Xhe(i):void 0,this.positionMapper=new Hhe(t)}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(Yi.getEmpty(),0);return e||(e=Rl.getEmpty()),e}parseList(e,t){const i=[];for(;;){let o=this.tryReadChildFromCache(e);if(!o){const r=this.tokenizer.peek();if(!r||r.kind===2&&r.bracketIds.intersects(e))break;o=this.parseChild(e,t+1)}o.kind===4&&o.childrenLength===0||i.push(o)}return this.oldNodeReader?qhe(i):LU(i,this.createImmutableLists)}tryReadChildFromCache(e){if(this.oldNodeReader){const t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(t===null||!E0(t)){const i=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),n=>t!==null&&!tp(n.length,t)?!1:n.canBeReused(e));if(i)return this._itemsFromCache++,this.tokenizer.skip(i.length),i}}}parseChild(e,t){this._itemsConstructed++;const i=this.tokenizer.read();switch(i.kind){case 2:return new $he(i.bracketIds,i.length);case 0:return i.astNode;case 1:{if(t>300)return new au(i.length);const n=e.merge(i.bracketIds),o=this.parseList(n,t+1),r=this.tokenizer.peek();return r&&r.kind===2&&(r.bracketId===i.bracketId||r.bracketIds.intersects(i.bracketIds))?(this.tokenizer.read(),bv.create(i.astNode,o,r.astNode)):bv.create(i.astNode,o,null)}default:throw new Error("unexpected")}}}function M0(s,e){if(s.length===0)return e;if(e.length===0)return s;const t=new Oc(eW(s)),i=eW(e);i.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let n=t.dequeue();function o(c){if(c===void 0){const h=t.takeWhile(u=>!0)||[];return n&&h.unshift(n),h}const d=[];for(;n&&!E0(c);){const[h,u]=n.splitAt(c);d.push(h),c=_v(h.lengthAfter,c),n=u??t.dequeue()}return E0(c)||d.push(new Od(!1,c,c)),d}const r=[];function a(c,d,h){if(r.length>0&&CU(r[r.length-1].endOffset,c)){const u=r[r.length-1];r[r.length-1]=new Lc(u.startOffset,d,vi(u.newLength,h))}else r.push({startOffset:c,endOffset:d,newLength:h})}let l=ps;for(const c of i){const d=o(c.lengthBefore);if(c.modified){const h=Bhe(d,g=>g.lengthBefore),u=vi(l,h);a(l,u,c.lengthAfter),l=u}else for(const h of d){const u=l;l=vi(l,h.lengthBefore),h.modified&&a(u,l,h.lengthAfter)}}return r}class Od{constructor(e,t,i){this.modified=e,this.lengthBefore=t,this.lengthAfter=i}splitAt(e){const t=_v(e,this.lengthAfter);return CU(t,ps)?[this,void 0]:this.modified?[new Od(this.modified,this.lengthBefore,e),new Od(this.modified,ps,t)]:[new Od(this.modified,e,e),new Od(this.modified,t,t)]}toString(){return`${this.modified?"M":"U"}:${_r(this.lengthBefore)} -> ${_r(this.lengthAfter)}`}}function eW(s){const e=[];let t=ps;for(const i of s){const n=_v(t,i.startOffset);E0(n)||e.push(new Od(!1,n,n));const o=_v(i.startOffset,i.endOffset);e.push(new Od(!0,o,i.newLength)),t=i.endOffset}return e}class Jhe extends B{didLanguageChange(e){return this.brackets.didLanguageChange(e)}constructor(e,t){if(super(),this.textModel=e,this.getLanguageConfiguration=t,this.didChangeEmitter=new O,this.denseKeyProvider=new yU,this.brackets=new SU(this.denseKeyProvider,this.getLanguageConfiguration),this.onDidChange=this.didChangeEmitter.event,this.queuedTextEditsForInitialAstWithoutTokens=[],this.queuedTextEdits=[],e.tokenization.hasTokens)e.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{const i=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),n=new Zhe(this.textModel.getValue(),i);this.initialAstWithoutTokens=LN(n,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){const e=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,e||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:e}){const t=e.map(i=>new Lc(Mi(i.fromLineNumber-1,0),Mi(i.toLineNumber,0),Mi(i.toLineNumber-i.fromLineNumber+1,0)));this.handleEdits(t,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(e){const t=Lc.fromModelContentChanges(e.changes);this.handleEdits(t,!1)}handleEdits(e,t){const i=M0(this.queuedTextEdits,e);this.queuedTextEdits=i,this.initialAstWithoutTokens&&!t&&(this.queuedTextEditsForInitialAstWithoutTokens=M0(this.queuedTextEditsForInitialAstWithoutTokens,e))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(e,t,i){const n=t,o=new wU(this.textModel,this.brackets);return LN(o,e,n,i)}getBracketsInRange(e,t){this.flushQueue();const i=Mi(e.startLineNumber-1,e.startColumn-1),n=Mi(e.endLineNumber-1,e.endColumn-1);return new Dc(o=>{const r=this.initialAstWithoutTokens||this.astWithTokens;xN(r,ps,r.length,i,n,o,0,0,new Map,t)})}getBracketPairsInRange(e,t){this.flushQueue();const i=Tf(e.getStartPosition()),n=Tf(e.getEndPosition());return new Dc(o=>{const r=this.initialAstWithoutTokens||this.astWithTokens,a=new eue(o,t,this.textModel);kN(r,ps,r.length,i,n,a,0,new Map)})}getFirstBracketAfter(e){this.flushQueue();const t=this.initialAstWithoutTokens||this.astWithTokens;return kU(t,ps,t.length,Tf(e))}getFirstBracketBefore(e){this.flushQueue();const t=this.initialAstWithoutTokens||this.astWithTokens;return xU(t,ps,t.length,Tf(e))}}function xU(s,e,t,i){if(s.kind===4||s.kind===2){const n=[];for(const o of s.children)t=vi(e,o.length),n.push({nodeOffsetStart:e,nodeOffsetEnd:t}),e=t;for(let o=n.length-1;o>=0;o--){const{nodeOffsetStart:r,nodeOffsetEnd:a}=n[o];if(tp(r,i)){const l=xU(s.children[o],r,a,i);if(l)return l}}return null}else{if(s.kind===3)return null;if(s.kind===1){const n=Tu(e,t);return{bracketInfo:s.bracketInfo,range:n}}}return null}function kU(s,e,t,i){if(s.kind===4||s.kind===2){for(const n of s.children){if(t=vi(e,n.length),tp(i,t)){const o=kU(n,e,t,i);if(o)return o}e=t}return null}else{if(s.kind===3)return null;if(s.kind===1){const n=Tu(e,t);return{bracketInfo:s.bracketInfo,range:n}}}return null}function xN(s,e,t,i,n,o,r,a,l,c,d=!1){if(r>200)return!0;e:for(;;)switch(s.kind){case 4:{const h=s.childrenLength;for(let u=0;u<h;u++){const g=s.getChild(u);if(g){if(t=vi(e,g.length),ip(e,n)&&I_(t,i)){if(I_(t,n)){s=g;continue e}if(!xN(g,e,t,i,n,o,r,0,l,c))return!1}e=t}}return!0}case 2:{const h=!c||!s.closingBracket||s.closingBracket.bracketInfo.closesColorized(s.openingBracket.bracketInfo);let u=0;if(l){let f=l.get(s.openingBracket.text);f===void 0&&(f=0),u=f,h&&(f++,l.set(s.openingBracket.text,f))}const g=s.childrenLength;for(let f=0;f<g;f++){const m=s.getChild(f);if(m){if(t=vi(e,m.length),ip(e,n)&&I_(t,i)){if(I_(t,n)&&m.kind!==1){s=m,h?(r++,a=u+1):a=u;continue e}if((h||m.kind!==1||!s.closingBracket)&&!xN(m,e,t,i,n,o,h?r+1:r,h?u+1:u,l,c,!s.closingBracket))return!1}e=t}}return l?.set(s.openingBracket.text,u),!0}case 3:{const h=Tu(e,t);return o(new XB(h,r-1,0,!0))}case 1:{const h=Tu(e,t);return o(new XB(h,r-1,a-1,d))}case 0:return!0}}class eue{constructor(e,t,i){this.push=e,this.includeMinIndentation=t,this.textModel=i}}function kN(s,e,t,i,n,o,r,a){if(r>200)return!0;let l=!0;if(s.kind===2){let c=0;if(a){let u=a.get(s.openingBracket.text);u===void 0&&(u=0),c=u,u++,a.set(s.openingBracket.text,u)}const d=vi(e,s.openingBracket.length);let h=-1;if(o.includeMinIndentation&&(h=s.computeMinIndentation(e,o.textModel)),l=o.push(new Phe(Tu(e,t),Tu(e,d),s.closingBracket?Tu(vi(d,s.child?.length||ps),t):void 0,r,c,s,h)),e=d,l&&s.child){const u=s.child;if(t=vi(e,u.length),ip(e,n)&&I_(t,i)&&(l=kN(u,e,t,i,n,o,r+1,a),!l))return!1}a?.set(s.openingBracket.text,c)}else{let c=e;for(const d of s.children){const h=c;if(c=vi(c,d.length),ip(h,n)&&ip(i,c)&&(l=kN(d,h,c,i,n,o,r,a),!l))return!1}}return l}class tue extends B{get canBuildAST(){return this.textModel.getValueLength()<=5e6}constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t,this.bracketPairsTree=this._register(new nn),this.onDidChangeEmitter=new O,this.onDidChange=this.onDidChangeEmitter.event,this.bracketsRequested=!1}handleLanguageConfigurationServiceChange(e){(!e.languageId||this.bracketPairsTree.value?.object.didLanguageChange(e.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}handleDidChangeOptions(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(e){this.bracketPairsTree.value?.object.handleContentChanged(e)}handleDidChangeBackgroundTokenizationState(){this.bracketPairsTree.value?.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(e){this.bracketPairsTree.value?.object.handleDidChangeTokens(e)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){const e=new Z;this.bracketPairsTree.value=iue(e.add(new Jhe(this.textModel,t=>this.languageConfigurationService.getLanguageConfiguration(t))),e),e.add(this.bracketPairsTree.value.object.onDidChange(t=>this.onDidChangeEmitter.fire(t))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(e){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(e,!1)||Dc.empty}getBracketPairsInRangeWithMinIndentation(e){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(e,!0)||Dc.empty}getBracketsInRange(e,t=!1){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketsInRange(e,t)||Dc.empty}findMatchingBracketUp(e,t,i){const n=this.textModel.validatePosition(t),o=this.textModel.getLanguageIdAtPosition(n.lineNumber,n.column);if(this.canBuildAST){const r=this.languageConfigurationService.getLanguageConfiguration(o).bracketsNew.getClosingBracketInfo(e);if(!r)return null;const a=this.getBracketPairsInRange(k.fromPositions(t,t)).findLast(l=>r.closes(l.openingBracketInfo));return a?a.openingBracketRange:null}else{const r=e.toLowerCase(),a=this.languageConfigurationService.getLanguageConfiguration(o).brackets;if(!a)return null;const l=a.textIsBracket[r];return l?By(this._findMatchingBracketUp(l,n,ID(i))):null}}matchBracket(e,t){if(this.canBuildAST){const i=this.getBracketPairsInRange(k.fromPositions(e,e)).filter(n=>n.closingBracketRange!==void 0&&(n.openingBracketRange.containsPosition(e)||n.closingBracketRange.containsPosition(e))).findLastMaxBy(bs(n=>n.openingBracketRange.containsPosition(e)?n.openingBracketRange:n.closingBracketRange,k.compareRangesUsingStarts));return i?[i.openingBracketRange,i.closingBracketRange]:null}else{const i=ID(t);return this._matchBracket(this.textModel.validatePosition(e),i)}}_establishBracketSearchOffsets(e,t,i,n){const o=t.getCount(),r=t.getLanguageId(n);let a=Math.max(0,e.column-1-i.maxBracketLength);for(let c=n-1;c>=0;c--){const d=t.getEndOffset(c);if(d<=a)break;if(rl(t.getStandardTokenType(c))||t.getLanguageId(c)!==r){a=d;break}}let l=Math.min(t.getLineContent().length,e.column-1+i.maxBracketLength);for(let c=n+1;c<o;c++){const d=t.getStartOffset(c);if(d>=l)break;if(rl(t.getStandardTokenType(c))||t.getLanguageId(c)!==r){l=d;break}}return{searchStartOffset:a,searchEndOffset:l}}_matchBracket(e,t){const i=e.lineNumber,n=this.textModel.tokenization.getLineTokens(i),o=this.textModel.getLineContent(i),r=n.findTokenIndexAtOffset(e.column-1);if(r<0)return null;const a=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId(r)).brackets;if(a&&!rl(n.getStandardTokenType(r))){let{searchStartOffset:l,searchEndOffset:c}=this._establishBracketSearchOffsets(e,n,a,r),d=null;for(;;){const h=Pr.findNextBracketInRange(a.forwardRegex,i,o,l,c);if(!h)break;if(h.startColumn<=e.column&&e.column<=h.endColumn){const u=o.substring(h.startColumn-1,h.endColumn-1).toLowerCase(),g=this._matchFoundBracket(h,a.textIsBracket[u],a.textIsOpenBracket[u],t);if(g){if(g instanceof dc)return null;d=g}}l=h.endColumn-1}if(d)return d}if(r>0&&n.getStartOffset(r)===e.column-1){const l=r-1,c=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId(l)).brackets;if(c&&!rl(n.getStandardTokenType(l))){const{searchStartOffset:d,searchEndOffset:h}=this._establishBracketSearchOffsets(e,n,c,l),u=Pr.findPrevBracketInRange(c.reversedRegex,i,o,d,h);if(u&&u.startColumn<=e.column&&e.column<=u.endColumn){const g=o.substring(u.startColumn-1,u.endColumn-1).toLowerCase(),f=this._matchFoundBracket(u,c.textIsBracket[g],c.textIsOpenBracket[g],t);if(f)return f instanceof dc?null:f}}}return null}_matchFoundBracket(e,t,i,n){if(!t)return null;const o=i?this._findMatchingBracketDown(t,e.getEndPosition(),n):this._findMatchingBracketUp(t,e.getStartPosition(),n);return o?o instanceof dc?o:[e,o]:null}_findMatchingBracketUp(e,t,i){const n=e.languageId,o=e.reversedRegex;let r=-1,a=0;const l=(c,d,h,u)=>{for(;;){if(i&&++a%100===0&&!i())return dc.INSTANCE;const g=Pr.findPrevBracketInRange(o,c,d,h,u);if(!g)break;const f=d.substring(g.startColumn-1,g.endColumn-1).toLowerCase();if(e.isOpen(f)?r++:e.isClose(f)&&r--,r===0)return g;u=g.startColumn-1}return null};for(let c=t.lineNumber;c>=1;c--){const d=this.textModel.tokenization.getLineTokens(c),h=d.getCount(),u=this.textModel.getLineContent(c);let g=h-1,f=u.length,m=u.length;c===t.lineNumber&&(g=d.findTokenIndexAtOffset(t.column-1),f=t.column-1,m=t.column-1);let _=!0;for(;g>=0;g--){const b=d.getLanguageId(g)===n&&!rl(d.getStandardTokenType(g));if(b)_?f=d.getStartOffset(g):(f=d.getStartOffset(g),m=d.getEndOffset(g));else if(_&&f!==m){const v=l(c,u,f,m);if(v)return v}_=b}if(_&&f!==m){const b=l(c,u,f,m);if(b)return b}}return null}_findMatchingBracketDown(e,t,i){const n=e.languageId,o=e.forwardRegex;let r=1,a=0;const l=(d,h,u,g)=>{for(;;){if(i&&++a%100===0&&!i())return dc.INSTANCE;const f=Pr.findNextBracketInRange(o,d,h,u,g);if(!f)break;const m=h.substring(f.startColumn-1,f.endColumn-1).toLowerCase();if(e.isOpen(m)?r++:e.isClose(m)&&r--,r===0)return f;u=f.endColumn-1}return null},c=this.textModel.getLineCount();for(let d=t.lineNumber;d<=c;d++){const h=this.textModel.tokenization.getLineTokens(d),u=h.getCount(),g=this.textModel.getLineContent(d);let f=0,m=0,_=0;d===t.lineNumber&&(f=h.findTokenIndexAtOffset(t.column-1),m=t.column-1,_=t.column-1);let b=!0;for(;f<u;f++){const v=h.getLanguageId(f)===n&&!rl(h.getStandardTokenType(f));if(v)b||(m=h.getStartOffset(f)),_=h.getEndOffset(f);else if(b&&m!==_){const C=l(d,g,m,_);if(C)return C}b=v}if(b&&m!==_){const v=l(d,g,m,_);if(v)return v}}return null}findPrevBracket(e){const t=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketBefore(t)||null;let i=null,n=null,o=null;for(let r=t.lineNumber;r>=1;r--){const a=this.textModel.tokenization.getLineTokens(r),l=a.getCount(),c=this.textModel.getLineContent(r);let d=l-1,h=c.length,u=c.length;if(r===t.lineNumber){d=a.findTokenIndexAtOffset(t.column-1),h=t.column-1,u=t.column-1;const f=a.getLanguageId(d);i!==f&&(i=f,n=this.languageConfigurationService.getLanguageConfiguration(i).brackets,o=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew)}let g=!0;for(;d>=0;d--){const f=a.getLanguageId(d);if(i!==f){if(n&&o&&g&&h!==u){const _=Pr.findPrevBracketInRange(n.reversedRegex,r,c,h,u);if(_)return this._toFoundBracket(o,_);g=!1}i=f,n=this.languageConfigurationService.getLanguageConfiguration(i).brackets,o=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew}const m=!!n&&!rl(a.getStandardTokenType(d));if(m)g?h=a.getStartOffset(d):(h=a.getStartOffset(d),u=a.getEndOffset(d));else if(o&&n&&g&&h!==u){const _=Pr.findPrevBracketInRange(n.reversedRegex,r,c,h,u);if(_)return this._toFoundBracket(o,_)}g=m}if(o&&n&&g&&h!==u){const f=Pr.findPrevBracketInRange(n.reversedRegex,r,c,h,u);if(f)return this._toFoundBracket(o,f)}}return null}findNextBracket(e){const t=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketAfter(t)||null;const i=this.textModel.getLineCount();let n=null,o=null,r=null;for(let a=t.lineNumber;a<=i;a++){const l=this.textModel.tokenization.getLineTokens(a),c=l.getCount(),d=this.textModel.getLineContent(a);let h=0,u=0,g=0;if(a===t.lineNumber){h=l.findTokenIndexAtOffset(t.column-1),u=t.column-1,g=t.column-1;const m=l.getLanguageId(h);n!==m&&(n=m,o=this.languageConfigurationService.getLanguageConfiguration(n).brackets,r=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew)}let f=!0;for(;h<c;h++){const m=l.getLanguageId(h);if(n!==m){if(r&&o&&f&&u!==g){const b=Pr.findNextBracketInRange(o.forwardRegex,a,d,u,g);if(b)return this._toFoundBracket(r,b);f=!1}n=m,o=this.languageConfigurationService.getLanguageConfiguration(n).brackets,r=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew}const _=!!o&&!rl(l.getStandardTokenType(h));if(_)f||(u=l.getStartOffset(h)),g=l.getEndOffset(h);else if(r&&o&&f&&u!==g){const b=Pr.findNextBracketInRange(o.forwardRegex,a,d,u,g);if(b)return this._toFoundBracket(r,b)}f=_}if(r&&o&&f&&u!==g){const m=Pr.findNextBracketInRange(o.forwardRegex,a,d,u,g);if(m)return this._toFoundBracket(r,m)}}return null}findEnclosingBrackets(e,t){const i=this.textModel.validatePosition(e);if(this.canBuildAST){const g=k.fromPositions(i),f=this.getBracketPairsInRange(k.fromPositions(i,i)).findLast(m=>m.closingBracketRange!==void 0&&m.range.strictContainsRange(g));return f?[f.openingBracketRange,f.closingBracketRange]:null}const n=ID(t),o=this.textModel.getLineCount(),r=new Map;let a=[];const l=(g,f)=>{if(!r.has(g)){const m=[];for(let _=0,b=f?f.brackets.length:0;_<b;_++)m[_]=0;r.set(g,m)}a=r.get(g)};let c=0;const d=(g,f,m,_,b)=>{for(;;){if(n&&++c%100===0&&!n())return dc.INSTANCE;const v=Pr.findNextBracketInRange(g.forwardRegex,f,m,_,b);if(!v)break;const C=m.substring(v.startColumn-1,v.endColumn-1).toLowerCase(),y=g.textIsBracket[C];if(y&&(y.isOpen(C)?a[y.index]++:y.isClose(C)&&a[y.index]--,a[y.index]===-1))return this._matchFoundBracket(v,y,!1,n);_=v.endColumn-1}return null};let h=null,u=null;for(let g=i.lineNumber;g<=o;g++){const f=this.textModel.tokenization.getLineTokens(g),m=f.getCount(),_=this.textModel.getLineContent(g);let b=0,v=0,C=0;if(g===i.lineNumber){b=f.findTokenIndexAtOffset(i.column-1),v=i.column-1,C=i.column-1;const w=f.getLanguageId(b);h!==w&&(h=w,u=this.languageConfigurationService.getLanguageConfiguration(h).brackets,l(h,u))}let y=!0;for(;b<m;b++){const w=f.getLanguageId(b);if(h!==w){if(u&&y&&v!==C){const L=d(u,g,_,v,C);if(L)return By(L);y=!1}h=w,u=this.languageConfigurationService.getLanguageConfiguration(h).brackets,l(h,u)}const x=!!u&&!rl(f.getStandardTokenType(b));if(x)y||(v=f.getStartOffset(b)),C=f.getEndOffset(b);else if(u&&y&&v!==C){const L=d(u,g,_,v,C);if(L)return By(L)}y=x}if(u&&y&&v!==C){const w=d(u,g,_,v,C);if(w)return By(w)}}return null}_toFoundBracket(e,t){if(!t)return null;let i=this.textModel.getValueInRange(t);i=i.toLowerCase();const n=e.getBracketInfo(i);return n?{range:t,bracketInfo:n}:null}}function iue(s,e){return{object:s,dispose:()=>e?.dispose()}}function ID(s){if(typeof s>"u")return()=>!0;{const e=Date.now();return()=>Date.now()-e<=s}}class dc{static{this.INSTANCE=new dc}constructor(){this._searchCanceledBrand=void 0}}function By(s){return s instanceof dc?null:s}class nue extends B{constructor(e){super(),this.textModel=e,this.colorProvider=new DU,this.onDidChangeEmitter=new O,this.onDidChange=this.onDidChangeEmitter.event,this.colorizationOptions=e.getOptions().bracketPairColorizationOptions,this._register(e.bracketPairs.onDidChange(t=>{this.onDidChangeEmitter.fire()}))}handleDidChangeOptions(e){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(e,t,i,n){return n?[]:t===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(e,!0).map(r=>({id:`bracket${r.range.toString()}-${r.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(r,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:r.range})).toArray():[]}getAllDecorations(e,t){return e===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new k(1,1,this.textModel.getLineCount(),1),e,t):[]}}class DU{constructor(){this.unexpectedClosingBracketClassName="unexpected-closing-bracket"}getInlineClassName(e,t){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(t?e.nestingLevelOfEqualBracketType:e.nestingLevel)}getInlineClassNameOfLevel(e){return`bracket-highlighting-${e%30}`}}kr((s,e)=>{const t=[fU,pU,mU,_U,bU,vU],i=new DU;e.addRule(`.monaco-editor .${i.unexpectedClosingBracketClassName} { color: ${s.getColor(mhe)}; }`);const n=t.map(o=>s.getColor(o)).filter(o=>!!o).filter(o=>!o.isTransparent());for(let o=0;o<30;o++){const r=n[o%n.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(o)} { color: ${r}; }`)}});function Wy(s){return s.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class In{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(e,t,i,n){this.oldPosition=e,this.oldText=t,this.newPosition=i,this.newText=n}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${Wy(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${Wy(this.oldText)}")`:`(replace@${this.oldPosition} "${Wy(this.oldText)}" with "${Wy(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,i){const n=t.length;va(e,n,i),i+=4;for(let o=0;o<n;o++)Uie(e,t.charCodeAt(o),i),i+=2;return i}static _readString(e,t){const i=ba(e,t);return t+=4,jie(e,t,i)}writeSize(){return 8+In._writeStringSize(this.oldText)+In._writeStringSize(this.newText)}write(e,t){return va(e,this.oldPosition,t),t+=4,va(e,this.newPosition,t),t+=4,t=In._writeString(e,this.oldText,t),t=In._writeString(e,this.newText,t),t}static read(e,t,i){const n=ba(e,t);t+=4;const o=ba(e,t);t+=4;const r=In._readString(e,t);t+=In._writeStringSize(r);const a=In._readString(e,t);return t+=In._writeStringSize(a),i.push(new In(n,r,o,a)),t}}function sue(s,e){return s===null||s.length===0?e:new cl(s,e).compress()}class cl{constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,i=this._getPrev(e),n=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(i===null){this._acceptCurr(n),n=this._getCurr(++t);continue}if(n===null){this._acceptPrev(i),i=this._getPrev(++e);continue}if(n.oldEnd<=i.newPosition){this._acceptCurr(n),n=this._getCurr(++t);continue}if(i.newEnd<=n.oldPosition){this._acceptPrev(i),i=this._getPrev(++e);continue}if(n.oldPosition<i.newPosition){const[c,d]=cl._splitCurr(n,i.newPosition-n.oldPosition);this._acceptCurr(c),n=d;continue}if(i.newPosition<n.oldPosition){const[c,d]=cl._splitPrev(i,n.oldPosition-i.newPosition);this._acceptPrev(c),i=d;continue}let a,l;if(n.oldEnd===i.newEnd)a=i,l=n,i=this._getPrev(++e),n=this._getCurr(++t);else if(n.oldEnd<i.newEnd){const[c,d]=cl._splitPrev(i,n.oldLength);a=c,l=n,i=d,n=this._getCurr(++t)}else{const[c,d]=cl._splitCurr(n,i.newLength);a=i,l=c,i=this._getPrev(++e),n=d}this._result[this._resultLen++]=new In(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}const o=cl._merge(this._result);return cl._removeNoOps(o)}_acceptCurr(e){this._result[this._resultLen++]=cl._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=cl._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new In(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new In(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){const i=e.newText.substr(0,t),n=e.newText.substr(t);return[new In(e.oldPosition,e.oldText,e.newPosition,i),new In(e.oldEnd,"",e.newPosition+t,n)]}static _splitCurr(e,t){const i=e.oldText.substr(0,t),n=e.oldText.substr(t);return[new In(e.oldPosition,i,e.newPosition,e.newText),new In(e.oldPosition+t,n,e.newEnd,"")]}static _merge(e){if(e.length===0)return e;const t=[];let i=0,n=e[0];for(let o=1;o<e.length;o++){const r=e[o];n.oldEnd===r.oldPosition?n=new In(n.oldPosition,n.oldText+r.oldText,n.newPosition,n.newText+r.newText):(t[i++]=n,n=r)}return t[i++]=n,t}static _removeNoOps(e){if(e.length===0)return e;const t=[];let i=0;for(let n=0;n<e.length;n++){const o=e[n];o.oldText!==o.newText&&(t[i++]=o)}return t}}function jg(s){return s.toString()}class an{static create(e,t){const i=e.getAlternativeVersionId(),n=DN(e);return new an(i,i,n,n,t,t,[])}constructor(e,t,i,n,o,r,a){this.beforeVersionId=e,this.afterVersionId=t,this.beforeEOL=i,this.afterEOL=n,this.beforeCursorState=o,this.afterCursorState=r,this.changes=a}append(e,t,i,n,o){t.length>0&&(this.changes=sue(this.changes,t)),this.afterEOL=i,this.afterVersionId=n,this.afterCursorState=o}static _writeSelectionsSize(e){return 4+4*4*(e?e.length:0)}static _writeSelections(e,t,i){if(va(e,t?t.length:0,i),i+=4,t)for(const n of t)va(e,n.selectionStartLineNumber,i),i+=4,va(e,n.selectionStartColumn,i),i+=4,va(e,n.positionLineNumber,i),i+=4,va(e,n.positionColumn,i),i+=4;return i}static _readSelections(e,t,i){const n=ba(e,t);t+=4;for(let o=0;o<n;o++){const r=ba(e,t);t+=4;const a=ba(e,t);t+=4;const l=ba(e,t);t+=4;const c=ba(e,t);t+=4,i.push(new me(r,a,l,c))}return t}serialize(){let e=10+an._writeSelectionsSize(this.beforeCursorState)+an._writeSelectionsSize(this.afterCursorState)+4;for(const n of this.changes)e+=n.writeSize();const t=new Uint8Array(e);let i=0;va(t,this.beforeVersionId,i),i+=4,va(t,this.afterVersionId,i),i+=4,n3(t,this.beforeEOL,i),i+=1,n3(t,this.afterEOL,i),i+=1,i=an._writeSelections(t,this.beforeCursorState,i),i=an._writeSelections(t,this.afterCursorState,i),va(t,this.changes.length,i),i+=4;for(const n of this.changes)i=n.write(t,i);return t.buffer}static deserialize(e){const t=new Uint8Array(e);let i=0;const n=ba(t,i);i+=4;const o=ba(t,i);i+=4;const r=i3(t,i);i+=1;const a=i3(t,i);i+=1;const l=[];i=an._readSelections(t,i,l);const c=[];i=an._readSelections(t,i,c);const d=ba(t,i);i+=4;const h=[];for(let u=0;u<d;u++)i=In.read(t,i,h);return new an(n,o,r,a,l,c,h)}}class IU{get type(){return 0}get resource(){return Se.isUri(this.model)?this.model:this.model.uri}constructor(e,t,i,n){this.label=e,this.code=t,this.model=i,this._data=an.create(i,n)}toString(){return(this._data instanceof an?this._data:an.deserialize(this._data)).changes.map(t=>t.toString()).join(", ")}matchesResource(e){return(Se.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof an}append(e,t,i,n,o){this._data instanceof an&&this._data.append(e,t,i,n,o)}close(){this._data instanceof an&&(this._data=this._data.serialize())}open(){this._data instanceof an||(this._data=an.deserialize(this._data))}undo(){if(Se.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof an&&(this._data=this._data.serialize());const e=an.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(Se.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof an&&(this._data=this._data.serialize());const e=an.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof an&&(this._data=this._data.serialize()),this._data.byteLength+168}}class oue{get resources(){return this._editStackElementsArr.map(e=>e.resource)}constructor(e,t,i){this.label=e,this.code=t,this.type=1,this._isOpen=!0,this._editStackElementsArr=i.slice(0),this._editStackElementsMap=new Map;for(const n of this._editStackElementsArr){const o=jg(n.resource);this._editStackElementsMap.set(o,n)}this._delegate=null}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}matchesResource(e){const t=jg(e);return this._editStackElementsMap.has(t)}setModel(e){const t=jg(Se.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;const t=jg(e.uri);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).canAppend(e):!1}append(e,t,i,n,o){const r=jg(e.uri);this._editStackElementsMap.get(r).append(e,t,i,n,o)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(const e of this._editStackElementsArr)e.undo()}redo(){for(const e of this._editStackElementsArr)e.redo()}heapSize(e){const t=jg(e);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).heapSize():0}split(){return this._editStackElementsArr}toString(){const e=[];for(const t of this._editStackElementsArr)e.push(`${wr(t.resource)}: ${t}`);return`{${e.join(", ")}}`}}function DN(s){return s.getEOL()===`
`?0:1}function hc(s){return s?s instanceof IU||s instanceof oue:!1}class lO{constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);hc(e)&&e.close()}popStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);hc(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e,t){const i=this._undoRedoService.getLastElement(this._model.uri);if(hc(i)&&i.canAppend(this._model))return i;const n=new IU(p("edit","Typing"),"undoredo.textBufferEdit",this._model,e);return this._undoRedoService.pushElement(n,t),n}pushEOL(e){const t=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(e),t.append(this._model,[],DN(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,i,n){const o=this._getOrCreateEditStackElement(e,n),r=this._model.applyEdits(t,!0),a=lO._computeCursorState(i,r),l=r.map((c,d)=>({index:d,textChange:c.textChange}));return l.sort((c,d)=>c.textChange.oldPosition===d.textChange.oldPosition?c.index-d.index:c.textChange.oldPosition-d.textChange.oldPosition),o.append(this._model,l.map(c=>c.textChange),DN(this._model),this._model.getAlternativeVersionId(),a),a}static _computeCursorState(e,t){try{return e?e(t):null}catch(i){return Oe(i),null}}}class TU extends B{constructor(){super(...arguments),this._isDisposed=!1}dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}}function hx(s,e){let t=0,i=0;const n=s.length;for(;i<n;){const o=s.charCodeAt(i);if(o===32)t++;else if(o===9)t=t-t%e+e;else break;i++}return i===n?-1:t}var Eu;(function(s){s[s.Disabled=0]="Disabled",s[s.EnabledForActive=1]="EnabledForActive",s[s.Enabled=2]="Enabled"})(Eu||(Eu={}));class Cu{constructor(e,t,i,n,o,r){if(this.visibleColumn=e,this.column=t,this.className=i,this.horizontalLine=n,this.forWrappedLinesAfterColumn=o,this.forWrappedLinesBeforeOrAtColumn=r,e!==-1==(t!==-1))throw new Error}}class ib{constructor(e,t){this.top=e,this.endColumn=t}}class rue extends TU{constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t}getLanguageConfiguration(e){return this.languageConfigurationService.getLanguageConfiguration(e)}_computeIndentLevel(e){return hx(this.textModel.getLineContent(e+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(e,t,i){this.assertNotDisposed();const n=this.textModel.getLineCount();if(e<1||e>n)throw new mt("Illegal value for lineNumber");const o=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,r=!!(o&&o.offSide);let a=-2,l=-1,c=-2,d=-1;const h=L=>{if(a!==-1&&(a===-2||a>L-1)){a=-1,l=-1;for(let D=L-2;D>=0;D--){const T=this._computeIndentLevel(D);if(T>=0){a=D,l=T;break}}}if(c===-2){c=-1,d=-1;for(let D=L;D<n;D++){const T=this._computeIndentLevel(D);if(T>=0){c=D,d=T;break}}}};let u=-2,g=-1,f=-2,m=-1;const _=L=>{if(u===-2){u=-1,g=-1;for(let D=L-2;D>=0;D--){const T=this._computeIndentLevel(D);if(T>=0){u=D,g=T;break}}}if(f!==-1&&(f===-2||f<L-1)){f=-1,m=-1;for(let D=L;D<n;D++){const T=this._computeIndentLevel(D);if(T>=0){f=D,m=T;break}}}};let b=0,v=!0,C=0,y=!0,w=0,x=0;for(let L=0;v||y;L++){const D=e-L,T=e+L;L>1&&(D<1||D<t)&&(v=!1),L>1&&(T>n||T>i)&&(y=!1),L>5e4&&(v=!1,y=!1);let F=-1;if(v&&D>=1){const H=this._computeIndentLevel(D-1);H>=0?(c=D-1,d=H,F=Math.ceil(H/this.textModel.getOptions().indentSize)):(h(D),F=this._getIndentLevelForWhitespaceLine(r,l,d))}let W=-1;if(y&&T<=n){const H=this._computeIndentLevel(T-1);H>=0?(u=T-1,g=H,W=Math.ceil(H/this.textModel.getOptions().indentSize)):(_(T),W=this._getIndentLevelForWhitespaceLine(r,g,m))}if(L===0){x=F;continue}if(L===1){if(T<=n&&W>=0&&x+1===W){v=!1,b=T,C=T,w=W;continue}if(D>=1&&F>=0&&F-1===x){y=!1,b=D,C=D,w=F;continue}if(b=e,C=e,w=x,w===0)return{startLineNumber:b,endLineNumber:C,indent:w}}v&&(F>=w?b=D:v=!1),y&&(W>=w?C=T:y=!1)}return{startLineNumber:b,endLineNumber:C,indent:w}}getLinesBracketGuides(e,t,i,n){const o=[];for(let h=e;h<=t;h++)o.push([]);const r=!0,a=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new k(e,1,t,this.textModel.getLineMaxColumn(t))).toArray();let l;if(i&&a.length>0){const h=(e<=i.lineNumber&&i.lineNumber<=t?a:this.textModel.bracketPairs.getBracketPairsInRange(k.fromPositions(i)).toArray()).filter(u=>k.strictContainsPosition(u.range,i));l=Xb(h,u=>r)?.range}const c=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,d=new EU;for(const h of a){if(!h.closingBracketRange)continue;const u=l&&h.range.equalsRange(l);if(!u&&!n.includeInactive)continue;const g=d.getInlineClassName(h.nestingLevel,h.nestingLevelOfEqualBracketType,c)+(n.highlightActive&&u?" "+d.activeClassName:""),f=h.openingBracketRange.getStartPosition(),m=h.closingBracketRange.getStartPosition(),_=n.horizontalGuides===Eu.Enabled||n.horizontalGuides===Eu.EnabledForActive&&u;if(h.range.startLineNumber===h.range.endLineNumber){_&&o[h.range.startLineNumber-e].push(new Cu(-1,h.openingBracketRange.getEndPosition().column,g,new ib(!1,m.column),-1,-1));continue}const b=this.getVisibleColumnFromPosition(m),v=this.getVisibleColumnFromPosition(h.openingBracketRange.getStartPosition()),C=Math.min(v,b,h.minVisibleColumnIndentation+1);let y=!1;rs(this.textModel.getLineContent(h.closingBracketRange.startLineNumber))<h.closingBracketRange.startColumn-1&&(y=!0);const L=Math.max(f.lineNumber,e),D=Math.min(m.lineNumber,t),T=y?1:0;for(let F=L;F<D+T;F++)o[F-e].push(new Cu(C,-1,g,null,F===f.lineNumber?f.column:-1,F===m.lineNumber?m.column:-1));_&&(f.lineNumber>=e&&v>C&&o[f.lineNumber-e].push(new Cu(C,-1,g,new ib(!1,f.column),-1,-1)),m.lineNumber<=t&&b>C&&o[m.lineNumber-e].push(new Cu(C,-1,g,new ib(!y,m.column),-1,-1)))}for(const h of o)h.sort((u,g)=>u.visibleColumn-g.visibleColumn);return o}getVisibleColumnFromPosition(e){return $i.visibleColumnFromColumn(this.textModel.getLineContent(e.lineNumber),e.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(e,t){this.assertNotDisposed();const i=this.textModel.getLineCount();if(e<1||e>i)throw new Error("Illegal value for startLineNumber");if(t<1||t>i)throw new Error("Illegal value for endLineNumber");const n=this.textModel.getOptions(),o=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,r=!!(o&&o.offSide),a=new Array(t-e+1);let l=-2,c=-1,d=-2,h=-1;for(let u=e;u<=t;u++){const g=u-e,f=this._computeIndentLevel(u-1);if(f>=0){l=u-1,c=f,a[g]=Math.ceil(f/n.indentSize);continue}if(l===-2){l=-1,c=-1;for(let m=u-2;m>=0;m--){const _=this._computeIndentLevel(m);if(_>=0){l=m,c=_;break}}}if(d!==-1&&(d===-2||d<u-1)){d=-1,h=-1;for(let m=u;m<i;m++){const _=this._computeIndentLevel(m);if(_>=0){d=m,h=_;break}}}a[g]=this._getIndentLevelForWhitespaceLine(r,c,h)}return a}_getIndentLevelForWhitespaceLine(e,t,i){const n=this.textModel.getOptions();return t===-1||i===-1?0:t<i?1+Math.floor(t/n.indentSize):t===i||e?Math.ceil(i/n.indentSize):1+Math.floor(i/n.indentSize)}}class EU{constructor(){this.activeClassName="indent-active"}getInlineClassName(e,t,i){return this.getInlineClassNameOfLevel(i?t:e)}getInlineClassNameOfLevel(e){return`bracket-indent-guide lvl-${e%30}`}}class aue{constructor(){this.spacesDiff=0,this.looksLikeAlignment=!1}}function lue(s,e,t,i,n){n.spacesDiff=0,n.looksLikeAlignment=!1;let o;for(o=0;o<e&&o<i;o++){const u=s.charCodeAt(o),g=t.charCodeAt(o);if(u!==g)break}let r=0,a=0;for(let u=o;u<e;u++)s.charCodeAt(u)===32?r++:a++;let l=0,c=0;for(let u=o;u<i;u++)t.charCodeAt(u)===32?l++:c++;if(r>0&&a>0||l>0&&c>0)return;const d=Math.abs(a-c),h=Math.abs(r-l);if(d===0){n.spacesDiff=h,h>0&&0<=l-1&&l-1<s.length&&l<t.length&&t.charCodeAt(l)!==32&&s.charCodeAt(l-1)===32&&s.charCodeAt(s.length-1)===44&&(n.looksLikeAlignment=!0);return}if(h%d===0){n.spacesDiff=h/d;return}}function tW(s,e,t){const i=Math.min(s.getLineCount(),1e4);let n=0,o=0,r="",a=0;const l=[2,4,6,8,3,5,7],c=8,d=[0,0,0,0,0,0,0,0,0],h=new aue;for(let f=1;f<=i;f++){const m=s.getLineLength(f),_=s.getLineContent(f),b=m<=65536;let v=!1,C=0,y=0,w=0;for(let L=0,D=m;L<D;L++){const T=b?_.charCodeAt(L):s.getLineCharCode(f,L);if(T===9)w++;else if(T===32)y++;else{v=!0,C=L;break}}if(!v||(w>0?n++:y>1&&o++,lue(r,a,_,C,h),h.looksLikeAlignment&&!(t&&e===h.spacesDiff)))continue;const x=h.spacesDiff;x<=c&&d[x]++,r=_,a=C}let u=t;n!==o&&(u=n<o);let g=e;if(u){let f=u?0:.1*i;l.forEach(m=>{const _=d[m];_>f&&(f=_,g=m)}),g===4&&d[4]>0&&d[2]>0&&d[2]>=d[4]/2&&(g=2)}return{insertSpaces:u,tabSize:g}}function Ms(s){return(s.metadata&1)>>>0}function qt(s,e){s.metadata=s.metadata&254|e<<0}function Mn(s){return(s.metadata&2)>>>1===1}function $t(s,e){s.metadata=s.metadata&253|(e?1:0)<<1}function NU(s){return(s.metadata&4)>>>2===1}function iW(s,e){s.metadata=s.metadata&251|(e?1:0)<<2}function RU(s){return(s.metadata&64)>>>6===1}function nW(s,e){s.metadata=s.metadata&191|(e?1:0)<<6}function cue(s){return(s.metadata&24)>>>3}function sW(s,e){s.metadata=s.metadata&231|e<<3}function due(s){return(s.metadata&32)>>>5===1}function oW(s,e){s.metadata=s.metadata&223|(e?1:0)<<5}class MU{constructor(e,t,i){this.metadata=0,this.parent=this,this.left=this,this.right=this,qt(this,1),this.start=t,this.end=i,this.delta=0,this.maxEnd=i,this.id=e,this.ownerId=0,this.options=null,iW(this,!1),nW(this,!1),sW(this,1),oW(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=null,$t(this,!1)}reset(e,t,i,n){this.start=t,this.end=i,this.maxEnd=i,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=n}setOptions(e){this.options=e;const t=this.options.className;iW(this,t==="squiggly-error"||t==="squiggly-warning"||t==="squiggly-info"),nW(this,this.options.glyphMarginClassName!==null),sW(this,this.options.stickiness),oW(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(e,t,i){this.cachedVersionId!==i&&(this.range=null),this.cachedVersionId=i,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}}const Xe=new MU(null,0,0);Xe.parent=Xe;Xe.left=Xe;Xe.right=Xe;qt(Xe,0);class TD{constructor(){this.root=Xe,this.requestNormalizeDelta=!1}intervalSearch(e,t,i,n,o,r){return this.root===Xe?[]:bue(this,e,t,i,n,o,r)}search(e,t,i,n){return this.root===Xe?[]:_ue(this,e,t,i,n)}collectNodesFromOwner(e){return pue(this,e)}collectNodesPostOrder(){return mue(this)}insert(e){rW(this,e),this._normalizeDeltaIfNecessary()}delete(e){aW(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){const i=e;let n=0;for(;e!==this.root;)e===e.parent.right&&(n+=e.parent.delta),e=e.parent;const o=i.start+n,r=i.end+n;i.setCachedOffsets(o,r,t)}acceptReplace(e,t,i,n){const o=gue(this,e,e+t);for(let r=0,a=o.length;r<a;r++){const l=o[r];aW(this,l)}this._normalizeDeltaIfNecessary(),fue(this,e,e+t,i),this._normalizeDeltaIfNecessary();for(let r=0,a=o.length;r<a;r++){const l=o[r];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,uue(l,e,e+t,i,n),l.maxEnd=l.end,rW(this,l)}this._normalizeDeltaIfNecessary()}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,hue(this))}}function hue(s){let e=s.root,t=0;for(;e!==Xe;){if(e.left!==Xe&&!Mn(e.left)){e=e.left;continue}if(e.right!==Xe&&!Mn(e.right)){t+=e.delta,e=e.right;continue}e.start=t+e.start,e.end=t+e.end,e.delta=0,ch(e),$t(e,!0),$t(e.left,!1),$t(e.right,!1),e===e.parent.right&&(t-=e.parent.delta),e=e.parent}$t(s.root,!1)}function Zg(s,e,t,i){return s<t?!0:s>t||i===1?!1:i===2?!0:e}function uue(s,e,t,i,n){const o=cue(s),r=o===0||o===2,a=o===1||o===2,l=t-e,c=i,d=Math.min(l,c),h=s.start;let u=!1;const g=s.end;let f=!1;e<=h&&g<=t&&due(s)&&(s.start=e,u=!0,s.end=e,f=!0);{const _=n?1:l>0?2:0;!u&&Zg(h,r,e,_)&&(u=!0),!f&&Zg(g,a,e,_)&&(f=!0)}if(d>0&&!n){const _=l>c?2:0;!u&&Zg(h,r,e+d,_)&&(u=!0),!f&&Zg(g,a,e+d,_)&&(f=!0)}{const _=n?1:0;!u&&Zg(h,r,t,_)&&(s.start=e+c,u=!0),!f&&Zg(g,a,t,_)&&(s.end=e+c,f=!0)}const m=c-l;u||(s.start=Math.max(0,h+m)),f||(s.end=Math.max(0,g+m)),s.start>s.end&&(s.end=s.start)}function gue(s,e,t){let i=s.root,n=0,o=0,r=0,a=0;const l=[];let c=0;for(;i!==Xe;){if(Mn(i)){$t(i.left,!1),$t(i.right,!1),i===i.parent.right&&(n-=i.parent.delta),i=i.parent;continue}if(!Mn(i.left)){if(o=n+i.maxEnd,o<e){$t(i,!0);continue}if(i.left!==Xe){i=i.left;continue}}if(r=n+i.start,r>t){$t(i,!0);continue}if(a=n+i.end,a>=e&&(i.setCachedOffsets(r,a,0),l[c++]=i),$t(i,!0),i.right!==Xe&&!Mn(i.right)){n+=i.delta,i=i.right;continue}}return $t(s.root,!1),l}function fue(s,e,t,i){let n=s.root,o=0,r=0,a=0;const l=i-(t-e);for(;n!==Xe;){if(Mn(n)){$t(n.left,!1),$t(n.right,!1),n===n.parent.right&&(o-=n.parent.delta),ch(n),n=n.parent;continue}if(!Mn(n.left)){if(r=o+n.maxEnd,r<e){$t(n,!0);continue}if(n.left!==Xe){n=n.left;continue}}if(a=o+n.start,a>t){n.start+=l,n.end+=l,n.delta+=l,(n.delta<-1073741824||n.delta>1073741824)&&(s.requestNormalizeDelta=!0),$t(n,!0);continue}if($t(n,!0),n.right!==Xe&&!Mn(n.right)){o+=n.delta,n=n.right;continue}}$t(s.root,!1)}function pue(s,e){let t=s.root;const i=[];let n=0;for(;t!==Xe;){if(Mn(t)){$t(t.left,!1),$t(t.right,!1),t=t.parent;continue}if(t.left!==Xe&&!Mn(t.left)){t=t.left;continue}if(t.ownerId===e&&(i[n++]=t),$t(t,!0),t.right!==Xe&&!Mn(t.right)){t=t.right;continue}}return $t(s.root,!1),i}function mue(s){let e=s.root;const t=[];let i=0;for(;e!==Xe;){if(Mn(e)){$t(e.left,!1),$t(e.right,!1),e=e.parent;continue}if(e.left!==Xe&&!Mn(e.left)){e=e.left;continue}if(e.right!==Xe&&!Mn(e.right)){e=e.right;continue}t[i++]=e,$t(e,!0)}return $t(s.root,!1),t}function _ue(s,e,t,i,n){let o=s.root,r=0,a=0,l=0;const c=[];let d=0;for(;o!==Xe;){if(Mn(o)){$t(o.left,!1),$t(o.right,!1),o===o.parent.right&&(r-=o.parent.delta),o=o.parent;continue}if(o.left!==Xe&&!Mn(o.left)){o=o.left;continue}a=r+o.start,l=r+o.end,o.setCachedOffsets(a,l,i);let h=!0;if(e&&o.ownerId&&o.ownerId!==e&&(h=!1),t&&NU(o)&&(h=!1),n&&!RU(o)&&(h=!1),h&&(c[d++]=o),$t(o,!0),o.right!==Xe&&!Mn(o.right)){r+=o.delta,o=o.right;continue}}return $t(s.root,!1),c}function bue(s,e,t,i,n,o,r){let a=s.root,l=0,c=0,d=0,h=0;const u=[];let g=0;for(;a!==Xe;){if(Mn(a)){$t(a.left,!1),$t(a.right,!1),a===a.parent.right&&(l-=a.parent.delta),a=a.parent;continue}if(!Mn(a.left)){if(c=l+a.maxEnd,c<e){$t(a,!0);continue}if(a.left!==Xe){a=a.left;continue}}if(d=l+a.start,d>t){$t(a,!0);continue}if(h=l+a.end,h>=e){a.setCachedOffsets(d,h,o);let f=!0;i&&a.ownerId&&a.ownerId!==i&&(f=!1),n&&NU(a)&&(f=!1),r&&!RU(a)&&(f=!1),f&&(u[g++]=a)}if($t(a,!0),a.right!==Xe&&!Mn(a.right)){l+=a.delta,a=a.right;continue}}return $t(s.root,!1),u}function rW(s,e){if(s.root===Xe)return e.parent=Xe,e.left=Xe,e.right=Xe,qt(e,0),s.root=e,s.root;vue(s,e),ud(e.parent);let t=e;for(;t!==s.root&&Ms(t.parent)===1;)if(t.parent===t.parent.parent.left){const i=t.parent.parent.right;Ms(i)===1?(qt(t.parent,0),qt(i,0),qt(t.parent.parent,1),t=t.parent.parent):(t===t.parent.right&&(t=t.parent,nb(s,t)),qt(t.parent,0),qt(t.parent.parent,1),sb(s,t.parent.parent))}else{const i=t.parent.parent.left;Ms(i)===1?(qt(t.parent,0),qt(i,0),qt(t.parent.parent,1),t=t.parent.parent):(t===t.parent.left&&(t=t.parent,sb(s,t)),qt(t.parent,0),qt(t.parent.parent,1),nb(s,t.parent.parent))}return qt(s.root,0),e}function vue(s,e){let t=0,i=s.root;const n=e.start,o=e.end;for(;;)if(yue(n,o,i.start+t,i.end+t)<0)if(i.left===Xe){e.start-=t,e.end-=t,e.maxEnd-=t,i.left=e;break}else i=i.left;else if(i.right===Xe){e.start-=t+i.delta,e.end-=t+i.delta,e.maxEnd-=t+i.delta,i.right=e;break}else t+=i.delta,i=i.right;e.parent=i,e.left=Xe,e.right=Xe,qt(e,1)}function aW(s,e){let t,i;if(e.left===Xe?(t=e.right,i=e,t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(s.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta):e.right===Xe?(t=e.left,i=e):(i=Cue(e.right),t=i.right,t.start+=i.delta,t.end+=i.delta,t.delta+=i.delta,(t.delta<-1073741824||t.delta>1073741824)&&(s.requestNormalizeDelta=!0),i.start+=e.delta,i.end+=e.delta,i.delta=e.delta,(i.delta<-1073741824||i.delta>1073741824)&&(s.requestNormalizeDelta=!0)),i===s.root){s.root=t,qt(t,0),e.detach(),ED(),ch(t),s.root.parent=Xe;return}const n=Ms(i)===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?t.parent=i.parent:(i.parent===e?t.parent=i:t.parent=i.parent,i.left=e.left,i.right=e.right,i.parent=e.parent,qt(i,Ms(e)),e===s.root?s.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==Xe&&(i.left.parent=i),i.right!==Xe&&(i.right.parent=i)),e.detach(),n){ud(t.parent),i!==e&&(ud(i),ud(i.parent)),ED();return}ud(t),ud(t.parent),i!==e&&(ud(i),ud(i.parent));let o;for(;t!==s.root&&Ms(t)===0;)t===t.parent.left?(o=t.parent.right,Ms(o)===1&&(qt(o,0),qt(t.parent,1),nb(s,t.parent),o=t.parent.right),Ms(o.left)===0&&Ms(o.right)===0?(qt(o,1),t=t.parent):(Ms(o.right)===0&&(qt(o.left,0),qt(o,1),sb(s,o),o=t.parent.right),qt(o,Ms(t.parent)),qt(t.parent,0),qt(o.right,0),nb(s,t.parent),t=s.root)):(o=t.parent.left,Ms(o)===1&&(qt(o,0),qt(t.parent,1),sb(s,t.parent),o=t.parent.left),Ms(o.left)===0&&Ms(o.right)===0?(qt(o,1),t=t.parent):(Ms(o.left)===0&&(qt(o.right,0),qt(o,1),nb(s,o),o=t.parent.left),qt(o,Ms(t.parent)),qt(t.parent,0),qt(o.left,0),sb(s,t.parent),t=s.root));qt(t,0),ED()}function Cue(s){for(;s.left!==Xe;)s=s.left;return s}function ED(){Xe.parent=Xe,Xe.delta=0,Xe.start=0,Xe.end=0}function nb(s,e){const t=e.right;t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(s.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta,e.right=t.left,t.left!==Xe&&(t.left.parent=e),t.parent=e.parent,e.parent===Xe?s.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,ch(e),ch(t)}function sb(s,e){const t=e.left;e.delta-=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(s.requestNormalizeDelta=!0),e.start-=t.delta,e.end-=t.delta,e.left=t.right,t.right!==Xe&&(t.right.parent=e),t.parent=e.parent,e.parent===Xe?s.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,ch(e),ch(t)}function AU(s){let e=s.end;if(s.left!==Xe){const t=s.left.maxEnd;t>e&&(e=t)}if(s.right!==Xe){const t=s.right.maxEnd+s.delta;t>e&&(e=t)}return e}function ch(s){s.maxEnd=AU(s)}function ud(s){for(;s!==Xe;){const e=AU(s);if(s.maxEnd===e)return;s.maxEnd=e,s=s.parent}}function yue(s,e,t,i){return s===t?e-i:s-t}class IN{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==Ve)return cO(this.right);let e=this;for(;e.parent!==Ve&&e.parent.left!==e;)e=e.parent;return e.parent===Ve?Ve:e.parent}prev(){if(this.left!==Ve)return PU(this.left);let e=this;for(;e.parent!==Ve&&e.parent.right!==e;)e=e.parent;return e.parent===Ve?Ve:e.parent}detach(){this.parent=null,this.left=null,this.right=null}}const Ve=new IN(null,0);Ve.parent=Ve;Ve.left=Ve;Ve.right=Ve;Ve.color=0;function cO(s){for(;s.left!==Ve;)s=s.left;return s}function PU(s){for(;s.right!==Ve;)s=s.right;return s}function dO(s){return s===Ve?0:s.size_left+s.piece.length+dO(s.right)}function hO(s){return s===Ve?0:s.lf_left+s.piece.lineFeedCnt+hO(s.right)}function ND(){Ve.parent=Ve}function ob(s,e){const t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==Ve&&(t.left.parent=e),t.parent=e.parent,e.parent===Ve?s.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function rb(s,e){const t=e.left;e.left=t.right,t.right!==Ve&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===Ve?s.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function Hy(s,e){let t,i;if(e.left===Ve?(i=e,t=i.right):e.right===Ve?(i=e,t=i.left):(i=cO(e.right),t=i.right),i===s.root){s.root=t,t.color=0,e.detach(),ND(),s.root.parent=Ve;return}const n=i.color===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?(t.parent=i.parent,T_(s,t)):(i.parent===e?t.parent=i:t.parent=i.parent,T_(s,t),i.left=e.left,i.right=e.right,i.parent=e.parent,i.color=e.color,e===s.root?s.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==Ve&&(i.left.parent=i),i.right!==Ve&&(i.right.parent=i),i.size_left=e.size_left,i.lf_left=e.lf_left,T_(s,i)),e.detach(),t.parent.left===t){const r=dO(t),a=hO(t);if(r!==t.parent.size_left||a!==t.parent.lf_left){const l=r-t.parent.size_left,c=a-t.parent.lf_left;t.parent.size_left=r,t.parent.lf_left=a,ic(s,t.parent,l,c)}}if(T_(s,t.parent),n){ND();return}let o;for(;t!==s.root&&t.color===0;)t===t.parent.left?(o=t.parent.right,o.color===1&&(o.color=0,t.parent.color=1,ob(s,t.parent),o=t.parent.right),o.left.color===0&&o.right.color===0?(o.color=1,t=t.parent):(o.right.color===0&&(o.left.color=0,o.color=1,rb(s,o),o=t.parent.right),o.color=t.parent.color,t.parent.color=0,o.right.color=0,ob(s,t.parent),t=s.root)):(o=t.parent.left,o.color===1&&(o.color=0,t.parent.color=1,rb(s,t.parent),o=t.parent.left),o.left.color===0&&o.right.color===0?(o.color=1,t=t.parent):(o.left.color===0&&(o.right.color=0,o.color=1,ob(s,o),o=t.parent.left),o.color=t.parent.color,t.parent.color=0,o.left.color=0,rb(s,t.parent),t=s.root));t.color=0,ND()}function lW(s,e){for(T_(s,e);e!==s.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){const t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,ob(s,e)),e.parent.color=0,e.parent.parent.color=1,rb(s,e.parent.parent))}else{const t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,rb(s,e)),e.parent.color=0,e.parent.parent.color=1,ob(s,e.parent.parent))}s.root.color=0}function ic(s,e,t,i){for(;e!==s.root&&e!==Ve;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}function T_(s,e){let t=0,i=0;if(e!==s.root){for(;e!==s.root&&e===e.parent.right;)e=e.parent;if(e!==s.root)for(e=e.parent,t=dO(e.left)-e.size_left,i=hO(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=i;e!==s.root&&(t!==0||i!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}}const Gl=65535;function OU(s){let e;return s[s.length-1]<65536?e=new Uint16Array(s.length):e=new Uint32Array(s.length),e.set(s,0),e}class wue{constructor(e,t,i,n,o){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=n,this.isBasicASCII=o}}function nc(s,e=!0){const t=[0];let i=1;for(let n=0,o=s.length;n<o;n++){const r=s.charCodeAt(n);r===13?n+1<o&&s.charCodeAt(n+1)===10?(t[i++]=n+2,n++):t[i++]=n+1:r===10&&(t[i++]=n+1)}return e?OU(t):t}function Sue(s,e){s.length=0,s[0]=0;let t=1,i=0,n=0,o=0,r=!0;for(let l=0,c=e.length;l<c;l++){const d=e.charCodeAt(l);d===13?l+1<c&&e.charCodeAt(l+1)===10?(o++,s[t++]=l+2,l++):(i++,s[t++]=l+1):d===10?(n++,s[t++]=l+1):r&&d!==9&&(d<32||d>126)&&(r=!1)}const a=new wue(OU(s),i,n,o,r);return s.length=0,a}class Js{constructor(e,t,i,n,o){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=n,this.length=o}}class lu{constructor(e,t){this.buffer=e,this.lineStarts=t}}class Lue{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==Ve&&e.iterate(e.root,i=>(i!==Ve&&this._pieces.push(i.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class xue{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1;const i=this._cache;for(let n=0;n<i.length;n++){const o=i[n];if(o.node.parent===null||o.nodeStartOffset>=e){i[n]=null,t=!0;continue}}if(t){const n=[];for(const o of i)o!==null&&n.push(o);this._cache=n}}}class kue{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this._buffers=[new lu("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=Ve,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=i;let n=null;for(let o=0,r=e.length;o<r;o++)if(e[o].buffer.length>0){e[o].lineStarts||(e[o].lineStarts=nc(e[o].buffer));const a=new Js(o+1,{line:0,column:0},{line:e[o].lineStarts.length-1,column:e[o].buffer.length-e[o].lineStarts[e[o].lineStarts.length-1]},e[o].lineStarts.length-1,e[o].buffer.length);this._buffers.push(e[o]),n=this.rbInsertRight(n,a)}this._searchCache=new xue(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){const t=Gl,i=t-Math.floor(t/3),n=i*2;let o="",r=0;const a=[];if(this.iterate(this.root,l=>{const c=this.getNodeContent(l),d=c.length;if(r<=i||r+d<n)return o+=c,r+=d,!0;const h=o.replace(/\r\n|\r|\n/g,e);return a.push(new lu(h,nc(h))),o=c,r=d,!0}),r>0){const l=o.replace(/\r\n|\r|\n/g,e);a.push(new lu(l,nc(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new Lue(this,e)}getOffsetAt(e,t){let i=0,n=this.root;for(;n!==Ve;)if(n.left!==Ve&&n.lf_left+1>=e)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt+1>=e){i+=n.size_left;const o=this.getAccumulatedValue(n,e-n.lf_left-2);return i+=o+t-1}else e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0;const n=e;for(;t!==Ve;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){const o=this.getIndexOf(t,e-t.size_left);if(i+=t.lf_left+o.index,o.index===0){const r=this.getOffsetAt(i+1,1),a=n-r;return new P(i+1,a+1)}return new P(i+1,o.remainder+1)}else if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===Ve){const o=this.getOffsetAt(i+1,1),r=n-e-o;return new P(i+1,r+1)}else t=t.right;return new P(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const i=this.nodeAt2(e.startLineNumber,e.startColumn),n=this.nodeAt2(e.endLineNumber,e.endColumn),o=this.getValueInRange2(i,n);return t?t!==this._EOL||!this._EOLNormalized?o.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?o:o.replace(/\r\n|\r|\n/g,t):o}getValueInRange2(e,t){if(e.node===t.node){const a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,c=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(c+e.remainder,c+t.remainder)}let i=e.node;const n=this._buffers[i.piece.bufferIndex].buffer,o=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);let r=n.substring(o+e.remainder,o+i.piece.length);for(i=i.next();i!==Ve;){const a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===t.node){r+=a.substring(l,l+t.remainder);break}else r+=a.substr(l,i.piece.length);i=i.next()}return r}getLinesContent(){const e=[];let t=0,i="",n=!1;return this.iterate(this.root,o=>{if(o===Ve)return!0;const r=o.piece;let a=r.length;if(a===0)return!0;const l=this._buffers[r.bufferIndex].buffer,c=this._buffers[r.bufferIndex].lineStarts,d=r.start.line,h=r.end.line;let u=c[d]+r.start.column;if(n&&(l.charCodeAt(u)===10&&(u++,a--),e[t++]=i,i="",n=!1,a===0))return!0;if(d===h)return!this._EOLNormalized&&l.charCodeAt(u+a-1)===13?(n=!0,i+=l.substr(u,a-1)):i+=l.substr(u,a),!0;i+=this._EOLNormalized?l.substring(u,Math.max(u,c[d+1]-this._EOLLength)):l.substring(u,c[d+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let g=d+1;g<h;g++)i=this._EOLNormalized?l.substring(c[g],c[g+1]-this._EOLLength):l.substring(c[g],c[g+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return!this._EOLNormalized&&l.charCodeAt(c[h]+r.end.column-1)===13?(n=!0,r.end.column===0?t--:i=l.substr(c[h],r.end.column-1)):i=l.substr(c[h],r.end.column),!0}),n&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const i=this._buffers[t.piece.bufferIndex],n=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(n)}else{const t=this._buffers[e.node.piece.bufferIndex],n=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(n)}}getLineCharCode(e,t){const i=this.nodeAt2(e,t+1);return this._getCharCode(i)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}findMatchesInNode(e,t,i,n,o,r,a,l,c,d,h){const u=this._buffers[e.piece.bufferIndex],g=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),f=this.offsetInBuffer(e.piece.bufferIndex,o),m=this.offsetInBuffer(e.piece.bufferIndex,r);let _;const b={line:0,column:0};let v,C;t._wordSeparators?(v=u.buffer.substring(f,m),C=y=>y+f,t.reset(0)):(v=u.buffer,C=y=>y,t.reset(f));do if(_=t.next(v),_){if(C(_.index)>=m)return d;this.positionInBuffer(e,C(_.index)-g,b);const y=this.getLineFeedCnt(e.piece.bufferIndex,o,b),w=b.line===o.line?b.column-o.column+n:b.column+1,x=w+_[0].length;if(h[d++]=iu(new k(i+y,w,i+y,x),_,l),C(_.index)+_[0].length>=m||d>=c)return d}while(_);return d}findMatchesLineByLine(e,t,i,n){const o=[];let r=0;const a=new Sf(t.wordSeparators,t.regex);let l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];const c=this.nodeAt2(e.endLineNumber,e.endColumn);if(c===null)return[];let d=this.positionInBuffer(l.node,l.remainder);const h=this.positionInBuffer(c.node,c.remainder);if(l.node===c.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,d,h,t,i,n,r,o),o;let u=e.startLineNumber,g=l.node;for(;g!==c.node;){const m=this.getLineFeedCnt(g.piece.bufferIndex,d,g.piece.end);if(m>=1){const b=this._buffers[g.piece.bufferIndex].lineStarts,v=this.offsetInBuffer(g.piece.bufferIndex,g.piece.start),C=b[d.line+m],y=u===e.startLineNumber?e.startColumn:1;if(r=this.findMatchesInNode(g,a,u,y,d,this.positionInBuffer(g,C-v),t,i,n,r,o),r>=n)return o;u+=m}const _=u===e.startLineNumber?e.startColumn-1:0;if(u===e.endLineNumber){const b=this.getLineContent(u).substring(_,e.endColumn-1);return r=this._findMatchesInLine(t,a,b,e.endLineNumber,_,r,o,i,n),o}if(r=this._findMatchesInLine(t,a,this.getLineContent(u).substr(_),u,_,r,o,i,n),r>=n)return o;u++,l=this.nodeAt2(u,1),g=l.node,d=this.positionInBuffer(l.node,l.remainder)}if(u===e.endLineNumber){const m=u===e.startLineNumber?e.startColumn-1:0,_=this.getLineContent(u).substring(m,e.endColumn-1);return r=this._findMatchesInLine(t,a,_,e.endLineNumber,m,r,o,i,n),o}const f=u===e.startLineNumber?e.startColumn:1;return r=this.findMatchesInNode(c.node,a,u,f,d,h,t,i,n,r,o),o}_findMatchesInLine(e,t,i,n,o,r,a,l,c){const d=e.wordSeparators;if(!l&&e.simpleSearch){const u=e.simpleSearch,g=u.length,f=i.length;let m=-g;for(;(m=i.indexOf(u,m+g))!==-1;)if((!d||d2(d,i,f,m,g))&&(a[r++]=new Yb(new k(n,m+1+o,n,m+1+g+o),null),r>=c))return r;return r}let h;t.reset(0);do if(h=t.next(i),h&&(a[r++]=iu(new k(n,h.index+1+o,n,h.index+1+h[0].length+o),h,l),r>=c))return r;while(h);return r}insert(e,t,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==Ve){const{node:n,remainder:o,nodeStartOffset:r}=this.nodeAt(e),a=n.piece,l=a.bufferIndex,c=this.positionInBuffer(n,o);if(n.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&r+a.length===e&&t.length<Gl){this.appendToNode(n,t),this.computeBufferMetadata();return}if(r===e)this.insertContentToNodeLeft(t,n),this._searchCache.validate(e);else if(r+n.piece.length>e){const d=[];let h=new Js(a.bufferIndex,c,a.end,this.getLineFeedCnt(a.bufferIndex,c,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,c));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(n,o)===10){const m={line:h.start.line+1,column:0};h=new Js(h.bufferIndex,m,h.end,this.getLineFeedCnt(h.bufferIndex,m,h.end),h.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(n,o-1)===13){const m=this.positionInBuffer(n,o-1);this.deleteNodeTail(n,m),t="\r"+t,n.piece.length===0&&d.push(n)}else this.deleteNodeTail(n,c);else this.deleteNodeTail(n,c);const u=this.createNewPieces(t);h.length>0&&this.rbInsertRight(n,h);let g=n;for(let f=0;f<u.length;f++)g=this.rbInsertRight(g,u[f]);this.deleteNodes(d)}else this.insertContentToNodeRight(t,n)}else{const n=this.createNewPieces(t);let o=this.rbInsertLeft(null,n[0]);for(let r=1;r<n.length;r++)o=this.rbInsertRight(o,n[r])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===Ve)return;const i=this.nodeAt(e),n=this.nodeAt(e+t),o=i.node,r=n.node;if(o===r){const u=this.positionInBuffer(o,i.remainder),g=this.positionInBuffer(o,n.remainder);if(i.nodeStartOffset===e){if(t===o.piece.length){const f=o.next();Hy(this,o),this.validateCRLFWithPrevNode(f),this.computeBufferMetadata();return}this.deleteNodeHead(o,g),this._searchCache.validate(e),this.validateCRLFWithPrevNode(o),this.computeBufferMetadata();return}if(i.nodeStartOffset+o.piece.length===e+t){this.deleteNodeTail(o,u),this.validateCRLFWithNextNode(o),this.computeBufferMetadata();return}this.shrinkNode(o,u,g),this.computeBufferMetadata();return}const a=[],l=this.positionInBuffer(o,i.remainder);this.deleteNodeTail(o,l),this._searchCache.validate(e),o.piece.length===0&&a.push(o);const c=this.positionInBuffer(r,n.remainder);this.deleteNodeHead(r,c),r.piece.length===0&&a.push(r);const d=o.next();for(let u=d;u!==Ve&&u!==r;u=u.next())a.push(u);const h=o.piece.length===0?o.prev():o;this.deleteNodes(a),this.validateCRLFWithNextNode(h),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){const i=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){const r=t.piece,a={line:r.start.line+1,column:0},l=new Js(r.bufferIndex,a,r.end,this.getLineFeedCnt(r.bufferIndex,a,r.end),r.length-1);t.piece=l,e+=`
`,ic(this,t,-1,-1),t.piece.length===0&&i.push(t)}const n=this.createNewPieces(e);let o=this.rbInsertLeft(t,n[n.length-1]);for(let r=n.length-2;r>=0;r--)o=this.rbInsertLeft(o,n[r]);this.validateCRLFWithPrevNode(o),this.deleteNodes(i)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);const i=this.createNewPieces(e),n=this.rbInsertRight(t,i[0]);let o=n;for(let r=1;r<i.length;r++)o=this.rbInsertRight(o,i[r]);this.validateCRLFWithPrevNode(n)}positionInBuffer(e,t,i){const n=e.piece,o=e.piece.bufferIndex,r=this._buffers[o].lineStarts,l=r[n.start.line]+n.start.column+t;let c=n.start.line,d=n.end.line,h=0,u=0,g=0;for(;c<=d&&(h=c+(d-c)/2|0,g=r[h],h!==d);)if(u=r[h+1],l<g)d=h-1;else if(l>=u)c=h+1;else break;return i?(i.line=h,i.column=l-g,null):{line:h,column:l-g}}getLineFeedCnt(e,t,i){if(i.column===0)return i.line-t.line;const n=this._buffers[e].lineStarts;if(i.line===n.length-1)return i.line-t.line;const o=n[i.line+1],r=n[i.line]+i.column;if(o>r+1)return i.line-t.line;const a=r-1;return this._buffers[e].buffer.charCodeAt(a)===13?i.line-t.line+1:i.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)Hy(this,e[t])}createNewPieces(e){if(e.length>Gl){const d=[];for(;e.length>Gl;){const u=e.charCodeAt(Gl-1);let g;u===13||u>=55296&&u<=56319?(g=e.substring(0,Gl-1),e=e.substring(Gl-1)):(g=e.substring(0,Gl),e=e.substring(Gl));const f=nc(g);d.push(new Js(this._buffers.length,{line:0,column:0},{line:f.length-1,column:g.length-f[f.length-1]},f.length-1,g.length)),this._buffers.push(new lu(g,f))}const h=nc(e);return d.push(new Js(this._buffers.length,{line:0,column:0},{line:h.length-1,column:e.length-h[h.length-1]},h.length-1,e.length)),this._buffers.push(new lu(e,h)),d}let t=this._buffers[0].buffer.length;const i=nc(e,!1);let n=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},n=this._lastChangeBufferPos;for(let d=0;d<i.length;d++)i[d]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let d=0;d<i.length;d++)i[d]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=e}const o=this._buffers[0].buffer.length,r=this._buffers[0].lineStarts.length-1,a=o-this._buffers[0].lineStarts[r],l={line:r,column:a},c=new Js(0,n,l,this.getLineFeedCnt(0,n,l),o-t);return this._lastChangeBufferPos=l,[c]}getLineRawContent(e,t=0){let i=this.root,n="";const o=this._searchCache.get2(e);if(o){i=o.node;const r=this.getAccumulatedValue(i,e-o.nodeStartLineNumber-1),a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(o.nodeStartLineNumber+i.piece.lineFeedCnt===e)n=a.substring(l+r,l+i.piece.length);else{const c=this.getAccumulatedValue(i,e-o.nodeStartLineNumber);return a.substring(l+r,l+c-t)}}else{let r=0;const a=e;for(;i!==Ve;)if(i.left!==Ve&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this.getAccumulatedValue(i,e-i.lf_left-1),d=this._buffers[i.piece.bufferIndex].buffer,h=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return r+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:r,nodeStartLineNumber:a-(e-1-i.lf_left)}),d.substring(h+l,h+c-t)}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this._buffers[i.piece.bufferIndex].buffer,d=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n=c.substring(d+l,d+i.piece.length);break}else e-=i.lf_left+i.piece.lineFeedCnt,r+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==Ve;){const r=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){const a=this.getAccumulatedValue(i,0),l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n+=r.substring(l,l+a-t),n}else{const a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n+=r.substr(a,i.piece.length)}i=i.next()}return n}computeBufferMetadata(){let e=this.root,t=1,i=0;for(;e!==Ve;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=i,this._searchCache.validate(this._length)}getIndexOf(e,t){const i=e.piece,n=this.positionInBuffer(e,t),o=n.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===t){const r=this.getLineFeedCnt(e.piece.bufferIndex,i.start,n);if(r!==o)return{index:r,remainder:0}}return{index:o,remainder:n.column}}getAccumulatedValue(e,t){if(t<0)return 0;const i=e.piece,n=this._buffers[i.bufferIndex].lineStarts,o=i.start.line+t+1;return o>i.end.line?n[i.end.line]+i.end.column-n[i.start.line]-i.start.column:n[o]-n[i.start.line]-i.start.column}deleteNodeTail(e,t){const i=e.piece,n=i.lineFeedCnt,o=this.offsetInBuffer(i.bufferIndex,i.end),r=t,a=this.offsetInBuffer(i.bufferIndex,r),l=this.getLineFeedCnt(i.bufferIndex,i.start,r),c=l-n,d=a-o,h=i.length+d;e.piece=new Js(i.bufferIndex,i.start,r,l,h),ic(this,e,d,c)}deleteNodeHead(e,t){const i=e.piece,n=i.lineFeedCnt,o=this.offsetInBuffer(i.bufferIndex,i.start),r=t,a=this.getLineFeedCnt(i.bufferIndex,r,i.end),l=this.offsetInBuffer(i.bufferIndex,r),c=a-n,d=o-l,h=i.length+d;e.piece=new Js(i.bufferIndex,r,i.end,a,h),ic(this,e,d,c)}shrinkNode(e,t,i){const n=e.piece,o=n.start,r=n.end,a=n.length,l=n.lineFeedCnt,c=t,d=this.getLineFeedCnt(n.bufferIndex,n.start,c),h=this.offsetInBuffer(n.bufferIndex,t)-this.offsetInBuffer(n.bufferIndex,o);e.piece=new Js(n.bufferIndex,n.start,c,d,h),ic(this,e,h-a,d-l);const u=new Js(n.bufferIndex,i,r,this.getLineFeedCnt(n.bufferIndex,i,r),this.offsetInBuffer(n.bufferIndex,r)-this.offsetInBuffer(n.bufferIndex,i)),g=this.rbInsertRight(e,u);this.validateCRLFWithPrevNode(g)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);const i=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),n=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const o=nc(t,!1);for(let g=0;g<o.length;g++)o[g]+=n;if(i){const g=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:n-g}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(o.slice(1));const r=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[r],l={line:r,column:a},c=e.piece.length+t.length,d=e.piece.lineFeedCnt,h=this.getLineFeedCnt(0,e.piece.start,l),u=h-d;e.piece=new Js(e.piece.bufferIndex,e.piece.start,l,h,c),this._lastChangeBufferPos=l,ic(this,e,t.length,u)}nodeAt(e){let t=this.root;const i=this._searchCache.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let n=0;for(;t!==Ve;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){n+=t.size_left;const o={node:t,remainder:e-t.size_left,nodeStartOffset:n};return this._searchCache.set(o),o}else e-=t.size_left+t.piece.length,n+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let i=this.root,n=0;for(;i!==Ve;)if(i.left!==Ve&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const o=this.getAccumulatedValue(i,e-i.lf_left-2),r=this.getAccumulatedValue(i,e-i.lf_left-1);return n+=i.size_left,{node:i,remainder:Math.min(o+t-1,r),nodeStartOffset:n}}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const o=this.getAccumulatedValue(i,e-i.lf_left-2);if(o+t-1<=i.piece.length)return{node:i,remainder:o+t-1,nodeStartOffset:n};t-=i.piece.length-o;break}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==Ve;){if(i.piece.lineFeedCnt>0){const o=this.getAccumulatedValue(i,0),r=this.offsetOfNode(i);return{node:i,remainder:Math.min(t-1,o),nodeStartOffset:r}}else if(i.piece.length>=t-1){const o=this.offsetOfNode(i);return{node:i,remainder:t-1,nodeStartOffset:o}}else t-=i.piece.length;i=i.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;const i=this._buffers[e.piece.bufferIndex],n=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(n)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===Ve||e.piece.lineFeedCnt===0)return!1;const t=e.piece,i=this._buffers[t.bufferIndex].lineStarts,n=t.start.line,o=i[n]+t.start.column;return n===i.length-1||i[n+1]>o+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(o)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===Ve||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){const i=[],n=this._buffers[e.piece.bufferIndex].lineStarts;let o;e.piece.end.column===0?o={line:e.piece.end.line-1,column:n[e.piece.end.line]-n[e.piece.end.line-1]-1}:o={line:e.piece.end.line,column:e.piece.end.column-1};const r=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new Js(e.piece.bufferIndex,e.piece.start,o,a,r),ic(this,e,-1,-1),e.piece.length===0&&i.push(e);const l={line:t.piece.start.line+1,column:0},c=t.piece.length-1,d=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new Js(t.piece.bufferIndex,l,t.piece.end,d,c),ic(this,t,-1,-1),t.piece.length===0&&i.push(t);const h=this.createNewPieces(`\r
`);this.rbInsertRight(e,h[0]);for(let u=0;u<i.length;u++)Hy(this,i[u])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const i=t.next();if(this.startWithLF(i)){if(e+=`
`,i.piece.length===1)Hy(this,i);else{const n=i.piece,o={line:n.start.line+1,column:0},r=n.length-1,a=this.getLineFeedCnt(n.bufferIndex,o,n.end);i.piece=new Js(n.bufferIndex,o,n.end,a,r),ic(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===Ve)return t(Ve);const i=this.iterate(e.left,t);return i&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===Ve)return"";const t=this._buffers[e.piece.bufferIndex],i=e.piece,n=this.offsetInBuffer(i.bufferIndex,i.start),o=this.offsetInBuffer(i.bufferIndex,i.end);return t.buffer.substring(n,o)}getPieceContent(e){const t=this._buffers[e.bufferIndex],i=this.offsetInBuffer(e.bufferIndex,e.start),n=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(i,n)}rbInsertRight(e,t){const i=new IN(t,1);if(i.left=Ve,i.right=Ve,i.parent=Ve,i.size_left=0,i.lf_left=0,this.root===Ve)this.root=i,i.color=0;else if(e.right===Ve)e.right=i,i.parent=e;else{const o=cO(e.right);o.left=i,i.parent=o}return lW(this,i),i}rbInsertLeft(e,t){const i=new IN(t,1);if(i.left=Ve,i.right=Ve,i.parent=Ve,i.size_left=0,i.lf_left=0,this.root===Ve)this.root=i,i.color=0;else if(e.left===Ve)e.left=i,i.parent=e;else{const n=PU(e.left);n.right=i,i.parent=n}return lW(this,i),i}}class np extends B{constructor(e,t,i,n,o,r,a){super(),this._onDidChangeContent=this._register(new O),this._BOM=t,this._mightContainNonBasicASCII=!r,this._mightContainRTL=n,this._mightContainUnusualLineTerminators=o,this._pieceTree=new kue(e,i,a)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){const i=e+t,n=this.getPositionAt(e),o=this.getPositionAt(i);return new k(n.lineNumber,n.column,o.lineNumber,o.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";const i=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,i)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;const i=this.getOffsetAt(e.startLineNumber,e.startColumn),n=this.getOffsetAt(e.endLineNumber,e.endColumn);let o=0;const r=this._getEndOfLine(t),a=this.getEOL();if(r.length!==a.length){const l=r.length-a.length,c=e.endLineNumber-e.startLineNumber;o=l*c}return n-i+o}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let i=0;const n=e.startLineNumber,o=e.endLineNumber;for(let r=n;r<=o;r++){const a=this.getLineContent(r),l=r===n?e.startColumn-1:0,c=r===o?e.endColumn-1:a.length;for(let d=l;d<c;d++)Qi(a.charCodeAt(d))?(i=i+1,d=d+1):i=i+1}return i+=this._getEndOfLine(t).length*(o-n),i}return this.getValueLengthInRange(e,t)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineFirstNonWhitespaceColumn(e){const t=rs(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=Na(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,i){let n=this._mightContainRTL,o=this._mightContainUnusualLineTerminators,r=this._mightContainNonBasicASCII,a=!0,l=[];for(let m=0;m<e.length;m++){const _=e[m];a&&_._isTracked&&(a=!1);const b=_.range;if(_.text){let x=!0;r||(x=!vC(_.text),r=x),!n&&x&&(n=Sp(_.text)),!o&&x&&(o=E6(_.text))}let v="",C=0,y=0,w=0;if(_.text){let x;[C,y,w,x]=rh(_.text);const L=this.getEOL();x===0||x===(L===`\r
`?2:1)?v=_.text:v=_.text.replace(/\r\n|\r|\n/g,L)}l[m]={sortIndex:m,identifier:_.identifier||null,range:b,rangeOffset:this.getOffsetAt(b.startLineNumber,b.startColumn),rangeLength:this.getValueLengthInRange(b),text:v,eolCount:C,firstLineLength:y,lastLineLength:w,forceMoveMarkers:!!_.forceMoveMarkers,isAutoWhitespaceEdit:_.isAutoWhitespaceEdit||!1}}l.sort(np._sortOpsAscending);let c=!1;for(let m=0,_=l.length-1;m<_;m++){const b=l[m].range.getEndPosition(),v=l[m+1].range.getStartPosition();if(v.isBeforeOrEqual(b)){if(v.isBefore(b))throw new Error("Overlapping ranges are not allowed!");c=!0}}a&&(l=this._reduceOperations(l));const d=i||t?np._getInverseEditRanges(l):[],h=[];if(t)for(let m=0;m<l.length;m++){const _=l[m],b=d[m];if(_.isAutoWhitespaceEdit&&_.range.isEmpty())for(let v=b.startLineNumber;v<=b.endLineNumber;v++){let C="";v===b.startLineNumber&&(C=this.getLineContent(_.range.startLineNumber),rs(C)!==-1)||h.push({lineNumber:v,oldContent:C})}}let u=null;if(i){let m=0;u=[];for(let _=0;_<l.length;_++){const b=l[_],v=d[_],C=this.getValueInRange(b.range),y=b.rangeOffset+m;m+=b.text.length-C.length,u[_]={sortIndex:b.sortIndex,identifier:b.identifier,range:v,text:C,textChange:new In(b.rangeOffset,C,y,b.text)}}c||u.sort((_,b)=>_.sortIndex-b.sortIndex)}this._mightContainRTL=n,this._mightContainUnusualLineTerminators=o,this._mightContainNonBasicASCII=r;const g=this._doApplyEdits(l);let f=null;if(t&&h.length>0){h.sort((m,_)=>_.lineNumber-m.lineNumber),f=[];for(let m=0,_=h.length;m<_;m++){const b=h[m].lineNumber;if(m>0&&h[m-1].lineNumber===b)continue;const v=h[m].oldContent,C=this.getLineContent(b);C.length===0||C===v||rs(C)!==-1||f.push(b)}}return this._onDidChangeContent.fire(),new One(u,g,f)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1;const i=e[0].range,n=e[e.length-1].range,o=new k(i.startLineNumber,i.startColumn,n.endLineNumber,n.endColumn);let r=i.startLineNumber,a=i.startColumn;const l=[];for(let g=0,f=e.length;g<f;g++){const m=e[g],_=m.range;t=t||m.forceMoveMarkers,l.push(this.getValueInRange(new k(r,a,_.startLineNumber,_.startColumn))),m.text.length>0&&l.push(m.text),r=_.endLineNumber,a=_.endColumn}const c=l.join(""),[d,h,u]=rh(c);return{sortIndex:0,identifier:e[0].identifier,range:o,rangeOffset:this.getOffsetAt(o.startLineNumber,o.startColumn),rangeLength:this.getValueLengthInRange(o,0),text:c,eolCount:d,firstLineLength:h,lastLineLength:u,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(np._sortOpsDescending);const t=[];for(let i=0;i<e.length;i++){const n=e[i],o=n.range.startLineNumber,r=n.range.startColumn,a=n.range.endLineNumber,l=n.range.endColumn;if(o===a&&r===l&&n.text.length===0)continue;n.text?(this._pieceTree.delete(n.rangeOffset,n.rangeLength),this._pieceTree.insert(n.rangeOffset,n.text,!0)):this._pieceTree.delete(n.rangeOffset,n.rangeLength);const c=new k(o,r,a,l);t.push({range:c,rangeLength:n.rangeLength,text:n.text,rangeOffset:n.rangeOffset,forceMoveMarkers:n.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,i,n){return this._pieceTree.findMatchesLineByLine(e,t,i,n)}static _getInverseEditRanges(e){const t=[];let i=0,n=0,o=null;for(let r=0,a=e.length;r<a;r++){const l=e[r];let c,d;o?o.range.endLineNumber===l.range.startLineNumber?(c=i,d=n+(l.range.startColumn-o.range.endColumn)):(c=i+(l.range.startLineNumber-o.range.endLineNumber),d=l.range.startColumn):(c=l.range.startLineNumber,d=l.range.startColumn);let h;if(l.text.length>0){const u=l.eolCount+1;u===1?h=new k(c,d,c,d+l.firstLineLength):h=new k(c,d,c+u-1,l.lastLineLength+1)}else h=new k(c,d,c,d);i=h.endLineNumber,n=h.endColumn,t.push(h),o=l}return t}static _sortOpsAscending(e,t){const i=k.compareRangesUsingEnds(e.range,t.range);return i===0?e.sortIndex-t.sortIndex:i}static _sortOpsDescending(e,t){const i=k.compareRangesUsingEnds(e.range,t.range);return i===0?t.sortIndex-e.sortIndex:-i}}class Due{constructor(e,t,i,n,o,r,a,l,c){this._chunks=e,this._bom=t,this._cr=i,this._lf=n,this._crlf=o,this._containsRTL=r,this._containsUnusualLineTerminators=a,this._isBasicASCII=l,this._normalizeEOL=c}_getEOL(e){const t=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:i>t/2?`\r
`:`
`}create(e){const t=this._getEOL(e),i=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let o=0,r=i.length;o<r;o++){const a=i[o].buffer.replace(/\r\n|\r|\n/g,t),l=nc(a);i[o]=new lu(a,l)}const n=new np(i,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:n,disposable:n}}}class FU{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&$P(e)&&(this.BOM=xee,e=e.substr(1));const t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=Sue(this._tmpLineStarts,e);this.chunks.push(new lu(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=Sp(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=E6(e)))}finish(e=!0){return this._finish(),new Due(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const t=nc(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}}class Iue{constructor(e){this._default=e,this._store=[]}get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}replace(e,t,i){if(e>=this._store.length)return;if(t===0){this.insert(e,i);return}else if(i===0){this.delete(e,t);return}const n=this._store.slice(0,e),o=this._store.slice(e+t),r=Tue(i,this._default);this._store=n.concat(r,o)}delete(e,t){t===0||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(t===0||e>=this._store.length)return;const i=[];for(let n=0;n<t;n++)i[n]=this._default;this._store=gL(this._store,e,i)}}function Tue(s,e){const t=[];for(let i=0;i<s;i++)t[i]=e;return t}class Eue{get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(e,t){this._startLineNumber=e,this._tokens=t}getLineTokens(e){return this._tokens[e-this._startLineNumber]}appendLineTokens(e){this._tokens.push(e)}}class TN{constructor(){this._tokens=[]}add(e,t){if(this._tokens.length>0){const i=this._tokens[this._tokens.length-1];if(i.endLineNumber+1===e){i.appendLineTokens(t);return}}this._tokens.push(new Eue(e,[t]))}finalize(){return this._tokens}}class Nue{constructor(e,t){this.tokenizationSupport=t,this.initialState=this.tokenizationSupport.getInitialState(),this.store=new EN(e)}getStartState(e){return this.store.getStartState(e,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}}class Rue extends Nue{constructor(e,t,i,n){super(e,t),this._textModel=i,this._languageIdCodec=n}updateTokensUntilLine(e,t){const i=this._textModel.getLanguageId();for(;;){const n=this.getFirstInvalidLine();if(!n||n.lineNumber>t)break;const o=this._textModel.getLineContent(n.lineNumber),r=t_(this._languageIdCodec,i,this.tokenizationSupport,o,!0,n.startState);e.add(n.lineNumber,r.tokens),this.store.setEndState(n.lineNumber,r.endState)}}getTokenTypeIfInsertingCharacter(e,t){const i=this.getStartState(e.lineNumber);if(!i)return 0;const n=this._textModel.getLanguageId(),o=this._textModel.getLineContent(e.lineNumber),r=o.substring(0,e.column-1)+t+o.substring(e.column-1),a=t_(this._languageIdCodec,n,this.tokenizationSupport,r,!0,i),l=new Pi(a.tokens,r,this._languageIdCodec);if(l.getCount()===0)return 0;const c=l.findTokenIndexAtOffset(e.column-1);return l.getStandardTokenType(c)}tokenizeLineWithEdit(e,t,i){const n=e.lineNumber,o=e.column,r=this.getStartState(n);if(!r)return null;const a=this._textModel.getLineContent(n),l=a.substring(0,o-1)+i+a.substring(o-1+t),c=this._textModel.getLanguageIdAtPosition(n,0),d=t_(this._languageIdCodec,c,this.tokenizationSupport,l,!0,r);return new Pi(d.tokens,l,this._languageIdCodec)}hasAccurateTokensForLine(e){const t=this.store.getFirstInvalidEndStateLineNumberOrMax();return e<t}isCheapToTokenize(e){const t=this.store.getFirstInvalidEndStateLineNumberOrMax();return e<t||e===t&&this._textModel.getLineLength(e)<2048}tokenizeHeuristically(e,t,i){if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(t<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(e,i),{heuristicTokens:!1};let n=this.guessStartState(t);const o=this._textModel.getLanguageId();for(let r=t;r<=i;r++){const a=this._textModel.getLineContent(r),l=t_(this._languageIdCodec,o,this.tokenizationSupport,a,!0,n);e.add(r,l.tokens),n=l.endState}return{heuristicTokens:!0}}guessStartState(e){let t=this._textModel.getLineFirstNonWhitespaceColumn(e);const i=[];let n=null;for(let a=e-1;t>1&&a>=1;a--){const l=this._textModel.getLineFirstNonWhitespaceColumn(a);if(l!==0&&l<t&&(i.push(this._textModel.getLineContent(a)),t=l,n=this.getStartState(a),n))break}n||(n=this.tokenizationSupport.getInitialState()),i.reverse();const o=this._textModel.getLanguageId();let r=n;for(const a of i)r=t_(this._languageIdCodec,o,this.tokenizationSupport,a,!1,r).endState;return r}}class EN{constructor(e){this.lineCount=e,this._tokenizationStateStore=new Mue,this._invalidEndStatesLineNumbers=new Aue,this._invalidEndStatesLineNumbers.addRange(new qe(1,e+1))}getEndState(e){return this._tokenizationStateStore.getEndState(e)}setEndState(e,t){if(!t)throw new mt("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(e);const i=this._tokenizationStateStore.setEndState(e,t);return i&&e<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new qe(e+1,e+2)),i}acceptChange(e,t){this.lineCount+=t-e.length,this._tokenizationStateStore.acceptChange(e,t),this._invalidEndStatesLineNumbers.addRangeAndResize(new qe(e.startLineNumber,e.endLineNumberExclusive),t)}acceptChanges(e){for(const t of e){const[i]=rh(t.text);this.acceptChange(new He(t.range.startLineNumber,t.range.endLineNumber+1),i+1)}}invalidateEndStateRange(e){this._invalidEndStatesLineNumbers.addRange(new qe(e.startLineNumber,e.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(e,t){return e===1?t:this.getEndState(e-1)}getFirstInvalidLine(e){const t=this.getFirstInvalidEndStateLineNumber();if(t===null)return null;const i=this.getStartState(t,e);if(!i)throw new mt("Start state must be defined");return{lineNumber:t,startState:i}}}class Mue{constructor(){this._lineEndStates=new Iue(null)}getEndState(e){return this._lineEndStates.get(e)}setEndState(e,t){const i=this._lineEndStates.get(e);return i&&i.equals(t)?!1:(this._lineEndStates.set(e,t),!0)}acceptChange(e,t){let i=e.length;t>0&&i>0&&(i--,t--),this._lineEndStates.replace(e.startLineNumber,i,t)}}class Aue{constructor(){this._ranges=[]}get min(){return this._ranges.length===0?null:this._ranges[0].start}delete(e){const t=this._ranges.findIndex(i=>i.contains(e));if(t!==-1){const i=this._ranges[t];i.start===e?i.endExclusive===e+1?this._ranges.splice(t,1):this._ranges[t]=new qe(e+1,i.endExclusive):i.endExclusive===e+1?this._ranges[t]=new qe(i.start,e):this._ranges.splice(t,1,new qe(i.start,e),new qe(e+1,i.endExclusive))}}addRange(e){qe.addRange(e,this._ranges)}addRangeAndResize(e,t){let i=0;for(;!(i>=this._ranges.length||e.start<=this._ranges[i].endExclusive);)i++;let n=i;for(;!(n>=this._ranges.length||e.endExclusive<this._ranges[n].start);)n++;const o=t-e.length;for(let r=n;r<this._ranges.length;r++)this._ranges[r]=this._ranges[r].delta(o);if(i===n){const r=new qe(e.start,e.start+t);r.isEmpty||this._ranges.splice(i,0,r)}else{const r=Math.min(e.start,this._ranges[i].start),a=Math.max(e.endExclusive,this._ranges[n-1].endExclusive),l=new qe(r,a+o);l.isEmpty?this._ranges.splice(i,n-i):this._ranges.splice(i,n-i,l)}}toString(){return this._ranges.map(e=>e.toString()).join(" + ")}}function t_(s,e,t,i,n,o){let r=null;if(t)try{r=t.tokenizeEncoded(i,n,o.clone())}catch(a){Oe(a)}return r||(r=ix(s.encodeLanguageId(e),o)),Pi.convertToEndOffset(r.tokens,i.length),r}class Pue{constructor(e,t){this._tokenizerWithStateStore=e,this._backgroundTokenStore=t,this._isDisposed=!1,this._isScheduled=!1}dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,F6(e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)}))}_backgroundTokenizeWithDeadline(e){const t=Date.now()+e.timeRemaining(),i=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?i6(i):this._beginBackgroundTokenization())};i()}_backgroundTokenizeForAtLeast1ms(){const e=this._tokenizerWithStateStore._textModel.getLineCount(),t=new TN,i=un.create(!1);do if(i.elapsed()>1||this._tokenizeOneInvalidLine(t)>=e)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(t.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(e){const t=this._tokenizerWithStateStore?.getFirstInvalidLine();return t?(this._tokenizerWithStateStore.updateTokensUntilLine(e,t.lineNumber),t.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(e,t){this._tokenizerWithStateStore.store.invalidateEndStateRange(new He(e,t))}}class Oue{constructor(){this._onDidChangeVisibleRanges=new O,this.onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event,this._views=new Set}attachView(){const e=new Fue(t=>{this._onDidChangeVisibleRanges.fire({view:e,state:t})});return this._views.add(e),e}detachView(e){this._views.delete(e),this._onDidChangeVisibleRanges.fire({view:e,state:void 0})}}class Fue{constructor(e){this.handleStateChange=e}setVisibleLines(e,t){const i=e.map(n=>new He(n.startLineNumber,n.endLineNumber+1));this.handleStateChange({visibleLineRanges:i,stabilized:t})}}class Bue extends B{get lineRanges(){return this._lineRanges}constructor(e){super(),this._refreshTokens=e,this.runner=this._register(new It(()=>this.update(),50)),this._computedLineRanges=[],this._lineRanges=[]}update(){ii(this._computedLineRanges,this._lineRanges,(e,t)=>e.equals(t))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(e){this._lineRanges=e.visibleLineRanges,e.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}}class BU extends B{get backgroundTokenizationState(){return this._backgroundTokenizationState}constructor(e,t,i){super(),this._languageIdCodec=e,this._textModel=t,this.getLanguageId=i,this._backgroundTokenizationState=1,this._onDidChangeBackgroundTokenizationState=this._register(new O),this.onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event,this._onDidChangeTokens=this._register(new O),this.onDidChangeTokens=this._onDidChangeTokens.event}tokenizeIfCheap(e){this.isCheapToTokenize(e)&&this.forceTokenization(e)}}class cW extends BU{constructor(e,t,i,n){super(t,i,n),this._treeSitterService=e,this._tokenizationSupport=null,this._initialize()}_initialize(){const e=this.getLanguageId();(!this._tokenizationSupport||this._lastLanguageId!==e)&&(this._lastLanguageId=e,this._tokenizationSupport=rT.get(e))}getLineTokens(e){const t=this._textModel.getLineContent(e);if(this._tokenizationSupport){const i=this._tokenizationSupport.tokenizeEncoded(e,this._textModel);if(i)return new Pi(i,t,this._languageIdCodec)}return Pi.createEmpty(t,this._languageIdCodec)}resetTokenization(e=!0){e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]}),this._initialize()}handleDidChangeAttached(){}handleDidChangeContent(e){e.isFlush&&this.resetTokenization(!1)}forceTokenization(e){}hasAccurateTokensForLine(e){return!0}isCheapToTokenize(e){return!0}getTokenTypeIfInsertingCharacter(e,t,i){return 0}tokenizeLineWithEdit(e,t,i){return null}get hasTokens(){return this._treeSitterService.getParseResult(this._textModel)!==void 0}}const WU=Je("treeSitterParserService"),sc=new Uint32Array(0).buffer;class dl{static deleteBeginning(e,t){return e===null||e===sc?e:dl.delete(e,0,t)}static deleteEnding(e,t){if(e===null||e===sc)return e;const i=mc(e),n=i[i.length-2];return dl.delete(e,t,n)}static delete(e,t,i){if(e===null||e===sc||t===i)return e;const n=mc(e),o=n.length>>>1;if(t===0&&n[n.length-2]===i)return sc;const r=Pi.findIndexInTokensArray(n,t),a=r>0?n[r-1<<1]:0,l=n[r<<1];if(i<l){const g=i-t;for(let f=r;f<o;f++)n[f<<1]-=g;return e}let c,d;a!==t?(n[r<<1]=t,c=r+1<<1,d=t):(c=r<<1,d=a);const h=i-t;for(let g=r+1;g<o;g++){const f=n[g<<1]-h;f>d&&(n[c++]=f,n[c++]=n[(g<<1)+1],d=f)}if(c===n.length)return e;const u=new Uint32Array(c);return u.set(n.subarray(0,c),0),u.buffer}static append(e,t){if(t===sc)return e;if(e===sc)return t;if(e===null)return e;if(t===null)return null;const i=mc(e),n=mc(t),o=n.length>>>1,r=new Uint32Array(i.length+n.length);r.set(i,0);let a=i.length;const l=i[i.length-2];for(let c=0;c<o;c++)r[a++]=n[c<<1]+l,r[a++]=n[(c<<1)+1];return r.buffer}static insert(e,t,i){if(e===null||e===sc)return e;const n=mc(e),o=n.length>>>1;let r=Pi.findIndexInTokensArray(n,t);r>0&&n[r-1<<1]===t&&r--;for(let a=r;a<o;a++)n[a<<1]+=i;return e}}function mc(s){return s instanceof Uint32Array?s:new Uint32Array(s)}class Cv{constructor(e){this._lineTokens=[],this._len=0,this._languageIdCodec=e}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(e,t,i){let n=null;if(t<this._len&&(n=this._lineTokens[t]),n!==null&&n!==sc)return new Pi(mc(n),i,this._languageIdCodec);const o=new Uint32Array(2);return o[0]=i.length,o[1]=dW(this._languageIdCodec.encodeLanguageId(e)),new Pi(o,i,this._languageIdCodec)}static _massageTokens(e,t,i){const n=i?mc(i):null;if(t===0){let o=!1;if(n&&n.length>1&&(o=Bs.getLanguageId(n[1])!==e),!o)return sc}if(!n||n.length===0){const o=new Uint32Array(2);return o[0]=t,o[1]=dW(e),o.buffer}return n[n.length-2]=t,n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){t!==0&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(t===0)return;const i=[];for(let n=0;n<t;n++)i[n]=null;this._lineTokens=gL(this._lineTokens,e,i),this._len+=t}setTokens(e,t,i,n,o){const r=Cv._massageTokens(this._languageIdCodec.encodeLanguageId(e),i,n);this._ensureLine(t);const a=this._lineTokens[t];return this._lineTokens[t]=r,o?!Cv._equals(a,r):!1}static _equals(e,t){if(!e||!t)return!e&&!t;const i=mc(e),n=mc(t);if(i.length!==n.length)return!1;for(let o=0,r=i.length;o<r;o++)if(i[o]!==n[o])return!1;return!0}acceptEdit(e,t,i){this._acceptDeleteRange(e),this._acceptInsertText(new P(e.startLineNumber,e.startColumn),t,i)}_acceptDeleteRange(e){const t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._lineTokens[t]=dl.delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1);return}this._lineTokens[t]=dl.deleteEnding(this._lineTokens[t],e.startColumn-1);const i=e.endLineNumber-1;let n=null;i<this._len&&(n=dl.deleteBeginning(this._lineTokens[i],e.endColumn-1)),this._lineTokens[t]=dl.append(this._lineTokens[t],n),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,i){if(t===0&&i===0)return;const n=e.lineNumber-1;if(!(n>=this._len)){if(t===0){this._lineTokens[n]=dl.insert(this._lineTokens[n],e.column-1,i);return}this._lineTokens[n]=dl.deleteEnding(this._lineTokens[n],e.column-1),this._lineTokens[n]=dl.insert(this._lineTokens[n],e.column-1,i),this._insertLines(e.lineNumber,t)}}setMultilineTokens(e,t){if(e.length===0)return{changes:[]};const i=[];for(let n=0,o=e.length;n<o;n++){const r=e[n];let a=0,l=0,c=!1;for(let d=r.startLineNumber;d<=r.endLineNumber;d++)c?(this.setTokens(t.getLanguageId(),d-1,t.getLineLength(d),r.getLineTokens(d),!1),l=d):this.setTokens(t.getLanguageId(),d-1,t.getLineLength(d),r.getLineTokens(d),!0)&&(c=!0,a=d,l=d);c&&i.push({fromLineNumber:a,toLineNumber:l})}return{changes:i}}}function dW(s){return(s<<0|0|0|32768|2<<24|1024)>>>0}class uO{constructor(e){this._pieces=[],this._isComplete=!1,this._languageIdCodec=e}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(e,t){this._pieces=e||[],this._isComplete=t}setPartial(e,t){let i=e;if(t.length>0){const o=t[0].getRange(),r=t[t.length-1].getRange();if(!o||!r)return e;i=e.plusRange(o).plusRange(r)}let n=null;for(let o=0,r=this._pieces.length;o<r;o++){const a=this._pieces[o];if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){n=n||{index:o};break}if(a.removeTokens(i),a.isEmpty()){this._pieces.splice(o,1),o--,r--;continue}if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){n=n||{index:o};continue}const[l,c]=a.split(i);if(l.isEmpty()){n=n||{index:o};continue}c.isEmpty()||(this._pieces.splice(o,1,l,c),o++,r++,n=n||{index:o})}return n=n||{index:this._pieces.length},t.length>0&&(this._pieces=gL(this._pieces,n.index,t)),i}isComplete(){return this._isComplete}addSparseTokens(e,t){if(t.getLineContent().length===0)return t;const i=this._pieces;if(i.length===0)return t;const n=uO._findFirstPieceWithLine(i,e),o=i[n].getLineTokens(e);if(!o)return t;const r=t.getCount(),a=o.getCount();let l=0;const c=[];let d=0,h=0;const u=(g,f)=>{g!==h&&(h=g,c[d++]=g,c[d++]=f)};for(let g=0;g<a;g++){const f=o.getStartCharacter(g),m=o.getEndCharacter(g),_=o.getMetadata(g),b=((_&1?2048:0)|(_&2?4096:0)|(_&4?8192:0)|(_&8?16384:0)|(_&16?16744448:0)|(_&32?4278190080:0))>>>0,v=~b>>>0;for(;l<r&&t.getEndOffset(l)<=f;)u(t.getEndOffset(l),t.getMetadata(l)),l++;for(l<r&&t.getStartOffset(l)<f&&u(f,t.getMetadata(l));l<r&&t.getEndOffset(l)<m;)u(t.getEndOffset(l),t.getMetadata(l)&v|_&b),l++;if(l<r)u(m,t.getMetadata(l)&v|_&b),t.getEndOffset(l)===m&&l++;else{const C=Math.min(Math.max(0,l-1),r-1);u(m,t.getMetadata(C)&v|_&b)}}for(;l<r;)u(t.getEndOffset(l),t.getMetadata(l)),l++;return new Pi(new Uint32Array(c),t.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(e,t){let i=0,n=e.length-1;for(;i<n;){let o=i+Math.floor((n-i)/2);if(e[o].endLineNumber<t)i=o+1;else if(e[o].startLineNumber>t)n=o-1;else{for(;o>i&&e[o-1].startLineNumber<=t&&t<=e[o-1].endLineNumber;)o--;return o}}return i}acceptEdit(e,t,i,n,o){for(const r of this._pieces)r.acceptEdit(e,t,i,n,o)}}var Wue=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},RD=function(s,e){return function(t,i){e(t,i,s)}},Zw;let NN=Zw=class extends TU{constructor(e,t,i,n,o,r,a){super(),this._textModel=e,this._bracketPairsTextModelPart=t,this._languageId=i,this._attachedViews=n,this._languageService=o,this._languageConfigurationService=r,this._treeSitterService=a,this._semanticTokens=new uO(this._languageService.languageIdCodec),this._onDidChangeLanguage=this._register(new O),this.onDidChangeLanguage=this._onDidChangeLanguage.event,this._onDidChangeLanguageConfiguration=this._register(new O),this.onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event,this._onDidChangeTokens=this._register(new O),this.onDidChangeTokens=this._onDidChangeTokens.event,this._tokensDisposables=this._register(new Z),this._register(this._languageConfigurationService.onDidChange(l=>{l.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._register(se.filter(rT.onDidChange,l=>l.changedLanguages.includes(this._languageId))(()=>{this.createPreferredTokenProvider()})),this.createPreferredTokenProvider()}createGrammarTokens(){return this._register(new hW(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews))}createTreeSitterTokens(){return this._register(new cW(this._treeSitterService,this._languageService.languageIdCodec,this._textModel,()=>this._languageId))}createTokens(e){const t=this._tokens!==void 0;this._tokens?.dispose(),this._tokens=e?this.createTreeSitterTokens():this.createGrammarTokens(),this._tokensDisposables.clear(),this._tokensDisposables.add(this._tokens.onDidChangeTokens(i=>{this._emitModelTokensChangedEvent(i)})),this._tokensDisposables.add(this._tokens.onDidChangeBackgroundTokenizationState(i=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()})),t&&this._tokens.resetTokenization()}createPreferredTokenProvider(){rT.get(this._languageId)?this._tokens instanceof cW||this.createTokens(!0):this._tokens instanceof hW||this.createTokens(!1)}handleLanguageConfigurationServiceChange(e){e.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}handleDidChangeContent(e){if(e.isFlush)this._semanticTokens.flush();else if(!e.isEolChange)for(const t of e.changes){const[i,n,o]=rh(t.text);this._semanticTokens.acceptEdit(t.range,i,n,o,t.text.length>0?t.text.charCodeAt(0):0)}this._tokens.handleDidChangeContent(e)}handleDidChangeAttached(){this._tokens.handleDidChangeAttached()}getLineTokens(e){this.validateLineNumber(e);const t=this._tokens.getLineTokens(e);return this._semanticTokens.addSparseTokens(e,t)}_emitModelTokensChangedEvent(e){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(e),this._onDidChangeTokens.fire(e))}validateLineNumber(e){if(e<1||e>this._textModel.getLineCount())throw new mt("Illegal value for lineNumber")}get hasTokens(){return this._tokens.hasTokens}resetTokenization(){this._tokens.resetTokenization()}get backgroundTokenizationState(){return this._tokens.backgroundTokenizationState}forceTokenization(e){this.validateLineNumber(e),this._tokens.forceTokenization(e)}hasAccurateTokensForLine(e){return this.validateLineNumber(e),this._tokens.hasAccurateTokensForLine(e)}isCheapToTokenize(e){return this.validateLineNumber(e),this._tokens.isCheapToTokenize(e)}tokenizeIfCheap(e){this.validateLineNumber(e),this._tokens.tokenizeIfCheap(e)}getTokenTypeIfInsertingCharacter(e,t,i){return this._tokens.getTokenTypeIfInsertingCharacter(e,t,i)}tokenizeLineWithEdit(e,t,i){return this._tokens.tokenizeLineWithEdit(e,t,i)}setSemanticTokens(e,t){this._semanticTokens.set(e,t),this._emitModelTokensChangedEvent({semanticTokensApplied:e!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(e,t){if(this.hasCompleteSemanticTokens())return;const i=this._textModel.validateRange(this._semanticTokens.setPartial(e,t));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]})}getWordAtPosition(e){this.assertNotDisposed();const t=this._textModel.validatePosition(e),i=this._textModel.getLineContent(t.lineNumber),n=this.getLineTokens(t.lineNumber),o=n.findTokenIndexAtOffset(t.column-1),[r,a]=Zw._findLanguageBoundaries(n,o),l=Vb(t.column,this.getLanguageConfiguration(n.getLanguageId(o)).getWordDefinition(),i.substring(r,a),r);if(l&&l.startColumn<=e.column&&e.column<=l.endColumn)return l;if(o>0&&r===t.column-1){const[c,d]=Zw._findLanguageBoundaries(n,o-1),h=Vb(t.column,this.getLanguageConfiguration(n.getLanguageId(o-1)).getWordDefinition(),i.substring(c,d),c);if(h&&h.startColumn<=e.column&&e.column<=h.endColumn)return h}return null}getLanguageConfiguration(e){return this._languageConfigurationService.getLanguageConfiguration(e)}static _findLanguageBoundaries(e,t){const i=e.getLanguageId(t);let n=0;for(let r=t;r>=0&&e.getLanguageId(r)===i;r--)n=e.getStartOffset(r);let o=e.getLineContent().length;for(let r=t,a=e.getCount();r<a&&e.getLanguageId(r)===i;r++)o=e.getEndOffset(r);return[n,o]}getWordUntilPosition(e){const t=this.getWordAtPosition(e);return t?{word:t.word.substr(0,e.column-t.startColumn),startColumn:t.startColumn,endColumn:e.column}:{word:"",startColumn:e.column,endColumn:e.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(e,t){const i=this._textModel.validatePosition(new P(e,t)),n=this.getLineTokens(i.lineNumber);return n.getLanguageId(n.findTokenIndexAtOffset(i.column-1))}setLanguageId(e,t="api"){if(this._languageId===e)return;const i={oldLanguage:this._languageId,newLanguage:e,source:t};this._languageId=e,this._bracketPairsTextModelPart.handleDidChangeLanguage(i),this._tokens.resetTokenization(),this.createPreferredTokenProvider(),this._onDidChangeLanguage.fire(i),this._onDidChangeLanguageConfiguration.fire({})}};NN=Zw=Wue([RD(4,ni),RD(5,di),RD(6,WU)],NN);class hW extends BU{constructor(e,t,i,n){super(e,t,i),this._tokenizer=null,this._defaultBackgroundTokenizer=null,this._backgroundTokenizer=this._register(new nn),this._tokens=new Cv(this._languageIdCodec),this._debugBackgroundTokenizer=this._register(new nn),this._attachedViewStates=this._register(new RP),this._register(mi.onDidChange(o=>{const r=this.getLanguageId();o.changedLanguages.indexOf(r)!==-1&&this.resetTokenization()})),this.resetTokenization(),this._register(n.onDidChangeVisibleRanges(({view:o,state:r})=>{if(r){let a=this._attachedViewStates.get(o);a||(a=new Bue(()=>this.refreshRanges(a.lineRanges)),this._attachedViewStates.set(o,a)),a.handleStateChange(r)}else this._attachedViewStates.deleteAndDispose(o)}))}resetTokenization(e=!0){this._tokens.flush(),this._debugBackgroundTokens?.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new EN(this._textModel.getLineCount())),e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});const t=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];const o=mi.get(this.getLanguageId());if(!o)return[null,null];let r;try{r=o.getInitialState()}catch(a){return Oe(a),[null,null]}return[o,r]},[i,n]=t();if(i&&n?this._tokenizer=new Rue(this._textModel.getLineCount(),i,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){const o={setTokens:r=>{this.setTokens(r)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;const r=2;this._backgroundTokenizationState=r,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(r,a)=>{if(!this._tokenizer)return;const l=this._tokenizer.store.getFirstInvalidEndStateLineNumber();l!==null&&r>=l&&this._tokenizer?.store.setEndState(r,a)}};i&&i.createBackgroundTokenizer&&!i.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=i.createBackgroundTokenizer(this._textModel,o)),!this._backgroundTokenizer.value&&!this._textModel.isTooLargeForTokenization()&&(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new Pue(this._tokenizer,o),this._defaultBackgroundTokenizer.handleChanges()),i?.backgroundTokenizerShouldOnlyVerifyTokens&&i.createBackgroundTokenizer?(this._debugBackgroundTokens=new Cv(this._languageIdCodec),this._debugBackgroundStates=new EN(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=i.createBackgroundTokenizer(this._textModel,{setTokens:r=>{this._debugBackgroundTokens?.setMultilineTokens(r,this._textModel)},backgroundTokenizationFinished(){},setEndState:(r,a)=>{this._debugBackgroundStates?.setEndState(r,a)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){this._defaultBackgroundTokenizer?.handleChanges()}handleDidChangeContent(e){if(e.isFlush)this.resetTokenization(!1);else if(!e.isEolChange){for(const t of e.changes){const[i,n]=rh(t.text);this._tokens.acceptEdit(t.range,i,n),this._debugBackgroundTokens?.acceptEdit(t.range,i,n)}this._debugBackgroundStates?.acceptChanges(e.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(e.changes),this._defaultBackgroundTokenizer?.handleChanges()}}setTokens(e){const{changes:t}=this._tokens.setMultilineTokens(e,this._textModel);return t.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:t}),{changes:t}}refreshAllVisibleLineTokens(){const e=He.joinMany([...this._attachedViewStates].map(([t,i])=>i.lineRanges));this.refreshRanges(e)}refreshRanges(e){for(const t of e)this.refreshRange(t.startLineNumber,t.endLineNumberExclusive-1)}refreshRange(e,t){if(!this._tokenizer)return;e=Math.max(1,Math.min(this._textModel.getLineCount(),e)),t=Math.min(this._textModel.getLineCount(),t);const i=new TN,{heuristicTokens:n}=this._tokenizer.tokenizeHeuristically(i,e,t),o=this.setTokens(i.finalize());if(n)for(const r of o.changes)this._backgroundTokenizer.value?.requestTokens(r.fromLineNumber,r.toLineNumber+1);this._defaultBackgroundTokenizer?.checkFinished()}forceTokenization(e){const t=new TN;this._tokenizer?.updateTokensUntilLine(t,e),this.setTokens(t.finalize()),this._defaultBackgroundTokenizer?.checkFinished()}hasAccurateTokensForLine(e){return this._tokenizer?this._tokenizer.hasAccurateTokensForLine(e):!0}isCheapToTokenize(e){return this._tokenizer?this._tokenizer.isCheapToTokenize(e):!0}getLineTokens(e){const t=this._textModel.getLineContent(e),i=this._tokens.getTokens(this._textModel.getLanguageId(),e-1,t);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>e&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>e){const n=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),e-1,t);!i.equals(n)&&this._debugBackgroundTokenizer.value?.reportMismatchingTokens&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(e)}return i}getTokenTypeIfInsertingCharacter(e,t,i){if(!this._tokenizer)return 0;const n=this._textModel.validatePosition(new P(e,t));return this.forceTokenization(n.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(n,i)}tokenizeLineWithEdit(e,t,i){if(!this._tokenizer)return null;const n=this._textModel.validatePosition(e);return this.forceTokenization(n.lineNumber),this._tokenizer.tokenizeLineWithEdit(n,t,i)}get hasTokens(){return this._tokens.hasTokens}}class Hue{constructor(){this.changeType=1}}class Ha{static applyInjectedText(e,t){if(!t||t.length===0)return e;let i="",n=0;for(const o of t)i+=e.substring(n,o.column-1),n=o.column-1,i+=o.options.content;return i+=e.substring(n),i}static fromDecorations(e){const t=[];for(const i of e)i.options.before&&i.options.before.content.length>0&&t.push(new Ha(i.ownerId,i.range.startLineNumber,i.range.startColumn,i.options.before,0)),i.options.after&&i.options.after.content.length>0&&t.push(new Ha(i.ownerId,i.range.endLineNumber,i.range.endColumn,i.options.after,1));return t.sort((i,n)=>i.lineNumber===n.lineNumber?i.column===n.column?i.order-n.order:i.column-n.column:i.lineNumber-n.lineNumber),t}constructor(e,t,i,n,o){this.ownerId=e,this.lineNumber=t,this.column=i,this.options=n,this.order=o}}class uW{constructor(e,t,i){this.changeType=2,this.lineNumber=e,this.detail=t,this.injectedText=i}}class Vue{constructor(e,t){this.changeType=3,this.fromLineNumber=e,this.toLineNumber=t}}class zue{constructor(e,t,i,n){this.changeType=4,this.injectedTexts=n,this.fromLineNumber=e,this.toLineNumber=t,this.detail=i}}class Uue{constructor(){this.changeType=5}}class sp{constructor(e,t,i,n){this.changes=e,this.versionId=t,this.isUndoing=i,this.isRedoing=n,this.resultingSelection=null}containsEvent(e){for(let t=0,i=this.changes.length;t<i;t++)if(this.changes[t].changeType===e)return!0;return!1}static merge(e,t){const i=[].concat(e.changes).concat(t.changes),n=t.versionId,o=e.isUndoing||t.isUndoing,r=e.isRedoing||t.isRedoing;return new sp(i,n,o,r)}}class HU{constructor(e){this.changes=e}}class Nu{constructor(e,t){this.rawContentChangedEvent=e,this.contentChangedEvent=t}merge(e){const t=sp.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),i=Nu._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new Nu(t,i)}static _mergeChangeEvents(e,t){const i=[].concat(e.changes).concat(t.changes),n=t.eol,o=t.versionId,r=e.isUndoing||t.isUndoing,a=e.isRedoing||t.isRedoing,l=e.isFlush||t.isFlush,c=e.isEolChange&&t.isEolChange;return{changes:i,eol:n,isEolChange:c,versionId:o,isUndoing:r,isRedoing:a,isFlush:l}}}var $ue=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Vy=function(s,e){return function(t,i){e(t,i,s)}},qh;function jue(s){const e=new FU;return e.acceptChunk(s),e.finish()}function Zue(s){const e=new FU;let t;for(;typeof(t=s.read())=="string";)e.acceptChunk(t);return e.finish()}function gW(s,e){let t;return typeof s=="string"?t=jue(s):Ane(s)?t=Zue(s):t=s,t.create(e)}let zy=0;const Kue=999,que=1e4;class Gue{constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;const e=[];let t=0,i=0;do{const n=this._source.read();if(n===null)return this._eos=!0,t===0?null:e.join("");if(n.length>0&&(e[t++]=n,i+=n.length),i>=64*1024)return e.join("")}while(!0)}}const i_=()=>{throw new Error("Invalid change accessor")};let Da=class extends B{static{qh=this}static{this._MODEL_SYNC_LIMIT=50*1024*1024}static{this.LARGE_FILE_SIZE_THRESHOLD=20*1024*1024}static{this.LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3}static{this.LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024}static{this.DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:Vn.tabSize,indentSize:Vn.indentSize,insertSpaces:Vn.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:Vn.trimAutoWhitespace,largeFileOptimizations:Vn.largeFileOptimizations,bracketPairColorizationOptions:Vn.bracketPairColorizationOptions}}static resolveOptions(e,t){if(t.detectIndentation){const i=tW(e,t.tabSize,t.insertSpaces);return new Ow({tabSize:i.tabSize,indentSize:"tabSize",insertSpaces:i.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL,bracketPairColorizationOptions:t.bracketPairColorizationOptions})}return new Ow(t)}get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}onDidChangeContent(e){return this._eventEmitter.slowEvent(t=>e(t.contentChangedEvent))}onDidChangeContentOrInjectedText(e){return Gr(this._eventEmitter.fastEvent(t=>e(t)),this._onDidChangeInjectedText.event(t=>e(t)))}_isDisposing(){return this.__isDisposing}get tokenization(){return this._tokenizationTextModelPart}get bracketPairs(){return this._bracketPairs}get guides(){return this._guidesTextModelPart}constructor(e,t,i,n=null,o,r,a,l){super(),this._undoRedoService=o,this._languageService=r,this._languageConfigurationService=a,this.instantiationService=l,this._onWillDispose=this._register(new O),this.onWillDispose=this._onWillDispose.event,this._onDidChangeDecorations=this._register(new tge(f=>this.handleBeforeFireDecorationsChangedEvent(f))),this.onDidChangeDecorations=this._onDidChangeDecorations.event,this._onDidChangeOptions=this._register(new O),this.onDidChangeOptions=this._onDidChangeOptions.event,this._onDidChangeAttached=this._register(new O),this.onDidChangeAttached=this._onDidChangeAttached.event,this._onDidChangeInjectedText=this._register(new O),this._eventEmitter=this._register(new ige),this._languageSelectionListener=this._register(new nn),this._deltaDecorationCallCnt=0,this._attachedViews=new Oue,zy++,this.id="$model"+zy,this.isForSimpleWidget=i.isForSimpleWidget,typeof n>"u"||n===null?this._associatedResource=Se.parse("inmemory://model/"+zy):this._associatedResource=n,this._attachedEditorCount=0;const{textBuffer:c,disposable:d}=gW(e,i.defaultEOL);this._buffer=c,this._bufferDisposable=d,this._options=qh.resolveOptions(this._buffer,i);const h=typeof t=="string"?t:t.languageId;typeof t!="string"&&(this._languageSelectionListener.value=t.onDidChange(()=>this._setLanguage(t.languageId))),this._bracketPairs=this._register(new tue(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new rue(this,this._languageConfigurationService)),this._decorationProvider=this._register(new nue(this)),this._tokenizationTextModelPart=this.instantiationService.createInstance(NN,this,this._bracketPairs,h,this._attachedViews);const u=this._buffer.getLineCount(),g=this._buffer.getValueLengthInRange(new k(1,1,u,this._buffer.getLineLength(u)+1),0);i.largeFileOptimizations?(this._isTooLargeForTokenization=g>qh.LARGE_FILE_SIZE_THRESHOLD||u>qh.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=g>qh.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._isTooLargeForSyncing=g>qh._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=N6(zy),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new fW,this._commandManager=new lO(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(h),this._register(this._languageConfigurationService.onDidChange(f=>{this._bracketPairs.handleLanguageConfigurationServiceChange(f),this._tokenizationTextModelPart.handleLanguageConfigurationServiceChange(f)}))}dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;const e=new np([],"",`
`,!1,!1,!0,!0);e.dispose(),this._buffer=e,this._bufferDisposable=B.None}_assertNotDisposed(){if(this._isDisposed)throw new mt("Model is disposed!")}_emitContentChangedEvent(e,t){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(t),this._bracketPairs.handleDidChangeContent(t),this._eventEmitter.fire(new Nu(e,t)))}setValue(e){if(this._assertNotDisposed(),e==null)throw mr();const{textBuffer:t,disposable:i}=gW(e,this._options.defaultEOL);this._setValueFromTextBuffer(t,i)}_createContentChanged2(e,t,i,n,o,r,a,l){return{changes:[{range:e,rangeOffset:t,rangeLength:i,text:n}],eol:this._buffer.getEOL(),isEolChange:l,versionId:this.getVersionId(),isUndoing:o,isRedoing:r,isFlush:a}}_setValueFromTextBuffer(e,t){this._assertNotDisposed();const i=this.getFullModelRange(),n=this.getValueLengthInRange(i),o=this.getLineCount(),r=this.getLineMaxColumn(o);this._buffer=e,this._bufferDisposable.dispose(),this._bufferDisposable=t,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new fW,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new sp([new Hue],this._versionId,!1,!1),this._createContentChanged2(new k(1,1,o,r),0,n,this.getValue(),!1,!1,!0,!1))}setEOL(e){this._assertNotDisposed();const t=e===1?`\r
`:`
`;if(this._buffer.getEOL()===t)return;const i=this.getFullModelRange(),n=this.getValueLengthInRange(i),o=this.getLineCount(),r=this.getLineMaxColumn(o);this._onBeforeEOLChange(),this._buffer.setEOL(t),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new sp([new Uue],this._versionId,!1,!1),this._createContentChanged2(new k(1,1,o,r),0,n,this.getValue(),!1,!1,!1,!0))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){const e=this.getVersionId(),t=this._decorationsTree.collectNodesPostOrder();for(let i=0,n=t.length;i<n;i++){const o=t[i],r=o.range,a=o.cachedAbsoluteStart-o.start,l=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),c=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);o.cachedAbsoluteStart=l,o.cachedAbsoluteEnd=c,o.cachedVersionId=e,o.start=l-a,o.end=c-a,ch(o)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(e){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(e)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let e=0,t=0;const i=this._buffer.getLineCount();for(let n=1;n<=i;n++){const o=this._buffer.getLineLength(n);o>=que?t+=o:e+=o}return t>e}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(e){this._assertNotDisposed();const t=typeof e.tabSize<"u"?e.tabSize:this._options.tabSize,i=typeof e.indentSize<"u"?e.indentSize:this._options.originalIndentSize,n=typeof e.insertSpaces<"u"?e.insertSpaces:this._options.insertSpaces,o=typeof e.trimAutoWhitespace<"u"?e.trimAutoWhitespace:this._options.trimAutoWhitespace,r=typeof e.bracketColorizationOptions<"u"?e.bracketColorizationOptions:this._options.bracketPairColorizationOptions,a=new Ow({tabSize:t,indentSize:i,insertSpaces:n,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:o,bracketPairColorizationOptions:r});if(this._options.equals(a))return;const l=this._options.createChangeEvent(a);this._options=a,this._bracketPairs.handleDidChangeOptions(l),this._decorationProvider.handleDidChangeOptions(l),this._onDidChangeOptions.fire(l)}detectIndentation(e,t){this._assertNotDisposed();const i=tW(this._buffer,t,e);this.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize,indentSize:i.tabSize})}normalizeIndentation(e){return this._assertNotDisposed(),nO(e,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(e=null){const t=this.findMatches(T6.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(e,t.map(i=>({range:i.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(e){this._assertNotDisposed();const t=this._validatePosition(e.lineNumber,e.column,0);return this._buffer.getOffsetAt(t.lineNumber,t.column)}getPositionAt(e){this._assertNotDisposed();const t=Math.min(this._buffer.getLength(),Math.max(0,e));return this._buffer.getPositionAt(t)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(e){this._versionId=e}_overwriteAlternativeVersionId(e){this._alternativeVersionId=e}_overwriteInitialUndoRedoSnapshot(e){this._initialUndoRedoSnapshot=e}getValue(e,t=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new mt("Operation would exceed heap memory limits");const i=this.getFullModelRange(),n=this.getValueInRange(i,e);return t?this._buffer.getBOM()+n:n}createSnapshot(e=!1){return new Gue(this._buffer.createSnapshot(e))}getValueLength(e,t=!1){this._assertNotDisposed();const i=this.getFullModelRange(),n=this.getValueLengthInRange(i,e);return t?this._buffer.getBOM().length+n:n}getValueInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(e),t)}getValueLengthInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(e),t)}getCharacterCountInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(e),t)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new mt("Illegal value for lineNumber");return this._buffer.getLineContent(e)}getLineLength(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new mt("Illegal value for lineNumber");return this._buffer.getLineLength(e)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new mt("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(e){return this._assertNotDisposed(),1}getLineMaxColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new mt("Illegal value for lineNumber");return this._buffer.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new mt("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(e)}getLineLastNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new mt("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(e)}_validateRangeRelaxedNoAllocations(e){const t=this._buffer.getLineCount(),i=e.startLineNumber,n=e.startColumn;let o=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),r=Math.floor(typeof n=="number"&&!isNaN(n)?n:1);if(o<1)o=1,r=1;else if(o>t)o=t,r=this.getLineMaxColumn(o);else if(r<=1)r=1;else{const h=this.getLineMaxColumn(o);r>=h&&(r=h)}const a=e.endLineNumber,l=e.endColumn;let c=Math.floor(typeof a=="number"&&!isNaN(a)?a:1),d=Math.floor(typeof l=="number"&&!isNaN(l)?l:1);if(c<1)c=1,d=1;else if(c>t)c=t,d=this.getLineMaxColumn(c);else if(d<=1)d=1;else{const h=this.getLineMaxColumn(c);d>=h&&(d=h)}return i===o&&n===r&&a===c&&l===d&&e instanceof k&&!(e instanceof me)?e:new k(o,r,c,d)}_isValidPosition(e,t,i){if(typeof e!="number"||typeof t!="number"||isNaN(e)||isNaN(t)||e<1||t<1||(e|0)!==e||(t|0)!==t)return!1;const n=this._buffer.getLineCount();if(e>n)return!1;if(t===1)return!0;const o=this.getLineMaxColumn(e);if(t>o)return!1;if(i===1){const r=this._buffer.getLineCharCode(e,t-2);if(Qi(r))return!1}return!0}_validatePosition(e,t,i){const n=Math.floor(typeof e=="number"&&!isNaN(e)?e:1),o=Math.floor(typeof t=="number"&&!isNaN(t)?t:1),r=this._buffer.getLineCount();if(n<1)return new P(1,1);if(n>r)return new P(r,this.getLineMaxColumn(r));if(o<=1)return new P(n,1);const a=this.getLineMaxColumn(n);if(o>=a)return new P(n,a);if(i===1){const l=this._buffer.getLineCharCode(n,o-2);if(Qi(l))return new P(n,o-1)}return new P(n,o)}validatePosition(e){return this._assertNotDisposed(),e instanceof P&&this._isValidPosition(e.lineNumber,e.column,1)?e:this._validatePosition(e.lineNumber,e.column,1)}_isValidRange(e,t){const i=e.startLineNumber,n=e.startColumn,o=e.endLineNumber,r=e.endColumn;if(!this._isValidPosition(i,n,0)||!this._isValidPosition(o,r,0))return!1;if(t===1){const a=n>1?this._buffer.getLineCharCode(i,n-2):0,l=r>1&&r<=this._buffer.getLineLength(o)?this._buffer.getLineCharCode(o,r-2):0,c=Qi(a),d=Qi(l);return!c&&!d}return!0}validateRange(e){if(this._assertNotDisposed(),e instanceof k&&!(e instanceof me)&&this._isValidRange(e,1))return e;const i=this._validatePosition(e.startLineNumber,e.startColumn,0),n=this._validatePosition(e.endLineNumber,e.endColumn,0),o=i.lineNumber,r=i.column,a=n.lineNumber,l=n.column;{const c=r>1?this._buffer.getLineCharCode(o,r-2):0,d=l>1&&l<=this._buffer.getLineLength(a)?this._buffer.getLineCharCode(a,l-2):0,h=Qi(c),u=Qi(d);return!h&&!u?new k(o,r,a,l):o===a&&r===l?new k(o,r-1,a,l-1):h&&u?new k(o,r-1,a,l+1):h?new k(o,r-1,a,l):new k(o,r,a,l+1)}}modifyPosition(e,t){this._assertNotDisposed();const i=this.getOffsetAt(e)+t;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,i)))}getFullModelRange(){this._assertNotDisposed();const e=this.getLineCount();return new k(1,1,e,this.getLineMaxColumn(e))}findMatchesLineByLine(e,t,i,n){return this._buffer.findMatchesLineByLine(e,t,i,n)}findMatches(e,t,i,n,o,r,a=Kue){this._assertNotDisposed();let l=null;t!==null&&(Array.isArray(t)||(t=[t]),t.every(h=>k.isIRange(h))&&(l=t.map(h=>this.validateRange(h)))),l===null&&(l=[this.getFullModelRange()]),l=l.sort((h,u)=>h.startLineNumber-u.startLineNumber||h.startColumn-u.startColumn);const c=[];c.push(l.reduce((h,u)=>k.areIntersecting(h,u)?h.plusRange(u):(c.push(h),u)));let d;if(!i&&e.indexOf(`
`)<0){const u=new Kh(e,i,n,o).parseSearchRequest();if(!u)return[];d=g=>this.findMatchesLineByLine(g,u,r,a)}else d=h=>wy.findMatches(this,new Kh(e,i,n,o),h,r,a);return c.map(d).reduce((h,u)=>h.concat(u),[])}findNextMatch(e,t,i,n,o,r){this._assertNotDisposed();const a=this.validatePosition(t);if(!i&&e.indexOf(`
`)<0){const c=new Kh(e,i,n,o).parseSearchRequest();if(!c)return null;const d=this.getLineCount();let h=new k(a.lineNumber,a.column,d,this.getLineMaxColumn(d)),u=this.findMatchesLineByLine(h,c,r,1);return wy.findNextMatch(this,new Kh(e,i,n,o),a,r),u.length>0||(h=new k(1,1,a.lineNumber,this.getLineMaxColumn(a.lineNumber)),u=this.findMatchesLineByLine(h,c,r,1),u.length>0)?u[0]:null}return wy.findNextMatch(this,new Kh(e,i,n,o),a,r)}findPreviousMatch(e,t,i,n,o,r){this._assertNotDisposed();const a=this.validatePosition(t);return wy.findPreviousMatch(this,new Kh(e,i,n,o),a,r)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(e){if((this.getEOL()===`
`?0:1)!==e)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(e)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(e){return e instanceof oD?e:new oD(e.identifier||null,this.validateRange(e.range),e.text,e.forceMoveMarkers||!1,e.isAutoWhitespaceEdit||!1,e._isTracked||!1)}_validateEditOperations(e){const t=[];for(let i=0,n=e.length;i<n;i++)t[i]=this._validateEditOperation(e[i]);return t}pushEditOperations(e,t,i,n){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(e,this._validateEditOperations(t),i,n)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(e,t,i,n){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){const o=t.map(a=>({range:this.validateRange(a.range),text:a.text}));let r=!0;if(e)for(let a=0,l=e.length;a<l;a++){const c=e[a];let d=!1;for(let h=0,u=o.length;h<u;h++){const g=o[h].range,f=g.startLineNumber>c.endLineNumber,m=c.startLineNumber>g.endLineNumber;if(!f&&!m){d=!0;break}}if(!d){r=!1;break}}if(r)for(let a=0,l=this._trimAutoWhitespaceLines.length;a<l;a++){const c=this._trimAutoWhitespaceLines[a],d=this.getLineMaxColumn(c);let h=!0;for(let u=0,g=o.length;u<g;u++){const f=o[u].range,m=o[u].text;if(!(c<f.startLineNumber||c>f.endLineNumber)&&!(c===f.startLineNumber&&f.startColumn===d&&f.isEmpty()&&m&&m.length>0&&m.charAt(0)===`
`)&&!(c===f.startLineNumber&&f.startColumn===1&&f.isEmpty()&&m&&m.length>0&&m.charAt(m.length-1)===`
`)){h=!1;break}}if(h){const u=new k(c,1,c,d);t.push(new oD(null,u,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(e,t,i,n)}_applyUndo(e,t,i,n){const o=e.map(r=>{const a=this.getPositionAt(r.newPosition),l=this.getPositionAt(r.newEnd);return{range:new k(a.lineNumber,a.column,l.lineNumber,l.column),text:r.oldText}});this._applyUndoRedoEdits(o,t,!0,!1,i,n)}_applyRedo(e,t,i,n){const o=e.map(r=>{const a=this.getPositionAt(r.oldPosition),l=this.getPositionAt(r.oldEnd);return{range:new k(a.lineNumber,a.column,l.lineNumber,l.column),text:r.newText}});this._applyUndoRedoEdits(o,t,!1,!0,i,n)}_applyUndoRedoEdits(e,t,i,n,o,r){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=i,this._isRedoing=n,this.applyEdits(e,!1),this.setEOL(t),this._overwriteAlternativeVersionId(o)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(r),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(e,t=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();const i=this._validateEditOperations(e);return this._doApplyEdits(i,t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(e,t){const i=this._buffer.getLineCount(),n=this._buffer.applyEdits(e,this._options.trimAutoWhitespace,t),o=this._buffer.getLineCount(),r=n.changes;if(this._trimAutoWhitespaceLines=n.trimAutoWhitespaceLineNumbers,r.length!==0){for(let c=0,d=r.length;c<d;c++){const h=r[c];this._decorationsTree.acceptReplace(h.rangeOffset,h.rangeLength,h.text.length,h.forceMoveMarkers)}const a=[];this._increaseVersionId();let l=i;for(let c=0,d=r.length;c<d;c++){const h=r[c],[u]=rh(h.text);this._onDidChangeDecorations.fire();const g=h.range.startLineNumber,f=h.range.endLineNumber,m=f-g,_=u,b=Math.min(m,_),v=_-m,C=o-l-v+g,y=C,w=C+_,x=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new P(y,1)),this.getOffsetAt(new P(w,this.getLineMaxColumn(w))),0),L=Ha.fromDecorations(x),D=new Oc(L);for(let T=b;T>=0;T--){const F=g+T,W=C+T;D.takeFromEndWhile($=>$.lineNumber>W);const H=D.takeFromEndWhile($=>$.lineNumber===W);a.push(new uW(F,this.getLineContent(W),H))}if(b<m){const T=g+b;a.push(new Vue(T+1,f))}if(b<_){const T=new Oc(L),F=g+b,W=_-b,H=o-l-W+F+1,$=[],V=[];for(let Y=0;Y<W;Y++){const ie=H+Y;V[Y]=this.getLineContent(ie),T.takeWhile(ue=>ue.lineNumber<ie),$[Y]=T.takeWhile(ue=>ue.lineNumber===ie)}a.push(new zue(F+1,g+_,V,$))}l+=v}this._emitContentChangedEvent(new sp(a,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:r,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return n.reverseEdits===null?void 0:n.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(e){if(e===null||e.size===0)return;const i=Array.from(e).map(n=>new uW(n,this.getLineContent(n),this._getInjectedTextInLine(n)));this._onDidChangeInjectedText.fire(new HU(i))}changeDecorations(e,t=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(t,e)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(e,t){const i={addDecoration:(o,r)=>this._deltaDecorationsImpl(e,[],[{range:o,options:r}])[0],changeDecoration:(o,r)=>{this._changeDecorationImpl(o,r)},changeDecorationOptions:(o,r)=>{this._changeDecorationOptionsImpl(o,mW(r))},removeDecoration:o=>{this._deltaDecorationsImpl(e,[o],[])},deltaDecorations:(o,r)=>o.length===0&&r.length===0?[]:this._deltaDecorationsImpl(e,o,r)};let n=null;try{n=t(i)}catch(o){Oe(o)}return i.addDecoration=i_,i.changeDecoration=i_,i.changeDecorationOptions=i_,i.removeDecoration=i_,i.deltaDecorations=i_,n}deltaDecorations(e,t,i=0){if(this._assertNotDisposed(),e||(e=[]),e.length===0&&t.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),Oe(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(i,e,t)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(e){return this.getDecorationRange(e)}_setTrackedRange(e,t,i){const n=e?this._decorations[e]:null;if(!n)return t?this._deltaDecorationsImpl(0,[],[{range:t,options:pW[i]}],!0)[0]:null;if(!t)return this._decorationsTree.delete(n),delete this._decorations[n.id],null;const o=this._validateRangeRelaxedNoAllocations(t),r=this._buffer.getOffsetAt(o.startLineNumber,o.startColumn),a=this._buffer.getOffsetAt(o.endLineNumber,o.endColumn);return this._decorationsTree.delete(n),n.reset(this.getVersionId(),r,a,o),n.setOptions(pW[i]),this._decorationsTree.insert(n),n.id}removeAllDecorationsWithOwnerId(e){if(this._isDisposed)return;const t=this._decorationsTree.collectNodesFromOwner(e);for(let i=0,n=t.length;i<n;i++){const o=t[i];this._decorationsTree.delete(o),delete this._decorations[o.id]}}getDecorationOptions(e){const t=this._decorations[e];return t?t.options:null}getDecorationRange(e){const t=this._decorations[e];return t?this._decorationsTree.getNodeRange(this,t):null}getLineDecorations(e,t=0,i=!1){return e<1||e>this.getLineCount()?[]:this.getLinesDecorations(e,e,t,i)}getLinesDecorations(e,t,i=0,n=!1,o=!1){const r=this.getLineCount(),a=Math.min(r,Math.max(1,e)),l=Math.min(r,Math.max(1,t)),c=this.getLineMaxColumn(l),d=new k(a,1,l,c),h=this._getDecorationsInRange(d,i,n,o);return qI(h,this._decorationProvider.getDecorationsInRange(d,i,n)),h}getDecorationsInRange(e,t=0,i=!1,n=!1,o=!1){const r=this.validateRange(e),a=this._getDecorationsInRange(r,t,i,o);return qI(a,this._decorationProvider.getDecorationsInRange(r,t,i,n)),a}getOverviewRulerDecorations(e=0,t=!1){return this._decorationsTree.getAll(this,e,t,!0,!1)}getInjectedTextDecorations(e=0){return this._decorationsTree.getAllInjectedText(this,e)}_getInjectedTextInLine(e){const t=this._buffer.getOffsetAt(e,1),i=t+this._buffer.getLineLength(e),n=this._decorationsTree.getInjectedTextInInterval(this,t,i,0);return Ha.fromDecorations(n).filter(o=>o.lineNumber===e)}getAllDecorations(e=0,t=!1){let i=this._decorationsTree.getAll(this,e,t,!1,!1);return i=i.concat(this._decorationProvider.getAllDecorations(e,t)),i}getAllMarginDecorations(e=0){return this._decorationsTree.getAll(this,e,!1,!1,!0)}_getDecorationsInRange(e,t,i,n){const o=this._buffer.getOffsetAt(e.startLineNumber,e.startColumn),r=this._buffer.getOffsetAt(e.endLineNumber,e.endColumn);return this._decorationsTree.getAllInInterval(this,o,r,t,i,n)}getRangeAt(e,t){return this._buffer.getRangeAt(e,t-e)}_changeDecorationImpl(e,t){const i=this._decorations[e];if(!i)return;if(i.options.after){const a=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(a.endLineNumber)}if(i.options.before){const a=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(a.startLineNumber)}const n=this._validateRangeRelaxedNoAllocations(t),o=this._buffer.getOffsetAt(n.startLineNumber,n.startColumn),r=this._buffer.getOffsetAt(n.endLineNumber,n.endColumn);this._decorationsTree.delete(i),i.reset(this.getVersionId(),o,r,n),this._decorationsTree.insert(i),this._onDidChangeDecorations.checkAffectedAndFire(i.options),i.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(n.endLineNumber),i.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(n.startLineNumber)}_changeDecorationOptionsImpl(e,t){const i=this._decorations[e];if(!i)return;const n=!!(i.options.overviewRuler&&i.options.overviewRuler.color),o=!!(t.overviewRuler&&t.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(i.options),this._onDidChangeDecorations.checkAffectedAndFire(t),i.options.after||t.after){const l=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.endLineNumber)}if(i.options.before||t.before){const l=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.startLineNumber)}const r=n!==o,a=Xue(t)!==Kw(i);r||a?(this._decorationsTree.delete(i),i.setOptions(t),this._decorationsTree.insert(i)):i.setOptions(t)}_deltaDecorationsImpl(e,t,i,n=!1){const o=this.getVersionId(),r=t.length;let a=0;const l=i.length;let c=0;this._onDidChangeDecorations.beginDeferredEmit();try{const d=new Array(l);for(;a<r||c<l;){let h=null;if(a<r){do h=this._decorations[t[a++]];while(!h&&a<r);if(h){if(h.options.after){const u=this._decorationsTree.getNodeRange(this,h);this._onDidChangeDecorations.recordLineAffectedByInjectedText(u.endLineNumber)}if(h.options.before){const u=this._decorationsTree.getNodeRange(this,h);this._onDidChangeDecorations.recordLineAffectedByInjectedText(u.startLineNumber)}this._decorationsTree.delete(h),n||this._onDidChangeDecorations.checkAffectedAndFire(h.options)}}if(c<l){if(!h){const b=++this._lastDecorationId,v=`${this._instanceId};${b}`;h=new MU(v,0,0),this._decorations[v]=h}const u=i[c],g=this._validateRangeRelaxedNoAllocations(u.range),f=mW(u.options),m=this._buffer.getOffsetAt(g.startLineNumber,g.startColumn),_=this._buffer.getOffsetAt(g.endLineNumber,g.endColumn);h.ownerId=e,h.reset(o,m,_,g),h.setOptions(f),h.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(g.endLineNumber),h.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(g.startLineNumber),n||this._onDidChangeDecorations.checkAffectedAndFire(f),this._decorationsTree.insert(h),d[c]=h.id,c++}else h&&delete this._decorations[h.id]}return d}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(e,t){typeof e=="string"?(this._languageSelectionListener.clear(),this._setLanguage(e,t)):(this._languageSelectionListener.value=e.onDidChange(()=>this._setLanguage(e.languageId,t)),this._setLanguage(e.languageId,t))}_setLanguage(e,t){this.tokenization.setLanguageId(e,t),this._languageService.requestRichLanguageFeatures(e)}getLanguageIdAtPosition(e,t){return this.tokenization.getLanguageIdAtPosition(e,t)}getWordAtPosition(e){return this._tokenizationTextModelPart.getWordAtPosition(e)}getWordUntilPosition(e){return this._tokenizationTextModelPart.getWordUntilPosition(e)}normalizePosition(e,t){return e}getLineIndentColumn(e){return Yue(this.getLineContent(e))+1}};Da=qh=$ue([Vy(4,_2),Vy(5,ni),Vy(6,di),Vy(7,ye)],Da);function Yue(s){let e=0;for(const t of s)if(t===" "||t==="	")e++;else break;return e}function MD(s){return!!(s.options.overviewRuler&&s.options.overviewRuler.color)}function Xue(s){return!!s.after||!!s.before}function Kw(s){return!!s.options.after||!!s.options.before}class fW{constructor(){this._decorationsTree0=new TD,this._decorationsTree1=new TD,this._injectedTextDecorationsTree=new TD}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1,!1)}_ensureNodesHaveRanges(e,t){for(const i of t)i.range===null&&(i.range=e.getRangeAt(i.cachedAbsoluteStart,i.cachedAbsoluteEnd));return t}getAllInInterval(e,t,i,n,o,r){const a=e.getVersionId(),l=this._intervalSearch(t,i,n,o,a,r);return this._ensureNodesHaveRanges(e,l)}_intervalSearch(e,t,i,n,o,r){const a=this._decorationsTree0.intervalSearch(e,t,i,n,o,r),l=this._decorationsTree1.intervalSearch(e,t,i,n,o,r),c=this._injectedTextDecorationsTree.intervalSearch(e,t,i,n,o,r);return a.concat(l).concat(c)}getInjectedTextInInterval(e,t,i,n){const o=e.getVersionId(),r=this._injectedTextDecorationsTree.intervalSearch(t,i,n,!1,o,!1);return this._ensureNodesHaveRanges(e,r).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getAllInjectedText(e,t){const i=e.getVersionId(),n=this._injectedTextDecorationsTree.search(t,!1,i,!1);return this._ensureNodesHaveRanges(e,n).filter(o=>o.options.showIfCollapsed||!o.range.isEmpty())}getAll(e,t,i,n,o){const r=e.getVersionId(),a=this._search(t,i,n,r,o);return this._ensureNodesHaveRanges(e,a)}_search(e,t,i,n,o){if(i)return this._decorationsTree1.search(e,t,n,o);{const r=this._decorationsTree0.search(e,t,n,o),a=this._decorationsTree1.search(e,t,n,o),l=this._injectedTextDecorationsTree.search(e,t,n,o);return r.concat(a).concat(l)}}collectNodesFromOwner(e){const t=this._decorationsTree0.collectNodesFromOwner(e),i=this._decorationsTree1.collectNodesFromOwner(e),n=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(i).concat(n)}collectNodesPostOrder(){const e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),i=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(i)}insert(e){Kw(e)?this._injectedTextDecorationsTree.insert(e):MD(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){Kw(e)?this._injectedTextDecorationsTree.delete(e):MD(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){const i=e.getVersionId();return t.cachedVersionId!==i&&this._resolveNode(t,i),t.range===null&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){Kw(e)?this._injectedTextDecorationsTree.resolveNode(e,t):MD(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,i,n){this._decorationsTree0.acceptReplace(e,t,i,n),this._decorationsTree1.acceptReplace(e,t,i,n),this._injectedTextDecorationsTree.acceptReplace(e,t,i,n)}}function il(s){return s.replace(/[^a-z0-9\-_]/gi," ")}class VU{constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}}class Que extends VU{constructor(e){super(e),this._resolvedColor=null,this.position=typeof e.position=="number"?e.position:Ho.Center}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if(typeof e=="string")return e;const i=e?t.getColor(e.id):null;return i?i.toString():""}}class Jue{constructor(e){this.position=e?.position??Jr.Center,this.persistLane=e?.persistLane}}class ege extends VU{constructor(e){super(e),this.position=e.position,this.sectionHeaderStyle=e.sectionHeaderStyle??null,this.sectionHeaderText=e.sectionHeaderText??null}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return typeof e=="string"?G.fromHex(e):t.getColor(e.id)}}class dh{static from(e){return e instanceof dh?e:new dh(e)}constructor(e){this.content=e.content||"",this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=e.attachedData||null,this.cursorStops=e.cursorStops||null}}class We{static register(e){return new We(e)}static createDynamic(e){return new We(e)}constructor(e){this.description=e.description,this.blockClassName=e.blockClassName?il(e.blockClassName):null,this.blockDoesNotCollapse=e.blockDoesNotCollapse??null,this.blockIsAfterEnd=e.blockIsAfterEnd??null,this.blockPadding=e.blockPadding??null,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?il(e.className):null,this.shouldFillLineOnLineBreak=e.shouldFillLineOnLineBreak??null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.lineNumberHoverMessage=e.lineNumberHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new Que(e.overviewRuler):null,this.minimap=e.minimap?new ege(e.minimap):null,this.glyphMargin=e.glyphMarginClassName?new Jue(e.glyphMargin):null,this.glyphMarginClassName=e.glyphMarginClassName?il(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?il(e.linesDecorationsClassName):null,this.lineNumberClassName=e.lineNumberClassName?il(e.lineNumberClassName):null,this.linesDecorationsTooltip=e.linesDecorationsTooltip?pee(e.linesDecorationsTooltip):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?il(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?il(e.marginClassName):null,this.inlineClassName=e.inlineClassName?il(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?il(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?il(e.afterContentClassName):null,this.after=e.after?dh.from(e.after):null,this.before=e.before?dh.from(e.before):null,this.hideInCommentTokens=e.hideInCommentTokens??!1,this.hideInStringTokens=e.hideInStringTokens??!1}}We.EMPTY=We.register({description:"empty"});const pW=[We.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),We.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),We.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),We.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function mW(s){return s instanceof We?s:We.createDynamic(s)}class tge extends B{constructor(e){super(),this.handleBeforeFire=e,this._actual=this._register(new O),this.event=this._actual.event,this._affectedInjectedTextLines=null,this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._affectsLineNumber=!1}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),this._affectedInjectedTextLines?.clear(),this._affectedInjectedTextLines=null)}recordLineAffectedByInjectedText(e){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(e)}checkAffectedAndFire(e){this._affectsMinimap||=!!e.minimap?.position,this._affectsOverviewRuler||=!!e.overviewRuler?.color,this._affectsGlyphMargin||=!!e.glyphMarginClassName,this._affectsLineNumber||=!!e.lineNumberClassName,this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines);const e={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin,affectsLineNumber:this._affectsLineNumber};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(e)}}class ige extends B{constructor(){super(),this._fastEmitter=this._register(new O),this.fastEvent=this._fastEmitter.event,this._slowEmitter=this._register(new O),this.slowEvent=this._slowEmitter.event,this._deferredCnt=0,this._deferredEvent=null}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;const t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e;return}this._fastEmitter.fire(e),this._slowEmitter.fire(e)}}var nge=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Uy=function(s,e){return function(t,i){e(t,i,s)}},cf;function Fh(s){return s.toString()}let sge=class{constructor(e,t,i){this.model=e,this._modelEventListeners=new Z,this.model=e,this._modelEventListeners.add(e.onWillDispose(()=>t(e))),this._modelEventListeners.add(e.onDidChangeLanguage(n=>i(e,n)))}dispose(){this._modelEventListeners.dispose()}};const oge=ys||Qe?1:2;class rge{constructor(e,t,i,n,o,r,a,l){this.uri=e,this.initialUndoRedoSnapshot=t,this.time=i,this.sharesUndoRedoStack=n,this.heapSize=o,this.sha1=r,this.versionId=a,this.alternativeVersionId=l}}let RN=class extends B{static{cf=this}static{this.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK=20*1024*1024}constructor(e,t,i,n){super(),this._configurationService=e,this._resourcePropertiesService=t,this._undoRedoService=i,this._instantiationService=n,this._onModelAdded=this._register(new O),this.onModelAdded=this._onModelAdded.event,this._onModelRemoved=this._register(new O),this.onModelRemoved=this._onModelRemoved.event,this._onModelModeChanged=this._register(new O),this.onModelLanguageChanged=this._onModelModeChanged.event,this._modelCreationOptionsByLanguageAndResource=Object.create(null),this._models={},this._disposedModels=new Map,this._disposedModelsHeapSize=0,this._register(this._configurationService.onDidChangeConfiguration(o=>this._updateModelOptions(o))),this._updateModelOptions(void 0)}static _readModelOptions(e,t){let i=Vn.tabSize;if(e.editor&&typeof e.editor.tabSize<"u"){const u=parseInt(e.editor.tabSize,10);isNaN(u)||(i=u),i<1&&(i=1)}let n="tabSize";if(e.editor&&typeof e.editor.indentSize<"u"&&e.editor.indentSize!=="tabSize"){const u=parseInt(e.editor.indentSize,10);isNaN(u)||(n=Math.max(u,1))}let o=Vn.insertSpaces;e.editor&&typeof e.editor.insertSpaces<"u"&&(o=e.editor.insertSpaces==="false"?!1:!!e.editor.insertSpaces);let r=oge;const a=e.eol;a===`\r
`?r=2:a===`
`&&(r=1);let l=Vn.trimAutoWhitespace;e.editor&&typeof e.editor.trimAutoWhitespace<"u"&&(l=e.editor.trimAutoWhitespace==="false"?!1:!!e.editor.trimAutoWhitespace);let c=Vn.detectIndentation;e.editor&&typeof e.editor.detectIndentation<"u"&&(c=e.editor.detectIndentation==="false"?!1:!!e.editor.detectIndentation);let d=Vn.largeFileOptimizations;e.editor&&typeof e.editor.largeFileOptimizations<"u"&&(d=e.editor.largeFileOptimizations==="false"?!1:!!e.editor.largeFileOptimizations);let h=Vn.bracketPairColorizationOptions;return e.editor?.bracketPairColorization&&typeof e.editor.bracketPairColorization=="object"&&(h={enabled:!!e.editor.bracketPairColorization.enabled,independentColorPoolPerBracketType:!!e.editor.bracketPairColorization.independentColorPoolPerBracketType}),{isForSimpleWidget:t,tabSize:i,indentSize:n,insertSpaces:o,detectIndentation:c,defaultEOL:r,trimAutoWhitespace:l,largeFileOptimizations:d,bracketPairColorizationOptions:h}}_getEOL(e,t){if(e)return this._resourcePropertiesService.getEOL(e,t);const i=this._configurationService.getValue("files.eol",{overrideIdentifier:t});return i&&typeof i=="string"&&i!=="auto"?i:lo===3||lo===2?`
`:`\r
`}_shouldRestoreUndoStack(){const e=this._configurationService.getValue("files.restoreUndoStack");return typeof e=="boolean"?e:!0}getCreationOptions(e,t,i){const n=typeof e=="string"?e:e.languageId;let o=this._modelCreationOptionsByLanguageAndResource[n+t];if(!o){const r=this._configurationService.getValue("editor",{overrideIdentifier:n,resource:t}),a=this._getEOL(t,n);o=cf._readModelOptions({editor:r,eol:a},i),this._modelCreationOptionsByLanguageAndResource[n+t]=o}return o}_updateModelOptions(e){const t=this._modelCreationOptionsByLanguageAndResource;this._modelCreationOptionsByLanguageAndResource=Object.create(null);const i=Object.keys(this._models);for(let n=0,o=i.length;n<o;n++){const r=i[n],a=this._models[r],l=a.model.getLanguageId(),c=a.model.uri;if(e&&!e.affectsConfiguration("editor",{overrideIdentifier:l,resource:c})&&!e.affectsConfiguration("files.eol",{overrideIdentifier:l,resource:c}))continue;const d=t[l+c],h=this.getCreationOptions(l,c,a.model.isForSimpleWidget);cf._setModelOptionsForModel(a.model,h,d)}}static _setModelOptionsForModel(e,t,i){i&&i.defaultEOL!==t.defaultEOL&&e.getLineCount()===1&&e.setEOL(t.defaultEOL===1?0:1),!(i&&i.detectIndentation===t.detectIndentation&&i.insertSpaces===t.insertSpaces&&i.tabSize===t.tabSize&&i.indentSize===t.indentSize&&i.trimAutoWhitespace===t.trimAutoWhitespace&&co(i.bracketPairColorizationOptions,t.bracketPairColorizationOptions))&&(t.detectIndentation?(e.detectIndentation(t.insertSpaces,t.tabSize),e.updateOptions({trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions})):e.updateOptions({insertSpaces:t.insertSpaces,tabSize:t.tabSize,indentSize:t.indentSize,trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions}))}_insertDisposedModel(e){this._disposedModels.set(Fh(e.uri),e),this._disposedModelsHeapSize+=e.heapSize}_removeDisposedModel(e){const t=this._disposedModels.get(Fh(e));return t&&(this._disposedModelsHeapSize-=t.heapSize),this._disposedModels.delete(Fh(e)),t}_ensureDisposedModelsHeapSize(e){if(this._disposedModelsHeapSize>e){const t=[];for(this._disposedModels.forEach(i=>{i.sharesUndoRedoStack||t.push(i)}),t.sort((i,n)=>i.time-n.time);t.length>0&&this._disposedModelsHeapSize>e;){const i=t.shift();this._removeDisposedModel(i.uri),i.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(i.initialUndoRedoSnapshot)}}}_createModelData(e,t,i,n){const o=this.getCreationOptions(t,i,n),r=this._instantiationService.createInstance(Da,e,t,o,i);if(i&&this._disposedModels.has(Fh(i))){const c=this._removeDisposedModel(i),d=this._undoRedoService.getElements(i),h=this._getSHA1Computer(),u=h.canComputeSHA1(r)?h.computeSHA1(r)===c.sha1:!1;if(u||c.sharesUndoRedoStack){for(const g of d.past)hc(g)&&g.matchesResource(i)&&g.setModel(r);for(const g of d.future)hc(g)&&g.matchesResource(i)&&g.setModel(r);this._undoRedoService.setElementsValidFlag(i,!0,g=>hc(g)&&g.matchesResource(i)),u&&(r._overwriteVersionId(c.versionId),r._overwriteAlternativeVersionId(c.alternativeVersionId),r._overwriteInitialUndoRedoSnapshot(c.initialUndoRedoSnapshot))}else c.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(c.initialUndoRedoSnapshot)}const a=Fh(r.uri);if(this._models[a])throw new Error("ModelService: Cannot add model because it already exists!");const l=new sge(r,c=>this._onWillDispose(c),(c,d)=>this._onDidChangeLanguage(c,d));return this._models[a]=l,l}createModel(e,t,i,n=!1){let o;return t?o=this._createModelData(e,t,i,n):o=this._createModelData(e,Cs,i,n),this._onModelAdded.fire(o.model),o.model}getModels(){const e=[],t=Object.keys(this._models);for(let i=0,n=t.length;i<n;i++){const o=t[i];e.push(this._models[o].model)}return e}getModel(e){const t=Fh(e),i=this._models[t];return i?i.model:null}_schemaShouldMaintainUndoRedoElements(e){return e.scheme===Fe.file||e.scheme===Fe.vscodeRemote||e.scheme===Fe.vscodeUserData||e.scheme===Fe.vscodeNotebookCell||e.scheme==="fake-fs"}_onWillDispose(e){const t=Fh(e.uri),i=this._models[t],n=this._undoRedoService.getUriComparisonKey(e.uri)!==e.uri.toString();let o=!1,r=0;if(n||this._shouldRestoreUndoStack()&&this._schemaShouldMaintainUndoRedoElements(e.uri)){const c=this._undoRedoService.getElements(e.uri);if(c.past.length>0||c.future.length>0){for(const d of c.past)hc(d)&&d.matchesResource(e.uri)&&(o=!0,r+=d.heapSize(e.uri),d.setModel(e.uri));for(const d of c.future)hc(d)&&d.matchesResource(e.uri)&&(o=!0,r+=d.heapSize(e.uri),d.setModel(e.uri))}}const a=cf.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK,l=this._getSHA1Computer();if(o)if(!n&&(r>a||!l.canComputeSHA1(e))){const c=i.model.getInitialUndoRedoSnapshot();c!==null&&this._undoRedoService.restoreSnapshot(c)}else this._ensureDisposedModelsHeapSize(a-r),this._undoRedoService.setElementsValidFlag(e.uri,!1,c=>hc(c)&&c.matchesResource(e.uri)),this._insertDisposedModel(new rge(e.uri,i.model.getInitialUndoRedoSnapshot(),Date.now(),n,r,l.computeSHA1(e),e.getVersionId(),e.getAlternativeVersionId()));else if(!n){const c=i.model.getInitialUndoRedoSnapshot();c!==null&&this._undoRedoService.restoreSnapshot(c)}delete this._models[t],i.dispose(),delete this._modelCreationOptionsByLanguageAndResource[e.getLanguageId()+e.uri],this._onModelRemoved.fire(e)}_onDidChangeLanguage(e,t){const i=t.oldLanguage,n=e.getLanguageId(),o=this.getCreationOptions(i,e.uri,e.isForSimpleWidget),r=this.getCreationOptions(n,e.uri,e.isForSimpleWidget);cf._setModelOptionsForModel(e,r,o),this._onModelModeChanged.fire({model:e,oldLanguageId:i})}_getSHA1Computer(){return new gO}};RN=cf=nge([Uy(0,Ke),Uy(1,FV),Uy(2,_2),Uy(3,ye)],RN);class gO{static{this.MAX_MODEL_SIZE=10*1024*1024}canComputeSHA1(e){return e.getValueLength()<=gO.MAX_MODEL_SIZE}computeSHA1(e){const t=new YP,i=e.createSnapshot();let n;for(;n=i.read();)t.update(n);return t.digest()}}var MN;(function(s){s[s.PRESERVE=0]="PRESERVE",s[s.LAST=1]="LAST"})(MN||(MN={}));const Cg={Quickaccess:"workbench.contributions.quickaccess"};class age{constructor(){this.providers=[],this.defaultProvider=void 0}registerQuickAccessProvider(e){return e.prefix.length===0?this.defaultProvider=e:this.providers.push(e),this.providers.sort((t,i)=>i.prefix.length-t.prefix.length),Ce(()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return Yr([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find(i=>e.startsWith(i.prefix))||void 0||this.defaultProvider}}ci.add(Cg.Quickaccess,new age);const lge={ctrlCmd:!1,alt:!1};var Wp;(function(s){s[s.Blur=1]="Blur",s[s.Gesture=2]="Gesture",s[s.Other=3]="Other"})(Wp||(Wp={}));var Ca;(function(s){s[s.NONE=0]="NONE",s[s.FIRST=1]="FIRST",s[s.SECOND=2]="SECOND",s[s.LAST=3]="LAST"})(Ca||(Ca={}));var zt;(function(s){s[s.First=1]="First",s[s.Second=2]="Second",s[s.Last=3]="Last",s[s.Next=4]="Next",s[s.Previous=5]="Previous",s[s.NextPage=6]="NextPage",s[s.PreviousPage=7]="PreviousPage",s[s.NextSeparator=8]="NextSeparator",s[s.PreviousSeparator=9]="PreviousSeparator"})(zt||(zt={}));var A0;(function(s){s[s.Title=1]="Title",s[s.Inline=2]="Inline"})(A0||(A0={}));const Dr=Je("quickInputService");var cge=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},_W=function(s,e){return function(t,i){e(t,i,s)}};let AN=class extends B{constructor(e,t){super(),this.quickInputService=e,this.instantiationService=t,this.registry=ci.as(Cg.Quickaccess),this.mapProviderToDescriptor=new Map,this.lastAcceptedPickerValues=new Map,this.visibleQuickAccess=void 0}show(e="",t){this.doShowOrPick(e,!1,t)}doShowOrPick(e,t,i){const[n,o]=this.getOrInstantiateProvider(e,i?.enabledProviderPrefixes),r=this.visibleQuickAccess,a=r?.descriptor;if(r&&o&&a===o){e!==o.prefix&&!i?.preserveValue&&(r.picker.value=e),this.adjustValueSelection(r.picker,o,i);return}if(o&&!i?.preserveValue){let f;if(r&&a&&a!==o){const m=r.value.substr(a.prefix.length);m&&(f=`${o.prefix}${m}`)}if(!f){const m=n?.defaultFilterValue;m===MN.LAST?f=this.lastAcceptedPickerValues.get(o):typeof m=="string"&&(f=`${o.prefix}${m}`)}typeof f=="string"&&(e=f)}const l=r?.picker?.valueSelection,c=r?.picker?.value,d=new Z,h=d.add(this.quickInputService.createQuickPick({useSeparators:!0}));h.value=e,this.adjustValueSelection(h,o,i),h.placeholder=i?.placeholder??o?.placeholder,h.quickNavigate=i?.quickNavigateConfiguration,h.hideInput=!!h.quickNavigate&&!r,(typeof i?.itemActivation=="number"||i?.quickNavigateConfiguration)&&(h.itemActivation=i?.itemActivation??Ca.SECOND),h.contextKey=o?.contextKey,h.filterValue=f=>f.substring(o?o.prefix.length:0);let u;t&&(u=new pm,d.add(se.once(h.onWillAccept)(f=>{f.veto(),h.hide()}))),d.add(this.registerPickerListeners(h,n,o,e,i));const g=d.add(new li);if(n&&d.add(n.provide(h,g.token,i?.providerOptions)),se.once(h.onDidHide)(()=>{h.selectedItems.length===0&&g.cancel(),d.dispose(),u?.complete(h.selectedItems.slice(0))}),h.show(),l&&c===e&&(h.valueSelection=l),t)return u?.p}adjustValueSelection(e,t,i){let n;i?.preserveValue?n=[e.value.length,e.value.length]:n=[t?.prefix.length??0,e.value.length],e.valueSelection=n}registerPickerListeners(e,t,i,n,o){const r=new Z,a=this.visibleQuickAccess={picker:e,descriptor:i,value:n};return r.add(Ce(()=>{a===this.visibleQuickAccess&&(this.visibleQuickAccess=void 0)})),r.add(e.onDidChangeValue(l=>{const[c]=this.getOrInstantiateProvider(l,o?.enabledProviderPrefixes);c!==t?this.show(l,{enabledProviderPrefixes:o?.enabledProviderPrefixes,preserveValue:!0,providerOptions:o?.providerOptions}):a.value=l})),i&&r.add(e.onDidAccept(()=>{this.lastAcceptedPickerValues.set(i,e.value)})),r}getOrInstantiateProvider(e,t){const i=this.registry.getQuickAccessProvider(e);if(!i||t&&!t?.includes(i.prefix))return[void 0,void 0];let n=this.mapProviderToDescriptor.get(i);return n||(n=this.instantiationService.createInstance(i.ctor),this.mapProviderToDescriptor.set(i,n)),[n,i]}};AN=cge([_W(0,Dr),_W(1,ye)],AN);class Im extends Yo{constructor(e){super(),this._onChange=this._register(new O),this.onChange=this._onChange.event,this._onKeyDown=this._register(new O),this.onKeyDown=this._onKeyDown.event,this._opts=e,this._checked=this._opts.isChecked;const t=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,t.push(...Ie.asClassNameArray(this._icon))),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(" ")),this._checked&&t.push("checked"),this.domNode=document.createElement("div"),this._hover=this._register(Ka().setupManagedHover(e.hoverDelegate??Ds("mouse"),this.domNode,this._opts.title)),this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,i=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),i.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,i=>{if(i.keyCode===10||i.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),i.preventDefault(),i.stopPropagation();return}this._onKeyDown.fire(i)})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}width(){return 22}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}}var dge=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o};class zU{constructor(e){this.nodes=e}toString(){return this.nodes.map(e=>typeof e=="string"?e:e.label).join("")}}dge([Ti],zU.prototype,"toString",null);const hge=/\[([^\]]+)\]\(((?:https?:\/\/|command:|file:)[^\)\s]+)(?: (["'])(.+?)(\3))?\)/gi;function uge(s){const e=[];let t=0,i;for(;i=hge.exec(s);){i.index-t>0&&e.push(s.substring(t,i.index));const[,n,o,,r]=i;r?e.push({label:n,href:o,title:r}):e.push({label:n,href:o}),t=i.index+i[0].length}return t<s.length&&e.push(s.substring(t)),new zU(e)}const AD={},gge=new z2("quick-input-button-icon-");function fge(s){if(!s)return;let e;const t=s.dark.toString();return AD[t]?e=AD[t]:(e=gge.nextId(),U1(`.${e}, .hc-light .${e}`,`background-image: ${Hc(s.light||s.dark)}`),U1(`.vs-dark .${e}, .hc-black .${e}`,`background-image: ${Hc(s.dark)}`),AD[t]=e),e}function ab(s,e,t){let i=s.iconClass||fge(s.iconPath);return s.alwaysVisible&&(i=i?`${i} always-visible`:"always-visible"),{id:e,label:"",tooltip:s.tooltip||"",class:i,enabled:!0,run:t}}function pge(s,e,t){yn(e);const i=uge(s);let n=0;for(const o of i.nodes)if(typeof o=="string")e.append(...Kd(o));else{let r=o.title;!r&&o.href.startsWith("command:")?r=p("executeCommand","Click to execute command '{0}'",o.href.substring(8)):r||(r=o.href);const a=te("a",{href:o.href,title:r,tabIndex:n++},o.label);a.style.textDecoration="underline";const l=g=>{Ote(g)&&it.stop(g,!0),t.callback(o.href)},c=t.disposables.add(new tt(a,ee.CLICK)).event,d=t.disposables.add(new tt(a,ee.KEY_DOWN)).event,h=se.chain(d,g=>g.filter(f=>{const m=new Ft(f);return m.equals(10)||m.equals(3)}));t.disposables.add(ti.addTarget(a));const u=t.disposables.add(new tt(a,Wt.Tap)).event;se.any(c,u,h)(l,null,t.disposables),e.appendChild(a)}}var mge=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},bW=function(s,e){return function(t,i){e(t,i,s)}};const UU="inQuickInput",_ge=new le(UU,!1,p("inQuickInput","Whether keyboard focus is inside the quick input control")),bge=q.has(UU),$U="quickInputType",vge=new le($U,void 0,p("quickInputType","The type of the currently visible quick input")),jU="cursorAtEndOfQuickInputBox",Cge=new le(jU,!1,p("cursorAtEndOfQuickInputBox","Whether the cursor in the quick input is at the end of the input box")),yge=q.has(jU),PN={iconClass:Ie.asClassName(J.quickInputBack),tooltip:p("quickInput.back","Back"),handle:-1};class ux extends B{static{this.noPromptMessage=p("inputModeEntry","Press 'Enter' to confirm your input or 'Escape' to cancel")}constructor(e){super(),this.ui=e,this._widgetUpdated=!1,this.visible=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!1,this._leftButtons=[],this._rightButtons=[],this._inlineButtons=[],this.buttonsUpdated=!1,this._toggles=[],this.togglesUpdated=!1,this.noValidationMessage=ux.noPromptMessage,this._severity=Di.Ignore,this.onDidTriggerButtonEmitter=this._register(new O),this.onDidHideEmitter=this._register(new O),this.onWillHideEmitter=this._register(new O),this.onDisposeEmitter=this._register(new O),this.visibleDisposables=this._register(new Z),this.onDidHide=this.onDidHideEmitter.event}get title(){return this._title}set title(e){this._title=e,this.update()}get description(){return this._description}set description(e){this._description=e,this.update()}get step(){return this._steps}set step(e){this._steps=e,this.update()}get totalSteps(){return this._totalSteps}set totalSteps(e){this._totalSteps=e,this.update()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.update()}get contextKey(){return this._contextKey}set contextKey(e){this._contextKey=e,this.update()}get busy(){return this._busy}set busy(e){this._busy=e,this.update()}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(e){const t=this._ignoreFocusOut!==e&&!Oa;this._ignoreFocusOut=e&&!Oa,t&&this.update()}get titleButtons(){return this._leftButtons.length?[...this._leftButtons,this._rightButtons]:this._rightButtons}get buttons(){return[...this._leftButtons,...this._rightButtons,...this._inlineButtons]}set buttons(e){this._leftButtons=e.filter(t=>t===PN),this._rightButtons=e.filter(t=>t!==PN&&t.location!==A0.Inline),this._inlineButtons=e.filter(t=>t.location===A0.Inline),this.buttonsUpdated=!0,this.update()}get toggles(){return this._toggles}set toggles(e){this._toggles=e??[],this.togglesUpdated=!0,this.update()}get validationMessage(){return this._validationMessage}set validationMessage(e){this._validationMessage=e,this.update()}get severity(){return this._severity}set severity(e){this._severity=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.onDidTriggerButton(e=>{this.buttons.indexOf(e)!==-1&&this.onDidTriggerButtonEmitter.fire(e)})),this.ui.show(this),this.visible=!0,this._lastValidationMessage=void 0,this._lastSeverity=void 0,this.buttons.length&&(this.buttonsUpdated=!0),this.toggles.length&&(this.togglesUpdated=!0),this.update())}hide(){this.visible&&this.ui.hide()}didHide(e=Wp.Other){this.visible=!1,this.visibleDisposables.clear(),this.onDidHideEmitter.fire({reason:e})}willHide(e=Wp.Other){this.onWillHideEmitter.fire({reason:e})}update(){if(!this.visible)return;const e=this.getTitle();e&&this.ui.title.textContent!==e?this.ui.title.textContent=e:!e&&this.ui.title.innerHTML!=="&nbsp;"&&(this.ui.title.innerText="");const t=this.getDescription();if(this.ui.description1.textContent!==t&&(this.ui.description1.textContent=t),this.ui.description2.textContent!==t&&(this.ui.description2.textContent=t),this._widgetUpdated&&(this._widgetUpdated=!1,this._widget?yn(this.ui.widget,this._widget):yn(this.ui.widget)),this.busy&&!this.busyDelay&&(this.busyDelay=new ia,this.busyDelay.setIfNotSet(()=>{this.visible&&this.ui.progressBar.infinite()},800)),!this.busy&&this.busyDelay&&(this.ui.progressBar.stop(),this.busyDelay.cancel(),this.busyDelay=void 0),this.buttonsUpdated){this.buttonsUpdated=!1,this.ui.leftActionBar.clear();const n=this._leftButtons.map((a,l)=>ab(a,`id-${l}`,async()=>this.onDidTriggerButtonEmitter.fire(a)));this.ui.leftActionBar.push(n,{icon:!0,label:!1}),this.ui.rightActionBar.clear();const o=this._rightButtons.map((a,l)=>ab(a,`id-${l}`,async()=>this.onDidTriggerButtonEmitter.fire(a)));this.ui.rightActionBar.push(o,{icon:!0,label:!1}),this.ui.inlineActionBar.clear();const r=this._inlineButtons.map((a,l)=>ab(a,`id-${l}`,async()=>this.onDidTriggerButtonEmitter.fire(a)));this.ui.inlineActionBar.push(r,{icon:!0,label:!1})}if(this.togglesUpdated){this.togglesUpdated=!1;const n=this.toggles?.filter(o=>o instanceof Im)??[];this.ui.inputBox.toggles=n}this.ui.ignoreFocusOut=this.ignoreFocusOut,this.ui.setEnabled(this.enabled),this.ui.setContextKey(this.contextKey);const i=this.validationMessage||this.noValidationMessage;this._lastValidationMessage!==i&&(this._lastValidationMessage=i,yn(this.ui.message),pge(i,this.ui.message,{callback:n=>{this.ui.linkOpenerDelegate(n)},disposables:this.visibleDisposables})),this._lastSeverity!==this.severity&&(this._lastSeverity=this.severity,this.showMessageDecoration(this.severity))}getTitle(){return this.title&&this.step?`${this.title} (${this.getSteps()})`:this.title?this.title:this.step?this.getSteps():""}getDescription(){return this.description||""}getSteps(){return this.step&&this.totalSteps?p("quickInput.steps","{0}/{1}",this.step,this.totalSteps):this.step?String(this.step):""}showMessageDecoration(e){if(this.ui.inputBox.showDecoration(e),e!==Di.Ignore){const t=this.ui.inputBox.stylesForType(e);this.ui.message.style.color=t.foreground?`${t.foreground}`:"",this.ui.message.style.backgroundColor=t.background?`${t.background}`:"",this.ui.message.style.border=t.border?`1px solid ${t.border}`:"",this.ui.message.style.marginBottom="-2px"}else this.ui.message.style.color="",this.ui.message.style.backgroundColor="",this.ui.message.style.border="",this.ui.message.style.marginBottom=""}dispose(){this.hide(),this.onDisposeEmitter.fire(),super.dispose()}}class P0 extends ux{constructor(){super(...arguments),this._value="",this.onDidChangeValueEmitter=this._register(new O),this.onWillAcceptEmitter=this._register(new O),this.onDidAcceptEmitter=this._register(new O),this.onDidCustomEmitter=this._register(new O),this._items=[],this.itemsUpdated=!1,this._canSelectMany=!1,this._canAcceptInBackground=!1,this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._keepScrollPosition=!1,this._itemActivation=Ca.FIRST,this._activeItems=[],this.activeItemsUpdated=!1,this.activeItemsToConfirm=[],this.onDidChangeActiveEmitter=this._register(new O),this._selectedItems=[],this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=[],this.onDidChangeSelectionEmitter=this._register(new O),this.onDidTriggerItemButtonEmitter=this._register(new O),this.onDidTriggerSeparatorButtonEmitter=this._register(new O),this.valueSelectionUpdated=!0,this._ok="default",this._customButton=!1,this._focusEventBufferer=new mC,this.type="quickPick",this.filterValue=e=>e,this.onDidChangeValue=this.onDidChangeValueEmitter.event,this.onWillAccept=this.onWillAcceptEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event,this.onDidChangeActive=this.onDidChangeActiveEmitter.event,this.onDidChangeSelection=this.onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this.onDidTriggerItemButtonEmitter.event,this.onDidTriggerSeparatorButton=this.onDidTriggerSeparatorButtonEmitter.event}static{this.DEFAULT_ARIA_LABEL=p("quickInputBox.ariaLabel","Type to narrow down results.")}get quickNavigate(){return this._quickNavigate}set quickNavigate(e){this._quickNavigate=e,this.update()}get value(){return this._value}set value(e){this.doSetValue(e)}doSetValue(e,t){this._value!==e&&(this._value=e,t||this.update(),this.visible&&this.ui.list.filter(this.filterValue(this._value))&&this.trySelectFirst(),this.onDidChangeValueEmitter.fire(this._value))}set ariaLabel(e){this._ariaLabel=e,this.update()}get ariaLabel(){return this._ariaLabel}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get items(){return this._items}get scrollTop(){return this.ui.list.scrollTop}set scrollTop(e){this.ui.list.scrollTop=e}set items(e){this._items=e,this.itemsUpdated=!0,this.update()}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){this._canSelectMany=e,this.update()}get canAcceptInBackground(){return this._canAcceptInBackground}set canAcceptInBackground(e){this._canAcceptInBackground=e}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e,this.update()}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e,this.update()}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e,this.update()}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(e){this._matchOnLabelMode=e,this.update()}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e,this.update()}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(e){this._keepScrollPosition=e}get itemActivation(){return this._itemActivation}set itemActivation(e){this._itemActivation=e}get activeItems(){return this._activeItems}set activeItems(e){this._activeItems=e,this.activeItemsUpdated=!0,this.update()}get selectedItems(){return this._selectedItems}set selectedItems(e){this._selectedItems=e,this.selectedItemsUpdated=!0,this.update()}get keyMods(){return this._quickNavigate?lge:this.ui.keyMods}get valueSelection(){const e=this.ui.inputBox.getSelection();if(e)return[e.start,e.end]}set valueSelection(e){this._valueSelection=e,this.valueSelectionUpdated=!0,this.update()}get customButton(){return this._customButton}set customButton(e){this._customButton=e,this.update()}get customLabel(){return this._customButtonLabel}set customLabel(e){this._customButtonLabel=e,this.update()}get customHover(){return this._customButtonHover}set customHover(e){this._customButtonHover=e,this.update()}get ok(){return this._ok}set ok(e){this._ok=e,this.update()}get hideInput(){return!!this._hideInput}set hideInput(e){this._hideInput=e,this.update()}trySelectFirst(){this.canSelectMany||this.ui.list.focus(zt.First)}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{this.doSetValue(e,!0)})),this.visibleDisposables.add(this.ui.onDidAccept(()=>{this.canSelectMany?this.ui.list.getCheckedElements().length||(this._selectedItems=[],this.onDidChangeSelectionEmitter.fire(this.selectedItems)):this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(!1)})),this.visibleDisposables.add(this.ui.onDidCustom(()=>{this.onDidCustomEmitter.fire()})),this.visibleDisposables.add(this._focusEventBufferer.wrapEvent(this.ui.list.onDidChangeFocus,(e,t)=>t)(e=>{this.activeItemsUpdated||this.activeItemsToConfirm!==this._activeItems&&ii(e,this._activeItems,(t,i)=>t===i)||(this._activeItems=e,this.onDidChangeActiveEmitter.fire(e))})),this.visibleDisposables.add(this.ui.list.onDidChangeSelection(({items:e,event:t})=>{if(this.canSelectMany){e.length&&this.ui.list.setSelectedElements([]);return}this.selectedItemsToConfirm!==this._selectedItems&&ii(e,this._selectedItems,(i,n)=>i===n)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e),e.length&&this.handleAccept(JP(t)&&t.button===1))})),this.visibleDisposables.add(this.ui.list.onChangedCheckedElements(e=>{!this.canSelectMany||!this.visible||this.selectedItemsToConfirm!==this._selectedItems&&ii(e,this._selectedItems,(t,i)=>t===i)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e))})),this.visibleDisposables.add(this.ui.list.onButtonTriggered(e=>this.onDidTriggerItemButtonEmitter.fire(e))),this.visibleDisposables.add(this.ui.list.onSeparatorButtonTriggered(e=>this.onDidTriggerSeparatorButtonEmitter.fire(e))),this.visibleDisposables.add(this.registerQuickNavigation()),this.valueSelectionUpdated=!0),super.show()}handleAccept(e){let t=!1;this.onWillAcceptEmitter.fire({veto:()=>t=!0}),t||this.onDidAcceptEmitter.fire({inBackground:e})}registerQuickNavigation(){return U(this.ui.container,ee.KEY_UP,e=>{if(this.canSelectMany||!this._quickNavigate)return;const t=new Ft(e),i=t.keyCode;this._quickNavigate.keybindings.some(r=>{const a=r.getChords();return a.length>1?!1:a[0].shiftKey&&i===4?!(t.ctrlKey||t.altKey||t.metaKey):!!(a[0].altKey&&i===6||a[0].ctrlKey&&i===5||a[0].metaKey&&i===57)})&&(this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!1)),this._quickNavigate=void 0)})}update(){if(!this.visible)return;const e=this.keepScrollPosition?this.scrollTop:0,t=!!this.description,i={title:!!this.title||!!this.step||!!this.titleButtons.length,description:t,checkAll:this.canSelectMany&&!this._hideCheckAll,checkBox:this.canSelectMany,inputBox:!this._hideInput,progressBar:!this._hideInput||t,visibleCount:!0,count:this.canSelectMany&&!this._hideCountBadge,ok:this.ok==="default"?this.canSelectMany:this.ok,list:!0,message:!!this.validationMessage,customButton:this.customButton};this.ui.setVisibilities(i),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||"");let n=this.ariaLabel;!n&&i.inputBox&&(n=this.placeholder||P0.DEFAULT_ARIA_LABEL,this.title&&(n+=` - ${this.title}`)),this.ui.list.ariaLabel!==n&&(this.ui.list.ariaLabel=n??null),this.ui.list.matchOnDescription=this.matchOnDescription,this.ui.list.matchOnDetail=this.matchOnDetail,this.ui.list.matchOnLabel=this.matchOnLabel,this.ui.list.matchOnLabelMode=this.matchOnLabelMode,this.ui.list.sortByLabel=this.sortByLabel,this.itemsUpdated&&(this.itemsUpdated=!1,this._focusEventBufferer.bufferEvents(()=>{switch(this.ui.list.setElements(this.items),this.ui.list.shouldLoop=!this.canSelectMany,this.ui.list.filter(this.filterValue(this.ui.inputBox.value)),this._itemActivation){case Ca.NONE:this._itemActivation=Ca.FIRST;break;case Ca.SECOND:this.ui.list.focus(zt.Second),this._itemActivation=Ca.FIRST;break;case Ca.LAST:this.ui.list.focus(zt.Last),this._itemActivation=Ca.FIRST;break;default:this.trySelectFirst();break}})),this.ui.container.classList.contains("show-checkboxes")!==!!this.canSelectMany&&(this.canSelectMany?this.ui.list.clearFocus():this.trySelectFirst()),this.activeItemsUpdated&&(this.activeItemsUpdated=!1,this.activeItemsToConfirm=this._activeItems,this.ui.list.setFocusedElements(this.activeItems),this.activeItemsToConfirm===this._activeItems&&(this.activeItemsToConfirm=null)),this.selectedItemsUpdated&&(this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=this._selectedItems,this.canSelectMany?this.ui.list.setCheckedElements(this.selectedItems):this.ui.list.setSelectedElements(this.selectedItems),this.selectedItemsToConfirm===this._selectedItems&&(this.selectedItemsToConfirm=null)),this.ui.customButton.label=this.customLabel||"",this.ui.customButton.element.title=this.customHover||"",i.inputBox||(this.ui.list.domFocus(),this.canSelectMany&&this.ui.list.focus(zt.First)),this.keepScrollPosition&&(this.scrollTop=e)}focus(e){this.ui.list.focus(e),this.canSelectMany&&this.ui.list.domFocus()}accept(e){e&&!this._canAcceptInBackground||this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(e??!1))}}let wge=class extends ux{constructor(){super(...arguments),this._value="",this.valueSelectionUpdated=!0,this._password=!1,this.onDidValueChangeEmitter=this._register(new O),this.onDidAcceptEmitter=this._register(new O),this.type="inputBox",this.onDidChangeValue=this.onDidValueChangeEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event}get value(){return this._value}set value(e){this._value=e||"",this.update()}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get password(){return this._password}set password(e){this._password=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{e!==this.value&&(this._value=e,this.onDidValueChangeEmitter.fire(e))})),this.visibleDisposables.add(this.ui.onDidAccept(()=>this.onDidAcceptEmitter.fire())),this.valueSelectionUpdated=!0),super.show()}update(){if(!this.visible)return;this.ui.container.classList.remove("hidden-input");const e={title:!!this.title||!!this.step||!!this.titleButtons.length,description:!!this.description||!!this.step,inputBox:!0,message:!0,progressBar:!0};this.ui.setVisibilities(e),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||""),this.ui.inputBox.password!==this.password&&(this.ui.inputBox.password=this.password)}},ON=class extends Ep{constructor(e,t){super("element",!1,i=>this.getOverrideOptions(i),e,t)}getOverrideOptions(e){const t=(tn(e.content)?e.content.textContent??"":typeof e.content=="string"?e.content:e.content.value).includes(`
`);return{persistence:{hideOnKeyDown:!1},appearance:{showHoverHint:t,skipFadeInAnimation:!0}}}};ON=mge([bW(0,Ke),bW(1,Vl)],ON);G.white.toString(),G.white.toString();class O0 extends B{get onDidClick(){return this._onDidClick.event}constructor(e,t){super(),this._label="",this._onDidClick=this._register(new O),this._onDidEscape=this._register(new O),this.options=t,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),this._element.classList.toggle("secondary",!!t.secondary);const i=t.secondary?t.buttonSecondaryBackground:t.buttonBackground,n=t.secondary?t.buttonSecondaryForeground:t.buttonForeground;this._element.style.color=n||"",this._element.style.backgroundColor=i||"",t.supportShortLabel&&(this._labelShortElement=document.createElement("div"),this._labelShortElement.classList.add("monaco-button-label-short"),this._element.appendChild(this._labelShortElement),this._labelElement=document.createElement("div"),this._labelElement.classList.add("monaco-button-label"),this._element.appendChild(this._labelElement),this._element.classList.add("monaco-text-button-with-short-label")),typeof t.title=="string"&&this.setTitle(t.title),typeof t.ariaLabel=="string"&&this._element.setAttribute("aria-label",t.ariaLabel),e.appendChild(this._element),this._register(ti.addTarget(this._element)),[ee.CLICK,Wt.Tap].forEach(o=>{this._register(U(this._element,o,r=>{if(!this.enabled){it.stop(r);return}this._onDidClick.fire(r)}))}),this._register(U(this._element,ee.KEY_DOWN,o=>{const r=new Ft(o);let a=!1;this.enabled&&(r.equals(3)||r.equals(10))?(this._onDidClick.fire(o),a=!0):r.equals(9)&&(this._onDidEscape.fire(o),this._element.blur(),a=!0),a&&it.stop(r,!0)})),this._register(U(this._element,ee.MOUSE_OVER,o=>{this._element.classList.contains("disabled")||this.updateBackground(!0)})),this._register(U(this._element,ee.MOUSE_OUT,o=>{this.updateBackground(!1)})),this.focusTracker=this._register(Wa(this._element)),this._register(this.focusTracker.onDidFocus(()=>{this.enabled&&this.updateBackground(!0)})),this._register(this.focusTracker.onDidBlur(()=>{this.enabled&&this.updateBackground(!1)}))}dispose(){super.dispose(),this._element.remove()}getContentElements(e){const t=[];for(let i of Kd(e))if(typeof i=="string"){if(i=i.trim(),i==="")continue;const n=document.createElement("span");n.textContent=i,t.push(n)}else t.push(i);return t}updateBackground(e){let t;this.options.secondary?t=e?this.options.buttonSecondaryHoverBackground:this.options.buttonSecondaryBackground:t=e?this.options.buttonHoverBackground:this.options.buttonBackground,t&&(this._element.style.backgroundColor=t)}get element(){return this._element}set label(e){if(this._label===e||Pa(this._label)&&Pa(e)&&tle(this._label,e))return;this._element.classList.add("monaco-text-button");const t=this.options.supportShortLabel?this._labelElement:this._element;if(Pa(e)){const n=tx(e,{inline:!0});n.dispose();const o=n.element.querySelector("p")?.innerHTML;if(o){const r=U6(o,{ADD_TAGS:["b","i","u","code","span"],ALLOWED_ATTR:["class"],RETURN_TRUSTED_TYPE:!0});t.innerHTML=r}else yn(t)}else this.options.supportIcons?yn(t,...this.getContentElements(e)):t.textContent=e;let i="";typeof this.options.title=="string"?i=this.options.title:this.options.title&&(i=ule(e)),this.setTitle(i),typeof this.options.ariaLabel=="string"?this._element.setAttribute("aria-label",this.options.ariaLabel):this.options.ariaLabel&&this._element.setAttribute("aria-label",i),this._label=e}get label(){return this._label}set icon(e){this._element.classList.add(...Ie.asClassNameArray(e))}set enabled(e){e?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}setTitle(e){!this._hover&&e!==""?this._hover=this._register(Ka().setupManagedHover(this.options.hoverDelegate??Ds("mouse"),this._element,e)):this._hover&&this._hover.update(e)}}class FN{constructor(e,t,i){this.options=t,this.styles=i,this.count=0,this.element=X(e,te(".monaco-count-badge")),this.countFormat=this.options.countFormat||"{0}",this.titleFormat=this.options.titleFormat||"",this.setCount(this.options.count||0)}setCount(e){this.count=e,this.render()}setTitleFormat(e){this.titleFormat=e,this.render()}render(){this.element.textContent=zu(this.countFormat,this.count),this.element.title=zu(this.titleFormat,this.count),this.element.style.backgroundColor=this.styles.badgeBackground??"",this.element.style.color=this.styles.badgeForeground??"",this.styles.badgeBorder&&(this.element.style.border=`1px solid ${this.styles.badgeBorder}`)}}const vW="done",CW="active",PD="infinite",OD="infinite-long-running",yW="discrete";class fO extends B{static{this.LONG_RUNNING_INFINITE_THRESHOLD=1e4}constructor(e,t){super(),this.progressSignal=this._register(new nn),this.workedVal=0,this.showDelayedScheduler=this._register(new It(()=>ro(this.element),0)),this.longRunningScheduler=this._register(new It(()=>this.infiniteLongRunning(),fO.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(e,t)}create(e,t){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),e.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.bit.style.backgroundColor=t?.progressBarBackground||"#0E70C0",this.element.appendChild(this.bit)}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(CW,PD,OD,yW),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel(),this.progressSignal.clear()}stop(){return this.doDone(!1)}doDone(e){return this.element.classList.add(vW),this.element.classList.contains(PD)?(this.bit.style.opacity="0",e?setTimeout(()=>this.off(),200):this.off()):(this.bit.style.width="inherit",e?setTimeout(()=>this.off(),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(yW,vW,OD),this.element.classList.add(CW,PD),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add(OD)}getContainer(){return this.element}}const Sge=p("caseDescription","Match Case"),Lge=p("wordsDescription","Match Whole Word"),xge=p("regexDescription","Use Regular Expression");class ZU extends Im{constructor(e){super({icon:J.caseSensitive,title:Sge+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??Ds("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class KU extends Im{constructor(e){super({icon:J.wholeWord,title:Lge+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??Ds("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class qU extends Im{constructor(e){super({icon:J.regex,title:xge+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??Ds("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class kge{constructor(e,t=0,i=e.length,n=t-1){this.items=e,this.start=t,this.end=i,this.index=n}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}}class Dge{constructor(e=[],t=10){this._initialize(e),this._limit=t,this._onChange()}getHistory(){return this._elements}add(e){this._history.delete(e),this._history.add(e),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(e){return this._history.has(e)}_onChange(){this._reduceToLimit();const e=this._elements;this._navigator=new kge(e,0,e.length,e.length)}_reduceToLimit(){const e=this._elements;e.length>this._limit&&this._initialize(e.slice(e.length-this._limit))}_currentPosition(){const e=this._navigator.current();return e?this._elements.indexOf(e):-1}_initialize(e){this._history=new Set;for(const t of e)this._history.add(t)}get _elements(){const e=[];return this._history.forEach(t=>e.push(t)),e}}const n_=te;class Ige extends Yo{constructor(e,t,i){super(),this.state="idle",this.maxHeight=Number.POSITIVE_INFINITY,this._onDidChange=this._register(new O),this.onDidChange=this._onDidChange.event,this._onDidHeightChange=this._register(new O),this.onDidHeightChange=this._onDidHeightChange.event,this.contextViewProvider=t,this.options=i,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=this.options.tooltip??(this.placeholder||""),this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=X(e,n_(".monaco-inputbox.idle"));const n=this.options.flexibleHeight?"textarea":"input",o=X(this.element,n_(".ibwrapper"));if(this.input=X(o,n_(n+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=X(o,n_("div.mirror")),this.mirror.innerText="",this.scrollableElement=new Cz(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),X(e,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(l=>this.input.scrollTop=l.scrollTop));const r=this._register(new tt(e.ownerDocument,"selectionchange")),a=se.filter(r.event,()=>e.ownerDocument.getSelection()?.anchorNode===o);this._register(a(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this._register(this.ignoreGesture(this.input)),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new zo(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(e){this.placeholder=e,this.input.setAttribute("placeholder",e)}setTooltip(e){this.tooltip=e,this.hover?this.hover.update(e):this.hover=this._register(Ka().setupManagedHover(Ds("mouse"),this.input,e))}get inputElement(){return this.input}get value(){return this.input.value}set value(e){this.input.value!==e&&(this.input.value=e,this.onValueChange())}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:Cc(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return LL(this.input)}select(e=null){this.input.select(),e&&(this.input.setSelectionRange(e.start,e.end),e.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}getSelection(){const e=this.input.selectionStart;if(e===null)return null;const t=this.input.selectionEnd??e;return{start:e,end:t}}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}set paddingRight(e){this.input.style.width=`calc(100% - ${e}px)`,this.mirror&&(this.mirror.style.paddingRight=e+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;const e=this.cachedContentHeight,t=this.cachedHeight,i=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:e,height:t}),this.scrollableElement.setScrollPosition({scrollTop:i})}showMessage(e,t){if(this.state==="open"&&co(this.message,e))return;this.message=e,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(e.type));const i=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${Ec(i.border,"transparent")}`,this.message.content&&(this.hasFocus()||t)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}validate(){let e=null;return this.validation&&(e=this.validation(this.value),e?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(e)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),e?.type}stylesForType(e){const t=this.options.inputBoxStyles;switch(e){case 1:return{border:t.inputValidationInfoBorder,background:t.inputValidationInfoBackground,foreground:t.inputValidationInfoForeground};case 2:return{border:t.inputValidationWarningBorder,background:t.inputValidationWarningBackground,foreground:t.inputValidationWarningForeground};default:return{border:t.inputValidationErrorBorder,background:t.inputValidationErrorBackground,foreground:t.inputValidationErrorForeground}}}classForType(e){switch(e){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let e;const t=()=>e.style.width=io(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:n=>{if(!this.message)return null;e=X(n,n_(".monaco-inputbox-container")),t();const o={inline:!0,className:"monaco-inputbox-message"},r=this.message.formatContent?vae(this.message.content,o):bae(this.message.content,o);r.classList.add(this.classForType(this.message.type));const a=this.stylesForType(this.message.type);return r.style.backgroundColor=a.background??"",r.style.color=a.foreground??"",r.style.border=a.border?`1px solid ${a.border}`:"",X(e,r),null},onHide:()=>{this.state="closed"},layout:t});let i;this.message.type===3?i=p("alertErrorMessage","Error: {0}",this.message.content):this.message.type===2?i=p("alertWarningMessage","Warning: {0}",this.message.content):i=p("alertInfoMessage","Info: {0}",this.message.content),Ls(i),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;const e=this.value,i=e.charCodeAt(e.length-1)===10?" ":"";(e+i).replace(/\u000c/g,"")?this.mirror.textContent=e+i:this.mirror.innerText="",this.layout()}applyStyles(){const e=this.options.inputBoxStyles,t=e.inputBackground??"",i=e.inputForeground??"",n=e.inputBorder??"";this.element.style.backgroundColor=t,this.element.style.color=i,this.input.style.backgroundColor="inherit",this.input.style.color=i,this.element.style.border=`1px solid ${Ec(n,"transparent")}`}layout(){if(!this.mirror)return;const e=this.cachedContentHeight;this.cachedContentHeight=Cc(this.mirror),e!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(e){const t=this.inputElement,i=t.selectionStart,n=t.selectionEnd,o=t.value;i!==null&&n!==null&&(this.value=o.substr(0,i)+e+o.substr(n),t.setSelectionRange(i+1,i+1),this.layout())}dispose(){this._hideMessage(),this.message=null,this.actionbar?.dispose(),super.dispose()}}class GU extends Ige{constructor(e,t,i){const n=p({key:"history.inputbox.hint.suffix.noparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field ends in a closing parenthesis ")", for example "Filter (e.g. text, !exclude)". The character inserted into the final string is  to represent the up and down arrow keys.']}," or {0} for history",""),o=p({key:"history.inputbox.hint.suffix.inparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field does NOT end in a closing parenthesis (eg. "Find"). The character inserted into the final string is  to represent the up and down arrow keys.']}," ({0} for history)","");super(e,t,i),this._onDidFocus=this._register(new O),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new O),this.onDidBlur=this._onDidBlur.event,this.history=new Dge(i.history,100);const r=()=>{if(i.showHistoryHint&&i.showHistoryHint()&&!this.placeholder.endsWith(n)&&!this.placeholder.endsWith(o)&&this.history.getHistory().length){const a=this.placeholder.endsWith(")")?n:o,l=this.placeholder+a;i.showPlaceholderOnFocus&&!LL(this.input)?this.placeholder=l:this.setPlaceHolder(l)}};this.observer=new MutationObserver((a,l)=>{a.forEach(c=>{c.target.textContent||r()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>r()),this.onblur(this.input,()=>{const a=l=>{if(this.placeholder.endsWith(l)){const c=this.placeholder.slice(0,this.placeholder.length-l.length);return i.showPlaceholderOnFocus?this.placeholder=c:this.setPlaceHolder(c),!0}else return!1};a(o)||a(n)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(e){this.value&&(e||this.value!==this.getCurrentValue())&&this.history.add(this.value)}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let e=this.getNextValue();e&&(e=e===this.value?this.getNextValue():e),this.value=e??"",Nl(this.value?this.value:p("clearedInput","Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let e=this.getPreviousValue();e&&(e=e===this.value?this.getPreviousValue():e),e&&(this.value=e,Nl(this.value))}setPlaceHolder(e){super.setPlaceHolder(e),this.setTooltip(e)}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let e=this.history.current();return e||(e=this.history.last(),this.history.next()),e}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}}const Tge=p("defaultLabel","input");class YU extends Yo{constructor(e,t,i){super(),this.fixFocusOnOptionClickEnabled=!0,this.imeSessionInProgress=!1,this.additionalTogglesDisposables=this._register(new nn),this.additionalToggles=[],this._onDidOptionChange=this._register(new O),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new O),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new O),this.onMouseDown=this._onMouseDown.event,this._onInput=this._register(new O),this._onKeyUp=this._register(new O),this._onCaseSensitiveKeyDown=this._register(new O),this.onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event,this._onRegexKeyDown=this._register(new O),this.onRegexKeyDown=this._onRegexKeyDown.event,this._lastHighlightFindOptions=0,this.placeholder=i.placeholder||"",this.validation=i.validation,this.label=i.label||Tge,this.showCommonFindToggles=!!i.showCommonFindToggles;const n=i.appendCaseSensitiveLabel||"",o=i.appendWholeWordsLabel||"",r=i.appendRegexLabel||"",a=i.history||[],l=!!i.flexibleHeight,c=!!i.flexibleWidth,d=i.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new GU(this.domNode,t,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:i.showHistoryHint,flexibleHeight:l,flexibleWidth:c,flexibleMaxHeight:d,inputBoxStyles:i.inputBoxStyles}));const h=this._register(Fp());if(this.showCommonFindToggles){this.regex=this._register(new qU({appendTitle:r,isChecked:!1,hoverDelegate:h,...i.toggleStyles})),this._register(this.regex.onChange(g=>{this._onDidOptionChange.fire(g),!g&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(g=>{this._onRegexKeyDown.fire(g)})),this.wholeWords=this._register(new KU({appendTitle:o,isChecked:!1,hoverDelegate:h,...i.toggleStyles})),this._register(this.wholeWords.onChange(g=>{this._onDidOptionChange.fire(g),!g&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new ZU({appendTitle:n,isChecked:!1,hoverDelegate:h,...i.toggleStyles})),this._register(this.caseSensitive.onChange(g=>{this._onDidOptionChange.fire(g),!g&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(g=>{this._onCaseSensitiveKeyDown.fire(g)}));const u=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,g=>{if(g.equals(15)||g.equals(17)||g.equals(9)){const f=u.indexOf(this.domNode.ownerDocument.activeElement);if(f>=0){let m=-1;g.equals(17)?m=(f+1)%u.length:g.equals(15)&&(f===0?m=u.length-1:m=f-1),g.equals(9)?(u[f].blur(),this.inputBox.focus()):m>=0&&u[m].focus(),it.stop(g,!0)}}})}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(i?.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),e?.appendChild(this.domNode),this._register(U(this.inputBox.inputElement,"compositionstart",u=>{this.imeSessionInProgress=!0})),this._register(U(this.inputBox.inputElement,"compositionend",u=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,u=>this._onKeyDown.fire(u)),this.onkeyup(this.inputBox.inputElement,u=>this._onKeyUp.fire(u)),this.oninput(this.inputBox.inputElement,u=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,u=>this._onMouseDown.fire(u))}get onDidChange(){return this.inputBox.onDidChange}layout(e){this.inputBox.layout(),this.updateInputBoxPadding(e.collapsedFindWidget)}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.regex?.enable(),this.wholeWords?.enable(),this.caseSensitive?.enable();for(const e of this.additionalToggles)e.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.regex?.disable(),this.wholeWords?.disable(),this.caseSensitive?.disable();for(const e of this.additionalToggles)e.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}setAdditionalToggles(e){for(const t of this.additionalToggles)t.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.value=new Z;for(const t of e??[])this.additionalTogglesDisposables.value.add(t),this.controls.appendChild(t.domNode),this.additionalTogglesDisposables.value.add(t.onChange(i=>{this._onDidOptionChange.fire(i),!i&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()})),this.additionalToggles.push(t);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(e=!1){e?this.inputBox.paddingRight=0:this.inputBox.paddingRight=(this.caseSensitive?.width()??0)+(this.wholeWords?.width()??0)+(this.regex?.width()??0)+this.additionalToggles.reduce((t,i)=>t+i.width(),0)}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){return this.caseSensitive?.checked??!1}setCaseSensitive(e){this.caseSensitive&&(this.caseSensitive.checked=e)}getWholeWords(){return this.wholeWords?.checked??!1}setWholeWords(e){this.wholeWords&&(this.wholeWords.checked=e)}getRegex(){return this.regex?.checked??!1}setRegex(e){this.regex&&(this.regex.checked=e,this.validate())}focusOnCaseSensitive(){this.caseSensitive?.focus()}highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(e){this.inputBox.showMessage(e)}clearMessage(){this.inputBox.hideMessage()}}const Ege=te;class Nge extends B{constructor(e,t,i){super(),this.parent=e,this.onKeyDown=o=>gi(this.findInput.inputBox.inputElement,ee.KEY_DOWN,o),this.onDidChange=o=>this.findInput.onDidChange(o),this.container=X(this.parent,Ege(".quick-input-box")),this.findInput=this._register(new YU(this.container,void 0,{label:"",inputBoxStyles:t,toggleStyles:i}));const n=this.findInput.inputBox.inputElement;n.role="combobox",n.ariaHasPopup="menu",n.ariaAutoComplete="list",n.ariaExpanded="true"}get value(){return this.findInput.getValue()}set value(e){this.findInput.setValue(e)}select(e=null){this.findInput.inputBox.select(e)}getSelection(){return this.findInput.inputBox.getSelection()}isSelectionAtEnd(){return this.findInput.inputBox.isSelectionAtEnd()}get placeholder(){return this.findInput.inputBox.inputElement.getAttribute("placeholder")||""}set placeholder(e){this.findInput.inputBox.setPlaceHolder(e)}get password(){return this.findInput.inputBox.inputElement.type==="password"}set password(e){this.findInput.inputBox.inputElement.type=e?"password":"text"}set enabled(e){this.findInput.inputBox.inputElement.toggleAttribute("readonly",!e)}set toggles(e){this.findInput.setAdditionalToggles(e)}setAttribute(e,t){this.findInput.inputBox.inputElement.setAttribute(e,t)}showDecoration(e){e===Di.Ignore?this.findInput.clearMessage():this.findInput.showMessage({type:e===Di.Info?1:e===Di.Warning?2:3,content:""})}stylesForType(e){return this.findInput.inputBox.stylesForType(e===Di.Info?1:e===Di.Warning?2:3)}setFocus(){this.findInput.focus()}layout(){this.findInput.inputBox.layout()}}class Rge{get templateId(){return this.renderer.templateId}constructor(e,t){this.renderer=e,this.modelProvider=t}renderTemplate(e){return{data:this.renderer.renderTemplate(e),disposable:B.None}}renderElement(e,t,i,n){if(i.disposable?.dispose(),!i.data)return;const o=this.modelProvider();if(o.isResolved(e))return this.renderer.renderElement(o.get(e),e,i.data,n);const r=new li,a=o.resolve(e,r.token);i.disposable={dispose:()=>r.cancel()},this.renderer.renderPlaceholder(e,i.data),a.then(l=>this.renderer.renderElement(l,e,i.data,n))}disposeTemplate(e){e.disposable&&(e.disposable.dispose(),e.disposable=void 0),e.data&&(this.renderer.disposeTemplate(e.data),e.data=void 0)}}class Mge{constructor(e,t){this.modelProvider=e,this.accessibilityProvider=t}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(e){const t=this.modelProvider();return t.isResolved(e)?this.accessibilityProvider.getAriaLabel(t.get(e)):null}}function Age(s,e){return{...e,accessibilityProvider:e.accessibilityProvider&&new Mge(s,e.accessibilityProvider)}}class Pge{constructor(e,t,i,n,o={}){const r=()=>this.model,a=n.map(l=>new Rge(l,r));this.list=new Xo(e,t,i,a,Age(r,o))}updateOptions(e){this.list.updateOptions(e)}getHTMLElement(){return this.list.getHTMLElement()}get onDidFocus(){return this.list.onDidFocus}get widget(){return this.list}get onDidDispose(){return this.list.onDidDispose}get onMouseDblClick(){return se.map(this.list.onMouseDblClick,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onPointer(){return se.map(this.list.onPointer,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onDidChangeSelection(){return se.map(this.list.onDidChangeSelection,({elements:e,indexes:t,browserEvent:i})=>({elements:e.map(n=>this._model.get(n)),indexes:t,browserEvent:i}))}get model(){return this._model}set model(e){this._model=e,this.list.splice(0,this.list.length,As(e.length))}getFocus(){return this.list.getFocus()}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map(e=>this.model.get(e))}style(e){this.list.style(e)}dispose(){this.list.dispose()}}var Tm=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o};const Oge=!1;var F0;(function(s){s.North="north",s.South="south",s.East="east",s.West="west"})(F0||(F0={}));let Fge=4;const Bge=new O;let Wge=300;const Hge=new O;class pO{constructor(e){this.el=e,this.disposables=new Z}get onPointerMove(){return this.disposables.add(new tt(ke(this.el),"mousemove")).event}get onPointerUp(){return this.disposables.add(new tt(ke(this.el),"mouseup")).event}dispose(){this.disposables.dispose()}}Tm([Ti],pO.prototype,"onPointerMove",null);Tm([Ti],pO.prototype,"onPointerUp",null);class mO{get onPointerMove(){return this.disposables.add(new tt(this.el,Wt.Change)).event}get onPointerUp(){return this.disposables.add(new tt(this.el,Wt.End)).event}constructor(e){this.el=e,this.disposables=new Z}dispose(){this.disposables.dispose()}}Tm([Ti],mO.prototype,"onPointerMove",null);Tm([Ti],mO.prototype,"onPointerUp",null);class B0{get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}constructor(e){this.factory=e}dispose(){}}Tm([Ti],B0.prototype,"onPointerMove",null);Tm([Ti],B0.prototype,"onPointerUp",null);const wW="pointer-events-disabled";class Hn extends B{get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(e){this._state!==e&&(this.el.classList.toggle("disabled",e===0),this.el.classList.toggle("minimum",e===1),this.el.classList.toggle("maximum",e===2),this._state=e,this.onDidEnablementChange.fire(e))}set orthogonalStartSash(e){if(this._orthogonalStartSash!==e){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),e){const t=i=>{this.orthogonalStartDragHandleDisposables.clear(),i!==0&&(this._orthogonalStartDragHandle=X(this.el,te(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(Ce(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(new tt(this._orthogonalStartDragHandle,"mouseenter")).event(()=>Hn.onMouseEnter(e),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new tt(this._orthogonalStartDragHandle,"mouseleave")).event(()=>Hn.onMouseLeave(e),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalStartSash=e}}set orthogonalEndSash(e){if(this._orthogonalEndSash!==e){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),e){const t=i=>{this.orthogonalEndDragHandleDisposables.clear(),i!==0&&(this._orthogonalEndDragHandle=X(this.el,te(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(Ce(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(new tt(this._orthogonalEndDragHandle,"mouseenter")).event(()=>Hn.onMouseEnter(e),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new tt(this._orthogonalEndDragHandle,"mouseleave")).event(()=>Hn.onMouseLeave(e),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalEndSash=e}}constructor(e,t,i){super(),this.hoverDelay=Wge,this.hoverDelayer=this._register(new Cr(this.hoverDelay)),this._state=3,this.onDidEnablementChange=this._register(new O),this._onDidStart=this._register(new O),this._onDidChange=this._register(new O),this._onDidReset=this._register(new O),this._onDidEnd=this._register(new O),this.orthogonalStartSashDisposables=this._register(new Z),this.orthogonalStartDragHandleDisposables=this._register(new Z),this.orthogonalEndSashDisposables=this._register(new Z),this.orthogonalEndDragHandleDisposables=this._register(new Z),this.onDidStart=this._onDidStart.event,this.onDidChange=this._onDidChange.event,this.onDidReset=this._onDidReset.event,this.onDidEnd=this._onDidEnd.event,this.linkedSash=void 0,this.el=X(e,te(".monaco-sash")),i.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${i.orthogonalEdge}`),Qe&&this.el.classList.add("mac");const n=this._register(new tt(this.el,"mousedown")).event;this._register(n(h=>this.onPointerStart(h,new pO(e)),this));const o=this._register(new tt(this.el,"dblclick")).event;this._register(o(this.onPointerDoublePress,this));const r=this._register(new tt(this.el,"mouseenter")).event;this._register(r(()=>Hn.onMouseEnter(this)));const a=this._register(new tt(this.el,"mouseleave")).event;this._register(a(()=>Hn.onMouseLeave(this))),this._register(ti.addTarget(this.el));const l=this._register(new tt(this.el,Wt.Start)).event;this._register(l(h=>this.onPointerStart(h,new mO(this.el)),this));const c=this._register(new tt(this.el,Wt.Tap)).event;let d;this._register(c(h=>{if(d){clearTimeout(d),d=void 0,this.onPointerDoublePress(h);return}clearTimeout(d),d=setTimeout(()=>d=void 0,250)},this)),typeof i.size=="number"?(this.size=i.size,i.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=Fge,this._register(Bge.event(h=>{this.size=h,this.layout()}))),this._register(Hge.event(h=>this.hoverDelay=h)),this.layoutProvider=t,this.orthogonalStartSash=i.orthogonalStartSash,this.orthogonalEndSash=i.orthogonalEndSash,this.orientation=i.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",Oge),this.layout()}onPointerStart(e,t){it.stop(e);let i=!1;if(!e.__orthogonalSashEvent){const f=this.getOrthogonalSash(e);f&&(i=!0,e.__orthogonalSashEvent=!0,f.onPointerStart(e,new B0(t)))}if(this.linkedSash&&!e.__linkedSashEvent&&(e.__linkedSashEvent=!0,this.linkedSash.onPointerStart(e,new B0(t))),!this.state)return;const n=this.el.ownerDocument.getElementsByTagName("iframe");for(const f of n)f.classList.add(wW);const o=e.pageX,r=e.pageY,a=e.altKey,l={startX:o,currentX:o,startY:r,currentY:r,altKey:a};this.el.classList.add("active"),this._onDidStart.fire(l);const c=$o(this.el),d=()=>{let f="";i?f="all-scroll":this.orientation===1?this.state===1?f="s-resize":this.state===2?f="n-resize":f=Qe?"row-resize":"ns-resize":this.state===1?f="e-resize":this.state===2?f="w-resize":f=Qe?"col-resize":"ew-resize",c.textContent=`* { cursor: ${f} !important; }`},h=new Z;d(),i||this.onDidEnablementChange.event(d,null,h);const u=f=>{it.stop(f,!1);const m={startX:o,currentX:f.pageX,startY:r,currentY:f.pageY,altKey:a};this._onDidChange.fire(m)},g=f=>{it.stop(f,!1),c.remove(),this.el.classList.remove("active"),this._onDidEnd.fire(),h.dispose();for(const m of n)m.classList.remove(wW)};t.onPointerMove(u,null,h),t.onPointerUp(g,null,h),h.add(t)}onPointerDoublePress(e){const t=this.getOrthogonalSash(e);t&&t._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(e,t=!1){e.el.classList.contains("active")?(e.hoverDelayer.cancel(),e.el.classList.add("hover")):e.hoverDelayer.trigger(()=>e.el.classList.add("hover"),e.hoverDelay).then(void 0,()=>{}),!t&&e.linkedSash&&Hn.onMouseEnter(e.linkedSash,!0)}static onMouseLeave(e,t=!1){e.hoverDelayer.cancel(),e.el.classList.remove("hover"),!t&&e.linkedSash&&Hn.onMouseLeave(e.linkedSash,!0)}clearSashHoverState(){Hn.onMouseLeave(this)}layout(){if(this.orientation===0){const e=this.layoutProvider;this.el.style.left=e.getVerticalSashLeft(this)-this.size/2+"px",e.getVerticalSashTop&&(this.el.style.top=e.getVerticalSashTop(this)+"px"),e.getVerticalSashHeight&&(this.el.style.height=e.getVerticalSashHeight(this)+"px")}else{const e=this.layoutProvider;this.el.style.top=e.getHorizontalSashTop(this)-this.size/2+"px",e.getHorizontalSashLeft&&(this.el.style.left=e.getHorizontalSashLeft(this)+"px"),e.getHorizontalSashWidth&&(this.el.style.width=e.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(e){const t=e.initialTarget??e.target;if(!(!t||!tn(t))&&t.classList.contains("orthogonal-drag-handle"))return t.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}}const Vge={separatorBorder:G.transparent};class XU{set size(e){this._size=e}get size(){return this._size}get visible(){return typeof this._cachedVisibleSize>"u"}setVisible(e,t){if(e!==this.visible){e?(this.size=cs(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof t=="number"?t:this.size,this.size=0),this.container.classList.toggle("visible",e);try{this.view.setVisible?.(e)}catch(i){console.error("Splitview: Failed to set visible view"),console.error(i)}}}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return!!this.view.snap}set enabled(e){this.container.style.pointerEvents=e?"":"none"}constructor(e,t,i,n){this.container=e,this.view=t,this.disposable=n,this._cachedVisibleSize=void 0,typeof i=="number"?(this._size=i,this._cachedVisibleSize=void 0,e.classList.add("visible")):(this._size=0,this._cachedVisibleSize=i.cachedVisibleSize)}layout(e,t){this.layoutContainer(e);try{this.view.layout(this.size,e,t)}catch(i){console.error("Splitview: Failed to layout view"),console.error(i)}}dispose(){this.disposable.dispose()}}class zge extends XU{layoutContainer(e){this.container.style.top=`${e}px`,this.container.style.height=`${this.size}px`}}class Uge extends XU{layoutContainer(e){this.container.style.left=`${e}px`,this.container.style.width=`${this.size}px`}}var oc;(function(s){s[s.Idle=0]="Idle",s[s.Busy=1]="Busy"})(oc||(oc={}));var W0;(function(s){s.Distribute={type:"distribute"};function e(n){return{type:"split",index:n}}s.Split=e;function t(n){return{type:"auto",index:n}}s.Auto=t;function i(n){return{type:"invisible",cachedVisibleSize:n}}s.Invisible=i})(W0||(W0={}));class QU extends B{get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(e){for(const t of this.sashItems)t.sash.orthogonalStartSash=e;this._orthogonalStartSash=e}set orthogonalEndSash(e){for(const t of this.sashItems)t.sash.orthogonalEndSash=e;this._orthogonalEndSash=e}set startSnappingEnabled(e){this._startSnappingEnabled!==e&&(this._startSnappingEnabled=e,this.updateSashEnablement())}set endSnappingEnabled(e){this._endSnappingEnabled!==e&&(this._endSnappingEnabled=e,this.updateSashEnablement())}constructor(e,t={}){super(),this.size=0,this._contentSize=0,this.proportions=void 0,this.viewItems=[],this.sashItems=[],this.state=oc.Idle,this._onDidSashChange=this._register(new O),this._onDidSashReset=this._register(new O),this._startSnappingEnabled=!0,this._endSnappingEnabled=!0,this.onDidSashChange=this._onDidSashChange.event,this.onDidSashReset=this._onDidSashReset.event,this.orientation=t.orientation??0,this.inverseAltBehavior=t.inverseAltBehavior??!1,this.proportionalLayout=t.proportionalLayout??!0,this.getSashOrthogonalSize=t.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(this.orientation===0?"vertical":"horizontal"),e.appendChild(this.el),this.sashContainer=X(this.el,te(".sash-container")),this.viewContainer=te(".split-view-container"),this.scrollable=this._register(new Sm({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame:n=>mo(ke(this.el),n)})),this.scrollableElement=this._register(new YL(this.viewContainer,{vertical:this.orientation===0?t.scrollbarVisibility??1:2,horizontal:this.orientation===1?t.scrollbarVisibility??1:2},this.scrollable));const i=this._register(new tt(this.viewContainer,"scroll")).event;this._register(i(n=>{const o=this.scrollableElement.getScrollPosition(),r=Math.abs(this.viewContainer.scrollLeft-o.scrollLeft)<=1?void 0:this.viewContainer.scrollLeft,a=Math.abs(this.viewContainer.scrollTop-o.scrollTop)<=1?void 0:this.viewContainer.scrollTop;(r!==void 0||a!==void 0)&&this.scrollableElement.setScrollPosition({scrollLeft:r,scrollTop:a})})),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll(n=>{n.scrollTopChanged&&(this.viewContainer.scrollTop=n.scrollTop),n.scrollLeftChanged&&(this.viewContainer.scrollLeft=n.scrollLeft)})),X(this.el,this.scrollableElement.getDomNode()),this.style(t.styles||Vge),t.descriptor&&(this.size=t.descriptor.size,t.descriptor.views.forEach((n,o)=>{const r=ns(n.visible)||n.visible?n.size:{type:"invisible",cachedVisibleSize:n.size},a=n.view;this.doAddView(a,r,o,!0)}),this._contentSize=this.viewItems.reduce((n,o)=>n+o.size,0),this.saveProportions())}style(e){e.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",e.separatorBorder.toString()))}addView(e,t,i=this.viewItems.length,n){this.doAddView(e,t,i,n)}layout(e,t){const i=Math.max(this.size,this._contentSize);if(this.size=e,this.layoutContext=t,this.proportions){let n=0;for(let o=0;o<this.viewItems.length;o++){const r=this.viewItems[o],a=this.proportions[o];typeof a=="number"?n+=a:e-=r.size}for(let o=0;o<this.viewItems.length;o++){const r=this.viewItems[o],a=this.proportions[o];typeof a=="number"&&n>0&&(r.size=cs(Math.round(a*e/n),r.minimumSize,r.maximumSize))}}else{const n=As(this.viewItems.length),o=n.filter(a=>this.viewItems[a].priority===1),r=n.filter(a=>this.viewItems[a].priority===2);this.resize(this.viewItems.length-1,e-i,void 0,o,r)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this._contentSize>0&&(this.proportions=this.viewItems.map(e=>e.proportionalLayout&&e.visible?e.size/this._contentSize:void 0))}onSashStart({sash:e,start:t,alt:i}){for(const a of this.viewItems)a.enabled=!1;const n=this.sashItems.findIndex(a=>a.sash===e),o=Gr(U(this.el.ownerDocument.body,"keydown",a=>r(this.sashDragState.current,a.altKey)),U(this.el.ownerDocument.body,"keyup",()=>r(this.sashDragState.current,!1))),r=(a,l)=>{const c=this.viewItems.map(f=>f.size);let d=Number.NEGATIVE_INFINITY,h=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(l=!l),l)if(n===this.sashItems.length-1){const m=this.viewItems[n];d=(m.minimumSize-m.size)/2,h=(m.maximumSize-m.size)/2}else{const m=this.viewItems[n+1];d=(m.size-m.maximumSize)/2,h=(m.size-m.minimumSize)/2}let u,g;if(!l){const f=As(n,-1),m=As(n+1,this.viewItems.length),_=f.reduce((D,T)=>D+(this.viewItems[T].minimumSize-c[T]),0),b=f.reduce((D,T)=>D+(this.viewItems[T].viewMaximumSize-c[T]),0),v=m.length===0?Number.POSITIVE_INFINITY:m.reduce((D,T)=>D+(c[T]-this.viewItems[T].minimumSize),0),C=m.length===0?Number.NEGATIVE_INFINITY:m.reduce((D,T)=>D+(c[T]-this.viewItems[T].viewMaximumSize),0),y=Math.max(_,C),w=Math.min(v,b),x=this.findFirstSnapIndex(f),L=this.findFirstSnapIndex(m);if(typeof x=="number"){const D=this.viewItems[x],T=Math.floor(D.viewMinimumSize/2);u={index:x,limitDelta:D.visible?y-T:y+T,size:D.size}}if(typeof L=="number"){const D=this.viewItems[L],T=Math.floor(D.viewMinimumSize/2);g={index:L,limitDelta:D.visible?w+T:w-T,size:D.size}}}this.sashDragState={start:a,current:a,index:n,sizes:c,minDelta:d,maxDelta:h,alt:l,snapBefore:u,snapAfter:g,disposable:o}};r(t,i)}onSashChange({current:e}){const{index:t,start:i,sizes:n,alt:o,minDelta:r,maxDelta:a,snapBefore:l,snapAfter:c}=this.sashDragState;this.sashDragState.current=e;const d=e-i,h=this.resize(t,d,n,void 0,void 0,r,a,l,c);if(o){const u=t===this.sashItems.length-1,g=this.viewItems.map(C=>C.size),f=u?t:t+1,m=this.viewItems[f],_=m.size-m.maximumSize,b=m.size-m.minimumSize,v=u?t-1:t+1;this.resize(v,-h,g,void 0,void 0,_,b)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(e){this._onDidSashChange.fire(e),this.sashDragState.disposable.dispose(),this.saveProportions();for(const t of this.viewItems)t.enabled=!0}onViewChange(e,t){const i=this.viewItems.indexOf(e);i<0||i>=this.viewItems.length||(t=typeof t=="number"?t:e.size,t=cs(t,e.minimumSize,e.maximumSize),this.inverseAltBehavior&&i>0?(this.resize(i-1,Math.floor((e.size-t)/2)),this.distributeEmptySpace(),this.layoutViews()):(e.size=t,this.relayout([i],void 0)))}resizeView(e,t){if(!(e<0||e>=this.viewItems.length)){if(this.state!==oc.Idle)throw new Error("Cant modify splitview");this.state=oc.Busy;try{const i=As(this.viewItems.length).filter(a=>a!==e),n=[...i.filter(a=>this.viewItems[a].priority===1),e],o=i.filter(a=>this.viewItems[a].priority===2),r=this.viewItems[e];t=Math.round(t),t=cs(t,r.minimumSize,Math.min(r.maximumSize,this.size)),r.size=t,this.relayout(n,o)}finally{this.state=oc.Idle}}}distributeViewSizes(){const e=[];let t=0;for(const a of this.viewItems)a.maximumSize-a.minimumSize>0&&(e.push(a),t+=a.size);const i=Math.floor(t/e.length);for(const a of e)a.size=cs(i,a.minimumSize,a.maximumSize);const n=As(this.viewItems.length),o=n.filter(a=>this.viewItems[a].priority===1),r=n.filter(a=>this.viewItems[a].priority===2);this.relayout(o,r)}getViewSize(e){return e<0||e>=this.viewItems.length?-1:this.viewItems[e].size}doAddView(e,t,i=this.viewItems.length,n){if(this.state!==oc.Idle)throw new Error("Cant modify splitview");this.state=oc.Busy;try{const o=te(".split-view-view");i===this.viewItems.length?this.viewContainer.appendChild(o):this.viewContainer.insertBefore(o,this.viewContainer.children.item(i));const r=e.onDidChange(u=>this.onViewChange(d,u)),a=Ce(()=>o.remove()),l=Gr(r,a);let c;typeof t=="number"?c=t:(t.type==="auto"&&(this.areViewsDistributed()?t={type:"distribute"}:t={type:"split",index:t.index}),t.type==="split"?c=this.getViewSize(t.index)/2:t.type==="invisible"?c={cachedVisibleSize:t.cachedVisibleSize}:c=e.minimumSize);const d=this.orientation===0?new zge(o,e,c,l):new Uge(o,e,c,l);if(this.viewItems.splice(i,0,d),this.viewItems.length>1){const u={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash},g=this.orientation===0?new Hn(this.sashContainer,{getHorizontalSashTop:D=>this.getSashPosition(D),getHorizontalSashWidth:this.getSashOrthogonalSize},{...u,orientation:1}):new Hn(this.sashContainer,{getVerticalSashLeft:D=>this.getSashPosition(D),getVerticalSashHeight:this.getSashOrthogonalSize},{...u,orientation:0}),f=this.orientation===0?D=>({sash:g,start:D.startY,current:D.currentY,alt:D.altKey}):D=>({sash:g,start:D.startX,current:D.currentX,alt:D.altKey}),_=se.map(g.onDidStart,f)(this.onSashStart,this),v=se.map(g.onDidChange,f)(this.onSashChange,this),y=se.map(g.onDidEnd,()=>this.sashItems.findIndex(D=>D.sash===g))(this.onSashEnd,this),w=g.onDidReset(()=>{const D=this.sashItems.findIndex($=>$.sash===g),T=As(D,-1),F=As(D+1,this.viewItems.length),W=this.findFirstSnapIndex(T),H=this.findFirstSnapIndex(F);typeof W=="number"&&!this.viewItems[W].visible||typeof H=="number"&&!this.viewItems[H].visible||this._onDidSashReset.fire(D)}),x=Gr(_,v,y,w,g),L={sash:g,disposable:x};this.sashItems.splice(i-1,0,L)}o.appendChild(e.element);let h;typeof t!="number"&&t.type==="split"&&(h=[t.index]),n||this.relayout([i],h),!n&&typeof t!="number"&&t.type==="distribute"&&this.distributeViewSizes()}finally{this.state=oc.Idle}}relayout(e,t){const i=this.viewItems.reduce((n,o)=>n+o.size,0);this.resize(this.viewItems.length-1,this.size-i,void 0,e,t),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(e,t,i=this.viewItems.map(d=>d.size),n,o,r=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,l,c){if(e<0||e>=this.viewItems.length)return 0;const d=As(e,-1),h=As(e+1,this.viewItems.length);if(o)for(const L of o)Rk(d,L),Rk(h,L);if(n)for(const L of n)gy(d,L),gy(h,L);const u=d.map(L=>this.viewItems[L]),g=d.map(L=>i[L]),f=h.map(L=>this.viewItems[L]),m=h.map(L=>i[L]),_=d.reduce((L,D)=>L+(this.viewItems[D].minimumSize-i[D]),0),b=d.reduce((L,D)=>L+(this.viewItems[D].maximumSize-i[D]),0),v=h.length===0?Number.POSITIVE_INFINITY:h.reduce((L,D)=>L+(i[D]-this.viewItems[D].minimumSize),0),C=h.length===0?Number.NEGATIVE_INFINITY:h.reduce((L,D)=>L+(i[D]-this.viewItems[D].maximumSize),0),y=Math.max(_,C,r),w=Math.min(v,b,a);let x=!1;if(l){const L=this.viewItems[l.index],D=t>=l.limitDelta;x=D!==L.visible,L.setVisible(D,l.size)}if(!x&&c){const L=this.viewItems[c.index],D=t<c.limitDelta;x=D!==L.visible,L.setVisible(D,c.size)}if(x)return this.resize(e,t,i,n,o,r,a);t=cs(t,y,w);for(let L=0,D=t;L<u.length;L++){const T=u[L],F=cs(g[L]+D,T.minimumSize,T.maximumSize),W=F-g[L];D-=W,T.size=F}for(let L=0,D=t;L<f.length;L++){const T=f[L],F=cs(m[L]-D,T.minimumSize,T.maximumSize),W=F-m[L];D+=W,T.size=F}return t}distributeEmptySpace(e){const t=this.viewItems.reduce((a,l)=>a+l.size,0);let i=this.size-t;const n=As(this.viewItems.length-1,-1),o=n.filter(a=>this.viewItems[a].priority===1),r=n.filter(a=>this.viewItems[a].priority===2);for(const a of r)Rk(n,a);for(const a of o)gy(n,a);typeof e=="number"&&gy(n,e);for(let a=0;i!==0&&a<n.length;a++){const l=this.viewItems[n[a]],c=cs(l.size+i,l.minimumSize,l.maximumSize),d=c-l.size;i-=d,l.size=c}}layoutViews(){this._contentSize=this.viewItems.reduce((t,i)=>t+i.size,0);let e=0;for(const t of this.viewItems)t.layout(e,this.layoutContext),e+=t.size;this.sashItems.forEach(t=>t.sash.layout()),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){this.orientation===0?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this._contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this._contentSize})}updateSashEnablement(){let e=!1;const t=this.viewItems.map(l=>e=l.size-l.minimumSize>0||e);e=!1;const i=this.viewItems.map(l=>e=l.maximumSize-l.size>0||e),n=[...this.viewItems].reverse();e=!1;const o=n.map(l=>e=l.size-l.minimumSize>0||e).reverse();e=!1;const r=n.map(l=>e=l.maximumSize-l.size>0||e).reverse();let a=0;for(let l=0;l<this.sashItems.length;l++){const{sash:c}=this.sashItems[l],d=this.viewItems[l];a+=d.size;const h=!(t[l]&&r[l+1]),u=!(i[l]&&o[l+1]);if(h&&u){const g=As(l,-1),f=As(l+1,this.viewItems.length),m=this.findFirstSnapIndex(g),_=this.findFirstSnapIndex(f),b=typeof m=="number"&&!this.viewItems[m].visible,v=typeof _=="number"&&!this.viewItems[_].visible;b&&o[l]&&(a>0||this.startSnappingEnabled)?c.state=1:v&&t[l]&&(a<this._contentSize||this.endSnappingEnabled)?c.state=2:c.state=0}else h&&!u?c.state=1:!h&&u?c.state=2:c.state=3}}getSashPosition(e){let t=0;for(let i=0;i<this.sashItems.length;i++)if(t+=this.viewItems[i].size,this.sashItems[i].sash===e)return t;return 0}findFirstSnapIndex(e){for(const t of e){const i=this.viewItems[t];if(i.visible&&i.snap)return t}for(const t of e){const i=this.viewItems[t];if(i.visible&&i.maximumSize-i.minimumSize>0)return;if(!i.visible&&i.snap)return t}}areViewsDistributed(){let e,t;for(const i of this.viewItems)if(e=e===void 0?i.size:Math.min(e,i.size),t=t===void 0?i.size:Math.max(t,i.size),t-e>2)return!1;return!0}dispose(){this.sashDragState?.disposable.dispose(),At(this.viewItems),this.viewItems=[],this.sashItems.forEach(e=>e.disposable.dispose()),this.sashItems=[],super.dispose()}}class gx{static{this.TemplateId="row"}constructor(e,t,i){this.columns=e,this.getColumnSize=i,this.templateId=gx.TemplateId,this.renderedTemplates=new Set;const n=new Map(t.map(o=>[o.templateId,o]));this.renderers=[];for(const o of e){const r=n.get(o.templateId);if(!r)throw new Error(`Table cell renderer for template id ${o.templateId} not found.`);this.renderers.push(r)}}renderTemplate(e){const t=X(e,te(".monaco-table-tr")),i=[],n=[];for(let r=0;r<this.columns.length;r++){const a=this.renderers[r],l=X(t,te(".monaco-table-td",{"data-col-index":r}));l.style.width=`${this.getColumnSize(r)}px`,i.push(l),n.push(a.renderTemplate(l))}const o={container:e,cellContainers:i,cellTemplateData:n};return this.renderedTemplates.add(o),o}renderElement(e,t,i,n){for(let o=0;o<this.columns.length;o++){const a=this.columns[o].project(e);this.renderers[o].renderElement(a,t,i.cellTemplateData[o],n)}}disposeElement(e,t,i,n){for(let o=0;o<this.columns.length;o++){const r=this.renderers[o];if(r.disposeElement){const l=this.columns[o].project(e);r.disposeElement(l,t,i.cellTemplateData[o],n)}}}disposeTemplate(e){for(let t=0;t<this.columns.length;t++)this.renderers[t].disposeTemplate(e.cellTemplateData[t]);Cn(e.container),this.renderedTemplates.delete(e)}layoutColumn(e,t){for(const{cellContainers:i}of this.renderedTemplates)i[e].style.width=`${t}px`}}function $ge(s){return{getHeight(e){return s.getHeight(e)},getTemplateId(){return gx.TemplateId}}}class jge extends B{get minimumSize(){return this.column.minimumWidth??120}get maximumSize(){return this.column.maximumWidth??Number.POSITIVE_INFINITY}get onDidChange(){return this.column.onDidChangeWidthConstraints??se.None}constructor(e,t){super(),this.column=e,this.index=t,this._onDidLayout=new O,this.onDidLayout=this._onDidLayout.event,this.element=te(".monaco-table-th",{"data-col-index":t},e.label),e.tooltip&&this._register(Ka().setupManagedHover(Ds("mouse"),this.element,e.tooltip))}layout(e){this._onDidLayout.fire([this.index,e])}}class _O{static{this.InstanceCount=0}get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onDidScroll(){return this.list.onDidScroll}get onMouseDblClick(){return this.list.onMouseDblClick}get onPointer(){return this.list.onPointer}get onDidFocus(){return this.list.onDidFocus}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}get scrollHeight(){return this.list.scrollHeight}get renderHeight(){return this.list.renderHeight}get onDidDispose(){return this.list.onDidDispose}constructor(e,t,i,n,o,r){this.virtualDelegate=i,this.columns=n,this.domId=`table_id_${++_O.InstanceCount}`,this.disposables=new Z,this.cachedWidth=0,this.cachedHeight=0,this.domNode=X(t,te(`.monaco-table.${this.domId}`));const a=n.map((d,h)=>this.disposables.add(new jge(d,h))),l={size:a.reduce((d,h)=>d+h.column.weight,0),views:a.map(d=>({size:d.column.weight,view:d}))};this.splitview=this.disposables.add(new QU(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:l})),this.splitview.el.style.height=`${i.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${i.headerRowHeight}px`;const c=new gx(n,o,d=>this.splitview.getViewSize(d));this.list=this.disposables.add(new Xo(e,this.domNode,$ge(i),[c],r)),se.any(...a.map(d=>d.onDidLayout))(([d,h])=>c.layoutColumn(d,h),null,this.disposables),this.splitview.onDidSashReset(d=>{const h=n.reduce((g,f)=>g+f.weight,0),u=n[d].weight/h*this.cachedWidth;this.splitview.resizeView(d,u)},null,this.disposables),this.styleElement=$o(this.domNode),this.style(mde)}updateOptions(e){this.list.updateOptions(e)}splice(e,t,i=[]){this.list.splice(e,t,i)}getHTMLElement(){return this.domNode}style(e){const t=[];t.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {
			top: ${this.virtualDelegate.headerRowHeight+1}px;
			height: calc(100% - ${this.virtualDelegate.headerRowHeight}px);
		}`),this.styleElement.textContent=t.join(`
`),this.list.style(e)}getSelectedElements(){return this.list.getSelectedElements()}getSelection(){return this.list.getSelection()}getFocus(){return this.list.getFocus()}dispose(){this.disposables.dispose()}}var Io;(function(s){s[s.Expanded=0]="Expanded",s[s.Collapsed=1]="Collapsed",s[s.PreserveOrExpanded=2]="PreserveOrExpanded",s[s.PreserveOrCollapsed=3]="PreserveOrCollapsed"})(Io||(Io={}));var yu;(function(s){s[s.Unknown=0]="Unknown",s[s.Twistie=1]="Twistie",s[s.Element=2]="Element",s[s.Filter=3]="Filter"})(yu||(yu={}));class Po extends Error{constructor(e,t){super(`TreeError [${e}] ${t}`)}}class bO{constructor(e){this.fn=e,this._map=new WeakMap}map(e){let t=this._map.get(e);return t||(t=this.fn(e),this._map.set(e,t)),t}}function vO(s){return typeof s=="object"&&"visibility"in s&&"data"in s}function yv(s){switch(s){case!0:return 1;case!1:return 0;default:return s}}function FD(s){return typeof s.collapsible=="boolean"}class Zge{constructor(e,t,i,n={}){this.user=e,this.list=t,this.rootRef=[],this.eventBufferer=new mC,this._onDidChangeCollapseState=new O,this.onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event),this._onDidChangeRenderNodeCount=new O,this.onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event),this._onDidSplice=new O,this.onDidSplice=this._onDidSplice.event,this.refilterDelayer=new Cr(P6),this.collapseByDefault=typeof n.collapseByDefault>"u"?!1:n.collapseByDefault,this.allowNonCollapsibleParents=n.allowNonCollapsibleParents??!1,this.filter=n.filter,this.autoExpandSingleChildren=typeof n.autoExpandSingleChildren>"u"?!1:n.autoExpandSingleChildren,this.root={parent:void 0,element:i,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}splice(e,t,i=st.empty(),n={}){if(e.length===0)throw new Po(this.user,"Invalid tree location");n.diffIdentityProvider?this.spliceSmart(n.diffIdentityProvider,e,t,i,n):this.spliceSimple(e,t,i,n)}spliceSmart(e,t,i,n=st.empty(),o,r=o.diffDepth??0){const{parentNode:a}=this.getParentNodeWithListIndex(t);if(!a.lastDiffIds)return this.spliceSimple(t,i,n,o);const l=[...n],c=t[t.length-1],d=new bl({getElements:()=>a.lastDiffIds},{getElements:()=>[...a.children.slice(0,c),...l,...a.children.slice(c+i)].map(m=>e.getId(m.element).toString())}).ComputeDiff(!1);if(d.quitEarly)return a.lastDiffIds=void 0,this.spliceSimple(t,i,l,o);const h=t.slice(0,-1),u=(m,_,b)=>{if(r>0)for(let v=0;v<b;v++)m--,_--,this.spliceSmart(e,[...h,m,0],Number.MAX_SAFE_INTEGER,l[_].children,o,r-1)};let g=Math.min(a.children.length,c+i),f=l.length;for(const m of d.changes.sort((_,b)=>b.originalStart-_.originalStart))u(g,f,g-(m.originalStart+m.originalLength)),g=m.originalStart,f=m.modifiedStart-c,this.spliceSimple([...h,g],m.originalLength,st.slice(l,f,f+m.modifiedLength),o);u(g,f,g)}spliceSimple(e,t,i=st.empty(),{onDidCreateNode:n,onDidDeleteNode:o,diffIdentityProvider:r}){const{parentNode:a,listIndex:l,revealed:c,visible:d}=this.getParentNodeWithListIndex(e),h=[],u=st.map(i,w=>this.createTreeNode(w,a,a.visible?1:0,c,h,n)),g=e[e.length-1];let f=0;for(let w=g;w>=0&&w<a.children.length;w--){const x=a.children[w];if(x.visible){f=x.visibleChildIndex;break}}const m=[];let _=0,b=0;for(const w of u)m.push(w),b+=w.renderNodeCount,w.visible&&(w.visibleChildIndex=f+_++);const v=y5(a.children,g,t,m);r?a.lastDiffIds?y5(a.lastDiffIds,g,t,m.map(w=>r.getId(w.element).toString())):a.lastDiffIds=a.children.map(w=>r.getId(w.element).toString()):a.lastDiffIds=void 0;let C=0;for(const w of v)w.visible&&C++;if(C!==0)for(let w=g+m.length;w<a.children.length;w++){const x=a.children[w];x.visible&&(x.visibleChildIndex-=C)}if(a.visibleChildrenCount+=_-C,c&&d){const w=v.reduce((x,L)=>x+(L.visible?L.renderNodeCount:0),0);this._updateAncestorsRenderNodeCount(a,b-w),this.list.splice(l,w,h)}if(v.length>0&&o){const w=x=>{o(x),x.children.forEach(w)};v.forEach(w)}this._onDidSplice.fire({insertedNodes:m,deletedNodes:v});let y=a;for(;y;){if(y.visibility===2){this.refilterDelayer.trigger(()=>this.refilter());break}y=y.parent}}rerender(e){if(e.length===0)throw new Po(this.user,"Invalid tree location");const{node:t,listIndex:i,revealed:n}=this.getTreeNodeWithListIndex(e);t.visible&&n&&this.list.splice(i,1,[t])}has(e){return this.hasTreeNode(e)}getListIndex(e){const{listIndex:t,visible:i,revealed:n}=this.getTreeNodeWithListIndex(e);return i&&n?t:-1}getListRenderCount(e){return this.getTreeNode(e).renderNodeCount}isCollapsible(e){return this.getTreeNode(e).collapsible}setCollapsible(e,t){const i=this.getTreeNode(e);typeof t>"u"&&(t=!i.collapsible);const n={collapsible:t};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,n))}isCollapsed(e){return this.getTreeNode(e).collapsed}setCollapsed(e,t,i){const n=this.getTreeNode(e);typeof t>"u"&&(t=!n.collapsed);const o={collapsed:t,recursive:i||!1};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,o))}_setCollapseState(e,t){const{node:i,listIndex:n,revealed:o}=this.getTreeNodeWithListIndex(e),r=this._setListNodeCollapseState(i,n,o,t);if(i!==this.root&&this.autoExpandSingleChildren&&r&&!FD(t)&&i.collapsible&&!i.collapsed&&!t.recursive){let a=-1;for(let l=0;l<i.children.length;l++)if(i.children[l].visible)if(a>-1){a=-1;break}else a=l;a>-1&&this._setCollapseState([...e,a],t)}return r}_setListNodeCollapseState(e,t,i,n){const o=this._setNodeCollapseState(e,n,!1);if(!i||!e.visible||!o)return o;const r=e.renderNodeCount,a=this.updateNodeAfterCollapseChange(e),l=r-(t===-1?0:1);return this.list.splice(t+1,l,a.slice(1)),o}_setNodeCollapseState(e,t,i){let n;if(e===this.root?n=!1:(FD(t)?(n=e.collapsible!==t.collapsible,e.collapsible=t.collapsible):e.collapsible?(n=e.collapsed!==t.collapsed,e.collapsed=t.collapsed):n=!1,n&&this._onDidChangeCollapseState.fire({node:e,deep:i})),!FD(t)&&t.recursive)for(const o of e.children)n=this._setNodeCollapseState(o,t,!0)||n;return n}expandTo(e){this.eventBufferer.bufferEvents(()=>{let t=this.getTreeNode(e);for(;t.parent;)t=t.parent,e=e.slice(0,e.length-1),t.collapsed&&this._setCollapseState(e,{collapsed:!1,recursive:!1})})}refilter(){const e=this.root.renderNodeCount,t=this.updateNodeAfterFilterChange(this.root);this.list.splice(0,e,t),this.refilterDelayer.cancel()}createTreeNode(e,t,i,n,o,r){const a={parent:t,element:e.element,children:[],depth:t.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:typeof e.collapsible=="boolean"?e.collapsible:typeof e.collapsed<"u",collapsed:typeof e.collapsed>"u"?this.collapseByDefault:e.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},l=this._filterNode(a,i);a.visibility=l,n&&o.push(a);const c=e.children||st.empty(),d=n&&l!==0&&!a.collapsed;let h=0,u=1;for(const g of c){const f=this.createTreeNode(g,a,l,d,o,r);a.children.push(f),u+=f.renderNodeCount,f.visible&&(f.visibleChildIndex=h++)}return this.allowNonCollapsibleParents||(a.collapsible=a.collapsible||a.children.length>0),a.visibleChildrenCount=h,a.visible=l===2?h>0:l===1,a.visible?a.collapsed||(a.renderNodeCount=u):(a.renderNodeCount=0,n&&o.pop()),r?.(a),a}updateNodeAfterCollapseChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterCollapseChange(e,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterCollapseChange(e,t){if(e.visible===!1)return 0;if(t.push(e),e.renderNodeCount=1,!e.collapsed)for(const i of e.children)e.renderNodeCount+=this._updateNodeAfterCollapseChange(i,t);return this._onDidChangeRenderNodeCount.fire(e),e.renderNodeCount}updateNodeAfterFilterChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterFilterChange(e,e.visible?1:0,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterFilterChange(e,t,i,n=!0){let o;if(e!==this.root){if(o=this._filterNode(e,t),o===0)return e.visible=!1,e.renderNodeCount=0,!1;n&&i.push(e)}const r=i.length;e.renderNodeCount=e===this.root?0:1;let a=!1;if(!e.collapsed||o!==0){let l=0;for(const c of e.children)a=this._updateNodeAfterFilterChange(c,o,i,n&&!e.collapsed)||a,c.visible&&(c.visibleChildIndex=l++);e.visibleChildrenCount=l}else e.visibleChildrenCount=0;return e!==this.root&&(e.visible=o===2?a:o===1,e.visibility=o),e.visible?e.collapsed||(e.renderNodeCount+=i.length-r):(e.renderNodeCount=0,n&&i.pop()),this._onDidChangeRenderNodeCount.fire(e),e.visible}_updateAncestorsRenderNodeCount(e,t){if(t!==0)for(;e;)e.renderNodeCount+=t,this._onDidChangeRenderNodeCount.fire(e),e=e.parent}_filterNode(e,t){const i=this.filter?this.filter.filter(e.element,t):1;return typeof i=="boolean"?(e.filterData=void 0,i?1:0):vO(i)?(e.filterData=i.data,yv(i.visibility)):(e.filterData=void 0,yv(i))}hasTreeNode(e,t=this.root){if(!e||e.length===0)return!0;const[i,...n]=e;return i<0||i>t.children.length?!1:this.hasTreeNode(n,t.children[i])}getTreeNode(e,t=this.root){if(!e||e.length===0)return t;const[i,...n]=e;if(i<0||i>t.children.length)throw new Po(this.user,"Invalid tree location");return this.getTreeNode(n,t.children[i])}getTreeNodeWithListIndex(e){if(e.length===0)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};const{parentNode:t,listIndex:i,revealed:n,visible:o}=this.getParentNodeWithListIndex(e),r=e[e.length-1];if(r<0||r>t.children.length)throw new Po(this.user,"Invalid tree location");const a=t.children[r];return{node:a,listIndex:i,revealed:n,visible:o&&a.visible}}getParentNodeWithListIndex(e,t=this.root,i=0,n=!0,o=!0){const[r,...a]=e;if(r<0||r>t.children.length)throw new Po(this.user,"Invalid tree location");for(let l=0;l<r;l++)i+=t.children[l].renderNodeCount;return n=n&&!t.collapsed,o=o&&t.visible,a.length===0?{parentNode:t,listIndex:i,revealed:n,visible:o}:this.getParentNodeWithListIndex(a,t.children[r],i+1,n,o)}getNode(e=[]){return this.getTreeNode(e)}getNodeLocation(e){const t=[];let i=e;for(;i.parent;)t.push(i.parent.children.indexOf(i)),i=i.parent;return t.reverse()}getParentNodeLocation(e){if(e.length!==0)return e.length===1?[]:sQ(e)[0]}getFirstElementChild(e){const t=this.getTreeNode(e);if(t.children.length!==0)return t.children[0].element}}class Kge extends OC{constructor(e){super(e.elements.map(t=>t.element)),this.data=e}}function BD(s){return s instanceof OC?new Kge(s):s}class qge{constructor(e,t){this.modelProvider=e,this.dnd=t,this.autoExpandDisposable=B.None,this.disposables=new Z}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){this.dnd.onDragStart?.(BD(e),t)}onDragOver(e,t,i,n,o,r=!0){const a=this.dnd.onDragOver(BD(e),t&&t.element,i,n,o),l=this.autoExpandNode!==t;if(l&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=t),typeof t>"u")return a;if(l&&typeof a!="boolean"&&a.autoExpand&&(this.autoExpandDisposable=nh(()=>{const g=this.modelProvider(),f=g.getNodeLocation(t);g.isCollapsed(f)&&g.setCollapsed(f,!1),this.autoExpandNode=void 0},500,this.disposables)),typeof a=="boolean"||!a.accept||typeof a.bubble>"u"||a.feedback){if(!r){const g=typeof a=="boolean"?a:a.accept,f=typeof a=="boolean"?void 0:a.effect;return{accept:g,effect:f,feedback:[i]}}return a}if(a.bubble===1){const g=this.modelProvider(),f=g.getNodeLocation(t),m=g.getParentNodeLocation(f),_=g.getNode(m),b=m&&g.getListIndex(m);return this.onDragOver(e,_,b,n,o,!1)}const c=this.modelProvider(),d=c.getNodeLocation(t),h=c.getListIndex(d),u=c.getListRenderCount(d);return{...a,feedback:As(h,h+u)}}drop(e,t,i,n,o){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(BD(e),t&&t.element,i,n,o)}onDragEnd(e){this.dnd.onDragEnd?.(e)}dispose(){this.disposables.dispose(),this.dnd.dispose()}}function Gge(s,e){return e&&{...e,identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(t.element)}},dnd:e.dnd&&new qge(s,e.dnd),multipleSelectionController:e.multipleSelectionController&&{isSelectionSingleChangeEvent(t){return e.multipleSelectionController.isSelectionSingleChangeEvent({...t,element:t.element})},isSelectionRangeChangeEvent(t){return e.multipleSelectionController.isSelectionRangeChangeEvent({...t,element:t.element})}},accessibilityProvider:e.accessibilityProvider&&{...e.accessibilityProvider,getSetSize(t){const i=s(),n=i.getNodeLocation(t),o=i.getParentNodeLocation(n);return i.getNode(o).visibleChildrenCount},getPosInSet(t){return t.visibleChildIndex+1},isChecked:e.accessibilityProvider&&e.accessibilityProvider.isChecked?t=>e.accessibilityProvider.isChecked(t.element):void 0,getRole:e.accessibilityProvider&&e.accessibilityProvider.getRole?t=>e.accessibilityProvider.getRole(t.element):()=>"treeitem",getAriaLabel(t){return e.accessibilityProvider.getAriaLabel(t.element)},getWidgetAriaLabel(){return e.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:e.accessibilityProvider&&e.accessibilityProvider.getWidgetRole?()=>e.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:e.accessibilityProvider&&e.accessibilityProvider.getAriaLevel?t=>e.accessibilityProvider.getAriaLevel(t.element):t=>t.depth,getActiveDescendantId:e.accessibilityProvider.getActiveDescendantId&&(t=>e.accessibilityProvider.getActiveDescendantId(t.element))},keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{...e.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(t){return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t.element)}}}}class CO{constructor(e){this.delegate=e}getHeight(e){return this.delegate.getHeight(e.element)}getTemplateId(e){return this.delegate.getTemplateId(e.element)}hasDynamicHeight(e){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(e.element)}setDynamicHeight(e,t){this.delegate.setDynamicHeight?.(e.element,t)}}var Hp;(function(s){s.None="none",s.OnHover="onHover",s.Always="always"})(Hp||(Hp={}));class Yge{get elements(){return this._elements}constructor(e,t=[]){this._elements=t,this.disposables=new Z,this.onDidChange=se.forEach(e,i=>this._elements=i,this.disposables)}dispose(){this.disposables.dispose()}}class H0{static{this.DefaultIndent=8}constructor(e,t,i,n,o,r={}){this.renderer=e,this.modelProvider=t,this.activeNodes=n,this.renderedIndentGuides=o,this.renderedElements=new Map,this.renderedNodes=new Map,this.indent=H0.DefaultIndent,this.hideTwistiesOfChildlessElements=!1,this.shouldRenderIndentGuides=!1,this.activeIndentNodes=new Set,this.indentGuidesDisposable=B.None,this.disposables=new Z,this.templateId=e.templateId,this.updateOptions(r),se.map(i,a=>a.node)(this.onDidChangeNodeTwistieState,this,this.disposables),e.onDidChangeTwistieState?.(this.onDidChangeTwistieState,this,this.disposables)}updateOptions(e={}){if(typeof e.indent<"u"){const t=cs(e.indent,0,40);if(t!==this.indent){this.indent=t;for(const[i,n]of this.renderedNodes)this.renderTreeElement(i,n)}}if(typeof e.renderIndentGuides<"u"){const t=e.renderIndentGuides!==Hp.None;if(t!==this.shouldRenderIndentGuides){this.shouldRenderIndentGuides=t;for(const[i,n]of this.renderedNodes)this._renderIndentGuides(i,n);if(this.indentGuidesDisposable.dispose(),t){const i=new Z;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,i),this.indentGuidesDisposable=i,this._onDidChangeActiveNodes(this.activeNodes.elements)}}}typeof e.hideTwistiesOfChildlessElements<"u"&&(this.hideTwistiesOfChildlessElements=e.hideTwistiesOfChildlessElements)}renderTemplate(e){const t=X(e,te(".monaco-tl-row")),i=X(t,te(".monaco-tl-indent")),n=X(t,te(".monaco-tl-twistie")),o=X(t,te(".monaco-tl-contents")),r=this.renderer.renderTemplate(o);return{container:e,indent:i,twistie:n,indentGuidesDisposable:B.None,templateData:r}}renderElement(e,t,i,n){this.renderedNodes.set(e,i),this.renderedElements.set(e.element,e),this.renderTreeElement(e,i),this.renderer.renderElement(e,t,i.templateData,n)}disposeElement(e,t,i,n){i.indentGuidesDisposable.dispose(),this.renderer.disposeElement?.(e,t,i.templateData,n),typeof n=="number"&&(this.renderedNodes.delete(e),this.renderedElements.delete(e.element))}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}onDidChangeTwistieState(e){const t=this.renderedElements.get(e);t&&this.onDidChangeNodeTwistieState(t)}onDidChangeNodeTwistieState(e){const t=this.renderedNodes.get(e);t&&(this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderTreeElement(e,t))}renderTreeElement(e,t){const i=H0.DefaultIndent+(e.depth-1)*this.indent;t.twistie.style.paddingLeft=`${i}px`,t.indent.style.width=`${i+this.indent-16}px`,e.collapsible?t.container.setAttribute("aria-expanded",String(!e.collapsed)):t.container.removeAttribute("aria-expanded"),t.twistie.classList.remove(...Ie.asClassNameArray(J.treeItemExpanded));let n=!1;this.renderer.renderTwistie&&(n=this.renderer.renderTwistie(e.element,t.twistie)),e.collapsible&&(!this.hideTwistiesOfChildlessElements||e.visibleChildrenCount>0)?(n||t.twistie.classList.add(...Ie.asClassNameArray(J.treeItemExpanded)),t.twistie.classList.add("collapsible"),t.twistie.classList.toggle("collapsed",e.collapsed)):t.twistie.classList.remove("collapsible","collapsed"),this._renderIndentGuides(e,t)}_renderIndentGuides(e,t){if(Cn(t.indent),t.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;const i=new Z,n=this.modelProvider();for(;;){const o=n.getNodeLocation(e),r=n.getParentNodeLocation(o);if(!r)break;const a=n.getNode(r),l=te(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(a)&&l.classList.add("active"),t.indent.childElementCount===0?t.indent.appendChild(l):t.indent.insertBefore(l,t.indent.firstElementChild),this.renderedIndentGuides.add(a,l),i.add(Ce(()=>this.renderedIndentGuides.delete(a,l))),e=a}t.indentGuidesDisposable=i}_onDidChangeActiveNodes(e){if(!this.shouldRenderIndentGuides)return;const t=new Set,i=this.modelProvider();e.forEach(n=>{const o=i.getNodeLocation(n);try{const r=i.getParentNodeLocation(o);n.collapsible&&n.children.length>0&&!n.collapsed?t.add(n):r&&t.add(i.getNode(r))}catch{}}),this.activeIndentNodes.forEach(n=>{t.has(n)||this.renderedIndentGuides.forEach(n,o=>o.classList.remove("active"))}),t.forEach(n=>{this.activeIndentNodes.has(n)||this.renderedIndentGuides.forEach(n,o=>o.classList.add("active"))}),this.activeIndentNodes=t}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),At(this.disposables)}}class Xge{get totalCount(){return this._totalCount}get matchCount(){return this._matchCount}constructor(e,t,i){this.tree=e,this.keyboardNavigationLabelProvider=t,this._filter=i,this._totalCount=0,this._matchCount=0,this._pattern="",this._lowercasePattern="",this.disposables=new Z,e.onWillRefilter(this.reset,this,this.disposables)}filter(e,t){let i=1;if(this._filter){const r=this._filter.filter(e,t);if(typeof r=="boolean"?i=r?1:0:vO(r)?i=yv(r.visibility):i=r,i===0)return!1}if(this._totalCount++,!this._pattern)return this._matchCount++,{data:Aa.Default,visibility:i};const n=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e),o=Array.isArray(n)?n:[n];for(const r of o){const a=r&&r.toString();if(typeof a>"u")return{data:Aa.Default,visibility:i};let l;if(this.tree.findMatchType===eg.Contiguous){const c=a.toLowerCase().indexOf(this._lowercasePattern);if(c>-1){l=[Number.MAX_SAFE_INTEGER,0];for(let d=this._lowercasePattern.length;d>0;d--)l.push(c+d-1)}}else l=Yu(this._pattern,this._lowercasePattern,0,a,a.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(l)return this._matchCount++,o.length===1?{data:l,visibility:i}:{data:{label:a,score:l},visibility:i}}return this.tree.findMode===xc.Filter?typeof this.tree.options.defaultFindVisibility=="number"?this.tree.options.defaultFindVisibility:this.tree.options.defaultFindVisibility?this.tree.options.defaultFindVisibility(e):2:{data:Aa.Default,visibility:i}}reset(){this._totalCount=0,this._matchCount=0}dispose(){At(this.disposables)}}var xc;(function(s){s[s.Highlight=0]="Highlight",s[s.Filter=1]="Filter"})(xc||(xc={}));var eg;(function(s){s[s.Fuzzy=0]="Fuzzy",s[s.Contiguous=1]="Contiguous"})(eg||(eg={}));let Qge=class{get pattern(){return this._pattern}get mode(){return this._mode}set mode(e){e!==this._mode&&(this._mode=e,this.widget&&(this.widget.mode=this._mode),this.tree.refilter(),this.render(),this._onDidChangeMode.fire(e))}get matchType(){return this._matchType}set matchType(e){e!==this._matchType&&(this._matchType=e,this.widget&&(this.widget.matchType=this._matchType),this.tree.refilter(),this.render(),this._onDidChangeMatchType.fire(e))}constructor(e,t,i,n,o,r={}){this.tree=e,this.view=i,this.filter=n,this.contextViewProvider=o,this.options=r,this._pattern="",this.width=0,this._onDidChangeMode=new O,this.onDidChangeMode=this._onDidChangeMode.event,this._onDidChangeMatchType=new O,this.onDidChangeMatchType=this._onDidChangeMatchType.event,this._onDidChangePattern=new O,this._onDidChangeOpenState=new O,this.onDidChangeOpenState=this._onDidChangeOpenState.event,this.enabledDisposables=new Z,this.disposables=new Z,this._mode=e.options.defaultFindMode??xc.Highlight,this._matchType=e.options.defaultFindMatchType??eg.Fuzzy,t.onDidSplice(this.onDidSpliceModel,this,this.disposables)}updateOptions(e={}){e.defaultFindMode!==void 0&&(this.mode=e.defaultFindMode),e.defaultFindMatchType!==void 0&&(this.matchType=e.defaultFindMatchType)}onDidSpliceModel(){!this.widget||this.pattern.length===0||(this.tree.refilter(),this.render())}render(){const e=this.filter.totalCount>0&&this.filter.matchCount===0;this.pattern&&e?(Ls(p("replFindNoResults","No results")),this.tree.options.showNotFoundMessage??!0?this.widget?.showMessage({type:2,content:p("not found","No elements found.")}):this.widget?.showMessage({type:2})):(this.widget?.clearMessage(),this.pattern&&Ls(p("replFindResults","{0} results",this.filter.matchCount)))}shouldAllowFocus(e){return!this.widget||!this.pattern||this.filter.totalCount>0&&this.filter.matchCount<=1?!0:!Aa.isDefault(e.filterData)}layout(e){this.width=e,this.widget?.layout(e)}dispose(){this._history=void 0,this._onDidChangePattern.dispose(),this.enabledDisposables.dispose(),this.disposables.dispose()}};function Jge(s,e){return s.position===e.position&&JU(s,e)}function JU(s,e){return s.node.element===e.node.element&&s.startIndex===e.startIndex&&s.height===e.height&&s.endIndex===e.endIndex}class efe{constructor(e=[]){this.stickyNodes=e}get count(){return this.stickyNodes.length}equal(e){return ii(this.stickyNodes,e.stickyNodes,Jge)}lastNodePartiallyVisible(){if(this.count===0)return!1;const e=this.stickyNodes[this.count-1];if(this.count===1)return e.position!==0;const t=this.stickyNodes[this.count-2];return t.position+t.height!==e.position}animationStateChanged(e){if(!ii(this.stickyNodes,e.stickyNodes,JU)||this.count===0)return!1;const t=this.stickyNodes[this.count-1],i=e.stickyNodes[e.count-1];return t.position!==i.position}}class tfe{constrainStickyScrollNodes(e,t,i){for(let n=0;n<e.length;n++){const o=e[n];if(o.position+o.height>i||n>=t)return e.slice(0,n)}return e}}let SW=class extends B{constructor(e,t,i,n,o,r={}){super(),this.tree=e,this.model=t,this.view=i,this.treeDelegate=o,this.maxWidgetViewRatio=.4;const a=this.validateStickySettings(r);this.stickyScrollMaxItemCount=a.stickyScrollMaxItemCount,this.stickyScrollDelegate=r.stickyScrollDelegate??new tfe,this._widget=this._register(new ife(i.getScrollableElement(),i,e,n,o,r.accessibilityProvider)),this.onDidChangeHasFocus=this._widget.onDidChangeHasFocus,this.onContextMenu=this._widget.onContextMenu,this._register(i.onDidScroll(()=>this.update())),this._register(i.onDidChangeContentHeight(()=>this.update())),this._register(e.onDidChangeCollapseState(()=>this.update())),this.update()}get height(){return this._widget.height}getNodeAtHeight(e){let t;if(e===0?t=this.view.firstVisibleIndex:t=this.view.indexAt(e+this.view.scrollTop),!(t<0||t>=this.view.length))return this.view.element(t)}update(){const e=this.getNodeAtHeight(0);if(!e||this.tree.scrollTop===0){this._widget.setState(void 0);return}const t=this.findStickyState(e);this._widget.setState(t)}findStickyState(e){const t=[];let i=e,n=0,o=this.getNextStickyNode(i,void 0,n);for(;o&&(t.push(o),n+=o.height,!(t.length<=this.stickyScrollMaxItemCount&&(i=this.getNextVisibleNode(o),!i)));)o=this.getNextStickyNode(i,o.node,n);const r=this.constrainStickyNodes(t);return r.length?new efe(r):void 0}getNextVisibleNode(e){return this.getNodeAtHeight(e.position+e.height)}getNextStickyNode(e,t,i){const n=this.getAncestorUnderPrevious(e,t);if(n&&!(n===e&&(!this.nodeIsUncollapsedParent(e)||this.nodeTopAlignsWithStickyNodesBottom(e,i))))return this.createStickyScrollNode(n,i)}nodeTopAlignsWithStickyNodesBottom(e,t){const i=this.getNodeIndex(e),n=this.view.getElementTop(i),o=t;return this.view.scrollTop===n-o}createStickyScrollNode(e,t){const i=this.treeDelegate.getHeight(e),{startIndex:n,endIndex:o}=this.getNodeRange(e),r=this.calculateStickyNodePosition(o,t,i);return{node:e,position:r,height:i,startIndex:n,endIndex:o}}getAncestorUnderPrevious(e,t=void 0){let i=e,n=this.getParentNode(i);for(;n;){if(n===t)return i;i=n,n=this.getParentNode(i)}if(t===void 0)return i}calculateStickyNodePosition(e,t,i){let n=this.view.getRelativeTop(e);if(n===null&&this.view.firstVisibleIndex===e&&e+1<this.view.length){const c=this.treeDelegate.getHeight(this.view.element(e)),d=this.view.getRelativeTop(e+1);n=d?d-c/this.view.renderHeight:null}if(n===null)return t;const o=this.view.element(e),r=this.treeDelegate.getHeight(o),l=n*this.view.renderHeight+r;return t+i>l&&t<=l?l-i:t}constrainStickyNodes(e){if(e.length===0)return[];const t=this.view.renderHeight*this.maxWidgetViewRatio,i=e[e.length-1];if(e.length<=this.stickyScrollMaxItemCount&&i.position+i.height<=t)return e;const n=this.stickyScrollDelegate.constrainStickyScrollNodes(e,this.stickyScrollMaxItemCount,t);if(!n.length)return[];const o=n[n.length-1];if(n.length>this.stickyScrollMaxItemCount||o.position+o.height>t)throw new Error("stickyScrollDelegate violates constraints");return n}getParentNode(e){const t=this.model.getNodeLocation(e),i=this.model.getParentNodeLocation(t);return i?this.model.getNode(i):void 0}nodeIsUncollapsedParent(e){const t=this.model.getNodeLocation(e);return this.model.getListRenderCount(t)>1}getNodeIndex(e){const t=this.model.getNodeLocation(e);return this.model.getListIndex(t)}getNodeRange(e){const t=this.model.getNodeLocation(e),i=this.model.getListIndex(t);if(i<0)throw new Error("Node not found in tree");const n=this.model.getListRenderCount(t),o=i+n-1;return{startIndex:i,endIndex:o}}nodePositionTopBelowWidget(e){const t=[];let i=this.getParentNode(e);for(;i;)t.push(i),i=this.getParentNode(i);let n=0;for(let o=0;o<t.length&&o<this.stickyScrollMaxItemCount;o++)n+=this.treeDelegate.getHeight(t[o]);return n}domFocus(){this._widget.domFocus()}focusedLast(){return this._widget.focusedLast()}updateOptions(e={}){if(!e.stickyScrollMaxItemCount)return;const t=this.validateStickySettings(e);this.stickyScrollMaxItemCount!==t.stickyScrollMaxItemCount&&(this.stickyScrollMaxItemCount=t.stickyScrollMaxItemCount,this.update())}validateStickySettings(e){let t=7;return typeof e.stickyScrollMaxItemCount=="number"&&(t=Math.max(e.stickyScrollMaxItemCount,1)),{stickyScrollMaxItemCount:t}}},ife=class{constructor(e,t,i,n,o,r){this.view=t,this.tree=i,this.treeRenderers=n,this.treeDelegate=o,this.accessibilityProvider=r,this._previousElements=[],this._previousStateDisposables=new Z,this._rootDomNode=te(".monaco-tree-sticky-container.empty"),e.appendChild(this._rootDomNode);const a=te(".monaco-tree-sticky-container-shadow");this._rootDomNode.appendChild(a),this.stickyScrollFocus=new nfe(this._rootDomNode,t),this.onDidChangeHasFocus=this.stickyScrollFocus.onDidChangeHasFocus,this.onContextMenu=this.stickyScrollFocus.onContextMenu}get height(){if(!this._previousState)return 0;const e=this._previousState.stickyNodes[this._previousState.count-1];return e.position+e.height}setState(e){const t=!!this._previousState&&this._previousState.count>0,i=!!e&&e.count>0;if(!t&&!i||t&&i&&this._previousState.equal(e))return;if(t!==i&&this.setVisible(i),!i){this._previousState=void 0,this._previousElements=[],this._previousStateDisposables.clear();return}const n=e.stickyNodes[e.count-1];if(this._previousState&&e.animationStateChanged(this._previousState))this._previousElements[this._previousState.count-1].style.top=`${n.position}px`;else{this._previousStateDisposables.clear();const o=Array(e.count);for(let r=e.count-1;r>=0;r--){const a=e.stickyNodes[r],{element:l,disposable:c}=this.createElement(a,r,e.count);o[r]=l,this._rootDomNode.appendChild(l),this._previousStateDisposables.add(c)}this.stickyScrollFocus.updateElements(o,e),this._previousElements=o}this._previousState=e,this._rootDomNode.style.height=`${n.position+n.height}px`}createElement(e,t,i){const n=e.startIndex,o=document.createElement("div");o.style.top=`${e.position}px`,this.tree.options.setRowHeight!==!1&&(o.style.height=`${e.height}px`),this.tree.options.setRowLineHeight!==!1&&(o.style.lineHeight=`${e.height}px`),o.classList.add("monaco-tree-sticky-row"),o.classList.add("monaco-list-row"),o.setAttribute("data-index",`${n}`),o.setAttribute("data-parity",n%2===0?"even":"odd"),o.setAttribute("id",this.view.getElementID(n));const r=this.setAccessibilityAttributes(o,e.node.element,t,i),a=this.treeDelegate.getTemplateId(e.node),l=this.treeRenderers.find(u=>u.templateId===a);if(!l)throw new Error(`No renderer found for template id ${a}`);let c=e.node;c===this.tree.getNode(this.tree.getNodeLocation(e.node))&&(c=new Proxy(e.node,{}));const d=l.renderTemplate(o);l.renderElement(c,e.startIndex,d,e.height);const h=Ce(()=>{r.dispose(),l.disposeElement(c,e.startIndex,d,e.height),l.disposeTemplate(d),o.remove()});return{element:o,disposable:h}}setAccessibilityAttributes(e,t,i,n){if(!this.accessibilityProvider)return B.None;this.accessibilityProvider.getSetSize&&e.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(t,i,n))),this.accessibilityProvider.getPosInSet&&e.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(t,i))),this.accessibilityProvider.getRole&&e.setAttribute("role",this.accessibilityProvider.getRole(t)??"treeitem");const o=this.accessibilityProvider.getAriaLabel(t),r=o&&typeof o!="string"?o:fr(o),a=Pe(c=>{const d=c.readObservable(r);d?e.setAttribute("aria-label",d):e.removeAttribute("aria-label")});typeof o=="string"||o&&e.setAttribute("aria-label",o.get());const l=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(t);return typeof l=="number"&&e.setAttribute("aria-level",`${l}`),e.setAttribute("aria-selected",String(!1)),a}setVisible(e){this._rootDomNode.classList.toggle("empty",!e),e||this.stickyScrollFocus.updateElements([],void 0)}domFocus(){this.stickyScrollFocus.domFocus()}focusedLast(){return this.stickyScrollFocus.focusedLast()}dispose(){this.stickyScrollFocus.dispose(),this._previousStateDisposables.dispose(),this._rootDomNode.remove()}};class nfe extends B{get domHasFocus(){return this._domHasFocus}set domHasFocus(e){e!==this._domHasFocus&&(this._onDidChangeHasFocus.fire(e),this._domHasFocus=e)}constructor(e,t){super(),this.container=e,this.view=t,this.focusedIndex=-1,this.elements=[],this._onDidChangeHasFocus=new O,this.onDidChangeHasFocus=this._onDidChangeHasFocus.event,this._onContextMenu=new O,this.onContextMenu=this._onContextMenu.event,this._domHasFocus=!1,this._register(U(this.container,"focus",()=>this.onFocus())),this._register(U(this.container,"blur",()=>this.onBlur())),this._register(this.view.onDidFocus(()=>this.toggleStickyScrollFocused(!1))),this._register(this.view.onKeyDown(i=>this.onKeyDown(i))),this._register(this.view.onMouseDown(i=>this.onMouseDown(i))),this._register(this.view.onContextMenu(i=>this.handleContextMenu(i)))}handleContextMenu(e){const t=e.browserEvent.target;if(!pv(t)&&!eb(t)){this.focusedLast()&&this.view.domFocus();return}if(!cc(e.browserEvent)){if(!this.state)throw new Error("Context menu should not be triggered when state is undefined");const r=this.state.stickyNodes.findIndex(a=>a.node.element===e.element?.element);if(r===-1)throw new Error("Context menu should not be triggered when element is not in sticky scroll widget");this.container.focus(),this.setFocus(r);return}if(!this.state||this.focusedIndex<0)throw new Error("Context menu key should not be triggered when focus is not in sticky scroll widget");const n=this.state.stickyNodes[this.focusedIndex].node.element,o=this.elements[this.focusedIndex];this._onContextMenu.fire({element:n,anchor:o,browserEvent:e.browserEvent,isStickyScroll:!0})}onKeyDown(e){if(this.domHasFocus&&this.state){if(e.key==="ArrowUp")this.setFocusedElement(Math.max(0,this.focusedIndex-1)),e.preventDefault(),e.stopPropagation();else if(e.key==="ArrowDown"||e.key==="ArrowRight"){if(this.focusedIndex>=this.state.count-1){const t=this.state.stickyNodes[this.state.count-1].startIndex+1;this.view.domFocus(),this.view.setFocus([t]),this.scrollNodeUnderWidget(t,this.state)}else this.setFocusedElement(this.focusedIndex+1);e.preventDefault(),e.stopPropagation()}}}onMouseDown(e){const t=e.browserEvent.target;!pv(t)&&!eb(t)||(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation())}updateElements(e,t){if(t&&t.count===0)throw new Error("Sticky scroll state must be undefined when there are no sticky nodes");if(t&&t.count!==e.length)throw new Error("Sticky scroll focus received illigel state");const i=this.focusedIndex;if(this.removeFocus(),this.elements=e,this.state=t,t){const n=cs(i,0,t.count-1);this.setFocus(n)}else this.domHasFocus&&this.view.domFocus();this.container.tabIndex=t?0:-1}setFocusedElement(e){const t=this.state;if(!t)throw new Error("Cannot set focus when state is undefined");if(this.setFocus(e),!(e<t.count-1)&&t.lastNodePartiallyVisible()){const i=t.stickyNodes[e];this.scrollNodeUnderWidget(i.endIndex+1,t)}}scrollNodeUnderWidget(e,t){const i=t.stickyNodes[t.count-1],n=t.count>1?t.stickyNodes[t.count-2]:void 0,o=this.view.getElementTop(e),r=n?n.position+n.height+i.height:i.height;this.view.scrollTop=o-r}domFocus(){if(!this.state)throw new Error("Cannot focus when state is undefined");this.container.focus()}focusedLast(){return this.state?this.view.getHTMLElement().classList.contains("sticky-scroll-focused"):!1}removeFocus(){this.focusedIndex!==-1&&(this.toggleElementFocus(this.elements[this.focusedIndex],!1),this.focusedIndex=-1)}setFocus(e){if(0>e)throw new Error("addFocus() can not remove focus");if(!this.state&&e>=0)throw new Error("Cannot set focus index when state is undefined");if(this.state&&e>=this.state.count)throw new Error("Cannot set focus index to an index that does not exist");const t=this.focusedIndex;t>=0&&this.toggleElementFocus(this.elements[t],!1),e>=0&&this.toggleElementFocus(this.elements[e],!0),this.focusedIndex=e}toggleElementFocus(e,t){this.toggleElementActiveFocus(e,t&&this.domHasFocus),this.toggleElementPassiveFocus(e,t)}toggleCurrentElementActiveFocus(e){this.focusedIndex!==-1&&this.toggleElementActiveFocus(this.elements[this.focusedIndex],e)}toggleElementActiveFocus(e,t){e.classList.toggle("focused",t)}toggleElementPassiveFocus(e,t){e.classList.toggle("passive-focused",t)}toggleStickyScrollFocused(e){this.view.getHTMLElement().classList.toggle("sticky-scroll-focused",e)}onFocus(){if(!this.state||this.elements.length===0)throw new Error("Cannot focus when state is undefined or elements are empty");this.domHasFocus=!0,this.toggleStickyScrollFocused(!0),this.toggleCurrentElementActiveFocus(!0),this.focusedIndex===-1&&this.setFocus(0)}onBlur(){this.domHasFocus=!1,this.toggleCurrentElementActiveFocus(!1)}dispose(){this.toggleStickyScrollFocused(!1),this._onDidChangeHasFocus.fire(!1),super.dispose()}}function $y(s){let e=yu.Unknown;return Zk(s.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?e=yu.Twistie:Zk(s.browserEvent.target,"monaco-tl-contents","monaco-tl-row")?e=yu.Element:Zk(s.browserEvent.target,"monaco-tree-type-filter","monaco-list")&&(e=yu.Filter),{browserEvent:s.browserEvent,element:s.element?s.element.element:null,target:e}}function sfe(s){const e=pv(s.browserEvent.target);return{element:s.element?s.element.element:null,browserEvent:s.browserEvent,anchor:s.anchor,isStickyScroll:e}}function qw(s,e){e(s),s.children.forEach(t=>qw(t,e))}class WD{get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}constructor(e,t){this.getFirstViewElementWithTrait=e,this.identityProvider=t,this.nodes=[],this._onDidChange=new O,this.onDidChange=this._onDidChange.event}set(e,t){!t?.__forceEvent&&ii(this.nodes,e)||this._set(e,!1,t)}_set(e,t,i){if(this.nodes=[...e],this.elements=void 0,this._nodeSet=void 0,!t){const n=this;this._onDidChange.fire({get elements(){return n.get()},browserEvent:i})}}get(){return this.elements||(this.elements=this.nodes.map(e=>e.element)),[...this.elements]}getNodes(){return this.nodes}has(e){return this.nodeSet.has(e)}onDidModelSplice({insertedNodes:e,deletedNodes:t}){if(!this.identityProvider){const l=this.createNodeSet(),c=d=>l.delete(d);t.forEach(d=>qw(d,c)),this.set([...l.values()]);return}const i=new Set,n=l=>i.add(this.identityProvider.getId(l.element).toString());t.forEach(l=>qw(l,n));const o=new Map,r=l=>o.set(this.identityProvider.getId(l.element).toString(),l);e.forEach(l=>qw(l,r));const a=[];for(const l of this.nodes){const c=this.identityProvider.getId(l.element).toString();if(!i.has(c))a.push(l);else{const h=o.get(c);h&&h.visible&&a.push(h)}}if(this.nodes.length>0&&a.length===0){const l=this.getFirstViewElementWithTrait();l&&a.push(l)}this._set(a,!0)}createNodeSet(){const e=new Set;for(const t of this.nodes)e.add(t);return e}}class ofe extends nU{constructor(e,t,i){super(e),this.tree=t,this.stickyScrollProvider=i}onViewPointer(e){if(Jz(e.browserEvent.target)||Gd(e.browserEvent.target)||D_(e.browserEvent.target)||e.browserEvent.isHandledByList)return;const t=e.element;if(!t)return super.onViewPointer(e);if(this.isSelectionRangeChangeEvent(e)||this.isSelectionSingleChangeEvent(e))return super.onViewPointer(e);const i=e.browserEvent.target,n=i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&e.browserEvent.offsetX<16,o=eb(e.browserEvent.target);let r=!1;if(o?r=!0:typeof this.tree.expandOnlyOnTwistieClick=="function"?r=this.tree.expandOnlyOnTwistieClick(t.element):r=!!this.tree.expandOnlyOnTwistieClick,o)this.handleStickyScrollMouseEvent(e,t);else{if(r&&!n&&e.browserEvent.detail!==2)return super.onViewPointer(e);if(!this.tree.expandOnDoubleClick&&e.browserEvent.detail===2)return super.onViewPointer(e)}if(t.collapsible&&(!o||n)){const a=this.tree.getNodeLocation(t),l=e.browserEvent.altKey;if(this.tree.setFocus([a]),this.tree.toggleCollapsed(a,l),n){e.browserEvent.isHandledByList=!0;return}}o||super.onViewPointer(e)}handleStickyScrollMouseEvent(e,t){if(dde(e.browserEvent.target)||hde(e.browserEvent.target))return;const i=this.stickyScrollProvider();if(!i)throw new Error("Sticky scroll controller not found");const n=this.list.indexOf(t),o=this.list.getElementTop(n),r=i.nodePositionTopBelowWidget(t);this.tree.scrollTop=o-r,this.list.domFocus(),this.list.setFocus([n]),this.list.setSelection([n])}onDoubleClick(e){e.browserEvent.target.classList.contains("monaco-tl-twistie")||!this.tree.expandOnDoubleClick||e.browserEvent.isHandledByList||super.onDoubleClick(e)}onMouseDown(e){const t=e.browserEvent.target;if(!pv(t)&&!eb(t)){super.onMouseDown(e);return}}onContextMenu(e){const t=e.browserEvent.target;if(!pv(t)&&!eb(t)){super.onContextMenu(e);return}}}class rfe extends Xo{constructor(e,t,i,n,o,r,a,l){super(e,t,i,n,l),this.focusTrait=o,this.selectionTrait=r,this.anchorTrait=a}createMouseController(e){return new ofe(this,e.tree,e.stickyScrollProvider)}splice(e,t,i=[]){if(super.splice(e,t,i),i.length===0)return;const n=[],o=[];let r;i.forEach((a,l)=>{this.focusTrait.has(a)&&n.push(e+l),this.selectionTrait.has(a)&&o.push(e+l),this.anchorTrait.has(a)&&(r=e+l)}),n.length>0&&super.setFocus(Pc([...super.getFocus(),...n])),o.length>0&&super.setSelection(Pc([...super.getSelection(),...o])),typeof r=="number"&&super.setAnchor(r)}setFocus(e,t,i=!1){super.setFocus(e,t),i||this.focusTrait.set(e.map(n=>this.element(n)),t)}setSelection(e,t,i=!1){super.setSelection(e,t),i||this.selectionTrait.set(e.map(n=>this.element(n)),t)}setAnchor(e,t=!1){super.setAnchor(e),t||(typeof e>"u"?this.anchorTrait.set([]):this.anchorTrait.set([this.element(e)]))}}class e${get onDidScroll(){return this.view.onDidScroll}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseDblClick(){return se.filter(se.map(this.view.onMouseDblClick,$y),e=>e.target!==yu.Filter)}get onMouseOver(){return se.map(this.view.onMouseOver,$y)}get onMouseOut(){return se.map(this.view.onMouseOut,$y)}get onContextMenu(){return se.any(se.filter(se.map(this.view.onContextMenu,sfe),e=>!e.isStickyScroll),this.stickyScrollController?.onContextMenu??se.None)}get onPointer(){return se.map(this.view.onPointer,$y)}get onKeyDown(){return this.view.onKeyDown}get onDidFocus(){return this.view.onDidFocus}get onDidChangeModel(){return se.signal(this.model.onDidSplice)}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get findMode(){return this.findController?.mode??xc.Highlight}set findMode(e){this.findController&&(this.findController.mode=e)}get findMatchType(){return this.findController?.matchType??eg.Fuzzy}set findMatchType(e){this.findController&&(this.findController.matchType=e)}get expandOnDoubleClick(){return typeof this._options.expandOnDoubleClick>"u"?!0:this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return typeof this._options.expandOnlyOnTwistieClick>"u"?!0:this._options.expandOnlyOnTwistieClick}get onDidDispose(){return this.view.onDidDispose}constructor(e,t,i,n,o={}){this._user=e,this._options=o,this.eventBufferer=new mC,this.onDidChangeFindOpenState=se.None,this.onDidChangeStickyScrollFocused=se.None,this.disposables=new Z,this._onWillRefilter=new O,this.onWillRefilter=this._onWillRefilter.event,this._onDidUpdateOptions=new O,this.treeDelegate=new CO(i);const r=new I5,a=new I5,l=this.disposables.add(new Yge(a.event)),c=new c2;this.renderers=n.map(f=>new H0(f,()=>this.model,r.event,l,c,o));for(const f of this.renderers)this.disposables.add(f);let d;o.keyboardNavigationLabelProvider&&(d=new Xge(this,o.keyboardNavigationLabelProvider,o.filter),o={...o,filter:d},this.disposables.add(d)),this.focus=new WD(()=>this.view.getFocusedElements()[0],o.identityProvider),this.selection=new WD(()=>this.view.getSelectedElements()[0],o.identityProvider),this.anchor=new WD(()=>this.view.getAnchorElement(),o.identityProvider),this.view=new rfe(e,t,this.treeDelegate,this.renderers,this.focus,this.selection,this.anchor,{...Gge(()=>this.model,o),tree:this,stickyScrollProvider:()=>this.stickyScrollController}),this.model=this.createModel(e,this.view,o),r.input=this.model.onDidChangeCollapseState;const h=se.forEach(this.model.onDidSplice,f=>{this.eventBufferer.bufferEvents(()=>{this.focus.onDidModelSplice(f),this.selection.onDidModelSplice(f)})},this.disposables);h(()=>null,null,this.disposables);const u=this.disposables.add(new O),g=this.disposables.add(new Cr(0));if(this.disposables.add(se.any(h,this.focus.onDidChange,this.selection.onDidChange)(()=>{g.trigger(()=>{const f=new Set;for(const m of this.focus.getNodes())f.add(m);for(const m of this.selection.getNodes())f.add(m);u.fire([...f.values()])})})),a.input=u.event,o.keyboardSupport!==!1){const f=se.chain(this.view.onKeyDown,m=>m.filter(_=>!Gd(_.target)).map(_=>new Ft(_)));se.chain(f,m=>m.filter(_=>_.keyCode===15))(this.onLeftArrow,this,this.disposables),se.chain(f,m=>m.filter(_=>_.keyCode===17))(this.onRightArrow,this,this.disposables),se.chain(f,m=>m.filter(_=>_.keyCode===10))(this.onSpace,this,this.disposables)}if((o.findWidgetEnabled??!0)&&o.keyboardNavigationLabelProvider&&o.contextViewProvider){const f=this.options.findWidgetStyles?{styles:this.options.findWidgetStyles}:void 0;this.findController=new Qge(this,this.model,this.view,d,o.contextViewProvider,f),this.focusNavigationFilter=m=>this.findController.shouldAllowFocus(m),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.disposables.add(this.findController),this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType}else this.onDidChangeFindMode=se.None,this.onDidChangeFindMatchType=se.None;o.enableStickyScroll&&(this.stickyScrollController=new SW(this,this.model,this.view,this.renderers,this.treeDelegate,o),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus),this.styleElement=$o(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===Hp.Always)}updateOptions(e={}){this._options={...this._options,...e};for(const t of this.renderers)t.updateOptions(e);this.view.updateOptions(this._options),this.findController?.updateOptions(e),this.updateStickyScroll(e),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===Hp.Always)}get options(){return this._options}updateStickyScroll(e){!this.stickyScrollController&&this._options.enableStickyScroll?(this.stickyScrollController=new SW(this,this.model,this.view,this.renderers,this.treeDelegate,this._options),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus):this.stickyScrollController&&!this._options.enableStickyScroll&&(this.onDidChangeStickyScrollFocused=se.None,this.stickyScrollController.dispose(),this.stickyScrollController=void 0),this.stickyScrollController?.updateOptions(e)}getHTMLElement(){return this.view.getHTMLElement()}get scrollTop(){return this.view.scrollTop}set scrollTop(e){this.view.scrollTop=e}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get ariaLabel(){return this.view.ariaLabel}set ariaLabel(e){this.view.ariaLabel=e}domFocus(){this.stickyScrollController?.focusedLast()?this.stickyScrollController.domFocus():this.view.domFocus()}layout(e,t){this.view.layout(e,t),Jd(t)&&this.findController?.layout(t)}style(e){const t=`.${this.view.domId}`,i=[];e.treeIndentGuidesStroke&&(i.push(`.monaco-list${t}:hover .monaco-tl-indent > .indent-guide, .monaco-list${t}.always .monaco-tl-indent > .indent-guide  { border-color: ${e.treeInactiveIndentGuidesStroke}; }`),i.push(`.monaco-list${t} .monaco-tl-indent > .indent-guide.active { border-color: ${e.treeIndentGuidesStroke}; }`));const n=e.treeStickyScrollBackground??e.listBackground;n&&(i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container { background-color: ${n}; }`),i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-row { background-color: ${n}; }`)),e.treeStickyScrollBorder&&i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container { border-bottom: 1px solid ${e.treeStickyScrollBorder}; }`),e.treeStickyScrollShadow&&i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-container-shadow { box-shadow: ${e.treeStickyScrollShadow} 0 6px 6px -6px inset; height: 3px; }`),e.listFocusForeground&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { color: inherit; }`));const o=Ec(e.listFocusAndSelectionOutline,Ec(e.listSelectionOutline,e.listFocusOutline??""));o&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused.selected { outline: 1px solid ${o}; outline-offset: -1px;}`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused.selected { outline: inherit;}`)),e.listFocusOutline&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { outline: inherit; }`),i.push(`.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.passive-focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),i.push(`.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused.sticky-scroll-focused .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`),i.push(`.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused:not(.sticky-scroll-focused) .monaco-tree-sticky-container .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`)),this.styleElement.textContent=i.join(`
`),this.view.style(e)}getParentElement(e){const t=this.model.getParentNodeLocation(e);return this.model.getNode(t).element}getFirstElementChild(e){return this.model.getFirstElementChild(e)}getNode(e){return this.model.getNode(e)}getNodeLocation(e){return this.model.getNodeLocation(e)}collapse(e,t=!1){return this.model.setCollapsed(e,!0,t)}expand(e,t=!1){return this.model.setCollapsed(e,!1,t)}toggleCollapsed(e,t=!1){return this.model.setCollapsed(e,void 0,t)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setSelection(e,t){this.eventBufferer.bufferEvents(()=>{const i=e.map(o=>this.model.getNode(o));this.selection.set(i,t);const n=e.map(o=>this.model.getListIndex(o)).filter(o=>o>-1);this.view.setSelection(n,t,!0)})}getSelection(){return this.selection.get()}setFocus(e,t){this.eventBufferer.bufferEvents(()=>{const i=e.map(o=>this.model.getNode(o));this.focus.set(i,t);const n=e.map(o=>this.model.getListIndex(o)).filter(o=>o>-1);this.view.setFocus(n,t,!0)})}focusNext(e=1,t=!1,i,n=cc(i)&&i.altKey?void 0:this.focusNavigationFilter){this.view.focusNext(e,t,i,n)}focusPrevious(e=1,t=!1,i,n=cc(i)&&i.altKey?void 0:this.focusNavigationFilter){this.view.focusPrevious(e,t,i,n)}focusNextPage(e,t=cc(e)&&e.altKey?void 0:this.focusNavigationFilter){return this.view.focusNextPage(e,t)}focusPreviousPage(e,t=cc(e)&&e.altKey?void 0:this.focusNavigationFilter){return this.view.focusPreviousPage(e,t,()=>this.stickyScrollController?.height??0)}focusLast(e,t=cc(e)&&e.altKey?void 0:this.focusNavigationFilter){this.view.focusLast(e,t)}focusFirst(e,t=cc(e)&&e.altKey?void 0:this.focusNavigationFilter){this.view.focusFirst(e,t)}getFocus(){return this.focus.get()}reveal(e,t){this.model.expandTo(e);const i=this.model.getListIndex(e);if(i!==-1)if(!this.stickyScrollController)this.view.reveal(i,t);else{const n=this.stickyScrollController.nodePositionTopBelowWidget(this.getNode(e));this.view.reveal(i,t,n)}}onLeftArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!0)){const r=this.model.getParentNodeLocation(n);if(!r)return;const a=this.model.getListIndex(r);this.view.reveal(a),this.view.setFocus([a])}}onRightArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!1)){if(!i.children.some(l=>l.visible))return;const[r]=this.view.getFocus(),a=r+1;this.view.reveal(a),this.view.setFocus([a])}}onSpace(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],n=this.model.getNodeLocation(i),o=e.browserEvent.altKey;this.model.setCollapsed(n,void 0,o)}dispose(){At(this.disposables),this.stickyScrollController?.dispose(),this.view.dispose()}}class yO{constructor(e,t,i={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.nodesByIdentity=new Map,this.model=new Zge(e,t,null,i),this.onDidSplice=this.model.onDidSplice,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,i.sorter&&(this.sorter={compare(n,o){return i.sorter.compare(n.element,o.element)}}),this.identityProvider=i.identityProvider}setChildren(e,t=st.empty(),i={}){const n=this.getElementLocation(e);this._setChildren(n,this.preserveCollapseState(t),i)}_setChildren(e,t=st.empty(),i){const n=new Set,o=new Set,r=l=>{if(l.element===null)return;const c=l;if(n.add(c.element),this.nodes.set(c.element,c),this.identityProvider){const d=this.identityProvider.getId(c.element).toString();o.add(d),this.nodesByIdentity.set(d,c)}i.onDidCreateNode?.(c)},a=l=>{if(l.element===null)return;const c=l;if(n.has(c.element)||this.nodes.delete(c.element),this.identityProvider){const d=this.identityProvider.getId(c.element).toString();o.has(d)||this.nodesByIdentity.delete(d)}i.onDidDeleteNode?.(c)};this.model.splice([...e,0],Number.MAX_VALUE,t,{...i,onDidCreateNode:r,onDidDeleteNode:a})}preserveCollapseState(e=st.empty()){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),st.map(e,t=>{let i=this.nodes.get(t.element);if(!i&&this.identityProvider){const r=this.identityProvider.getId(t.element).toString();i=this.nodesByIdentity.get(r)}if(!i){let r;return typeof t.collapsed>"u"?r=void 0:t.collapsed===Io.Collapsed||t.collapsed===Io.PreserveOrCollapsed?r=!0:t.collapsed===Io.Expanded||t.collapsed===Io.PreserveOrExpanded?r=!1:r=!!t.collapsed,{...t,children:this.preserveCollapseState(t.children),collapsed:r}}const n=typeof t.collapsible=="boolean"?t.collapsible:i.collapsible;let o;return typeof t.collapsed>"u"||t.collapsed===Io.PreserveOrCollapsed||t.collapsed===Io.PreserveOrExpanded?o=i.collapsed:t.collapsed===Io.Collapsed?o=!0:t.collapsed===Io.Expanded?o=!1:o=!!t.collapsed,{...t,collapsible:n,collapsed:o,children:this.preserveCollapseState(t.children)}})}rerender(e){const t=this.getElementLocation(e);this.model.rerender(t)}getFirstElementChild(e=null){const t=this.getElementLocation(e);return this.model.getFirstElementChild(t)}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getElementLocation(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getElementLocation(e);return this.model.getListRenderCount(t)}isCollapsible(e){const t=this.getElementLocation(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getElementLocation(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getElementLocation(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const n=this.getElementLocation(e);return this.model.setCollapsed(n,t,i)}expandTo(e){const t=this.getElementLocation(e);this.model.expandTo(t)}refilter(){this.model.refilter()}getNode(e=null){if(e===null)return this.model.getNode(this.model.rootRef);const t=this.nodes.get(e);if(!t)throw new Po(this.user,`Tree element not found: ${e}`);return t}getNodeLocation(e){return e.element}getParentNodeLocation(e){if(e===null)throw new Po(this.user,"Invalid getParentNodeLocation call");const t=this.nodes.get(e);if(!t)throw new Po(this.user,`Tree element not found: ${e}`);const i=this.model.getNodeLocation(t),n=this.model.getParentNodeLocation(i);return this.model.getNode(n).element}getElementLocation(e){if(e===null)return[];const t=this.nodes.get(e);if(!t)throw new Po(this.user,`Tree element not found: ${e}`);return this.model.getNodeLocation(t)}}function Gw(s){const e=[s.element],t=s.incompressible||!1;return{element:{elements:e,incompressible:t},children:st.map(st.from(s.children),Gw),collapsible:s.collapsible,collapsed:s.collapsed}}function Yw(s){const e=[s.element],t=s.incompressible||!1;let i,n;for(;[n,i]=st.consume(st.from(s.children),2),!(n.length!==1||n[0].incompressible);)s=n[0],e.push(s.element);return{element:{elements:e,incompressible:t},children:st.map(st.concat(n,i),Yw),collapsible:s.collapsible,collapsed:s.collapsed}}function BN(s,e=0){let t;return e<s.element.elements.length-1?t=[BN(s,e+1)]:t=st.map(st.from(s.children),i=>BN(i,0)),e===0&&s.element.incompressible?{element:s.element.elements[e],children:t,incompressible:!0,collapsible:s.collapsible,collapsed:s.collapsed}:{element:s.element.elements[e],children:t,collapsible:s.collapsible,collapsed:s.collapsed}}function LW(s){return BN(s,0)}function t$(s,e,t){return s.element===e?{...s,children:t}:{...s,children:st.map(st.from(s.children),i=>t$(i,e,t))}}const afe=s=>({getId(e){return e.elements.map(t=>s.getId(t).toString()).join("\0")}});class lfe{get onDidSplice(){return this.model.onDidSplice}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}constructor(e,t,i={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.model=new yO(e,t,i),this.enabled=typeof i.compressionEnabled>"u"?!0:i.compressionEnabled,this.identityProvider=i.identityProvider}setChildren(e,t=st.empty(),i){const n=i.diffIdentityProvider&&afe(i.diffIdentityProvider);if(e===null){const f=st.map(t,this.enabled?Yw:Gw);this._setChildren(null,f,{diffIdentityProvider:n,diffDepth:1/0});return}const o=this.nodes.get(e);if(!o)throw new Po(this.user,"Unknown compressed tree node");const r=this.model.getNode(o),a=this.model.getParentNodeLocation(o),l=this.model.getNode(a),c=LW(r),d=t$(c,e,t),h=(this.enabled?Yw:Gw)(d),u=i.diffIdentityProvider?(f,m)=>i.diffIdentityProvider.getId(f)===i.diffIdentityProvider.getId(m):void 0;if(ii(h.element.elements,r.element.elements,u)){this._setChildren(o,h.children||st.empty(),{diffIdentityProvider:n,diffDepth:1});return}const g=l.children.map(f=>f===r?h:f);this._setChildren(l.element,g,{diffIdentityProvider:n,diffDepth:r.depth-l.depth})}isCompressionEnabled(){return this.enabled}setCompressionEnabled(e){if(e===this.enabled)return;this.enabled=e;const i=this.model.getNode().children,n=st.map(i,LW),o=st.map(n,e?Yw:Gw);this._setChildren(null,o,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(e,t,i){const n=new Set,o=a=>{for(const l of a.element.elements)n.add(l),this.nodes.set(l,a.element)},r=a=>{for(const l of a.element.elements)n.has(l)||this.nodes.delete(l)};this.model.setChildren(e,t,{...i,onDidCreateNode:o,onDidDeleteNode:r})}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getCompressedNode(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getCompressedNode(e);return this.model.getListRenderCount(t)}getNode(e){if(typeof e>"u")return this.model.getNode();const t=this.getCompressedNode(e);return this.model.getNode(t)}getNodeLocation(e){const t=this.model.getNodeLocation(e);return t===null?null:t.elements[t.elements.length-1]}getParentNodeLocation(e){const t=this.getCompressedNode(e),i=this.model.getParentNodeLocation(t);return i===null?null:i.elements[i.elements.length-1]}getFirstElementChild(e){const t=this.getCompressedNode(e);return this.model.getFirstElementChild(t)}isCollapsible(e){const t=this.getCompressedNode(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getCompressedNode(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getCompressedNode(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const n=this.getCompressedNode(e);return this.model.setCollapsed(n,t,i)}expandTo(e){const t=this.getCompressedNode(e);this.model.expandTo(t)}rerender(e){const t=this.getCompressedNode(e);this.model.rerender(t)}refilter(){this.model.refilter()}getCompressedNode(e){if(e===null)return null;const t=this.nodes.get(e);if(!t)throw new Po(this.user,`Tree element not found: ${e}`);return t}}const cfe=s=>s[s.length-1];class wO{get element(){return this.node.element===null?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map(e=>new wO(this.unwrapper,e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e,t){this.unwrapper=e,this.node=t}}function dfe(s,e){return{splice(t,i,n){e.splice(t,i,n.map(o=>s.map(o)))},updateElementHeight(t,i){e.updateElementHeight(t,i)}}}function hfe(s,e){return{...e,identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(s(t))}},sorter:e.sorter&&{compare(t,i){return e.sorter.compare(t.elements[0],i.elements[0])}},filter:e.filter&&{filter(t,i){return e.filter.filter(s(t),i)}}}}class ufe{get onDidSplice(){return se.map(this.model.onDidSplice,({insertedNodes:e,deletedNodes:t})=>({insertedNodes:e.map(i=>this.nodeMapper.map(i)),deletedNodes:t.map(i=>this.nodeMapper.map(i))}))}get onDidChangeCollapseState(){return se.map(this.model.onDidChangeCollapseState,({node:e,deep:t})=>({node:this.nodeMapper.map(e),deep:t}))}get onDidChangeRenderNodeCount(){return se.map(this.model.onDidChangeRenderNodeCount,e=>this.nodeMapper.map(e))}constructor(e,t,i={}){this.rootRef=null,this.elementMapper=i.elementMapper||cfe;const n=o=>this.elementMapper(o.elements);this.nodeMapper=new bO(o=>new wO(n,o)),this.model=new lfe(e,dfe(this.nodeMapper,t),hfe(n,i))}setChildren(e,t=st.empty(),i={}){this.model.setChildren(e,t,i)}isCompressionEnabled(){return this.model.isCompressionEnabled()}setCompressionEnabled(e){this.model.setCompressionEnabled(e)}has(e){return this.model.has(e)}getListIndex(e){return this.model.getListIndex(e)}getListRenderCount(e){return this.model.getListRenderCount(e)}getNode(e){return this.nodeMapper.map(this.model.getNode(e))}getNodeLocation(e){return e.element}getParentNodeLocation(e){return this.model.getParentNodeLocation(e)}getFirstElementChild(e){const t=this.model.getFirstElementChild(e);return t===null||typeof t>"u"?t:this.elementMapper(t.elements)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}setCollapsed(e,t,i){return this.model.setCollapsed(e,t,i)}expandTo(e){return this.model.expandTo(e)}rerender(e){return this.model.rerender(e)}refilter(){return this.model.refilter()}getCompressedTreeNode(e=null){return this.model.getNode(e)}}var gfe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o};class SO extends e${get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}constructor(e,t,i,n,o={}){super(e,t,i,n,o),this.user=e}setChildren(e,t=st.empty(),i){this.model.setChildren(e,t,i)}rerender(e){if(e===void 0){this.view.rerender();return}this.model.rerender(e)}hasElement(e){return this.model.has(e)}createModel(e,t,i){return new yO(e,t,i)}}class i${get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}constructor(e,t,i){this._compressedTreeNodeProvider=e,this.stickyScrollDelegate=t,this.renderer=i,this.templateId=i.templateId,i.onDidChangeTwistieState&&(this.onDidChangeTwistieState=i.onDidChangeTwistieState)}renderTemplate(e){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){let o=this.stickyScrollDelegate.getCompressedNode(e);o||(o=this.compressedTreeNodeProvider.getCompressedTreeNode(e.element)),o.element.elements.length===1?(i.compressedTreeNode=void 0,this.renderer.renderElement(e,t,i.data,n)):(i.compressedTreeNode=o,this.renderer.renderCompressedElements(o,t,i.data,n))}disposeElement(e,t,i,n){i.compressedTreeNode?this.renderer.disposeCompressedElements?.(i.compressedTreeNode,t,i.data,n):this.renderer.disposeElement?.(e,t,i.data,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.data)}renderTwistie(e,t){return this.renderer.renderTwistie?this.renderer.renderTwistie(e,t):!1}}gfe([Ti],i$.prototype,"compressedTreeNodeProvider",null);class ffe{constructor(e){this.modelProvider=e,this.compressedStickyNodes=new Map}getCompressedNode(e){return this.compressedStickyNodes.get(e)}constrainStickyScrollNodes(e,t,i){if(this.compressedStickyNodes.clear(),e.length===0)return[];for(let n=0;n<e.length;n++){const o=e[n],r=o.position+o.height;if(n+1<e.length&&r+e[n+1].height>i||n>=t-1&&t<e.length){const l=e.slice(0,n),c=e.slice(n),d=this.compressStickyNodes(c);return[...l,d]}}return e}compressStickyNodes(e){if(e.length===0)throw new Error("Can't compress empty sticky nodes");const t=this.modelProvider();if(!t.isCompressionEnabled())return e[0];const i=[];for(let c=0;c<e.length;c++){const d=e[c],h=t.getCompressedTreeNode(d.node.element);if(h.element){if(c!==0&&h.element.incompressible)break;i.push(...h.element.elements)}}if(i.length<2)return e[0];const n=e[e.length-1],o={elements:i,incompressible:!1},r={...n.node,children:[],element:o},a=new Proxy(e[0].node,{}),l={node:a,startIndex:e[0].startIndex,endIndex:n.endIndex,position:e[0].position,height:e[0].height};return this.compressedStickyNodes.set(a,r),l}}function pfe(s,e){return e&&{...e,keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(t){let i;try{i=s().getCompressedTreeNode(t)}catch{return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t)}return i.element.elements.length===1?e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t):e.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(i.element.elements)}}}}class n$ extends SO{constructor(e,t,i,n,o={}){const r=()=>this,a=new ffe(()=>this.model),l=n.map(c=>new i$(r,a,c));super(e,t,i,l,{...pfe(r,o),stickyScrollDelegate:a})}setChildren(e,t=st.empty(),i){this.model.setChildren(e,t,i)}createModel(e,t,i){return new ufe(e,t,i)}updateOptions(e={}){super.updateOptions(e),typeof e.compressionEnabled<"u"&&this.model.setCompressionEnabled(e.compressionEnabled)}getCompressedTreeNode(e=null){return this.model.getCompressedTreeNode(e)}}function HD(s){return{...s,children:[],refreshPromise:void 0,stale:!0,slow:!1,forceExpanded:!1}}function WN(s,e){return e.parent?e.parent===s?!0:WN(s,e.parent):!1}function mfe(s,e){return s===e||WN(s,e)||WN(e,s)}class LO{get element(){return this.node.element.element}get children(){return this.node.children.map(e=>new LO(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e){this.node=e}}class _fe{constructor(e,t,i){this.renderer=e,this.nodeMapper=t,this.onDidChangeTwistieState=i,this.renderedNodes=new Map,this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,n)}renderTwistie(e,t){return e.slow?(t.classList.add(...Ie.asClassNameArray(J.treeItemLoading)),!0):(t.classList.remove(...Ie.asClassNameArray(J.treeItemLoading)),!1)}disposeElement(e,t,i,n){this.renderer.disposeElement?.(this.nodeMapper.map(e),t,i.templateData,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear()}}function xW(s){return{browserEvent:s.browserEvent,elements:s.elements.map(e=>e.element)}}function kW(s){return{browserEvent:s.browserEvent,element:s.element&&s.element.element,target:s.target}}class bfe extends OC{constructor(e){super(e.elements.map(t=>t.element)),this.data=e}}function VD(s){return s instanceof OC?new bfe(s):s}class vfe{constructor(e){this.dnd=e}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){this.dnd.onDragStart?.(VD(e),t)}onDragOver(e,t,i,n,o,r=!0){return this.dnd.onDragOver(VD(e),t&&t.element,i,n,o)}drop(e,t,i,n,o){this.dnd.drop(VD(e),t&&t.element,i,n,o)}onDragEnd(e){this.dnd.onDragEnd?.(e)}dispose(){this.dnd.dispose()}}function s$(s){return s&&{...s,collapseByDefault:!0,identityProvider:s.identityProvider&&{getId(e){return s.identityProvider.getId(e.element)}},dnd:s.dnd&&new vfe(s.dnd),multipleSelectionController:s.multipleSelectionController&&{isSelectionSingleChangeEvent(e){return s.multipleSelectionController.isSelectionSingleChangeEvent({...e,element:e.element})},isSelectionRangeChangeEvent(e){return s.multipleSelectionController.isSelectionRangeChangeEvent({...e,element:e.element})}},accessibilityProvider:s.accessibilityProvider&&{...s.accessibilityProvider,getPosInSet:void 0,getSetSize:void 0,getRole:s.accessibilityProvider.getRole?e=>s.accessibilityProvider.getRole(e.element):()=>"treeitem",isChecked:s.accessibilityProvider.isChecked?e=>!!s.accessibilityProvider?.isChecked(e.element):void 0,getAriaLabel(e){return s.accessibilityProvider.getAriaLabel(e.element)},getWidgetAriaLabel(){return s.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:s.accessibilityProvider.getWidgetRole?()=>s.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:s.accessibilityProvider.getAriaLevel&&(e=>s.accessibilityProvider.getAriaLevel(e.element)),getActiveDescendantId:s.accessibilityProvider.getActiveDescendantId&&(e=>s.accessibilityProvider.getActiveDescendantId(e.element))},filter:s.filter&&{filter(e,t){return s.filter.filter(e.element,t)}},keyboardNavigationLabelProvider:s.keyboardNavigationLabelProvider&&{...s.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(e){return s.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element)}},sorter:void 0,expandOnlyOnTwistieClick:typeof s.expandOnlyOnTwistieClick>"u"?void 0:typeof s.expandOnlyOnTwistieClick!="function"?s.expandOnlyOnTwistieClick:e=>s.expandOnlyOnTwistieClick(e.element),defaultFindVisibility:e=>e.hasChildren&&e.stale?1:typeof s.defaultFindVisibility=="number"?s.defaultFindVisibility:typeof s.defaultFindVisibility>"u"?2:s.defaultFindVisibility(e.element)}}function HN(s,e){e(s),s.children.forEach(t=>HN(t,e))}class o${get onDidScroll(){return this.tree.onDidScroll}get onDidChangeFocus(){return se.map(this.tree.onDidChangeFocus,xW)}get onDidChangeSelection(){return se.map(this.tree.onDidChangeSelection,xW)}get onMouseDblClick(){return se.map(this.tree.onMouseDblClick,kW)}get onPointer(){return se.map(this.tree.onPointer,kW)}get onDidFocus(){return this.tree.onDidFocus}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidChangeFindOpenState(){return this.tree.onDidChangeFindOpenState}get onDidChangeStickyScrollFocused(){return this.tree.onDidChangeStickyScrollFocused}get onDidDispose(){return this.tree.onDidDispose}constructor(e,t,i,n,o,r={}){this.user=e,this.dataSource=o,this.nodes=new Map,this.subTreeRefreshPromises=new Map,this.refreshPromises=new Map,this._onDidRender=new O,this._onDidChangeNodeSlowState=new O,this.nodeMapper=new bO(a=>new LO(a)),this.disposables=new Z,this.identityProvider=r.identityProvider,this.autoExpandSingleChildren=typeof r.autoExpandSingleChildren>"u"?!1:r.autoExpandSingleChildren,this.sorter=r.sorter,this.getDefaultCollapseState=a=>r.collapseByDefault?r.collapseByDefault(a)?Io.PreserveOrCollapsed:Io.PreserveOrExpanded:void 0,this.tree=this.createTree(e,t,i,n,r),this.onDidChangeFindMode=this.tree.onDidChangeFindMode,this.onDidChangeFindMatchType=this.tree.onDidChangeFindMatchType,this.root=HD({element:void 0,parent:null,hasChildren:!0,defaultCollapseState:void 0}),this.identityProvider&&(this.root={...this.root,id:null}),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables)}createTree(e,t,i,n,o){const r=new CO(i),a=n.map(c=>new _fe(c,this.nodeMapper,this._onDidChangeNodeSlowState.event)),l=s$(o)||{};return new SO(e,t,r,a,l)}updateOptions(e={}){this.tree.updateOptions(e)}getHTMLElement(){return this.tree.getHTMLElement()}get scrollTop(){return this.tree.scrollTop}set scrollTop(e){this.tree.scrollTop=e}get scrollHeight(){return this.tree.scrollHeight}get renderHeight(){return this.tree.renderHeight}domFocus(){this.tree.domFocus()}layout(e,t){this.tree.layout(e,t)}style(e){this.tree.style(e)}getInput(){return this.root.element}async setInput(e,t){this.refreshPromises.forEach(n=>n.cancel()),this.refreshPromises.clear(),this.root.element=e;const i=t&&{viewState:t,focus:[],selection:[]};await this._updateChildren(e,!0,!1,i),i&&(this.tree.setFocus(i.focus),this.tree.setSelection(i.selection)),t&&typeof t.scrollTop=="number"&&(this.scrollTop=t.scrollTop)}async _updateChildren(e=this.root.element,t=!0,i=!1,n,o){if(typeof this.root.element>"u")throw new Po(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await se.toPromise(this._onDidRender.event));const r=this.getDataNode(e);if(await this.refreshAndRenderNode(r,t,n,o),i)try{this.tree.rerender(r)}catch{}}rerender(e){if(e===void 0||e===this.root.element){this.tree.rerender();return}const t=this.getDataNode(e);this.tree.rerender(t)}getNode(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getNode(t===this.root?null:t);return this.nodeMapper.map(i)}collapse(e,t=!1){const i=this.getDataNode(e);return this.tree.collapse(i===this.root?null:i,t)}async expand(e,t=!1){if(typeof this.root.element>"u")throw new Po(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await se.toPromise(this._onDidRender.event));const i=this.getDataNode(e);if(this.tree.hasElement(i)&&!this.tree.isCollapsible(i)||(i.refreshPromise&&(await this.root.refreshPromise,await se.toPromise(this._onDidRender.event)),i!==this.root&&!i.refreshPromise&&!this.tree.isCollapsed(i)))return!1;const n=this.tree.expand(i===this.root?null:i,t);return i.refreshPromise&&(await this.root.refreshPromise,await se.toPromise(this._onDidRender.event)),n}setSelection(e,t){const i=e.map(n=>this.getDataNode(n));this.tree.setSelection(i,t)}getSelection(){return this.tree.getSelection().map(t=>t.element)}setFocus(e,t){const i=e.map(n=>this.getDataNode(n));this.tree.setFocus(i,t)}getFocus(){return this.tree.getFocus().map(t=>t.element)}reveal(e,t){this.tree.reveal(this.getDataNode(e),t)}getParentElement(e){const t=this.tree.getParentElement(this.getDataNode(e));return t&&t.element}getFirstElementChild(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getFirstElementChild(t===this.root?null:t);return i&&i.element}getDataNode(e){const t=this.nodes.get(e===this.root.element?null:e);if(!t)throw new Po(this.user,`Data tree node not found: ${e}`);return t}async refreshAndRenderNode(e,t,i,n){await this.refreshNode(e,t,i),!this.disposables.isDisposed&&this.render(e,i,n)}async refreshNode(e,t,i){let n;if(this.subTreeRefreshPromises.forEach((o,r)=>{!n&&mfe(r,e)&&(n=o.then(()=>this.refreshNode(e,t,i)))}),n)return n;if(e!==this.root&&this.tree.getNode(e).collapsed){e.hasChildren=!!this.dataSource.hasChildren(e.element),e.stale=!0,this.setChildren(e,[],t,i);return}return this.doRefreshSubTree(e,t,i)}async doRefreshSubTree(e,t,i){let n;e.refreshPromise=new Promise(o=>n=o),this.subTreeRefreshPromises.set(e,e.refreshPromise),e.refreshPromise.finally(()=>{e.refreshPromise=void 0,this.subTreeRefreshPromises.delete(e)});try{const o=await this.doRefreshNode(e,t,i);e.stale=!1,await iE.settled(o.map(r=>this.doRefreshSubTree(r,t,i)))}finally{n()}}async doRefreshNode(e,t,i){e.hasChildren=!!this.dataSource.hasChildren(e.element);let n;if(!e.hasChildren)n=Promise.resolve(st.empty());else{const o=this.doGetChildren(e);if(w5(o))n=Promise.resolve(o);else{const r=Wc(800);r.then(()=>{e.slow=!0,this._onDidChangeNodeSlowState.fire(e)},a=>null),n=o.finally(()=>r.cancel())}}try{const o=await n;return this.setChildren(e,o,t,i)}catch(o){if(e!==this.root&&this.tree.hasElement(e)&&this.tree.collapse(e),xr(o))return[];throw o}finally{e.slow&&(e.slow=!1,this._onDidChangeNodeSlowState.fire(e))}}doGetChildren(e){let t=this.refreshPromises.get(e);if(t)return t;const i=this.dataSource.getChildren(e.element);return w5(i)?this.processChildren(i):(t=en(async()=>this.processChildren(await i)),this.refreshPromises.set(e,t),t.finally(()=>{this.refreshPromises.delete(e)}))}_onDidChangeCollapseState({node:e,deep:t}){e.element!==null&&!e.collapsed&&e.element.stale&&(t?this.collapse(e.element.element):this.refreshAndRenderNode(e.element,!1).catch(Oe))}setChildren(e,t,i,n){const o=[...t];if(e.children.length===0&&o.length===0)return[];const r=new Map,a=new Map;for(const d of e.children)r.set(d.element,d),this.identityProvider&&a.set(d.id,{node:d,collapsed:this.tree.hasElement(d)&&this.tree.isCollapsed(d)});const l=[],c=o.map(d=>{const h=!!this.dataSource.hasChildren(d);if(!this.identityProvider){const m=HD({element:d,parent:e,hasChildren:h,defaultCollapseState:this.getDefaultCollapseState(d)});return h&&m.defaultCollapseState===Io.PreserveOrExpanded&&l.push(m),m}const u=this.identityProvider.getId(d).toString(),g=a.get(u);if(g){const m=g.node;return r.delete(m.element),this.nodes.delete(m.element),this.nodes.set(d,m),m.element=d,m.hasChildren=h,i?g.collapsed?(m.children.forEach(_=>HN(_,b=>this.nodes.delete(b.element))),m.children.splice(0,m.children.length),m.stale=!0):l.push(m):h&&!g.collapsed&&l.push(m),m}const f=HD({element:d,parent:e,id:u,hasChildren:h,defaultCollapseState:this.getDefaultCollapseState(d)});return n&&n.viewState.focus&&n.viewState.focus.indexOf(u)>-1&&n.focus.push(f),n&&n.viewState.selection&&n.viewState.selection.indexOf(u)>-1&&n.selection.push(f),(n&&n.viewState.expanded&&n.viewState.expanded.indexOf(u)>-1||h&&f.defaultCollapseState===Io.PreserveOrExpanded)&&l.push(f),f});for(const d of r.values())HN(d,h=>this.nodes.delete(h.element));for(const d of c)this.nodes.set(d.element,d);return e.children.splice(0,e.children.length,...c),e!==this.root&&this.autoExpandSingleChildren&&c.length===1&&l.length===0&&(c[0].forceExpanded=!0,l.push(c[0])),l}render(e,t,i){const n=e.children.map(r=>this.asTreeElement(r,t)),o=i&&{...i,diffIdentityProvider:i.diffIdentityProvider&&{getId(r){return i.diffIdentityProvider.getId(r.element)}}};this.tree.setChildren(e===this.root?null:e,n,o),e!==this.root&&this.tree.setCollapsible(e,e.hasChildren),this._onDidRender.fire()}asTreeElement(e,t){if(e.stale)return{element:e,collapsible:e.hasChildren,collapsed:!0};let i;return t&&t.viewState.expanded&&e.id&&t.viewState.expanded.indexOf(e.id)>-1?i=!1:e.forceExpanded?(i=!1,e.forceExpanded=!1):i=e.defaultCollapseState,{element:e,children:e.hasChildren?st.map(e.children,n=>this.asTreeElement(n,t)):[],collapsible:e.hasChildren,collapsed:i}}processChildren(e){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),e}dispose(){this.disposables.dispose(),this.tree.dispose()}}class xO{get element(){return{elements:this.node.element.elements.map(e=>e.element),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map(e=>new xO(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e){this.node=e}}class Cfe{constructor(e,t,i,n){this.renderer=e,this.nodeMapper=t,this.compressibleNodeMapperProvider=i,this.onDidChangeTwistieState=n,this.renderedNodes=new Map,this.disposables=[],this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,n)}renderCompressedElements(e,t,i,n){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(e),t,i.templateData,n)}renderTwistie(e,t){return e.slow?(t.classList.add(...Ie.asClassNameArray(J.treeItemLoading)),!0):(t.classList.remove(...Ie.asClassNameArray(J.treeItemLoading)),!1)}disposeElement(e,t,i,n){this.renderer.disposeElement?.(this.nodeMapper.map(e),t,i.templateData,n)}disposeCompressedElements(e,t,i,n){this.renderer.disposeCompressedElements?.(this.compressibleNodeMapperProvider().map(e),t,i.templateData,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=At(this.disposables)}}function yfe(s){const e=s&&s$(s);return e&&{...e,keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{...e.keyboardNavigationLabelProvider,getCompressedNodeKeyboardNavigationLabel(t){return s.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(t.map(i=>i.element))}}}}class wfe extends o${constructor(e,t,i,n,o,r,a={}){super(e,t,i,o,r,a),this.compressionDelegate=n,this.compressibleNodeMapper=new bO(l=>new xO(l)),this.filter=a.filter}createTree(e,t,i,n,o){const r=new CO(i),a=n.map(c=>new Cfe(c,this.nodeMapper,()=>this.compressibleNodeMapper,this._onDidChangeNodeSlowState.event)),l=yfe(o)||{};return new n$(e,t,r,a,l)}asTreeElement(e,t){return{incompressible:this.compressionDelegate.isIncompressible(e.element),...super.asTreeElement(e,t)}}updateOptions(e={}){this.tree.updateOptions(e)}render(e,t,i){if(!this.identityProvider)return super.render(e,t);const n=g=>this.identityProvider.getId(g).toString(),o=g=>{const f=new Set;for(const m of g){const _=this.tree.getCompressedTreeNode(m===this.root?null:m);if(_.element)for(const b of _.element.elements)f.add(n(b.element))}return f},r=o(this.tree.getSelection()),a=o(this.tree.getFocus());super.render(e,t,i);const l=this.getSelection();let c=!1;const d=this.getFocus();let h=!1;const u=g=>{const f=g.element;if(f)for(let m=0;m<f.elements.length;m++){const _=n(f.elements[m].element),b=f.elements[f.elements.length-1].element;r.has(_)&&l.indexOf(b)===-1&&(l.push(b),c=!0),a.has(_)&&d.indexOf(b)===-1&&(d.push(b),h=!0)}g.children.forEach(u)};u(this.tree.getCompressedTreeNode(e===this.root?null:e)),c&&this.setSelection(l),h&&this.setFocus(d)}processChildren(e){return this.filter&&(e=st.filter(e,t=>{const i=this.filter.filter(t,1),n=Sfe(i);if(n===2)throw new Error("Recursive tree visibility not supported in async data compressed trees");return n===1})),super.processChildren(e)}}function Sfe(s){return typeof s=="boolean"?s?1:0:vO(s)?yv(s.visibility):yv(s)}class Lfe extends e${constructor(e,t,i,n,o,r={}){super(e,t,i,n,r),this.user=e,this.dataSource=o,this.identityProvider=r.identityProvider}createModel(e,t,i){return new yO(e,t,i)}}new le("isMac",Qe,p("isMac","Whether the operating system is macOS"));new le("isLinux",ys,p("isLinux","Whether the operating system is Linux"));const fx=new le("isWindows",An,p("isWindows","Whether the operating system is Windows")),r$=new le("isWeb",gg,p("isWeb","Whether the platform is a web browser"));new le("isMacNative",Qe&&!gg,p("isMacNative","Whether the operating system is macOS on a non-browser platform"));new le("isIOS",Oa,p("isIOS","Whether the operating system is iOS"));new le("isMobile",t6,p("isMobile","Whether the platform is a mobile web browser"));new le("isDevelopment",!1,!0);new le("productQualityType","",p("productQualityType","Quality type of VS Code"));const a$="inputFocus",l$=new le(a$,!1,p("inputFocus","Whether keyboard focus is inside an input box"));var Qc=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},jt=function(s,e){return function(t,i){e(t,i,s)}};const Ir=Je("listService");class xfe{get lastFocusedList(){return this._lastFocusedWidget}constructor(){this.disposables=new Z,this.lists=[],this._lastFocusedWidget=void 0,this._hasCreatedStyleController=!1}setLastFocusedList(e){e!==this._lastFocusedWidget&&(this._lastFocusedWidget?.getHTMLElement().classList.remove("last-focused"),this._lastFocusedWidget=e,this._lastFocusedWidget?.getHTMLElement().classList.add("last-focused"))}register(e,t){if(this._hasCreatedStyleController||(this._hasCreatedStyleController=!0,new sU($o(),"").style(bg)),this.lists.some(n=>n.widget===e))throw new Error("Cannot register the same widget multiple times");const i={widget:e,extraContextKeys:t};return this.lists.push(i),LL(e.getHTMLElement())&&this.setLastFocusedList(e),Gr(e.onDidFocus(()=>this.setLastFocusedList(e)),Ce(()=>this.lists.splice(this.lists.indexOf(i),1)),e.onDidDispose(()=>{this.lists=this.lists.filter(n=>n!==i),this._lastFocusedWidget===e&&this.setLastFocusedList(void 0)}))}dispose(){this.disposables.dispose()}}const wv=new le("listScrollAtBoundary","none");q.or(wv.isEqualTo("top"),wv.isEqualTo("both"));q.or(wv.isEqualTo("bottom"),wv.isEqualTo("both"));const c$=new le("listFocus",!0),d$=new le("treestickyScrollFocused",!1),px=new le("listSupportsMultiselect",!0),h$=q.and(c$,q.not(a$),d$.negate()),kO=new le("listHasSelectionOrFocus",!1),DO=new le("listDoubleSelection",!1),IO=new le("listMultiSelection",!1),mx=new le("listSelectionNavigation",!1),kfe=new le("listSupportsFind",!0),TO=new le("treeElementCanCollapse",!1),Dfe=new le("treeElementHasParent",!1),EO=new le("treeElementCanExpand",!1),Ife=new le("treeElementHasChild",!1),Tfe=new le("treeFindOpen",!1),u$="listTypeNavigationMode",g$="listAutomaticKeyboardNavigation";function _x(s,e){const t=s.createScoped(e.getHTMLElement());return c$.bindTo(t),t}function bx(s,e){const t=wv.bindTo(s),i=()=>{const n=e.scrollTop===0,o=e.scrollHeight-e.renderHeight-e.scrollTop<1;n&&o?t.set("both"):n?t.set("top"):o?t.set("bottom"):t.set("none")};return i(),e.onDidScroll(i)}const yg="workbench.list.multiSelectModifier",Xw="workbench.list.openMode",br="workbench.list.horizontalScrolling",NO="workbench.list.defaultFindMode",RO="workbench.list.typeNavigationMode",V0="workbench.list.keyboardNavigation",Va="workbench.list.scrollByPage",MO="workbench.list.defaultFindMatchType",Sv="workbench.tree.indent",z0="workbench.tree.renderIndentGuides",za="workbench.list.smoothScrolling",Ml="workbench.list.mouseWheelScrollSensitivity",Al="workbench.list.fastScrollSensitivity",U0="workbench.tree.expandMode",$0="workbench.tree.enableStickyScroll",j0="workbench.tree.stickyScrollMaxItemCount";function Pl(s){return s.getValue(yg)==="alt"}class Efe extends B{constructor(e){super(),this.configurationService=e,this.useAltAsMultipleSelectionModifier=Pl(e),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(yg)&&(this.useAltAsMultipleSelectionModifier=Pl(this.configurationService))}))}isSelectionSingleChangeEvent(e){return this.useAltAsMultipleSelectionModifier?e.browserEvent.altKey:tU(e)}isSelectionRangeChangeEvent(e){return iU(e)}}function vx(s,e){const t=s.get(Ke),i=s.get(yt),n=new Z;return[{...e,keyboardNavigationDelegate:{mightProducePrintableCharacter(r){return i.mightProducePrintableCharacter(r)}},smoothScrolling:!!t.getValue(za),mouseWheelScrollSensitivity:t.getValue(Ml),fastScrollSensitivity:t.getValue(Al),multipleSelectionController:e.multipleSelectionController??n.add(new Efe(t)),keyboardNavigationEventFilter:Mfe(i),scrollByPage:!!t.getValue(Va)},n]}let DW=class extends Xo{constructor(e,t,i,n,o,r,a,l,c){const d=typeof o.horizontalScrolling<"u"?o.horizontalScrolling:!!l.getValue(br),[h,u]=c.invokeFunction(vx,o);super(e,t,i,n,{keyboardSupport:!1,...h,horizontalScrolling:d}),this.disposables.add(u),this.contextKeyService=_x(r,this),this.disposables.add(bx(this.contextKeyService,this)),this.listSupportsMultiSelect=px.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(o.multipleSelectionSupport!==!1),mx.bindTo(this.contextKeyService).set(!!o.selectionNavigation),this.listHasSelectionOrFocus=kO.bindTo(this.contextKeyService),this.listDoubleSelection=DO.bindTo(this.contextKeyService),this.listMultiSelection=IO.bindTo(this.contextKeyService),this.horizontalScrolling=o.horizontalScrolling,this._useAltAsMultipleSelectionModifier=Pl(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(o.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const f=this.getSelection(),m=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(f.length>0||m.length>0),this.listMultiSelection.set(f.length>1),this.listDoubleSelection.set(f.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const f=this.getSelection(),m=this.getFocus();this.listHasSelectionOrFocus.set(f.length>0||m.length>0)})),this.disposables.add(l.onDidChangeConfiguration(f=>{f.affectsConfiguration(yg)&&(this._useAltAsMultipleSelectionModifier=Pl(l));let m={};if(f.affectsConfiguration(br)&&this.horizontalScrolling===void 0){const _=!!l.getValue(br);m={...m,horizontalScrolling:_}}if(f.affectsConfiguration(Va)){const _=!!l.getValue(Va);m={...m,scrollByPage:_}}if(f.affectsConfiguration(za)){const _=!!l.getValue(za);m={...m,smoothScrolling:_}}if(f.affectsConfiguration(Ml)){const _=l.getValue(Ml);m={...m,mouseWheelScrollSensitivity:_}}if(f.affectsConfiguration(Al)){const _=l.getValue(Al);m={...m,fastScrollSensitivity:_}}Object.keys(m).length>0&&this.updateOptions(m)})),this.navigator=new f$(this,{configurationService:l,...o}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?vg(e):bg)}};DW=Qc([jt(5,Ee),jt(6,Ir),jt(7,Ke),jt(8,ye)],DW);let IW=class extends Pge{constructor(e,t,i,n,o,r,a,l,c){const d=typeof o.horizontalScrolling<"u"?o.horizontalScrolling:!!l.getValue(br),[h,u]=c.invokeFunction(vx,o);super(e,t,i,n,{keyboardSupport:!1,...h,horizontalScrolling:d}),this.disposables=new Z,this.disposables.add(u),this.contextKeyService=_x(r,this),this.disposables.add(bx(this.contextKeyService,this.widget)),this.horizontalScrolling=o.horizontalScrolling,this.listSupportsMultiSelect=px.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(o.multipleSelectionSupport!==!1),mx.bindTo(this.contextKeyService).set(!!o.selectionNavigation),this._useAltAsMultipleSelectionModifier=Pl(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(o.overrideStyles),this.disposables.add(l.onDidChangeConfiguration(f=>{f.affectsConfiguration(yg)&&(this._useAltAsMultipleSelectionModifier=Pl(l));let m={};if(f.affectsConfiguration(br)&&this.horizontalScrolling===void 0){const _=!!l.getValue(br);m={...m,horizontalScrolling:_}}if(f.affectsConfiguration(Va)){const _=!!l.getValue(Va);m={...m,scrollByPage:_}}if(f.affectsConfiguration(za)){const _=!!l.getValue(za);m={...m,smoothScrolling:_}}if(f.affectsConfiguration(Ml)){const _=l.getValue(Ml);m={...m,mouseWheelScrollSensitivity:_}}if(f.affectsConfiguration(Al)){const _=l.getValue(Al);m={...m,fastScrollSensitivity:_}}Object.keys(m).length>0&&this.updateOptions(m)})),this.navigator=new f$(this,{configurationService:l,...o}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?vg(e):bg)}dispose(){this.disposables.dispose(),super.dispose()}};IW=Qc([jt(5,Ee),jt(6,Ir),jt(7,Ke),jt(8,ye)],IW);let TW=class extends _O{constructor(e,t,i,n,o,r,a,l,c,d){const h=typeof r.horizontalScrolling<"u"?r.horizontalScrolling:!!c.getValue(br),[u,g]=d.invokeFunction(vx,r);super(e,t,i,n,o,{keyboardSupport:!1,...u,horizontalScrolling:h}),this.disposables.add(g),this.contextKeyService=_x(a,this),this.disposables.add(bx(this.contextKeyService,this)),this.listSupportsMultiSelect=px.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(r.multipleSelectionSupport!==!1),mx.bindTo(this.contextKeyService).set(!!r.selectionNavigation),this.listHasSelectionOrFocus=kO.bindTo(this.contextKeyService),this.listDoubleSelection=DO.bindTo(this.contextKeyService),this.listMultiSelection=IO.bindTo(this.contextKeyService),this.horizontalScrolling=r.horizontalScrolling,this._useAltAsMultipleSelectionModifier=Pl(c),this.disposables.add(this.contextKeyService),this.disposables.add(l.register(this)),this.updateStyles(r.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const m=this.getSelection(),_=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(m.length>0||_.length>0),this.listMultiSelection.set(m.length>1),this.listDoubleSelection.set(m.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const m=this.getSelection(),_=this.getFocus();this.listHasSelectionOrFocus.set(m.length>0||_.length>0)})),this.disposables.add(c.onDidChangeConfiguration(m=>{m.affectsConfiguration(yg)&&(this._useAltAsMultipleSelectionModifier=Pl(c));let _={};if(m.affectsConfiguration(br)&&this.horizontalScrolling===void 0){const b=!!c.getValue(br);_={..._,horizontalScrolling:b}}if(m.affectsConfiguration(Va)){const b=!!c.getValue(Va);_={..._,scrollByPage:b}}if(m.affectsConfiguration(za)){const b=!!c.getValue(za);_={..._,smoothScrolling:b}}if(m.affectsConfiguration(Ml)){const b=c.getValue(Ml);_={..._,mouseWheelScrollSensitivity:b}}if(m.affectsConfiguration(Al)){const b=c.getValue(Al);_={..._,fastScrollSensitivity:b}}Object.keys(_).length>0&&this.updateOptions(_)})),this.navigator=new Nfe(this,{configurationService:c,...r}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?vg(e):bg)}dispose(){this.disposables.dispose(),super.dispose()}};TW=Qc([jt(6,Ee),jt(7,Ir),jt(8,Ke),jt(9,ye)],TW);class AO extends B{constructor(e,t){super(),this.widget=e,this._onDidOpen=this._register(new O),this.onDidOpen=this._onDidOpen.event,this._register(se.filter(this.widget.onDidChangeSelection,i=>cc(i.browserEvent))(i=>this.onSelectionFromKeyboard(i))),this._register(this.widget.onPointer(i=>this.onPointer(i.element,i.browserEvent))),this._register(this.widget.onMouseDblClick(i=>this.onMouseDblClick(i.element,i.browserEvent))),typeof t?.openOnSingleClick!="boolean"&&t?.configurationService?(this.openOnSingleClick=t?.configurationService.getValue(Xw)!=="doubleClick",this._register(t?.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration(Xw)&&(this.openOnSingleClick=t?.configurationService.getValue(Xw)!=="doubleClick")}))):this.openOnSingleClick=t?.openOnSingleClick??!0}onSelectionFromKeyboard(e){if(e.elements.length!==1)return;const t=e.browserEvent,i=typeof t.preserveFocus=="boolean"?t.preserveFocus:!0,n=typeof t.pinned=="boolean"?t.pinned:!i;this._open(this.getSelectedElement(),i,n,!1,e.browserEvent)}onPointer(e,t){if(!this.openOnSingleClick||t.detail===2)return;const n=t.button===1,o=!0,r=n,a=t.ctrlKey||t.metaKey||t.altKey;this._open(e,o,r,a,t)}onMouseDblClick(e,t){if(!t)return;const i=t.target;if(i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&t.offsetX<16)return;const o=!1,r=!0,a=t.ctrlKey||t.metaKey||t.altKey;this._open(e,o,r,a,t)}_open(e,t,i,n,o){e&&this._onDidOpen.fire({editorOptions:{preserveFocus:t,pinned:i,revealIfVisible:!0},sideBySide:n,element:e,browserEvent:o})}}class f$ extends AO{constructor(e,t){super(e,t),this.widget=e}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class Nfe extends AO{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class Rfe extends AO{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelection()[0]??void 0}}function Mfe(s){let e=!1;return t=>{if(t.toKeyCodeChord().isModifierKey())return!1;if(e)return e=!1,!1;const i=s.softDispatch(t,t.target);return i.kind===1?(e=!0,!1):(e=!1,i.kind===0)}}let VN=class extends SO{constructor(e,t,i,n,o,r,a,l,c){const{options:d,getTypeNavigationMode:h,disposable:u}=r.invokeFunction(HC,o);super(e,t,i,n,d),this.disposables.add(u),this.internals=new tg(this,o,h,o.overrideStyles,a,l,c),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};VN=Qc([jt(5,ye),jt(6,Ee),jt(7,Ir),jt(8,Ke)],VN);let EW=class extends n${constructor(e,t,i,n,o,r,a,l,c){const{options:d,getTypeNavigationMode:h,disposable:u}=r.invokeFunction(HC,o);super(e,t,i,n,d),this.disposables.add(u),this.internals=new tg(this,o,h,o.overrideStyles,a,l,c),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};EW=Qc([jt(5,ye),jt(6,Ee),jt(7,Ir),jt(8,Ke)],EW);let NW=class extends Lfe{constructor(e,t,i,n,o,r,a,l,c,d){const{options:h,getTypeNavigationMode:u,disposable:g}=a.invokeFunction(HC,r);super(e,t,i,n,o,h),this.disposables.add(g),this.internals=new tg(this,r,u,r.overrideStyles,l,c,d),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles!==void 0&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};NW=Qc([jt(6,ye),jt(7,Ee),jt(8,Ir),jt(9,Ke)],NW);let zN=class extends o${get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,i,n,o,r,a,l,c,d){const{options:h,getTypeNavigationMode:u,disposable:g}=a.invokeFunction(HC,r);super(e,t,i,n,o,h),this.disposables.add(g),this.internals=new tg(this,r,u,r.overrideStyles,l,c,d),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};zN=Qc([jt(6,ye),jt(7,Ee),jt(8,Ir),jt(9,Ke)],zN);let RW=class extends wfe{constructor(e,t,i,n,o,r,a,l,c,d,h){const{options:u,getTypeNavigationMode:g,disposable:f}=l.invokeFunction(HC,a);super(e,t,i,n,o,r,u),this.disposables.add(f),this.internals=new tg(this,a,g,a.overrideStyles,c,d,h),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};RW=Qc([jt(7,ye),jt(8,Ee),jt(9,Ir),jt(10,Ke)],RW);function p$(s){const e=s.getValue(NO);if(e==="highlight")return xc.Highlight;if(e==="filter")return xc.Filter;const t=s.getValue(V0);if(t==="simple"||t==="highlight")return xc.Highlight;if(t==="filter")return xc.Filter}function m$(s){const e=s.getValue(MO);if(e==="fuzzy")return eg.Fuzzy;if(e==="contiguous")return eg.Contiguous}function HC(s,e){const t=s.get(Ke),i=s.get(Yc),n=s.get(Ee),o=s.get(ye),r=()=>{const u=n.getContextKeyValue(u$);if(u==="automatic")return vl.Automatic;if(u==="trigger"||n.getContextKeyValue(g$)===!1)return vl.Trigger;const f=t.getValue(RO);if(f==="automatic")return vl.Automatic;if(f==="trigger")return vl.Trigger},a=e.horizontalScrolling!==void 0?e.horizontalScrolling:!!t.getValue(br),[l,c]=o.invokeFunction(vx,e),d=e.paddingBottom,h=e.renderIndentGuides!==void 0?e.renderIndentGuides:t.getValue(z0);return{getTypeNavigationMode:r,disposable:c,options:{keyboardSupport:!1,...l,indent:typeof t.getValue(Sv)=="number"?t.getValue(Sv):void 0,renderIndentGuides:h,smoothScrolling:!!t.getValue(za),defaultFindMode:p$(t),defaultFindMatchType:m$(t),horizontalScrolling:a,scrollByPage:!!t.getValue(Va),paddingBottom:d,hideTwistiesOfChildlessElements:e.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:e.expandOnlyOnTwistieClick??t.getValue(U0)==="doubleClick",contextViewProvider:i,findWidgetStyles:Fde,enableStickyScroll:!!t.getValue($0),stickyScrollMaxItemCount:Number(t.getValue(j0))}}}let tg=class{get onDidOpen(){return this.navigator.onDidOpen}constructor(e,t,i,n,o,r,a){this.tree=e,this.disposables=[],this.contextKeyService=_x(o,e),this.disposables.push(bx(this.contextKeyService,e)),this.listSupportsMultiSelect=px.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(t.multipleSelectionSupport!==!1),mx.bindTo(this.contextKeyService).set(!!t.selectionNavigation),this.listSupportFindWidget=kfe.bindTo(this.contextKeyService),this.listSupportFindWidget.set(t.findWidgetEnabled??!0),this.hasSelectionOrFocus=kO.bindTo(this.contextKeyService),this.hasDoubleSelection=DO.bindTo(this.contextKeyService),this.hasMultiSelection=IO.bindTo(this.contextKeyService),this.treeElementCanCollapse=TO.bindTo(this.contextKeyService),this.treeElementHasParent=Dfe.bindTo(this.contextKeyService),this.treeElementCanExpand=EO.bindTo(this.contextKeyService),this.treeElementHasChild=Ife.bindTo(this.contextKeyService),this.treeFindOpen=Tfe.bindTo(this.contextKeyService),this.treeStickyScrollFocused=d$.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=Pl(a),this.updateStyleOverrides(n);const c=()=>{const h=e.getFocus()[0];if(!h)return;const u=e.getNode(h);this.treeElementCanCollapse.set(u.collapsible&&!u.collapsed),this.treeElementHasParent.set(!!e.getParentElement(h)),this.treeElementCanExpand.set(u.collapsible&&u.collapsed),this.treeElementHasChild.set(!!e.getFirstElementChild(h))},d=new Set;d.add(u$),d.add(g$),this.disposables.push(this.contextKeyService,r.register(e),e.onDidChangeSelection(()=>{const h=e.getSelection(),u=e.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.hasSelectionOrFocus.set(h.length>0||u.length>0),this.hasMultiSelection.set(h.length>1),this.hasDoubleSelection.set(h.length===2)})}),e.onDidChangeFocus(()=>{const h=e.getSelection(),u=e.getFocus();this.hasSelectionOrFocus.set(h.length>0||u.length>0),c()}),e.onDidChangeCollapseState(c),e.onDidChangeModel(c),e.onDidChangeFindOpenState(h=>this.treeFindOpen.set(h)),e.onDidChangeStickyScrollFocused(h=>this.treeStickyScrollFocused.set(h)),a.onDidChangeConfiguration(h=>{let u={};if(h.affectsConfiguration(yg)&&(this._useAltAsMultipleSelectionModifier=Pl(a)),h.affectsConfiguration(Sv)){const g=a.getValue(Sv);u={...u,indent:g}}if(h.affectsConfiguration(z0)&&t.renderIndentGuides===void 0){const g=a.getValue(z0);u={...u,renderIndentGuides:g}}if(h.affectsConfiguration(za)){const g=!!a.getValue(za);u={...u,smoothScrolling:g}}if(h.affectsConfiguration(NO)||h.affectsConfiguration(V0)){const g=p$(a);u={...u,defaultFindMode:g}}if(h.affectsConfiguration(RO)||h.affectsConfiguration(V0)){const g=i();u={...u,typeNavigationMode:g}}if(h.affectsConfiguration(MO)){const g=m$(a);u={...u,defaultFindMatchType:g}}if(h.affectsConfiguration(br)&&t.horizontalScrolling===void 0){const g=!!a.getValue(br);u={...u,horizontalScrolling:g}}if(h.affectsConfiguration(Va)){const g=!!a.getValue(Va);u={...u,scrollByPage:g}}if(h.affectsConfiguration(U0)&&t.expandOnlyOnTwistieClick===void 0&&(u={...u,expandOnlyOnTwistieClick:a.getValue(U0)==="doubleClick"}),h.affectsConfiguration($0)){const g=a.getValue($0);u={...u,enableStickyScroll:g}}if(h.affectsConfiguration(j0)){const g=Math.max(1,a.getValue(j0));u={...u,stickyScrollMaxItemCount:g}}if(h.affectsConfiguration(Ml)){const g=a.getValue(Ml);u={...u,mouseWheelScrollSensitivity:g}}if(h.affectsConfiguration(Al)){const g=a.getValue(Al);u={...u,fastScrollSensitivity:g}}Object.keys(u).length>0&&e.updateOptions(u)}),this.contextKeyService.onDidChangeContext(h=>{h.affectsSome(d)&&e.updateOptions({typeNavigationMode:i()})})),this.navigator=new Rfe(e,{configurationService:a,...t}),this.disposables.push(this.navigator)}updateOptions(e){e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyleOverrides(e){this.tree.style(e?vg(e):bg)}dispose(){this.disposables=At(this.disposables)}};tg=Qc([jt(4,Ee),jt(5,Ir),jt(6,Ke)],tg);const Afe=ci.as(na.Configuration);Afe.registerConfiguration({id:"workbench",order:7,title:p("workbenchConfigurationTitle","Workbench"),type:"object",properties:{[yg]:{type:"string",enum:["ctrlCmd","alt"],markdownEnumDescriptions:[p("multiSelectModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),p("multiSelectModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:p({key:"multiSelectModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},[Xw]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:p({key:"openModeModifier",comment:["`singleClick` and `doubleClick` refers to a value the setting can take and should not be localized."]},"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[br]:{type:"boolean",default:!1,description:p("horizontalScrolling setting","Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[Va]:{type:"boolean",default:!1,description:p("list.scrollByPage","Controls whether clicks in the scrollbar scroll page by page.")},[Sv]:{type:"number",default:8,minimum:4,maximum:40,description:p("tree indent setting","Controls tree indentation in pixels.")},[z0]:{type:"string",enum:["none","onHover","always"],default:"onHover",description:p("render tree indent guides","Controls whether the tree should render indent guides.")},[za]:{type:"boolean",default:!1,description:p("list smoothScrolling setting","Controls whether lists and trees have smooth scrolling.")},[Ml]:{type:"number",default:1,markdownDescription:p("Mouse Wheel Scroll Sensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")},[Al]:{type:"number",default:5,markdownDescription:p("Fast Scroll Sensitivity","Scrolling speed multiplier when pressing `Alt`.")},[NO]:{type:"string",enum:["highlight","filter"],enumDescriptions:[p("defaultFindModeSettingKey.highlight","Highlight elements when searching. Further up and down navigation will traverse only the highlighted elements."),p("defaultFindModeSettingKey.filter","Filter elements when searching.")],default:"highlight",description:p("defaultFindModeSettingKey","Controls the default find mode for lists and trees in the workbench.")},[V0]:{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[p("keyboardNavigationSettingKey.simple","Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),p("keyboardNavigationSettingKey.highlight","Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),p("keyboardNavigationSettingKey.filter","Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:p("keyboardNavigationSettingKey","Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter."),deprecated:!0,deprecationMessage:p("keyboardNavigationSettingKeyDeprecated","Please use 'workbench.list.defaultFindMode' and	'workbench.list.typeNavigationMode' instead.")},[MO]:{type:"string",enum:["fuzzy","contiguous"],enumDescriptions:[p("defaultFindMatchTypeSettingKey.fuzzy","Use fuzzy matching when searching."),p("defaultFindMatchTypeSettingKey.contiguous","Use contiguous matching when searching.")],default:"fuzzy",description:p("defaultFindMatchTypeSettingKey","Controls the type of matching used when searching lists and trees in the workbench.")},[U0]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:p("expand mode","Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[$0]:{type:"boolean",default:!0,description:p("sticky scroll","Controls whether sticky scrolling is enabled in trees.")},[j0]:{type:"number",minimum:1,default:7,markdownDescription:p("sticky scroll maximum items","Controls the number of sticky elements displayed in the tree when {0} is enabled.","`#workbench.tree.enableStickyScroll#`")},[RO]:{type:"string",enum:["automatic","trigger"],default:"automatic",markdownDescription:p("typeNavigationMode2","Controls how type navigation works in lists and trees in the workbench. When set to `trigger`, type navigation begins once the `list.triggerTypeNavigation` command is run.")}}});class Yd extends B{constructor(e,t){super(),this.options=t,this.text="",this.title="",this.highlights=[],this.didEverRender=!1,this.supportIcons=t?.supportIcons??!1,this.domNode=X(e,te("span.monaco-highlighted-label"))}get element(){return this.domNode}set(e,t=[],i="",n){e||(e=""),n&&(e=Yd.escapeNewLines(e,t)),!(this.didEverRender&&this.text===e&&this.title===i&&co(this.highlights,t))&&(this.text=e,this.title=i,this.highlights=t,this.render())}render(){const e=[];let t=0;for(const i of this.highlights){if(i.end===i.start)continue;if(t<i.start){const r=this.text.substring(t,i.start);this.supportIcons?e.push(...Kd(r)):e.push(r),t=i.start}const n=this.text.substring(t,i.end),o=te("span.highlight",void 0,...this.supportIcons?Kd(n):[n]);i.extraClasses&&o.classList.add(...i.extraClasses),e.push(o),t=i.end}if(t<this.text.length){const i=this.text.substring(t);this.supportIcons?e.push(...Kd(i)):e.push(i)}if(yn(this.domNode,...e),this.options?.hoverDelegate?.showNativeHover)this.domNode.title=this.title;else if(!this.customHover&&this.title!==""){const i=this.options?.hoverDelegate??Ds("mouse");this.customHover=this._register(Ka().setupManagedHover(i,this.domNode,this.title))}else this.customHover&&this.customHover.update(this.title);this.didEverRender=!0}static escapeNewLines(e,t){let i=0,n=0;return e.replace(/\r\n|\r|\n/g,(o,r)=>{n=o===`\r
`?-1:0,r+=i;for(const a of t)a.end<=r||(a.start>=r&&(a.start+=n),a.end>=r&&(a.end+=n));return i+=n,""})}}class s_{constructor(e){this._element=e}get element(){return this._element}set textContent(e){this.disposed||e===this._textContent||(this._textContent=e,this._element.textContent=e)}set classNames(e){this.disposed||co(e,this._classNames)||(this._classNames=e,this._element.classList.value="",this._element.classList.add(...e))}set empty(e){this.disposed||e===this._empty||(this._empty=e,this._element.style.marginLeft=e?"0":"")}dispose(){this.disposed=!0}}class Z0 extends B{constructor(e,t){super(),this.customHovers=new Map,this.creationOptions=t,this.domNode=this._register(new s_(X(e,te(".monaco-icon-label")))),this.labelContainer=X(this.domNode.element,te(".monaco-icon-label-container")),this.nameContainer=X(this.labelContainer,te("span.monaco-icon-name-container")),t?.supportHighlights||t?.supportIcons?this.nameNode=this._register(new Ffe(this.nameContainer,!!t.supportIcons)):this.nameNode=new Pfe(this.nameContainer),this.hoverDelegate=t?.hoverDelegate??Ds("mouse")}get element(){return this.domNode.element}setLabel(e,t,i){const n=["monaco-icon-label"],o=["monaco-icon-label-container"];let r="";i&&(i.extraClasses&&n.push(...i.extraClasses),i.italic&&n.push("italic"),i.strikethrough&&n.push("strikethrough"),i.disabledCommand&&o.push("disabled"),i.title&&(typeof i.title=="string"?r+=i.title:r+=e));const a=this.domNode.element.querySelector(".monaco-icon-label-iconpath");if(i?.iconPath){let l;!a||!tn(a)?(l=te(".monaco-icon-label-iconpath"),this.domNode.element.prepend(l)):l=a,l.style.backgroundImage=Hc(i?.iconPath)}else a&&a.remove();if(this.domNode.classNames=n,this.domNode.element.setAttribute("aria-label",r),this.labelContainer.classList.value="",this.labelContainer.classList.add(...o),this.setupHover(i?.descriptionTitle?this.labelContainer:this.element,i?.title),this.nameNode.setLabel(e,i),t||this.descriptionNode){const l=this.getOrCreateDescriptionNode();l instanceof Yd?(l.set(t||"",i?i.descriptionMatches:void 0,void 0,i?.labelEscapeNewLines),this.setupHover(l.element,i?.descriptionTitle)):(l.textContent=t&&i?.labelEscapeNewLines?Yd.escapeNewLines(t,[]):t||"",this.setupHover(l.element,i?.descriptionTitle||""),l.empty=!t)}if(i?.suffix||this.suffixNode){const l=this.getOrCreateSuffixNode();l.textContent=i?.suffix??""}}setupHover(e,t){const i=this.customHovers.get(e);if(i&&(i.dispose(),this.customHovers.delete(e)),!t){e.removeAttribute("title");return}if(this.hoverDelegate.showNativeHover)(function(o,r){zs(r)?o.title=V2(r):r?.markdownNotSupportedFallback?o.title=r.markdownNotSupportedFallback:o.removeAttribute("title")})(e,t);else{const n=Ka().setupManagedHover(this.hoverDelegate,e,t);n&&this.customHovers.set(e,n)}}dispose(){super.dispose();for(const e of this.customHovers.values())e.dispose();this.customHovers.clear()}getOrCreateSuffixNode(){if(!this.suffixNode){const e=this._register(new s_(Wte(this.nameContainer,te("span.monaco-icon-suffix-container"))));this.suffixNode=this._register(new s_(X(e.element,te("span.label-suffix"))))}return this.suffixNode}getOrCreateDescriptionNode(){if(!this.descriptionNode){const e=this._register(new s_(X(this.labelContainer,te("span.monaco-icon-description-container"))));this.creationOptions?.supportDescriptionHighlights?this.descriptionNode=this._register(new Yd(X(e.element,te("span.label-description")),{supportIcons:!!this.creationOptions.supportIcons})):this.descriptionNode=this._register(new s_(X(e.element,te("span.label-description"))))}return this.descriptionNode}}class Pfe{constructor(e){this.container=e,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(!(this.label===e&&co(this.options,t)))if(this.label=e,this.options=t,typeof e=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=X(this.container,te("a.label-name",{id:t?.domId}))),this.singleLabel.textContent=e;else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let i=0;i<e.length;i++){const n=e[i],o=t?.domId&&`${t?.domId}_${i}`;X(this.container,te("a.label-name",{id:o,"data-icon-label-count":e.length,"data-icon-label-index":i,role:"treeitem"},n)),i<e.length-1&&X(this.container,te("span.label-separator",void 0,t?.separator||"/"))}}}}function Ofe(s,e,t){if(!t)return;let i=0;return s.map(n=>{const o={start:i,end:i+n.length},r=t.map(a=>Wn.intersect(o,a)).filter(a=>!Wn.isEmpty(a)).map(({start:a,end:l})=>({start:a-i,end:l-i}));return i=o.end+e.length,r})}class Ffe extends B{constructor(e,t){super(),this.container=e,this.supportIcons=t,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(!(this.label===e&&co(this.options,t)))if(this.label=e,this.options=t,typeof e=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=this._register(new Yd(X(this.container,te("a.label-name",{id:t?.domId})),{supportIcons:this.supportIcons}))),this.singleLabel.set(e,t?.matches,void 0,t?.labelEscapeNewLines);else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;const i=t?.separator||"/",n=Ofe(e,i,t?.matches);for(let o=0;o<e.length;o++){const r=e[o],a=n?n[o]:void 0,l=t?.domId&&`${t?.domId}_${o}`,c=te("a.label-name",{id:l,"data-icon-label-count":e.length,"data-icon-label-index":o,role:"treeitem"});this._register(new Yd(X(this.container,c),{supportIcons:this.supportIcons})).set(r,a,void 0,t?.labelEscapeNewLines),o<e.length-1&&X(c,te("span.label-separator",void 0,i))}}}}const jy=te,_$={keybindingLabelBackground:void 0,keybindingLabelForeground:void 0,keybindingLabelBorder:void 0,keybindingLabelBottomBorder:void 0,keybindingLabelShadow:void 0};class Em extends B{constructor(e,t,i){super(),this.os=t,this.keyElements=new Set,this.options=i||Object.create(null);const n=this.options.keybindingLabelForeground;this.domNode=X(e,jy(".monaco-keybinding")),n&&(this.domNode.style.color=n),this.hover=this._register(Ka().setupManagedHover(Ds("mouse"),this.domNode,"")),this.didEverRender=!1,e.appendChild(this.domNode)}get element(){return this.domNode}set(e,t){this.didEverRender&&this.keybinding===e&&Em.areSame(this.matches,t)||(this.keybinding=e,this.matches=t,this.render())}render(){if(this.clear(),this.keybinding){const e=this.keybinding.getChords();e[0]&&this.renderChord(this.domNode,e[0],this.matches?this.matches.firstPart:null);for(let i=1;i<e.length;i++)X(this.domNode,jy("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderChord(this.domNode,e[i],this.matches?this.matches.chordPart:null);const t=this.options.disableTitle??!1?void 0:this.keybinding.getAriaLabel()||void 0;this.hover.update(t),this.domNode.setAttribute("aria-label",t||"")}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.didEverRender=!0}clear(){Cn(this.domNode),this.keyElements.clear()}renderChord(e,t,i){const n=K2.modifierLabels[this.os];t.ctrlKey&&this.renderKey(e,n.ctrlKey,!!i?.ctrlKey,n.separator),t.shiftKey&&this.renderKey(e,n.shiftKey,!!i?.shiftKey,n.separator),t.altKey&&this.renderKey(e,n.altKey,!!i?.altKey,n.separator),t.metaKey&&this.renderKey(e,n.metaKey,!!i?.metaKey,n.separator);const o=t.keyLabel;o&&this.renderKey(e,o,!!i?.keyCode,"")}renderKey(e,t,i,n){X(e,this.createKeyElement(t,i?".highlight":"")),n&&X(e,jy("span.monaco-keybinding-key-separator",void 0,n))}renderUnbound(e){X(e,this.createKeyElement(p("unbound","Unbound")))}createKeyElement(e,t=""){const i=jy("span.monaco-keybinding-key"+t,void 0,e);return this.keyElements.add(i),this.options.keybindingLabelBackground&&(i.style.backgroundColor=this.options.keybindingLabelBackground),this.options.keybindingLabelBorder&&(i.style.borderColor=this.options.keybindingLabelBorder),this.options.keybindingLabelBottomBorder&&(i.style.borderBottomColor=this.options.keybindingLabelBottomBorder),this.options.keybindingLabelShadow&&(i.style.boxShadow=`inset 0 -1px 0 ${this.options.keybindingLabelShadow}`),i}static areSame(e,t){return e===t||!e&&!t?!0:!!e&&!!t&&co(e.firstPart,t.firstPart)&&co(e.chordPart,t.chordPart)}}const MW=new Fa(()=>{const s=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:s,collatorIsNumeric:s.resolvedOptions().numeric}});function Bfe(s,e,t=!1){const i=s||"",n=e||"",o=MW.value.collator.compare(i,n);return MW.value.collatorIsNumeric&&o===0&&i!==n?i<n?-1:1:o}function Wfe(s,e,t){const i=s.toLowerCase(),n=e.toLowerCase(),o=Hfe(s,e,t);if(o)return o;const r=i.endsWith(t),a=n.endsWith(t);if(r!==a)return r?-1:1;const l=Bfe(i,n);return l!==0?l:i.localeCompare(n)}function Hfe(s,e,t){const i=s.toLowerCase(),n=e.toLowerCase(),o=i.startsWith(t),r=n.startsWith(t);if(o!==r)return o?-1:1;if(o&&r){if(i.length<n.length)return-1;if(i.length>n.length)return 1}return 0}var Cx=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},UN=function(s,e){return function(t,i){e(t,i,s)}},$N;const ha=te;class b${constructor(e,t,i){this.index=e,this.hasCheckbox=t,this._hidden=!1,this._init=new Fa(()=>{const n=i.label??"",o=x_(n).text.trim(),r=i.ariaLabel||[n,this.saneDescription,this.saneDetail].map(a=>qae(a)).filter(a=>!!a).join(", ");return{saneLabel:n,saneSortLabel:o,saneAriaLabel:r}}),this._saneDescription=i.description,this._saneTooltip=i.tooltip}get saneLabel(){return this._init.value.saneLabel}get saneSortLabel(){return this._init.value.saneSortLabel}get saneAriaLabel(){return this._init.value.saneAriaLabel}get element(){return this._element}set element(e){this._element=e}get hidden(){return this._hidden}set hidden(e){this._hidden=e}get saneDescription(){return this._saneDescription}set saneDescription(e){this._saneDescription=e}get saneDetail(){return this._saneDetail}set saneDetail(e){this._saneDetail=e}get saneTooltip(){return this._saneTooltip}set saneTooltip(e){this._saneTooltip=e}get labelHighlights(){return this._labelHighlights}set labelHighlights(e){this._labelHighlights=e}get descriptionHighlights(){return this._descriptionHighlights}set descriptionHighlights(e){this._descriptionHighlights=e}get detailHighlights(){return this._detailHighlights}set detailHighlights(e){this._detailHighlights=e}}class kn extends b${constructor(e,t,i,n,o,r){super(e,t,o),this.fireButtonTriggered=i,this._onChecked=n,this.item=o,this._separator=r,this._checked=!1,this.onChecked=t?se.map(se.filter(this._onChecked.event,a=>a.element===this),a=>a.checked):se.None,this._saneDetail=o.detail,this._labelHighlights=o.highlights?.label,this._descriptionHighlights=o.highlights?.description,this._detailHighlights=o.highlights?.detail}get separator(){return this._separator}set separator(e){this._separator=e}get checked(){return this._checked}set checked(e){e!==this._checked&&(this._checked=e,this._onChecked.fire({element:this,checked:e}))}get checkboxDisabled(){return!!this.item.disabled}}var hl;(function(s){s[s.NONE=0]="NONE",s[s.MOUSE_HOVER=1]="MOUSE_HOVER",s[s.ACTIVE_ITEM=2]="ACTIVE_ITEM"})(hl||(hl={}));class Gh extends b${constructor(e,t,i){super(e,!1,i),this.fireSeparatorButtonTriggered=t,this.separator=i,this.children=new Array,this.focusInsideSeparator=hl.NONE}}class Vfe{getHeight(e){return e instanceof Gh?30:e.saneDetail?44:22}getTemplateId(e){return e instanceof kn?K0.ID:yx.ID}}class zfe{getWidgetAriaLabel(){return p("quickInput","Quick Input")}getAriaLabel(e){return e.separator?.label?`${e.saneAriaLabel}, ${e.separator.label}`:e.saneAriaLabel}getWidgetRole(){return"listbox"}getRole(e){return e.hasCheckbox?"checkbox":"option"}isChecked(e){if(!(!e.hasCheckbox||!(e instanceof kn)))return{get value(){return e.checked},onDidChange:t=>e.onChecked(()=>t())}}}class v${constructor(e){this.hoverDelegate=e}renderTemplate(e){const t=Object.create(null);t.toDisposeElement=new Z,t.toDisposeTemplate=new Z,t.entry=X(e,ha(".quick-input-list-entry"));const i=X(t.entry,ha("label.quick-input-list-label"));t.toDisposeTemplate.add(gi(i,ee.CLICK,c=>{t.checkbox.offsetParent||c.preventDefault()})),t.checkbox=X(i,ha("input.quick-input-list-checkbox")),t.checkbox.type="checkbox";const n=X(i,ha(".quick-input-list-rows")),o=X(n,ha(".quick-input-list-row")),r=X(n,ha(".quick-input-list-row"));t.label=new Z0(o,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0,hoverDelegate:this.hoverDelegate}),t.toDisposeTemplate.add(t.label),t.icon=e2(t.label.element,ha(".quick-input-list-icon"));const a=X(o,ha(".quick-input-list-entry-keybinding"));t.keybinding=new Em(a,lo),t.toDisposeTemplate.add(t.keybinding);const l=X(r,ha(".quick-input-list-label-meta"));return t.detail=new Z0(l,{supportHighlights:!0,supportIcons:!0,hoverDelegate:this.hoverDelegate}),t.toDisposeTemplate.add(t.detail),t.separator=X(t.entry,ha(".quick-input-list-separator")),t.actionBar=new zo(t.entry,this.hoverDelegate?{hoverDelegate:this.hoverDelegate}:void 0),t.actionBar.domNode.classList.add("quick-input-list-entry-action-bar"),t.toDisposeTemplate.add(t.actionBar),t}disposeTemplate(e){e.toDisposeElement.dispose(),e.toDisposeTemplate.dispose()}disposeElement(e,t,i){i.toDisposeElement.clear(),i.actionBar.clear()}}let K0=class extends v${static{$N=this}static{this.ID="quickpickitem"}constructor(e,t){super(e),this.themeService=t,this._itemsWithSeparatorsFrequency=new Map}get templateId(){return $N.ID}renderTemplate(e){const t=super.renderTemplate(e);return t.toDisposeTemplate.add(gi(t.checkbox,ee.CHANGE,i=>{t.element.checked=t.checkbox.checked})),t}renderElement(e,t,i){const n=e.element;i.element=n,n.element=i.entry??void 0;const o=n.item;i.checkbox.checked=n.checked,i.toDisposeElement.add(n.onChecked(u=>i.checkbox.checked=u)),i.checkbox.disabled=n.checkboxDisabled;const{labelHighlights:r,descriptionHighlights:a,detailHighlights:l}=n;if(o.iconPath){const u=Dp(this.themeService.getColorTheme().type)?o.iconPath.dark:o.iconPath.light??o.iconPath.dark,g=Se.revive(u);i.icon.className="quick-input-list-icon",i.icon.style.backgroundImage=Hc(g)}else i.icon.style.backgroundImage="",i.icon.className=o.iconClass?`quick-input-list-icon ${o.iconClass}`:"";let c;!n.saneTooltip&&n.saneDescription&&(c={markdown:{value:n.saneDescription,supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDescription});const d={matches:r||[],descriptionTitle:c,descriptionMatches:a||[],labelEscapeNewLines:!0};if(d.extraClasses=o.iconClasses,d.italic=o.italic,d.strikethrough=o.strikethrough,i.entry.classList.remove("quick-input-list-separator-as-item"),i.label.setLabel(n.saneLabel,n.saneDescription,d),i.keybinding.set(o.keybinding),n.saneDetail){let u;n.saneTooltip||(u={markdown:{value:n.saneDetail,supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDetail}),i.detail.element.style.display="",i.detail.setLabel(n.saneDetail,void 0,{matches:l,title:u,labelEscapeNewLines:!0})}else i.detail.element.style.display="none";n.separator?.label?(i.separator.textContent=n.separator.label,i.separator.style.display="",this.addItemWithSeparator(n)):i.separator.style.display="none",i.entry.classList.toggle("quick-input-list-separator-border",!!n.separator);const h=o.buttons;h&&h.length?(i.actionBar.push(h.map((u,g)=>ab(u,`id-${g}`,()=>n.fireButtonTriggered({button:u,item:n.item}))),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions")}disposeElement(e,t,i){this.removeItemWithSeparator(e.element),super.disposeElement(e,t,i)}isItemWithSeparatorVisible(e){return this._itemsWithSeparatorsFrequency.has(e)}addItemWithSeparator(e){this._itemsWithSeparatorsFrequency.set(e,(this._itemsWithSeparatorsFrequency.get(e)||0)+1)}removeItemWithSeparator(e){const t=this._itemsWithSeparatorsFrequency.get(e)||0;t>1?this._itemsWithSeparatorsFrequency.set(e,t-1):this._itemsWithSeparatorsFrequency.delete(e)}};K0=$N=Cx([UN(1,Ki)],K0);class yx extends v${constructor(){super(...arguments),this._visibleSeparatorsFrequency=new Map}static{this.ID="quickpickseparator"}get templateId(){return yx.ID}get visibleSeparators(){return[...this._visibleSeparatorsFrequency.keys()]}isSeparatorVisible(e){return this._visibleSeparatorsFrequency.has(e)}renderTemplate(e){const t=super.renderTemplate(e);return t.checkbox.style.display="none",t}renderElement(e,t,i){const n=e.element;i.element=n,n.element=i.entry??void 0,n.element.classList.toggle("focus-inside",!!n.focusInsideSeparator);const o=n.separator,{labelHighlights:r,descriptionHighlights:a,detailHighlights:l}=n;i.icon.style.backgroundImage="",i.icon.className="";let c;!n.saneTooltip&&n.saneDescription&&(c={markdown:{value:n.saneDescription,supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDescription});const d={matches:r||[],descriptionTitle:c,descriptionMatches:a||[],labelEscapeNewLines:!0};if(i.entry.classList.add("quick-input-list-separator-as-item"),i.label.setLabel(n.saneLabel,n.saneDescription,d),n.saneDetail){let u;n.saneTooltip||(u={markdown:{value:n.saneDetail,supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDetail}),i.detail.element.style.display="",i.detail.setLabel(n.saneDetail,void 0,{matches:l,title:u,labelEscapeNewLines:!0})}else i.detail.element.style.display="none";i.separator.style.display="none",i.entry.classList.add("quick-input-list-separator-border");const h=o.buttons;h&&h.length?(i.actionBar.push(h.map((u,g)=>ab(u,`id-${g}`,()=>n.fireSeparatorButtonTriggered({button:u,separator:n.separator}))),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions"),this.addSeparator(n)}disposeElement(e,t,i){this.removeSeparator(e.element),this.isSeparatorVisible(e.element)||e.element.element?.classList.remove("focus-inside"),super.disposeElement(e,t,i)}addSeparator(e){this._visibleSeparatorsFrequency.set(e,(this._visibleSeparatorsFrequency.get(e)||0)+1)}removeSeparator(e){const t=this._visibleSeparatorsFrequency.get(e)||0;t>1?this._visibleSeparatorsFrequency.set(e,t-1):this._visibleSeparatorsFrequency.delete(e)}}let Lv=class extends B{constructor(e,t,i,n,o,r){super(),this.parent=e,this.hoverDelegate=t,this.linkOpenerDelegate=i,this.accessibilityService=r,this._onKeyDown=new O,this._onLeave=new O,this.onLeave=this._onLeave.event,this._visibleCountObservable=Ze("VisibleCount",0),this.onChangedVisibleCount=se.fromObservable(this._visibleCountObservable,this._store),this._allVisibleCheckedObservable=Ze("AllVisibleChecked",!1),this.onChangedAllVisibleChecked=se.fromObservable(this._allVisibleCheckedObservable,this._store),this._checkedCountObservable=Ze("CheckedCount",0),this.onChangedCheckedCount=se.fromObservable(this._checkedCountObservable,this._store),this._checkedElementsObservable=dN({equalsFn:ii},new Array),this.onChangedCheckedElements=se.fromObservable(this._checkedElementsObservable,this._store),this._onButtonTriggered=new O,this.onButtonTriggered=this._onButtonTriggered.event,this._onSeparatorButtonTriggered=new O,this.onSeparatorButtonTriggered=this._onSeparatorButtonTriggered.event,this._elementChecked=new O,this._elementCheckedEventBufferer=new mC,this._hasCheckboxes=!1,this._inputElements=new Array,this._elementTree=new Array,this._itemElements=new Array,this._elementDisposable=this._register(new Z),this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._shouldLoop=!0,this._container=X(this.parent,ha(".quick-input-list")),this._separatorRenderer=new yx(t),this._itemRenderer=o.createInstance(K0,t),this._tree=this._register(o.createInstance(VN,"QuickInput",this._container,new Vfe,[this._itemRenderer,this._separatorRenderer],{filter:{filter(a){return a.hidden?0:a instanceof Gh?2:1}},sorter:{compare:(a,l)=>{if(!this.sortByLabel||!this._lastQueryString)return 0;const c=this._lastQueryString.toLowerCase();return $fe(a,l,c)}},accessibilityProvider:new zfe,setRowLineHeight:!1,multipleSelectionSupport:!1,hideTwistiesOfChildlessElements:!0,renderIndentGuides:Hp.None,findWidgetEnabled:!1,indent:0,horizontalScrolling:!1,allowNonCollapsibleParents:!0,alwaysConsumeMouseWheel:!0})),this._tree.getHTMLElement().id=n,this._registerListeners()}get onDidChangeFocus(){return se.map(this._tree.onDidChangeFocus,e=>e.elements.filter(t=>t instanceof kn).map(t=>t.item),this._store)}get onDidChangeSelection(){return se.map(this._tree.onDidChangeSelection,e=>({items:e.elements.filter(t=>t instanceof kn).map(t=>t.item),event:e.browserEvent}),this._store)}get displayed(){return this._container.style.display!=="none"}set displayed(e){this._container.style.display=e?"":"none"}get scrollTop(){return this._tree.scrollTop}set scrollTop(e){this._tree.scrollTop=e}get ariaLabel(){return this._tree.ariaLabel}set ariaLabel(e){this._tree.ariaLabel=e??""}set enabled(e){this._tree.getHTMLElement().style.pointerEvents=e?"":"none"}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(e){this._matchOnLabelMode=e}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e}get shouldLoop(){return this._shouldLoop}set shouldLoop(e){this._shouldLoop=e}_registerListeners(){this._registerOnKeyDown(),this._registerOnContainerClick(),this._registerOnMouseMiddleClick(),this._registerOnTreeModelChanged(),this._registerOnElementChecked(),this._registerOnContextMenu(),this._registerHoverListeners(),this._registerSelectionChangeListener(),this._registerSeparatorActionShowingListeners()}_registerOnKeyDown(){this._register(this._tree.onKeyDown(e=>{const t=new Ft(e);switch(t.keyCode){case 10:this.toggleCheckbox();break}this._onKeyDown.fire(t)}))}_registerOnContainerClick(){this._register(U(this._container,ee.CLICK,e=>{(e.x||e.y)&&this._onLeave.fire()}))}_registerOnMouseMiddleClick(){this._register(U(this._container,ee.AUXCLICK,e=>{e.button===1&&this._onLeave.fire()}))}_registerOnTreeModelChanged(){this._register(this._tree.onDidChangeModel(()=>{const e=this._itemElements.filter(t=>!t.hidden).length;this._visibleCountObservable.set(e,void 0),this._hasCheckboxes&&this._updateCheckedObservables()}))}_registerOnElementChecked(){this._register(this._elementCheckedEventBufferer.wrapEvent(this._elementChecked.event,(e,t)=>t)(e=>this._updateCheckedObservables()))}_registerOnContextMenu(){this._register(this._tree.onContextMenu(e=>{e.element&&(e.browserEvent.preventDefault(),this._tree.setSelection([e.element]))}))}_registerHoverListeners(){const e=this._register(new O6(this.hoverDelegate.delay));this._register(this._tree.onMouseOver(async t=>{if(j5(t.browserEvent.target)){e.cancel();return}if(!(!j5(t.browserEvent.relatedTarget)&&Ji(t.browserEvent.relatedTarget,t.element?.element)))try{await e.trigger(async()=>{t.element instanceof kn&&this.showHover(t.element)})}catch(i){if(!xr(i))throw i}})),this._register(this._tree.onMouseOut(t=>{Ji(t.browserEvent.relatedTarget,t.element?.element)||e.cancel()}))}_registerSeparatorActionShowingListeners(){this._register(this._tree.onDidChangeFocus(e=>{const t=e.elements[0]?this._tree.getParentElement(e.elements[0]):null;for(const i of this._separatorRenderer.visibleSeparators){const n=i===t;!!(i.focusInsideSeparator&hl.ACTIVE_ITEM)!==n&&(n?i.focusInsideSeparator|=hl.ACTIVE_ITEM:i.focusInsideSeparator&=~hl.ACTIVE_ITEM,this._tree.rerender(i))}})),this._register(this._tree.onMouseOver(e=>{const t=e.element?this._tree.getParentElement(e.element):null;for(const i of this._separatorRenderer.visibleSeparators){if(i!==t)continue;!!(i.focusInsideSeparator&hl.MOUSE_HOVER)||(i.focusInsideSeparator|=hl.MOUSE_HOVER,this._tree.rerender(i))}})),this._register(this._tree.onMouseOut(e=>{const t=e.element?this._tree.getParentElement(e.element):null;for(const i of this._separatorRenderer.visibleSeparators){if(i!==t)continue;!!(i.focusInsideSeparator&hl.MOUSE_HOVER)&&(i.focusInsideSeparator&=~hl.MOUSE_HOVER,this._tree.rerender(i))}}))}_registerSelectionChangeListener(){this._register(this._tree.onDidChangeSelection(e=>{const t=e.elements.filter(i=>i instanceof kn);t.length!==e.elements.length&&(e.elements.length===1&&e.elements[0]instanceof Gh&&(this._tree.setFocus([e.elements[0].children[0]]),this._tree.reveal(e.elements[0],0)),this._tree.setSelection(t))}))}setAllVisibleChecked(e){this._elementCheckedEventBufferer.bufferEvents(()=>{this._itemElements.forEach(t=>{!t.hidden&&!t.checkboxDisabled&&(t.checked=e)})})}setElements(e){this._elementDisposable.clear(),this._lastQueryString=void 0,this._inputElements=e,this._hasCheckboxes=this.parent.classList.contains("show-checkboxes");let t;this._itemElements=new Array,this._elementTree=e.reduce((i,n,o)=>{let r;if(n.type==="separator"){if(!n.buttons)return i;t=new Gh(o,a=>this._onSeparatorButtonTriggered.fire(a),n),r=t}else{const a=o>0?e[o-1]:void 0;let l;a&&a.type==="separator"&&!a.buttons&&(t=void 0,l=a);const c=new kn(o,this._hasCheckboxes,d=>this._onButtonTriggered.fire(d),this._elementChecked,n,l);if(this._itemElements.push(c),t)return t.children.push(c),i;r=c}return i.push(r),i},new Array),this._setElementsToTree(this._elementTree),this.accessibilityService.isScreenReaderOptimized()&&setTimeout(()=>{const i=this._tree.getHTMLElement().querySelector(".monaco-list-row.focused"),n=i?.parentNode;if(i&&n){const o=i.nextSibling;i.remove(),n.insertBefore(i,o)}},0)}setFocusedElements(e){const t=e.map(i=>this._itemElements.find(n=>n.item===i)).filter(i=>!!i).filter(i=>!i.hidden);if(this._tree.setFocus(t),e.length>0){const i=this._tree.getFocus()[0];i&&this._tree.reveal(i)}}getActiveDescendant(){return this._tree.getHTMLElement().getAttribute("aria-activedescendant")}setSelectedElements(e){const t=e.map(i=>this._itemElements.find(n=>n.item===i)).filter(i=>!!i);this._tree.setSelection(t)}getCheckedElements(){return this._itemElements.filter(e=>e.checked).map(e=>e.item)}setCheckedElements(e){this._elementCheckedEventBufferer.bufferEvents(()=>{const t=new Set;for(const i of e)t.add(i);for(const i of this._itemElements)i.checked=t.has(i.item)})}focus(e){if(this._itemElements.length)switch(e===zt.Second&&this._itemElements.length<2&&(e=zt.First),e){case zt.First:this._tree.scrollTop=0,this._tree.focusFirst(void 0,t=>t.element instanceof kn);break;case zt.Second:{this._tree.scrollTop=0;let t=!1;this._tree.focusFirst(void 0,i=>i.element instanceof kn?t?!0:(t=!t,!1):!1);break}case zt.Last:this._tree.scrollTop=this._tree.scrollHeight,this._tree.focusLast(void 0,t=>t.element instanceof kn);break;case zt.Next:{const t=this._tree.getFocus();this._tree.focusNext(void 0,this._shouldLoop,void 0,n=>n.element instanceof kn?(this._tree.reveal(n.element),!0):!1);const i=this._tree.getFocus();t.length&&t[0]===i[0]&&t[0]===this._itemElements[this._itemElements.length-1]&&this._onLeave.fire();break}case zt.Previous:{const t=this._tree.getFocus();this._tree.focusPrevious(void 0,this._shouldLoop,void 0,n=>{if(!(n.element instanceof kn))return!1;const o=this._tree.getParentElement(n.element);return o===null||o.children[0]!==n.element?this._tree.reveal(n.element):this._tree.reveal(o),!0});const i=this._tree.getFocus();t.length&&t[0]===i[0]&&t[0]===this._itemElements[0]&&this._onLeave.fire();break}case zt.NextPage:this._tree.focusNextPage(void 0,t=>t.element instanceof kn?(this._tree.reveal(t.element),!0):!1);break;case zt.PreviousPage:this._tree.focusPreviousPage(void 0,t=>{if(!(t.element instanceof kn))return!1;const i=this._tree.getParentElement(t.element);return i===null||i.children[0]!==t.element?this._tree.reveal(t.element):this._tree.reveal(i),!0});break;case zt.NextSeparator:{let t=!1;const i=this._tree.getFocus()[0];this._tree.focusNext(void 0,!0,void 0,o=>{if(t)return!0;if(o.element instanceof Gh)t=!0,this._separatorRenderer.isSeparatorVisible(o.element)?this._tree.reveal(o.element.children[0]):this._tree.reveal(o.element,0);else if(o.element instanceof kn){if(o.element.separator)return this._itemRenderer.isItemWithSeparatorVisible(o.element)?this._tree.reveal(o.element):this._tree.reveal(o.element,0),!0;if(o.element===this._elementTree[0])return this._tree.reveal(o.element,0),!0}return!1});const n=this._tree.getFocus()[0];i===n&&(this._tree.scrollTop=this._tree.scrollHeight,this._tree.focusLast(void 0,o=>o.element instanceof kn));break}case zt.PreviousSeparator:{let t,i=!!this._tree.getFocus()[0]?.separator;this._tree.focusPrevious(void 0,!0,void 0,n=>{if(n.element instanceof Gh)i?t||(this._separatorRenderer.isSeparatorVisible(n.element)?this._tree.reveal(n.element):this._tree.reveal(n.element,0),t=n.element.children[0]):i=!0;else if(n.element instanceof kn&&!t){if(n.element.separator)this._itemRenderer.isItemWithSeparatorVisible(n.element)?this._tree.reveal(n.element):this._tree.reveal(n.element,0),t=n.element;else if(n.element===this._elementTree[0])return this._tree.reveal(n.element,0),!0}return!1}),t&&this._tree.setFocus([t]);break}}}clearFocus(){this._tree.setFocus([])}domFocus(){this._tree.domFocus()}layout(e){this._tree.getHTMLElement().style.maxHeight=e?`${Math.floor(e/44)*44+6}px`:"",this._tree.layout()}filter(e){if(this._lastQueryString=e,!(this._sortByLabel||this._matchOnLabel||this._matchOnDescription||this._matchOnDetail))return this._tree.layout(),!1;const t=e;if(e=e.trim(),!e||!(this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))this._itemElements.forEach(i=>{i.labelHighlights=void 0,i.descriptionHighlights=void 0,i.detailHighlights=void 0,i.hidden=!1;const n=i.index&&this._inputElements[i.index-1];i.item&&(i.separator=n&&n.type==="separator"&&!n.buttons?n:void 0)});else{let i;this._itemElements.forEach(n=>{let o;this.matchOnLabelMode==="fuzzy"?o=this.matchOnLabel?vD(e,x_(n.saneLabel))??void 0:void 0:o=this.matchOnLabel?Ufe(t,x_(n.saneLabel))??void 0:void 0;const r=this.matchOnDescription?vD(e,x_(n.saneDescription||""))??void 0:void 0,a=this.matchOnDetail?vD(e,x_(n.saneDetail||""))??void 0:void 0;if(o||r||a?(n.labelHighlights=o,n.descriptionHighlights=r,n.detailHighlights=a,n.hidden=!1):(n.labelHighlights=void 0,n.descriptionHighlights=void 0,n.detailHighlights=void 0,n.hidden=n.item?!n.item.alwaysShow:!0),n.item?n.separator=void 0:n.separator&&(n.hidden=!0),!this.sortByLabel){const l=n.index&&this._inputElements[n.index-1]||void 0;l?.type==="separator"&&!l.buttons&&(i=l),i&&!n.hidden&&(n.separator=i,i=void 0)}})}return this._setElementsToTree(this._sortByLabel&&e?this._itemElements:this._elementTree),this._tree.layout(),!0}toggleCheckbox(){this._elementCheckedEventBufferer.bufferEvents(()=>{const e=this._tree.getFocus().filter(i=>i instanceof kn),t=this._allVisibleChecked(e);for(const i of e)i.checkboxDisabled||(i.checked=!t)})}style(e){this._tree.style(e)}toggleHover(){const e=this._tree.getFocus()[0];if(!e?.saneTooltip||!(e instanceof kn))return;if(this._lastHover&&!this._lastHover.isDisposed){this._lastHover.dispose();return}this.showHover(e);const t=new Z;t.add(this._tree.onDidChangeFocus(i=>{i.elements[0]instanceof kn&&this.showHover(i.elements[0])})),this._lastHover&&t.add(this._lastHover),this._elementDisposable.add(t)}_setElementsToTree(e){const t=new Array;for(const i of e)i instanceof Gh?t.push({element:i,collapsible:!1,collapsed:!1,children:i.children.map(n=>({element:n,collapsible:!1,collapsed:!1}))}):t.push({element:i,collapsible:!1,collapsed:!1});this._tree.setChildren(null,t)}_allVisibleChecked(e,t=!0){for(let i=0,n=e.length;i<n;i++){const o=e[i];if(!o.hidden)if(o.checked)t=!0;else return!1}return t}_updateCheckedObservables(){ai(e=>{this._allVisibleCheckedObservable.set(this._allVisibleChecked(this._itemElements,!1),e);const t=this._itemElements.filter(i=>i.checked).length;this._checkedCountObservable.set(t,e),this._checkedElementsObservable.set(this.getCheckedElements(),e)})}showHover(e){this._lastHover&&!this._lastHover.isDisposed&&(this.hoverDelegate.onDidHideHover?.(),this._lastHover?.dispose()),!(!e.element||!e.saneTooltip)&&(this._lastHover=this.hoverDelegate.showHover({content:e.saneTooltip,target:e.element,linkHandler:t=>{this.linkOpenerDelegate(t)},appearance:{showPointer:!0},container:this._container,position:{hoverPosition:1}},!1))}};Cx([Ti],Lv.prototype,"onDidChangeFocus",null);Cx([Ti],Lv.prototype,"onDidChangeSelection",null);Lv=Cx([UN(4,ye),UN(5,vo)],Lv);function Ufe(s,e){const{text:t,iconOffsets:i}=e;if(!i||i.length===0)return AW(s,t);const n=_C(t," "),o=t.length-n.length,r=AW(s,n);if(r)for(const a of r){const l=i[a.start+o]+o;a.start+=l,a.end+=l}return r}function AW(s,e){const t=e.toLowerCase().indexOf(s.toLowerCase());return t!==-1?[{start:t,end:t+s.length}]:null}function $fe(s,e,t){const i=s.labelHighlights||[],n=e.labelHighlights||[];return i.length&&!n.length?-1:!i.length&&n.length?1:i.length===0&&n.length===0?0:Wfe(s.saneSortLabel,e.saneSortLabel,t)}const C$={weight:200,when:q.and(q.equals($U,"quickPick"),bge),metadata:{description:p("quickPick","Used while in the context of the quick pick. If you change one keybinding for this command, you should change all of the other keybindings (modifier variants) of this command as well.")}};function no(s,e={}){Ss.registerCommandAndKeybindingRule({...C$,...s,secondary:jfe(s.primary,s.secondary??[],e)})}const q0=Qe?256:2048;function jfe(s,e,t={}){return t.withAltMod&&e.push(512+s),t.withCtrlMod&&(e.push(q0+s),t.withAltMod&&e.push(512+q0+s)),t.withCmdMod&&Qe&&(e.push(2048+s),t.withCtrlMod&&e.push(2304+s),t.withAltMod&&(e.push(2560+s),t.withCtrlMod&&e.push(2816+s))),e}function To(s,e){return t=>{const i=t.get(Dr).currentQuickInput;if(i)return e&&i.quickNavigate?i.focus(e):i.focus(s)}}no({id:"quickInput.pageNext",primary:12,handler:To(zt.NextPage)},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});no({id:"quickInput.pagePrevious",primary:11,handler:To(zt.PreviousPage)},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});no({id:"quickInput.first",primary:q0+14,handler:To(zt.First)},{withAltMod:!0,withCmdMod:!0});no({id:"quickInput.last",primary:q0+13,handler:To(zt.Last)},{withAltMod:!0,withCmdMod:!0});no({id:"quickInput.next",primary:18,handler:To(zt.Next)},{withCtrlMod:!0});no({id:"quickInput.previous",primary:16,handler:To(zt.Previous)},{withCtrlMod:!0});const PW=p("quickInput.nextSeparatorWithQuickAccessFallback","If we're in quick access mode, this will navigate to the next item. If we are not in quick access mode, this will navigate to the next separator."),OW=p("quickInput.previousSeparatorWithQuickAccessFallback","If we're in quick access mode, this will navigate to the previous item. If we are not in quick access mode, this will navigate to the previous separator.");Qe?(no({id:"quickInput.nextSeparatorWithQuickAccessFallback",primary:2066,handler:To(zt.NextSeparator,zt.Next),metadata:{description:PW}}),no({id:"quickInput.nextSeparator",primary:2578,secondary:[2322],handler:To(zt.NextSeparator)},{withCtrlMod:!0}),no({id:"quickInput.previousSeparatorWithQuickAccessFallback",primary:2064,handler:To(zt.PreviousSeparator,zt.Previous),metadata:{description:OW}}),no({id:"quickInput.previousSeparator",primary:2576,secondary:[2320],handler:To(zt.PreviousSeparator)},{withCtrlMod:!0})):(no({id:"quickInput.nextSeparatorWithQuickAccessFallback",primary:530,handler:To(zt.NextSeparator,zt.Next),metadata:{description:PW}}),no({id:"quickInput.nextSeparator",primary:2578,handler:To(zt.NextSeparator)}),no({id:"quickInput.previousSeparatorWithQuickAccessFallback",primary:528,handler:To(zt.PreviousSeparator,zt.Previous),metadata:{description:OW}}),no({id:"quickInput.previousSeparator",primary:2576,handler:To(zt.PreviousSeparator)}));no({id:"quickInput.acceptInBackground",when:q.and(C$.when,q.or(l$.negate(),yge)),primary:17,weight:250,handler:s=>{s.get(Dr).currentQuickInput?.accept(!0)}},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});var Zfe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},zD=function(s,e){return function(t,i){e(t,i,s)}},jN;const eo=te;let ZN=class extends B{static{jN=this}static{this.MAX_WIDTH=600}get currentQuickInput(){return this.controller??void 0}get container(){return this._container}constructor(e,t,i,n){super(),this.options=e,this.layoutService=t,this.instantiationService=i,this.contextKeyService=n,this.enabled=!0,this.onDidAcceptEmitter=this._register(new O),this.onDidCustomEmitter=this._register(new O),this.onDidTriggerButtonEmitter=this._register(new O),this.keyMods={ctrlCmd:!1,alt:!1},this.controller=null,this.onShowEmitter=this._register(new O),this.onShow=this.onShowEmitter.event,this.onHideEmitter=this._register(new O),this.onHide=this.onHideEmitter.event,this.inQuickInputContext=_ge.bindTo(this.contextKeyService),this.quickInputTypeContext=vge.bindTo(this.contextKeyService),this.endOfQuickInputBoxContext=Cge.bindTo(this.contextKeyService),this.idPrefix=e.idPrefix,this._container=e.container,this.styles=e.styles,this._register(se.runAndSubscribe(wL,({window:o,disposables:r})=>this.registerKeyModsListeners(o,r),{window:Nt,disposables:this._store})),this._register(wte(o=>{this.ui&&ke(this.ui.container)===o&&(this.reparentUI(this.layoutService.mainContainer),this.layout(this.layoutService.mainContainerDimension,this.layoutService.mainContainerOffset.quickPickTop))}))}registerKeyModsListeners(e,t){const i=n=>{this.keyMods.ctrlCmd=n.ctrlKey||n.metaKey,this.keyMods.alt=n.altKey};for(const n of[ee.KEY_DOWN,ee.KEY_UP,ee.MOUSE_DOWN])t.add(U(e,n,i,!0))}getUI(e){if(this.ui)return e&&ke(this._container)!==ke(this.layoutService.activeContainer)&&(this.reparentUI(this.layoutService.activeContainer),this.layout(this.layoutService.activeContainerDimension,this.layoutService.activeContainerOffset.quickPickTop)),this.ui;const t=X(this._container,eo(".quick-input-widget.show-file-icons"));t.tabIndex=-1,t.style.display="none";const i=$o(t),n=X(t,eo(".quick-input-titlebar")),o=this._register(new zo(n,{hoverDelegate:this.options.hoverDelegate}));o.domNode.classList.add("quick-input-left-action-bar");const r=X(n,eo(".quick-input-title")),a=this._register(new zo(n,{hoverDelegate:this.options.hoverDelegate}));a.domNode.classList.add("quick-input-right-action-bar");const l=X(t,eo(".quick-input-header")),c=X(l,eo("input.quick-input-check-all"));c.type="checkbox",c.setAttribute("aria-label",p("quickInput.checkAll","Toggle all checkboxes")),this._register(gi(c,ee.CHANGE,V=>{const Y=c.checked;H.setAllVisibleChecked(Y)})),this._register(U(c,ee.CLICK,V=>{(V.x||V.y)&&g.setFocus()}));const d=X(l,eo(".quick-input-description")),h=X(l,eo(".quick-input-and-message")),u=X(h,eo(".quick-input-filter")),g=this._register(new Nge(u,this.styles.inputBox,this.styles.toggle));g.setAttribute("aria-describedby",`${this.idPrefix}message`);const f=X(u,eo(".quick-input-visible-count"));f.setAttribute("aria-live","polite"),f.setAttribute("aria-atomic","true");const m=new FN(f,{countFormat:p({key:"quickInput.visibleCount",comment:["This tells the user how many items are shown in a list of items to select from. The items can be anything. Currently not visible, but read by screen readers."]},"{0} Results")},this.styles.countBadge),_=X(u,eo(".quick-input-count"));_.setAttribute("aria-live","polite");const b=new FN(_,{countFormat:p({key:"quickInput.countSelected",comment:["This tells the user how many items are selected in a list of items to select from. The items can be anything."]},"{0} Selected")},this.styles.countBadge),v=this._register(new zo(l,{hoverDelegate:this.options.hoverDelegate}));v.domNode.classList.add("quick-input-inline-action-bar");const C=X(l,eo(".quick-input-action")),y=this._register(new O0(C,this.styles.button));y.label=p("ok","OK"),this._register(y.onDidClick(V=>{this.onDidAcceptEmitter.fire()}));const w=X(l,eo(".quick-input-action")),x=this._register(new O0(w,{...this.styles.button,supportIcons:!0}));x.label=p("custom","Custom"),this._register(x.onDidClick(V=>{this.onDidCustomEmitter.fire()}));const L=X(h,eo(`#${this.idPrefix}message.quick-input-message`)),D=this._register(new fO(t,this.styles.progressBar));D.getContainer().classList.add("quick-input-progress");const T=X(t,eo(".quick-input-html-widget"));T.tabIndex=-1;const F=X(t,eo(".quick-input-description")),W=this.idPrefix+"list",H=this._register(this.instantiationService.createInstance(Lv,t,this.options.hoverDelegate,this.options.linkOpenerDelegate,W));g.setAttribute("aria-controls",W),this._register(H.onDidChangeFocus(()=>{g.setAttribute("aria-activedescendant",H.getActiveDescendant()??"")})),this._register(H.onChangedAllVisibleChecked(V=>{c.checked=V})),this._register(H.onChangedVisibleCount(V=>{m.setCount(V)})),this._register(H.onChangedCheckedCount(V=>{b.setCount(V)})),this._register(H.onLeave(()=>{setTimeout(()=>{this.controller&&(g.setFocus(),this.controller instanceof P0&&this.controller.canSelectMany&&H.clearFocus())},0)}));const $=Wa(t);return this._register($),this._register(U(t,ee.FOCUS,V=>{const Y=this.getUI();if(Ji(V.relatedTarget,Y.inputContainer)){const ie=Y.inputBox.isSelectionAtEnd();this.endOfQuickInputBoxContext.get()!==ie&&this.endOfQuickInputBoxContext.set(ie)}Ji(V.relatedTarget,Y.container)||(this.inQuickInputContext.set(!0),this.previousFocusElement=tn(V.relatedTarget)?V.relatedTarget:void 0)},!0)),this._register($.onDidBlur(()=>{!this.getUI().ignoreFocusOut&&!this.options.ignoreFocusOut()&&this.hide(Wp.Blur),this.inQuickInputContext.set(!1),this.endOfQuickInputBoxContext.set(!1),this.previousFocusElement=void 0})),this._register(g.onKeyDown(V=>{const Y=this.getUI().inputBox.isSelectionAtEnd();this.endOfQuickInputBoxContext.get()!==Y&&this.endOfQuickInputBoxContext.set(Y)})),this._register(U(t,ee.FOCUS,V=>{g.setFocus()})),this._register(gi(t,ee.KEY_DOWN,V=>{if(!Ji(V.target,T))switch(V.keyCode){case 3:it.stop(V,!0),this.enabled&&this.onDidAcceptEmitter.fire();break;case 9:it.stop(V,!0),this.hide(Wp.Gesture);break;case 2:if(!V.altKey&&!V.ctrlKey&&!V.metaKey){const Y=[".quick-input-list .monaco-action-bar .always-visible",".quick-input-list-entry:hover .monaco-action-bar",".monaco-list-row.focused .monaco-action-bar"];if(t.classList.contains("show-checkboxes")?Y.push("input"):Y.push("input[type=text]"),this.getUI().list.displayed&&Y.push(".monaco-list"),this.getUI().message&&Y.push(".quick-input-message a"),this.getUI().widget){if(Ji(V.target,this.getUI().widget))break;Y.push(".quick-input-html-widget")}const ie=t.querySelectorAll(Y.join(", "));V.shiftKey&&V.target===ie[0]?(it.stop(V,!0),H.clearFocus()):!V.shiftKey&&Ji(V.target,ie[ie.length-1])&&(it.stop(V,!0),ie[0].focus())}break;case 10:V.ctrlKey&&(it.stop(V,!0),this.getUI().list.toggleHover());break}})),this.ui={container:t,styleSheet:i,leftActionBar:o,titleBar:n,title:r,description1:F,description2:d,widget:T,rightActionBar:a,inlineActionBar:v,checkAll:c,inputContainer:h,filterContainer:u,inputBox:g,visibleCountContainer:f,visibleCount:m,countContainer:_,count:b,okContainer:C,ok:y,message:L,customButtonContainer:w,customButton:x,list:H,progressBar:D,onDidAccept:this.onDidAcceptEmitter.event,onDidCustom:this.onDidCustomEmitter.event,onDidTriggerButton:this.onDidTriggerButtonEmitter.event,ignoreFocusOut:!1,keyMods:this.keyMods,show:V=>this.show(V),hide:()=>this.hide(),setVisibilities:V=>this.setVisibilities(V),setEnabled:V=>this.setEnabled(V),setContextKey:V=>this.options.setContextKey(V),linkOpenerDelegate:V=>this.options.linkOpenerDelegate(V)},this.updateStyles(),this.ui}reparentUI(e){this.ui&&(this._container=e,X(this._container,this.ui.container))}pick(e,t={},i=Ue.None){return new Promise((n,o)=>{let r=d=>{r=n,t.onKeyMods?.(a.keyMods),n(d)};if(i.isCancellationRequested){r(void 0);return}const a=this.createQuickPick({useSeparators:!0});let l;const c=[a,a.onDidAccept(()=>{if(a.canSelectMany)r(a.selectedItems.slice()),a.hide();else{const d=a.activeItems[0];d&&(r(d),a.hide())}}),a.onDidChangeActive(d=>{const h=d[0];h&&t.onDidFocus&&t.onDidFocus(h)}),a.onDidChangeSelection(d=>{if(!a.canSelectMany){const h=d[0];h&&(r(h),a.hide())}}),a.onDidTriggerItemButton(d=>t.onDidTriggerItemButton&&t.onDidTriggerItemButton({...d,removeItem:()=>{const h=a.items.indexOf(d.item);if(h!==-1){const u=a.items.slice(),g=u.splice(h,1),f=a.activeItems.filter(_=>_!==g[0]),m=a.keepScrollPosition;a.keepScrollPosition=!0,a.items=u,f&&(a.activeItems=f),a.keepScrollPosition=m}}})),a.onDidTriggerSeparatorButton(d=>t.onDidTriggerSeparatorButton?.(d)),a.onDidChangeValue(d=>{l&&!d&&(a.activeItems.length!==1||a.activeItems[0]!==l)&&(a.activeItems=[l])}),i.onCancellationRequested(()=>{a.hide()}),a.onDidHide(()=>{At(c),r(void 0)})];a.title=t.title,t.value&&(a.value=t.value),a.canSelectMany=!!t.canPickMany,a.placeholder=t.placeHolder,a.ignoreFocusOut=!!t.ignoreFocusLost,a.matchOnDescription=!!t.matchOnDescription,a.matchOnDetail=!!t.matchOnDetail,a.matchOnLabel=t.matchOnLabel===void 0||t.matchOnLabel,a.quickNavigate=t.quickNavigate,a.hideInput=!!t.hideInput,a.contextKey=t.contextKey,a.busy=!0,Promise.all([e,t.activeItem]).then(([d,h])=>{l=h,a.busy=!1,a.items=d,a.canSelectMany&&(a.selectedItems=d.filter(u=>u.type!=="separator"&&u.picked)),l&&(a.activeItems=[l])}),a.show(),Promise.resolve(e).then(void 0,d=>{o(d),a.hide()})})}createQuickPick(e={useSeparators:!1}){const t=this.getUI(!0);return new P0(t)}createInputBox(){const e=this.getUI(!0);return new wge(e)}show(e){const t=this.getUI(!0);this.onShowEmitter.fire();const i=this.controller;this.controller=e,i?.didHide(),this.setEnabled(!0),t.leftActionBar.clear(),t.title.textContent="",t.description1.textContent="",t.description2.textContent="",yn(t.widget),t.rightActionBar.clear(),t.inlineActionBar.clear(),t.checkAll.checked=!1,t.inputBox.placeholder="",t.inputBox.password=!1,t.inputBox.showDecoration(Di.Ignore),t.visibleCount.setCount(0),t.count.setCount(0),yn(t.message),t.progressBar.stop(),t.list.setElements([]),t.list.matchOnDescription=!1,t.list.matchOnDetail=!1,t.list.matchOnLabel=!0,t.list.sortByLabel=!0,t.ignoreFocusOut=!1,t.inputBox.toggles=void 0;const n=this.options.backKeybindingLabel();PN.tooltip=n?p("quickInput.backWithKeybinding","Back ({0})",n):p("quickInput.back","Back"),t.container.style.display="",this.updateLayout(),t.inputBox.setFocus(),this.quickInputTypeContext.set(e.type)}isVisible(){return!!this.ui&&this.ui.container.style.display!=="none"}setVisibilities(e){const t=this.getUI();t.title.style.display=e.title?"":"none",t.description1.style.display=e.description&&(e.inputBox||e.checkAll)?"":"none",t.description2.style.display=e.description&&!(e.inputBox||e.checkAll)?"":"none",t.checkAll.style.display=e.checkAll?"":"none",t.inputContainer.style.display=e.inputBox?"":"none",t.filterContainer.style.display=e.inputBox?"":"none",t.visibleCountContainer.style.display=e.visibleCount?"":"none",t.countContainer.style.display=e.count?"":"none",t.okContainer.style.display=e.ok?"":"none",t.customButtonContainer.style.display=e.customButton?"":"none",t.message.style.display=e.message?"":"none",t.progressBar.getContainer().style.display=e.progressBar?"":"none",t.list.displayed=!!e.list,t.container.classList.toggle("show-checkboxes",!!e.checkBox),t.container.classList.toggle("hidden-input",!e.inputBox&&!e.description),this.updateLayout()}setEnabled(e){if(e!==this.enabled){this.enabled=e;for(const t of this.getUI().leftActionBar.viewItems)t.action.enabled=e;for(const t of this.getUI().rightActionBar.viewItems)t.action.enabled=e;this.getUI().checkAll.disabled=!e,this.getUI().inputBox.enabled=e,this.getUI().ok.enabled=e,this.getUI().list.enabled=e}}hide(e){const t=this.controller;if(!t)return;t.willHide(e);const i=this.ui?.container,n=i&&!Q6(i);if(this.controller=null,this.onHideEmitter.fire(),i&&(i.style.display="none"),!n){let o=this.previousFocusElement;for(;o&&!o.offsetParent;)o=o.parentElement??void 0;o?.offsetParent?(o.focus(),this.previousFocusElement=void 0):this.options.returnFocus()}t.didHide(e)}layout(e,t){this.dimension=e,this.titleBarOffset=t,this.updateLayout()}updateLayout(){if(this.ui&&this.isVisible()){this.ui.container.style.top=`${this.titleBarOffset}px`;const e=this.ui.container.style,t=Math.min(this.dimension.width*.62,jN.MAX_WIDTH);e.width=t+"px",e.marginLeft="-"+t/2+"px",this.ui.inputBox.layout(),this.ui.list.layout(this.dimension&&this.dimension.height*.4)}}applyStyles(e){this.styles=e,this.updateStyles()}updateStyles(){if(this.ui){const{quickInputTitleBackground:e,quickInputBackground:t,quickInputForeground:i,widgetBorder:n,widgetShadow:o}=this.styles.widget;this.ui.titleBar.style.backgroundColor=e??"",this.ui.container.style.backgroundColor=t??"",this.ui.container.style.color=i??"",this.ui.container.style.border=n?`1px solid ${n}`:"",this.ui.container.style.boxShadow=o?`0 0 8px 2px ${o}`:"",this.ui.list.style(this.styles.list);const r=[];this.styles.pickerGroup.pickerGroupBorder&&r.push(`.quick-input-list .quick-input-list-entry { border-top-color:  ${this.styles.pickerGroup.pickerGroupBorder}; }`),this.styles.pickerGroup.pickerGroupForeground&&r.push(`.quick-input-list .quick-input-list-separator { color:  ${this.styles.pickerGroup.pickerGroupForeground}; }`),this.styles.pickerGroup.pickerGroupForeground&&r.push(".quick-input-list .quick-input-list-separator-as-item { color: var(--vscode-descriptionForeground); }"),(this.styles.keybindingLabel.keybindingLabelBackground||this.styles.keybindingLabel.keybindingLabelBorder||this.styles.keybindingLabel.keybindingLabelBottomBorder||this.styles.keybindingLabel.keybindingLabelShadow||this.styles.keybindingLabel.keybindingLabelForeground)&&(r.push(".quick-input-list .monaco-keybinding > .monaco-keybinding-key {"),this.styles.keybindingLabel.keybindingLabelBackground&&r.push(`background-color: ${this.styles.keybindingLabel.keybindingLabelBackground};`),this.styles.keybindingLabel.keybindingLabelBorder&&r.push(`border-color: ${this.styles.keybindingLabel.keybindingLabelBorder};`),this.styles.keybindingLabel.keybindingLabelBottomBorder&&r.push(`border-bottom-color: ${this.styles.keybindingLabel.keybindingLabelBottomBorder};`),this.styles.keybindingLabel.keybindingLabelShadow&&r.push(`box-shadow: inset 0 -1px 0 ${this.styles.keybindingLabel.keybindingLabelShadow};`),this.styles.keybindingLabel.keybindingLabelForeground&&r.push(`color: ${this.styles.keybindingLabel.keybindingLabelForeground};`),r.push("}"));const a=r.join(`
`);a!==this.ui.styleSheet.textContent&&(this.ui.styleSheet.textContent=a)}}};ZN=jN=Zfe([zD(1,vh),zD(2,ye),zD(3,Ee)],ZN);var Kfe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},o_=function(s,e){return function(t,i){e(t,i,s)}};let KN=class extends Bse{get controller(){return this._controller||(this._controller=this._register(this.createController())),this._controller}get hasController(){return!!this._controller}get currentQuickInput(){return this.controller.currentQuickInput}get quickAccess(){return this._quickAccess||(this._quickAccess=this._register(this.instantiationService.createInstance(AN))),this._quickAccess}constructor(e,t,i,n,o){super(i),this.instantiationService=e,this.contextKeyService=t,this.layoutService=n,this.configurationService=o,this._onShow=this._register(new O),this._onHide=this._register(new O),this.contexts=new Map}createController(e=this.layoutService,t){const i={idPrefix:"quickInput_",container:e.activeContainer,ignoreFocusOut:()=>!1,backKeybindingLabel:()=>{},setContextKey:o=>this.setContextKey(o),linkOpenerDelegate:o=>{this.instantiationService.invokeFunction(r=>{r.get(Ys).open(o,{allowCommands:!0,fromUserGesture:!0})})},returnFocus:()=>e.focus(),styles:this.computeStyles(),hoverDelegate:this._register(this.instantiationService.createInstance(ON))},n=this._register(this.instantiationService.createInstance(ZN,{...i,...t}));return n.layout(e.activeContainerDimension,e.activeContainerOffset.quickPickTop),this._register(e.onDidLayoutActiveContainer(o=>{ke(e.activeContainer)===ke(n.container)&&n.layout(o,e.activeContainerOffset.quickPickTop)})),this._register(e.onDidChangeActiveContainer(()=>{n.isVisible()||n.layout(e.activeContainerDimension,e.activeContainerOffset.quickPickTop)})),this._register(n.onShow(()=>{this.resetContextKeys(),this._onShow.fire()})),this._register(n.onHide(()=>{this.resetContextKeys(),this._onHide.fire()})),n}setContextKey(e){let t;e&&(t=this.contexts.get(e),t||(t=new le(e,!1).bindTo(this.contextKeyService),this.contexts.set(e,t))),!(t&&t.get())&&(this.resetContextKeys(),t?.set(!0))}resetContextKeys(){this.contexts.forEach(e=>{e.get()&&e.reset()})}pick(e,t,i=Ue.None){return this.controller.pick(e,t,i)}createQuickPick(e={useSeparators:!1}){return this.controller.createQuickPick(e)}createInputBox(){return this.controller.createInputBox()}updateStyles(){this.hasController&&this.controller.applyStyles(this.computeStyles())}computeStyles(){return{widget:{quickInputBackground:he(cB),quickInputForeground:he(eae),quickInputTitleBackground:he(tae),widgetBorder:he(lz),widgetShadow:he(ym)},inputBox:x0,toggle:L0,countBadge:rU,button:Pde,progressBar:Ode,keybindingLabel:Ade,list:vg({listBackground:cB,listFocusBackground:av,listFocusForeground:rv,listInactiveFocusForeground:rv,listInactiveSelectionIconForeground:E2,listInactiveFocusBackground:av,listFocusOutline:Xt,listInactiveFocusOutline:Xt}),pickerGroup:{pickerGroupBorder:he(iae),pickerGroupForeground:he(bz)}}}};KN=Kfe([o_(0,ye),o_(1,Ee),o_(2,Ki),o_(3,vh),o_(4,Ke)],KN);var y$=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},cu=function(s,e){return function(t,i){e(t,i,s)}};let qN=class extends KN{constructor(e,t,i,n,o,r){super(t,i,n,new xE(e.getContainerDomNode(),o),r),this.host=void 0;const a=xv.get(e);if(a){const l=a.widget;this.host={_serviceBrand:void 0,get mainContainer(){return l.getDomNode()},getContainer(){return l.getDomNode()},whenContainerStylesLoaded(){},get containers(){return[l.getDomNode()]},get activeContainer(){return l.getDomNode()},get mainContainerDimension(){return e.getLayoutInfo()},get activeContainerDimension(){return e.getLayoutInfo()},get onDidLayoutMainContainer(){return e.onDidLayoutChange},get onDidLayoutActiveContainer(){return e.onDidLayoutChange},get onDidLayoutContainer(){return se.map(e.onDidLayoutChange,c=>({container:l.getDomNode(),dimension:c}))},get onDidChangeActiveContainer(){return se.None},get onDidAddContainer(){return se.None},get mainContainerOffset(){return{top:0,quickPickTop:0}},get activeContainerOffset(){return{top:0,quickPickTop:0}},focus:()=>e.focus()}}else this.host=void 0}createController(){return super.createController(this.host)}};qN=y$([cu(1,ye),cu(2,Ee),cu(3,Ki),cu(4,ft),cu(5,Ke)],qN);let GN=class{get activeService(){const e=this.codeEditorService.getFocusedCodeEditor();if(!e)throw new Error("Quick input service needs a focused editor to work.");let t=this.mapEditorToService.get(e);if(!t){const i=t=this.instantiationService.createInstance(qN,e);this.mapEditorToService.set(e,t),eh(e.onDidDispose)(()=>{i.dispose(),this.mapEditorToService.delete(e)})}return t}get currentQuickInput(){return this.activeService.currentQuickInput}get quickAccess(){return this.activeService.quickAccess}constructor(e,t){this.instantiationService=e,this.codeEditorService=t,this.mapEditorToService=new Map}pick(e,t,i=Ue.None){return this.activeService.pick(e,t,i)}createQuickPick(e={useSeparators:!1}){return this.activeService.createQuickPick(e)}createInputBox(){return this.activeService.createInputBox()}};GN=y$([cu(0,ye),cu(1,ft)],GN);class xv{static{this.ID="editor.controller.quickInput"}static get(e){return e.getContribution(xv.ID)}constructor(e){this.editor=e,this.widget=new PO(this.editor)}dispose(){this.widget.dispose()}}class PO{static{this.ID="editor.contrib.quickInputWidget"}constructor(e){this.codeEditor=e,this.domNode=document.createElement("div"),this.codeEditor.addOverlayWidget(this)}getId(){return PO.ID}getDomNode(){return this.domNode}getPosition(){return{preference:2}}dispose(){this.codeEditor.removeOverlayWidget(this)}}ct(xv.ID,xv,4);class qfe{constructor(e,t,i,n,o){this._parsedThemeRuleBrand=void 0,this.token=e,this.index=t,this.fontStyle=i,this.foreground=n,this.background=o}}function Gfe(s){if(!s||!Array.isArray(s))return[];const e=[];let t=0;for(let i=0,n=s.length;i<n;i++){const o=s[i];let r=-1;if(typeof o.fontStyle=="string"){r=0;const c=o.fontStyle.split(" ");for(let d=0,h=c.length;d<h;d++)switch(c[d]){case"italic":r=r|1;break;case"bold":r=r|2;break;case"underline":r=r|4;break;case"strikethrough":r=r|8;break}}let a=null;typeof o.foreground=="string"&&(a=o.foreground);let l=null;typeof o.background=="string"&&(l=o.background),e[t++]=new qfe(o.token||"",i,r,a,l)}return e}function Yfe(s,e){s.sort((d,h)=>{const u=tpe(d.token,h.token);return u!==0?u:d.index-h.index});let t=0,i="000000",n="ffffff";for(;s.length>=1&&s[0].token==="";){const d=s.shift();d.fontStyle!==-1&&(t=d.fontStyle),d.foreground!==null&&(i=d.foreground),d.background!==null&&(n=d.background)}const o=new Qfe;for(const d of e)o.getId(d);const r=o.getId(i),a=o.getId(n),l=new OO(t,r,a),c=new FO(l);for(let d=0,h=s.length;d<h;d++){const u=s[d];c.insert(u.token,u.fontStyle,o.getId(u.foreground),o.getId(u.background))}return new w$(o,c)}const Xfe=/^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;class Qfe{constructor(){this._lastColorId=0,this._id2color=[],this._color2id=new Map}getId(e){if(e===null)return 0;const t=e.match(Xfe);if(!t)throw new Error("Illegal value for token color: "+e);e=t[1].toUpperCase();let i=this._color2id.get(e);return i||(i=++this._lastColorId,this._color2id.set(e,i),this._id2color[i]=G.fromHex("#"+e),i)}getColorMap(){return this._id2color.slice(0)}}class w${static createFromRawTokenTheme(e,t){return this.createFromParsedTokenTheme(Gfe(e),t)}static createFromParsedTokenTheme(e,t){return Yfe(e,t)}constructor(e,t){this._colorMap=e,this._root=t,this._cache=new Map}getColorMap(){return this._colorMap.getColorMap()}_match(e){return this._root.match(e)}match(e,t){let i=this._cache.get(t);if(typeof i>"u"){const n=this._match(t),o=epe(t);i=(n.metadata|o<<8)>>>0,this._cache.set(t,i)}return(i|e<<0)>>>0}}const Jfe=/\b(comment|string|regex|regexp)\b/;function epe(s){const e=s.match(Jfe);if(!e)return 0;switch(e[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"regexp":return 3}throw new Error("Unexpected match for standard token type!")}function tpe(s,e){return s<e?-1:s>e?1:0}class OO{constructor(e,t,i){this._themeTrieElementRuleBrand=void 0,this._fontStyle=e,this._foreground=t,this._background=i,this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}clone(){return new OO(this._fontStyle,this._foreground,this._background)}acceptOverwrite(e,t,i){e!==-1&&(this._fontStyle=e),t!==0&&(this._foreground=t),i!==0&&(this._background=i),this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}}class FO{constructor(e){this._themeTrieElementBrand=void 0,this._mainRule=e,this._children=new Map}match(e){if(e==="")return this._mainRule;const t=e.indexOf(".");let i,n;t===-1?(i=e,n=""):(i=e.substring(0,t),n=e.substring(t+1));const o=this._children.get(i);return typeof o<"u"?o.match(n):this._mainRule}insert(e,t,i,n){if(e===""){this._mainRule.acceptOverwrite(t,i,n);return}const o=e.indexOf(".");let r,a;o===-1?(r=e,a=""):(r=e.substring(0,o),a=e.substring(o+1));let l=this._children.get(r);typeof l>"u"&&(l=new FO(this._mainRule.clone()),this._children.set(r,l)),l.insert(a,t,i,n)}}function ipe(s){const e=[];for(let t=1,i=s.length;t<i;t++){const n=s[t];e[t]=`.mtk${t} { color: ${n}; }`}return e.push(".mtki { font-style: italic; }"),e.push(".mtkb { font-weight: bold; }"),e.push(".mtku { text-decoration: underline; text-underline-position: under; }"),e.push(".mtks { text-decoration: line-through; }"),e.push(".mtks.mtku { text-decoration: underline line-through; text-underline-position: under; }"),e.join(`
`)}const npe={base:"vs",inherit:!1,rules:[{token:"",foreground:"000000",background:"fffffe"},{token:"invalid",foreground:"cd3131"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"001188"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"delimiter.xml",foreground:"0000FF"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"FF0000"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"FF0000"},{token:"attribute.value",foreground:"0451A5"},{token:"attribute.value.number",foreground:"098658"},{token:"attribute.value.unit",foreground:"098658"},{token:"attribute.value.html",foreground:"0000FF"},{token:"attribute.value.xml",foreground:"0000FF"},{token:"string",foreground:"A31515"},{token:"string.html",foreground:"0000FF"},{token:"string.sql",foreground:"FF0000"},{token:"string.yaml",foreground:"0451A5"},{token:"keyword",foreground:"0000FF"},{token:"keyword.json",foreground:"0451A5"},{token:"keyword.flow",foreground:"AF00DB"},{token:"keyword.flow.scss",foreground:"0000FF"},{token:"operator.scss",foreground:"666666"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[ea]:"#FFFFFE",[Hl]:"#000000",[rz]:"#E5EBF1",[BC]:"#D3D3D3",[WC]:"#939393",[L2]:"#ADD6FF4D"}},spe={base:"vs-dark",inherit:!1,rules:[{token:"",foreground:"D4D4D4",background:"1E1E1E"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"74B0DF"},{token:"variable.predefined",foreground:"4864AA"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"B5CEA8"},{token:"number.hex",foreground:"5BB498"},{token:"regexp",foreground:"B46695"},{token:"annotation",foreground:"cc6666"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"DCDCDC"},{token:"delimiter.html",foreground:"808080"},{token:"delimiter.xml",foreground:"808080"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"A79873"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"DD6A6F"},{token:"metatag.content.html",foreground:"9CDCFE"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"attribute.value.number.css",foreground:"B5CEA8"},{token:"attribute.value.unit.css",foreground:"B5CEA8"},{token:"attribute.value.hex.css",foreground:"D4D4D4"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"keyword.json",foreground:"CE9178"},{token:"keyword.flow.scss",foreground:"569CD6"},{token:"operator.scss",foreground:"909090"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[ea]:"#1E1E1E",[Hl]:"#D4D4D4",[rz]:"#3A3D41",[BC]:"#404040",[WC]:"#707070",[L2]:"#ADD6FF26"}},ope={base:"hc-black",inherit:!1,rules:[{token:"",foreground:"FFFFFF",background:"000000"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"1AEBFF"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"FFFFFF"},{token:"regexp",foreground:"C0C0C0"},{token:"annotation",foreground:"569CD6"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"FFFF00"},{token:"delimiter.html",foreground:"FFFF00"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta",foreground:"D4D4D4"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"569CD6"},{token:"metatag.content.html",foreground:"1AEBFF"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key",foreground:"9CDCFE"},{token:"string.value",foreground:"CE9178"},{token:"attribute.name",foreground:"569CD6"},{token:"attribute.value",foreground:"3FF23F"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[ea]:"#000000",[Hl]:"#FFFFFF",[BC]:"#FFFFFF",[WC]:"#FFFFFF"}},rpe={base:"hc-light",inherit:!1,rules:[{token:"",foreground:"292929",background:"FFFFFF"},{token:"invalid",foreground:"B5200D"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"264F70"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"B5200D"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"264F78"},{token:"attribute.value",foreground:"0451A5"},{token:"string",foreground:"A31515"},{token:"string.sql",foreground:"B5200D"},{token:"keyword",foreground:"0000FF"},{token:"keyword.flow",foreground:"AF00DB"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[ea]:"#FFFFFF",[Hl]:"#292929",[BC]:"#292929",[WC]:"#292929"}},ape={IconContribution:"base.contributions.icons"};var FW;(function(s){function e(t,i){let n=t.defaults;for(;Ie.isThemeIcon(n);){const o=wg.getIcon(n.id);if(!o)return;n=o.defaults}return n}s.getDefinition=e})(FW||(FW={}));var BW;(function(s){function e(i){return{weight:i.weight,style:i.style,src:i.src.map(n=>({format:n.format,location:n.location.toString()}))}}s.toJSONObject=e;function t(i){const n=o=>zs(o)?o:void 0;if(i&&Array.isArray(i.src)&&i.src.every(o=>zs(o.format)&&zs(o.location)))return{weight:n(i.weight),style:n(i.style),src:i.src.map(o=>({format:o.format,location:Se.parse(o.location)}))}}s.fromJSONObject=t})(BW||(BW={}));class lpe{constructor(){this._onDidChange=new O,this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:p("iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:p("iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${Ie.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(e,t,i,n){const o=this.iconsById[e];if(o){if(i&&!o.description){o.description=i,this.iconSchema.properties[e].markdownDescription=`${i} $(${e})`;const l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=i),this._onDidChange.fire()}return o}const r={id:e,description:i,defaults:t,deprecationMessage:n};this.iconsById[e]=r;const a={$ref:"#/definitions/icons"};return n&&(a.deprecationMessage=n),i&&(a.markdownDescription=`${i}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(i||""),this._onDidChange.fire(),{id:e}}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}toString(){const e=(o,r)=>o.id.localeCompare(r.id),t=o=>{for(;Ie.isThemeIcon(o.defaults);)o=this.iconsById[o.defaults.id];return`codicon codicon-${o?o.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const n=Object.keys(this.iconsById).map(o=>this.iconsById[o]);for(const o of n.filter(r=>!!r.description).sort(e))i.push(`|<i class="${t(o)}"></i>|${o.id}|${Ie.isThemeIcon(o.defaults)?o.defaults.id:o.id}|${o.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(const o of n.filter(r=>!Ie.isThemeIcon(r.defaults)).sort(e))i.push(`|<i class="${t(o)}"></i>|${o.id}|`);return i.join(`
`)}}const wg=new lpe;ci.add(ape.IconContribution,wg);function Kt(s,e,t,i){return wg.registerIcon(s,e,t,i)}function S$(){return wg}function cpe(){const s=C6();for(const e in s){const t="\\"+s[e].toString(16);wg.registerIcon(e,{fontCharacter:t})}}cpe();const L$="vscode://schemas/icons",x$=ci.as(FL.JSONContribution);x$.registerSchema(L$,wg.getIconSchema());const WW=new It(()=>x$.notifySchemaChanged(L$),200);wg.onDidChange(()=>{WW.isScheduled()||WW.schedule()});const k$=Kt("widget-close",J.close,p("widgetClose","Icon for the close action in widgets."));Kt("goto-previous-location",J.arrowUp,p("previousChangeIcon","Icon for goto previous editor location."));Kt("goto-next-location",J.arrowDown,p("nextChangeIcon","Icon for goto next editor location."));Ie.modify(J.sync,"spin");Ie.modify(J.loading,"spin");function dpe(s){const e=new Z,t=e.add(new O),i=S$();return e.add(i.onDidChange(()=>t.fire())),s&&e.add(s.onDidProductIconThemeChange(()=>t.fire())),{dispose:()=>e.dispose(),onDidChange:t.event,getCSS(){const n=s?s.getProductIconTheme():new D$,o={},r=[],a=[];for(const l of i.getIcons()){const c=n.getIcon(l);if(!c)continue;const d=c.font,h=`--vscode-icon-${l.id}-font-family`,u=`--vscode-icon-${l.id}-content`;d?(o[d.id]=d.definition,a.push(`${h}: ${qk(d.id)};`,`${u}: '${c.fontCharacter}';`),r.push(`.codicon-${l.id}:before { content: '${c.fontCharacter}'; font-family: ${qk(d.id)}; }`)):(a.push(`${u}: '${c.fontCharacter}'; ${h}: 'codicon';`),r.push(`.codicon-${l.id}:before { content: '${c.fontCharacter}'; }`))}for(const l in o){const c=o[l],d=c.weight?`font-weight: ${c.weight};`:"",h=c.style?`font-style: ${c.style};`:"",u=c.src.map(g=>`${Hc(g.location)} format('${g.format}')`).join(", ");r.push(`@font-face { src: ${u}; font-family: ${qk(l)};${d}${h} font-display: block; }`)}return r.push(`:root { ${a.join(" ")} }`),r.join(`
`)}}}class D${getIcon(e){const t=S$();let i=e.defaults;for(;Ie.isThemeIcon(i);){const n=t.getIcon(i.id);if(!n)return;i=n.defaults}return i}}const _c="vs",op="vs-dark",Ru="hc-black",Mu="hc-light",I$=ci.as(ez.ColorContribution),hpe=ci.as(BV.ThemingContribution);class T${constructor(e,t){this.semanticHighlighting=!1,this.themeData=t;const i=t.base;e.length>0?(Qw(e)?this.id=e:this.id=i+" "+e,this.themeName=e):(this.id=i,this.themeName=i),this.colors=null,this.defaultColors=Object.create(null),this._tokenTheme=null}get base(){return this.themeData.base}notifyBaseUpdated(){this.themeData.inherit&&(this.colors=null,this._tokenTheme=null)}getColors(){if(!this.colors){const e=new Map;for(const t in this.themeData.colors)e.set(t,G.fromHex(this.themeData.colors[t]));if(this.themeData.inherit){const t=YN(this.themeData.base);for(const i in t.colors)e.has(i)||e.set(i,G.fromHex(t.colors[i]))}this.colors=e}return this.colors}getColor(e,t){const i=this.getColors().get(e);if(i)return i;if(t!==!1)return this.getDefault(e)}getDefault(e){let t=this.defaultColors[e];return t||(t=I$.resolveDefaultColor(e,this),this.defaultColors[e]=t,t)}defines(e){return this.getColors().has(e)}get type(){switch(this.base){case _c:return gr.LIGHT;case Ru:return gr.HIGH_CONTRAST_DARK;case Mu:return gr.HIGH_CONTRAST_LIGHT;default:return gr.DARK}}get tokenTheme(){if(!this._tokenTheme){let e=[],t=[];if(this.themeData.inherit){const o=YN(this.themeData.base);e=o.rules,o.encodedTokensColors&&(t=o.encodedTokensColors)}const i=this.themeData.colors["editor.foreground"],n=this.themeData.colors["editor.background"];if(i||n){const o={token:""};i&&(o.foreground=i),n&&(o.background=n),e.push(o)}e=e.concat(this.themeData.rules),this.themeData.encodedTokensColors&&(t=this.themeData.encodedTokensColors),this._tokenTheme=w$.createFromRawTokenTheme(e,t)}return this._tokenTheme}getTokenStyleMetadata(e,t,i){const o=this.tokenTheme._match([e].concat(t).join(".")).metadata,r=Bs.getForeground(o),a=Bs.getFontStyle(o);return{foreground:r,italic:!!(a&1),bold:!!(a&2),underline:!!(a&4),strikethrough:!!(a&8)}}}function Qw(s){return s===_c||s===op||s===Ru||s===Mu}function YN(s){switch(s){case _c:return npe;case op:return spe;case Ru:return ope;case Mu:return rpe}}function Zy(s){const e=YN(s);return new T$(s,e)}class upe extends B{constructor(){super(),this._onColorThemeChange=this._register(new O),this.onDidColorThemeChange=this._onColorThemeChange.event,this._onProductIconThemeChange=this._register(new O),this.onDidProductIconThemeChange=this._onProductIconThemeChange.event,this._environment=Object.create(null),this._builtInProductIconTheme=new D$,this._autoDetectHighContrast=!0,this._knownThemes=new Map,this._knownThemes.set(_c,Zy(_c)),this._knownThemes.set(op,Zy(op)),this._knownThemes.set(Ru,Zy(Ru)),this._knownThemes.set(Mu,Zy(Mu));const e=this._register(dpe(this));this._codiconCSS=e.getCSS(),this._themeCSS="",this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._globalStyleElement=null,this._styleElements=[],this._colorMapOverride=null,this.setTheme(_c),this._onOSSchemeChanged(),this._register(e.onDidChange(()=>{this._codiconCSS=e.getCSS(),this._updateCSS()})),M6(Nt,"(forced-colors: active)",()=>{this._onOSSchemeChanged()})}registerEditorContainer(e){return z1(e)?this._registerShadowDomContainer(e):this._registerRegularEditorContainer()}_registerRegularEditorContainer(){return this._globalStyleElement||(this._globalStyleElement=$o(void 0,e=>{e.className="monaco-colors",e.textContent=this._allCSS}),this._styleElements.push(this._globalStyleElement)),B.None}_registerShadowDomContainer(e){const t=$o(e,i=>{i.className="monaco-colors",i.textContent=this._allCSS});return this._styleElements.push(t),{dispose:()=>{for(let i=0;i<this._styleElements.length;i++)if(this._styleElements[i]===t){this._styleElements.splice(i,1);return}}}}defineTheme(e,t){if(!/^[a-z0-9\-]+$/i.test(e))throw new Error("Illegal theme name!");if(!Qw(t.base)&&!Qw(e))throw new Error("Illegal theme base!");this._knownThemes.set(e,new T$(e,t)),Qw(e)&&this._knownThemes.forEach(i=>{i.base===e&&i.notifyBaseUpdated()}),this._theme.themeName===e&&this.setTheme(e)}getColorTheme(){return this._theme}setColorMapOverride(e){this._colorMapOverride=e,this._updateThemeOrColorMap()}setTheme(e){let t;this._knownThemes.has(e)?t=this._knownThemes.get(e):t=this._knownThemes.get(_c),this._updateActualTheme(t)}_updateActualTheme(e){!e||this._theme===e||(this._theme=e,this._updateThemeOrColorMap())}_onOSSchemeChanged(){if(this._autoDetectHighContrast){const e=Nt.matchMedia("(forced-colors: active)").matches;if(e!==Ra(this._theme.type)){let t;Dp(this._theme.type)?t=e?Ru:op:t=e?Mu:_c,this._updateActualTheme(this._knownThemes.get(t))}}}setAutoDetectHighContrast(e){this._autoDetectHighContrast=e,this._onOSSchemeChanged()}_updateThemeOrColorMap(){const e=[],t={},i={addRule:r=>{t[r]||(e.push(r),t[r]=!0)}};hpe.getThemingParticipants().forEach(r=>r(this._theme,i,this._environment));const n=[];for(const r of I$.getColors()){const a=this._theme.getColor(r.id,!0);a&&n.push(`${y2(r.id)}: ${a.toString()};`)}i.addRule(`.monaco-editor, .monaco-diff-editor, .monaco-component { ${n.join(`
`)} }`);const o=this._colorMapOverride||this._theme.tokenTheme.getColorMap();i.addRule(ipe(o)),this._themeCSS=e.join(`
`),this._updateCSS(),mi.setColorMap(o),this._onColorThemeChange.fire(this._theme)}_updateCSS(){this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._styleElements.forEach(e=>e.textContent=this._allCSS)}getFileIconTheme(){return{hasFileIcons:!1,hasFolderIcons:!1,hidesExplorerArrows:!1}}getProductIconTheme(){return this._builtInProductIconTheme}}const Qo=Je("themeService");var gpe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},UD=function(s,e){return function(t,i){e(t,i,s)}};let XN=class extends B{constructor(e,t,i){super(),this._contextKeyService=e,this._layoutService=t,this._configurationService=i,this._accessibilitySupport=0,this._onDidChangeScreenReaderOptimized=new O,this._onDidChangeReducedMotion=new O,this._onDidChangeLinkUnderline=new O,this._accessibilityModeEnabledContext=TC.bindTo(this._contextKeyService);const n=()=>this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());this._register(this._configurationService.onDidChangeConfiguration(r=>{r.affectsConfiguration("editor.accessibilitySupport")&&(n(),this._onDidChangeScreenReaderOptimized.fire()),r.affectsConfiguration("workbench.reduceMotion")&&(this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._onDidChangeReducedMotion.fire())})),n(),this._register(this.onDidChangeScreenReaderOptimized(()=>n()));const o=Nt.matchMedia("(prefers-reduced-motion: reduce)");this._systemMotionReduced=o.matches,this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._linkUnderlinesEnabled=this._configurationService.getValue("accessibility.underlineLinks"),this.initReducedMotionListeners(o),this.initLinkUnderlineListeners()}initReducedMotionListeners(e){this._register(U(e,"change",()=>{this._systemMotionReduced=e.matches,this._configMotionReduced==="auto"&&this._onDidChangeReducedMotion.fire()}));const t=()=>{const i=this.isMotionReduced();this._layoutService.mainContainer.classList.toggle("reduce-motion",i),this._layoutService.mainContainer.classList.toggle("enable-motion",!i)};t(),this._register(this.onDidChangeReducedMotion(()=>t()))}initLinkUnderlineListeners(){this._register(this._configurationService.onDidChangeConfiguration(t=>{if(t.affectsConfiguration("accessibility.underlineLinks")){const i=this._configurationService.getValue("accessibility.underlineLinks");this._linkUnderlinesEnabled=i,this._onDidChangeLinkUnderline.fire()}}));const e=()=>{const t=this._linkUnderlinesEnabled;this._layoutService.mainContainer.classList.toggle("underline-links",t)};e(),this._register(this.onDidChangeLinkUnderlines(()=>e()))}onDidChangeLinkUnderlines(e){return this._onDidChangeLinkUnderline.event(e)}get onDidChangeScreenReaderOptimized(){return this._onDidChangeScreenReaderOptimized.event}isScreenReaderOptimized(){const e=this._configurationService.getValue("editor.accessibilitySupport");return e==="on"||e==="auto"&&this._accessibilitySupport===2}get onDidChangeReducedMotion(){return this._onDidChangeReducedMotion.event}isMotionReduced(){const e=this._configMotionReduced;return e==="on"||e==="auto"&&this._systemMotionReduced}getAccessibilitySupport(){return this._accessibilitySupport}};XN=gpe([UD(0,Ee),UD(1,vh),UD(2,Ke)],XN);var wx=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},kl=function(s,e){return function(t,i){e(t,i,s)}},df,E_;let QN=class{constructor(e,t,i){this._commandService=e,this._keybindingService=t,this._hiddenStates=new JN(i)}createMenu(e,t,i){return new G0(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...i},this._commandService,this._keybindingService,t)}getMenuActions(e,t,i){const n=new G0(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...i},this._commandService,this._keybindingService,t),o=n.getActions(i);return n.dispose(),o}resetHiddenStates(e){this._hiddenStates.reset(e)}};QN=wx([kl(0,Ht),kl(1,yt),kl(2,oa)],QN);let JN=class{static{df=this}static{this._key="menu.hiddenCommands"}constructor(e){this._storageService=e,this._disposables=new Z,this._onDidChange=new O,this.onDidChange=this._onDidChange.event,this._ignoreChangeEvent=!1,this._hiddenByDefaultCache=new Map;try{const t=e.get(df._key,0,"{}");this._data=JSON.parse(t)}catch{this._data=Object.create(null)}this._disposables.add(e.onDidChangeValue(0,df._key,this._disposables)(()=>{if(!this._ignoreChangeEvent)try{const t=e.get(df._key,0,"{}");this._data=JSON.parse(t)}catch(t){console.log("FAILED to read storage after UPDATE",t)}this._onDidChange.fire()}))}dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(e,t){return this._hiddenByDefaultCache.get(`${e.id}/${t}`)??!1}setDefaultState(e,t,i){this._hiddenByDefaultCache.set(`${e.id}/${t}`,i)}isHidden(e,t){const i=this._isHiddenByDefault(e,t),n=this._data[e.id]?.includes(t)??!1;return i?!n:n}updateHidden(e,t,i){this._isHiddenByDefault(e,t)&&(i=!i);const o=this._data[e.id];if(i)o?o.indexOf(t)<0&&o.push(t):this._data[e.id]=[t];else if(o){const r=o.indexOf(t);r>=0&&oQ(o,r),o.length===0&&delete this._data[e.id]}this._persist()}reset(e){if(e===void 0)this._data=Object.create(null),this._persist();else{for(const{id:t}of e)this._data[t]&&delete this._data[t];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;const e=JSON.stringify(this._data);this._storageService.store(df._key,e,0,0)}finally{this._ignoreChangeEvent=!1}}};JN=df=wx([kl(0,oa)],JN);class lb{constructor(e,t){this._id=e,this._collectContextKeysForSubmenus=t,this._menuGroups=[],this._allMenuIds=new Set,this._structureContextKeys=new Set,this._preconditionContextKeys=new Set,this._toggledContextKeys=new Set,this.refresh()}get allMenuIds(){return this._allMenuIds}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._allMenuIds.clear(),this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();const e=this._sort(hn.getMenuItems(this._id));let t;for(const i of e){const n=i.group||"";(!t||t[0]!==n)&&(t=[n,[]],this._menuGroups.push(t)),t[1].push(i),this._collectContextKeysAndSubmenuIds(i)}this._allMenuIds.add(this._id)}_sort(e){return e}_collectContextKeysAndSubmenuIds(e){if(lb._fillInKbExprKeys(e.when,this._structureContextKeys),Kf(e)){if(e.command.precondition&&lb._fillInKbExprKeys(e.command.precondition,this._preconditionContextKeys),e.command.toggled){const t=e.command.toggled.condition||e.command.toggled;lb._fillInKbExprKeys(t,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&(hn.getMenuItems(e.submenu).forEach(this._collectContextKeysAndSubmenuIds,this),this._allMenuIds.add(e.submenu))}static _fillInKbExprKeys(e,t){if(e)for(const i of e.keys())t.add(i)}}let eR=E_=class extends lb{constructor(e,t,i,n,o,r){super(e,i),this._hiddenStates=t,this._commandService=n,this._keybindingService=o,this._contextKeyService=r,this.refresh()}createActionGroups(e){const t=[];for(const i of this._menuGroups){const[n,o]=i;let r;for(const a of o)if(this._contextKeyService.contextMatchesRules(a.when)){const l=Kf(a);l&&this._hiddenStates.setDefaultState(this._id,a.command.id,!!a.isHiddenByDefault);const c=fpe(this._id,l?a.command:a,this._hiddenStates);if(l){const d=E$(this._commandService,this._keybindingService,a.command.id,a.when);(r??=[]).push(new uo(a.command,a.alt,e,c,d,this._contextKeyService,this._commandService))}else{const d=new E_(a.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._keybindingService,this._contextKeyService).createActionGroups(e),h=ji.join(...d.map(u=>u[1]));h.length>0&&(r??=[]).push(new qf(a,c,h))}}r&&r.length>0&&t.push([n,r])}return t}_sort(e){return e.sort(E_._compareMenuItems)}static _compareMenuItems(e,t){const i=e.group,n=t.group;if(i!==n){if(i){if(!n)return-1}else return 1;if(i==="navigation")return-1;if(n==="navigation")return 1;const a=i.localeCompare(n);if(a!==0)return a}const o=e.order||0,r=t.order||0;return o<r?-1:o>r?1:E_._compareTitles(Kf(e)?e.command.title:e.title,Kf(t)?t.command.title:t.title)}static _compareTitles(e,t){const i=typeof e=="string"?e:e.original,n=typeof t=="string"?t:t.original;return i.localeCompare(n)}};eR=E_=wx([kl(3,Ht),kl(4,yt),kl(5,Ee)],eR);let G0=class{constructor(e,t,i,n,o,r){this._disposables=new Z,this._menuInfo=new eR(e,t,i.emitEventsForSubmenuChanges,n,o,r);const a=new It(()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})},i.eventDebounceDelay);this._disposables.add(a),this._disposables.add(hn.onDidChangeMenu(h=>{for(const u of this._menuInfo.allMenuIds)if(h.has(u)){a.schedule();break}}));const l=this._disposables.add(new Z),c=h=>{let u=!1,g=!1,f=!1;for(const m of h)if(u=u||m.isStructuralChange,g=g||m.isEnablementChange,f=f||m.isToggleChange,u&&g&&f)break;return{menu:this,isStructuralChange:u,isEnablementChange:g,isToggleChange:f}},d=()=>{l.add(r.onDidChangeContext(h=>{const u=h.affectsSome(this._menuInfo.structureContextKeys),g=h.affectsSome(this._menuInfo.preconditionContextKeys),f=h.affectsSome(this._menuInfo.toggledContextKeys);(u||g||f)&&this._onDidChange.fire({menu:this,isStructuralChange:u,isEnablementChange:g,isToggleChange:f})})),l.add(t.onDidChange(h=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})}))};this._onDidChange=new d6({onWillAddFirstListener:d,onDidRemoveLastListener:l.clear.bind(l),delay:i.eventDebounceDelay,merge:c}),this.onDidChange=this._onDidChange.event}getActions(e){return this._menuInfo.createActionGroups(e)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};G0=wx([kl(3,Ht),kl(4,yt),kl(5,Ee)],G0);function fpe(s,e,t){const i=vie(e)?e.submenu.id:e.id,n=typeof e.title=="string"?e.title:e.title.value,o=Du({id:`hide/${s.id}/${i}`,label:p("hide.label","Hide '{0}'",n),run(){t.updateHidden(s,i,!0)}}),r=Du({id:`toggle/${s.id}/${i}`,label:n,get checked(){return!t.isHidden(s,i)},run(){t.updateHidden(s,i,!!this.checked)}});return{hide:o,toggle:r,get isHidden(){return!r.checked}}}function E$(s,e,t,i=void 0,n=!0){return Du({id:`configureKeybinding/${t}`,label:p("configure keybinding","Configure Keybinding"),enabled:n,run(){const r=!!!e.lookupKeybinding(t)&&i?i.serialize():void 0;s.executeCommand("workbench.action.openGlobalKeybindings",`@command:${t}`+(r?` +when:${r}`:""))}})}var ppe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},HW=function(s,e){return function(t,i){e(t,i,s)}},tR;const VW="application/vnd.code.resources";let iR=class extends B{static{tR=this}constructor(e,t){super(),this.layoutService=e,this.logService=t,this.mapTextToType=new Map,this.findText="",this.resources=[],this.resourcesStateHash=void 0,(Fc||A6)&&this.installWebKitWriteTextWorkaround(),this._register(se.runAndSubscribe(wL,({window:i,disposables:n})=>{n.add(U(i.document,"copy",()=>this.clearResourcesState()))},{window:Nt,disposables:this._store}))}installWebKitWriteTextWorkaround(){const e=()=>{const t=new pm;this.webKitPendingClipboardWritePromise&&!this.webKitPendingClipboardWritePromise.isSettled&&this.webKitPendingClipboardWritePromise.cancel(),this.webKitPendingClipboardWritePromise=t,C_().navigator.clipboard.write([new ClipboardItem({"text/plain":t.p})]).catch(async i=>{(!(i instanceof Error)||i.name!=="NotAllowedError"||!t.isRejected)&&this.logService.error(i)})};this._register(se.runAndSubscribe(this.layoutService.onDidAddContainer,({container:t,disposables:i})=>{i.add(U(t,"click",e)),i.add(U(t,"keydown",e))},{container:this.layoutService.mainContainer,disposables:this._store}))}async writeText(e,t){if(this.clearResourcesState(),t){this.mapTextToType.set(t,e);return}if(this.webKitPendingClipboardWritePromise)return this.webKitPendingClipboardWritePromise.complete(e);try{return await C_().navigator.clipboard.writeText(e)}catch(i){console.error(i)}this.fallbackWriteText(e)}fallbackWriteText(e){const t=mm(),i=t.activeElement,n=t.body.appendChild(te("textarea",{"aria-hidden":!0}));n.style.height="1px",n.style.width="1px",n.style.position="absolute",n.value=e,n.focus(),n.select(),t.execCommand("copy"),tn(i)&&i.focus(),n.remove()}async readText(e){if(e)return this.mapTextToType.get(e)||"";try{return await C_().navigator.clipboard.readText()}catch(t){console.error(t)}return""}async readFindText(){return this.findText}async writeFindText(e){this.findText=e}static{this.MAX_RESOURCE_STATE_SOURCE_LENGTH=1e3}async readResources(){try{const t=await C_().navigator.clipboard.read();for(const i of t)if(i.types.includes(`web ${VW}`)){const n=await i.getType(`web ${VW}`);return JSON.parse(await n.text()).map(r=>Se.from(r))}}catch{}const e=await this.computeResourcesStateHash();return this.resourcesStateHash!==e&&this.clearResourcesState(),this.resources}async computeResourcesStateHash(){if(this.resources.length===0)return;const e=await this.readText();return CL(e.substring(0,tR.MAX_RESOURCE_STATE_SOURCE_LENGTH))}clearInternalState(){this.clearResourcesState()}clearResourcesState(){this.resources=[],this.resourcesStateHash=void 0}};iR=tR=ppe([HW(0,vh),HW(1,Pn)],iR);const Jc=Je("clipboardService");var mpe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},_pe=function(s,e){return function(t,i){e(t,i,s)}};const cb="data-keybinding-context";let BO=class{constructor(e,t){this._id=e,this._parent=t,this._value=Object.create(null),this._value._contextId=e}get value(){return{...this._value}}setValue(e,t){return this._value[e]!==t?(this._value[e]=t,!0):!1}removeValue(e){return e in this._value?(delete this._value[e],!0):!1}getValue(e){const t=this._value[e];return typeof t>"u"&&this._parent?this._parent.getValue(e):t}};class Vp extends BO{static{this.INSTANCE=new Vp}constructor(){super(-1,null)}setValue(e,t){return!1}removeValue(e){return!1}getValue(e){}}class Y0 extends BO{static{this._keyPrefix="config."}constructor(e,t,i){super(e,null),this._configurationService=t,this._values=Qf.forConfigKeys(),this._listener=this._configurationService.onDidChangeConfiguration(n=>{if(n.source===7){const o=Array.from(this._values,([r])=>r);this._values.clear(),i.fire(new UW(o))}else{const o=[];for(const r of n.affectedKeys){const a=`config.${r}`,l=this._values.findSuperstr(a);l!==void 0&&(o.push(...st.map(l,([c])=>c)),this._values.deleteSuperstr(a)),this._values.has(a)&&(o.push(a),this._values.delete(a))}i.fire(new UW(o))}})}dispose(){this._listener.dispose()}getValue(e){if(e.indexOf(Y0._keyPrefix)!==0)return super.getValue(e);if(this._values.has(e))return this._values.get(e);const t=e.substr(Y0._keyPrefix.length),i=this._configurationService.getValue(t);let n;switch(typeof i){case"number":case"boolean":case"string":n=i;break;default:Array.isArray(i)?n=JSON.stringify(i):n=i}return this._values.set(e,n),n}setValue(e,t){return super.setValue(e,t)}removeValue(e){return super.removeValue(e)}}class bpe{constructor(e,t,i){this._service=e,this._key=t,this._defaultValue=i,this.reset()}set(e){this._service.setContext(this._key,e)}reset(){typeof this._defaultValue>"u"?this._service.removeContext(this._key):this._service.setContext(this._key,this._defaultValue)}get(){return this._service.getContextKeyValue(this._key)}}class zW{constructor(e){this.key=e}affectsSome(e){return e.has(this.key)}allKeysContainedIn(e){return this.affectsSome(e)}}class UW{constructor(e){this.keys=e}affectsSome(e){for(const t of this.keys)if(e.has(t))return!0;return!1}allKeysContainedIn(e){return this.keys.every(t=>e.has(t))}}class vpe{constructor(e){this.events=e}affectsSome(e){for(const t of this.events)if(t.affectsSome(e))return!0;return!1}allKeysContainedIn(e){return this.events.every(t=>t.allKeysContainedIn(e))}}function Cpe(s,e){return s.allKeysContainedIn(new Set(Object.keys(e)))}class N$ extends B{constructor(e){super(),this._onDidChangeContext=this._register(new Vu({merge:t=>new vpe(t)})),this.onDidChangeContext=this._onDidChangeContext.event,this._isDisposed=!1,this._myContextId=e}createKey(e,t){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new bpe(this,e,t)}bufferChangeEvents(e){this._onDidChangeContext.pause();try{e()}finally{this._onDidChangeContext.resume()}}createScoped(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new ype(this,e)}contextMatchesRules(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");const t=this.getContextValuesContainer(this._myContextId);return e?e.evaluate(t):!0}getContextKeyValue(e){if(!this._isDisposed)return this.getContextValuesContainer(this._myContextId).getValue(e)}setContext(e,t){if(this._isDisposed)return;const i=this.getContextValuesContainer(this._myContextId);i&&i.setValue(e,t)&&this._onDidChangeContext.fire(new zW(e))}removeContext(e){this._isDisposed||this.getContextValuesContainer(this._myContextId).removeValue(e)&&this._onDidChangeContext.fire(new zW(e))}getContext(e){return this._isDisposed?Vp.INSTANCE:this.getContextValuesContainer(wpe(e))}dispose(){super.dispose(),this._isDisposed=!0}}let nR=class extends N${constructor(e){super(0),this._contexts=new Map,this._lastContextId=0;const t=this._register(new Y0(this._myContextId,e,this._onDidChangeContext));this._contexts.set(this._myContextId,t)}getContextValuesContainer(e){return this._isDisposed?Vp.INSTANCE:this._contexts.get(e)||Vp.INSTANCE}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ContextKeyService has been disposed");const t=++this._lastContextId;return this._contexts.set(t,new BO(t,this.getContextValuesContainer(e))),t}disposeContext(e){this._isDisposed||this._contexts.delete(e)}};nR=mpe([_pe(0,Ke)],nR);class ype extends N${constructor(e,t){if(super(e.createChildContext()),this._parentChangeListener=this._register(new nn),this._parent=e,this._updateParentChangeListener(),this._domNode=t,this._domNode.hasAttribute(cb)){let i="";this._domNode.classList&&(i=Array.from(this._domNode.classList.values()).join(", ")),console.error(`Element already has context attribute${i?": "+i:""}`)}this._domNode.setAttribute(cb,String(this._myContextId))}_updateParentChangeListener(){this._parentChangeListener.value=this._parent.onDidChangeContext(e=>{const i=this._parent.getContextValuesContainer(this._myContextId).value;Cpe(e,i)||this._onDidChangeContext.fire(e)})}dispose(){this._isDisposed||(this._parent.disposeContext(this._myContextId),this._domNode.removeAttribute(cb),super.dispose())}getContextValuesContainer(e){return this._isDisposed?Vp.INSTANCE:this._parent.getContextValuesContainer(e)}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ScopedContextKeyService has been disposed");return this._parent.createChildContext(e)}disposeContext(e){this._isDisposed||this._parent.disposeContext(e)}}function wpe(s){for(;s;){if(s.hasAttribute(cb)){const e=s.getAttribute(cb);return e?parseInt(e,10):NaN}s=s.parentElement}return 0}function Spe(s,e,t){s.get(Ee).createKey(String(e),Lpe(t))}function Lpe(s){return YH(s,e=>{if(typeof e=="object"&&e.$mid===1)return Se.revive(e).toString();if(e instanceof Se)return e.toString()})}ot.registerCommand("_setContext",Spe);ot.registerCommand({id:"getContextKeyInfo",handler(){return[...le.all()].sort((s,e)=>s.key.localeCompare(e.key))},metadata:{description:p("getContextKeyInfo","A command that returns information about context keys"),args:[]}});ot.registerCommand("_generateContextKeyInfo",function(){const s=[],e=new Set;for(const t of le.all())e.has(t.key)||(e.add(t.key),s.push(t));s.sort((t,i)=>t.key.localeCompare(i.key)),console.log(JSON.stringify(s,void 0,2))});let xpe=class{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}};class $W{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(const t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),n=this.lookupOrInsertNode(t);i.outgoing.set(n.key,n),n.incoming.set(i.key,i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(const i of this._nodes.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let i=this._nodes.get(t);return i||(i=new xpe(t,e),this._nodes.set(t,i)),i}isEmpty(){return this._nodes.size===0}toString(){const e=[];for(const[t,i]of this._nodes)e.push(`${t}
	(-> incoming)[${[...i.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...i.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this._nodes){const i=new Set([e]),n=this._findCycle(t,i);if(n)return n}}_findCycle(e,t){for(const[i,n]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const o=this._findCycle(n,t);if(o)return o;t.delete(i)}}}class Nm{constructor(...e){this._entries=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}get(e){return this._entries.get(e)}}const kpe=!1;class jW extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}}class X0{constructor(e=new Nm,t=!1,i,n=kpe){this._services=e,this._strict=t,this._parent=i,this._enableTracing=n,this._isDisposed=!1,this._servicesToMaybeDispose=new Set,this._children=new Set,this._activeInstantiations=new Set,this._services.set(ye,this),this._globalGraph=n?i?._globalGraph??new $W(o=>o):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,At(this._children),this._children.clear();for(const e of this._servicesToMaybeDispose)mL(e)&&e.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(e,t){this._throwIfDisposed();const i=this,n=new class extends X0{dispose(){i._children.delete(n),super.dispose()}}(e,this._strict,this,this._enableTracing);return this._children.add(n),t?.add(n),n}invokeFunction(e,...t){this._throwIfDisposed();const i=sr.traceInvocation(this._enableTracing,e);let n=!1;try{return e({get:r=>{if(n)throw NP("service accessor is only valid during the invocation of its target method");const a=this._getOrCreateServiceInstance(r,i);if(!a)throw new Error(`[invokeFunction] unknown service '${r}'`);return a}},...t)}finally{n=!0,i.stop()}}createInstance(e,...t){this._throwIfDisposed();let i,n;return e instanceof fl?(i=sr.traceCreation(this._enableTracing,e.ctor),n=this._createInstance(e.ctor,e.staticArguments.concat(t),i)):(i=sr.traceCreation(this._enableTracing,e),n=this._createInstance(e,t,i)),i.stop(),n}_createInstance(e,t=[],i){const n=xa.getServiceDependencies(e).sort((a,l)=>a.index-l.index),o=[];for(const a of n){const l=this._getOrCreateServiceInstance(a.id,i);l||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${a.id}.`,!1),o.push(l)}const r=n.length>0?n[0].index:t.length;if(t.length!==r){console.trace(`[createInstance] First service dependency of ${e.name} at position ${r+1} conflicts with ${t.length} static arguments`);const a=r-t.length;a>0?t=t.concat(new Array(a)):t=t.slice(0,r)}return Reflect.construct(e,t.concat(o))}_setCreatedServiceInstance(e,t){if(this._services.get(e)instanceof fl)this._services.set(e,t);else if(this._parent)this._parent._setCreatedServiceInstance(e,t);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){const t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));const i=this._getServiceInstanceOrDescriptor(e);return i instanceof fl?this._safeCreateAndCacheServiceInstance(e,i,t.branch(e,!0)):(t.branch(e,!1),i)}_safeCreateAndCacheServiceInstance(e,t,i){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,i)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,i){const n=new $W(l=>l.id.toString());let o=0;const r=[{id:e,desc:t,_trace:i}],a=new Set;for(;r.length;){const l=r.pop();if(!a.has(String(l.id))){if(a.add(String(l.id)),n.lookupOrInsertNode(l),o++>1e3)throw new jW(n);for(const c of xa.getServiceDependencies(l.desc.ctor)){const d=this._getServiceInstanceOrDescriptor(c.id);if(d||this._throwIfStrict(`[createInstance] ${e} depends on ${c.id} which is NOT registered.`,!0),this._globalGraph?.insertEdge(String(l.id),String(c.id)),d instanceof fl){const h={id:c.id,desc:d,_trace:l._trace.branch(c.id,!0)};n.insertEdge(l,h),r.push(h)}}}}for(;;){const l=n.roots();if(l.length===0){if(!n.isEmpty())throw new jW(n);break}for(const{data:c}of l){if(this._getServiceInstanceOrDescriptor(c.id)instanceof fl){const h=this._createServiceInstanceWithOwner(c.id,c.desc.ctor,c.desc.staticArguments,c.desc.supportsDelayedInstantiation,c._trace);this._setCreatedServiceInstance(c.id,h)}n.removeNode(c)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,i=[],n,o){if(this._services.get(e)instanceof fl)return this._createServiceInstance(e,t,i,n,o,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,i,n,o);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t,i=[],n,o,r){if(n){const a=new X0(void 0,this._strict,this,this._enableTracing);a._globalGraphImplicitDependency=String(e);const l=new Map,c=new jee(()=>{const d=a._createInstance(t,i,o);for(const[h,u]of l){const g=d[h];if(typeof g=="function")for(const f of u)f.disposable=g.apply(d,f.listener)}return l.clear(),r.add(d),d});return new Proxy(Object.create(null),{get(d,h){if(!c.isInitialized&&typeof h=="string"&&(h.startsWith("onDid")||h.startsWith("onWill"))){let f=l.get(h);return f||(f=new fs,l.set(h,f)),(_,b,v)=>{if(c.isInitialized)return c.value[h](_,b,v);{const C={listener:[_,b,v],disposable:void 0},y=f.push(C);return Ce(()=>{y(),C.disposable?.dispose()})}}}if(h in d)return d[h];const u=c.value;let g=u[h];return typeof g!="function"||(g=g.bind(u),d[h]=g),g},set(d,h,u){return c.value[h]=u,!0},getPrototypeOf(d){return t.prototype}})}else{const a=this._createInstance(t,i,o);return r.add(a),a}}_throwIfStrict(e,t){if(t&&console.warn(e),this._strict)throw new Error(e)}}class sr{static{this.all=new Set}static{this._None=new class extends sr{constructor(){super(0,null)}stop(){}branch(){return this}}}static traceInvocation(e,t){return e?new sr(2,t.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):sr._None}static traceCreation(e,t){return e?new sr(1,t.name):sr._None}static{this._totals=0}constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}branch(e,t){const i=new sr(3,e.toString());return this._dep.push([e,t,i]),i}stop(){const e=Date.now()-this._start;sr._totals+=e;let t=!1;function i(o,r){const a=[],l=new Array(o+1).join("	");for(const[c,d,h]of r._dep)if(d&&h){t=!0,a.push(`${l}CREATES -> ${c}`);const u=i(o+1,h);u&&a.push(u)}else a.push(`${l}uses -> ${c}`);return a.join(`
`)}const n=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${i(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${sr._totals.toFixed(2)}ms)`];(e>2||t)&&sr.all.add(n.join(`
`))}}const Dpe=new Set([Fe.inMemory,Fe.vscodeSourceControl,Fe.walkThrough,Fe.walkThroughSnippet,Fe.vscodeChatCodeBlock]);class Ipe{constructor(){this._byResource=new Ui,this._byOwner=new Map}set(e,t,i){let n=this._byResource.get(e);n||(n=new Map,this._byResource.set(e,n)),n.set(t,i);let o=this._byOwner.get(t);o||(o=new Ui,this._byOwner.set(t,o)),o.set(e,i)}get(e,t){return this._byResource.get(e)?.get(t)}delete(e,t){let i=!1,n=!1;const o=this._byResource.get(e);o&&(i=o.delete(t));const r=this._byOwner.get(t);if(r&&(n=r.delete(e)),i!==n)throw new Error("illegal state");return i&&n}values(e){return typeof e=="string"?this._byOwner.get(e)?.values()??st.empty():Se.isUri(e)?this._byResource.get(e)?.values()??st.empty():st.map(st.concat(...this._byOwner.values()),t=>t[1])}}class Tpe{constructor(e){this.errors=0,this.infos=0,this.warnings=0,this.unknowns=0,this._data=new Ui,this._service=e,this._subscription=e.onMarkerChanged(this._update,this)}dispose(){this._subscription.dispose()}_update(e){for(const t of e){const i=this._data.get(t);i&&this._substract(i);const n=this._resourceStats(t);this._add(n),this._data.set(t,n)}}_resourceStats(e){const t={errors:0,warnings:0,infos:0,unknowns:0};if(Dpe.has(e.scheme))return t;for(const{severity:i}of this._service.read({resource:e}))i===bi.Error?t.errors+=1:i===bi.Warning?t.warnings+=1:i===bi.Info?t.infos+=1:t.unknowns+=1;return t}_substract(e){this.errors-=e.errors,this.warnings-=e.warnings,this.infos-=e.infos,this.unknowns-=e.unknowns}_add(e){this.errors+=e.errors,this.warnings+=e.warnings,this.infos+=e.infos,this.unknowns+=e.unknowns}}class md{constructor(){this._onMarkerChanged=new d6({delay:0,merge:md._merge}),this.onMarkerChanged=this._onMarkerChanged.event,this._data=new Ipe,this._stats=new Tpe(this)}dispose(){this._stats.dispose(),this._onMarkerChanged.dispose()}remove(e,t){for(const i of t||[])this.changeOne(e,i,[])}changeOne(e,t,i){if(jH(i))this._data.delete(t,e)&&this._onMarkerChanged.fire([t]);else{const n=[];for(const o of i){const r=md._toMarker(e,t,o);r&&n.push(r)}this._data.set(t,e,n),this._onMarkerChanged.fire([t])}}static _toMarker(e,t,i){let{code:n,severity:o,message:r,source:a,startLineNumber:l,startColumn:c,endLineNumber:d,endColumn:h,relatedInformation:u,tags:g}=i;if(r)return l=l>0?l:1,c=c>0?c:1,d=d>=l?d:l,h=h>0?h:c,{resource:t,owner:e,code:n,severity:o,message:r,source:a,startLineNumber:l,startColumn:c,endLineNumber:d,endColumn:h,relatedInformation:u,tags:g}}changeAll(e,t){const i=[],n=this._data.values(e);if(n)for(const o of n){const r=st.first(o);r&&(i.push(r.resource),this._data.delete(r.resource,e))}if(os(t)){const o=new Ui;for(const{resource:r,marker:a}of t){const l=md._toMarker(e,r,a);if(!l)continue;const c=o.get(r);c?c.push(l):(o.set(r,[l]),i.push(r))}for(const[r,a]of o)this._data.set(r,e,a)}i.length>0&&this._onMarkerChanged.fire(i)}read(e=Object.create(null)){let{owner:t,resource:i,severities:n,take:o}=e;if((!o||o<0)&&(o=-1),t&&i){const r=this._data.get(i,t);if(r){const a=[];for(const l of r)if(md._accept(l,n)){const c=a.push(l);if(o>0&&c===o)break}return a}else return[]}else if(!t&&!i){const r=[];for(const a of this._data.values())for(const l of a)if(md._accept(l,n)){const c=r.push(l);if(o>0&&c===o)return r}return r}else{const r=this._data.values(i??t),a=[];for(const l of r)for(const c of l)if(md._accept(c,n)){const d=a.push(c);if(o>0&&d===o)return a}return a}}static _accept(e,t){return t===void 0||(t&e.severity)===e.severity}static _merge(e){const t=new Ui;for(const i of e)for(const n of i)t.set(n,!0);return Array.from(t.keys())}}class Epe extends B{get configurationModel(){return this._configurationModel}constructor(e){super(),this.logService=e,this._configurationModel=vn.createEmptyModel(this.logService)}reload(){return this.resetConfigurationModel(),this.configurationModel}getConfigurationDefaultOverrides(){return{}}resetConfigurationModel(){this._configurationModel=vn.createEmptyModel(this.logService);const e=ci.as(na.Configuration).getConfigurationProperties();this.updateConfigurationModel(Object.keys(e),e)}updateConfigurationModel(e,t){const i=this.getConfigurationDefaultOverrides();for(const n of e){const o=i[n],r=t[n];o!==void 0?this._configurationModel.setValue(n,o):r?this._configurationModel.setValue(n,r.default):this._configurationModel.removeValue(n)}}}const Lh=Je("accessibilitySignalService");class et{static register(e){return new et(e.fileName)}static{this.error=et.register({fileName:"error.mp3"})}static{this.warning=et.register({fileName:"warning.mp3"})}static{this.success=et.register({fileName:"success.mp3"})}static{this.foldedArea=et.register({fileName:"foldedAreas.mp3"})}static{this.break=et.register({fileName:"break.mp3"})}static{this.quickFixes=et.register({fileName:"quickFixes.mp3"})}static{this.taskCompleted=et.register({fileName:"taskCompleted.mp3"})}static{this.taskFailed=et.register({fileName:"taskFailed.mp3"})}static{this.terminalBell=et.register({fileName:"terminalBell.mp3"})}static{this.diffLineInserted=et.register({fileName:"diffLineInserted.mp3"})}static{this.diffLineDeleted=et.register({fileName:"diffLineDeleted.mp3"})}static{this.diffLineModified=et.register({fileName:"diffLineModified.mp3"})}static{this.chatRequestSent=et.register({fileName:"chatRequestSent.mp3"})}static{this.chatResponseReceived1=et.register({fileName:"chatResponseReceived1.mp3"})}static{this.chatResponseReceived2=et.register({fileName:"chatResponseReceived2.mp3"})}static{this.chatResponseReceived3=et.register({fileName:"chatResponseReceived3.mp3"})}static{this.chatResponseReceived4=et.register({fileName:"chatResponseReceived4.mp3"})}static{this.clear=et.register({fileName:"clear.mp3"})}static{this.save=et.register({fileName:"save.mp3"})}static{this.format=et.register({fileName:"format.mp3"})}static{this.voiceRecordingStarted=et.register({fileName:"voiceRecordingStarted.mp3"})}static{this.voiceRecordingStopped=et.register({fileName:"voiceRecordingStopped.mp3"})}static{this.progress=et.register({fileName:"progress.mp3"})}constructor(e){this.fileName=e}}class Npe{constructor(e){this.randomOneOf=e}}class Lt{constructor(e,t,i,n,o,r){this.sound=e,this.name=t,this.legacySoundSettingsKey=i,this.settingsKey=n,this.legacyAnnouncementSettingsKey=o,this.announcementMessage=r}static{this._signals=new Set}static register(e){const t=new Npe("randomOneOf"in e.sound?e.sound.randomOneOf:[e.sound]),i=new Lt(t,e.name,e.legacySoundSettingsKey,e.settingsKey,e.legacyAnnouncementSettingsKey,e.announcementMessage);return Lt._signals.add(i),i}static{this.errorAtPosition=Lt.register({name:p("accessibilitySignals.positionHasError.name","Error at Position"),sound:et.error,announcementMessage:p("accessibility.signals.positionHasError","Error"),settingsKey:"accessibility.signals.positionHasError",delaySettingsKey:"accessibility.signalOptions.delays.errorAtPosition"})}static{this.warningAtPosition=Lt.register({name:p("accessibilitySignals.positionHasWarning.name","Warning at Position"),sound:et.warning,announcementMessage:p("accessibility.signals.positionHasWarning","Warning"),settingsKey:"accessibility.signals.positionHasWarning",delaySettingsKey:"accessibility.signalOptions.delays.warningAtPosition"})}static{this.errorOnLine=Lt.register({name:p("accessibilitySignals.lineHasError.name","Error on Line"),sound:et.error,legacySoundSettingsKey:"audioCues.lineHasError",legacyAnnouncementSettingsKey:"accessibility.alert.error",announcementMessage:p("accessibility.signals.lineHasError","Error on Line"),settingsKey:"accessibility.signals.lineHasError"})}static{this.warningOnLine=Lt.register({name:p("accessibilitySignals.lineHasWarning.name","Warning on Line"),sound:et.warning,legacySoundSettingsKey:"audioCues.lineHasWarning",legacyAnnouncementSettingsKey:"accessibility.alert.warning",announcementMessage:p("accessibility.signals.lineHasWarning","Warning on Line"),settingsKey:"accessibility.signals.lineHasWarning"})}static{this.foldedArea=Lt.register({name:p("accessibilitySignals.lineHasFoldedArea.name","Folded Area on Line"),sound:et.foldedArea,legacySoundSettingsKey:"audioCues.lineHasFoldedArea",legacyAnnouncementSettingsKey:"accessibility.alert.foldedArea",announcementMessage:p("accessibility.signals.lineHasFoldedArea","Folded"),settingsKey:"accessibility.signals.lineHasFoldedArea"})}static{this.break=Lt.register({name:p("accessibilitySignals.lineHasBreakpoint.name","Breakpoint on Line"),sound:et.break,legacySoundSettingsKey:"audioCues.lineHasBreakpoint",legacyAnnouncementSettingsKey:"accessibility.alert.breakpoint",announcementMessage:p("accessibility.signals.lineHasBreakpoint","Breakpoint"),settingsKey:"accessibility.signals.lineHasBreakpoint"})}static{this.inlineSuggestion=Lt.register({name:p("accessibilitySignals.lineHasInlineSuggestion.name","Inline Suggestion on Line"),sound:et.quickFixes,legacySoundSettingsKey:"audioCues.lineHasInlineSuggestion",settingsKey:"accessibility.signals.lineHasInlineSuggestion"})}static{this.terminalQuickFix=Lt.register({name:p("accessibilitySignals.terminalQuickFix.name","Terminal Quick Fix"),sound:et.quickFixes,legacySoundSettingsKey:"audioCues.terminalQuickFix",legacyAnnouncementSettingsKey:"accessibility.alert.terminalQuickFix",announcementMessage:p("accessibility.signals.terminalQuickFix","Quick Fix"),settingsKey:"accessibility.signals.terminalQuickFix"})}static{this.onDebugBreak=Lt.register({name:p("accessibilitySignals.onDebugBreak.name","Debugger Stopped on Breakpoint"),sound:et.break,legacySoundSettingsKey:"audioCues.onDebugBreak",legacyAnnouncementSettingsKey:"accessibility.alert.onDebugBreak",announcementMessage:p("accessibility.signals.onDebugBreak","Breakpoint"),settingsKey:"accessibility.signals.onDebugBreak"})}static{this.noInlayHints=Lt.register({name:p("accessibilitySignals.noInlayHints","No Inlay Hints on Line"),sound:et.error,legacySoundSettingsKey:"audioCues.noInlayHints",legacyAnnouncementSettingsKey:"accessibility.alert.noInlayHints",announcementMessage:p("accessibility.signals.noInlayHints","No Inlay Hints"),settingsKey:"accessibility.signals.noInlayHints"})}static{this.taskCompleted=Lt.register({name:p("accessibilitySignals.taskCompleted","Task Completed"),sound:et.taskCompleted,legacySoundSettingsKey:"audioCues.taskCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.taskCompleted",announcementMessage:p("accessibility.signals.taskCompleted","Task Completed"),settingsKey:"accessibility.signals.taskCompleted"})}static{this.taskFailed=Lt.register({name:p("accessibilitySignals.taskFailed","Task Failed"),sound:et.taskFailed,legacySoundSettingsKey:"audioCues.taskFailed",legacyAnnouncementSettingsKey:"accessibility.alert.taskFailed",announcementMessage:p("accessibility.signals.taskFailed","Task Failed"),settingsKey:"accessibility.signals.taskFailed"})}static{this.terminalCommandFailed=Lt.register({name:p("accessibilitySignals.terminalCommandFailed","Terminal Command Failed"),sound:et.error,legacySoundSettingsKey:"audioCues.terminalCommandFailed",legacyAnnouncementSettingsKey:"accessibility.alert.terminalCommandFailed",announcementMessage:p("accessibility.signals.terminalCommandFailed","Command Failed"),settingsKey:"accessibility.signals.terminalCommandFailed"})}static{this.terminalCommandSucceeded=Lt.register({name:p("accessibilitySignals.terminalCommandSucceeded","Terminal Command Succeeded"),sound:et.success,announcementMessage:p("accessibility.signals.terminalCommandSucceeded","Command Succeeded"),settingsKey:"accessibility.signals.terminalCommandSucceeded"})}static{this.terminalBell=Lt.register({name:p("accessibilitySignals.terminalBell","Terminal Bell"),sound:et.terminalBell,legacySoundSettingsKey:"audioCues.terminalBell",legacyAnnouncementSettingsKey:"accessibility.alert.terminalBell",announcementMessage:p("accessibility.signals.terminalBell","Terminal Bell"),settingsKey:"accessibility.signals.terminalBell"})}static{this.notebookCellCompleted=Lt.register({name:p("accessibilitySignals.notebookCellCompleted","Notebook Cell Completed"),sound:et.taskCompleted,legacySoundSettingsKey:"audioCues.notebookCellCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellCompleted",announcementMessage:p("accessibility.signals.notebookCellCompleted","Notebook Cell Completed"),settingsKey:"accessibility.signals.notebookCellCompleted"})}static{this.notebookCellFailed=Lt.register({name:p("accessibilitySignals.notebookCellFailed","Notebook Cell Failed"),sound:et.taskFailed,legacySoundSettingsKey:"audioCues.notebookCellFailed",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellFailed",announcementMessage:p("accessibility.signals.notebookCellFailed","Notebook Cell Failed"),settingsKey:"accessibility.signals.notebookCellFailed"})}static{this.diffLineInserted=Lt.register({name:p("accessibilitySignals.diffLineInserted","Diff Line Inserted"),sound:et.diffLineInserted,legacySoundSettingsKey:"audioCues.diffLineInserted",settingsKey:"accessibility.signals.diffLineInserted"})}static{this.diffLineDeleted=Lt.register({name:p("accessibilitySignals.diffLineDeleted","Diff Line Deleted"),sound:et.diffLineDeleted,legacySoundSettingsKey:"audioCues.diffLineDeleted",settingsKey:"accessibility.signals.diffLineDeleted"})}static{this.diffLineModified=Lt.register({name:p("accessibilitySignals.diffLineModified","Diff Line Modified"),sound:et.diffLineModified,legacySoundSettingsKey:"audioCues.diffLineModified",settingsKey:"accessibility.signals.diffLineModified"})}static{this.chatRequestSent=Lt.register({name:p("accessibilitySignals.chatRequestSent","Chat Request Sent"),sound:et.chatRequestSent,legacySoundSettingsKey:"audioCues.chatRequestSent",legacyAnnouncementSettingsKey:"accessibility.alert.chatRequestSent",announcementMessage:p("accessibility.signals.chatRequestSent","Chat Request Sent"),settingsKey:"accessibility.signals.chatRequestSent"})}static{this.chatResponseReceived=Lt.register({name:p("accessibilitySignals.chatResponseReceived","Chat Response Received"),legacySoundSettingsKey:"audioCues.chatResponseReceived",sound:{randomOneOf:[et.chatResponseReceived1,et.chatResponseReceived2,et.chatResponseReceived3,et.chatResponseReceived4]},settingsKey:"accessibility.signals.chatResponseReceived"})}static{this.progress=Lt.register({name:p("accessibilitySignals.progress","Progress"),sound:et.progress,legacySoundSettingsKey:"audioCues.chatResponsePending",legacyAnnouncementSettingsKey:"accessibility.alert.progress",announcementMessage:p("accessibility.signals.progress","Progress"),settingsKey:"accessibility.signals.progress"})}static{this.clear=Lt.register({name:p("accessibilitySignals.clear","Clear"),sound:et.clear,legacySoundSettingsKey:"audioCues.clear",legacyAnnouncementSettingsKey:"accessibility.alert.clear",announcementMessage:p("accessibility.signals.clear","Clear"),settingsKey:"accessibility.signals.clear"})}static{this.save=Lt.register({name:p("accessibilitySignals.save","Save"),sound:et.save,legacySoundSettingsKey:"audioCues.save",legacyAnnouncementSettingsKey:"accessibility.alert.save",announcementMessage:p("accessibility.signals.save","Save"),settingsKey:"accessibility.signals.save"})}static{this.format=Lt.register({name:p("accessibilitySignals.format","Format"),sound:et.format,legacySoundSettingsKey:"audioCues.format",legacyAnnouncementSettingsKey:"accessibility.alert.format",announcementMessage:p("accessibility.signals.format","Format"),settingsKey:"accessibility.signals.format"})}static{this.voiceRecordingStarted=Lt.register({name:p("accessibilitySignals.voiceRecordingStarted","Voice Recording Started"),sound:et.voiceRecordingStarted,legacySoundSettingsKey:"audioCues.voiceRecordingStarted",settingsKey:"accessibility.signals.voiceRecordingStarted"})}static{this.voiceRecordingStopped=Lt.register({name:p("accessibilitySignals.voiceRecordingStopped","Voice Recording Stopped"),sound:et.voiceRecordingStopped,legacySoundSettingsKey:"audioCues.voiceRecordingStopped",settingsKey:"accessibility.signals.voiceRecordingStopped"})}}class Rpe extends B{constructor(e,t=[]){super(),this.logger=new yie([e,...t]),this._register(e.onDidChangeLogLevel(i=>this.setLevel(i)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}error(e,...t){this.logger.error(e,...t)}}const R$=[];function Rm(s){R$.push(s)}function Mpe(){return R$.slice(0)}class Ape{getParseResult(e){}}var Ul=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Oi=function(s,e){return function(t,i){e(t,i,s)}};class Ppe{constructor(e){this.disposed=!1,this.model=e,this._onWillDispose=new O}get textEditorModel(){return this.model}dispose(){this.disposed=!0,this._onWillDispose.fire()}}let sR=class{constructor(e){this.modelService=e}createModelReference(e){const t=this.modelService.getModel(e);return t?Promise.resolve(new kJ(new Ppe(t))):Promise.reject(new Error("Model not found"))}};sR=Ul([Oi(0,Zt)],sR);class WO{static{this.NULL_PROGRESS_RUNNER={done:()=>{},total:()=>{},worked:()=>{}}}show(){return WO.NULL_PROGRESS_RUNNER}async showWhile(e,t){await e}}class Ope{withProgress(e,t,i){return t({report:()=>{}})}}class Fpe{constructor(){this.isExtensionDevelopment=!1,this.isBuilt=!1}}class Bpe{async confirm(e){return{confirmed:this.doConfirm(e.message,e.detail),checkboxChecked:!1}}doConfirm(e,t){let i=e;return t&&(i=i+`

`+t),Nt.confirm(i)}async prompt(e){let t;if(this.doConfirm(e.message,e.detail)){const n=[...e.buttons??[]];e.cancelButton&&typeof e.cancelButton!="string"&&typeof e.cancelButton!="boolean"&&n.push(e.cancelButton),t=await n[0]?.run({checkboxChecked:!1})}return{result:t}}async error(e,t){await this.prompt({type:Di.Error,message:e,detail:t})}}class Q0{static{this.NO_OP=new zse}info(e){return this.notify({severity:Di.Info,message:e})}warn(e){return this.notify({severity:Di.Warning,message:e})}error(e){return this.notify({severity:Di.Error,message:e})}notify(e){switch(e.severity){case Di.Error:console.error(e.message);break;case Di.Warning:console.warn(e.message);break;default:console.log(e.message);break}return Q0.NO_OP}prompt(e,t,i,n){return Q0.NO_OP}status(e,t){return B.None}}let oR=class{constructor(e){this._onWillExecuteCommand=new O,this._onDidExecuteCommand=new O,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._instantiationService=e}executeCommand(e,...t){const i=ot.getCommand(e);if(!i)return Promise.reject(new Error(`command '${e}' not found`));try{this._onWillExecuteCommand.fire({commandId:e,args:t});const n=this._instantiationService.invokeFunction.apply(this._instantiationService,[i.handler,...t]);return this._onDidExecuteCommand.fire({commandId:e,args:t}),Promise.resolve(n)}catch(n){return Promise.reject(n)}}};oR=Ul([Oi(0,ye)],oR);let zp=class extends oce{constructor(e,t,i,n,o,r){super(e,t,i,n,o),this._cachedResolver=null,this._dynamicKeybindings=[],this._domNodeListeners=[];const a=g=>{const f=new Z;f.add(U(g,ee.KEY_DOWN,m=>{const _=new Ft(m);this._dispatch(_,_.target)&&(_.preventDefault(),_.stopPropagation())})),f.add(U(g,ee.KEY_UP,m=>{const _=new Ft(m);this._singleModifierDispatch(_,_.target)&&_.preventDefault()})),this._domNodeListeners.push(new Wpe(g,f))},l=g=>{for(let f=0;f<this._domNodeListeners.length;f++){const m=this._domNodeListeners[f];m.domNode===g&&(this._domNodeListeners.splice(f,1),m.dispose())}},c=g=>{g.getOption(61)||a(g.getContainerDomNode())},d=g=>{g.getOption(61)||l(g.getContainerDomNode())};this._register(r.onCodeEditorAdd(c)),this._register(r.onCodeEditorRemove(d)),r.listCodeEditors().forEach(c);const h=g=>{a(g.getContainerDomNode())},u=g=>{l(g.getContainerDomNode())};this._register(r.onDiffEditorAdd(h)),this._register(r.onDiffEditorRemove(u)),r.listDiffEditors().forEach(h)}addDynamicKeybinding(e,t,i,n){return Gr(ot.registerCommand(e,i),this.addDynamicKeybindings([{keybinding:t,command:e,when:n}]))}addDynamicKeybindings(e){const t=e.map(i=>({keybinding:eE(i.keybinding,lo),command:i.command??null,commandArgs:i.commandArgs,when:i.when,weight1:1e3,weight2:0,extensionId:null,isBuiltinExtension:!1}));return this._dynamicKeybindings=this._dynamicKeybindings.concat(t),this.updateResolver(),Ce(()=>{for(let i=0;i<this._dynamicKeybindings.length;i++)if(this._dynamicKeybindings[i]===t[0]){this._dynamicKeybindings.splice(i,t.length),this.updateResolver();return}})}updateResolver(){this._cachedResolver=null,this._onDidUpdateKeybindings.fire()}_getResolver(){if(!this._cachedResolver){const e=this._toNormalizedKeybindingItems(Ss.getDefaultKeybindings(),!0),t=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1);this._cachedResolver=new J_(e,t,i=>this._log(i))}return this._cachedResolver}_documentHasFocus(){return Nt.document.hasFocus()}_toNormalizedKeybindingItems(e,t){const i=[];let n=0;for(const o of e){const r=o.when||void 0,a=o.keybinding;if(!a)i[n++]=new MB(void 0,o.command,o.commandArgs,r,t,null,!1);else{const l=hv.resolveKeybinding(a,lo);for(const c of l)i[n++]=new MB(c,o.command,o.commandArgs,r,t,null,!1)}}return i}resolveKeyboardEvent(e){const t=new Bc(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,e.keyCode);return new hv([t],lo)}};zp=Ul([Oi(0,Ee),Oi(1,Ht),Oi(2,jn),Oi(3,Ii),Oi(4,Pn),Oi(5,ft)],zp);class Wpe extends B{constructor(e,t){super(),this.domNode=e,this._register(t)}}function ZW(s){return s&&typeof s=="object"&&(!s.overrideIdentifier||typeof s.overrideIdentifier=="string")&&(!s.resource||s.resource instanceof Se)}let J0=class{constructor(e){this.logService=e,this._onDidChangeConfiguration=new O,this.onDidChangeConfiguration=this._onDidChangeConfiguration.event;const t=new Epe(e);this._configuration=new nx(t.reload(),vn.createEmptyModel(e),vn.createEmptyModel(e),vn.createEmptyModel(e),vn.createEmptyModel(e),vn.createEmptyModel(e),new Ui,vn.createEmptyModel(e),new Ui,e),t.dispose()}getValue(e,t){const i=typeof e=="string"?e:void 0,n=ZW(e)?e:ZW(t)?t:{};return this._configuration.getValue(i,n,void 0)}updateValues(e){const t={data:this._configuration.toData()},i=[];for(const n of e){const[o,r]=n;this.getValue(o)!==r&&(this._configuration.updateValue(o,r),i.push(o))}if(i.length>0){const n=new ece({keys:i,overrides:[]},t,this._configuration,void 0,this.logService);n.source=8,this._onDidChangeConfiguration.fire(n)}return Promise.resolve()}updateValue(e,t,i,n){return this.updateValues([[e,t]])}inspect(e,t={}){return this._configuration.inspect(e,t,void 0)}};J0=Ul([Oi(0,Pn)],J0);let rR=class{constructor(e,t,i){this.configurationService=e,this.modelService=t,this.languageService=i,this._onDidChangeConfiguration=new O,this.configurationService.onDidChangeConfiguration(n=>{this._onDidChangeConfiguration.fire({affectedKeys:n.affectedKeys,affectsConfiguration:(o,r)=>n.affectsConfiguration(r)})})}getValue(e,t,i){const n=P.isIPosition(t)?t:null,o=n?typeof i=="string"?i:void 0:typeof t=="string"?t:void 0,r=e?this.getLanguage(e,n):void 0;return typeof o>"u"?this.configurationService.getValue({resource:e,overrideIdentifier:r}):this.configurationService.getValue(o,{resource:e,overrideIdentifier:r})}getLanguage(e,t){const i=this.modelService.getModel(e);return i?t?i.getLanguageIdAtPosition(t.lineNumber,t.column):i.getLanguageId():this.languageService.guessLanguageIdByFilepathOrFirstLine(e)}};rR=Ul([Oi(0,Ke),Oi(1,Zt),Oi(2,ni)],rR);let aR=class{constructor(e){this.configurationService=e}getEOL(e,t){const i=this.configurationService.getValue("files.eol",{overrideIdentifier:t,resource:e});return i&&typeof i=="string"&&i!=="auto"?i:ys||Qe?`
`:`\r
`}};aR=Ul([Oi(0,Ke)],aR);class Hpe{publicLog2(){}}class eS{static{this.SCHEME="inmemory"}constructor(){const e=Se.from({scheme:eS.SCHEME,authority:"model",path:"/"});this.workspace={id:Vz,folders:[new vce({uri:e,name:"",index:0})]}}getWorkspace(){return this.workspace}getWorkspaceFolder(e){return e&&e.scheme===eS.SCHEME?this.workspace.folders[0]:null}}function tS(s,e,t){if(!e||!(s instanceof J0))return;const i=[];Object.keys(e).forEach(n=>{Gle(n)&&i.push([`editor.${n}`,e[n]]),t&&Yle(n)&&i.push([`diffEditor.${n}`,e[n]])}),i.length>0&&s.updateValues(i)}let lR=class{constructor(e){this._modelService=e}hasPreviewHandler(){return!1}async apply(e,t){const i=Array.isArray(e)?e:Z2.convert(e),n=new Map;for(const a of i){if(!(a instanceof qd))throw new Error("bad edit - only text edits are supported");const l=this._modelService.getModel(a.resource);if(!l)throw new Error("bad edit - model not found");if(typeof a.versionId=="number"&&l.getVersionId()!==a.versionId)throw new Error("bad state - model changed in the meantime");let c=n.get(l);c||(c=[],n.set(l,c)),c.push(ri.replaceMove(k.lift(a.textEdit.range),a.textEdit.text))}let o=0,r=0;for(const[a,l]of n)a.pushStackElement(),a.pushEditOperations([],l,()=>[]),a.pushStackElement(),r+=1,o+=l.length;return{ariaSummary:zu(rN.bulkEditServiceSummary,o,r),isApplied:o>0}}};lR=Ul([Oi(0,Zt)],lR);class Vpe{getUriLabel(e,t){return e.scheme==="file"?e.fsPath:e.path}getUriBasenameLabel(e){return wr(e)}}let cR=class extends $le{constructor(e,t){super(e),this._codeEditorService=t}showContextView(e,t,i){if(!t){const n=this._codeEditorService.getFocusedCodeEditor()||this._codeEditorService.getActiveCodeEditor();n&&(t=n.getContainerDomNode())}return super.showContextView(e,t,i)}};cR=Ul([Oi(0,vh),Oi(1,ft)],cR);class zpe{constructor(){this._neverEmitter=new O,this.onDidChangeTrust=this._neverEmitter.event}isWorkspaceTrusted(){return!0}}class Upe extends y0{constructor(){super()}}class $pe extends Rpe{constructor(){super(new Cie)}}let dR=class extends bN{constructor(e,t,i,n,o,r){super(e,t,i,n,o,r),this.configure({blockMouse:!1})}};dR=Ul([Oi(0,jn),Oi(1,Ii),Oi(2,Yc),Oi(3,yt),Oi(4,qo),Oi(5,Ee)],dR);const hR={amdModuleId:"vs/editor/common/services/editorSimpleWorker",esmModuleLocation:void 0,label:"editorWorkerService"};let uR=class extends yE{constructor(e,t,i,n,o){super(hR,e,t,i,n,o)}};uR=Ul([Oi(0,Zt),Oi(1,WL),Oi(2,Pn),Oi(3,di),Oi(4,pe)],uR);class jpe{async playSignal(e,t){}}nt(Pn,$pe,0);nt(Ke,J0,0);nt(WL,rR,0);nt(FV,aR,0);nt(Xu,eS,0);nt(Pp,Vpe,0);nt(jn,Hpe,0);nt(xC,Bpe,0);nt(b2,Fpe,0);nt(Ii,Q0,0);nt(zl,md,0);nt(ni,Upe,0);nt(Qo,upe,0);nt(Zt,RN,0);nt(iO,SN,0);nt(Ee,nR,0);nt(Hz,Ope,0);nt(yh,WO,0);nt(oa,Rde,0);nt(Xs,uR,0);nt(EC,lR,0);nt(zz,zpe,0);nt(qs,sR,0);nt(vo,XN,0);nt(Ir,xfe,0);nt(Ht,oR,0);nt(yt,zp,0);nt(Dr,GN,0);nt(Yc,cR,0);nt(Ys,wN,0);nt(Jc,iR,0);nt(bo,dR,0);nt(qo,QN,0);nt(Lh,jpe,0);nt(WU,Ape,0);var Me;(function(s){const e=new Nm;for(const[l,c]of o3())e.set(l,c);const t=new X0(e,!0);e.set(ye,t);function i(l){n||r({});const c=e.get(l);if(!c)throw new Error("Missing service "+l);return c instanceof fl?t.invokeFunction(d=>d.get(l)):c}s.get=i;let n=!1;const o=new O;function r(l){if(n)return t;n=!0;for(const[d,h]of o3())e.get(d)||e.set(d,h);for(const d in l)if(l.hasOwnProperty(d)){const h=Je(d);e.get(h)instanceof fl&&e.set(h,l[d])}const c=Mpe();for(const d of c)try{t.createInstance(d)}catch(h){Oe(h)}return o.fire(),t}s.initialize=r;function a(l){if(n)return l();const c=new Z,d=c.add(o.event(()=>{d.dispose(),c.add(l())}));return c}s.withServices=a})(Me||(Me={}));function Zpe(s,e){return new Kpe(s,e)}class Kpe extends e0{constructor(e,t){const i={amdModuleId:hR.amdModuleId,esmModuleLocation:hR.esmModuleLocation,label:t.label};super(i,t.keepIdleModels||!1,e),this._foreignModuleId=t.moduleId,this._foreignModuleCreateData=t.createData||null,this._foreignModuleHost=t.host||null,this._foreignProxy=null}fhr(e,t){if(!this._foreignModuleHost||typeof this._foreignModuleHost[e]!="function")return Promise.reject(new Error("Missing method "+e+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[e].apply(this._foreignModuleHost,t))}catch(i){return Promise.reject(i)}}_getForeignProxy(){return this._foreignProxy||(this._foreignProxy=this._getProxy().then(e=>{const t=this._foreignModuleHost?YI(this._foreignModuleHost):[];return e.$loadForeignModule(this._foreignModuleId,this._foreignModuleCreateData,t).then(i=>{this._foreignModuleCreateData=null;const n=(a,l)=>e.$fmr(a,l),o=(a,l)=>function(){const c=Array.prototype.slice.call(arguments,0);return l(a,c)},r={};for(const a of i)r[a]=o(a,n);return r})})),this._foreignProxy}getProxy(){return this._getForeignProxy()}withSyncedResources(e){return this.workerWithSyncedResources(e).then(t=>this.getProxy())}}const VC={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"};class ms{constructor(e,t,i,n){this.startColumn=e,this.endColumn=t,this.className=i,this.type=n,this._lineDecorationBrand=void 0}static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){const i=e.length,n=t.length;if(i!==n)return!1;for(let o=0;o<i;o++)if(!ms._equals(e[o],t[o]))return!1;return!0}static extractWrapped(e,t,i){if(e.length===0)return e;const n=t+1,o=i+1,r=i-t,a=[];let l=0;for(const c of e)c.endColumn<=n||c.startColumn>=o||(a[l++]=new ms(Math.max(1,c.startColumn-n+1),Math.min(r+1,c.endColumn-n+1),c.className,c.type));return a}static filter(e,t,i,n){if(e.length===0)return[];const o=[];let r=0;for(let a=0,l=e.length;a<l;a++){const c=e[a],d=c.range;if(d.endLineNumber<t||d.startLineNumber>t||d.isEmpty()&&(c.type===0||c.type===3))continue;const h=d.startLineNumber===t?d.startColumn:i,u=d.endLineNumber===t?d.endColumn:n;o[r++]=new ms(h,u,c.inlineClassName,c.type)}return o}static _typeCompare(e,t){const i=[2,0,1,3];return i[e]-i[t]}static compare(e,t){if(e.startColumn!==t.startColumn)return e.startColumn-t.startColumn;if(e.endColumn!==t.endColumn)return e.endColumn-t.endColumn;const i=ms._typeCompare(e.type,t.type);return i!==0?i:e.className!==t.className?e.className<t.className?-1:1:0}}class KW{constructor(e,t,i,n){this.startOffset=e,this.endOffset=t,this.className=i,this.metadata=n}}class iS{constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let i=0,n=e.length;i<n;i++)t|=e[i];return t}consumeLowerThan(e,t,i){for(;this.count>0&&this.stopOffsets[0]<e;){let n=0;for(;n+1<this.count&&this.stopOffsets[n]===this.stopOffsets[n+1];)n++;i.push(new KW(t,this.stopOffsets[n],this.classNames.join(" "),iS._metadata(this.metadata))),t=this.stopOffsets[n]+1,this.stopOffsets.splice(0,n+1),this.classNames.splice(0,n+1),this.metadata.splice(0,n+1),this.count-=n+1}return this.count>0&&t<e&&(i.push(new KW(t,e-1,this.classNames.join(" "),iS._metadata(this.metadata))),t=e),t}insert(e,t,i){if(this.count===0||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(i);else for(let n=0;n<this.count;n++)if(this.stopOffsets[n]>=e){this.stopOffsets.splice(n,0,e),this.classNames.splice(n,0,t),this.metadata.splice(n,0,i);break}this.count++}}class qpe{static normalize(e,t){if(t.length===0)return[];const i=[],n=new iS;let o=0;for(let r=0,a=t.length;r<a;r++){const l=t[r];let c=l.startColumn,d=l.endColumn;const h=l.className,u=l.type===1?2:l.type===2?4:0;if(c>1){const m=e.charCodeAt(c-2);Qi(m)&&c--}if(d>1){const m=e.charCodeAt(d-2);Qi(m)&&d--}const g=c-1,f=d-2;o=n.consumeLowerThan(g,o,i),n.count===0&&(o=g),n.insert(f,h,u)}return n.consumeLowerThan(1073741824,o,i),i}}class cn{constructor(e,t,i,n){this.endIndex=e,this.type=t,this.metadata=i,this.containsRTL=n,this._linePartBrand=void 0}isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}}class M${constructor(e,t){this.startOffset=e,this.endOffset=t}equals(e){return this.startOffset===e.startOffset&&this.endOffset===e.endOffset}}class xh{constructor(e,t,i,n,o,r,a,l,c,d,h,u,g,f,m,_,b,v,C){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.continuesWithWrappedLine=n,this.isBasicASCII=o,this.containsRTL=r,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=c.sort(ms.compare),this.tabSize=d,this.startVisibleColumn=h,this.spaceWidth=u,this.stopRenderingLineAfter=m,this.renderWhitespace=_==="all"?4:_==="boundary"?1:_==="selection"?2:_==="trailing"?3:0,this.renderControlCharacters=b,this.fontLigatures=v,this.selectionsOnLine=C&&C.sort((x,L)=>x.startOffset<L.startOffset?-1:1);const y=Math.abs(f-u),w=Math.abs(g-u);y<w?(this.renderSpaceWidth=f,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=g,this.renderSpaceCharCode=183)}sameSelection(e){if(this.selectionsOnLine===null)return e===null;if(e===null||e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&ms.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)}}class A${constructor(e,t){this.partIndex=e,this.charIndex=t}}class pl{static getPartIndex(e){return(e&4294901760)>>>16}static getCharIndex(e){return(e&65535)>>>0}constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(e,t,i,n){const o=(t<<16|i<<0)>>>0;this._data[e-1]=o,this._horizontalOffset[e-1]=n}getHorizontalOffset(e){return this._horizontalOffset.length===0?0:this._horizontalOffset[e-1]}charOffsetToPartData(e){return this.length===0?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){const t=this.charOffsetToPartData(e-1),i=pl.getPartIndex(t),n=pl.getCharIndex(t);return new A$(i,n)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,i){if(this.length===0)return 0;const n=(e<<16|i<<0)>>>0;let o=0,r=this.length-1;for(;o+1<r;){const m=o+r>>>1,_=this._data[m];if(_===n)return m;_>n?r=m:o=m}if(o===r)return o;const a=this._data[o],l=this._data[r];if(a===n)return o;if(l===n)return r;const c=pl.getPartIndex(a),d=pl.getCharIndex(a),h=pl.getPartIndex(l);let u;c!==h?u=t:u=pl.getCharIndex(l);const g=i-d,f=u-i;return g<=f?o:r}}class gR{constructor(e,t,i){this._renderLineOutputBrand=void 0,this.characterMapping=e,this.containsRTL=t,this.containsForeignElements=i}}function zC(s,e){if(s.lineContent.length===0){if(s.lineDecorations.length>0){e.appendString("<span>");let t=0,i=0,n=0;for(const r of s.lineDecorations)(r.type===1||r.type===2)&&(e.appendString('<span class="'),e.appendString(r.className),e.appendString('"></span>'),r.type===1&&(n|=1,t++),r.type===2&&(n|=2,i++));e.appendString("</span>");const o=new pl(1,t+i);return o.setColumnInfo(1,t,0,0),new gR(o,!1,n)}return e.appendString("<span><span></span></span>"),new gR(new pl(0,0),!1,0)}return nme(Xpe(s),e)}class Gpe{constructor(e,t,i,n){this.characterMapping=e,this.html=t,this.containsRTL=i,this.containsForeignElements=n}}function Sx(s){const e=new vm(1e4),t=zC(s,e);return new Gpe(t.characterMapping,e.build(),t.containsRTL,t.containsForeignElements)}class Ype{constructor(e,t,i,n,o,r,a,l,c,d,h,u,g,f,m,_){this.fontIsMonospace=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.len=n,this.isOverflowing=o,this.overflowingCharCount=r,this.parts=a,this.containsForeignElements=l,this.fauxIndentLength=c,this.tabSize=d,this.startVisibleColumn=h,this.containsRTL=u,this.spaceWidth=g,this.renderSpaceCharCode=f,this.renderWhitespace=m,this.renderControlCharacters=_}}function Xpe(s){const e=s.lineContent;let t,i,n;s.stopRenderingLineAfter!==-1&&s.stopRenderingLineAfter<e.length?(t=!0,i=e.length-s.stopRenderingLineAfter,n=s.stopRenderingLineAfter):(t=!1,i=0,n=e.length);let o=Qpe(e,s.containsRTL,s.lineTokens,s.fauxIndentLength,n);s.renderControlCharacters&&!s.isBasicASCII&&(o=eme(e,o)),(s.renderWhitespace===4||s.renderWhitespace===1||s.renderWhitespace===2&&s.selectionsOnLine||s.renderWhitespace===3&&!s.continuesWithWrappedLine)&&(o=tme(s,e,n,o));let r=0;if(s.lineDecorations.length>0){for(let a=0,l=s.lineDecorations.length;a<l;a++){const c=s.lineDecorations[a];c.type===3||c.type===1?r|=1:c.type===2&&(r|=2)}o=ime(e,n,o,s.lineDecorations)}return s.containsRTL||(o=Jpe(e,o,!s.isBasicASCII||s.fontLigatures)),new Ype(s.useMonospaceOptimizations,s.canUseHalfwidthRightwardsArrow,e,n,t,i,o,r,s.fauxIndentLength,s.tabSize,s.startVisibleColumn,s.containsRTL,s.spaceWidth,s.renderSpaceCharCode,s.renderWhitespace,s.renderControlCharacters)}function Qpe(s,e,t,i,n){const o=[];let r=0;i>0&&(o[r++]=new cn(i,"",0,!1));let a=i;for(let l=0,c=t.getCount();l<c;l++){const d=t.getEndOffset(l);if(d<=i)continue;const h=t.getClassName(l);if(d>=n){const g=e?Sp(s.substring(a,n)):!1;o[r++]=new cn(n,h,0,g);break}const u=e?Sp(s.substring(a,d)):!1;o[r++]=new cn(d,h,0,u),a=d}return o}function Jpe(s,e,t){let i=0;const n=[];let o=0;if(t)for(let r=0,a=e.length;r<a;r++){const l=e[r],c=l.endIndex;if(i+50<c){const d=l.type,h=l.metadata,u=l.containsRTL;let g=-1,f=i;for(let m=i;m<c;m++)s.charCodeAt(m)===32&&(g=m),g!==-1&&m-f>=50&&(n[o++]=new cn(g+1,d,h,u),f=g+1,g=-1);f!==c&&(n[o++]=new cn(c,d,h,u))}else n[o++]=l;i=c}else for(let r=0,a=e.length;r<a;r++){const l=e[r],c=l.endIndex,d=c-i;if(d>50){const h=l.type,u=l.metadata,g=l.containsRTL,f=Math.ceil(d/50);for(let m=1;m<f;m++){const _=i+m*50;n[o++]=new cn(_,h,u,g)}n[o++]=new cn(c,h,u,g)}else n[o++]=l;i=c}return n}function P$(s){return s<32?s!==9:s===127||s>=8234&&s<=8238||s>=8294&&s<=8297||s>=8206&&s<=8207||s===1564}function eme(s,e){const t=[];let i=new cn(0,"",0,!1),n=0;for(const o of e){const r=o.endIndex;for(;n<r;n++){const a=s.charCodeAt(n);P$(a)&&(n>i.endIndex&&(i=new cn(n,o.type,o.metadata,o.containsRTL),t.push(i)),i=new cn(n+1,"mtkcontrol",o.metadata,!1),t.push(i))}n>i.endIndex&&(i=new cn(r,o.type,o.metadata,o.containsRTL),t.push(i))}return t}function tme(s,e,t,i){const n=s.continuesWithWrappedLine,o=s.fauxIndentLength,r=s.tabSize,a=s.startVisibleColumn,l=s.useMonospaceOptimizations,c=s.selectionsOnLine,d=s.renderWhitespace===1,h=s.renderWhitespace===3,u=s.renderSpaceWidth!==s.spaceWidth,g=[];let f=0,m=0,_=i[m].type,b=i[m].containsRTL,v=i[m].endIndex;const C=i.length;let y=!1,w=rs(e),x;w===-1?(y=!0,w=t,x=t):x=Na(e);let L=!1,D=0,T=c&&c[D],F=a%r;for(let H=o;H<t;H++){const $=e.charCodeAt(H);T&&H>=T.endOffset&&(D++,T=c&&c[D]);let V;if(H<w||H>x)V=!0;else if($===9)V=!0;else if($===32)if(d)if(L)V=!0;else{const Y=H+1<t?e.charCodeAt(H+1):0;V=Y===32||Y===9}else V=!0;else V=!1;if(V&&c&&(V=!!T&&T.startOffset<=H&&T.endOffset>H),V&&h&&(V=y||H>x),V&&b&&H>=w&&H<=x&&(V=!1),L){if(!V||!l&&F>=r){if(u){const Y=f>0?g[f-1].endIndex:o;for(let ie=Y+1;ie<=H;ie++)g[f++]=new cn(ie,"mtkw",1,!1)}else g[f++]=new cn(H,"mtkw",1,!1);F=F%r}}else(H===v||V&&H>o)&&(g[f++]=new cn(H,_,0,b),F=F%r);for($===9?F=r:ih($)?F+=2:F++,L=V;H===v&&(m++,m<C);)_=i[m].type,b=i[m].containsRTL,v=i[m].endIndex}let W=!1;if(L)if(n&&d){const H=t>0?e.charCodeAt(t-1):0,$=t>1?e.charCodeAt(t-2):0;H===32&&$!==32&&$!==9||(W=!0)}else W=!0;if(W)if(u){const H=f>0?g[f-1].endIndex:o;for(let $=H+1;$<=t;$++)g[f++]=new cn($,"mtkw",1,!1)}else g[f++]=new cn(t,"mtkw",1,!1);else g[f++]=new cn(t,_,0,b);return g}function ime(s,e,t,i){i.sort(ms.compare);const n=qpe.normalize(s,i),o=n.length;let r=0;const a=[];let l=0,c=0;for(let h=0,u=t.length;h<u;h++){const g=t[h],f=g.endIndex,m=g.type,_=g.metadata,b=g.containsRTL;for(;r<o&&n[r].startOffset<f;){const v=n[r];if(v.startOffset>c&&(c=v.startOffset,a[l++]=new cn(c,m,_,b)),v.endOffset+1<=f)c=v.endOffset+1,a[l++]=new cn(c,m+" "+v.className,_|v.metadata,b),r++;else{c=f,a[l++]=new cn(c,m+" "+v.className,_|v.metadata,b);break}}f>c&&(c=f,a[l++]=new cn(c,m,_,b))}const d=t[t.length-1].endIndex;if(r<o&&n[r].startOffset===d)for(;r<o&&n[r].startOffset===d;){const h=n[r];a[l++]=new cn(c,h.className,h.metadata,!1),r++}return a}function nme(s,e){const t=s.fontIsMonospace,i=s.canUseHalfwidthRightwardsArrow,n=s.containsForeignElements,o=s.lineContent,r=s.len,a=s.isOverflowing,l=s.overflowingCharCount,c=s.parts,d=s.fauxIndentLength,h=s.tabSize,u=s.startVisibleColumn,g=s.containsRTL,f=s.spaceWidth,m=s.renderSpaceCharCode,_=s.renderWhitespace,b=s.renderControlCharacters,v=new pl(r+1,c.length);let C=!1,y=0,w=u,x=0,L=0,D=0;g?e.appendString('<span dir="ltr">'):e.appendString("<span>");for(let T=0,F=c.length;T<F;T++){const W=c[T],H=W.endIndex,$=W.type,V=W.containsRTL,Y=_!==0&&W.isWhitespace(),ie=Y&&!t&&($==="mtkw"||!n),ue=y===H&&W.isPseudoAfter();if(x=0,e.appendString("<span "),V&&e.appendString('style="unicode-bidi:isolate" '),e.appendString('class="'),e.appendString(ie?"mtkz":$),e.appendASCIICharCode(34),Y){let fe=0;{let oe=y,be=w;for(;oe<H;oe++){const wt=(o.charCodeAt(oe)===9?h-be%h:1)|0;fe+=wt,oe>=d&&(be+=wt)}}for(ie&&(e.appendString(' style="width:'),e.appendString(String(f*fe)),e.appendString('px"')),e.appendASCIICharCode(62);y<H;y++){v.setColumnInfo(y+1,T-D,x,L),D=0;const oe=o.charCodeAt(y);let be,xe;if(oe===9){be=h-w%h|0,xe=be,!i||xe>1?e.appendCharCode(8594):e.appendCharCode(65515);for(let wt=2;wt<=xe;wt++)e.appendCharCode(160)}else be=2,xe=1,e.appendCharCode(m),e.appendCharCode(8204);x+=be,L+=xe,y>=d&&(w+=xe)}}else for(e.appendASCIICharCode(62);y<H;y++){v.setColumnInfo(y+1,T-D,x,L),D=0;const fe=o.charCodeAt(y);let oe=1,be=1;switch(fe){case 9:oe=h-w%h,be=oe;for(let xe=1;xe<=oe;xe++)e.appendCharCode(160);break;case 32:e.appendCharCode(160);break;case 60:e.appendString("&lt;");break;case 62:e.appendString("&gt;");break;case 38:e.appendString("&amp;");break;case 0:b?e.appendCharCode(9216):e.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:e.appendCharCode(65533);break;default:ih(fe)&&be++,b&&fe<32?e.appendCharCode(9216+fe):b&&fe===127?e.appendCharCode(9249):b&&P$(fe)?(e.appendString("[U+"),e.appendString(sme(fe)),e.appendString("]"),oe=8,be=oe):e.appendCharCode(fe)}x+=oe,L+=be,y>=d&&(w+=be)}ue?D++:D=0,y>=r&&!C&&W.isPseudoAfter()&&(C=!0,v.setColumnInfo(y+1,T,x,L)),e.appendString("</span>")}return C||v.setColumnInfo(r+1,c.length-1,x,L),a&&(e.appendString('<span class="mtkoverflow">'),e.appendString(p("showMore","Show more ({0})",ome(l))),e.appendString("</span>")),e.appendString("</span>"),new gR(v,g,n)}function sme(s){return s.toString(16).toUpperCase().padStart(4,"0")}function ome(s){return s<1024?p("overflow.chars","{0} chars",s):s<1024*1024?`${(s/1024).toFixed(1)} KB`:`${(s/1024/1024).toFixed(1)} MB`}class qW{constructor(e,t,i,n){this._viewportBrand=void 0,this.top=e|0,this.left=t|0,this.width=i|0,this.height=n|0}}class rme{constructor(e,t){this.tabSize=e,this.data=t}}class HO{constructor(e,t,i,n,o,r,a){this._viewLineDataBrand=void 0,this.content=e,this.continuesWithWrappedLine=t,this.minColumn=i,this.maxColumn=n,this.startVisibleColumn=o,this.tokens=r,this.inlineDecorations=a}}class Zo{constructor(e,t,i,n,o,r,a,l,c,d){this.minColumn=e,this.maxColumn=t,this.content=i,this.continuesWithWrappedLine=n,this.isBasicASCII=Zo.isBasicASCII(i,r),this.containsRTL=Zo.containsRTL(i,this.isBasicASCII,o),this.tokens=a,this.inlineDecorations=l,this.tabSize=c,this.startVisibleColumn=d}static isBasicASCII(e,t){return t?vC(e):!0}static containsRTL(e,t,i){return!t&&i?Sp(e):!1}}class db{constructor(e,t,i){this.range=e,this.inlineClassName=t,this.type=i}}class ame{constructor(e,t,i,n){this.startOffset=e,this.endOffset=t,this.inlineClassName=i,this.inlineClassNameAffectsLetterSpacing=n}toInlineDecoration(e){return new db(new k(e,this.startOffset+1,e,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}}class O${constructor(e,t){this._viewModelDecorationBrand=void 0,this.range=e,this.options=t}}class kv{constructor(e,t,i){this.color=e,this.zIndex=t,this.data=i}static compareByRenderingProps(e,t){return e.zIndex===t.zIndex?e.color<t.color?-1:e.color>t.color?1:0:e.zIndex-t.zIndex}static equals(e,t){return e.color===t.color&&e.zIndex===t.zIndex&&ii(e.data,t.data)}static equalsArr(e,t){return ii(e,t,kv.equals)}}function lme(s){return Array.isArray(s)}function cme(s){return!lme(s)}function F$(s){return typeof s=="string"}function GW(s){return!F$(s)}function du(s){return!s}function Rc(s,e){return s.ignoreCase&&e?e.toLowerCase():e}function YW(s){return s.replace(/[&<>'"_]/g,"-")}function dme(s,e){console.log(`${s.languageId}: ${e}`)}function Gt(s,e){return new Error(`${s.languageId}: ${e}`)}function wd(s,e,t,i,n){const o=/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g;let r=null;return e.replace(o,function(a,l,c,d,h,u,g,f,m){return du(c)?du(d)?!du(h)&&h<i.length?Rc(s,i[h]):!du(g)&&s&&typeof s[g]=="string"?s[g]:(r===null&&(r=n.split("."),r.unshift(n)),!du(u)&&u<r.length?Rc(s,r[u]):""):Rc(s,t):"$"})}function hme(s,e,t){const i=/\$[sS](\d\d?)/g;let n=null;return e.replace(i,function(o,r){return n===null&&(n=t.split("."),n.unshift(t)),!du(r)&&r<n.length?Rc(s,n[r]):""})}function Ky(s,e){let t=e;for(;t&&t.length>0;){const i=s.tokenizer[t];if(i)return i;const n=t.lastIndexOf(".");n<0?t=null:t=t.substr(0,n)}return null}function ume(s,e){let t=e;for(;t&&t.length>0;){if(s.stateNames[t])return!0;const n=t.lastIndexOf(".");n<0?t=null:t=t.substr(0,n)}return!1}var gme=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},fme=function(s,e){return function(t,i){e(t,i,s)}},fR;const B$=5;class Dv{static{this._INSTANCE=new Dv(B$)}static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(e!==null&&e.depth>=this._maxCacheDepth)return new rp(e,t);let i=rp.getStackElementId(e);i.length>0&&(i+="|"),i+=t;let n=this._entries[i];return n||(n=new rp(e,t),this._entries[i]=n,n)}}class rp{constructor(e,t){this.parent=e,this.state=t,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(e){let t="";for(;e!==null;)t.length>0&&(t+="|"),t+=e.state,e=e.parent;return t}static _equals(e,t){for(;e!==null&&t!==null;){if(e===t)return!0;if(e.state!==t.state)return!1;e=e.parent,t=t.parent}return e===null&&t===null}equals(e){return rp._equals(this,e)}push(e){return Dv.create(this,e)}pop(){return this.parent}popall(){let e=this;for(;e.parent;)e=e.parent;return e}switchTo(e){return Dv.create(this.parent,e)}}class Ef{constructor(e,t){this.languageId=e,this.state=t}equals(e){return this.languageId===e.languageId&&this.state.equals(e.state)}clone(){return this.state.clone()===this.state?this:new Ef(this.languageId,this.state)}}class Sd{static{this._INSTANCE=new Sd(B$)}static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(t!==null)return new hb(e,t);if(e!==null&&e.depth>=this._maxCacheDepth)return new hb(e,t);const i=rp.getStackElementId(e);let n=this._entries[i];return n||(n=new hb(e,null),this._entries[i]=n,n)}}class hb{constructor(e,t){this.stack=e,this.embeddedLanguageData=t}clone(){return(this.embeddedLanguageData?this.embeddedLanguageData.clone():null)===this.embeddedLanguageData?this:Sd.create(this.stack,this.embeddedLanguageData)}equals(e){return!(e instanceof hb)||!this.stack.equals(e.stack)?!1:this.embeddedLanguageData===null&&e.embeddedLanguageData===null?!0:this.embeddedLanguageData===null||e.embeddedLanguageData===null?!1:this.embeddedLanguageData.equals(e.embeddedLanguageData)}}class pme{constructor(){this._tokens=[],this._languageId=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterLanguage(e){this._languageId=e}emit(e,t){this._lastTokenType===t&&this._lastTokenLanguage===this._languageId||(this._lastTokenType=t,this._lastTokenLanguage=this._languageId,this._tokens.push(new zb(e,t,this._languageId)))}nestedLanguageTokenize(e,t,i,n){const o=i.languageId,r=i.state,a=mi.get(o);if(!a)return this.enterLanguage(o),this.emit(n,""),r;const l=a.tokenize(e,t,r);if(n!==0)for(const c of l.tokens)this._tokens.push(new zb(c.offset+n,c.type,c.language));else this._tokens=this._tokens.concat(l.tokens);return this._lastTokenType=null,this._lastTokenLanguage=null,this._languageId=null,l.endState}finalize(e){return new FP(this._tokens,e)}}class nS{constructor(e,t){this._languageService=e,this._theme=t,this._prependTokens=null,this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0}enterLanguage(e){this._currentLanguageId=this._languageService.languageIdCodec.encodeLanguageId(e)}emit(e,t){const i=this._theme.match(this._currentLanguageId,t)|1024;this._lastTokenMetadata!==i&&(this._lastTokenMetadata=i,this._tokens.push(e),this._tokens.push(i))}static _merge(e,t,i){const n=e!==null?e.length:0,o=t.length,r=i!==null?i.length:0;if(n===0&&o===0&&r===0)return new Uint32Array(0);if(n===0&&o===0)return i;if(o===0&&r===0)return e;const a=new Uint32Array(n+o+r);e!==null&&a.set(e);for(let l=0;l<o;l++)a[n+l]=t[l];return i!==null&&a.set(i,n+o),a}nestedLanguageTokenize(e,t,i,n){const o=i.languageId,r=i.state,a=mi.get(o);if(!a)return this.enterLanguage(o),this.emit(n,""),r;const l=a.tokenizeEncoded(e,t,r);if(n!==0)for(let c=0,d=l.tokens.length;c<d;c+=2)l.tokens[c]+=n;return this._prependTokens=nS._merge(this._prependTokens,this._tokens,l.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,l.endState}finalize(e){return new _L(nS._merge(this._prependTokens,this._tokens,null),e)}}let Iv=fR=class extends B{constructor(e,t,i,n,o){super(),this._configurationService=o,this._languageService=e,this._standaloneThemeService=t,this._languageId=i,this._lexer=n,this._embeddedLanguages=Object.create(null),this.embeddedLoaded=Promise.resolve(void 0);let r=!1;this._register(mi.onDidChange(a=>{if(r)return;let l=!1;for(let c=0,d=a.changedLanguages.length;c<d;c++){const h=a.changedLanguages[c];if(this._embeddedLanguages[h]){l=!0;break}}l&&(r=!0,mi.handleChange([this._languageId]),r=!1)})),this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}),this._register(this._configurationService.onDidChangeConfiguration(a=>{a.affectsConfiguration("editor.maxTokenizationLineLength")&&(this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}))}))}getLoadStatus(){const e=[];for(const t in this._embeddedLanguages){const i=mi.get(t);if(i){if(i instanceof fR){const n=i.getLoadStatus();n.loaded===!1&&e.push(n.promise)}continue}mi.isResolved(t)||e.push(mi.getOrCreate(t))}return e.length===0?{loaded:!0}:{loaded:!1,promise:Promise.all(e).then(t=>{})}}getInitialState(){const e=Dv.create(null,this._lexer.start);return Sd.create(e,null)}tokenize(e,t,i){if(e.length>=this._maxTokenizationLineLength)return $2(this._languageId,i);const n=new pme,o=this._tokenize(e,t,i,n);return n.finalize(o)}tokenizeEncoded(e,t,i){if(e.length>=this._maxTokenizationLineLength)return ix(this._languageService.languageIdCodec.encodeLanguageId(this._languageId),i);const n=new nS(this._languageService,this._standaloneThemeService.getColorTheme().tokenTheme),o=this._tokenize(e,t,i,n);return n.finalize(o)}_tokenize(e,t,i,n){return i.embeddedLanguageData?this._nestedTokenize(e,t,i,0,n):this._myTokenize(e,t,i,0,n)}_findLeavingNestedLanguageOffset(e,t){let i=this._lexer.tokenizer[t.stack.state];if(!i&&(i=Ky(this._lexer,t.stack.state),!i))throw Gt(this._lexer,"tokenizer state is not defined: "+t.stack.state);let n=-1,o=!1;for(const r of i){if(!GW(r.action)||r.action.nextEmbedded!=="@pop")continue;o=!0;let a=r.resolveRegex(t.stack.state);const l=a.source;if(l.substr(0,4)==="^(?:"&&l.substr(l.length-1,1)===")"){const d=(a.ignoreCase?"i":"")+(a.unicode?"u":"");a=new RegExp(l.substr(4,l.length-5),d)}const c=e.search(a);c===-1||c!==0&&r.matchOnlyAtLineStart||(n===-1||c<n)&&(n=c)}if(!o)throw Gt(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+t.stack.state);return n}_nestedTokenize(e,t,i,n,o){const r=this._findLeavingNestedLanguageOffset(e,i);if(r===-1){const c=o.nestedLanguageTokenize(e,t,i.embeddedLanguageData,n);return Sd.create(i.stack,new Ef(i.embeddedLanguageData.languageId,c))}const a=e.substring(0,r);a.length>0&&o.nestedLanguageTokenize(a,!1,i.embeddedLanguageData,n);const l=e.substring(r);return this._myTokenize(l,t,i,n+r,o)}_safeRuleName(e){return e?e.name:"(unknown)"}_myTokenize(e,t,i,n,o){o.enterLanguage(this._languageId);const r=e.length,a=t&&this._lexer.includeLF?e+`
`:e,l=a.length;let c=i.embeddedLanguageData,d=i.stack,h=0,u=null,g=!0;for(;g||h<l;){const f=h,m=d.depth,_=u?u.groups.length:0,b=d.state;let v=null,C=null,y=null,w=null,x=null;if(u){v=u.matches;const T=u.groups.shift();C=T.matched,y=T.action,w=u.rule,u.groups.length===0&&(u=null)}else{if(!g&&h>=l)break;g=!1;let T=this._lexer.tokenizer[b];if(!T&&(T=Ky(this._lexer,b),!T))throw Gt(this._lexer,"tokenizer state is not defined: "+b);const F=a.substr(h);for(const W of T)if((h===0||!W.matchOnlyAtLineStart)&&(v=F.match(W.resolveRegex(b)),v)){C=v[0],y=W.action;break}}if(v||(v=[""],C=""),y||(h<l&&(v=[a.charAt(h)],C=v[0]),y=this._lexer.defaultToken),C===null)break;for(h+=C.length;cme(y)&&GW(y)&&y.test;)y=y.test(C,v,b,h===l);let L=null;if(typeof y=="string"||Array.isArray(y))L=y;else if(y.group)L=y.group;else if(y.token!==null&&y.token!==void 0){if(y.tokenSubst?L=wd(this._lexer,y.token,C,v,b):L=y.token,y.nextEmbedded)if(y.nextEmbedded==="@pop"){if(!c)throw Gt(this._lexer,"cannot pop embedded language if not inside one");c=null}else{if(c)throw Gt(this._lexer,"cannot enter embedded language from within an embedded language");x=wd(this._lexer,y.nextEmbedded,C,v,b)}if(y.goBack&&(h=Math.max(0,h-y.goBack)),y.switchTo&&typeof y.switchTo=="string"){let T=wd(this._lexer,y.switchTo,C,v,b);if(T[0]==="@"&&(T=T.substr(1)),Ky(this._lexer,T))d=d.switchTo(T);else throw Gt(this._lexer,"trying to switch to a state '"+T+"' that is undefined in rule: "+this._safeRuleName(w))}else{if(y.transform&&typeof y.transform=="function")throw Gt(this._lexer,"action.transform not supported");if(y.next)if(y.next==="@push"){if(d.depth>=this._lexer.maxStack)throw Gt(this._lexer,"maximum tokenizer stack size reached: ["+d.state+","+d.parent.state+",...]");d=d.push(b)}else if(y.next==="@pop"){if(d.depth<=1)throw Gt(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(w));d=d.pop()}else if(y.next==="@popall")d=d.popall();else{let T=wd(this._lexer,y.next,C,v,b);if(T[0]==="@"&&(T=T.substr(1)),Ky(this._lexer,T))d=d.push(T);else throw Gt(this._lexer,"trying to set a next state '"+T+"' that is undefined in rule: "+this._safeRuleName(w))}}y.log&&typeof y.log=="string"&&dme(this._lexer,this._lexer.languageId+": "+wd(this._lexer,y.log,C,v,b))}if(L===null)throw Gt(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(w));const D=T=>{const F=this._languageService.getLanguageIdByLanguageName(T)||this._languageService.getLanguageIdByMimeType(T)||T,W=this._getNestedEmbeddedLanguageData(F);if(h<l){const H=e.substr(h);return this._nestedTokenize(H,t,Sd.create(d,W),n+h,o)}else return Sd.create(d,W)};if(Array.isArray(L)){if(u&&u.groups.length>0)throw Gt(this._lexer,"groups cannot be nested: "+this._safeRuleName(w));if(v.length!==L.length+1)throw Gt(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(w));let T=0;for(let F=1;F<v.length;F++)T+=v[F].length;if(T!==C.length)throw Gt(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(w));u={rule:w,matches:v,groups:[]};for(let F=0;F<L.length;F++)u.groups[F]={action:L[F],matched:v[F+1]};h-=C.length;continue}else{if(L==="@rematch"&&(h-=C.length,C="",v=null,L="",x!==null))return D(x);if(C.length===0){if(l===0||m!==d.depth||b!==d.state||(u?u.groups.length:0)!==_)continue;throw Gt(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(w))}let T=null;if(F$(L)&&L.indexOf("@brackets")===0){const F=L.substr(9),W=mme(this._lexer,C);if(!W)throw Gt(this._lexer,"@brackets token returned but no bracket defined as: "+C);T=YW(W.token+F)}else{const F=L===""?"":L+this._lexer.tokenPostfix;T=YW(F)}f<r&&o.emit(f+n,T)}if(x!==null)return D(x)}return Sd.create(d,c)}_getNestedEmbeddedLanguageData(e){if(!this._languageService.isRegisteredLanguageId(e))return new Ef(e,Ap);e!==this._languageId&&(this._languageService.requestBasicLanguageFeatures(e),mi.getOrCreate(e),this._embeddedLanguages[e]=!0);const t=mi.get(e);return t?new Ef(e,t.getInitialState()):new Ef(e,Ap)}};Iv=fR=gme([fme(4,Ke)],Iv);function mme(s,e){if(!e)return null;e=Rc(s,e);const t=s.brackets;for(const i of t){if(i.open===e)return{token:i.token,bracketType:1};if(i.close===e)return{token:i.token,bracketType:-1}}return null}const _me=Gc("standaloneColorizer",{createHTML:s=>s});class VO{static colorizeElement(e,t,i,n){n=n||{};const o=n.theme||"vs",r=n.mimeType||i.getAttribute("lang")||i.getAttribute("data-lang");if(!r)return console.error("Mode not detected"),Promise.resolve();const a=t.getLanguageIdByMimeType(r)||r;e.setTheme(o);const l=i.firstChild?i.firstChild.nodeValue:"";i.className+=" "+o;const c=d=>{const h=_me?.createHTML(d)??d;i.innerHTML=h};return this.colorize(t,l||"",a,n).then(c,d=>console.error(d))}static async colorize(e,t,i,n){const o=e.languageIdCodec;let r=4;n&&typeof n.tabSize=="number"&&(r=n.tabSize),$P(t)&&(t=t.substr(1));const a=Fl(t);if(!e.isRegisteredLanguageId(i))return XW(a,r,o);const l=await mi.getOrCreate(i);return l?bme(a,r,l,o):XW(a,r,o)}static colorizeLine(e,t,i,n,o=4){const r=Zo.isBasicASCII(e,t),a=Zo.containsRTL(e,r,i);return Sx(new xh(!1,!0,e,!1,r,a,0,n,[],o,0,0,0,0,-1,"none",!1,!1,null)).html}static colorizeModelLine(e,t,i=4){const n=e.getLineContent(t);e.tokenization.forceTokenization(t);const r=e.tokenization.getLineTokens(t).inflate();return this.colorizeLine(n,e.mightContainNonBasicASCII(),e.mightContainRTL(),r,i)}}function bme(s,e,t,i){return new Promise((n,o)=>{const r=()=>{const a=vme(s,e,t,i);if(t instanceof Iv){const l=t.getLoadStatus();if(l.loaded===!1){l.promise.then(r,o);return}}n(a)};r()})}function XW(s,e,t){let i=[];const o=new Uint32Array(2);o[0]=0,o[1]=33587200;for(let r=0,a=s.length;r<a;r++){const l=s[r];o[0]=l.length;const c=new Pi(o,l,t),d=Zo.isBasicASCII(l,!0),h=Zo.containsRTL(l,d,!0),u=Sx(new xh(!1,!0,l,!1,d,h,0,c,[],e,0,0,0,0,-1,"none",!1,!1,null));i=i.concat(u.html),i.push("<br/>")}return i.join("")}function vme(s,e,t,i){let n=[],o=t.getInitialState();for(let r=0,a=s.length;r<a;r++){const l=s[r],c=t.tokenizeEncoded(l,!0,o);Pi.convertToEndOffset(c.tokens,l.length);const d=new Pi(c.tokens,l,i),h=Zo.isBasicASCII(l,!0),u=Zo.containsRTL(l,h,!0),g=Sx(new xh(!1,!0,l,!1,h,u,0,d.inflate(),[],e,0,0,0,0,-1,"none",!1,!1,null));n=n.concat(g.html),n.push("<br/>"),o=c.endState}return n.join("")}var Cme=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},yme=function(s,e){return function(t,i){e(t,i,s)}};let sS=class{static{this.ID="editor.contrib.markerDecorations"}constructor(e,t){}dispose(){}};sS=Cme([yme(1,iO)],sS);ct(sS.ID,sS,0);class W$ extends B{constructor(e,t){super(),this._onDidChange=this._register(new O),this.onDidChange=this._onDidChange.event,this._referenceDomElement=e,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let e=null;const t=()=>{e?this.observe({width:e.width,height:e.height}):this.observe()};let i=!1,n=!1;const o=()=>{if(i&&!n)try{i=!1,n=!0,t()}finally{mo(ke(this._referenceDomElement),()=>{n=!1,o()})}};this._resizeObserver=new ResizeObserver(r=>{r&&r[0]&&r[0].contentRect?e={width:r[0].contentRect.width,height:r[0].contentRect.height}:e=null,i=!0,o()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let i=0,n=0;t?(i=t.width,n=t.height):this._referenceDomElement&&(i=this._referenceDomElement.clientWidth,n=this._referenceDomElement.clientHeight),i=Math.max(5,i),n=Math.max(5,n),(this._width!==i||this._height!==n)&&(this._width=i,this._height=n,e&&this._onDidChange.fire())}}class Au{static{this.items=[]}constructor(e,t){this.key=e,this.migrate=t}apply(e){const t=Au._read(e,this.key),i=o=>Au._read(e,o),n=(o,r)=>Au._write(e,o,r);this.migrate(t,i,n)}static _read(e,t){if(typeof e>"u")return;const i=t.indexOf(".");if(i>=0){const n=t.substring(0,i);return this._read(e[n],t.substring(i+1))}return e[t]}static _write(e,t,i){const n=t.indexOf(".");if(n>=0){const o=t.substring(0,n);e[o]=e[o]||{},this._write(e[o],t.substring(n+1),i);return}e[t]=i}}function qa(s,e){Au.items.push(new Au(s,e))}function Co(s,e){qa(s,(t,i,n)=>{if(typeof t<"u"){for(const[o,r]of e)if(t===o){n(s,r);return}}})}function wme(s){Au.items.forEach(e=>e.apply(s))}Co("wordWrap",[[!0,"on"],[!1,"off"]]);Co("lineNumbers",[[!0,"on"],[!1,"off"]]);Co("cursorBlinking",[["visible","solid"]]);Co("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);Co("renderLineHighlight",[[!0,"line"],[!1,"none"]]);Co("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);Co("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);Co("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);Co("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);Co("autoIndent",[[!1,"advanced"],[!0,"full"]]);Co("matchBrackets",[[!0,"always"],[!1,"never"]]);Co("renderFinalNewline",[[!0,"on"],[!1,"off"]]);Co("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);Co("occurrencesHighlight",[[!0,"singleFile"],[!1,"off"]]);Co("wordBasedSuggestions",[[!0,"matchingDocuments"],[!1,"off"]]);qa("autoClosingBrackets",(s,e,t)=>{s===!1&&(t("autoClosingBrackets","never"),typeof e("autoClosingQuotes")>"u"&&t("autoClosingQuotes","never"),typeof e("autoSurround")>"u"&&t("autoSurround","never"))});qa("renderIndentGuides",(s,e,t)=>{typeof s<"u"&&(t("renderIndentGuides",void 0),typeof e("guides.indentation")>"u"&&t("guides.indentation",!!s))});qa("highlightActiveIndentGuide",(s,e,t)=>{typeof s<"u"&&(t("highlightActiveIndentGuide",void 0),typeof e("guides.highlightActiveIndentation")>"u"&&t("guides.highlightActiveIndentation",!!s))});const Sme={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};qa("suggest.filteredTypes",(s,e,t)=>{if(s&&typeof s=="object"){for(const i of Object.entries(Sme))s[i[0]]===!1&&typeof e(`suggest.${i[1]}`)>"u"&&t(`suggest.${i[1]}`,!1);t("suggest.filteredTypes",void 0)}});qa("quickSuggestions",(s,e,t)=>{if(typeof s=="boolean"){const i=s?"on":"off";t("quickSuggestions",{comments:i,strings:i,other:i})}});qa("experimental.stickyScroll.enabled",(s,e,t)=>{typeof s=="boolean"&&(t("experimental.stickyScroll.enabled",void 0),typeof e("stickyScroll.enabled")>"u"&&t("stickyScroll.enabled",s))});qa("experimental.stickyScroll.maxLineCount",(s,e,t)=>{typeof s=="number"&&(t("experimental.stickyScroll.maxLineCount",void 0),typeof e("stickyScroll.maxLineCount")>"u"&&t("stickyScroll.maxLineCount",s))});qa("codeActionsOnSave",(s,e,t)=>{if(s&&typeof s=="object"){let i=!1;const n={};for(const o of Object.entries(s))typeof o[1]=="boolean"?(i=!0,n[o[0]]=o[1]?"explicit":"never"):n[o[0]]=o[1];i&&t("codeActionsOnSave",n)}});qa("codeActionWidget.includeNearbyQuickfixes",(s,e,t)=>{typeof s=="boolean"&&(t("codeActionWidget.includeNearbyQuickfixes",void 0),typeof e("codeActionWidget.includeNearbyQuickFixes")>"u"&&t("codeActionWidget.includeNearbyQuickFixes",s))});qa("lightbulb.enabled",(s,e,t)=>{typeof s=="boolean"&&t("lightbulb.enabled",s?void 0:"off")});class Lme{constructor(){this._tabFocus=!1,this._onDidChangeTabFocus=new O,this.onDidChangeTabFocus=this._onDidChangeTabFocus.event}getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus)}}const Up=new Lme;var xme=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},kme=function(s,e){return function(t,i){e(t,i,s)}};let pR=class extends B{constructor(e,t,i,n,o){super(),this._accessibilityService=o,this._onDidChange=this._register(new O),this.onDidChange=this._onDidChange.event,this._onDidChangeFast=this._register(new O),this.onDidChangeFast=this._onDidChangeFast.event,this._isDominatedByLongLines=!1,this._viewLineCount=1,this._lineNumbersDigitCount=1,this._reservedHeight=0,this._glyphMarginDecorationLaneCount=1,this._computeOptionsMemory=new a6,this.isSimpleWidget=e,this.contextMenuId=t,this._containerObserver=this._register(new W$(n,i.dimension)),this._targetWindowId=ke(n).vscodeWindowId,this._rawOptions=QW(i),this._validatedOptions=Ld.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(13)&&this._containerObserver.startObserving(),this._register(lr.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(Up.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(cE.onDidChange(()=>this._recomputeOptions())),this._register(qb.getInstance(ke(n)).onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions()))}_recomputeOptions(){const e=this._computeOptions(),t=Ld.checkEquals(this.options,e);t!==null&&(this.options=e,this._onDidChangeFast.fire(t),this._onDidChange.fire(t))}_computeOptions(){const e=this._readEnvConfiguration(),t=ku.createFromValidatedSettings(this._validatedOptions,e.pixelRatio,this.isSimpleWidget),i=this._readFontInfo(t),n={memory:this._computeOptionsMemory,outerWidth:e.outerWidth,outerHeight:e.outerHeight-this._reservedHeight,fontInfo:i,extraEditorClassName:e.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:e.emptySelectionClipboard,pixelRatio:e.pixelRatio,tabFocusMode:Up.getTabFocusMode(),accessibilitySupport:e.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount};return Ld.computeOptions(this._validatedOptions,n)}_readEnvConfiguration(){return{extraEditorClassName:Ime(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:xu||vr,pixelRatio:qb.getInstance($5(this._targetWindowId,!0).window).value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(e){return cE.readFontInfo($5(this._targetWindowId,!0).window,e)}getRawOptions(){return this._rawOptions}updateOptions(e){const t=QW(e);Ld.applyUpdate(this._rawOptions,t)&&(this._validatedOptions=Ld.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(e){this._containerObserver.observe(e)}setIsDominatedByLongLines(e){this._isDominatedByLongLines!==e&&(this._isDominatedByLongLines=e,this._recomputeOptions())}setModelLineCount(e){const t=Dme(e);this._lineNumbersDigitCount!==t&&(this._lineNumbersDigitCount=t,this._recomputeOptions())}setViewLineCount(e){this._viewLineCount!==e&&(this._viewLineCount=e,this._recomputeOptions())}setReservedHeight(e){this._reservedHeight!==e&&(this._reservedHeight=e,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(e){this._glyphMarginDecorationLaneCount!==e&&(this._glyphMarginDecorationLaneCount=e,this._recomputeOptions())}};pR=xme([kme(4,vo)],pR);function Dme(s){let e=0;for(;s;)s=Math.floor(s/10),e++;return e||1}function Ime(){let s="";return!Fc&&!A6&&(s+="no-user-select "),Fc&&(s+="no-minimap-shadow ",s+="enable-user-select "),Qe&&(s+="mac "),s}class Tme{constructor(){this._values=[]}_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}}class Eme{constructor(){this._values=[]}_read(e){if(e>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[e]}get(e){return this._read(e)}_write(e,t){this._values[e]=t}}class Ld{static validateOptions(e){const t=new Tme;for(const i of vf){const n=i.name==="_never_"?void 0:e[i.name];t._write(i.id,i.validate(n))}return t}static computeOptions(e,t){const i=new Eme;for(const n of vf)i._write(n.id,n.compute(t,i,e._read(n.id)));return i}static _deepEquals(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return e===t;if(Array.isArray(e)||Array.isArray(t))return Array.isArray(e)&&Array.isArray(t)?ii(e,t):!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(!Ld._deepEquals(e[i],t[i]))return!1;return!0}static checkEquals(e,t){const i=[];let n=!1;for(const o of vf){const r=!Ld._deepEquals(e._read(o.id),t._read(o.id));i[o.id]=r,r&&(n=!0)}return n?new r6(i):null}static applyUpdate(e,t){let i=!1;for(const n of vf)if(t.hasOwnProperty(n.name)){const o=n.applyUpdate(e[n.name],t[n.name]);e[n.name]=o.newValue,i=i||o.didChange}return i}}function QW(s){const e=lc(s);return wme(e),e}var Fd;(function(s){const e={total:0,min:Number.MAX_VALUE,max:0},t={...e},i={...e},n={...e};let o=0;const r={keydown:0,input:0,render:0};function a(){b(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),r.keydown=1,queueMicrotask(l)}s.onKeyDown=a;function l(){r.keydown===1&&(performance.mark("keydown/end"),r.keydown=2)}function c(){performance.mark("input/start"),r.input=1,_()}s.onBeforeInput=c;function d(){r.input===0&&c(),queueMicrotask(h)}s.onInput=d;function h(){r.input===1&&(performance.mark("input/end"),r.input=2)}function u(){b()}s.onKeyUp=u;function g(){b()}s.onSelectionChange=g;function f(){r.keydown===2&&r.input===2&&r.render===0&&(performance.mark("render/start"),r.render=1,queueMicrotask(m),_())}s.onRenderStart=f;function m(){r.render===1&&(performance.mark("render/end"),r.render=2)}function _(){setTimeout(b)}function b(){r.keydown===2&&r.input===2&&r.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),v("keydown",e),v("input",t),v("render",i),v("inputlatency",n),o++,C())}function v(L,D){const T=performance.getEntriesByName(L)[0].duration;D.total+=T,D.min=Math.min(D.min,T),D.max=Math.max(D.max,T)}function C(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),r.keydown=0,r.input=0,r.render=0}function y(){if(o===0)return;const L={keydown:w(e),input:w(t),render:w(i),total:w(n),sampleCount:o};return x(e),x(t),x(i),x(n),o=0,L}s.getAndClearMeasurements=y;function w(L){return{average:L.total/o,max:L.max,min:L.min}}function x(L){L.total=0,L.min=Number.MAX_VALUE,L.max=0}})(Fd||(Fd={}));class Lx{constructor(e,t){this.x=e,this.y=t,this._pageCoordinatesBrand=void 0}toClientCoordinates(e){return new H$(this.x-e.scrollX,this.y-e.scrollY)}}class H${constructor(e,t){this.clientX=e,this.clientY=t,this._clientCoordinatesBrand=void 0}toPageCoordinates(e){return new Lx(this.clientX+e.scrollX,this.clientY+e.scrollY)}}class Nme{constructor(e,t,i,n){this.x=e,this.y=t,this.width=i,this.height=n,this._editorPagePositionBrand=void 0}}class Rme{constructor(e,t){this.x=e,this.y=t,this._positionRelativeToEditorBrand=void 0}}function zO(s){const e=Si(s);return new Nme(e.left,e.top,e.width,e.height)}function UO(s,e,t){const i=e.width/s.offsetWidth,n=e.height/s.offsetHeight,o=(t.x-e.x)/i,r=(t.y-e.y)/n;return new Rme(o,r)}class hh extends jr{constructor(e,t,i){super(ke(i),e),this._editorMouseEventBrand=void 0,this.isFromPointerCapture=t,this.pos=new Lx(this.posx,this.posy),this.editorPos=zO(i),this.relativePos=UO(i,this.editorPos,this.pos)}}class Mme{constructor(e){this._editorViewDomNode=e}_create(e){return new hh(e,!1,this._editorViewDomNode)}onContextMenu(e,t){return U(e,"contextmenu",i=>{t(this._create(i))})}onMouseUp(e,t){return U(e,"mouseup",i=>{t(this._create(i))})}onMouseDown(e,t){return U(e,ee.MOUSE_DOWN,i=>{t(this._create(i))})}onPointerDown(e,t){return U(e,ee.POINTER_DOWN,i=>{t(this._create(i),i.pointerId)})}onMouseLeave(e,t){return U(e,ee.MOUSE_LEAVE,i=>{t(this._create(i))})}onMouseMove(e,t){return U(e,"mousemove",i=>t(this._create(i)))}}class Ame{constructor(e){this._editorViewDomNode=e}_create(e){return new hh(e,!1,this._editorViewDomNode)}onPointerUp(e,t){return U(e,"pointerup",i=>{t(this._create(i))})}onPointerDown(e,t){return U(e,ee.POINTER_DOWN,i=>{t(this._create(i),i.pointerId)})}onPointerLeave(e,t){return U(e,ee.POINTER_LEAVE,i=>{t(this._create(i))})}onPointerMove(e,t){return U(e,"pointermove",i=>t(this._create(i)))}}class Pme extends B{constructor(e){super(),this._editorViewDomNode=e,this._globalPointerMoveMonitor=this._register(new wm),this._keydownListener=null}startMonitoring(e,t,i,n,o){this._keydownListener=gi(e.ownerDocument,"keydown",r=>{r.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,r.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(e,t,i,r=>{n(new hh(r,!0,this._editorViewDomNode))},r=>{this._keydownListener.dispose(),o(r)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}}class xx{static{this._idPool=0}constructor(e){this._editor=e,this._instanceId=++xx._idPool,this._counter=0,this._rules=new Map,this._garbageCollectionScheduler=new It(()=>this.garbageCollect(),1e3)}createClassNameRef(e){const t=this.getOrCreateRule(e);return t.increaseRefCount(),{className:t.className,dispose:()=>{t.decreaseRefCount(),this._garbageCollectionScheduler.schedule()}}}getOrCreateRule(e){const t=this.computeUniqueKey(e);let i=this._rules.get(t);if(!i){const n=this._counter++;i=new Ome(t,`dyn-rule-${this._instanceId}-${n}`,z1(this._editor.getContainerDomNode())?this._editor.getContainerDomNode():void 0,e),this._rules.set(t,i)}return i}computeUniqueKey(e){return JSON.stringify(e)}garbageCollect(){for(const e of this._rules.values())e.hasReferences()||(this._rules.delete(e.key),e.dispose())}}class Ome{constructor(e,t,i,n){this.key=e,this.className=t,this.properties=n,this._referenceCount=0,this._styleElementDisposables=new Z,this._styleElement=$o(i,void 0,this._styleElementDisposables),this._styleElement.textContent=this.getCssText(this.className,this.properties)}getCssText(e,t){let i=`.${e} {`;for(const n in t){const o=t[n];let r;typeof o=="object"?r=he(o.id):r=o;const a=Fme(n);i+=`
	${a}: ${r};`}return i+=`
}`,i}dispose(){this._styleElementDisposables.dispose(),this._styleElement=void 0}increaseRefCount(){this._referenceCount++}decreaseRefCount(){this._referenceCount--}hasReferences(){return this._referenceCount>0}}function Fme(s){return s.replace(/(^[A-Z])/,([e])=>e.toLowerCase()).replace(/([A-Z])/g,([e])=>`-${e.toLowerCase()}`)}class UC extends B{constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let i=0,n=e.length;i<n;i++){const o=e[i];switch(o.type){case 0:this.onCompositionStart(o)&&(t=!0);break;case 1:this.onCompositionEnd(o)&&(t=!0);break;case 2:this.onConfigurationChanged(o)&&(t=!0);break;case 3:this.onCursorStateChanged(o)&&(t=!0);break;case 4:this.onDecorationsChanged(o)&&(t=!0);break;case 5:this.onFlushed(o)&&(t=!0);break;case 6:this.onFocusChanged(o)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(o)&&(t=!0);break;case 8:this.onLineMappingChanged(o)&&(t=!0);break;case 9:this.onLinesChanged(o)&&(t=!0);break;case 10:this.onLinesDeleted(o)&&(t=!0);break;case 11:this.onLinesInserted(o)&&(t=!0);break;case 12:this.onRevealRangeRequest(o)&&(t=!0);break;case 13:this.onScrollChanged(o)&&(t=!0);break;case 15:this.onTokensChanged(o)&&(t=!0);break;case 14:this.onThemeChanged(o)&&(t=!0);break;case 16:this.onTokensColorsChanged(o)&&(t=!0);break;case 17:this.onZonesChanged(o)&&(t=!0);break;default:console.info("View received unknown event: "),console.info(o)}}t&&(this._shouldRender=!0)}}class yo extends UC{constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class Ua{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){const t=e.getAttribute("data-mprt");return t===null?0:parseInt(t,10)}static collect(e,t){const i=[];let n=0;for(;e&&e!==e.ownerDocument.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(i[n++]=this.read(e)),e=e.parentElement;const o=new Uint8Array(n);for(let r=0;r<n;r++)o[r]=i[n-r-1];return o}}class Bme{constructor(e,t){this._restrictedRenderingContextBrand=void 0,this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const i=this._viewLayout.getCurrentViewport();this.scrollTop=i.top,this.scrollLeft=i.left,this.viewportWidth=i.width,this.viewportHeight=i.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class Wme extends Bme{constructor(e,t,i){super(e,t),this._renderingContextBrand=void 0,this._viewLines=i}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}}class Hme{constructor(e,t,i,n){this.outsideRenderedLine=e,this.lineNumber=t,this.ranges=i,this.continuesOnNextLine=n}}class kx{static from(e){const t=new Array(e.length);for(let i=0,n=e.length;i<n;i++){const o=e[i];t[i]=new kx(o.left,o.width)}return t}constructor(e,t){this._horizontalRangeBrand=void 0,this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}}class Pu{constructor(e,t){this._floatHorizontalRangeBrand=void 0,this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}}class Vme{constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}}class JW{constructor(e,t){this.outsideRenderedLine=e,this.ranges=t}}class Jw{static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,i,n,o){const r=this._createRange();try{return r.setStart(e,t),r.setEnd(i,n),r.getClientRects()}catch{return null}finally{this._detachRange(r,o)}}static _mergeAdjacentRanges(e){if(e.length===1)return e;e.sort(Pu.compare);const t=[];let i=0,n=e[0];for(let o=1,r=e.length;o<r;o++){const a=e[o];n.left+n.width+.9>=a.left?n.width=Math.max(n.width,a.left+a.width-n.left):(t[i++]=n,n=a)}return t[i++]=n,t}static _createHorizontalRangesFromClientRects(e,t,i){if(!e||e.length===0)return null;const n=[];for(let o=0,r=e.length;o<r;o++){const a=e[o];n[o]=new Pu(Math.max(0,(a.left-t)/i),a.width/i)}return this._mergeAdjacentRanges(n)}static readHorizontalRanges(e,t,i,n,o,r){const l=e.children.length-1;if(0>l)return null;if(t=Math.min(l,Math.max(0,t)),n=Math.min(l,Math.max(0,n)),t===n&&i===o&&i===0&&!e.children[t].firstChild){const u=e.children[t].getClientRects();return r.markDidDomLayout(),this._createHorizontalRangesFromClientRects(u,r.clientRectDeltaLeft,r.clientRectScale)}t!==n&&n>0&&o===0&&(n--,o=1073741824);let c=e.children[t].firstChild,d=e.children[n].firstChild;if((!c||!d)&&(!c&&i===0&&t>0&&(c=e.children[t-1].firstChild,i=1073741824),!d&&o===0&&n>0&&(d=e.children[n-1].firstChild,o=1073741824)),!c||!d)return null;i=Math.min(c.textContent.length,Math.max(0,i)),o=Math.min(d.textContent.length,Math.max(0,o));const h=this._readClientRects(c,i,d,o,r.endNode);return r.markDidDomLayout(),this._createHorizontalRangesFromClientRects(h,r.clientRectDeltaLeft,r.clientRectScale)}}const zme=function(){return Ia?!0:!(ys||vr||Fc)}();let ap=!0;class e9{constructor(e,t){this.themeType=t;const i=e.options,n=i.get(50);i.get(38)==="off"?this.renderWhitespace=i.get(100):this.renderWhitespace="none",this.renderControlCharacters=i.get(95),this.spaceWidth=n.spaceWidth,this.middotWidth=n.middotWidth,this.wsmiddotWidth=n.wsmiddotWidth,this.useMonospaceOptimizations=n.isMonospace&&!i.get(33),this.canUseHalfwidthRightwardsArrow=n.canUseHalfwidthRightwardsArrow,this.lineHeight=i.get(67),this.stopRenderingLineAfter=i.get(118),this.fontLigatures=i.get(51)}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures}}class bc{static{this.CLASS_NAME="view-line"}constructor(e){this._options=e,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(this._renderedViewLine)this._renderedViewLine.domNode=Ct(e);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){return Ra(this._options.themeType)||this._options.renderWhitespace==="selection"?(this._isMaybeInvalid=!0,!0):!1}renderLine(e,t,i,n,o){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;const r=n.getViewLineRenderingData(e),a=this._options,l=ms.filter(r.inlineDecorations,e,r.minColumn,r.maxColumn);let c=null;if(Ra(a.themeType)||this._options.renderWhitespace==="selection"){const g=n.selections;for(const f of g){if(f.endLineNumber<e||f.startLineNumber>e)continue;const m=f.startLineNumber===e?f.startColumn:r.minColumn,_=f.endLineNumber===e?f.endColumn:r.maxColumn;m<_&&(Ra(a.themeType)&&l.push(new ms(m,_,"inline-selected-text",0)),this._options.renderWhitespace==="selection"&&(c||(c=[]),c.push(new M$(m-1,_-1))))}}const d=new xh(a.useMonospaceOptimizations,a.canUseHalfwidthRightwardsArrow,r.content,r.continuesWithWrappedLine,r.isBasicASCII,r.containsRTL,r.minColumn-1,r.tokens,l,r.tabSize,r.startVisibleColumn,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,a.stopRenderingLineAfter,a.renderWhitespace,a.renderControlCharacters,a.fontLigatures!==Ur.OFF,c);if(this._renderedViewLine&&this._renderedViewLine.input.equals(d))return!1;o.appendString('<div style="top:'),o.appendString(String(t)),o.appendString("px;height:"),o.appendString(String(i)),o.appendString('px;" class="'),o.appendString(bc.CLASS_NAME),o.appendString('">');const h=zC(d,o);o.appendString("</div>");let u=null;return ap&&zme&&r.isBasicASCII&&a.useMonospaceOptimizations&&h.containsForeignElements===0&&(u=new qy(this._renderedViewLine?this._renderedViewLine.domNode:null,d,h.characterMapping)),u||(u=z$(this._renderedViewLine?this._renderedViewLine.domNode:null,d,h.characterMapping,h.containsRTL,h.containsForeignElements)),this._renderedViewLine=u,!0}layoutLine(e,t,i){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(i))}getWidth(e){return this._renderedViewLine?this._renderedViewLine.getWidth(e):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof qy:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof qy?this._renderedViewLine.monospaceAssumptionsAreValid():ap}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof qy&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,i,n){if(!this._renderedViewLine)return null;t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),i=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,i));const o=this._renderedViewLine.input.stopRenderingLineAfter;if(o!==-1&&t>o+1&&i>o+1)return new JW(!0,[new Pu(this.getWidth(n),0)]);o!==-1&&t>o+1&&(t=o+1),o!==-1&&i>o+1&&(i=o+1);const r=this._renderedViewLine.getVisibleRangesForRange(e,t,i,n);return r&&r.length>0?new JW(!1,r):null}getColumnOfNodeOffset(e,t){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t):1}}class qy{constructor(e,t,i){this._cachedWidth=-1,this.domNode=e,this.input=t;const n=Math.floor(t.lineContent.length/300);if(n>0){this._keyColumnPixelOffsetCache=new Float32Array(n);for(let o=0;o<n;o++)this._keyColumnPixelOffsetCache[o]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=i,this._charWidth=t.spaceWidth}getWidth(e){if(!this.domNode||this.input.lineContent.length<300){const t=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*t)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return ap;if(this.input.lineContent.length<300){const e=this.getWidth(null),t=this.domNode.domNode.firstChild.offsetWidth;Math.abs(e-t)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),ap=!1)}return ap}toSlowRenderedLine(){return z$(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(e,t,i,n){const o=this._getColumnPixelOffset(e,t,n),r=this._getColumnPixelOffset(e,i,n);return[new Pu(o,r-o)]}_getColumnPixelOffset(e,t,i){if(t<=300){const c=this._characterMapping.getHorizontalOffset(t);return this._charWidth*c}const n=Math.floor((t-1)/300)-1,o=(n+1)*300+1;let r=-1;if(this._keyColumnPixelOffsetCache&&(r=this._keyColumnPixelOffsetCache[n],r===-1&&(r=this._actualReadPixelOffset(e,o,i),this._keyColumnPixelOffsetCache[n]=r)),r===-1){const c=this._characterMapping.getHorizontalOffset(t);return this._charWidth*c}const a=this._characterMapping.getHorizontalOffset(o),l=this._characterMapping.getHorizontalOffset(t);return r+this._charWidth*(l-a)}_getReadingTarget(e){return e.domNode.firstChild}_actualReadPixelOffset(e,t,i){if(!this.domNode)return-1;const n=this._characterMapping.getDomPosition(t),o=Jw.readHorizontalRanges(this._getReadingTarget(this.domNode),n.partIndex,n.charIndex,n.partIndex,n.charIndex,i);return!o||o.length===0?-1:o[0].left}getColumnOfNodeOffset(e,t){return $O(this._characterMapping,e,t)}}class V${constructor(e,t,i,n,o){if(this.domNode=e,this.input=t,this._characterMapping=i,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=o,this._cachedWidth=-1,this._pixelOffsetCache=null,!n||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let r=0,a=this._characterMapping.length;r<=a;r++)this._pixelOffsetCache[r]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(e){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(e,t,i,n){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){const o=this._readPixelOffset(this.domNode,e,t,n);if(o===-1)return null;const r=this._readPixelOffset(this.domNode,e,i,n);return r===-1?null:[new Pu(o,r-o)]}return this._readVisibleRangesForRange(this.domNode,e,t,i,n)}_readVisibleRangesForRange(e,t,i,n,o){if(i===n){const r=this._readPixelOffset(e,t,i,o);return r===-1?null:[new Pu(r,0)]}else return this._readRawVisibleRangesForRange(e,i,n,o)}_readPixelOffset(e,t,i,n){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(n);const o=this._getReadingTarget(e);return o.firstChild?(n.markDidDomLayout(),o.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){const o=this._pixelOffsetCache[i];if(o!==-1)return o;const r=this._actualReadPixelOffset(e,t,i,n);return this._pixelOffsetCache[i]=r,r}return this._actualReadPixelOffset(e,t,i,n)}_actualReadPixelOffset(e,t,i,n){if(this._characterMapping.length===0){const l=Jw.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,n);return!l||l.length===0?-1:l[0].left}if(i===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(n);const o=this._characterMapping.getDomPosition(i),r=Jw.readHorizontalRanges(this._getReadingTarget(e),o.partIndex,o.charIndex,o.partIndex,o.charIndex,n);if(!r||r.length===0)return-1;const a=r[0].left;if(this.input.isBasicASCII){const l=this._characterMapping.getHorizontalOffset(i),c=Math.round(this.input.spaceWidth*l);if(Math.abs(c-a)<=1)return c}return a}_readRawVisibleRangesForRange(e,t,i,n){if(t===1&&i===this._characterMapping.length)return[new Pu(0,this.getWidth(n))];const o=this._characterMapping.getDomPosition(t),r=this._characterMapping.getDomPosition(i);return Jw.readHorizontalRanges(this._getReadingTarget(e),o.partIndex,o.charIndex,r.partIndex,r.charIndex,n)}getColumnOfNodeOffset(e,t){return $O(this._characterMapping,e,t)}}class Ume extends V${_readVisibleRangesForRange(e,t,i,n,o){const r=super._readVisibleRangesForRange(e,t,i,n,o);if(!r||r.length===0||i===n||i===1&&n===this._characterMapping.length)return r;if(!this.input.containsRTL){const a=this._readPixelOffset(e,t,n,o);if(a!==-1){const l=r[r.length-1];l.left<a&&(l.width=a-l.left)}}return r}}const z$=function(){return xu?$me:jme}();function $me(s,e,t,i,n){return new Ume(s,e,t,i,n)}function jme(s,e,t,i,n){return new V$(s,e,t,i,n)}function $O(s,e,t){const i=e.textContent.length;let n=-1;for(;e;)e=e.previousSibling,n++;return s.getColumn(new A$(n,t),i)}class Tv{static whitespaceVisibleColumn(e,t,i){const n=e.length;let o=0,r=-1,a=-1;for(let l=0;l<n;l++){if(l===t)return[r,a,o];switch(o%i===0&&(r=l,a=o),e.charCodeAt(l)){case 32:o+=1;break;case 9:o=$i.nextRenderTabStop(o,i);break;default:return[-1,-1,-1]}}return t===n?[r,a,o]:[-1,-1,-1]}static atomicPosition(e,t,i,n){const o=e.length,[r,a,l]=Tv.whitespaceVisibleColumn(e,t,i);if(l===-1)return-1;let c;switch(n){case 0:c=!0;break;case 1:c=!1;break;case 2:if(l%i===0)return t;c=l%i<=i/2;break}if(c){if(r===-1)return-1;let u=a;for(let g=r;g<o;++g){if(u===a+i)return r;switch(e.charCodeAt(g)){case 32:u+=1;break;case 9:u=$i.nextRenderTabStop(u,i);break;default:return-1}}return u===a+i?r:-1}const d=$i.nextRenderTabStop(l,i);let h=l;for(let u=t;u<o;u++){if(h===d)return u;switch(e.charCodeAt(u)){case 32:h+=1;break;case 9:h=$i.nextRenderTabStop(h,i);break;default:return-1}}return h===d?o:-1}}class gd{constructor(e=null){this.hitTarget=e,this.type=0}}class U${get hitTarget(){return this.spanNode}constructor(e,t,i){this.position=e,this.spanNode=t,this.injectedText=i,this.type=1}}var hu;(function(s){function e(t,i,n){const o=t.getPositionFromDOMInfo(i,n);return o?new U$(o,i,null):new gd(i)}s.createFromDOMInfo=e})(hu||(hu={}));class Zme{constructor(e,t){this.lastViewCursorsRenderData=e,this.lastTextareaPosition=t}}class Qn{static _deduceRage(e,t=null){return!t&&e?new k(e.lineNumber,e.column,e.lineNumber,e.column):t??null}static createUnknown(e,t,i){return{type:0,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createTextarea(e,t){return{type:1,element:e,mouseColumn:t,position:null,range:null}}static createMargin(e,t,i,n,o,r){return{type:e,element:t,mouseColumn:i,position:n,range:o,detail:r}}static createViewZone(e,t,i,n,o){return{type:e,element:t,mouseColumn:i,position:n,range:this._deduceRage(n),detail:o}}static createContentText(e,t,i,n,o){return{type:6,element:e,mouseColumn:t,position:i,range:this._deduceRage(i,n),detail:o}}static createContentEmpty(e,t,i,n){return{type:7,element:e,mouseColumn:t,position:i,range:this._deduceRage(i),detail:n}}static createContentWidget(e,t,i){return{type:9,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createScrollbar(e,t,i){return{type:11,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createOverlayWidget(e,t,i){return{type:12,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createOutsideEditor(e,t,i,n){return{type:13,element:null,mouseColumn:e,position:t,range:this._deduceRage(t),outsidePosition:i,outsideDistance:n}}static _typeToString(e){return e===1?"TEXTAREA":e===2?"GUTTER_GLYPH_MARGIN":e===3?"GUTTER_LINE_NUMBERS":e===4?"GUTTER_LINE_DECORATIONS":e===5?"GUTTER_VIEW_ZONE":e===6?"CONTENT_TEXT":e===7?"CONTENT_EMPTY":e===8?"CONTENT_VIEW_ZONE":e===9?"CONTENT_WIDGET":e===10?"OVERVIEW_RULER":e===11?"SCROLLBAR":e===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+JSON.stringify(e.detail)}}class ls{static isTextArea(e){return e.length===2&&e[0]===3&&e[1]===7}static isChildOfViewLines(e){return e.length>=4&&e[0]===3&&e[3]===8}static isStrictChildOfViewLines(e){return e.length>4&&e[0]===3&&e[3]===8}static isChildOfScrollableElement(e){return e.length>=2&&e[0]===3&&e[1]===6}static isChildOfMinimap(e){return e.length>=2&&e[0]===3&&e[1]===9}static isChildOfContentWidgets(e){return e.length>=4&&e[0]===3&&e[3]===1}static isChildOfOverflowGuard(e){return e.length>=1&&e[0]===3}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&e[0]===2}static isChildOfOverlayWidgets(e){return e.length>=2&&e[0]===3&&e[1]===4}static isChildOfOverflowingOverlayWidgets(e){return e.length>=1&&e[0]===5}}class $p{constructor(e,t,i){this.viewModel=e.viewModel;const n=e.configuration.options;this.layoutInfo=n.get(146),this.viewDomNode=t.viewDomNode,this.lineHeight=n.get(67),this.stickyTabStops=n.get(117),this.typicalHalfwidthCharacterWidth=n.get(50).typicalHalfwidthCharacterWidth,this.lastRenderData=i,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return $p.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){const i=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(i){const n=i.verticalOffset+i.height/2,o=e.viewModel.getLineCount();let r=null,a,l=null;return i.afterLineNumber!==o&&(l=new P(i.afterLineNumber+1,1)),i.afterLineNumber>0&&(r=new P(i.afterLineNumber,e.viewModel.getLineMaxColumn(i.afterLineNumber))),l===null?a=r:r===null?a=l:t<n?a=r:a=l,{viewZoneId:i.id,afterLineNumber:i.afterLineNumber,positionBefore:r,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){const n=this._context.viewModel.getLineCount(),o=this._context.viewModel.getLineMaxColumn(n);return{range:new k(n,o,n,o),isAfterLines:!0}}const t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),i=this._context.viewModel.getLineMaxColumn(t);return{range:new k(t,1,t,i),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return $p._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,i){for(;e&&e!==e.ownerDocument.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===i)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}}class Kme{constructor(e,t,i,n){this.editorPos=t,this.pos=i,this.relativePos=n,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+this.relativePos.x-e.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<e.layoutInfo.contentLeft&&this.relativePos.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,Xn._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}}class qme extends Kme{get target(){return this._useHitTestTarget?this.hitTestResult.value.hitTarget:this._eventTarget}get targetPath(){return this._targetPathCacheElement!==this.target&&(this._targetPathCacheElement=this.target,this._targetPathCacheValue=Ua.collect(this.target,this._ctx.viewDomNode)),this._targetPathCacheValue}constructor(e,t,i,n,o){super(e,t,i,n),this.hitTestResult=new Fa(()=>Xn.doHitTest(this._ctx,this)),this._targetPathCacheElement=null,this._targetPathCacheValue=new Uint8Array(0),this._ctx=e,this._eventTarget=o;const r=!!this._eventTarget;this._useHitTestTarget=!r}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}get wouldBenefitFromHitTestTargetSwitch(){return!this._useHitTestTarget&&this.hitTestResult.value.hitTarget!==null&&this.target!==this.hitTestResult.value.hitTarget}switchToHitTestTarget(){this._useHitTestTarget=!0}_getMouseColumn(e=null){return e&&e.column<this._ctx.viewModel.getLineMaxColumn(e.lineNumber)?$i.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(e.lineNumber),e.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(e=null){return Qn.createUnknown(this.target,this._getMouseColumn(e),e)}fulfillTextarea(){return Qn.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(e,t,i,n){return Qn.createMargin(e,this.target,this._getMouseColumn(t),t,i,n)}fulfillViewZone(e,t,i){return Qn.createViewZone(e,this.target,this._getMouseColumn(t),t,i)}fulfillContentText(e,t,i){return Qn.createContentText(this.target,this._getMouseColumn(e),e,t,i)}fulfillContentEmpty(e,t){return Qn.createContentEmpty(this.target,this._getMouseColumn(e),e,t)}fulfillContentWidget(e){return Qn.createContentWidget(this.target,this._getMouseColumn(),e)}fulfillScrollbar(e){return Qn.createScrollbar(this.target,this._getMouseColumn(e),e)}fulfillOverlayWidget(e){return Qn.createOverlayWidget(this.target,this._getMouseColumn(),e)}}const t9={isAfterLines:!0};function $D(s){return{isAfterLines:!1,horizontalDistanceToText:s}}class Xn{constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){const t=e.target,i=Ua.collect(t,this._viewHelper.viewDomNode);return!!(ls.isChildOfContentWidgets(i)||ls.isChildOfOverflowingContentWidgets(i)||ls.isChildOfOverlayWidgets(i)||ls.isChildOfOverflowingOverlayWidgets(i))}createMouseTarget(e,t,i,n,o){const r=new $p(this._context,this._viewHelper,e),a=new qme(r,t,i,n,o);try{const l=Xn._createMouseTarget(r,a);if(l.type===6&&r.stickyTabStops&&l.position!==null){const c=Xn._snapToSoftTabBoundary(l.position,r.viewModel),d=k.fromPositions(c,c).plusRange(l.range);return a.fulfillContentText(c,d,l.detail)}return l}catch{return a.fulfillUnknown()}}static _createMouseTarget(e,t){if(t.target===null)return t.fulfillUnknown();const i=t;let n=null;return!ls.isChildOfOverflowGuard(t.targetPath)&&!ls.isChildOfOverflowingContentWidgets(t.targetPath)&&!ls.isChildOfOverflowingOverlayWidgets(t.targetPath)&&(n=n||t.fulfillUnknown()),n=n||Xn._hitTestContentWidget(e,i),n=n||Xn._hitTestOverlayWidget(e,i),n=n||Xn._hitTestMinimap(e,i),n=n||Xn._hitTestScrollbarSlider(e,i),n=n||Xn._hitTestViewZone(e,i),n=n||Xn._hitTestMargin(e,i),n=n||Xn._hitTestViewCursor(e,i),n=n||Xn._hitTestTextArea(e,i),n=n||Xn._hitTestViewLines(e,i),n=n||Xn._hitTestScrollbar(e,i),n||t.fulfillUnknown()}static _hitTestContentWidget(e,t){if(ls.isChildOfContentWidgets(t.targetPath)||ls.isChildOfOverflowingContentWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfillContentWidget(i):t.fulfillUnknown()}return null}static _hitTestOverlayWidget(e,t){if(ls.isChildOfOverlayWidgets(t.targetPath)||ls.isChildOfOverflowingOverlayWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfillOverlayWidget(i):t.fulfillUnknown()}return null}static _hitTestViewCursor(e,t){if(t.target){const i=e.lastRenderData.lastViewCursorsRenderData;for(const n of i)if(t.target===n.domNode)return t.fulfillContentText(n.position,null,{mightBeForeignElement:!1,injectedText:null})}if(t.isInContentArea){const i=e.lastRenderData.lastViewCursorsRenderData,n=t.mouseContentHorizontalOffset,o=t.mouseVerticalOffset;for(const r of i){if(n<r.contentLeft||n>r.contentLeft+r.width)continue;const a=e.getVerticalOffsetForLineNumber(r.position.lineNumber);if(a<=o&&o<=a+r.height)return t.fulfillContentText(r.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(e,t){const i=e.getZoneAtCoord(t.mouseVerticalOffset);if(i){const n=t.isInContentArea?8:5;return t.fulfillViewZone(n,i.position,i)}return null}static _hitTestTextArea(e,t){return ls.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfillContentText(e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):t.fulfillTextarea():null}static _hitTestMargin(e,t){if(t.isInMarginArea){const i=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),n=i.range.getStartPosition();let o=Math.abs(t.relativePos.x);const r={isAfterLines:i.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:o};if(o-=e.layoutInfo.glyphMarginLeft,o<=e.layoutInfo.glyphMarginWidth){const a=e.viewModel.coordinatesConverter.convertViewPositionToModelPosition(i.range.getStartPosition()),l=e.viewModel.glyphLanes.getLanesAtLine(a.lineNumber);return r.glyphMarginLane=l[Math.floor(o/e.lineHeight)],t.fulfillMargin(2,n,i.range,r)}return o-=e.layoutInfo.glyphMarginWidth,o<=e.layoutInfo.lineNumbersWidth?t.fulfillMargin(3,n,i.range,r):(o-=e.layoutInfo.lineNumbersWidth,t.fulfillMargin(4,n,i.range,r))}return null}static _hitTestViewLines(e,t){if(!ls.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfillContentEmpty(new P(1,1),t9);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){const n=e.viewModel.getLineCount(),o=e.viewModel.getLineMaxColumn(n);return t.fulfillContentEmpty(new P(n,o),t9)}if(ls.isStrictChildOfViewLines(t.targetPath)){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(e.viewModel.getLineLength(n)===0){const r=e.getLineWidth(n),a=$D(t.mouseContentHorizontalOffset-r);return t.fulfillContentEmpty(new P(n,1),a)}const o=e.getLineWidth(n);if(t.mouseContentHorizontalOffset>=o){const r=$D(t.mouseContentHorizontalOffset-o),a=new P(n,e.viewModel.getLineMaxColumn(n));return t.fulfillContentEmpty(a,r)}}const i=t.hitTestResult.value;return i.type===1?Xn.createMouseTargetFromHitTestPosition(e,t,i.spanNode,i.position,i.injectedText):t.wouldBenefitFromHitTestTargetSwitch?(t.switchToHitTestTarget(),this._createMouseTarget(e,t)):t.fulfillUnknown()}static _hitTestMinimap(e,t){if(ls.isChildOfMinimap(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new P(i,n))}return null}static _hitTestScrollbarSlider(e,t){if(ls.isChildOfScrollableElement(t.targetPath)&&t.target&&t.target.nodeType===1){const i=t.target.className;if(i&&/\b(slider|scrollbar)\b/.test(i)){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),o=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new P(n,o))}}return null}static _hitTestScrollbar(e,t){if(ls.isChildOfScrollableElement(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new P(i,n))}return null}getMouseColumn(e){const t=this._context.configuration.options,i=t.get(146),n=this._context.viewLayout.getCurrentScrollLeft()+e.x-i.contentLeft;return Xn._getMouseColumn(n,t.get(50).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){return e<0?1:Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,i,n,o){const r=n.lineNumber,a=n.column,l=e.getLineWidth(r);if(t.mouseContentHorizontalOffset>l){const b=$D(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(n,b)}const c=e.visibleRangeForPosition(r,a);if(!c)return t.fulfillUnknown(n);const d=c.left;if(Math.abs(t.mouseContentHorizontalOffset-d)<1)return t.fulfillContentText(n,null,{mightBeForeignElement:!!o,injectedText:o});const h=[];if(h.push({offset:c.left,column:a}),a>1){const b=e.visibleRangeForPosition(r,a-1);b&&h.push({offset:b.left,column:a-1})}const u=e.viewModel.getLineMaxColumn(r);if(a<u){const b=e.visibleRangeForPosition(r,a+1);b&&h.push({offset:b.left,column:a+1})}h.sort((b,v)=>b.offset-v.offset);const g=t.pos.toClientCoordinates(ke(e.viewDomNode)),f=i.getBoundingClientRect(),m=f.left<=g.clientX&&g.clientX<=f.right;let _=null;for(let b=1;b<h.length;b++){const v=h[b-1],C=h[b];if(v.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=C.offset){_=new k(r,v.column,r,C.column);const y=Math.abs(v.offset-t.mouseContentHorizontalOffset),w=Math.abs(C.offset-t.mouseContentHorizontalOffset);n=y<w?new P(r,v.column):new P(r,C.column);break}}return t.fulfillContentText(n,_,{mightBeForeignElement:!m||!!o,injectedText:o})}static _doHitTestWithCaretRangeFromPoint(e,t){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.getVerticalOffsetForLineNumber(i),o=n+e.lineHeight;if(!(i===e.viewModel.getLineCount()&&t.mouseVerticalOffset>o)){const a=Math.floor((n+o)/2);let l=t.pos.y+(a-t.mouseVerticalOffset);l<=t.editorPos.y&&(l=t.editorPos.y+1),l>=t.editorPos.y+t.editorPos.height&&(l=t.editorPos.y+t.editorPos.height-1);const c=new Lx(t.pos.x,l),d=this._actualDoHitTestWithCaretRangeFromPoint(e,c.toClientCoordinates(ke(e.viewDomNode)));if(d.type===1)return d}return this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates(ke(e.viewDomNode)))}static _actualDoHitTestWithCaretRangeFromPoint(e,t){const i=ju(e.viewDomNode);let n;if(i?typeof i.caretRangeFromPoint>"u"?n=Gme(i,t.clientX,t.clientY):n=i.caretRangeFromPoint(t.clientX,t.clientY):n=e.viewDomNode.ownerDocument.caretRangeFromPoint(t.clientX,t.clientY),!n||!n.startContainer)return new gd;const o=n.startContainer;if(o.nodeType===o.TEXT_NODE){const r=o.parentNode,a=r?r.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===bc.CLASS_NAME?hu.createFromDOMInfo(e,r,n.startOffset):new gd(o.parentNode)}else if(o.nodeType===o.ELEMENT_NODE){const r=o.parentNode,a=r?r.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===bc.CLASS_NAME?hu.createFromDOMInfo(e,o,o.textContent.length):new gd(o)}return new gd}static _doHitTestWithCaretPositionFromPoint(e,t){const i=e.viewDomNode.ownerDocument.caretPositionFromPoint(t.clientX,t.clientY);if(i.offsetNode.nodeType===i.offsetNode.TEXT_NODE){const n=i.offsetNode.parentNode,o=n?n.parentNode:null,r=o?o.parentNode:null;return(r&&r.nodeType===r.ELEMENT_NODE?r.className:null)===bc.CLASS_NAME?hu.createFromDOMInfo(e,i.offsetNode.parentNode,i.offset):new gd(i.offsetNode.parentNode)}if(i.offsetNode.nodeType===i.offsetNode.ELEMENT_NODE){const n=i.offsetNode.parentNode,o=n&&n.nodeType===n.ELEMENT_NODE?n.className:null,r=n?n.parentNode:null,a=r&&r.nodeType===r.ELEMENT_NODE?r.className:null;if(o===bc.CLASS_NAME){const l=i.offsetNode.childNodes[Math.min(i.offset,i.offsetNode.childNodes.length-1)];if(l)return hu.createFromDOMInfo(e,l,0)}else if(a===bc.CLASS_NAME)return hu.createFromDOMInfo(e,i.offsetNode,0)}return new gd(i.offsetNode)}static _snapToSoftTabBoundary(e,t){const i=t.getLineContent(e.lineNumber),{tabSize:n}=t.model.getOptions(),o=Tv.atomicPosition(i,e.column-1,n,2);return o!==-1?new P(e.lineNumber,o+1):e}static doHitTest(e,t){let i=new gd;if(typeof e.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?i=this._doHitTestWithCaretRangeFromPoint(e,t):e.viewDomNode.ownerDocument.caretPositionFromPoint&&(i=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates(ke(e.viewDomNode)))),i.type===1){const n=e.viewModel.getInjectedTextAt(i.position),o=e.viewModel.normalizePosition(i.position,2);(n||!o.equals(i.position))&&(i=new U$(o,i.spanNode,n))}return i}}function Gme(s,e,t){const i=document.createRange();let n=s.elementFromPoint(e,t);if(n!==null){for(;n&&n.firstChild&&n.firstChild.nodeType!==n.firstChild.TEXT_NODE&&n.lastChild&&n.lastChild.firstChild;)n=n.lastChild;const o=n.getBoundingClientRect(),r=ke(n),a=r.getComputedStyle(n,null).getPropertyValue("font-style"),l=r.getComputedStyle(n,null).getPropertyValue("font-variant"),c=r.getComputedStyle(n,null).getPropertyValue("font-weight"),d=r.getComputedStyle(n,null).getPropertyValue("font-size"),h=r.getComputedStyle(n,null).getPropertyValue("line-height"),u=r.getComputedStyle(n,null).getPropertyValue("font-family"),g=`${a} ${l} ${c} ${d}/${h} ${u}`,f=n.innerText;let m=o.left,_=0,b;if(e>o.left+o.width)_=f.length;else{const v=Nf.getInstance();for(let C=0;C<f.length+1;C++){if(b=v.getCharWidth(f.charAt(C),g)/2,m+=b,e<m){_=C;break}m+=b}}i.setStart(n.firstChild,_),i.setEnd(n.firstChild,_)}return i}class Nf{static{this._INSTANCE=null}static getInstance(){return Nf._INSTANCE||(Nf._INSTANCE=new Nf),Nf._INSTANCE}constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(e,t){const i=e+t;if(this._cache[i])return this._cache[i];const n=this._canvas.getContext("2d");n.font=t;const r=n.measureText(e).width;return this._cache[i]=r,r}}class jO extends UC{constructor(e,t,i){super(),this._mouseLeaveMonitor=null,this._context=e,this.viewController=t,this.viewHelper=i,this.mouseTargetFactory=new Xn(this._context,i),this._mouseDownOperation=this._register(new Yme(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(r,a)=>this._createMouseTarget(r,a),r=>this._getMouseColumn(r))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(146).height;const n=new Mme(this.viewHelper.viewDomNode);this._register(n.onContextMenu(this.viewHelper.viewDomNode,r=>this._onContextMenu(r,!0))),this._register(n.onMouseMove(this.viewHelper.viewDomNode,r=>{this._onMouseMove(r),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=U(this.viewHelper.viewDomNode.ownerDocument,"mousemove",a=>{this.viewHelper.viewDomNode.contains(a.target)||this._onMouseLeave(new hh(a,!1,this.viewHelper.viewDomNode))}))})),this._register(n.onMouseUp(this.viewHelper.viewDomNode,r=>this._onMouseUp(r))),this._register(n.onMouseLeave(this.viewHelper.viewDomNode,r=>this._onMouseLeave(r)));let o=0;this._register(n.onPointerDown(this.viewHelper.viewDomNode,(r,a)=>{o=a})),this._register(U(this.viewHelper.viewDomNode,ee.POINTER_UP,r=>{this._mouseDownOperation.onPointerUp()})),this._register(n.onMouseDown(this.viewHelper.viewDomNode,r=>this._onMouseDown(r,o))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){const e=GL.INSTANCE;let t=0,i=lr.getZoomLevel(),n=!1,o=0;const r=l=>{if(this.viewController.emitMouseWheel(l),!this._context.configuration.options.get(76))return;const c=new $u(l);if(e.acceptStandardWheelEvent(c),e.isPhysicalMouseWheel()){if(a(l)){const d=lr.getZoomLevel(),h=c.deltaY>0?1:-1;lr.setZoomLevel(d+h),c.preventDefault(),c.stopPropagation()}}else Date.now()-t>50&&(i=lr.getZoomLevel(),n=a(l),o=0),t=Date.now(),o+=c.deltaY,n&&(lr.setZoomLevel(i+o/5),c.preventDefault(),c.stopPropagation())};this._register(U(this.viewHelper.viewDomNode,ee.MOUSE_WHEEL,r,{capture:!0,passive:!1}));function a(l){return Qe?(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey:l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(146)){const t=this._context.configuration.options.get(146).height;this._height!==t&&(this._height=t,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}getTargetAtClientPoint(e,t){const n=new H$(e,t).toPageCoordinates(ke(this.viewHelper.viewDomNode)),o=zO(this.viewHelper.viewDomNode);if(n.y<o.y||n.y>o.y+o.height||n.x<o.x||n.x>o.x+o.width)return null;const r=UO(this.viewHelper.viewDomNode,o,n);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),o,n,r,null)}_createMouseTarget(e,t){let i=e.target;if(!this.viewHelper.viewDomNode.contains(i)){const n=ju(this.viewHelper.viewDomNode);n&&(i=n.elementsFromPoint(e.posx,e.posy).find(o=>this.viewHelper.viewDomNode.contains(o)))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,e.relativePos,t?i:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.relativePos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){this.mouseTargetFactory.mouseTargetIsWidget(e)||e.preventDefault(),!(this._mouseDownOperation.isActive()||e.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e,t){const i=this._createMouseTarget(e,!0),n=i.type===6||i.type===7,o=i.type===2||i.type===3||i.type===4,r=i.type===3,a=this._context.configuration.options.get(110),l=i.type===8||i.type===5,c=i.type===9;let d=e.leftButton||e.middleButton;Qe&&e.leftButton&&e.ctrlKey&&(d=!1);const h=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(d&&(n||r&&a))h(),this._mouseDownOperation.start(i.type,e,t);else if(o)e.preventDefault();else if(l){const u=i.detail;d&&this.viewHelper.shouldSuppressMouseDownOnViewZone(u.viewZoneId)&&(h(),this._mouseDownOperation.start(i.type,e,t),e.preventDefault())}else c&&this.viewHelper.shouldSuppressMouseDownOnWidget(i.detail)&&(h(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:i})}}class Yme extends B{constructor(e,t,i,n,o,r){super(),this._context=e,this._viewController=t,this._viewHelper=i,this._mouseTargetFactory=n,this._createMouseTarget=o,this._getMouseColumn=r,this._mouseMoveMonitor=this._register(new Pme(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new Xme(this._context,this._viewHelper,this._mouseTargetFactory,(a,l,c)=>this._dispatchMouse(a,l,c))),this._mouseState=new ZO,this._currentSelection=new me(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(e){this._lastMouseEvent=e,this._mouseState.setModifiers(e);const t=this._findMousePosition(e,!1);t&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:e,target:t}):t.type===13&&(t.outsidePosition==="above"||t.outsidePosition==="below")?this._topBottomDragScrolling.start(t,e):(this._topBottomDragScrolling.stop(),this._dispatchMouse(t,!0,1)))}start(e,t,i){this._lastMouseEvent=t,this._mouseState.setStartedOnLineNumbers(e===3),this._mouseState.setStartButtons(t),this._mouseState.setModifiers(t);const n=this._findMousePosition(t,!0);if(!n||!n.position)return;this._mouseState.trySetCount(t.detail,n.position),t.detail=this._mouseState.count;const o=this._context.configuration.options;if(!o.get(92)&&o.get(35)&&!o.get(22)&&!this._mouseState.altKey&&t.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&n.type===6&&n.position&&this._currentSelection.containsPosition(n.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,t.buttons,r=>this._onMouseDownThenMove(r),r=>{const a=this._findMousePosition(this._lastMouseEvent,!1);cc(r)?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:a?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(n,t.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,t.buttons,r=>this._onMouseDownThenMove(r),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(e){this._currentSelection=e.selections[0]}_getPositionOutsideEditor(e){const t=e.editorPos,i=this._context.viewModel,n=this._context.viewLayout,o=this._getMouseColumn(e);if(e.posy<t.y){const a=t.y-e.posy,l=Math.max(n.getCurrentScrollTop()-a,0),c=$p.getZoneAtCoord(this._context,l);if(c){const h=this._helpPositionJumpOverViewZone(c);if(h)return Qn.createOutsideEditor(o,h,"above",a)}const d=n.getLineNumberAtVerticalOffset(l);return Qn.createOutsideEditor(o,new P(d,1),"above",a)}if(e.posy>t.y+t.height){const a=e.posy-t.y-t.height,l=n.getCurrentScrollTop()+e.relativePos.y,c=$p.getZoneAtCoord(this._context,l);if(c){const h=this._helpPositionJumpOverViewZone(c);if(h)return Qn.createOutsideEditor(o,h,"below",a)}const d=n.getLineNumberAtVerticalOffset(l);return Qn.createOutsideEditor(o,new P(d,i.getLineMaxColumn(d)),"below",a)}const r=n.getLineNumberAtVerticalOffset(n.getCurrentScrollTop()+e.relativePos.y);if(e.posx<t.x){const a=t.x-e.posx;return Qn.createOutsideEditor(o,new P(r,1),"left",a)}if(e.posx>t.x+t.width){const a=e.posx-t.x-t.width;return Qn.createOutsideEditor(o,new P(r,i.getLineMaxColumn(r)),"right",a)}return null}_findMousePosition(e,t){const i=this._getPositionOutsideEditor(e);if(i)return i;const n=this._createMouseTarget(e,t);if(!n.position)return null;if(n.type===8||n.type===5){const r=this._helpPositionJumpOverViewZone(n.detail);if(r)return Qn.createViewZone(n.type,n.element,n.mouseColumn,r,n.detail)}return n}_helpPositionJumpOverViewZone(e){const t=new P(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),i=e.positionBefore,n=e.positionAfter;return i&&n?i.isBefore(t)?i:n:null}_dispatchMouse(e,t,i){e.position&&this._viewController.dispatchMouse({position:e.position,mouseColumn:e.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:i,inSelectionMode:t,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:e.type===6&&e.detail.injectedText!==null})}}class Xme extends B{constructor(e,t,i,n){super(),this._context=e,this._viewHelper=t,this._mouseTargetFactory=i,this._dispatchMouse=n,this._operation=null}dispose(){super.dispose(),this.stop()}start(e,t){this._operation?this._operation.setPosition(e,t):this._operation=new Qme(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,e,t)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}}class Qme extends B{constructor(e,t,i,n,o,r){super(),this._context=e,this._viewHelper=t,this._mouseTargetFactory=i,this._dispatchMouse=n,this._position=o,this._mouseEvent=r,this._lastTime=Date.now(),this._animationFrameDisposable=mo(ke(r.browserEvent),()=>this._execute())}dispose(){this._animationFrameDisposable.dispose(),super.dispose()}setPosition(e,t){this._position=e,this._mouseEvent=t}_tick(){const e=Date.now(),t=e-this._lastTime;return this._lastTime=e,t}_getScrollSpeed(){const e=this._context.configuration.options.get(67),t=this._context.configuration.options.get(146).height/e,i=this._position.outsideDistance/e;return i<=1.5?Math.max(30,t*(1+i)):i<=3?Math.max(60,t*(2+i)):Math.max(200,t*(7+i))}_execute(){const e=this._context.configuration.options.get(67),t=this._getScrollSpeed(),i=this._tick(),n=t*(i/1e3)*e,o=this._position.outsidePosition==="above"?-n:n;this._context.viewModel.viewLayout.deltaScrollNow(0,o),this._viewHelper.renderNow();const r=this._context.viewLayout.getLinesViewportData(),a=this._position.outsidePosition==="above"?r.startLineNumber:r.endLineNumber;let l;{const c=zO(this._viewHelper.viewDomNode),d=this._context.configuration.options.get(146).horizontalScrollbarHeight,h=new Lx(this._mouseEvent.pos.x,c.y+c.height-d-.1),u=UO(this._viewHelper.viewDomNode,c,h);l=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),c,h,u,null)}(!l.position||l.position.lineNumber!==a)&&(this._position.outsidePosition==="above"?l=Qn.createOutsideEditor(this._position.mouseColumn,new P(a,1),"above",this._position.outsideDistance):l=Qn.createOutsideEditor(this._position.mouseColumn,new P(a,this._context.viewModel.getLineMaxColumn(a)),"below",this._position.outsideDistance)),this._dispatchMouse(l,!0,2),this._animationFrameDisposable=mo(ke(l.element),()=>this._execute())}}class ZO{static{this.CLEAR_MOUSE_DOWN_COUNT_TIME=400}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get shiftKey(){return this._shiftKey}get leftButton(){return this._leftButton}get middleButton(){return this._middleButton}get startedOnLineNumbers(){return this._startedOnLineNumbers}constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){const i=new Date().getTime();i-this._lastSetMouseDownCountTime>ZO.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=i,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}}class Tn{static{this.EMPTY=new Tn("",0,0,null,void 0)}constructor(e,t,i,n,o){this.value=e,this.selectionStart=t,this.selectionEnd=i,this.selection=n,this.newlineCountBeforeSelection=o}toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(e,t){const i=e.getValue(),n=e.getSelectionStart(),o=e.getSelectionEnd();let r;if(t){const a=i.substring(0,n),l=t.value.substring(0,t.selectionStart);a===l&&(r=t.newlineCountBeforeSelection)}return new Tn(i,n,o,null,r)}collapseSelection(){return this.selectionStart===this.value.length?this:new Tn(this.value,this.value.length,this.value.length,null,void 0)}writeToTextArea(e,t,i){t.setValue(e,this.value),i&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){if(e<=this.selectionStart){const n=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,n,-1)}if(e>=this.selectionEnd){const n=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,n,1)}const t=this.value.substring(this.selectionStart,e);if(t.indexOf("")===-1)return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,t,1);const i=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,i,-1)}_finishDeduceEditorPosition(e,t,i){let n=0,o=-1;for(;(o=t.indexOf(`
`,o+1))!==-1;)n++;return[e,i*t.length,n]}static deduceInput(e,t,i){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};const n=Math.min(th(e.value,t.value),e.selectionStart,t.selectionStart),o=Math.min(O1(e.value,t.value),e.value.length-e.selectionEnd,t.value.length-t.selectionEnd);e.value.substring(n,e.value.length-o);const r=t.value.substring(n,t.value.length-o),a=e.selectionStart-n,l=e.selectionEnd-n,c=t.selectionStart-n,d=t.selectionEnd-n;if(c===d){const u=e.selectionStart-n;return{text:r,replacePrevCharCnt:u,replaceNextCharCnt:0,positionDelta:0}}const h=l-a;return{text:r,replacePrevCharCnt:h,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};const i=Math.min(th(e.value,t.value),e.selectionEnd),n=Math.min(O1(e.value,t.value),e.value.length-e.selectionEnd),o=e.value.substring(i,e.value.length-n),r=t.value.substring(i,t.value.length-n);e.selectionStart-i;const a=e.selectionEnd-i;t.selectionStart-i;const l=t.selectionEnd-i;return{text:r,replacePrevCharCnt:a,replaceNextCharCnt:o.length-a,positionDelta:l-r.length}}}class Rf{static _getPageOfLine(e,t){return Math.floor((e-1)/t)}static _getRangeForPage(e,t){const i=e*t,n=i+1,o=i+t;return new k(n,1,o+1,1)}static fromEditorSelection(e,t,i,n){const r=Rf._getPageOfLine(t.startLineNumber,i),a=Rf._getRangeForPage(r,i),l=Rf._getPageOfLine(t.endLineNumber,i),c=Rf._getRangeForPage(l,i);let d=a.intersectRanges(new k(1,1,t.startLineNumber,t.startColumn));if(n&&e.getValueLengthInRange(d,1)>500){const b=e.modifyPosition(d.getEndPosition(),-500);d=k.fromPositions(b,d.getEndPosition())}const h=e.getValueInRange(d,1),u=e.getLineCount(),g=e.getLineMaxColumn(u);let f=c.intersectRanges(new k(t.endLineNumber,t.endColumn,u,g));if(n&&e.getValueLengthInRange(f,1)>500){const b=e.modifyPosition(f.getStartPosition(),500);f=k.fromPositions(f.getStartPosition(),b)}const m=e.getValueInRange(f,1);let _;if(r===l||r+1===l)_=e.getValueInRange(t,1);else{const b=a.intersectRanges(t),v=c.intersectRanges(t);_=e.getValueInRange(b,1)+""+e.getValueInRange(v,1)}return n&&_.length>2*500&&(_=_.substring(0,500)+""+_.substring(_.length-500,_.length)),new Tn(h+_+m,h.length,h.length+_.length,t,d.endLineNumber-d.startLineNumber)}}var Jme=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},i9=function(s,e){return function(t,i){e(t,i,s)}},oS;(function(s){s.Tap="-monaco-textarea-synthetic-tap"})(oS||(oS={}));const mR={forceCopyWithSyntaxHighlighting:!1};class Ev{static{this.INSTANCE=new Ev}constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}}class e_e{constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(e){e=e||"";const t={text:e,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=e.length,t}}let _R=class extends B{get textAreaState(){return this._textAreaState}constructor(e,t,i,n,o,r){super(),this._host=e,this._textArea=t,this._OS=i,this._browser=n,this._accessibilityService=o,this._logService=r,this._onFocus=this._register(new O),this.onFocus=this._onFocus.event,this._onBlur=this._register(new O),this.onBlur=this._onBlur.event,this._onKeyDown=this._register(new O),this.onKeyDown=this._onKeyDown.event,this._onKeyUp=this._register(new O),this.onKeyUp=this._onKeyUp.event,this._onCut=this._register(new O),this.onCut=this._onCut.event,this._onPaste=this._register(new O),this.onPaste=this._onPaste.event,this._onType=this._register(new O),this.onType=this._onType.event,this._onCompositionStart=this._register(new O),this.onCompositionStart=this._onCompositionStart.event,this._onCompositionUpdate=this._register(new O),this.onCompositionUpdate=this._onCompositionUpdate.event,this._onCompositionEnd=this._register(new O),this.onCompositionEnd=this._onCompositionEnd.event,this._onSelectionChangeRequest=this._register(new O),this.onSelectionChangeRequest=this._onSelectionChangeRequest.event,this._asyncFocusGainWriteScreenReaderContent=this._register(new nn),this._asyncTriggerCut=this._register(new It(()=>this._onCut.fire(),0)),this._textAreaState=Tn.EMPTY,this._selectionChangeListener=null,this._accessibilityService.isScreenReaderOptimized()&&this.writeNativeTextAreaContent("ctor"),this._register(se.runAndSubscribe(this._accessibilityService.onDidChangeScreenReaderOptimized,()=>{this._accessibilityService.isScreenReaderOptimized()&&!this._asyncFocusGainWriteScreenReaderContent.value?this._asyncFocusGainWriteScreenReaderContent.value=this._register(new It(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)):this._asyncFocusGainWriteScreenReaderContent.clear()})),this._hasFocus=!1,this._currentComposition=null;let a=null;this._register(this._textArea.onKeyDown(l=>{const c=new Ft(l);(c.keyCode===114||this._currentComposition&&c.keyCode===1)&&c.stopPropagation(),c.equals(9)&&c.preventDefault(),a=c,this._onKeyDown.fire(c)})),this._register(this._textArea.onKeyUp(l=>{const c=new Ft(l);this._onKeyUp.fire(c)})),this._register(this._textArea.onCompositionStart(l=>{const c=new e_e;if(this._currentComposition){this._currentComposition=c;return}if(this._currentComposition=c,this._OS===2&&a&&a.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===l.data&&(a.code==="ArrowRight"||a.code==="ArrowLeft")){c.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:l.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:l.data});return}this._onCompositionStart.fire({data:l.data})})),this._register(this._textArea.onCompositionUpdate(l=>{const c=this._currentComposition;if(!c)return;if(this._browser.isAndroid){const h=Tn.readFromTextArea(this._textArea,this._textAreaState),u=Tn.deduceAndroidCompositionInput(this._textAreaState,h);this._textAreaState=h,this._onType.fire(u),this._onCompositionUpdate.fire(l);return}const d=c.handleCompositionUpdate(l.data);this._textAreaState=Tn.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(d),this._onCompositionUpdate.fire(l)})),this._register(this._textArea.onCompositionEnd(l=>{const c=this._currentComposition;if(!c)return;if(this._currentComposition=null,this._browser.isAndroid){const h=Tn.readFromTextArea(this._textArea,this._textAreaState),u=Tn.deduceAndroidCompositionInput(this._textAreaState,h);this._textAreaState=h,this._onType.fire(u),this._onCompositionEnd.fire();return}const d=c.handleCompositionUpdate(l.data);this._textAreaState=Tn.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(d),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(l=>{if(this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;const c=Tn.readFromTextArea(this._textArea,this._textAreaState),d=Tn.deduceInput(this._textAreaState,c,this._OS===2);d.replacePrevCharCnt===0&&d.text.length===1&&(Qi(d.text.charCodeAt(0))||d.text.charCodeAt(0)===127)||(this._textAreaState=c,(d.text!==""||d.replacePrevCharCnt!==0||d.replaceNextCharCnt!==0||d.positionDelta!==0)&&this._onType.fire(d))})),this._register(this._textArea.onCut(l=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(l),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(l=>{this._ensureClipboardGetsEditorSelection(l)})),this._register(this._textArea.onPaste(l=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),l.preventDefault(),!l.clipboardData)return;let[c,d]=bR.getTextData(l.clipboardData);c&&(d=d||Ev.INSTANCE.get(c),this._onPaste.fire({text:c,metadata:d}))})),this._register(this._textArea.onFocus(()=>{const l=this._hasFocus;this._setHasFocus(!0),this._accessibilityService.isScreenReaderOptimized()&&this._browser.isSafari&&!l&&this._hasFocus&&(this._asyncFocusGainWriteScreenReaderContent.value||(this._asyncFocusGainWriteScreenReaderContent.value=new It(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)),this._asyncFocusGainWriteScreenReaderContent.value.schedule())})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_installSelectionChangeListener(){let e=0;return U(this._textArea.ownerDocument,"selectionchange",t=>{if(Fd.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;const i=Date.now(),n=i-e;if(e=i,n<5)return;const o=i-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),o<100||!this._textAreaState.selection)return;const r=this._textArea.getValue();if(this._textAreaState.value!==r)return;const a=this._textArea.getSelectionStart(),l=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===a&&this._textAreaState.selectionEnd===l)return;const c=this._textAreaState.deduceEditorPosition(a),d=this._host.deduceModelPosition(c[0],c[1],c[2]),h=this._textAreaState.deduceEditorPosition(l),u=this._host.deduceModelPosition(h[0],h[1],h[2]),g=new me(d.lineNumber,d.column,u.lineNumber,u.column);this._onSelectionChangeRequest.fire(g)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(e){this._hasFocus!==e&&(this._hasFocus=e,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeNativeTextAreaContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(e,t){this._hasFocus||(t=t.collapseSelection()),t.writeToTextArea(e,this._textArea,this._hasFocus),this._textAreaState=t}writeNativeTextAreaContent(e){!this._accessibilityService.isScreenReaderOptimized()&&e==="render"||this._currentComposition||(this._logService.trace(`writeTextAreaState(reason: ${e})`),this._setAndWriteTextAreaState(e,this._host.getScreenReaderContent()))}_ensureClipboardGetsEditorSelection(e){const t=this._host.getDataToCopy(),i={version:1,isFromEmptySelection:t.isFromEmptySelection,multicursorText:t.multicursorText,mode:t.mode};Ev.INSTANCE.set(this._browser.isFirefox?t.text.replace(/\r\n/g,`
`):t.text,i),e.preventDefault(),e.clipboardData&&bR.setTextData(e.clipboardData,t.text,t.html,i)}};_R=Jme([i9(4,vo),i9(5,Pn)],_R);const bR={getTextData(s){const e=s.getData(wi.text);let t=null;const i=s.getData("vscode-editor-data");if(typeof i=="string")try{t=JSON.parse(i),t.version!==1&&(t=null)}catch{}return e.length===0&&t===null&&s.files.length>0?[Array.prototype.slice.call(s.files,0).map(o=>o.name).join(`
`),null]:[e,t]},setTextData(s,e,t,i){s.setData(wi.text,e),typeof t=="string"&&s.setData("text/html",t),s.setData("vscode-editor-data",JSON.stringify(i))}};class t_e extends B{get ownerDocument(){return this._actual.ownerDocument}constructor(e){super(),this._actual=e,this.onKeyDown=this._register(new tt(this._actual,"keydown")).event,this.onKeyUp=this._register(new tt(this._actual,"keyup")).event,this.onCompositionStart=this._register(new tt(this._actual,"compositionstart")).event,this.onCompositionUpdate=this._register(new tt(this._actual,"compositionupdate")).event,this.onCompositionEnd=this._register(new tt(this._actual,"compositionend")).event,this.onBeforeInput=this._register(new tt(this._actual,"beforeinput")).event,this.onInput=this._register(new tt(this._actual,"input")).event,this.onCut=this._register(new tt(this._actual,"cut")).event,this.onCopy=this._register(new tt(this._actual,"copy")).event,this.onPaste=this._register(new tt(this._actual,"paste")).event,this.onFocus=this._register(new tt(this._actual,"focus")).event,this.onBlur=this._register(new tt(this._actual,"blur")).event,this._onSyntheticTap=this._register(new O),this.onSyntheticTap=this._onSyntheticTap.event,this._ignoreSelectionChangeTime=0,this._register(this.onKeyDown(()=>Fd.onKeyDown())),this._register(this.onBeforeInput(()=>Fd.onBeforeInput())),this._register(this.onInput(()=>Fd.onInput())),this._register(this.onKeyUp(()=>Fd.onKeyUp())),this._register(U(this._actual,oS.Tap,()=>this._onSyntheticTap.fire()))}hasFocus(){const e=ju(this._actual);return e?e.activeElement===this._actual:this._actual.isConnected?Rn()===this._actual:!1}setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(e,t){const i=this._actual;i.value!==t&&(this.setIgnoreSelectionChangeTime("setValue"),i.value=t)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(e,t,i){const n=this._actual;let o=null;const r=ju(n);r?o=r.activeElement:o=Rn();const a=ke(o),l=o===n,c=n.selectionStart,d=n.selectionEnd;if(l&&c===t&&d===i){vr&&a.parent!==a&&n.focus();return}if(l){this.setIgnoreSelectionChangeTime("setSelectionRange"),n.setSelectionRange(t,i),vr&&a.parent!==a&&n.focus();return}try{const h=Fte(n);this.setIgnoreSelectionChangeTime("setSelectionRange"),n.focus(),n.setSelectionRange(t,i),Bte(n,h)}catch{}}}class i_e extends jO{constructor(e,t,i){super(e,t,i),this._register(ti.addTarget(this.viewHelper.linesContentDomNode)),this._register(U(this.viewHelper.linesContentDomNode,Wt.Tap,o=>this.onTap(o))),this._register(U(this.viewHelper.linesContentDomNode,Wt.Change,o=>this.onChange(o))),this._register(U(this.viewHelper.linesContentDomNode,Wt.Contextmenu,o=>this._onContextMenu(new hh(o,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(U(this.viewHelper.linesContentDomNode,"pointerdown",o=>{const r=o.pointerType;if(r==="mouse"){this._lastPointerType="mouse";return}else r==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));const n=new Ame(this.viewHelper.viewDomNode);this._register(n.onPointerMove(this.viewHelper.viewDomNode,o=>this._onMouseMove(o))),this._register(n.onPointerUp(this.viewHelper.viewDomNode,o=>this._onMouseUp(o))),this._register(n.onPointerLeave(this.viewHelper.viewDomNode,o=>this._onMouseLeave(o))),this._register(n.onPointerDown(this.viewHelper.viewDomNode,(o,r)=>this._onMouseDown(o,r)))}onTap(e){!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget)||(e.preventDefault(),this.viewHelper.focusTextArea(),this._dispatchGesture(e,!1))}onChange(e){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY),this._lastPointerType==="pen"&&this._dispatchGesture(e,!0)}_dispatchGesture(e,t){const i=this._createMouseTarget(new hh(e,!1,this.viewHelper.viewDomNode),!1);i.position&&this.viewController.dispatchMouse({position:i.position,mouseColumn:i.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:e.tapCount,inSelectionMode:t,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:i.type===6&&i.detail.injectedText!==null})}_onMouseDown(e,t){e.browserEvent.pointerType!=="touch"&&super._onMouseDown(e,t)}}class n_e extends jO{constructor(e,t,i){super(e,t,i),this._register(ti.addTarget(this.viewHelper.linesContentDomNode)),this._register(U(this.viewHelper.linesContentDomNode,Wt.Tap,n=>this.onTap(n))),this._register(U(this.viewHelper.linesContentDomNode,Wt.Change,n=>this.onChange(n))),this._register(U(this.viewHelper.linesContentDomNode,Wt.Contextmenu,n=>this._onContextMenu(new hh(n,!1,this.viewHelper.viewDomNode),!1)))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();const t=this._createMouseTarget(new hh(e,!1,this.viewHelper.viewDomNode),!1);if(t.position){const i=document.createEvent("CustomEvent");i.initEvent(oS.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(i),this.viewController.moveTo(t.position,1)}}onChange(e){this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}}class s_e extends B{constructor(e,t,i){super(),(Oa||IQ&&t6)&&ZP.pointerEvents?this.handler=this._register(new i_e(e,t,i)):Nt.TouchEvent?this.handler=this._register(new n_e(e,t,i)):this.handler=this._register(new jO(e,t,i))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}}class Sg extends UC{}class Dx extends Sg{static{this.CLASS_NAME="line-numbers"}constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new P(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){const e=this._context.configuration.options;this._lineHeight=e.get(67);const t=e.get(68);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(96);const i=e.get(146);this._lineNumbersLeft=i.lineNumbersLeft,this._lineNumbersWidth=i.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){const t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t);let i=!1;return this._activeLineNumber!==t.lineNumber&&(this._activeLineNumber=t.lineNumber,i=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(i=!0),i}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onDecorationsChanged(e){return e.affectsLineNumber}_getLineRenderLineNumber(e){const t=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new P(e,1));if(t.column!==1)return"";const i=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(i);if(this._renderLineNumbers===2){const n=Math.abs(this._lastCursorModelPosition.lineNumber-i);return n===0?'<span class="relative-current-line-number">'+i+"</span>":String(n)}if(this._renderLineNumbers===3){if(this._lastCursorModelPosition.lineNumber===i||i%10===0)return String(i);const n=this._context.viewModel.getLineCount();return i===n?String(i):""}return String(i)}prepareRender(e){if(this._renderLineNumbers===0){this._renderResult=null;return}const t=ys?this._lineHeight%2===0?" lh-even":" lh-odd":"",i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,o=this._context.viewModel.getDecorationsInViewport(e.visibleRange).filter(c=>!!c.options.lineNumberClassName);o.sort((c,d)=>k.compareRangesUsingEnds(c.range,d.range));let r=0;const a=this._context.viewModel.getLineCount(),l=[];for(let c=i;c<=n;c++){const d=c-i;let h=this._getLineRenderLineNumber(c),u="";for(;r<o.length&&o[r].range.endLineNumber<c;)r++;for(let g=r;g<o.length;g++){const{range:f,options:m}=o[g];f.startLineNumber<=c&&(u+=" "+m.lineNumberClassName)}if(!h&&!u){l[d]="";continue}c===a&&this._context.viewModel.getLineLength(c)===0&&(this._renderFinalNewline==="off"&&(h=""),this._renderFinalNewline==="dimmed"&&(u+=" dimmed-line-number")),c===this._activeLineNumber&&(u+=" active-line-number"),l[d]=`<div class="${Dx.CLASS_NAME}${t}${u}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${h}</div>`}this._renderResult=l}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}kr((s,e)=>{const t=s.getColor(Kde),i=s.getColor(ahe);i?e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${i}; }`):t&&e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${t.transparent(.4)}; }`)});class Nv extends yo{static{this.CLASS_NAME="glyph-margin"}static{this.OUTER_CLASS_NAME="margin"}constructor(e){super(e);const t=this._context.configuration.options,i=t.get(146);this._canUseLayerHinting=!t.get(32),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._domNode=Ct(document.createElement("div")),this._domNode.setClassName(Nv.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=Ct(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(Nv.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(146);return this._canUseLayerHinting=!t.get(32),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");const t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);const i=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(i),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(i)}}const lp="monaco-mouse-cursor-text";var o_e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},n9=function(s,e){return function(t,i){e(t,i,s)}};class r_e{constructor(e,t,i,n,o){this._context=e,this.modelLineNumber=t,this.distanceToModelLineStart=i,this.widthOfHiddenLineTextBefore=n,this.distanceToModelLineEnd=o,this._visibleTextAreaBrand=void 0,this.startPosition=null,this.endPosition=null,this.visibleTextareaStart=null,this.visibleTextareaEnd=null,this._previousPresentation=null}prepareRender(e){const t=new P(this.modelLineNumber,this.distanceToModelLineStart+1),i=new P(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=e.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=e.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(e){return this._previousPresentation||(e?this._previousPresentation=e:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}}const jD=vr;let vR=class extends yo{constructor(e,t,i,n,o){super(e),this._keybindingService=n,this._instantiationService=o,this._primaryCursorPosition=new P(1,1),this._primaryCursorVisibleRange=null,this._viewController=t,this._visibleRangeProvider=i,this._scrollLeft=0,this._scrollTop=0;const r=this._context.configuration.options,a=r.get(146);this._setAccessibilityOptions(r),this._contentLeft=a.contentLeft,this._contentWidth=a.contentWidth,this._contentHeight=a.height,this._fontInfo=r.get(50),this._lineHeight=r.get(67),this._emptySelectionClipboard=r.get(37),this._copyWithSyntaxHighlighting=r.get(25),this._visibleTextArea=null,this._selections=[new me(1,1,1,1)],this._modelSelections=[new me(1,1,1,1)],this._lastRenderPosition=null,this.textArea=Ct(document.createElement("textarea")),Ua.write(this.textArea,7),this.textArea.setClassName(`inputarea ${lp}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:l}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${l*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",this._getAriaLabel(r)),this.textArea.setAttribute("aria-required",r.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(r.get(125))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",p("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",r.get(92)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=Ct(document.createElement("div")),this.textAreaCover.setPosition("absolute");const c={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:u=>this._context.viewModel.getLineMaxColumn(u),getValueInRange:(u,g)=>this._context.viewModel.getValueInRange(u,g),getValueLengthInRange:(u,g)=>this._context.viewModel.getValueLengthInRange(u,g),modifyPosition:(u,g)=>this._context.viewModel.modifyPosition(u,g)},d={getDataToCopy:()=>{const u=this._context.viewModel.getPlainTextToCopy(this._modelSelections,this._emptySelectionClipboard,An),g=this._context.viewModel.model.getEOL(),f=this._emptySelectionClipboard&&this._modelSelections.length===1&&this._modelSelections[0].isEmpty(),m=Array.isArray(u)?u:null,_=Array.isArray(u)?u.join(g):u;let b,v=null;if(mR.forceCopyWithSyntaxHighlighting||this._copyWithSyntaxHighlighting&&_.length<65536){const C=this._context.viewModel.getRichTextToCopy(this._modelSelections,this._emptySelectionClipboard);C&&(b=C.html,v=C.mode)}return{isFromEmptySelection:f,multicursorText:m,text:_,html:b,mode:v}},getScreenReaderContent:()=>{if(this._accessibilitySupport===1){const u=this._selections[0];if(Qe&&u.isEmpty()){const f=u.getStartPosition();let m=this._getWordBeforePosition(f);if(m.length===0&&(m=this._getCharacterBeforePosition(f)),m.length>0)return new Tn(m,m.length,m.length,k.fromPositions(f),0)}if(Qe&&!u.isEmpty()&&c.getValueLengthInRange(u,0)<500){const f=c.getValueInRange(u,0);return new Tn(f,0,f.length,u,0)}if(Fc&&!u.isEmpty()){const f="vscode-placeholder";return new Tn(f,0,f.length,null,void 0)}return Tn.EMPTY}if(A5){const u=this._selections[0];if(u.isEmpty()){const g=u.getStartPosition(),[f,m]=this._getAndroidWordAtPosition(g);if(f.length>0)return new Tn(f,m,m,k.fromPositions(g),0)}return Tn.EMPTY}return Rf.fromEditorSelection(c,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0)},deduceModelPosition:(u,g,f)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(u,g,f)},h=this._register(new t_e(this.textArea.domNode));this._textAreaInput=this._register(this._instantiationService.createInstance(_R,d,h,lo,{isAndroid:A5,isChrome:CC,isFirefox:vr,isSafari:Fc})),this._register(this._textAreaInput.onKeyDown(u=>{this._viewController.emitKeyDown(u)})),this._register(this._textAreaInput.onKeyUp(u=>{this._viewController.emitKeyUp(u)})),this._register(this._textAreaInput.onPaste(u=>{let g=!1,f=null,m=null;u.metadata&&(g=this._emptySelectionClipboard&&!!u.metadata.isFromEmptySelection,f=typeof u.metadata.multicursorText<"u"?u.metadata.multicursorText:null,m=u.metadata.mode),this._viewController.paste(u.text,g,f,m)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(u=>{u.replacePrevCharCnt||u.replaceNextCharCnt||u.positionDelta?this._viewController.compositionType(u.text,u.replacePrevCharCnt,u.replaceNextCharCnt,u.positionDelta):this._viewController.type(u.text)})),this._register(this._textAreaInput.onSelectionChangeRequest(u=>{this._viewController.setSelection(u)})),this._register(this._textAreaInput.onCompositionStart(u=>{const g=this.textArea.domNode,f=this._modelSelections[0],{distanceToModelLineStart:m,widthOfHiddenTextBefore:_}=(()=>{const v=g.value.substring(0,Math.min(g.selectionStart,g.selectionEnd)),C=v.lastIndexOf(`
`),y=v.substring(C+1),w=y.lastIndexOf("	"),x=y.length-w-1,L=f.getStartPosition(),D=Math.min(L.column-1,x),T=L.column-1-D,F=y.substring(0,y.length-D),{tabSize:W}=this._context.viewModel.model.getOptions(),H=a_e(this.textArea.domNode.ownerDocument,F,this._fontInfo,W);return{distanceToModelLineStart:T,widthOfHiddenTextBefore:H}})(),{distanceToModelLineEnd:b}=(()=>{const v=g.value.substring(Math.max(g.selectionStart,g.selectionEnd)),C=v.indexOf(`
`),y=C===-1?v:v.substring(0,C),w=y.indexOf("	"),x=w===-1?y.length:y.length-w-1,L=f.getEndPosition(),D=Math.min(this._context.viewModel.model.getLineMaxColumn(L.lineNumber)-L.column,x);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(L.lineNumber)-L.column-D}})();this._context.viewModel.revealRange("keyboard",!0,k.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new r_e(this._context,f.startLineNumber,m,_,b),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${lp} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(u=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${lp}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(Q_.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}writeScreenReaderContent(e){this._textAreaInput.writeNativeTextAreaContent(e)}dispose(){super.dispose()}_getAndroidWordAtPosition(e){const t='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',i=this._context.viewModel.getLineContent(e.lineNumber),n=yr(t,[]);let o=!0,r=e.column,a=!0,l=e.column,c=0;for(;c<50&&(o||a);){if(o&&r<=1&&(o=!1),o){const d=i.charCodeAt(r-2);n.get(d)!==0?o=!1:r--}if(a&&l>i.length&&(a=!1),a){const d=i.charCodeAt(l-1);n.get(d)!==0?a=!1:l++}c++}return[i.substring(r-1,l-1),e.column-r]}_getWordBeforePosition(e){const t=this._context.viewModel.getLineContent(e.lineNumber),i=yr(this._context.configuration.options.get(132),[]);let n=e.column,o=0;for(;n>1;){const r=t.charCodeAt(n-2);if(i.get(r)!==0||o>50)return t.substring(n-1,e.column-1);o++,n--}return t.substring(0,e.column-1)}_getCharacterBeforePosition(e){if(e.column>1){const i=this._context.viewModel.getLineContent(e.lineNumber).charAt(e.column-2);if(!Qi(i.charCodeAt(0)))return i}return""}_getAriaLabel(e){if(e.get(2)===1){const i=this._keybindingService.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode")?.getAriaLabel(),n=this._keybindingService.lookupKeybinding("workbench.action.showCommands")?.getAriaLabel(),o=this._keybindingService.lookupKeybinding("workbench.action.openGlobalKeybindings")?.getAriaLabel(),r=p("accessibilityModeOff","The editor is not accessible at this time.");return i?p("accessibilityOffAriaLabel","{0} To enable screen reader optimized mode, use {1}",r,i):n?p("accessibilityOffAriaLabelNoKb","{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",r,n):o?p("accessibilityOffAriaLabelNoKbs","{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",r,o):r}return e.get(4)}_setAccessibilityOptions(e){this._accessibilitySupport=e.get(2);const t=e.get(3);this._accessibilitySupport===2&&t===ja.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=t;const n=e.get(146).wrappingColumn;if(n!==-1&&this._accessibilitySupport!==1){const o=e.get(50);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(n*o.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=jD?0:1}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(146);this._setAccessibilityOptions(t),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._contentHeight=i.height,this._fontInfo=t.get(50),this._lineHeight=t.get(67),this._emptySelectionClipboard=t.get(37),this._copyWithSyntaxHighlighting=t.get(25),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:n}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${n*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",this._getAriaLabel(t)),this.textArea.setAttribute("aria-required",t.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(t.get(125))),(e.hasChanged(34)||e.hasChanged(92))&&this._ensureReadOnlyAttribute(),e.hasChanged(2)&&this._textAreaInput.writeNativeTextAreaContent("strategy changed"),!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),this._modelSelections=e.modelSelections.slice(0),this._textAreaInput.writeNativeTextAreaContent("selection changed"),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return this._scrollLeft=e.scrollLeft,this._scrollTop=e.scrollTop,!0}onZonesChanged(e){return!0}isFocused(){return this._textAreaInput.isFocused()}focusTextArea(){this._textAreaInput.focusTextArea()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(e){e.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",e.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),e.role&&this.textArea.setAttribute("role",e.role)}_ensureReadOnlyAttribute(){const e=this._context.configuration.options;!Q_.enabled||e.get(34)&&e.get(92)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}prepareRender(e){this._primaryCursorPosition=new P(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=e.visibleRangeForPosition(this._primaryCursorPosition),this._visibleTextArea?.prepareRender(e)}render(e){this._textAreaInput.writeNativeTextAreaContent("render"),this._render()}_render(){if(this._visibleTextArea){const i=this._visibleTextArea.visibleTextareaStart,n=this._visibleTextArea.visibleTextareaEnd,o=this._visibleTextArea.startPosition,r=this._visibleTextArea.endPosition;if(o&&r&&i&&n&&n.left>=this._scrollLeft&&i.left<=this._scrollLeft+this._contentWidth){const a=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,l=this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));let c=this._visibleTextArea.widthOfHiddenLineTextBefore,d=this._contentLeft+i.left-this._scrollLeft,h=n.left-i.left+1;if(d<this._contentLeft){const b=this._contentLeft-d;d+=b,c+=b,h-=b}h>this._contentWidth&&(h=this._contentWidth);const u=this._context.viewModel.getViewLineData(o.lineNumber),g=u.tokens.findTokenIndexAtOffset(o.column-1),f=u.tokens.findTokenIndexAtOffset(r.column-1),m=g===f,_=this._visibleTextArea.definePresentation(m?u.tokens.getPresentation(g):null);this.textArea.domNode.scrollTop=l*this._lineHeight,this.textArea.domNode.scrollLeft=c,this._doRender({lastRenderPosition:null,top:a,left:d,width:h,height:this._lineHeight,useCover:!1,color:(mi.getColorMap()||[])[_.foreground],italic:_.italic,bold:_.bold,underline:_.underline,strikethrough:_.strikethrough})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}const e=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(e<this._contentLeft||e>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}const t=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(t<0||t>this._contentHeight){this._renderAtTopLeft();return}if(Qe||this._accessibilitySupport===2){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:t,left:this._textAreaWrapping?this._contentLeft:e,width:this._textAreaWidth,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;const i=this._textAreaInput.textAreaState.newlineCountBeforeSelection??this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=i*this._lineHeight;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:t,left:this._textAreaWrapping?this._contentLeft:e,width:this._textAreaWidth,height:jD?0:1,useCover:!1})}_newlinecount(e){let t=0,i=-1;do{if(i=e.indexOf(`
`,i+1),i===-1)break;t++}while(!0);return t}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:jD?0:1,useCover:!0})}_doRender(e){this._lastRenderPosition=e.lastRenderPosition;const t=this.textArea,i=this.textAreaCover;wn(t,this._fontInfo),t.setTop(e.top),t.setLeft(e.left),t.setWidth(e.width),t.setHeight(e.height),t.setColor(e.color?G.Format.CSS.formatHex(e.color):""),t.setFontStyle(e.italic?"italic":""),e.bold&&t.setFontWeight("bold"),t.setTextDecoration(`${e.underline?" underline":""}${e.strikethrough?" line-through":""}`),i.setTop(e.useCover?e.top:0),i.setLeft(e.useCover?e.left:0),i.setWidth(e.useCover?e.width:0),i.setHeight(e.useCover?e.height:0);const n=this._context.configuration.options;n.get(57)?i.setClassName("monaco-editor-background textAreaCover "+Nv.OUTER_CLASS_NAME):n.get(68).renderType!==0?i.setClassName("monaco-editor-background textAreaCover "+Dx.CLASS_NAME):i.setClassName("monaco-editor-background textAreaCover")}};vR=o_e([n9(3,yt),n9(4,ye)],vR);function a_e(s,e,t,i){if(e.length===0)return 0;const n=s.createElement("div");n.style.position="absolute",n.style.top="-50000px",n.style.width="50000px";const o=s.createElement("span");wn(o,t),o.style.whiteSpace="pre",o.style.tabSize=`${i*t.spaceWidth}px`,o.append(e),n.appendChild(o),s.body.appendChild(n);const r=o.offsetWidth;return n.remove(),r}const l_e=()=>!0,c_e=()=>!1,d_e=s=>s===" "||s==="	";class Kg{static shouldRecreate(e){return e.hasChanged(146)||e.hasChanged(132)||e.hasChanged(37)||e.hasChanged(77)||e.hasChanged(79)||e.hasChanged(80)||e.hasChanged(6)||e.hasChanged(7)||e.hasChanged(11)||e.hasChanged(9)||e.hasChanged(10)||e.hasChanged(14)||e.hasChanged(129)||e.hasChanged(50)||e.hasChanged(92)||e.hasChanged(131)}constructor(e,t,i,n){this.languageConfigurationService=n,this._cursorMoveConfigurationBrand=void 0,this._languageId=e;const o=i.options,r=o.get(146),a=o.get(50);this.readOnly=o.get(92),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=o.get(117),this.lineHeight=a.lineHeight,this.typicalHalfwidthCharacterWidth=a.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(r.height/this.lineHeight)-2),this.useTabStops=o.get(129),this.wordSeparators=o.get(132),this.emptySelectionClipboard=o.get(37),this.copyWithSyntaxHighlighting=o.get(25),this.multiCursorMergeOverlapping=o.get(77),this.multiCursorPaste=o.get(79),this.multiCursorLimit=o.get(80),this.autoClosingBrackets=o.get(6),this.autoClosingComments=o.get(7),this.autoClosingQuotes=o.get(11),this.autoClosingDelete=o.get(9),this.autoClosingOvertype=o.get(10),this.autoSurround=o.get(14),this.autoIndent=o.get(12),this.wordSegmenterLocales=o.get(131),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(e,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(e,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(e,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(e).getAutoClosingPairs();const l=this.languageConfigurationService.getLanguageConfiguration(e).getSurroundingPairs();if(l)for(const d of l)this.surroundingPairs[d.open]=d.close;const c=this.languageConfigurationService.getLanguageConfiguration(e).comments;this.blockCommentStartToken=c?.blockCommentStartToken??null}get electricChars(){if(!this._electricChars){this._electricChars={};const e=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter?.getElectricCharacters();if(e)for(const t of e)this._electricChars[t]=!0}return this._electricChars}onElectricCharacter(e,t,i){const n=bu(t,i-1),o=this.languageConfigurationService.getLanguageConfiguration(n.languageId).electricCharacter;return o?o.onElectricCharacter(e,n,i-n.firstCharOffset):null}normalizeIndentation(e){return nO(e,this.indentSize,this.insertSpaces)}_getShouldAutoClose(e,t,i){switch(t){case"beforeWhitespace":return d_e;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(e,i);case"always":return l_e;case"never":return c_e}}_getLanguageDefinedShouldAutoClose(e,t){const i=this.languageConfigurationService.getLanguageConfiguration(e).getAutoCloseBeforeSet(t);return n=>i.indexOf(n)!==-1}visibleColumnFromColumn(e,t){return $i.visibleColumnFromColumn(e.getLineContent(t.lineNumber),t.column,this.tabSize)}columnFromVisibleColumn(e,t,i){const n=$i.columnFromVisibleColumn(e.getLineContent(t),i,this.tabSize),o=e.getLineMinColumn(t);if(n<o)return o;const r=e.getLineMaxColumn(t);return n>r?r:n}}let ut=class $${static fromModelState(e){return new h_e(e)}static fromViewState(e){return new u_e(e)}static fromModelSelection(e){const t=me.liftSelection(e),i=new _n(k.fromPositions(t.getSelectionStart()),0,0,t.getPosition(),0);return $$.fromModelState(i)}static fromModelSelections(e){const t=[];for(let i=0,n=e.length;i<n;i++)t[i]=this.fromModelSelection(e[i]);return t}constructor(e,t){this._cursorStateBrand=void 0,this.modelState=e,this.viewState=t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}};class h_e{constructor(e){this.modelState=e,this.viewState=null}}class u_e{constructor(e){this.modelState=null,this.viewState=e}}class _n{constructor(e,t,i,n,o){this.selectionStart=e,this.selectionStartKind=t,this.selectionStartLeftoverVisibleColumns=i,this.position=n,this.leftoverVisibleColumns=o,this._singleCursorStateBrand=void 0,this.selection=_n._computeSelection(this.selectionStart,this.position)}equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.selectionStartKind===e.selectionStartKind&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,i,n){return e?new _n(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new P(t,i),n):new _n(new k(t,i,t,i),0,n,new P(t,i),n)}static _computeSelection(e,t){return e.isEmpty()||!t.isBeforeOrEqual(e.getStartPosition())?me.fromPositions(e.getStartPosition(),t):me.fromPositions(e.getEndPosition(),t)}}class js{constructor(e,t,i){this._editOperationResultBrand=void 0,this.type=e,this.commands=t,this.shouldPushStackElementBefore=i.shouldPushStackElementBefore,this.shouldPushStackElementAfter=i.shouldPushStackElementAfter}}function uh(s){return s==="'"||s==='"'||s==="`"}class uu{static columnSelect(e,t,i,n,o,r){const a=Math.abs(o-i)+1,l=i>o,c=n>r,d=n<r,h=[];for(let u=0;u<a;u++){const g=i+(l?-u:u),f=e.columnFromVisibleColumn(t,g,n),m=e.columnFromVisibleColumn(t,g,r),_=e.visibleColumnFromColumn(t,new P(g,f)),b=e.visibleColumnFromColumn(t,new P(g,m));d&&(_>r||b<n)||c&&(b>n||_<r)||h.push(new _n(new k(g,f,g,f),0,0,new P(g,m),0))}if(h.length===0)for(let u=0;u<a;u++){const g=i+(l?-u:u),f=t.getLineMaxColumn(g);h.push(new _n(new k(g,f,g,f),0,0,new P(g,f),0))}return{viewStates:h,reversed:l,fromLineNumber:i,fromVisualColumn:n,toLineNumber:o,toVisualColumn:r}}static columnSelectLeft(e,t,i){let n=i.toViewVisualColumn;return n>0&&n--,uu.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,n)}static columnSelectRight(e,t,i){let n=0;const o=Math.min(i.fromViewLineNumber,i.toViewLineNumber),r=Math.max(i.fromViewLineNumber,i.toViewLineNumber);for(let l=o;l<=r;l++){const c=t.getLineMaxColumn(l),d=e.visibleColumnFromColumn(t,new P(l,c));n=Math.max(n,d)}let a=i.toViewVisualColumn;return a<n&&a++,this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,a)}static columnSelectUp(e,t,i,n){const o=n?e.pageSize:1,r=Math.max(1,i.toViewLineNumber-o);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,r,i.toViewVisualColumn)}static columnSelectDown(e,t,i,n){const o=n?e.pageSize:1,r=Math.min(t.getLineCount(),i.toViewLineNumber+o);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,r,i.toViewVisualColumn)}}class Nn{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return me.fromPositions(n.getEndPosition())}}class g_e{constructor(e,t){this._range=e,this._text=t}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return me.fromRange(n,0)}}class e1{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return me.fromPositions(n.getStartPosition())}}class rS{constructor(e,t,i,n,o=!1){this._range=e,this._text=t,this._columnDeltaOffset=n,this._lineNumberDeltaOffset=i,this.insertsAutoWhitespace=o}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return me.fromPositions(n.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}}class KO{constructor(e,t,i,n=!1){this._range=e,this._text=t,this._initialSelection=i,this._forceMoveMarkers=n,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}class ZD{constructor(e,t,i){this._cursorPositionBrand=void 0,this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=i}}class xt{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-I6(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){const i=t.lineNumber-1;return new P(i,e.getLineMaxColumn(i))}else return t}static leftPositionAtomicSoftTabs(e,t,i){if(t.column<=e.getLineIndentColumn(t.lineNumber)){const n=e.getLineMinColumn(t.lineNumber),o=e.getLineContent(t.lineNumber),r=Tv.atomicPosition(o,t.column-1,i,0);if(r!==-1&&r+1>=n)return new P(t.lineNumber,r+1)}return this.leftPosition(e,t)}static left(e,t,i){const n=e.stickyTabStops?xt.leftPositionAtomicSoftTabs(t,i,e.tabSize):xt.leftPosition(t,i);return new ZD(n.lineNumber,n.column,0)}static moveLeft(e,t,i,n,o){let r,a;if(i.hasSelection()&&!n)r=i.selection.startLineNumber,a=i.selection.startColumn;else{const l=i.position.delta(void 0,-(o-1)),c=t.normalizePosition(xt.clipPositionColumn(l,t),0),d=xt.left(e,t,c);r=d.lineNumber,a=d.column}return i.move(n,r,a,0)}static clipPositionColumn(e,t){return new P(e.lineNumber,xt.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,i){return e<t?t:e>i?i:e}static rightPosition(e,t,i){return i<e.getLineMaxColumn(t)?i=i+zP(e.getLineContent(t),i-1):t<e.getLineCount()&&(t=t+1,i=e.getLineMinColumn(t)),new P(t,i)}static rightPositionAtomicSoftTabs(e,t,i,n,o){if(i<e.getLineIndentColumn(t)){const r=e.getLineContent(t),a=Tv.atomicPosition(r,i-1,n,1);if(a!==-1)return new P(t,a+1)}return this.rightPosition(e,t,i)}static right(e,t,i){const n=e.stickyTabStops?xt.rightPositionAtomicSoftTabs(t,i.lineNumber,i.column,e.tabSize,e.indentSize):xt.rightPosition(t,i.lineNumber,i.column);return new ZD(n.lineNumber,n.column,0)}static moveRight(e,t,i,n,o){let r,a;if(i.hasSelection()&&!n)r=i.selection.endLineNumber,a=i.selection.endColumn;else{const l=i.position.delta(void 0,o-1),c=t.normalizePosition(xt.clipPositionColumn(l,t),1),d=xt.right(e,t,c);r=d.lineNumber,a=d.column}return i.move(n,r,a,0)}static vertical(e,t,i,n,o,r,a,l){const c=$i.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize)+o,d=t.getLineCount(),h=i===1&&n===1,u=i===d&&n===t.getLineMaxColumn(i),g=r<i?h:u;if(i=r,i<1?(i=1,a?n=t.getLineMinColumn(i):n=Math.min(t.getLineMaxColumn(i),n)):i>d?(i=d,a?n=t.getLineMaxColumn(i):n=Math.min(t.getLineMaxColumn(i),n)):n=e.columnFromVisibleColumn(t,i,c),g?o=0:o=c-$i.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize),l!==void 0){const f=new P(i,n),m=t.normalizePosition(f,l);o=o+(n-m.column),i=m.lineNumber,n=m.column}return new ZD(i,n,o)}static down(e,t,i,n,o,r,a){return this.vertical(e,t,i,n,o,i+r,a,4)}static moveDown(e,t,i,n,o){let r,a;i.hasSelection()&&!n?(r=i.selection.endLineNumber,a=i.selection.endColumn):(r=i.position.lineNumber,a=i.position.column);let l=0,c;do if(c=xt.down(e,t,r+l,a,i.leftoverVisibleColumns,o,!0),t.normalizePosition(new P(c.lineNumber,c.column),2).lineNumber>r)break;while(l++<10&&r+l<t.getLineCount());return i.move(n,c.lineNumber,c.column,c.leftoverVisibleColumns)}static translateDown(e,t,i){const n=i.selection,o=xt.down(e,t,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),r=xt.down(e,t,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new _n(new k(o.lineNumber,o.column,o.lineNumber,o.column),0,o.leftoverVisibleColumns,new P(r.lineNumber,r.column),r.leftoverVisibleColumns)}static up(e,t,i,n,o,r,a){return this.vertical(e,t,i,n,o,i-r,a,3)}static moveUp(e,t,i,n,o){let r,a;i.hasSelection()&&!n?(r=i.selection.startLineNumber,a=i.selection.startColumn):(r=i.position.lineNumber,a=i.position.column);const l=xt.up(e,t,r,a,i.leftoverVisibleColumns,o,!0);return i.move(n,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(e,t,i){const n=i.selection,o=xt.up(e,t,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),r=xt.up(e,t,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new _n(new k(o.lineNumber,o.column,o.lineNumber,o.column),0,o.leftoverVisibleColumns,new P(r.lineNumber,r.column),r.leftoverVisibleColumns)}static _isBlankLine(e,t){return e.getLineFirstNonWhitespaceColumn(t)===0}static moveToPrevBlankLine(e,t,i,n){let o=i.position.lineNumber;for(;o>1&&this._isBlankLine(t,o);)o--;for(;o>1&&!this._isBlankLine(t,o);)o--;return i.move(n,o,t.getLineMinColumn(o),0)}static moveToNextBlankLine(e,t,i,n){const o=t.getLineCount();let r=i.position.lineNumber;for(;r<o&&this._isBlankLine(t,r);)r++;for(;r<o&&!this._isBlankLine(t,r);)r++;return i.move(n,r,t.getLineMinColumn(r),0)}static moveToBeginningOfLine(e,t,i,n){const o=i.position.lineNumber,r=t.getLineMinColumn(o),a=t.getLineFirstNonWhitespaceColumn(o)||r;let l;return i.position.column===a?l=r:l=a,i.move(n,o,l,0)}static moveToEndOfLine(e,t,i,n,o){const r=i.position.lineNumber,a=t.getLineMaxColumn(r);return i.move(n,r,a,o?1073741824-a:0)}static moveToBeginningOfBuffer(e,t,i,n){return i.move(n,1,1,0)}static moveToEndOfBuffer(e,t,i,n){const o=t.getLineCount(),r=t.getLineMaxColumn(o);return i.move(n,o,r,0)}}class ig{static deleteRight(e,t,i,n){const o=[];let r=e!==3;for(let a=0,l=n.length;a<l;a++){const c=n[a];let d=c;if(d.isEmpty()){const h=c.getPosition(),u=xt.right(t,i,h);d=new k(u.lineNumber,u.column,h.lineNumber,h.column)}if(d.isEmpty()){o[a]=null;continue}d.startLineNumber!==d.endLineNumber&&(r=!0),o[a]=new Nn(d,"")}return[r,o]}static isAutoClosingPairDelete(e,t,i,n,o,r,a){if(t==="never"&&i==="never"||e==="never")return!1;for(let l=0,c=r.length;l<c;l++){const d=r[l],h=d.getPosition();if(!d.isEmpty())return!1;const u=o.getLineContent(h.lineNumber);if(h.column<2||h.column>=u.length+1)return!1;const g=u.charAt(h.column-2),f=n.get(g);if(!f)return!1;if(uh(g)){if(i==="never")return!1}else if(t==="never")return!1;const m=u.charAt(h.column-1);let _=!1;for(const b of f)b.open===g&&b.close===m&&(_=!0);if(!_)return!1;if(e==="auto"){let b=!1;for(let v=0,C=a.length;v<C;v++){const y=a[v];if(h.lineNumber===y.startLineNumber&&h.column===y.startColumn){b=!0;break}}if(!b)return!1}}return!0}static _runAutoClosingPairDelete(e,t,i){const n=[];for(let o=0,r=i.length;o<r;o++){const a=i[o].getPosition(),l=new k(a.lineNumber,a.column-1,a.lineNumber,a.column+1);n[o]=new Nn(l,"")}return[!0,n]}static deleteLeft(e,t,i,n,o){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,i,n,o))return this._runAutoClosingPairDelete(t,i,n);const r=[];let a=e!==2;for(let l=0,c=n.length;l<c;l++){const d=ig.getDeleteRange(n[l],i,t);if(d.isEmpty()){r[l]=null;continue}d.startLineNumber!==d.endLineNumber&&(a=!0),r[l]=new Nn(d,"")}return[a,r]}static getDeleteRange(e,t,i){if(!e.isEmpty())return e;const n=e.getPosition();if(i.useTabStops&&n.column>1){const o=t.getLineContent(n.lineNumber),r=rs(o),a=r===-1?o.length+1:r+1;if(n.column<=a){const l=i.visibleColumnFromColumn(t,n),c=$i.prevIndentTabStop(l,i.indentSize),d=i.columnFromVisibleColumn(t,n.lineNumber,c);return new k(n.lineNumber,d,n.lineNumber,n.column)}}return k.fromPositions(ig.getPositionAfterDeleteLeft(n,t),n)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){const i=Iee(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,i+1)}else if(e.lineNumber>1){const i=e.lineNumber-1;return new P(i,t.getLineMaxColumn(i))}else return e}static cut(e,t,i){const n=[];let o=null;i.sort((r,a)=>P.compare(r.getStartPosition(),a.getEndPosition()));for(let r=0,a=i.length;r<a;r++){const l=i[r];if(l.isEmpty())if(e.emptySelectionClipboard){const c=l.getPosition();let d,h,u,g;c.lineNumber<t.getLineCount()?(d=c.lineNumber,h=1,u=c.lineNumber+1,g=1):c.lineNumber>1&&o?.endLineNumber!==c.lineNumber?(d=c.lineNumber-1,h=t.getLineMaxColumn(c.lineNumber-1),u=c.lineNumber,g=t.getLineMaxColumn(c.lineNumber)):(d=c.lineNumber,h=1,u=c.lineNumber,g=t.getLineMaxColumn(c.lineNumber));const f=new k(d,h,u,g);o=f,f.isEmpty()?n[r]=null:n[r]=new Nn(f,"")}else n[r]=null;else n[r]=new Nn(l,"")}return new js(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class vt{static _createWord(e,t,i,n,o){return{start:n,end:o,wordType:t,nextCharClass:i}}static _createIntlWord(e,t){return{start:e.index,end:e.index+e.segment.length,wordType:1,nextCharClass:t}}static _findPreviousWordOnLine(e,t,i){const n=t.getLineContent(i.lineNumber);return this._doFindPreviousWordOnLine(n,e,i)}static _doFindPreviousWordOnLine(e,t,i){let n=0;const o=t.findPrevIntlWordBeforeOrAtOffset(e,i.column-2);for(let r=i.column-2;r>=0;r--){const a=e.charCodeAt(r),l=t.get(a);if(o&&r===o.index)return this._createIntlWord(o,l);if(l===0){if(n===2)return this._createWord(e,n,l,r+1,this._findEndOfWord(e,t,n,r+1));n=1}else if(l===2){if(n===1)return this._createWord(e,n,l,r+1,this._findEndOfWord(e,t,n,r+1));n=2}else if(l===1&&n!==0)return this._createWord(e,n,l,r+1,this._findEndOfWord(e,t,n,r+1))}return n!==0?this._createWord(e,n,1,0,this._findEndOfWord(e,t,n,0)):null}static _findEndOfWord(e,t,i,n){const o=t.findNextIntlWordAtOrAfterOffset(e,n),r=e.length;for(let a=n;a<r;a++){const l=e.charCodeAt(a),c=t.get(l);if(o&&a===o.index+o.segment.length||c===1||i===1&&c===2||i===2&&c===0)return a}return r}static _findNextWordOnLine(e,t,i){const n=t.getLineContent(i.lineNumber);return this._doFindNextWordOnLine(n,e,i)}static _doFindNextWordOnLine(e,t,i){let n=0;const o=e.length,r=t.findNextIntlWordAtOrAfterOffset(e,i.column-1);for(let a=i.column-1;a<o;a++){const l=e.charCodeAt(a),c=t.get(l);if(r&&a===r.index)return this._createIntlWord(r,c);if(c===0){if(n===2)return this._createWord(e,n,c,this._findStartOfWord(e,t,n,a-1),a);n=1}else if(c===2){if(n===1)return this._createWord(e,n,c,this._findStartOfWord(e,t,n,a-1),a);n=2}else if(c===1&&n!==0)return this._createWord(e,n,c,this._findStartOfWord(e,t,n,a-1),a)}return n!==0?this._createWord(e,n,1,this._findStartOfWord(e,t,n,o-1),o):null}static _findStartOfWord(e,t,i,n){const o=t.findPrevIntlWordBeforeOrAtOffset(e,n);for(let r=n;r>=0;r--){const a=e.charCodeAt(r),l=t.get(a);if(o&&r===o.index)return r;if(l===1||i===1&&l===2||i===2&&l===0)return r+1}return 0}static moveWordLeft(e,t,i,n,o){let r=i.lineNumber,a=i.column;a===1&&r>1&&(r=r-1,a=t.getLineMaxColumn(r));let l=vt._findPreviousWordOnLine(e,t,new P(r,a));if(n===0)return new P(r,l?l.start+1:1);if(n===1)return!o&&l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=vt._findPreviousWordOnLine(e,t,new P(r,l.start+1))),new P(r,l?l.start+1:1);if(n===3){for(;l&&l.wordType===2;)l=vt._findPreviousWordOnLine(e,t,new P(r,l.start+1));return new P(r,l?l.start+1:1)}return l&&a<=l.end+1&&(l=vt._findPreviousWordOnLine(e,t,new P(r,l.start+1))),new P(r,l?l.end+1:1)}static _moveWordPartLeft(e,t){const i=t.lineNumber,n=e.getLineMaxColumn(i);if(t.column===1)return i>1?new P(i-1,e.getLineMaxColumn(i-1)):t;const o=e.getLineContent(i);for(let r=t.column-1;r>1;r--){const a=o.charCodeAt(r-2),l=o.charCodeAt(r-1);if(a===95&&l!==95)return new P(i,r);if(a===45&&l!==45)return new P(i,r);if((Td(a)||_y(a))&&gl(l))return new P(i,r);if(gl(a)&&gl(l)&&r+1<n){const c=o.charCodeAt(r);if(Td(c)||_y(c))return new P(i,r)}}return new P(i,1)}static moveWordRight(e,t,i,n){let o=i.lineNumber,r=i.column,a=!1;r===t.getLineMaxColumn(o)&&o<t.getLineCount()&&(a=!0,o=o+1,r=1);let l=vt._findNextWordOnLine(e,t,new P(o,r));if(n===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=vt._findNextWordOnLine(e,t,new P(o,l.end+1))),l?r=l.end+1:r=t.getLineMaxColumn(o);else if(n===3){for(a&&(r=0);l&&(l.wordType===2||l.start+1<=r);)l=vt._findNextWordOnLine(e,t,new P(o,l.end+1));l?r=l.start+1:r=t.getLineMaxColumn(o)}else l&&!a&&r>=l.start+1&&(l=vt._findNextWordOnLine(e,t,new P(o,l.end+1))),l?r=l.start+1:r=t.getLineMaxColumn(o);return new P(o,r)}static _moveWordPartRight(e,t){const i=t.lineNumber,n=e.getLineMaxColumn(i);if(t.column===n)return i<e.getLineCount()?new P(i+1,1):t;const o=e.getLineContent(i);for(let r=t.column+1;r<n;r++){const a=o.charCodeAt(r-2),l=o.charCodeAt(r-1);if(a!==95&&l===95)return new P(i,r);if(a!==45&&l===45)return new P(i,r);if((Td(a)||_y(a))&&gl(l))return new P(i,r);if(gl(a)&&gl(l)&&r+1<n){const c=o.charCodeAt(r);if(Td(c)||_y(c))return new P(i,r)}}return new P(i,n)}static _deleteWordLeftWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=t.column-2,o=Na(i,n);return o+1<n?new k(t.lineNumber,o+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){const i=e.wordSeparators,n=e.model,o=e.selection,r=e.whitespaceHeuristics;if(!o.isEmpty())return o;if(ig.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){const h=e.selection.getPosition();return new k(h.lineNumber,h.column-1,h.lineNumber,h.column+1)}const a=new P(o.positionLineNumber,o.positionColumn);let l=a.lineNumber,c=a.column;if(l===1&&c===1)return null;if(r){const h=this._deleteWordLeftWhitespace(n,a);if(h)return h}let d=vt._findPreviousWordOnLine(i,n,a);return t===0?d?c=d.start+1:c>1?c=1:(l--,c=n.getLineMaxColumn(l)):(d&&c<=d.end+1&&(d=vt._findPreviousWordOnLine(i,n,new P(l,d.start+1))),d?c=d.end+1:c>1?c=1:(l--,c=n.getLineMaxColumn(l))),new k(l,c,a.lineNumber,a.column)}static deleteInsideWord(e,t,i){if(!i.isEmpty())return i;const n=new P(i.positionLineNumber,i.positionColumn),o=this._deleteInsideWordWhitespace(t,n);return o||this._deleteInsideWordDetermineDeleteRange(e,t,n)}static _charAtIsWhitespace(e,t){const i=e.charCodeAt(t);return i===32||i===9}static _deleteInsideWordWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=i.length;if(n===0)return null;let o=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(i,o))return null;let r=Math.min(t.column-1,n-1);if(!this._charAtIsWhitespace(i,r))return null;for(;o>0&&this._charAtIsWhitespace(i,o-1);)o--;for(;r+1<n&&this._charAtIsWhitespace(i,r+1);)r++;return new k(t.lineNumber,o+1,t.lineNumber,r+2)}static _deleteInsideWordDetermineDeleteRange(e,t,i){const n=t.getLineContent(i.lineNumber),o=n.length;if(o===0)return i.lineNumber>1?new k(i.lineNumber-1,t.getLineMaxColumn(i.lineNumber-1),i.lineNumber,1):i.lineNumber<t.getLineCount()?new k(i.lineNumber,1,i.lineNumber+1,1):new k(i.lineNumber,1,i.lineNumber,1);const r=h=>h.start+1<=i.column&&i.column<=h.end+1,a=(h,u)=>(h=Math.min(h,i.column),u=Math.max(u,i.column),new k(i.lineNumber,h,i.lineNumber,u)),l=h=>{let u=h.start+1,g=h.end+1,f=!1;for(;g-1<o&&this._charAtIsWhitespace(n,g-1);)f=!0,g++;if(!f)for(;u>1&&this._charAtIsWhitespace(n,u-2);)u--;return a(u,g)},c=vt._findPreviousWordOnLine(e,t,i);if(c&&r(c))return l(c);const d=vt._findNextWordOnLine(e,t,i);return d&&r(d)?l(d):c&&d?a(c.end+1,d.start+1):c?a(c.start+1,c.end+1):d?a(d.start+1,d.end+1):a(1,o+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),n=vt._moveWordPartLeft(e,i);return new k(i.lineNumber,i.column,n.lineNumber,n.column)}static _findFirstNonWhitespaceChar(e,t){const i=e.length;for(let n=t;n<i;n++){const o=e.charAt(n);if(o!==" "&&o!=="	")return n}return i}static _deleteWordRightWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=t.column-1,o=this._findFirstNonWhitespaceChar(i,n);return n+1<o?new k(t.lineNumber,t.column,t.lineNumber,o+1):null}static deleteWordRight(e,t){const i=e.wordSeparators,n=e.model,o=e.selection,r=e.whitespaceHeuristics;if(!o.isEmpty())return o;const a=new P(o.positionLineNumber,o.positionColumn);let l=a.lineNumber,c=a.column;const d=n.getLineCount(),h=n.getLineMaxColumn(l);if(l===d&&c===h)return null;if(r){const g=this._deleteWordRightWhitespace(n,a);if(g)return g}let u=vt._findNextWordOnLine(i,n,a);return t===2?u?c=u.end+1:c<h||l===d?c=h:(l++,u=vt._findNextWordOnLine(i,n,new P(l,1)),u?c=u.start+1:c=n.getLineMaxColumn(l)):(u&&c>=u.start+1&&(u=vt._findNextWordOnLine(i,n,new P(l,u.end+1))),u?c=u.start+1:c<h||l===d?c=h:(l++,u=vt._findNextWordOnLine(i,n,new P(l,1)),u?c=u.start+1:c=n.getLineMaxColumn(l))),new k(l,c,a.lineNumber,a.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),n=vt._moveWordPartRight(e,i);return new k(i.lineNumber,i.column,n.lineNumber,n.column)}static _createWordAtPosition(e,t,i){const n=new k(t,i.start+1,t,i.end+1);return{word:e.getValueInRange(n),startColumn:n.startColumn,endColumn:n.endColumn}}static getWordAtPosition(e,t,i,n){const o=yr(t,i),r=vt._findPreviousWordOnLine(o,e,n);if(r&&r.wordType===1&&r.start<=n.column-1&&n.column-1<=r.end)return vt._createWordAtPosition(e,n.lineNumber,r);const a=vt._findNextWordOnLine(o,e,n);return a&&a.wordType===1&&a.start<=n.column-1&&n.column-1<=a.end?vt._createWordAtPosition(e,n.lineNumber,a):null}static word(e,t,i,n,o){const r=yr(e.wordSeparators,e.wordSegmenterLocales),a=vt._findPreviousWordOnLine(r,t,o),l=vt._findNextWordOnLine(r,t,o);if(!n){let g,f;return a&&a.wordType===1&&a.start<=o.column-1&&o.column-1<=a.end?(g=a.start+1,f=a.end+1):l&&l.wordType===1&&l.start<=o.column-1&&o.column-1<=l.end?(g=l.start+1,f=l.end+1):(a?g=a.end+1:g=1,l?f=l.start+1:f=t.getLineMaxColumn(o.lineNumber)),new _n(new k(o.lineNumber,g,o.lineNumber,f),1,0,new P(o.lineNumber,f),0)}let c,d;a&&a.wordType===1&&a.start<o.column-1&&o.column-1<a.end?(c=a.start+1,d=a.end+1):l&&l.wordType===1&&l.start<o.column-1&&o.column-1<l.end?(c=l.start+1,d=l.end+1):(c=o.column,d=o.column);const h=o.lineNumber;let u;if(i.selectionStart.containsPosition(o))u=i.selectionStart.endColumn;else if(o.isBeforeOrEqual(i.selectionStart.getStartPosition())){u=c;const g=new P(h,u);i.selectionStart.containsPosition(g)&&(u=i.selectionStart.endColumn)}else{u=d;const g=new P(h,u);i.selectionStart.containsPosition(g)&&(u=i.selectionStart.startColumn)}return i.move(!0,h,u,0)}}class Ix extends vt{static deleteWordPartLeft(e){const t=Gy([vt.deleteWordLeft(e,0),vt.deleteWordLeft(e,2),vt._deleteWordPartLeft(e.model,e.selection)]);return t.sort(k.compareRangesUsingEnds),t[2]}static deleteWordPartRight(e){const t=Gy([vt.deleteWordRight(e,0),vt.deleteWordRight(e,2),vt._deleteWordPartRight(e.model,e.selection)]);return t.sort(k.compareRangesUsingStarts),t[0]}static moveWordPartLeft(e,t,i,n){const o=Gy([vt.moveWordLeft(e,t,i,0,n),vt.moveWordLeft(e,t,i,2,n),vt._moveWordPartLeft(t,i)]);return o.sort(P.compare),o[2]}static moveWordPartRight(e,t,i){const n=Gy([vt.moveWordRight(e,t,i,0),vt.moveWordRight(e,t,i,2),vt._moveWordPartRight(t,i)]);return n.sort(P.compare),n[0]}}function Gy(s){return s.filter(e=>!!e)}class mn{static addCursorDown(e,t,i){const n=[];let o=0;for(let r=0,a=t.length;r<a;r++){const l=t[r];n[o++]=new ut(l.modelState,l.viewState),i?n[o++]=ut.fromModelState(xt.translateDown(e.cursorConfig,e.model,l.modelState)):n[o++]=ut.fromViewState(xt.translateDown(e.cursorConfig,e,l.viewState))}return n}static addCursorUp(e,t,i){const n=[];let o=0;for(let r=0,a=t.length;r<a;r++){const l=t[r];n[o++]=new ut(l.modelState,l.viewState),i?n[o++]=ut.fromModelState(xt.translateUp(e.cursorConfig,e.model,l.modelState)):n[o++]=ut.fromViewState(xt.translateUp(e.cursorConfig,e,l.viewState))}return n}static moveToBeginningOfLine(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o];n[o]=this._moveToLineStart(e,a,i)}return n}static _moveToLineStart(e,t,i){const n=t.viewState.position.column,o=t.modelState.position.column,r=n===o,a=t.viewState.position.lineNumber,l=e.getLineFirstNonWhitespaceColumn(a);return!r&&!(n===l)?this._moveToLineStartByView(e,t,i):this._moveToLineStartByModel(e,t,i)}static _moveToLineStartByView(e,t,i){return ut.fromViewState(xt.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,i))}static _moveToLineStartByModel(e,t,i){return ut.fromModelState(xt.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,i))}static moveToEndOfLine(e,t,i,n){const o=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];o[r]=this._moveToLineEnd(e,l,i,n)}return o}static _moveToLineEnd(e,t,i,n){const o=t.viewState.position,r=e.getLineMaxColumn(o.lineNumber),a=o.column===r,l=t.modelState.position,c=e.model.getLineMaxColumn(l.lineNumber),d=r-o.column===c-l.column;return a||d?this._moveToLineEndByModel(e,t,i,n):this._moveToLineEndByView(e,t,i,n)}static _moveToLineEndByView(e,t,i,n){return ut.fromViewState(xt.moveToEndOfLine(e.cursorConfig,e,t.viewState,i,n))}static _moveToLineEndByModel(e,t,i,n){return ut.fromModelState(xt.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,i,n))}static expandLineSelection(e,t){const i=[];for(let n=0,o=t.length;n<o;n++){const r=t[n],a=r.modelState.selection.startLineNumber,l=e.model.getLineCount();let c=r.modelState.selection.endLineNumber,d;c===l?d=e.model.getLineMaxColumn(l):(c++,d=1),i[n]=ut.fromModelState(new _n(new k(a,1,a,1),0,0,new P(c,d),0))}return i}static moveToBeginningOfBuffer(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o];n[o]=ut.fromModelState(xt.moveToBeginningOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return n}static moveToEndOfBuffer(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o];n[o]=ut.fromModelState(xt.moveToEndOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return n}static selectAll(e,t){const i=e.model.getLineCount(),n=e.model.getLineMaxColumn(i);return ut.fromModelState(new _n(new k(1,1,1,1),0,0,new P(i,n),0))}static line(e,t,i,n,o){const r=e.model.validatePosition(n),a=o?e.coordinatesConverter.validateViewPosition(new P(o.lineNumber,o.column),r):e.coordinatesConverter.convertModelPositionToViewPosition(r);if(!i){const c=e.model.getLineCount();let d=r.lineNumber+1,h=1;return d>c&&(d=c,h=e.model.getLineMaxColumn(d)),ut.fromModelState(new _n(new k(r.lineNumber,1,d,h),2,0,new P(d,h),0))}const l=t.modelState.selectionStart.getStartPosition().lineNumber;if(r.lineNumber<l)return ut.fromViewState(t.viewState.move(!0,a.lineNumber,1,0));if(r.lineNumber>l){const c=e.getLineCount();let d=a.lineNumber+1,h=1;return d>c&&(d=c,h=e.getLineMaxColumn(d)),ut.fromViewState(t.viewState.move(!0,d,h,0))}else{const c=t.modelState.selectionStart.getEndPosition();return ut.fromModelState(t.modelState.move(!0,c.lineNumber,c.column,0))}}static word(e,t,i,n){const o=e.model.validatePosition(n);return ut.fromModelState(vt.word(e.cursorConfig,e.model,t.modelState,i,o))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new ut(t.modelState,t.viewState);const i=t.viewState.position.lineNumber,n=t.viewState.position.column;return ut.fromViewState(new _n(new k(i,n,i,n),0,0,new P(i,n),0))}static moveTo(e,t,i,n,o){if(i){if(t.modelState.selectionStartKind===1)return this.word(e,t,i,n);if(t.modelState.selectionStartKind===2)return this.line(e,t,i,n,o)}const r=e.model.validatePosition(n),a=o?e.coordinatesConverter.validateViewPosition(new P(o.lineNumber,o.column),r):e.coordinatesConverter.convertModelPositionToViewPosition(r);return ut.fromViewState(t.viewState.move(i,a.lineNumber,a.column,0))}static simpleMove(e,t,i,n,o,r){switch(i){case 0:return r===4?this._moveHalfLineLeft(e,t,n):this._moveLeft(e,t,n,o);case 1:return r===4?this._moveHalfLineRight(e,t,n):this._moveRight(e,t,n,o);case 2:return r===2?this._moveUpByViewLines(e,t,n,o):this._moveUpByModelLines(e,t,n,o);case 3:return r===2?this._moveDownByViewLines(e,t,n,o):this._moveDownByModelLines(e,t,n,o);case 4:return r===2?t.map(a=>ut.fromViewState(xt.moveToPrevBlankLine(e.cursorConfig,e,a.viewState,n))):t.map(a=>ut.fromModelState(xt.moveToPrevBlankLine(e.cursorConfig,e.model,a.modelState,n)));case 5:return r===2?t.map(a=>ut.fromViewState(xt.moveToNextBlankLine(e.cursorConfig,e,a.viewState,n))):t.map(a=>ut.fromModelState(xt.moveToNextBlankLine(e.cursorConfig,e.model,a.modelState,n)));case 6:return this._moveToViewMinColumn(e,t,n);case 7:return this._moveToViewFirstNonWhitespaceColumn(e,t,n);case 8:return this._moveToViewCenterColumn(e,t,n);case 9:return this._moveToViewMaxColumn(e,t,n);case 10:return this._moveToViewLastNonWhitespaceColumn(e,t,n);default:return null}}static viewportMove(e,t,i,n,o){const r=e.getCompletelyVisibleViewRange(),a=e.coordinatesConverter.convertViewRangeToModelRange(r);switch(i){case 11:{const l=this._firstLineNumberInRange(e.model,a,o),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,c)]}case 13:{const l=this._lastLineNumberInRange(e.model,a,o),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,c)]}case 12:{const l=Math.round((a.startLineNumber+a.endLineNumber)/2),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,c)]}case 14:{const l=[];for(let c=0,d=t.length;c<d;c++){const h=t[c];l[c]=this.findPositionInViewportIfOutside(e,h,r,n)}return l}default:return null}}static findPositionInViewportIfOutside(e,t,i,n){const o=t.viewState.position.lineNumber;if(i.startLineNumber<=o&&o<=i.endLineNumber-1)return new ut(t.modelState,t.viewState);{let r;o>i.endLineNumber-1?r=i.endLineNumber-1:o<i.startLineNumber?r=i.startLineNumber:r=o;const a=xt.vertical(e.cursorConfig,e,o,t.viewState.position.column,t.viewState.leftoverVisibleColumns,r,!1);return ut.fromViewState(t.viewState.move(n,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,i){let n=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(n)&&n++,Math.min(t.endLineNumber,n+i-1)}static _lastLineNumberInRange(e,t,i){let n=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(n)&&n++,Math.max(n,t.endLineNumber-i+1)}static _moveLeft(e,t,i,n){return t.map(o=>ut.fromViewState(xt.moveLeft(e.cursorConfig,e,o.viewState,i,n)))}static _moveHalfLineLeft(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=Math.round(e.getLineLength(l)/2);n[o]=ut.fromViewState(xt.moveLeft(e.cursorConfig,e,a.viewState,i,c))}return n}static _moveRight(e,t,i,n){return t.map(o=>ut.fromViewState(xt.moveRight(e.cursorConfig,e,o.viewState,i,n)))}static _moveHalfLineRight(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=Math.round(e.getLineLength(l)/2);n[o]=ut.fromViewState(xt.moveRight(e.cursorConfig,e,a.viewState,i,c))}return n}static _moveDownByViewLines(e,t,i,n){const o=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];o[r]=ut.fromViewState(xt.moveDown(e.cursorConfig,e,l.viewState,i,n))}return o}static _moveDownByModelLines(e,t,i,n){const o=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];o[r]=ut.fromModelState(xt.moveDown(e.cursorConfig,e.model,l.modelState,i,n))}return o}static _moveUpByViewLines(e,t,i,n){const o=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];o[r]=ut.fromViewState(xt.moveUp(e.cursorConfig,e,l.viewState,i,n))}return o}static _moveUpByModelLines(e,t,i,n){const o=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];o[r]=ut.fromModelState(xt.moveUp(e.cursorConfig,e.model,l.modelState,i,n))}return o}static _moveToViewPosition(e,t,i,n,o){return ut.fromViewState(t.viewState.move(i,n,o,0))}static _moveToModelPosition(e,t,i,n,o){return ut.fromModelState(t.modelState.move(i,n,o,0))}static _moveToViewMinColumn(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=e.getLineMinColumn(l);n[o]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewFirstNonWhitespaceColumn(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=e.getLineFirstNonWhitespaceColumn(l);n[o]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewCenterColumn(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=Math.round((e.getLineMaxColumn(l)+e.getLineMinColumn(l))/2);n[o]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewMaxColumn(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=e.getLineMaxColumn(l);n[o]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewLastNonWhitespaceColumn(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=e.getLineLastNonWhitespaceColumn(l);n[o]=this._moveToViewPosition(e,a,i,l,c)}return n}}var aS;(function(s){const e=function(i){if(!dn(i))return!1;const n=i;return!(!zs(n.to)||!ns(n.select)&&!qH(n.select)||!ns(n.by)&&!zs(n.by)||!ns(n.value)&&!Jd(n.value))};s.metadata={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
				`,constraint:e,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},s.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},s.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function t(i){if(!i.to)return null;let n;switch(i.to){case s.RawDirection.Left:n=0;break;case s.RawDirection.Right:n=1;break;case s.RawDirection.Up:n=2;break;case s.RawDirection.Down:n=3;break;case s.RawDirection.PrevBlankLine:n=4;break;case s.RawDirection.NextBlankLine:n=5;break;case s.RawDirection.WrappedLineStart:n=6;break;case s.RawDirection.WrappedLineFirstNonWhitespaceCharacter:n=7;break;case s.RawDirection.WrappedLineColumnCenter:n=8;break;case s.RawDirection.WrappedLineEnd:n=9;break;case s.RawDirection.WrappedLineLastNonWhitespaceCharacter:n=10;break;case s.RawDirection.ViewPortTop:n=11;break;case s.RawDirection.ViewPortBottom:n=13;break;case s.RawDirection.ViewPortCenter:n=12;break;case s.RawDirection.ViewPortIfOutside:n=14;break;default:return null}let o=0;switch(i.by){case s.RawUnit.Line:o=1;break;case s.RawUnit.WrappedLine:o=2;break;case s.RawUnit.Character:o=3;break;case s.RawUnit.HalfLine:o=4;break}return{direction:n,unit:o,select:!!i.select,value:i.value||1}}s.parse=t})(aS||(aS={}));class qO{constructor(e,t,i){this._indentRulesSupport=t,this._indentationLineProcessor=new j$(e,i)}shouldIncrease(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIncrease(i)}shouldDecrease(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldDecrease(i)}shouldIgnore(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIgnore(i)}shouldIndentNextLine(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIndentNextLine(i)}}class GO{constructor(e,t){this.model=e,this.indentationLineProcessor=new j$(e,t)}getProcessedTokenContextAroundRange(e){const t=this._getProcessedTokensBeforeRange(e),i=this._getProcessedTokensAfterRange(e),n=this._getProcessedPreviousLineTokens(e);return{beforeRangeProcessedTokens:t,afterRangeProcessedTokens:i,previousLineProcessedTokens:n}}_getProcessedTokensBeforeRange(e){this.model.tokenization.forceTokenization(e.startLineNumber);const t=this.model.tokenization.getLineTokens(e.startLineNumber),i=bu(t,e.startColumn-1);let n;if(YO(this.model,e.getStartPosition())){const r=e.startColumn-1-i.firstCharOffset,a=i.firstCharOffset,l=a+r;n=t.sliceAndInflate(a,l,0)}else{const r=e.startColumn-1;n=t.sliceAndInflate(0,r,0)}return this.indentationLineProcessor.getProcessedTokens(n)}_getProcessedTokensAfterRange(e){const t=e.isEmpty()?e.getStartPosition():e.getEndPosition();this.model.tokenization.forceTokenization(t.lineNumber);const i=this.model.tokenization.getLineTokens(t.lineNumber),n=bu(i,t.column-1),o=t.column-1-n.firstCharOffset,r=n.firstCharOffset+o,a=n.firstCharOffset+n.getLineLength(),l=i.sliceAndInflate(r,a,0);return this.indentationLineProcessor.getProcessedTokens(l)}_getProcessedPreviousLineTokens(e){const t=g=>{this.model.tokenization.forceTokenization(g);const f=this.model.tokenization.getLineTokens(g),m=this.model.getLineMaxColumn(g)-1;return bu(f,m)};this.model.tokenization.forceTokenization(e.startLineNumber);const i=this.model.tokenization.getLineTokens(e.startLineNumber),n=bu(i,e.startColumn-1),o=Pi.createEmpty("",n.languageIdCodec),r=e.startLineNumber-1;if(r===0||!(n.firstCharOffset===0))return o;const c=t(r);if(!(n.languageId===c.languageId))return o;const h=c.toIViewLineTokens();return this.indentationLineProcessor.getProcessedTokens(h)}}class j${constructor(e,t){this.model=e,this.languageConfigurationService=t}getProcessedLine(e,t){const i=(r,a)=>{const l=Mt(r);return a+r.substring(l.length)};this.model.tokenization.forceTokenization?.(e);const n=this.model.tokenization.getLineTokens(e);let o=this.getProcessedTokens(n).getLineContent();return t!==void 0&&(o=i(o,t)),o}getProcessedTokens(e){const t=l=>l===2||l===3||l===1,i=e.getLanguageId(0),o=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew.getBracketRegExp({global:!0}),r=[];return e.forEach(l=>{const c=e.getStandardTokenType(l);let d=e.getTokenText(l);t(c)&&(d=d.replace(o,""));const h=e.getMetadata(l);r.push({text:d,metadata:h})}),Pi.createFromTextAndMetadata(r,e.languageIdCodec)}}function YO(s,e){s.tokenization.forceTokenization(e.lineNumber);const t=s.tokenization.getLineTokens(e.lineNumber),i=bu(t,e.column-1),n=i.firstCharOffset===0,o=t.getLanguageId(0)===i.languageId;return!n&&!o}function cp(s,e,t,i){e.tokenization.forceTokenization(t.startLineNumber);const n=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),o=i.getLanguageConfiguration(n);if(!o)return null;const a=new GO(e,i).getProcessedTokenContextAroundRange(t),l=a.previousLineProcessedTokens.getLineContent(),c=a.beforeRangeProcessedTokens.getLineContent(),d=a.afterRangeProcessedTokens.getLineContent(),h=o.onEnter(s,l,c,d);if(!h)return null;const u=h.indentAction;let g=h.appendText;const f=h.removeText||0;g?u===Wi.Indent&&(g="	"+g):u===Wi.Indent||u===Wi.IndentOutdent?g="	":g="";let m=kV(e,t.startLineNumber,t.startColumn);return f&&(m=m.substring(0,m.length-f)),{indentAction:u,appendText:g,removeText:f,indentation:m}}var f_e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},p_e=function(s,e){return function(t,i){e(t,i,s)}},t1;const KD=Object.create(null);function Bh(s,e){if(e<=0)return"";KD[s]||(KD[s]=["",s]);const t=KD[s];for(let i=t.length;i<=e;i++)t[i]=t[i-1]+s;return t[e]}let Sr=t1=class{static unshiftIndent(e,t,i,n,o){const r=$i.visibleColumnFromColumn(e,t,i);if(o){const a=Bh(" ",n),c=$i.prevIndentTabStop(r,n)/n;return Bh(a,c)}else{const a="	",c=$i.prevRenderTabStop(r,i)/i;return Bh(a,c)}}static shiftIndent(e,t,i,n,o){const r=$i.visibleColumnFromColumn(e,t,i);if(o){const a=Bh(" ",n),c=$i.nextIndentTabStop(r,n)/n;return Bh(a,c)}else{const a="	",c=$i.nextRenderTabStop(r,i)/i;return Bh(a,c)}}constructor(e,t,i){this._languageConfigurationService=i,this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}_addEditOperation(e,t,i){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,i):e.addEditOperation(t,i)}getEditOperations(e,t){const i=this._selection.startLineNumber;let n=this._selection.endLineNumber;this._selection.endColumn===1&&i!==n&&(n=n-1);const{tabSize:o,indentSize:r,insertSpaces:a}=this._opts,l=i===n;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(i))&&(this._useLastEditRangeForCursorEndPosition=!0);let c=0,d=0;for(let h=i;h<=n;h++,c=d){d=0;const u=e.getLineContent(h);let g=rs(u);if(this._opts.isUnshift&&(u.length===0||g===0)||!l&&!this._opts.isUnshift&&u.length===0)continue;if(g===-1&&(g=u.length),h>1&&$i.visibleColumnFromColumn(u,g+1,o)%r!==0&&e.tokenization.isCheapToTokenize(h-1)){const _=cp(this._opts.autoIndent,e,new k(h-1,e.getLineMaxColumn(h-1),h-1,e.getLineMaxColumn(h-1)),this._languageConfigurationService);if(_){if(d=c,_.appendText)for(let b=0,v=_.appendText.length;b<v&&d<r&&_.appendText.charCodeAt(b)===32;b++)d++;_.removeText&&(d=Math.max(0,d-_.removeText));for(let b=0;b<d&&!(g===0||u.charCodeAt(g-1)!==32);b++)g--}}if(this._opts.isUnshift&&g===0)continue;let f;this._opts.isUnshift?f=t1.unshiftIndent(u,g+1,o,r,a):f=t1.shiftIndent(u,g+1,o,r,a),this._addEditOperation(t,new k(h,1,h,g+1),f),h===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=g+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&e.getLineLength(i)===0&&(this._useLastEditRangeForCursorEndPosition=!0);const c=a?Bh(" ",r):"	";for(let d=i;d<=n;d++){const h=e.getLineContent(d);let u=rs(h);if(!(this._opts.isUnshift&&(h.length===0||u===0))&&!(!l&&!this._opts.isUnshift&&h.length===0)&&(u===-1&&(u=h.length),!(this._opts.isUnshift&&u===0)))if(this._opts.isUnshift){u=Math.min(u,r);for(let g=0;g<u;g++)if(h.charCodeAt(g)===9){u=g+1;break}this._addEditOperation(t,new k(d,1,d,u+1),"")}else this._addEditOperation(t,new k(d,1,d,1),c),d===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){const n=t.getInverseEditOperations()[0];return new me(n.range.endLineNumber,n.range.endColumn,n.range.endLineNumber,n.range.endColumn)}const i=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){const n=this._selection.startColumn;return i.startColumn<=n?i:i.getDirection()===0?new me(i.startLineNumber,n,i.endLineNumber,i.endColumn):new me(i.endLineNumber,i.endColumn,i.startLineNumber,n)}return i}};Sr=t1=f_e([p_e(2,di)],Sr);class m_e{constructor(e,t,i){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=i}getEditOperations(e,t){t.addTrackedEditOperation(new k(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new k(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(e,t){const i=t.getInverseEditOperations(),n=i[0].range,o=i[1].range;return new me(n.endLineNumber,n.endColumn,o.endLineNumber,o.endColumn-this._charAfterSelection.length)}}class __e{constructor(e,t,i){this._position=e,this._text=t,this._charAfter=i}getEditOperations(e,t){t.addTrackedEditOperation(new k(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return new me(n.endLineNumber,n.startColumn,n.endLineNumber,n.endColumn-this._charAfter.length)}}function b_e(s,e,t){const i=s.tokenization.getLanguageIdAtPosition(e,0);if(e>1){let n,o=-1;for(n=e-1;n>=1;n--){if(s.tokenization.getLanguageIdAtPosition(n,0)!==i)return o;const r=s.getLineContent(n);if(t.shouldIgnore(n)||/^\s+$/.test(r)||r===""){o=n;continue}return n}}return-1}function Rv(s,e,t,i=!0,n){if(s<4)return null;const o=n.getLanguageConfiguration(e.tokenization.getLanguageId()).indentRulesSupport;if(!o)return null;const r=new qO(e,o,n);if(t<=1)return{indentation:"",action:null};for(let l=t-1;l>0&&e.getLineContent(l)==="";l--)if(l===1)return{indentation:"",action:null};const a=b_e(e,t,r);if(a<0)return null;if(a<1)return{indentation:"",action:null};if(r.shouldIncrease(a)||r.shouldIndentNextLine(a)){const l=e.getLineContent(a);return{indentation:Mt(l),action:Wi.Indent,line:a}}else if(r.shouldDecrease(a)){const l=e.getLineContent(a);return{indentation:Mt(l),action:null,line:a}}else{if(a===1)return{indentation:Mt(e.getLineContent(a)),action:null,line:a};const l=a-1,c=o.getIndentMetadata(e.getLineContent(l));if(!(c&3)&&c&4){let d=0;for(let h=l-1;h>0;h--)if(!r.shouldIndentNextLine(h)){d=h;break}return{indentation:Mt(e.getLineContent(d+1)),action:null,line:d+1}}if(i)return{indentation:Mt(e.getLineContent(a)),action:null,line:a};for(let d=a;d>0;d--){if(r.shouldIncrease(d))return{indentation:Mt(e.getLineContent(d)),action:Wi.Indent,line:d};if(r.shouldIndentNextLine(d)){let h=0;for(let u=d-1;u>0;u--)if(!r.shouldIndentNextLine(d)){h=u;break}return{indentation:Mt(e.getLineContent(h+1)),action:null,line:h+1}}else if(r.shouldDecrease(d))return{indentation:Mt(e.getLineContent(d)),action:null,line:d}}return{indentation:Mt(e.getLineContent(1)),action:null,line:1}}}function ub(s,e,t,i,n,o){if(s<4)return null;const r=o.getLanguageConfiguration(t);if(!r)return null;const a=o.getLanguageConfiguration(t).indentRulesSupport;if(!a)return null;const l=new qO(e,a,o),c=Rv(s,e,i,void 0,o);if(c){const d=c.line;if(d!==void 0){let h=!0;for(let u=d;u<i-1;u++)if(!/^\s*$/.test(e.getLineContent(u))){h=!1;break}if(h){const u=r.onEnter(s,"",e.getLineContent(d),"");if(u){let g=Mt(e.getLineContent(d));return u.removeText&&(g=g.substring(0,g.length-u.removeText)),u.indentAction===Wi.Indent||u.indentAction===Wi.IndentOutdent?g=n.shiftIndent(g):u.indentAction===Wi.Outdent&&(g=n.unshiftIndent(g)),l.shouldDecrease(i)&&(g=n.unshiftIndent(g)),u.appendText&&(g+=u.appendText),Mt(g)}}}return l.shouldDecrease(i)?c.action===Wi.Indent?c.indentation:n.unshiftIndent(c.indentation):c.action===Wi.Indent?n.shiftIndent(c.indentation):c.indentation}return null}function v_e(s,e,t,i,n){if(s<4)return null;const o=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),r=n.getLanguageConfiguration(o).indentRulesSupport;if(!r)return null;e.tokenization.forceTokenization(t.startLineNumber);const l=new GO(e,n).getProcessedTokenContextAroundRange(t),c=l.afterRangeProcessedTokens,d=l.beforeRangeProcessedTokens,h=Mt(d.getLineContent()),u=y_e(e,t.startLineNumber,d),g=YO(e,t.getStartPosition()),f=e.getLineContent(t.startLineNumber),m=Mt(f),_=Rv(s,u,t.startLineNumber+1,void 0,n);if(!_){const v=g?m:h;return{beforeEnter:v,afterEnter:v}}let b=g?m:_.indentation;return _.action===Wi.Indent&&(b=i.shiftIndent(b)),r.shouldDecrease(c.getLineContent())&&(b=i.unshiftIndent(b)),{beforeEnter:g?m:h,afterEnter:b}}function C_e(s,e,t,i,n,o){const r=s.autoIndent;if(r<4||YO(e,t.getStartPosition()))return null;const l=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),c=o.getLanguageConfiguration(l).indentRulesSupport;if(!c)return null;const h=new GO(e,o).getProcessedTokenContextAroundRange(t),u=h.beforeRangeProcessedTokens.getLineContent(),g=h.afterRangeProcessedTokens.getLineContent(),f=u+g,m=u+i+g;if(!c.shouldDecrease(f)&&c.shouldDecrease(m)){const b=Rv(r,e,t.startLineNumber,!1,o);if(!b)return null;let v=b.indentation;return b.action!==Wi.Indent&&(v=n.unshiftIndent(v)),v}const _=t.startLineNumber-1;if(_>0){const b=e.getLineContent(_);if(c.shouldIndentNextLine(b)&&c.shouldIncrease(m)){const C=Rv(r,e,t.startLineNumber,!1,o)?.indentation;if(C!==void 0){const y=e.getLineContent(t.startLineNumber),w=Mt(y),L=n.shiftIndent(C)===w,D=/^\s*$/.test(f),T=s.autoClosingPairs.autoClosingPairsOpenByEnd.get(i),W=T&&T.length>0&&D;if(L&&W)return C}}}return null}function Z$(s,e,t){const i=t.getLanguageConfiguration(s.getLanguageId()).indentRulesSupport;return!i||e<1||e>s.getLineCount()?null:i.getIndentMetadata(s.getLineContent(e))}function y_e(s,e,t){return{tokenization:{getLineTokens:n=>n===e?t:s.tokenization.getLineTokens(n),getLanguageId:()=>s.getLanguageId(),getLanguageIdAtPosition:(n,o)=>s.getLanguageIdAtPosition(n,o)},getLineContent:n=>n===e?t.getLineContent():s.getLineContent(n)}}class w_e{static getEdits(e,t,i,n,o){if(!o&&this._isAutoIndentType(e,t,i)){const r=[];for(const l of i){const c=this._findActualIndentationForSelection(e,t,l,n);if(c===null)return;r.push({selection:l,indentation:c})}const a=CR.getAutoClosingPairClose(e,t,i,n,!1);return this._getIndentationAndAutoClosingPairEdits(e,t,r,n,a)}}static _isAutoIndentType(e,t,i){if(e.autoIndent<4)return!1;for(let n=0,o=i.length;n<o;n++)if(!t.tokenization.isCheapToTokenize(i[n].getEndPosition().lineNumber))return!1;return!0}static _findActualIndentationForSelection(e,t,i,n){const o=C_e(e,t,i,n,{shiftIndent:a=>JO(e,a),unshiftIndent:a=>lS(e,a)},e.languageConfigurationService);if(o===null)return null;const r=kV(t,i.startLineNumber,i.startColumn);return o===e.normalizeIndentation(r)?null:o}static _getIndentationAndAutoClosingPairEdits(e,t,i,n,o){const r=i.map(({selection:l,indentation:c})=>{if(o!==null){const d=this._getEditFromIndentationAndSelection(e,t,c,l,n,!1);return new M_e(d,l,n,o)}else{const d=this._getEditFromIndentationAndSelection(e,t,c,l,n,!0);return Yh(d.range,d.text,!1)}}),a={shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1};return new js(4,r,a)}static _getEditFromIndentationAndSelection(e,t,i,n,o,r=!0){const a=n.startLineNumber,l=t.getLineFirstNonWhitespaceColumn(a);let c=e.normalizeIndentation(i);if(l!==0){const h=t.getLineContent(a);c+=h.substring(l-1,n.startColumn-1)}return c+=r?o:"",{range:new k(a,1,n.endLineNumber,n.endColumn),text:c}}}class S_e{static getEdits(e,t,i,n,o,r){if(K$(t,i,n,o,r))return this._runAutoClosingOvertype(e,n,r)}static _runAutoClosingOvertype(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const l=t[o].getPosition(),c=new k(l.lineNumber,l.column,l.lineNumber,l.column+1);n[o]=new Nn(c,i)}return new js(4,n,{shouldPushStackElementBefore:Ex(e,4),shouldPushStackElementAfter:!1})}}class L_e{static getEdits(e,t,i,n,o){if(K$(e,t,i,n,o)){const r=i.map(a=>new Nn(new k(a.positionLineNumber,a.positionColumn,a.positionLineNumber,a.positionColumn+1),"",!1));return new js(4,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}}class CR{static getEdits(e,t,i,n,o,r){if(!r){const a=this.getAutoClosingPairClose(e,t,i,n,o);if(a!==null)return this._runAutoClosingOpenCharType(i,n,o,a)}}static _runAutoClosingOpenCharType(e,t,i,n){const o=[];for(let r=0,a=e.length;r<a;r++){const l=e[r];o[r]=new R_e(l,t,!i,n)}return new js(4,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static getAutoClosingPairClose(e,t,i,n,o){for(const f of i)if(!f.isEmpty())return null;const r=i.map(f=>{const m=f.getPosition();return o?{lineNumber:m.lineNumber,beforeColumn:m.column-n.length,afterColumn:m.column}:{lineNumber:m.lineNumber,beforeColumn:m.column,afterColumn:m.column}}),a=this._findAutoClosingPairOpen(e,t,r.map(f=>new P(f.lineNumber,f.beforeColumn)),n);if(!a)return null;let l,c;if(uh(n)?(l=e.autoClosingQuotes,c=e.shouldAutoCloseBefore.quote):(e.blockCommentStartToken?a.open.includes(e.blockCommentStartToken):!1)?(l=e.autoClosingComments,c=e.shouldAutoCloseBefore.comment):(l=e.autoClosingBrackets,c=e.shouldAutoCloseBefore.bracket),l==="never")return null;const h=this._findContainedAutoClosingPair(e,a),u=h?h.close:"";let g=!0;for(const f of r){const{lineNumber:m,beforeColumn:_,afterColumn:b}=f,v=t.getLineContent(m),C=v.substring(0,_-1),y=v.substring(b-1);if(y.startsWith(u)||(g=!1),y.length>0){const D=y.charAt(0);if(!this._isBeforeClosingBrace(e,y)&&!c(D))return null}if(a.open.length===1&&(n==="'"||n==='"')&&l!=="always"){const D=yr(e.wordSeparators,[]);if(C.length>0){const T=C.charCodeAt(C.length-1);if(D.get(T)===0)return null}}if(!t.tokenization.isCheapToTokenize(m))return null;t.tokenization.forceTokenization(m);const w=t.tokenization.getLineTokens(m),x=bu(w,_-1);if(!a.shouldAutoClose(x,_-x.firstCharOffset))return null;const L=a.findNeutralCharacter();if(L){const D=t.tokenization.getTokenTypeIfInsertingCharacter(m,_,L);if(!a.isOK(D))return null}}return g?a.close.substring(0,a.close.length-u.length):a.close}static _findContainedAutoClosingPair(e,t){if(t.open.length<=1)return null;const i=t.close.charAt(t.close.length-1),n=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(i)||[];let o=null;for(const r of n)r.open!==t.open&&t.open.includes(r.open)&&t.close.endsWith(r.close)&&(!o||r.open.length>o.open.length)&&(o=r);return o}static _findAutoClosingPairOpen(e,t,i,n){const o=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(n);if(!o)return null;let r=null;for(const a of o)if(r===null||a.open.length>r.open.length){let l=!0;for(const c of i)if(t.getValueInRange(new k(c.lineNumber,c.column-a.open.length+1,c.lineNumber,c.column))+n!==a.open){l=!1;break}l&&(r=a)}return r}static _isBeforeClosingBrace(e,t){const i=t.charAt(0),n=e.autoClosingPairs.autoClosingPairsOpenByStart.get(i)||[],o=e.autoClosingPairs.autoClosingPairsCloseByStart.get(i)||[],r=n.some(l=>t.startsWith(l.open)),a=o.some(l=>t.startsWith(l.close));return!r&&a}}class x_e{static getEdits(e,t,i,n,o){if(!o&&this._isSurroundSelectionType(e,t,i,n))return this._runSurroundSelectionType(e,i,n)}static _runSurroundSelectionType(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=e.surroundingPairs[i];n[o]=new m_e(a,i,l)}return new js(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isSurroundSelectionType(e,t,i,n){if(!q$(e,n)||!e.surroundingPairs.hasOwnProperty(n))return!1;const o=uh(n);for(const r of i){if(r.isEmpty())return!1;let a=!0;for(let l=r.startLineNumber;l<=r.endLineNumber;l++){const c=t.getLineContent(l),d=l===r.startLineNumber?r.startColumn-1:0,h=l===r.endLineNumber?r.endColumn-1:c.length,u=c.substring(d,h);if(/[^ \t]/.test(u)){a=!1;break}}if(a)return!1;if(o&&r.startLineNumber===r.endLineNumber&&r.startColumn+1===r.endColumn){const l=t.getValueInRange(r);if(uh(l))return!1}}return!0}}class k_e{static getEdits(e,t,i,n,o,r){if(!r&&this._isTypeInterceptorElectricChar(t,i,n)){const a=this._typeInterceptorElectricChar(e,t,i,n[0],o);if(a)return a}}static _isTypeInterceptorElectricChar(e,t,i){return!!(i.length===1&&t.tokenization.isCheapToTokenize(i[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,i,n,o){if(!t.electricChars.hasOwnProperty(o)||!n.isEmpty())return null;const r=n.getPosition();i.tokenization.forceTokenization(r.lineNumber);const a=i.tokenization.getLineTokens(r.lineNumber);let l;try{l=t.onElectricCharacter(o,a,r.column)}catch(c){return Oe(c),null}if(!l)return null;if(l.matchOpenBracket){const c=(a.getLineContent()+o).lastIndexOf(l.matchOpenBracket)+1,d=i.bracketPairs.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:r.lineNumber,column:c},500);if(d){if(d.startLineNumber===r.lineNumber)return null;const h=i.getLineContent(d.startLineNumber),u=Mt(h),g=t.normalizeIndentation(u),f=i.getLineContent(r.lineNumber),m=i.getLineFirstNonWhitespaceColumn(r.lineNumber)||r.column,_=f.substring(m-1,r.column-1),b=g+_+o,v=new k(r.lineNumber,1,r.lineNumber,r.column),C=new Nn(v,b);return new js(QO(b,e),[C],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}}class D_e{static getEdits(e,t,i){const n=[];for(let r=0,a=t.length;r<a;r++)n[r]=new Nn(t[r],i);const o=QO(i,e);return new js(o,n,{shouldPushStackElementBefore:Ex(e,o),shouldPushStackElementAfter:!1})}}class Tx{static getEdits(e,t,i,n,o){if(!o&&n===`
`){const r=[];for(let a=0,l=i.length;a<l;a++)r[a]=this._enter(e,t,!1,i[a]);return new js(4,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}static _enter(e,t,i,n){if(e.autoIndent===0)return Yh(n,`
`,i);if(!t.tokenization.isCheapToTokenize(n.getStartPosition().lineNumber)||e.autoIndent===1){const l=t.getLineContent(n.startLineNumber),c=Mt(l).substring(0,n.startColumn-1);return Yh(n,`
`+e.normalizeIndentation(c),i)}const o=cp(e.autoIndent,t,n,e.languageConfigurationService);if(o){if(o.indentAction===Wi.None)return Yh(n,`
`+e.normalizeIndentation(o.indentation+o.appendText),i);if(o.indentAction===Wi.Indent)return Yh(n,`
`+e.normalizeIndentation(o.indentation+o.appendText),i);if(o.indentAction===Wi.IndentOutdent){const l=e.normalizeIndentation(o.indentation),c=e.normalizeIndentation(o.indentation+o.appendText),d=`
`+c+`
`+l;return i?new e1(n,d,!0):new rS(n,d,-1,c.length-l.length,!0)}else if(o.indentAction===Wi.Outdent){const l=lS(e,o.indentation);return Yh(n,`
`+e.normalizeIndentation(l+o.appendText),i)}}const r=t.getLineContent(n.startLineNumber),a=Mt(r).substring(0,n.startColumn-1);if(e.autoIndent>=4){const l=v_e(e.autoIndent,t,n,{unshiftIndent:c=>lS(e,c),shiftIndent:c=>JO(e,c),normalizeIndentation:c=>e.normalizeIndentation(c)},e.languageConfigurationService);if(l){let c=e.visibleColumnFromColumn(t,n.getEndPosition());const d=n.endColumn,h=t.getLineContent(n.endLineNumber),u=rs(h);if(u>=0?n=n.setEndPosition(n.endLineNumber,Math.max(n.endColumn,u+1)):n=n.setEndPosition(n.endLineNumber,t.getLineMaxColumn(n.endLineNumber)),i)return new e1(n,`
`+e.normalizeIndentation(l.afterEnter),!0);{let g=0;return d<=u+1&&(e.insertSpaces||(c=Math.ceil(c/e.indentSize)),g=Math.min(c+1-e.normalizeIndentation(l.afterEnter).length-1,0)),new rS(n,`
`+e.normalizeIndentation(l.afterEnter),0,g,!0)}}}return Yh(n,`
`+e.normalizeIndentation(a),i)}static lineInsertBefore(e,t,i){if(t===null||i===null)return[];const n=[];for(let o=0,r=i.length;o<r;o++){let a=i[o].positionLineNumber;if(a===1)n[o]=new e1(new k(1,1,1,1),`
`);else{a--;const l=t.getLineMaxColumn(a);n[o]=this._enter(e,t,!1,new k(a,l,a,l))}}return n}static lineInsertAfter(e,t,i){if(t===null||i===null)return[];const n=[];for(let o=0,r=i.length;o<r;o++){const a=i[o].positionLineNumber,l=t.getLineMaxColumn(a);n[o]=this._enter(e,t,!1,new k(a,l,a,l))}return n}static lineBreakInsert(e,t,i){const n=[];for(let o=0,r=i.length;o<r;o++)n[o]=this._enter(e,t,!0,i[o]);return n}}class I_e{static getEdits(e,t,i,n,o,r){const a=this._distributePasteToCursors(e,i,n,o,r);return a?(i=i.sort(k.compareRangesUsingStarts),this._distributedPaste(e,t,i,a)):this._simplePaste(e,t,i,n,o)}static _distributePasteToCursors(e,t,i,n,o){if(n||t.length===1)return null;if(o&&o.length===t.length)return o;if(e.multiCursorPaste==="spread"){i.charCodeAt(i.length-1)===10&&(i=i.substring(0,i.length-1)),i.charCodeAt(i.length-1)===13&&(i=i.substring(0,i.length-1));const r=Fl(i);if(r.length===t.length)return r}return null}static _distributedPaste(e,t,i,n){const o=[];for(let r=0,a=i.length;r<a;r++)o[r]=new Nn(i[r],n[r]);return new js(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,i,n,o){const r=[];for(let a=0,l=i.length;a<l;a++){const c=i[a],d=c.getPosition();if(o&&!c.isEmpty()&&(o=!1),o&&n.indexOf(`
`)!==n.length-1&&(o=!1),o){const h=new k(d.lineNumber,1,d.lineNumber,1);r[a]=new KO(h,n,c,!0)}else r[a]=new Nn(c,n)}return new js(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class T_e{static getEdits(e,t,i,n,o,r,a,l){const c=n.map(d=>this._compositionType(i,d,o,r,a,l));return new js(4,c,{shouldPushStackElementBefore:Ex(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,i,n,o,r){if(!t.isEmpty())return null;const a=t.getPosition(),l=Math.max(1,a.column-n),c=Math.min(e.getLineMaxColumn(a.lineNumber),a.column+o),d=new k(a.lineNumber,l,a.lineNumber,c);return e.getValueInRange(d)===i&&r===0?null:new rS(d,i,0,r)}}class E_e{static getEdits(e,t,i){const n=[];for(let r=0,a=t.length;r<a;r++)n[r]=new Nn(t[r],i);const o=QO(i,e);return new js(o,n,{shouldPushStackElementBefore:Ex(e,o),shouldPushStackElementAfter:!1})}}class N_e{static getCommands(e,t,i){const n=[];for(let o=0,r=i.length;o<r;o++){const a=i[o];if(a.isEmpty()){const l=t.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&t.tokenization.isCheapToTokenize(a.startLineNumber)){let c=this._goodIndentForLine(e,t,a.startLineNumber);c=c||"	";const d=e.normalizeIndentation(c);if(!l.startsWith(d)){n[o]=new Nn(new k(a.startLineNumber,1,a.startLineNumber,l.length+1),d,!0);continue}}n[o]=this._replaceJumpToNextIndent(e,t,a,!0)}else{if(a.startLineNumber===a.endLineNumber){const l=t.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){n[o]=this._replaceJumpToNextIndent(e,t,a,!1);continue}}n[o]=new Sr(a,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService)}}return n}static _goodIndentForLine(e,t,i){let n=null,o="";const r=Rv(e.autoIndent,t,i,!1,e.languageConfigurationService);if(r)n=r.action,o=r.indentation;else if(i>1){let a;for(a=i-1;a>=1;a--){const d=t.getLineContent(a);if(Na(d)>=0)break}if(a<1)return null;const l=t.getLineMaxColumn(a),c=cp(e.autoIndent,t,new k(a,l,a,l),e.languageConfigurationService);c&&(o=c.indentation+c.appendText)}return n&&(n===Wi.Indent&&(o=JO(e,o)),n===Wi.Outdent&&(o=lS(e,o)),o=e.normalizeIndentation(o)),o||null}static _replaceJumpToNextIndent(e,t,i,n){let o="";const r=i.getStartPosition();if(e.insertSpaces){const a=e.visibleColumnFromColumn(t,r),l=e.indentSize,c=l-a%l;for(let d=0;d<c;d++)o+=" "}else o="	";return new Nn(i,o,n)}}class XO extends rS{constructor(e,t,i,n,o,r){super(e,t,i,n),this._openCharacter=o,this._closeCharacter=r,this.closeCharacterRange=null,this.enclosingRange=null}_computeCursorStateWithRange(e,t,i){return this.closeCharacterRange=new k(t.startLineNumber,t.endColumn-this._closeCharacter.length,t.endLineNumber,t.endColumn),this.enclosingRange=new k(t.startLineNumber,t.endColumn-this._openCharacter.length-this._closeCharacter.length,t.endLineNumber,t.endColumn),super.computeCursorState(e,i)}}class R_e extends XO{constructor(e,t,i,n){const o=(i?t:"")+n,r=0,a=-n.length;super(e,o,r,a,t,n)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return this._computeCursorStateWithRange(e,n,t)}}class M_e extends XO{constructor(e,t,i,n){const o=i+n,r=0,a=i.length;super(t,o,r,a,i,n),this._autoIndentationEdit=e,this._autoClosingEdit={range:t,text:o}}getEditOperations(e,t){t.addTrackedEditOperation(this._autoIndentationEdit.range,this._autoIndentationEdit.text),t.addTrackedEditOperation(this._autoClosingEdit.range,this._autoClosingEdit.text)}computeCursorState(e,t){const i=t.getInverseEditOperations();if(i.length!==2)throw new Error("There should be two inverse edit operations!");const n=i[0].range,o=i[1].range,r=n.plusRange(o);return this._computeCursorStateWithRange(e,r,t)}}function QO(s,e){return s===" "?e===5||e===6?6:5:4}function Ex(s,e){return o9(s)&&!o9(e)?!0:s===5?!1:s9(s)!==s9(e)}function s9(s){return s===6||s===5?"space":s}function o9(s){return s===4||s===5||s===6}function K$(s,e,t,i,n){if(s.autoClosingOvertype==="never"||!s.autoClosingPairs.autoClosingPairsCloseSingleChar.has(n))return!1;for(let o=0,r=t.length;o<r;o++){const a=t[o];if(!a.isEmpty())return!1;const l=a.getPosition(),c=e.getLineContent(l.lineNumber);if(c.charAt(l.column-1)!==n)return!1;const h=uh(n);if((l.column>2?c.charCodeAt(l.column-2):0)===92&&h)return!1;if(s.autoClosingOvertype==="auto"){let g=!1;for(let f=0,m=i.length;f<m;f++){const _=i[f];if(l.lineNumber===_.startLineNumber&&l.column===_.startColumn){g=!0;break}}if(!g)return!1}}return!0}function Yh(s,e,t){return t?new e1(s,e,!0):new Nn(s,e,!0)}function JO(s,e,t){return t=t||1,Sr.shiftIndent(e,e.length+t,s.tabSize,s.indentSize,s.insertSpaces)}function lS(s,e,t){return t=t||1,Sr.unshiftIndent(e,e.length+t,s.tabSize,s.indentSize,s.insertSpaces)}function q$(s,e){return uh(e)?s.autoSurround==="quotes"||s.autoSurround==="languageDefined":s.autoSurround==="brackets"||s.autoSurround==="languageDefined"}class xd{static indent(e,t,i){if(t===null||i===null)return[];const n=[];for(let o=0,r=i.length;o<r;o++)n[o]=new Sr(i[o],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return n}static outdent(e,t,i){const n=[];for(let o=0,r=i.length;o<r;o++)n[o]=new Sr(i[o],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return n}static paste(e,t,i,n,o,r){return I_e.getEdits(e,t,i,n,o,r)}static tab(e,t,i){return N_e.getCommands(e,t,i)}static compositionType(e,t,i,n,o,r,a,l){return T_e.getEdits(e,t,i,n,o,r,a,l)}static compositionEndWithInterceptors(e,t,i,n,o,r){if(!n)return null;let a=null;for(const u of n)if(a===null)a=u.insertedText;else if(a!==u.insertedText)return null;if(!a||a.length!==1)return null;const l=a;let c=!1;for(const u of n)if(u.deletedText.length!==0){c=!0;break}if(c){if(!q$(t,l)||!t.surroundingPairs.hasOwnProperty(l))return null;const u=uh(l);for(const m of n)if(m.deletedSelectionStart!==0||m.deletedSelectionEnd!==m.deletedText.length||/^[ \t]+$/.test(m.deletedText)||u&&uh(m.deletedText))return null;const g=[];for(const m of o){if(!m.isEmpty())return null;g.push(m.getPosition())}if(g.length!==n.length)return null;const f=[];for(let m=0,_=g.length;m<_;m++)f.push(new __e(g[m],n[m].deletedText,t.surroundingPairs[l]));return new js(4,f,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}const d=L_e.getEdits(t,i,o,r,l);if(d!==void 0)return d;const h=CR.getEdits(t,i,o,l,!0,!1);return h!==void 0?h:null}static typeWithInterceptors(e,t,i,n,o,r,a){const l=Tx.getEdits(i,n,o,a,e);if(l!==void 0)return l;const c=w_e.getEdits(i,n,o,a,e);if(c!==void 0)return c;const d=S_e.getEdits(t,i,n,o,r,a);if(d!==void 0)return d;const h=CR.getEdits(i,n,o,a,!1,e);if(h!==void 0)return h;const u=x_e.getEdits(i,n,o,a,e);if(u!==void 0)return u;const g=k_e.getEdits(t,i,n,o,a,e);return g!==void 0?g:D_e.getEdits(t,o,a)}static typeWithoutInterceptors(e,t,i,n,o){return E_e.getEdits(e,n,o)}}class A_e{constructor(e,t,i,n,o,r){this.deletedText=e,this.deletedSelectionStart=t,this.deletedSelectionEnd=i,this.insertedText=n,this.insertedSelectionStart=o,this.insertedSelectionEnd=r}}var I;(function(s){s.editorSimpleInput=new le("editorSimpleInput",!1,!0),s.editorTextFocus=new le("editorTextFocus",!1,p("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),s.focus=new le("editorFocus",!1,p("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),s.textInputFocus=new le("textInputFocus",!1,p("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),s.readOnly=new le("editorReadonly",!1,p("editorReadonly","Whether the editor is read-only")),s.inDiffEditor=new le("inDiffEditor",!1,p("inDiffEditor","Whether the context is a diff editor")),s.isEmbeddedDiffEditor=new le("isEmbeddedDiffEditor",!1,p("isEmbeddedDiffEditor","Whether the context is an embedded diff editor")),s.inMultiDiffEditor=new le("inMultiDiffEditor",!1,p("inMultiDiffEditor","Whether the context is a multi diff editor")),s.multiDiffEditorAllCollapsed=new le("multiDiffEditorAllCollapsed",void 0,p("multiDiffEditorAllCollapsed","Whether all files in multi diff editor are collapsed")),s.hasChanges=new le("diffEditorHasChanges",!1,p("diffEditorHasChanges","Whether the diff editor has changes")),s.comparingMovedCode=new le("comparingMovedCode",!1,p("comparingMovedCode","Whether a moved code block is selected for comparison")),s.accessibleDiffViewerVisible=new le("accessibleDiffViewerVisible",!1,p("accessibleDiffViewerVisible","Whether the accessible diff viewer is visible")),s.diffEditorRenderSideBySideInlineBreakpointReached=new le("diffEditorRenderSideBySideInlineBreakpointReached",!1,p("diffEditorRenderSideBySideInlineBreakpointReached","Whether the diff editor render side by side inline breakpoint is reached")),s.diffEditorInlineMode=new le("diffEditorInlineMode",!1,p("diffEditorInlineMode","Whether inline mode is active")),s.diffEditorOriginalWritable=new le("diffEditorOriginalWritable",!1,p("diffEditorOriginalWritable","Whether modified is writable in the diff editor")),s.diffEditorModifiedWritable=new le("diffEditorModifiedWritable",!1,p("diffEditorModifiedWritable","Whether modified is writable in the diff editor")),s.diffEditorOriginalUri=new le("diffEditorOriginalUri","",p("diffEditorOriginalUri","The uri of the original document")),s.diffEditorModifiedUri=new le("diffEditorModifiedUri","",p("diffEditorModifiedUri","The uri of the modified document")),s.columnSelection=new le("editorColumnSelection",!1,p("editorColumnSelection","Whether `editor.columnSelection` is enabled")),s.writable=s.readOnly.toNegated(),s.hasNonEmptySelection=new le("editorHasSelection",!1,p("editorHasSelection","Whether the editor has text selected")),s.hasOnlyEmptySelection=s.hasNonEmptySelection.toNegated(),s.hasMultipleSelections=new le("editorHasMultipleSelections",!1,p("editorHasMultipleSelections","Whether the editor has multiple selections")),s.hasSingleSelection=s.hasMultipleSelections.toNegated(),s.tabMovesFocus=new le("editorTabMovesFocus",!1,p("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),s.tabDoesNotMoveFocus=s.tabMovesFocus.toNegated(),s.isInEmbeddedEditor=new le("isInEmbeddedEditor",!1,!0),s.canUndo=new le("canUndo",!1,!0),s.canRedo=new le("canRedo",!1,!0),s.hoverVisible=new le("editorHoverVisible",!1,p("editorHoverVisible","Whether the editor hover is visible")),s.hoverFocused=new le("editorHoverFocused",!1,p("editorHoverFocused","Whether the editor hover is focused")),s.stickyScrollFocused=new le("stickyScrollFocused",!1,p("stickyScrollFocused","Whether the sticky scroll is focused")),s.stickyScrollVisible=new le("stickyScrollVisible",!1,p("stickyScrollVisible","Whether the sticky scroll is visible")),s.standaloneColorPickerVisible=new le("standaloneColorPickerVisible",!1,p("standaloneColorPickerVisible","Whether the standalone color picker is visible")),s.standaloneColorPickerFocused=new le("standaloneColorPickerFocused",!1,p("standaloneColorPickerFocused","Whether the standalone color picker is focused")),s.inCompositeEditor=new le("inCompositeEditor",void 0,p("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),s.notInCompositeEditor=s.inCompositeEditor.toNegated(),s.languageId=new le("editorLangId","",p("editorLangId","The language identifier of the editor")),s.hasCompletionItemProvider=new le("editorHasCompletionItemProvider",!1,p("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),s.hasCodeActionsProvider=new le("editorHasCodeActionsProvider",!1,p("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),s.hasCodeLensProvider=new le("editorHasCodeLensProvider",!1,p("editorHasCodeLensProvider","Whether the editor has a code lens provider")),s.hasDefinitionProvider=new le("editorHasDefinitionProvider",!1,p("editorHasDefinitionProvider","Whether the editor has a definition provider")),s.hasDeclarationProvider=new le("editorHasDeclarationProvider",!1,p("editorHasDeclarationProvider","Whether the editor has a declaration provider")),s.hasImplementationProvider=new le("editorHasImplementationProvider",!1,p("editorHasImplementationProvider","Whether the editor has an implementation provider")),s.hasTypeDefinitionProvider=new le("editorHasTypeDefinitionProvider",!1,p("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),s.hasHoverProvider=new le("editorHasHoverProvider",!1,p("editorHasHoverProvider","Whether the editor has a hover provider")),s.hasDocumentHighlightProvider=new le("editorHasDocumentHighlightProvider",!1,p("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),s.hasDocumentSymbolProvider=new le("editorHasDocumentSymbolProvider",!1,p("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),s.hasReferenceProvider=new le("editorHasReferenceProvider",!1,p("editorHasReferenceProvider","Whether the editor has a reference provider")),s.hasRenameProvider=new le("editorHasRenameProvider",!1,p("editorHasRenameProvider","Whether the editor has a rename provider")),s.hasSignatureHelpProvider=new le("editorHasSignatureHelpProvider",!1,p("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),s.hasInlayHintsProvider=new le("editorHasInlayHintsProvider",!1,p("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),s.hasDocumentFormattingProvider=new le("editorHasDocumentFormattingProvider",!1,p("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),s.hasDocumentSelectionFormattingProvider=new le("editorHasDocumentSelectionFormattingProvider",!1,p("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),s.hasMultipleDocumentFormattingProvider=new le("editorHasMultipleDocumentFormattingProvider",!1,p("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),s.hasMultipleDocumentSelectionFormattingProvider=new le("editorHasMultipleDocumentSelectionFormattingProvider",!1,p("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))})(I||(I={}));const _t=0;class yi extends Zi{runEditorCommand(e,t,i){const n=t._getViewModel();n&&this.runCoreEditorCommand(n,i||{})}}var Dn;(function(s){const e=function(i){if(!dn(i))return!1;const n=i;return!(!zs(n.to)||!ns(n.by)&&!zs(n.by)||!ns(n.value)&&!Jd(n.value)||!ns(n.revealCursor)&&!qH(n.revealCursor))};s.metadata={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:e,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},s.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},s.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function t(i){let n;switch(i.to){case s.RawDirection.Up:n=1;break;case s.RawDirection.Right:n=2;break;case s.RawDirection.Down:n=3;break;case s.RawDirection.Left:n=4;break;default:return null}let o;switch(i.by){case s.RawUnit.Line:o=1;break;case s.RawUnit.WrappedLine:o=2;break;case s.RawUnit.Page:o=3;break;case s.RawUnit.HalfPage:o=4;break;case s.RawUnit.Editor:o=5;break;case s.RawUnit.Column:o=6;break;default:o=2}const r=Math.floor(i.value||1),a=!!i.revealCursor;return{direction:n,unit:o,value:r,revealCursor:a,select:!!i.select}}s.parse=t})(Dn||(Dn={}));var Mf;(function(s){const e=function(t){if(!dn(t))return!1;const i=t;return!(!Jd(i.lineNumber)&&!zs(i.lineNumber)||!ns(i.at)&&!zs(i.at))};s.metadata={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:e,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},s.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(Mf||(Mf={}));class yR{constructor(e){e.addImplementation(1e4,"code-editor",(t,i)=>{const n=t.get(ft).getFocusedCodeEditor();return n&&n.hasTextFocus()?this._runEditorCommand(t,n,i):!1}),e.addImplementation(1e3,"generic-dom-input-textarea",(t,i)=>{const n=Rn();return n&&["input","textarea"].indexOf(n.tagName.toLowerCase())>=0?(this.runDOMCommand(n),!0):!1}),e.addImplementation(0,"generic-dom",(t,i)=>{const n=t.get(ft).getActiveCodeEditor();return n?(n.focus(),this._runEditorCommand(t,n,i)):!1})}_runEditorCommand(e,t,i){const n=this.runEditorCommand(e,t,i);return n||!0}}var rn;(function(s){class e extends yi{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,C){if(!C.position)return;v.model.pushStackElement(),v.setCursorStates(C.source,3,[mn.moveTo(v,v.getPrimaryCursorState(),this._inSelectionMode,C.position,C.viewPosition)])&&C.revealType!==2&&v.revealAllCursors(C.source,!0,!0)}}s.MoveTo=ae(new e({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),s.MoveToSelect=ae(new e({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class t extends yi{runCoreEditorCommand(v,C){v.model.pushStackElement();const y=this._getColumnSelectResult(v,v.getPrimaryCursorState(),v.getCursorColumnSelectData(),C);y!==null&&(v.setCursorStates(C.source,3,y.viewStates.map(w=>ut.fromViewState(w))),v.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:y.fromLineNumber,fromViewVisualColumn:y.fromVisualColumn,toViewLineNumber:y.toLineNumber,toViewVisualColumn:y.toVisualColumn}),y.reversed?v.revealTopMostCursor(C.source):v.revealBottomMostCursor(C.source))}}s.ColumnSelect=ae(new class extends t{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(b,v,C,y){if(typeof y.position>"u"||typeof y.viewPosition>"u"||typeof y.mouseColumn>"u")return null;const w=b.model.validatePosition(y.position),x=b.coordinatesConverter.validateViewPosition(new P(y.viewPosition.lineNumber,y.viewPosition.column),w),L=y.doColumnSelect?C.fromViewLineNumber:x.lineNumber,D=y.doColumnSelect?C.fromViewVisualColumn:y.mouseColumn-1;return uu.columnSelect(b.cursorConfig,b,L,D,x.lineNumber,y.mouseColumn-1)}}),s.CursorColumnSelectLeft=ae(new class extends t{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(b,v,C,y){return uu.columnSelectLeft(b.cursorConfig,b,C)}}),s.CursorColumnSelectRight=ae(new class extends t{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(b,v,C,y){return uu.columnSelectRight(b.cursorConfig,b,C)}});class i extends t{constructor(v){super(v),this._isPaged=v.isPaged}_getColumnSelectResult(v,C,y,w){return uu.columnSelectUp(v.cursorConfig,v,y,this._isPaged)}}s.CursorColumnSelectUp=ae(new i({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:3600,linux:{primary:0}}})),s.CursorColumnSelectPageUp=ae(new i({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:3595,linux:{primary:0}}}));class n extends t{constructor(v){super(v),this._isPaged=v.isPaged}_getColumnSelectResult(v,C,y,w){return uu.columnSelectDown(v.cursorConfig,v,y,this._isPaged)}}s.CursorColumnSelectDown=ae(new n({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:3602,linux:{primary:0}}})),s.CursorColumnSelectPageDown=ae(new n({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:3596,linux:{primary:0}}}));class o extends yi{constructor(){super({id:"cursorMove",precondition:void 0,metadata:aS.metadata})}runCoreEditorCommand(v,C){const y=aS.parse(C);y&&this._runCursorMove(v,C.source,y)}_runCursorMove(v,C,y){v.model.pushStackElement(),v.setCursorStates(C,3,o._move(v,v.getCursorStates(),y)),v.revealAllCursors(C,!0)}static _move(v,C,y){const w=y.select,x=y.value;switch(y.direction){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return mn.simpleMove(v,C,y.direction,w,x,y.unit);case 11:case 13:case 12:case 14:return mn.viewportMove(v,C,y.direction,w,x);default:return null}}}s.CursorMoveImpl=o,s.CursorMove=ae(new o);class r extends yi{constructor(v){super(v),this._staticArgs=v.args}runCoreEditorCommand(v,C){let y=this._staticArgs;this._staticArgs.value===-1&&(y={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:C.pageSize||v.cursorConfig.pageSize}),v.model.pushStackElement(),v.setCursorStates(C.source,3,mn.simpleMove(v,v.getCursorStates(),y.direction,y.select,y.value,y.unit)),v.revealAllCursors(C.source,!0)}}s.CursorLeft=ae(new r({args:{direction:0,unit:0,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),s.CursorLeftSelect=ae(new r({args:{direction:0,unit:0,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:1039}})),s.CursorRight=ae(new r({args:{direction:1,unit:0,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),s.CursorRightSelect=ae(new r({args:{direction:1,unit:0,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:1041}})),s.CursorUp=ae(new r({args:{direction:2,unit:2,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),s.CursorUpSelect=ae(new r({args:{direction:2,unit:2,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),s.CursorPageUp=ae(new r({args:{direction:2,unit:2,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:11}})),s.CursorPageUpSelect=ae(new r({args:{direction:2,unit:2,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:1035}})),s.CursorDown=ae(new r({args:{direction:3,unit:2,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),s.CursorDownSelect=ae(new r({args:{direction:3,unit:2,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),s.CursorPageDown=ae(new r({args:{direction:3,unit:2,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:12}})),s.CursorPageDownSelect=ae(new r({args:{direction:3,unit:2,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:1036}})),s.CreateCursor=ae(new class extends yi{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(b,v){if(!v.position)return;let C;v.wholeLine?C=mn.line(b,b.getPrimaryCursorState(),!1,v.position,v.viewPosition):C=mn.moveTo(b,b.getPrimaryCursorState(),!1,v.position,v.viewPosition);const y=b.getCursorStates();if(y.length>1){const w=C.modelState?C.modelState.position:null,x=C.viewState?C.viewState.position:null;for(let L=0,D=y.length;L<D;L++){const T=y[L];if(!(w&&!T.modelState.selection.containsPosition(w))&&!(x&&!T.viewState.selection.containsPosition(x))){y.splice(L,1),b.model.pushStackElement(),b.setCursorStates(v.source,3,y);return}}}y.push(C),b.model.pushStackElement(),b.setCursorStates(v.source,3,y)}}),s.LastCursorMoveToSelect=ae(new class extends yi{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(b,v){if(!v.position)return;const C=b.getLastAddedCursorIndex(),y=b.getCursorStates(),w=y.slice(0);w[C]=mn.moveTo(b,y[C],!0,v.position,v.viewPosition),b.model.pushStackElement(),b.setCursorStates(v.source,3,w)}});class a extends yi{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,C){v.model.pushStackElement(),v.setCursorStates(C.source,3,mn.moveToBeginningOfLine(v,v.getCursorStates(),this._inSelectionMode)),v.revealAllCursors(C.source,!0)}}s.CursorHome=ae(new a({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),s.CursorHomeSelect=ae(new a({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class l extends yi{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,C){v.model.pushStackElement(),v.setCursorStates(C.source,3,this._exec(v.getCursorStates())),v.revealAllCursors(C.source,!0)}_exec(v){const C=[];for(let y=0,w=v.length;y<w;y++){const x=v[y],L=x.modelState.position.lineNumber;C[y]=ut.fromModelState(x.modelState.move(this._inSelectionMode,L,1,0))}return C}}s.CursorLineStart=ae(new l({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:0,mac:{primary:287}}})),s.CursorLineStartSelect=ae(new l({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:0,mac:{primary:1311}}}));class c extends yi{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,C){v.model.pushStackElement(),v.setCursorStates(C.source,3,mn.moveToEndOfLine(v,v.getCursorStates(),this._inSelectionMode,C.sticky||!1)),v.revealAllCursors(C.source,!0)}}s.CursorEnd=ae(new c({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:_t,kbExpr:I.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},metadata:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:p("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),s.CursorEndSelect=ae(new c({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:_t,kbExpr:I.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},metadata:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:p("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class d extends yi{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,C){v.model.pushStackElement(),v.setCursorStates(C.source,3,this._exec(v,v.getCursorStates())),v.revealAllCursors(C.source,!0)}_exec(v,C){const y=[];for(let w=0,x=C.length;w<x;w++){const L=C[w],D=L.modelState.position.lineNumber,T=v.model.getLineMaxColumn(D);y[w]=ut.fromModelState(L.modelState.move(this._inSelectionMode,D,T,0))}return y}}s.CursorLineEnd=ae(new d({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:0,mac:{primary:291}}})),s.CursorLineEndSelect=ae(new d({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:0,mac:{primary:1315}}}));class h extends yi{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,C){v.model.pushStackElement(),v.setCursorStates(C.source,3,mn.moveToBeginningOfBuffer(v,v.getCursorStates(),this._inSelectionMode)),v.revealAllCursors(C.source,!0)}}s.CursorTop=ae(new h({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:2062,mac:{primary:2064}}})),s.CursorTopSelect=ae(new h({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:3086,mac:{primary:3088}}}));class u extends yi{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,C){v.model.pushStackElement(),v.setCursorStates(C.source,3,mn.moveToEndOfBuffer(v,v.getCursorStates(),this._inSelectionMode)),v.revealAllCursors(C.source,!0)}}s.CursorBottom=ae(new u({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:2061,mac:{primary:2066}}})),s.CursorBottomSelect=ae(new u({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:3085,mac:{primary:3090}}}));class g extends yi{constructor(){super({id:"editorScroll",precondition:void 0,metadata:Dn.metadata})}determineScrollMethod(v){const C=[6],y=[1,2,3,4,5,6],w=[4,2],x=[1,3];return C.includes(v.unit)&&w.includes(v.direction)?this._runHorizontalEditorScroll.bind(this):y.includes(v.unit)&&x.includes(v.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(v,C){const y=Dn.parse(C);if(!y)return;const w=this.determineScrollMethod(y);w&&w(v,C.source,y)}_runVerticalEditorScroll(v,C,y){const w=this._computeDesiredScrollTop(v,y);if(y.revealCursor){const x=v.getCompletelyVisibleViewRangeAtScrollTop(w);v.setCursorStates(C,3,[mn.findPositionInViewportIfOutside(v,v.getPrimaryCursorState(),x,y.select)])}v.viewLayout.setScrollPosition({scrollTop:w},0)}_computeDesiredScrollTop(v,C){if(C.unit===1){const x=v.viewLayout.getFutureViewport(),L=v.getCompletelyVisibleViewRangeAtScrollTop(x.top),D=v.coordinatesConverter.convertViewRangeToModelRange(L);let T;C.direction===1?T=Math.max(1,D.startLineNumber-C.value):T=Math.min(v.model.getLineCount(),D.startLineNumber+C.value);const F=v.coordinatesConverter.convertModelPositionToViewPosition(new P(T,1));return v.viewLayout.getVerticalOffsetForLineNumber(F.lineNumber)}if(C.unit===5){let x=0;return C.direction===3&&(x=v.model.getLineCount()-v.cursorConfig.pageSize),v.viewLayout.getVerticalOffsetForLineNumber(x)}let y;C.unit===3?y=v.cursorConfig.pageSize*C.value:C.unit===4?y=Math.round(v.cursorConfig.pageSize/2)*C.value:y=C.value;const w=(C.direction===1?-1:1)*y;return v.viewLayout.getCurrentScrollTop()+w*v.cursorConfig.lineHeight}_runHorizontalEditorScroll(v,C,y){const w=this._computeDesiredScrollLeft(v,y);v.viewLayout.setScrollPosition({scrollLeft:w},0)}_computeDesiredScrollLeft(v,C){const y=(C.direction===4?-1:1)*C.value;return v.viewLayout.getCurrentScrollLeft()+y*v.cursorConfig.typicalHalfwidthCharacterWidth}}s.EditorScrollImpl=g,s.EditorScroll=ae(new g),s.ScrollLineUp=ae(new class extends yi{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(b,v){s.EditorScroll.runCoreEditorCommand(b,{to:Dn.RawDirection.Up,by:Dn.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:v.source})}}),s.ScrollPageUp=ae(new class extends yi{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(b,v){s.EditorScroll.runCoreEditorCommand(b,{to:Dn.RawDirection.Up,by:Dn.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:v.source})}}),s.ScrollEditorTop=ae(new class extends yi{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus}})}runCoreEditorCommand(b,v){s.EditorScroll.runCoreEditorCommand(b,{to:Dn.RawDirection.Up,by:Dn.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:v.source})}}),s.ScrollLineDown=ae(new class extends yi{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(b,v){s.EditorScroll.runCoreEditorCommand(b,{to:Dn.RawDirection.Down,by:Dn.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:v.source})}}),s.ScrollPageDown=ae(new class extends yi{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(b,v){s.EditorScroll.runCoreEditorCommand(b,{to:Dn.RawDirection.Down,by:Dn.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:v.source})}}),s.ScrollEditorBottom=ae(new class extends yi{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus}})}runCoreEditorCommand(b,v){s.EditorScroll.runCoreEditorCommand(b,{to:Dn.RawDirection.Down,by:Dn.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:v.source})}}),s.ScrollLeft=ae(new class extends yi{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus}})}runCoreEditorCommand(b,v){s.EditorScroll.runCoreEditorCommand(b,{to:Dn.RawDirection.Left,by:Dn.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:v.source})}}),s.ScrollRight=ae(new class extends yi{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus}})}runCoreEditorCommand(b,v){s.EditorScroll.runCoreEditorCommand(b,{to:Dn.RawDirection.Right,by:Dn.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:v.source})}});class f extends yi{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,C){C.position&&(v.model.pushStackElement(),v.setCursorStates(C.source,3,[mn.word(v,v.getPrimaryCursorState(),this._inSelectionMode,C.position)]),C.revealType!==2&&v.revealAllCursors(C.source,!0,!0))}}s.WordSelect=ae(new f({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),s.WordSelectDrag=ae(new f({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),s.LastCursorWordSelect=ae(new class extends yi{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(b,v){if(!v.position)return;const C=b.getLastAddedCursorIndex(),y=b.getCursorStates(),w=y.slice(0),x=y[C];w[C]=mn.word(b,x,x.modelState.hasSelection(),v.position),b.model.pushStackElement(),b.setCursorStates(v.source,3,w)}});class m extends yi{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,C){C.position&&(v.model.pushStackElement(),v.setCursorStates(C.source,3,[mn.line(v,v.getPrimaryCursorState(),this._inSelectionMode,C.position,C.viewPosition)]),C.revealType!==2&&v.revealAllCursors(C.source,!1,!0))}}s.LineSelect=ae(new m({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),s.LineSelectDrag=ae(new m({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class _ extends yi{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,C){if(!C.position)return;const y=v.getLastAddedCursorIndex(),w=v.getCursorStates(),x=w.slice(0);x[y]=mn.line(v,w[y],this._inSelectionMode,C.position,C.viewPosition),v.model.pushStackElement(),v.setCursorStates(C.source,3,x)}}s.LastCursorLineSelect=ae(new _({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),s.LastCursorLineSelectDrag=ae(new _({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),s.CancelSelection=ae(new class extends yi{constructor(){super({id:"cancelSelection",precondition:I.hasNonEmptySelection,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(b,v){b.model.pushStackElement(),b.setCursorStates(v.source,3,[mn.cancelSelection(b,b.getPrimaryCursorState())]),b.revealAllCursors(v.source,!0)}}),s.RemoveSecondaryCursors=ae(new class extends yi{constructor(){super({id:"removeSecondaryCursors",precondition:I.hasMultipleSelections,kbOpts:{weight:_t+1,kbExpr:I.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(b,v){b.model.pushStackElement(),b.setCursorStates(v.source,3,[b.getPrimaryCursorState()]),b.revealAllCursors(v.source,!0),Nl(p("removedCursor","Removed secondary cursors"))}}),s.RevealLine=ae(new class extends yi{constructor(){super({id:"revealLine",precondition:void 0,metadata:Mf.metadata})}runCoreEditorCommand(b,v){const C=v,y=C.lineNumber||0;let w=typeof y=="number"?y+1:parseInt(y)+1;w<1&&(w=1);const x=b.model.getLineCount();w>x&&(w=x);const L=new k(w,1,w,b.model.getLineMaxColumn(w));let D=0;if(C.at)switch(C.at){case Mf.RawAtArgument.Top:D=3;break;case Mf.RawAtArgument.Center:D=1;break;case Mf.RawAtArgument.Bottom:D=4;break}const T=b.coordinatesConverter.convertModelRangeToViewRange(L);b.revealRange(v.source,!1,T,D,0)}}),s.SelectAll=new class extends yR{constructor(){super(xie)}runDOMCommand(b){vr&&(b.focus(),b.select()),b.ownerDocument.execCommand("selectAll")}runEditorCommand(b,v,C){const y=v._getViewModel();y&&this.runCoreEditorCommand(y,C)}runCoreEditorCommand(b,v){b.model.pushStackElement(),b.setCursorStates("keyboard",3,[mn.selectAll(b,b.getPrimaryCursorState())])}},s.SetSelection=ae(new class extends yi{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(b,v){v.selection&&(b.model.pushStackElement(),b.setCursorStates(v.source,3,[ut.fromModelSelection(v.selection)]))}})})(rn||(rn={}));const P_e=q.and(I.textInputFocus,I.columnSelection);function Mm(s,e){Ss.registerKeybindingRule({id:s,primary:e,when:P_e,weight:_t+1})}Mm(rn.CursorColumnSelectLeft.id,1039);Mm(rn.CursorColumnSelectRight.id,1041);Mm(rn.CursorColumnSelectUp.id,1040);Mm(rn.CursorColumnSelectPageUp.id,1035);Mm(rn.CursorColumnSelectDown.id,1042);Mm(rn.CursorColumnSelectPageDown.id,1036);function r9(s){return s.register(),s}var dp;(function(s){class e extends Zi{runEditorCommand(i,n,o){const r=n._getViewModel();r&&this.runCoreEditingCommand(n,r,o||{})}}s.CoreEditingCommand=e,s.LineBreakInsert=ae(new class extends e{constructor(){super({id:"lineBreakInsert",precondition:I.writable,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(t,i,n){t.pushUndoStop(),t.executeCommands(this.id,Tx.lineBreakInsert(i.cursorConfig,i.model,i.getCursorStates().map(o=>o.modelState.selection)))}}),s.Outdent=ae(new class extends e{constructor(){super({id:"outdent",precondition:I.writable,kbOpts:{weight:_t,kbExpr:q.and(I.editorTextFocus,I.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(t,i,n){t.pushUndoStop(),t.executeCommands(this.id,xd.outdent(i.cursorConfig,i.model,i.getCursorStates().map(o=>o.modelState.selection))),t.pushUndoStop()}}),s.Tab=ae(new class extends e{constructor(){super({id:"tab",precondition:I.writable,kbOpts:{weight:_t,kbExpr:q.and(I.editorTextFocus,I.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(t,i,n){t.pushUndoStop(),t.executeCommands(this.id,xd.tab(i.cursorConfig,i.model,i.getCursorStates().map(o=>o.modelState.selection))),t.pushUndoStop()}}),s.DeleteLeft=ae(new class extends e{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(t,i,n){const[o,r]=ig.deleteLeft(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map(a=>a.modelState.selection),i.getCursorAutoClosedCharacters());o&&t.pushUndoStop(),t.executeCommands(this.id,r),i.setPrevEditOperationType(2)}}),s.DeleteRight=ae(new class extends e{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:_t,kbExpr:I.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(t,i,n){const[o,r]=ig.deleteRight(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map(a=>a.modelState.selection));o&&t.pushUndoStop(),t.executeCommands(this.id,r),i.setPrevEditOperationType(3)}}),s.Undo=new class extends yR{constructor(){super(gV)}runDOMCommand(t){t.ownerDocument.execCommand("undo")}runEditorCommand(t,i,n){if(!(!i.hasModel()||i.getOption(92)===!0))return i.getModel().undo()}},s.Redo=new class extends yR{constructor(){super(fV)}runDOMCommand(t){t.ownerDocument.execCommand("redo")}runEditorCommand(t,i,n){if(!(!i.hasModel()||i.getOption(92)===!0))return i.getModel().redo()}}})(dp||(dp={}));class a9 extends AL{constructor(e,t,i){super({id:e,precondition:void 0,metadata:i}),this._handlerId=t}runCommand(e,t){const i=e.get(ft).getFocusedCodeEditor();i&&i.trigger("keyboard",this._handlerId,t)}}function Lg(s,e){r9(new a9("default:"+s,s)),r9(new a9(s,s,e))}Lg("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});Lg("replacePreviousChar");Lg("compositionType");Lg("compositionStart");Lg("compositionEnd");Lg("paste");Lg("cut");class O_e{constructor(e,t,i,n){this.configuration=e,this.viewModel=t,this.userInputEvents=i,this.commandDelegate=n}paste(e,t,i,n){this.commandDelegate.paste(e,t,i,n)}type(e){this.commandDelegate.type(e)}compositionType(e,t,i,n){this.commandDelegate.compositionType(e,t,i,n)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){rn.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){const t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new P(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(78)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(78)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){const t=this.configuration.options,i=ys&&t.get(108),n=t.get(22);e.middleButton&&!i?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():e.mouseDownCount===3?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount===2?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey?this._columnSelect(e.position,e.mouseColumn,!0):n?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){rn.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){rn.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,i){e=this._validateViewColumn(e),rn.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:i})}_createCursor(e,t){e=this._validateViewColumn(e),rn.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){rn.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){rn.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){rn.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){rn.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){rn.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){rn.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){rn.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){rn.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){rn.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}}class G${constructor(e){this._lineFactory=e,this._set(1,[])}flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){const t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new mt("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(this.getCount()===0)return null;const i=this.getStartLineNumber(),n=this.getEndLineNumber();if(t<i){const l=t-e+1;return this._rendLineNumberStart-=l,null}if(e>n)return null;let o=0,r=0;for(let l=i;l<=n;l++){const c=l-this._rendLineNumberStart;e<=l&&l<=t&&(r===0?(o=c,r=1):r++)}if(e<i){let l=0;t<i?l=t-e+1:l=i-e,this._rendLineNumberStart-=l}return this._lines.splice(o,r)}onLinesChanged(e,t){const i=e+t-1;if(this.getCount()===0)return!1;const n=this.getStartLineNumber(),o=this.getEndLineNumber();let r=!1;for(let a=e;a<=i;a++)a>=n&&a<=o&&(this._lines[a-this._rendLineNumberStart].onContentChanged(),r=!0);return r}onLinesInserted(e,t){if(this.getCount()===0)return null;const i=t-e+1,n=this.getStartLineNumber(),o=this.getEndLineNumber();if(e<=n)return this._rendLineNumberStart+=i,null;if(e>o)return null;if(i+e>o)return this._lines.splice(e-this._rendLineNumberStart,o-e+1);const r=[];for(let h=0;h<i;h++)r[h]=this._lineFactory.createLine();const a=e-this._rendLineNumberStart,l=this._lines.slice(0,a),c=this._lines.slice(a,this._lines.length-i),d=this._lines.slice(this._lines.length-i,this._lines.length);return this._lines=l.concat(r).concat(c),d}onTokensChanged(e){if(this.getCount()===0)return!1;const t=this.getStartLineNumber(),i=this.getEndLineNumber();let n=!1;for(let o=0,r=e.length;o<r;o++){const a=e[o];if(a.toLineNumber<t||a.fromLineNumber>i)continue;const l=Math.max(t,a.fromLineNumber),c=Math.min(i,a.toLineNumber);for(let d=l;d<=c;d++){const h=d-this._rendLineNumberStart;this._lines[h].onTokensChanged(),n=!0}}return n}}class Y${constructor(e){this._lineFactory=e,this.domNode=this._createDomNode(),this._linesCollection=new G$(this._lineFactory)}_createDomNode(){const e=Ct(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(146)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){const t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,n=t.length;i<n;i++)t[i].getDomNode()?.remove();return!0}onLinesInserted(e){const t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,n=t.length;i<n;i++)t[i].getDomNode()?.remove();return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){const t=this._linesCollection._get(),i=new gu(this.domNode.domNode,this._lineFactory,e),n={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},o=i.render(n,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(o.rendLineNumberStart,o.lines)}}class gu{static{this._ttPolicy=Gc("editorViewLayer",{createHTML:e=>e})}constructor(e,t,i){this._domNode=e,this._lineFactory=t,this._viewportData=i}render(e,t,i,n){const o={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(o.rendLineNumberStart+o.linesLength-1<t||i<o.rendLineNumberStart){o.rendLineNumberStart=t,o.linesLength=i-t+1,o.lines=[];for(let r=t;r<=i;r++)o.lines[r-t]=this._lineFactory.createLine();return this._finishRendering(o,!0,n),o}if(this._renderUntouchedLines(o,Math.max(t-o.rendLineNumberStart,0),Math.min(i-o.rendLineNumberStart,o.linesLength-1),n,t),o.rendLineNumberStart>t){const r=t,a=Math.min(i,o.rendLineNumberStart-1);r<=a&&(this._insertLinesBefore(o,r,a,n,t),o.linesLength+=a-r+1)}else if(o.rendLineNumberStart<t){const r=Math.min(o.linesLength,t-o.rendLineNumberStart);r>0&&(this._removeLinesBefore(o,r),o.linesLength-=r)}if(o.rendLineNumberStart=t,o.rendLineNumberStart+o.linesLength-1<i){const r=o.rendLineNumberStart+o.linesLength,a=i;r<=a&&(this._insertLinesAfter(o,r,a,n,t),o.linesLength+=a-r+1)}else if(o.rendLineNumberStart+o.linesLength-1>i){const r=Math.max(0,i-o.rendLineNumberStart+1),l=o.linesLength-1-r+1;l>0&&(this._removeLinesAfter(o,l),o.linesLength-=l)}return this._finishRendering(o,!1,n),o}_renderUntouchedLines(e,t,i,n,o){const r=e.rendLineNumberStart,a=e.lines;for(let l=t;l<=i;l++){const c=r+l;a[l].layoutLine(c,n[c-o],this._viewportData.lineHeight)}}_insertLinesBefore(e,t,i,n,o){const r=[];let a=0;for(let l=t;l<=i;l++)r[a++]=this._lineFactory.createLine();e.lines=r.concat(e.lines)}_removeLinesBefore(e,t){for(let i=0;i<t;i++)e.lines[i].getDomNode()?.remove();e.lines.splice(0,t)}_insertLinesAfter(e,t,i,n,o){const r=[];let a=0;for(let l=t;l<=i;l++)r[a++]=this._lineFactory.createLine();e.lines=e.lines.concat(r)}_removeLinesAfter(e,t){const i=e.linesLength-t;for(let n=0;n<t;n++)e.lines[i+n].getDomNode()?.remove();e.lines.splice(i,t)}_finishRenderingNewLines(e,t,i,n){gu._ttPolicy&&(i=gu._ttPolicy.createHTML(i));const o=this._domNode.lastChild;t||!o?this._domNode.innerHTML=i:o.insertAdjacentHTML("afterend",i);let r=this._domNode.lastChild;for(let a=e.linesLength-1;a>=0;a--){const l=e.lines[a];n[a]&&(l.setDomNode(r),r=r.previousSibling)}}_finishRenderingInvalidLines(e,t,i){const n=document.createElement("div");gu._ttPolicy&&(t=gu._ttPolicy.createHTML(t)),n.innerHTML=t;for(let o=0;o<e.linesLength;o++){const r=e.lines[o];if(i[o]){const a=n.firstChild,l=r.getDomNode();l.parentNode.replaceChild(a,l),r.setDomNode(a)}}}static{this._sb=new vm(1e5)}_finishRendering(e,t,i){const n=gu._sb,o=e.linesLength,r=e.lines,a=e.rendLineNumberStart,l=[];{n.reset();let c=!1;for(let d=0;d<o;d++){const h=r[d];l[d]=!1,!(h.getDomNode()||!h.renderLine(d+a,i[d],this._viewportData.lineHeight,this._viewportData,n))&&(l[d]=!0,c=!0)}c&&this._finishRenderingNewLines(e,t,n.build(),l)}{n.reset();let c=!1;const d=[];for(let h=0;h<o;h++){const u=r[h];d[h]=!1,!(l[h]||!u.renderLine(h+a,i[h],this._viewportData.lineHeight,this._viewportData,n))&&(d[h]=!0,c=!0)}c&&this._finishRenderingInvalidLines(e,n.build(),d)}}}class X$ extends yo{constructor(e){super(e),this._dynamicOverlays=[],this._isFocused=!1,this._visibleLines=new Y$({createLine:()=>new F_e(this._dynamicOverlays)}),this.domNode=this._visibleLines.domNode;const i=this._context.configuration.options.get(50);wn(this.domNode,i),this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++)if(this._dynamicOverlays[e].shouldRender())return!0;return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++)this._dynamicOverlays[e].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);const i=this._context.configuration.options.get(50);return wn(this.domNode,i),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){const t=this._dynamicOverlays.filter(i=>i.shouldRender());for(let i=0,n=t.length;i<n;i++){const o=t[i];o.prepareRender(e),o.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}}class F_e{constructor(e){this._dynamicOverlays=e,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=Ct(e)}onContentChanged(){}onTokensChanged(){}renderLine(e,t,i,n,o){let r="";for(let a=0,l=this._dynamicOverlays.length;a<l;a++){const c=this._dynamicOverlays[a];r+=c.render(n.startLineNumber,e)}return this._renderedContent===r?!1:(this._renderedContent=r,o.appendString('<div style="top:'),o.appendString(String(t)),o.appendString("px;height:"),o.appendString(String(i)),o.appendString('px;">'),o.appendString(r),o.appendString("</div>"),!0)}layoutLine(e,t,i){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(i))}}class B_e extends X${constructor(e){super(e);const i=this._context.configuration.options.get(146);this._contentWidth=i.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){const i=this._context.configuration.options.get(146);return this._contentWidth=i.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}}class W_e extends X${constructor(e){super(e);const t=this._context.configuration.options,i=t.get(146);this._contentLeft=i.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),wn(this.domNode,t.get(50))}onConfigurationChanged(e){const t=this._context.configuration.options;wn(this.domNode,t.get(50));const i=t.get(146);return this._contentLeft=i.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);const t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}}class Nx{constructor(e){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=e}emitKeyDown(e){this.onKeyDown?.(e)}emitKeyUp(e){this.onKeyUp?.(e)}emitContextMenu(e){this.onContextMenu?.(this._convertViewToModelMouseEvent(e))}emitMouseMove(e){this.onMouseMove?.(this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){this.onMouseLeave?.(this._convertViewToModelMouseEvent(e))}emitMouseDown(e){this.onMouseDown?.(this._convertViewToModelMouseEvent(e))}emitMouseUp(e){this.onMouseUp?.(this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){this.onMouseDrag?.(this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){this.onMouseDrop?.(this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){this.onMouseDropCanceled?.()}emitMouseWheel(e){this.onMouseWheel?.(e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return Nx.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){const i={...e};return i.position&&(i.position=t.convertViewPositionToModelPosition(i.position)),i.range&&(i.range=t.convertViewRangeToModelRange(i.range)),(i.type===5||i.type===8)&&(i.detail=this.convertViewToModelViewZoneData(i.detail,t)),i}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new P(e.afterLineNumber,1)).lineNumber}}}class H_e extends yo{constructor(e){super(e),this.blocks=[],this.contentWidth=-1,this.contentLeft=0,this.domNode=Ct(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let e=!1;const i=this._context.configuration.options.get(146),n=i.contentWidth-i.verticalScrollbarWidth;this.contentWidth!==n&&(this.contentWidth=n,e=!0);const o=i.contentLeft;return this.contentLeft!==o&&(this.contentLeft=o,e=!0),e}dispose(){super.dispose()}onConfigurationChanged(e){return this.update()}onScrollChanged(e){return e.scrollTopChanged||e.scrollLeftChanged}onDecorationsChanged(e){return!0}onZonesChanged(e){return!0}prepareRender(e){}render(e){let t=0;const i=e.getDecorationsInViewport();for(const n of i){if(!n.options.blockClassName)continue;let o=this.blocks[t];o||(o=this.blocks[t]=Ct(document.createElement("div")),this.domNode.appendChild(o));let r,a;n.options.blockIsAfterEnd?(r=e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!1),a=e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0)):(r=e.getVerticalOffsetForLineNumber(n.range.startLineNumber,!0),a=n.range.isEmpty()&&!n.options.blockDoesNotCollapse?e.getVerticalOffsetForLineNumber(n.range.startLineNumber,!1):e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0));const[l,c,d,h]=n.options.blockPadding??[0,0,0,0];o.setClassName("blockDecorations-block "+n.options.blockClassName),o.setLeft(this.contentLeft-h),o.setWidth(this.contentWidth+h+c),o.setTop(r-e.scrollTop-l),o.setHeight(a-r+l+d),t++}for(let n=t;n<this.blocks.length;n++)this.blocks[n].domNode.remove();this.blocks.length=t}}class V_e extends yo{constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=Ct(document.createElement("div")),Ua.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=Ct(document.createElement("div")),Ua.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(e){return this._updateAnchorsViewPositions(),!0}onLinesInserted(e){return this._updateAnchorsViewPositions(),!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}_updateAnchorsViewPositions(){const e=Object.keys(this._widgets);for(const t of e)this._widgets[t].updateAnchorViewPosition()}addWidget(e){const t=new z_e(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,i,n,o){this._widgets[e.getId()].setPosition(t,i,n,o),this.setShouldRender()}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const i=this._widgets[t];delete this._widgets[t];const n=i.domNode.domNode;n.remove(),n.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return this._widgets.hasOwnProperty(e)?this._widgets[e].suppressMouseDown:!1}onBeforeRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onBeforeRender(e)}prepareRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].prepareRender(e)}render(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].render(e)}}class z_e{constructor(e,t,i){this._primaryAnchor=new r_(null,null),this._secondaryAnchor=new r_(null,null),this._context=e,this._viewDomNode=t,this._actual=i,this.domNode=Ct(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;const n=this._context.configuration.options,o=n.get(146);this._fixedOverflowWidgets=n.get(42),this._contentWidth=o.contentWidth,this._contentLeft=o.contentLeft,this._lineHeight=n.get(67),this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){const t=this._context.configuration.options;if(this._lineHeight=t.get(67),e.hasChanged(146)){const i=t.get(146);this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(e,t,i){this._affinity=e,this._primaryAnchor=n(t,this._context.viewModel,this._affinity),this._secondaryAnchor=n(i,this._context.viewModel,this._affinity);function n(o,r,a){if(!o)return new r_(null,null);const l=r.model.validatePosition(o);if(r.coordinatesConverter.modelPositionIsVisible(l)){const c=r.coordinatesConverter.convertModelPositionToViewPosition(l,a??void 0);return new r_(o,c)}return new r_(o,null)}}_getMaxWidth(){const e=this.domNode.domNode.ownerDocument,t=e.defaultView;return this.allowEditorOverflow?t?.innerWidth||e.documentElement.offsetWidth||e.body.offsetWidth:this._contentWidth}setPosition(e,t,i,n){this._setPosition(n,e,t),this._preference=i,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(e,t,i,n){const o=e.top,r=o,a=e.top+e.height,l=n.viewportHeight-a,c=o-i,d=r>=i,h=a,u=l>=i;let g=e.left;return g+t>n.scrollLeft+n.viewportWidth&&(g=n.scrollLeft+n.viewportWidth-t),g<n.scrollLeft&&(g=n.scrollLeft),{fitsAbove:d,aboveTop:c,fitsBelow:u,belowTop:h,left:g}}_layoutHorizontalSegmentInPage(e,t,i,n){const a=Math.max(15,t.left-n),l=Math.min(t.left+t.width+n,e.width-15),d=this._viewDomNode.domNode.ownerDocument.defaultView;let h=t.left+i-(d?.scrollX??0);if(h+n>l){const u=h-(l-n);h-=u,i-=u}if(h<a){const u=h-a;h-=u,i-=u}return[i,h]}_layoutBoxInPage(e,t,i,n){const o=e.top-i,r=e.top+e.height,a=Si(this._viewDomNode.domNode),l=this._viewDomNode.domNode.ownerDocument,c=l.defaultView,d=a.top+o-(c?.scrollY??0),h=a.top+r-(c?.scrollY??0),u=sh(l.body),[g,f]=this._layoutHorizontalSegmentInPage(u,a,e.left-n.scrollLeft+this._contentLeft,t),m=22,_=22,b=d>=m,v=h+i<=u.height-_;return this._fixedOverflowWidgets?{fitsAbove:b,aboveTop:Math.max(d,m),fitsBelow:v,belowTop:h,left:f}:{fitsAbove:b,aboveTop:o,fitsBelow:v,belowTop:r,left:g}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new a_(e.top,e.left+this._contentLeft)}_getAnchorsCoordinates(e){const t=o(this._primaryAnchor.viewPosition,this._affinity,this._lineHeight),i=this._secondaryAnchor.viewPosition?.lineNumber===this._primaryAnchor.viewPosition?.lineNumber?this._secondaryAnchor.viewPosition:null,n=o(i,this._affinity,this._lineHeight);return{primary:t,secondary:n};function o(r,a,l){if(!r)return null;const c=e.visibleRangeForPosition(r);if(!c)return null;const d=r.column===1&&a===3?0:c.left,h=e.getVerticalOffsetForLineNumber(r.lineNumber)-e.scrollTop;return new l9(h,d,l)}}_reduceAnchorCoordinates(e,t,i){if(!t)return e;const n=this._context.configuration.options.get(50);let o=t.left;return o<e.left?o=Math.max(o,e.left-i+n.typicalFullwidthCharacterWidth):o=Math.min(o,e.left+i-n.typicalFullwidthCharacterWidth),new l9(e.top,o,e.height)}_prepareRenderWidget(e){if(!this._preference||this._preference.length===0)return null;const{primary:t,secondary:i}=this._getAnchorsCoordinates(e);if(!t)return{kind:"offViewport",preserveFocus:this.domNode.domNode.contains(this.domNode.domNode.ownerDocument.activeElement)};if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let r=null;if(typeof this._actual.beforeRender=="function"&&(r=qD(this._actual.beforeRender,this._actual)),r)this._cachedDomNodeOffsetWidth=r.width,this._cachedDomNodeOffsetHeight=r.height;else{const l=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(l.width),this._cachedDomNodeOffsetHeight=Math.round(l.height)}}const n=this._reduceAnchorCoordinates(t,i,this._cachedDomNodeOffsetWidth);let o;this.allowEditorOverflow?o=this._layoutBoxInPage(n,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e):o=this._layoutBoxInViewport(n,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e);for(let r=1;r<=2;r++)for(const a of this._preference)if(a===1){if(!o)return null;if(r===2||o.fitsAbove)return{kind:"inViewport",coordinate:new a_(o.aboveTop,o.left),position:1}}else if(a===2){if(!o)return null;if(r===2||o.fitsBelow)return{kind:"inViewport",coordinate:new a_(o.belowTop,o.left),position:2}}else return this.allowEditorOverflow?{kind:"inViewport",coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new a_(n.top,n.left)),position:0}:{kind:"inViewport",coordinate:new a_(n.top,n.left),position:0};return null}onBeforeRender(e){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<e.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){if(!this._renderData||this._renderData.kind==="offViewport"){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this._renderData?.kind==="offViewport"&&this._renderData.preserveFocus?this.domNode.setTop(-1e3):this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&qD(this._actual.afterRender,this._actual,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&qD(this._actual.afterRender,this._actual,this._renderData.position)}}class r_{constructor(e,t){this.modelPosition=e,this.viewPosition=t}}class a_{constructor(e,t){this.top=e,this.left=t,this._coordinateBrand=void 0}}class l9{constructor(e,t,i){this.top=e,this.left=t,this.height=i,this._anchorCoordinateBrand=void 0}}function qD(s,e,...t){try{return s.call(e,...t)}catch{return null}}class Q$ extends Sg{constructor(e){super(),this._context=e;const t=this._context.configuration.options,i=t.get(146);this._renderLineHighlight=t.get(97),this._renderLineHighlightOnlyWhenFocus=t.get(98),this._wordWrap=i.isViewportWrapping,this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new me(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1;const t=new Set;for(const o of this._selections)t.add(o.positionLineNumber);const i=Array.from(t);i.sort((o,r)=>o-r),ii(this._cursorLineNumbers,i)||(this._cursorLineNumbers=i,e=!0);const n=this._selections.every(o=>o.isEmpty());return this._selectionIsEmpty!==n&&(this._selectionIsEmpty=n,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(146);return this._renderLineHighlight=t.get(97),this._renderLineHighlightOnlyWhenFocus=t.get(98),this._wordWrap=i.isViewportWrapping,this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return this._renderLineHighlightOnlyWhenFocus?(this._focused=e.isFocused,!0):!1}prepareRender(e){if(!this._shouldRenderThis()){this._renderData=null;return}const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=[];for(let r=t;r<=i;r++){const a=r-t;n[a]=""}if(this._wordWrap){const r=this._renderOne(e,!1);for(const a of this._cursorLineNumbers){const l=this._context.viewModel.coordinatesConverter,c=l.convertViewPositionToModelPosition(new P(a,1)).lineNumber,d=l.convertModelPositionToViewPosition(new P(c,1)).lineNumber,h=l.convertModelPositionToViewPosition(new P(c,this._context.viewModel.model.getLineMaxColumn(c))).lineNumber,u=Math.max(d,t),g=Math.min(h,i);for(let f=u;f<=g;f++){const m=f-t;n[m]=r}}}const o=this._renderOne(e,!0);for(const r of this._cursorLineNumbers){if(r<t||r>i)continue;const a=r-t;n[a]=o}this._renderData=n}render(e,t){if(!this._renderData)return"";const i=t-e;return i>=this._renderData.length?"":this._renderData[i]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}}class U_e extends Q${_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-both":"")+(t?" current-line-exact":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}}class $_e extends Q${_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")+(this._shouldRenderInMargin()&&t?" current-line-exact-margin":"")}" style="width:${this._contentLeft}px"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}}kr((s,e)=>{const t=s.getColor(dU);if(t&&(e.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${t}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${t}; border: none; }`)),!t||t.isTransparent()||s.defines(GB)){const i=s.getColor(GB);i&&(e.addRule(`.monaco-editor .view-overlays .current-line-exact { border: 2px solid ${i}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-exact-margin { border: 2px solid ${i}; }`),Ra(s.type)&&(e.addRule(".monaco-editor .view-overlays .current-line-exact { border-width: 1px; }"),e.addRule(".monaco-editor .margin-view-overlays .current-line-exact-margin { border-width: 1px; }")))}});class j_e extends Sg{constructor(e){super(),this._context=e;const t=this._context.configuration.options;this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){const t=e.getDecorationsInViewport();let i=[],n=0;for(let l=0,c=t.length;l<c;l++){const d=t[l];d.options.className&&(i[n++]=d)}i=i.sort((l,c)=>{if(l.options.zIndex<c.options.zIndex)return-1;if(l.options.zIndex>c.options.zIndex)return 1;const d=l.options.className,h=c.options.className;return d<h?-1:d>h?1:k.compareRangesUsingStarts(l.range,c.range)});const o=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber,a=[];for(let l=o;l<=r;l++){const c=l-o;a[c]=""}this._renderWholeLineDecorations(e,i,a),this._renderNormalDecorations(e,i,a),this._renderResult=a}_renderWholeLineDecorations(e,t,i){const n=e.visibleRange.startLineNumber,o=e.visibleRange.endLineNumber;for(let r=0,a=t.length;r<a;r++){const l=t[r];if(!l.options.isWholeLine)continue;const c='<div class="cdr '+l.options.className+'" style="left:0;width:100%;"></div>',d=Math.max(l.range.startLineNumber,n),h=Math.min(l.range.endLineNumber,o);for(let u=d;u<=h;u++){const g=u-n;i[g]+=c}}}_renderNormalDecorations(e,t,i){const n=e.visibleRange.startLineNumber;let o=null,r=!1,a=null,l=!1;for(let c=0,d=t.length;c<d;c++){const h=t[c];if(h.options.isWholeLine)continue;const u=h.options.className,g=!!h.options.showIfCollapsed;let f=h.range;if(g&&f.endColumn===1&&f.endLineNumber!==f.startLineNumber&&(f=new k(f.startLineNumber,f.startColumn,f.endLineNumber-1,this._context.viewModel.getLineMaxColumn(f.endLineNumber-1))),o===u&&r===g&&k.areIntersectingOrTouching(a,f)){a=k.plusRange(a,f);continue}o!==null&&this._renderNormalDecoration(e,a,o,l,r,n,i),o=u,r=g,a=f,l=h.options.shouldFillLineOnLineBreak??!1}o!==null&&this._renderNormalDecoration(e,a,o,l,r,n,i)}_renderNormalDecoration(e,t,i,n,o,r,a){const l=e.linesVisibleRangesForRange(t,i==="findMatch");if(l)for(let c=0,d=l.length;c<d;c++){const h=l[c];if(h.outsideRenderedLine)continue;const u=h.lineNumber-r;if(o&&h.ranges.length===1){const g=h.ranges[0];if(g.width<this._typicalHalfwidthCharacterWidth){const f=Math.round(g.left+g.width/2),m=Math.max(0,Math.round(f-this._typicalHalfwidthCharacterWidth/2));h.ranges[0]=new kx(m,this._typicalHalfwidthCharacterWidth)}}for(let g=0,f=h.ranges.length;g<f;g++){const m=n&&h.continuesOnNextLine&&f===1,_=h.ranges[g],b='<div class="cdr '+i+'" style="left:'+String(_.left)+"px;width:"+(m?"100%;":String(_.width)+"px;")+'"></div>';a[u]+=b}}}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class Z_e extends yo{constructor(e,t,i,n){super(e);const o=this._context.configuration.options,r=o.get(104),a=o.get(75),l=o.get(40),c=o.get(107),d={listenOnDomNode:i.domNode,className:"editor-scrollable "+SE(e.theme.type),useShadows:!1,lazyRender:!0,vertical:r.vertical,horizontal:r.horizontal,verticalHasArrows:r.verticalHasArrows,horizontalHasArrows:r.horizontalHasArrows,verticalScrollbarSize:r.verticalScrollbarSize,verticalSliderSize:r.verticalSliderSize,horizontalScrollbarSize:r.horizontalScrollbarSize,horizontalSliderSize:r.horizontalSliderSize,handleMouseWheel:r.handleMouseWheel,alwaysConsumeMouseWheel:r.alwaysConsumeMouseWheel,arrowSize:r.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:c,scrollByPage:r.scrollByPage};this.scrollbar=this._register(new YL(t.domNode,d,this._context.viewLayout.getScrollable())),Ua.write(this.scrollbar.getDomNode(),6),this.scrollbarDomNode=Ct(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();const h=(u,g,f)=>{const m={};{const _=u.scrollTop;_&&(m.scrollTop=this._context.viewLayout.getCurrentScrollTop()+_,u.scrollTop=0)}if(f){const _=u.scrollLeft;_&&(m.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+_,u.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(m,1)};this._register(U(i.domNode,"scroll",u=>h(i.domNode,!0,!0))),this._register(U(t.domNode,"scroll",u=>h(t.domNode,!0,!1))),this._register(U(n.domNode,"scroll",u=>h(n.domNode,!0,!1))),this._register(U(this.scrollbarDomNode.domNode,"scroll",u=>h(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){const e=this._context.configuration.options,t=e.get(146);this.scrollbarDomNode.setLeft(t.contentLeft),e.get(73).side==="right"?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(e){this.scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this.scrollbar.delegateScrollFromMouseWheelEvent(e)}onConfigurationChanged(e){if(e.hasChanged(104)||e.hasChanged(75)||e.hasChanged(40)){const t=this._context.configuration.options,i=t.get(104),n=t.get(75),o=t.get(40),r=t.get(107),a={vertical:i.vertical,horizontal:i.horizontal,verticalScrollbarSize:i.verticalScrollbarSize,horizontalScrollbarSize:i.horizontalScrollbarSize,scrollByPage:i.scrollByPage,handleMouseWheel:i.handleMouseWheel,mouseWheelScrollSensitivity:n,fastScrollSensitivity:o,scrollPredominantAxis:r};this.scrollbar.updateOptions(a)}return e.hasChanged(146)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+SE(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}}class wR{constructor(e,t,i,n,o){this.startLineNumber=e,this.endLineNumber=t,this.className=i,this.tooltip=n,this._decorationToRenderBrand=void 0,this.zIndex=o??0}}class K_e{constructor(e,t,i){this.className=e,this.zIndex=t,this.tooltip=i}}class q_e{constructor(){this.decorations=[]}add(e){this.decorations.push(e)}getDecorations(){return this.decorations}}class J$ extends Sg{_render(e,t,i){const n=[];for(let a=e;a<=t;a++){const l=a-e;n[l]=new q_e}if(i.length===0)return n;i.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let o=null,r=0;for(let a=0,l=i.length;a<l;a++){const c=i[a],d=c.className,h=c.zIndex;let u=Math.max(c.startLineNumber,e)-e;const g=Math.min(c.endLineNumber,t)-e;o===d?(u=Math.max(r+1,u),r=Math.max(r,g)):(o=d,r=g);for(let f=u;f<=r;f++)n[f].add(new K_e(d,h,c.tooltip))}return n}}class G_e extends yo{constructor(e){super(e),this._widgets={},this._context=e;const t=this._context.configuration.options,i=t.get(146);this.domNode=Ct(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=t.get(67),this._glyphMargin=t.get(57),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(146);return this._lineHeight=t.get(67),this._glyphMargin=t.get(57),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}addWidget(e){const t=Ct(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:e.getPosition(),domNode:t,renderInfo:null},t.setPosition("absolute"),t.setDisplay("none"),t.setAttribute("widgetId",e.getId()),this.domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){const i=this._widgets[e.getId()];return i.preference.lane===t.lane&&i.preference.zIndex===t.zIndex&&k.equalsRange(i.preference.range,t.range)?!1:(i.preference=t,this.setShouldRender(),!0)}removeWidget(e){const t=e.getId();if(this._widgets[t]){const n=this._widgets[t].domNode.domNode;delete this._widgets[t],n.remove(),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(e,t){const i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,o=e.getDecorationsInViewport();for(const r of o){const a=r.options.glyphMarginClassName;if(!a)continue;const l=Math.max(r.range.startLineNumber,i),c=Math.min(r.range.endLineNumber,n),d=r.options.glyphMargin?.position??Jr.Center,h=r.options.zIndex??0;for(let u=l;u<=c;u++){const g=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new P(u,0)),f=this._context.viewModel.glyphLanes.getLanesAtLine(g.lineNumber).indexOf(d);t.push(new Y_e(u,f,h,a))}}}_collectWidgetBasedGlyphRenderRequest(e,t){const i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;for(const o of Object.values(this._widgets)){const r=o.preference.range,{startLineNumber:a,endLineNumber:l}=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(k.lift(r));if(!a||!l||l<i||a>n)continue;const c=Math.max(a,i),d=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new P(c,0)),h=this._context.viewModel.glyphLanes.getLanesAtLine(d.lineNumber).indexOf(o.preference.lane);t.push(new X_e(c,h,o.preference.zIndex,o))}}_collectSortedGlyphRenderRequests(e){const t=[];return this._collectDecorationBasedGlyphRenderRequest(e,t),this._collectWidgetBasedGlyphRenderRequest(e,t),t.sort((i,n)=>i.lineNumber===n.lineNumber?i.laneIndex===n.laneIndex?i.zIndex===n.zIndex?n.type===i.type?i.type===0&&n.type===0?i.className<n.className?-1:1:0:n.type-i.type:n.zIndex-i.zIndex:i.laneIndex-n.laneIndex:i.lineNumber-n.lineNumber),t}prepareRender(e){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(const n of Object.values(this._widgets))n.renderInfo=null;const t=new Oc(this._collectSortedGlyphRenderRequests(e)),i=[];for(;t.length>0;){const n=t.peek();if(!n)break;const o=t.takeWhile(a=>a.lineNumber===n.lineNumber&&a.laneIndex===n.laneIndex);if(!o||o.length===0)break;const r=o[0];if(r.type===0){const a=[];for(const l of o){if(l.zIndex!==r.zIndex||l.type!==r.type)break;(a.length===0||a[a.length-1]!==l.className)&&a.push(l.className)}i.push(r.accept(a.join(" ")))}else r.widget.renderInfo={lineNumber:r.lineNumber,laneIndex:r.laneIndex}}this._decorationGlyphsToRender=i}render(e){if(!this._glyphMargin){for(const i of Object.values(this._widgets))i.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;)this._managedDomNodes.pop()?.domNode.remove();return}const t=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(const i of Object.values(this._widgets))if(!i.renderInfo)i.domNode.setDisplay("none");else{const n=e.viewportData.relativeVerticalOffset[i.renderInfo.lineNumber-e.viewportData.startLineNumber],o=this._glyphMarginLeft+i.renderInfo.laneIndex*this._lineHeight;i.domNode.setDisplay("block"),i.domNode.setTop(n),i.domNode.setLeft(o),i.domNode.setWidth(t),i.domNode.setHeight(this._lineHeight)}for(let i=0;i<this._decorationGlyphsToRender.length;i++){const n=this._decorationGlyphsToRender[i],o=e.viewportData.relativeVerticalOffset[n.lineNumber-e.viewportData.startLineNumber],r=this._glyphMarginLeft+n.laneIndex*this._lineHeight;let a;i<this._managedDomNodes.length?a=this._managedDomNodes[i]:(a=Ct(document.createElement("div")),this._managedDomNodes.push(a),this.domNode.appendChild(a)),a.setClassName("cgmr codicon "+n.combinedClassName),a.setPosition("absolute"),a.setTop(o),a.setLeft(r),a.setWidth(t),a.setHeight(this._lineHeight)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;)this._managedDomNodes.pop()?.domNode.remove()}}class Y_e{constructor(e,t,i,n){this.lineNumber=e,this.laneIndex=t,this.zIndex=i,this.className=n,this.type=0}accept(e){return new Q_e(this.lineNumber,this.laneIndex,e)}}class X_e{constructor(e,t,i,n){this.lineNumber=e,this.laneIndex=t,this.zIndex=i,this.widget=n,this.type=1}}class Q_e{constructor(e,t,i){this.lineNumber=e,this.laneIndex=t,this.combinedClassName=i}}class J_e extends Sg{constructor(e){super(),this._context=e,this._primaryPosition=null;const t=this._context.configuration.options,i=t.get(147),n=t.get(50);this._spaceWidth=n.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(147),n=t.get(50);return this._spaceWidth=n.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),!0}onCursorStateChanged(e){const i=e.selections[0].getPosition();return this._primaryPosition?.equals(i)?!1:(this._primaryPosition=i,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=e.scrollWidth,o=this._primaryPosition,r=this.getGuidesByLine(t,Math.min(i+1,this._context.viewModel.getLineCount()),o),a=[];for(let l=t;l<=i;l++){const c=l-t,d=r[c];let h="";const u=e.visibleRangeForPosition(new P(l,1))?.left??0;for(const g of d){const f=g.column===-1?u+(g.visibleColumn-1)*this._spaceWidth:e.visibleRangeForPosition(new P(l,g.column)).left;if(f>n||this._maxIndentLeft>0&&f>this._maxIndentLeft)break;const m=g.horizontalLine?g.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",_=g.horizontalLine?(e.visibleRangeForPosition(new P(l,g.horizontalLine.endColumn))?.left??f+this._spaceWidth)-f:this._spaceWidth;h+=`<div class="core-guide ${g.className} ${m}" style="left:${f}px;width:${_}px"></div>`}a[c]=h}this._renderResult=a}getGuidesByLine(e,t,i){const n=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(e,t,i,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?Eu.Enabled:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?Eu.EnabledForActive:Eu.Disabled,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,o=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(e,t):null;let r=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&i){const h=this._context.viewModel.getActiveIndentGuide(i.lineNumber,e,t);r=h.startLineNumber,a=h.endLineNumber,l=h.indent}const{indentSize:c}=this._context.viewModel.model.getOptions(),d=[];for(let h=e;h<=t;h++){const u=new Array;d.push(u);const g=n?n[h-e]:[],f=new Oc(g),m=o?o[h-e]:0;for(let _=1;_<=m;_++){const b=(_-1)*c+1,v=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||g.length===0)&&r<=h&&h<=a&&_===l;u.push(...f.takeWhile(y=>y.visibleColumn<b)||[]);const C=f.peek();(!C||C.visibleColumn!==b||C.horizontalLine)&&u.push(new Cu(b,-1,`core-guide-indent lvl-${(_-1)%30}`+(v?" indent-active":""),null,-1,-1))}u.push(...f.takeWhile(_=>!0)||[])}return d}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}function qg(s){if(!(s&&s.isTransparent()))return s}kr((s,e)=>{const t=[{bracketColor:fU,guideColor:_he,guideColorActive:She},{bracketColor:pU,guideColor:bhe,guideColorActive:Lhe},{bracketColor:mU,guideColor:vhe,guideColorActive:xhe},{bracketColor:_U,guideColor:Che,guideColorActive:khe},{bracketColor:bU,guideColor:yhe,guideColorActive:Dhe},{bracketColor:vU,guideColor:whe,guideColorActive:Ihe}],i=new EU,n=[{indentColor:BC,indentColorActive:WC},{indentColor:Yde,indentColorActive:the},{indentColor:Xde,indentColorActive:ihe},{indentColor:Qde,indentColorActive:nhe},{indentColor:Jde,indentColorActive:she},{indentColor:ehe,indentColorActive:ohe}],o=t.map(a=>{const l=s.getColor(a.bracketColor),c=s.getColor(a.guideColor),d=s.getColor(a.guideColorActive),h=qg(qg(c)??l?.transparent(.3)),u=qg(qg(d)??l);if(!(!h||!u))return{guideColor:h,guideColorActive:u}}).filter(Sl),r=n.map(a=>{const l=s.getColor(a.indentColor),c=s.getColor(a.indentColorActive),d=qg(l),h=qg(c);if(!(!d||!h))return{indentColor:d,indentColorActive:h}}).filter(Sl);if(o.length>0){for(let a=0;a<30;a++){const l=o[a%o.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}e.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),e.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),e.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),e.addRule(`.monaco-editor .vertical.${i.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),e.addRule(`.monaco-editor .horizontal-top.${i.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),e.addRule(`.monaco-editor .horizontal-bottom.${i.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(r.length>0){for(let a=0;a<30;a++){const l=r[a%r.length];e.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${a} { --indent-color: ${l.indentColor}; --indent-color-active: ${l.indentColorActive}; }`)}e.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),e.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});class GD{get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;const e=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=e.left,this._clientRectScale=e.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}constructor(e,t){this._domNode=e,this.endNode=t,this._didDomLayout=!1,this._clientRectDeltaLeft=0,this._clientRectScale=1,this._clientRectRead=!1}markDidDomLayout(){this._didDomLayout=!0}}class ebe{constructor(){this._currentVisibleRange=new k(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}}class tbe{constructor(e,t,i,n,o,r,a){this.minimalReveal=e,this.lineNumber=t,this.startColumn=i,this.endColumn=n,this.startScrollTop=o,this.stopScrollTop=r,this.scrollType=a,this.type="range",this.minLineNumber=t,this.maxLineNumber=t}}class ibe{constructor(e,t,i,n,o){this.minimalReveal=e,this.selections=t,this.startScrollTop=i,this.stopScrollTop=n,this.scrollType=o,this.type="selections";let r=t[0].startLineNumber,a=t[0].endLineNumber;for(let l=1,c=t.length;l<c;l++){const d=t[l];r=Math.min(r,d.startLineNumber),a=Math.max(a,d.endLineNumber)}this.minLineNumber=r,this.maxLineNumber=a}}class eF extends yo{static{this.HORIZONTAL_EXTRA_PX=30}constructor(e,t){super(e);const i=this._context.configuration,n=this._context.configuration.options,o=n.get(50),r=n.get(147);this._lineHeight=n.get(67),this._typicalHalfwidthCharacterWidth=o.typicalHalfwidthCharacterWidth,this._isViewportWrapping=r.isViewportWrapping,this._revealHorizontalRightPadding=n.get(101),this._cursorSurroundingLines=n.get(29),this._cursorSurroundingLinesStyle=n.get(30),this._canUseLayerHinting=!n.get(32),this._viewLineOptions=new e9(i,this._context.theme.type),this._linesContent=t,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new Y$({createLine:()=>new bc(this._viewLineOptions)}),this.domNode=this._visibleLines.domNode,Ua.write(this.domNode,8),this.domNode.setClassName(`view-lines ${lp}`),wn(this.domNode,o),this._maxLineWidth=0,this._asyncUpdateLineWidths=new It(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new It(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new ebe,this._horizontalRevealRequest=null,this._stickyScrollEnabled=n.get(116).enabled,this._maxNumberStickyLines=n.get(116).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(147)&&(this._maxLineWidth=0);const t=this._context.configuration.options,i=t.get(50),n=t.get(147);return this._lineHeight=t.get(67),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._isViewportWrapping=n.isViewportWrapping,this._revealHorizontalRightPadding=t.get(101),this._cursorSurroundingLines=t.get(29),this._cursorSurroundingLinesStyle=t.get(30),this._canUseLayerHinting=!t.get(32),this._stickyScrollEnabled=t.get(116).enabled,this._maxNumberStickyLines=t.get(116).maxLineCount,wn(this.domNode,i),this._onOptionsMaybeChanged(),e.hasChanged(146)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){const e=this._context.configuration,t=new e9(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let o=i;o<=n;o++)this._visibleLines.getVisibleLine(o).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let n=!1;for(let o=t;o<=i;o++)n=this._visibleLines.getVisibleLine(o).onSelectionChanged()||n;return n}onDecorationsChanged(e){{const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=t;n<=i;n++)this._visibleLines.getVisibleLine(n).onDecorationsChanged()}return!0}onFlushed(e){const t=this._visibleLines.onFlushed(e);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){const t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.minimalReveal,e.range,e.selections,e.verticalType);if(t===-1)return!1;let i=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?i={scrollTop:i.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new tbe(e.minimalReveal,e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new ibe(e.minimalReveal,e.selections,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;const o=Math.abs(this._context.viewLayout.getCurrentScrollTop()-i.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(i,o),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){const t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),i=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>i)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){const i=this._getViewLineDomNode(e);if(i===null)return null;const n=this._getLineNumberFor(i);if(n===-1||n<1||n>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(n)===1)return new P(n,1);const o=this._visibleLines.getStartLineNumber(),r=this._visibleLines.getEndLineNumber();if(n<o||n>r)return null;let a=this._visibleLines.getVisibleLine(n).getColumnOfNodeOffset(e,t);const l=this._context.viewModel.getLineMinColumn(n);return a<l&&(a=l),new P(n,a)}_getViewLineDomNode(e){for(;e&&e.nodeType===1;){if(e.className===bc.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=t;n<=i;n++){const o=this._visibleLines.getVisibleLine(n);if(e===o.getDomNode())return n}return-1}getLineWidth(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();if(e<t||e>i)return-1;const n=new GD(this.domNode.domNode,this._textRangeRestingSpot),o=this._visibleLines.getVisibleLine(e).getWidth(n);return this._updateLineWidthsSlowIfDomDidLayout(n),o}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;const i=e.endLineNumber,n=k.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!n)return null;const o=[];let r=0;const a=new GD(this.domNode.domNode,this._textRangeRestingSpot);let l=0;t&&(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new P(n.startLineNumber,1)).lineNumber);const c=this._visibleLines.getStartLineNumber(),d=this._visibleLines.getEndLineNumber();for(let h=n.startLineNumber;h<=n.endLineNumber;h++){if(h<c||h>d)continue;const u=h===n.startLineNumber?n.startColumn:1,g=h!==n.endLineNumber,f=g?this._context.viewModel.getLineMaxColumn(h):n.endColumn,m=this._visibleLines.getVisibleLine(h).getVisibleRangesForRange(h,u,f,a);if(m){if(t&&h<i){const _=l;l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new P(h+1,1)).lineNumber,_!==l&&(m.ranges[m.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}o[r++]=new Hme(m.outsideRenderedLine,h,kx.from(m.ranges),g)}}return this._updateLineWidthsSlowIfDomDidLayout(a),r===0?null:o}_visibleRangesForLineRange(e,t,i){if(this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber())return null;const n=new GD(this.domNode.domNode,this._textRangeRestingSpot),o=this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(e,t,i,n);return this._updateLineWidthsSlowIfDomDidLayout(n),o}visibleRangeForPosition(e){const t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new Vme(t.outsideRenderedLine,t.ranges[0].left):null}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(e){e.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let n=1,o=!0;for(let r=t;r<=i;r++){const a=this._visibleLines.getVisibleLine(r);if(e&&!a.getWidthIsFast()){o=!1;continue}n=Math.max(n,a.getWidth(null))}return o&&t===1&&i===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(n),o}_checkMonospaceFontAssumptions(){let e=-1,t=-1;const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let o=i;o<=n;o++){const r=this._visibleLines.getVisibleLine(o);if(r.needsMonospaceFontCheck()){const a=r.getWidth(null);a>t&&(t=a,e=o)}}if(e!==-1&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let o=i;o<=n;o++)this._visibleLines.getVisibleLine(o).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){const i=this._horizontalRevealRequest;if(e.startLineNumber<=i.minLineNumber&&i.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();const n=this._computeScrollLeftToReveal(i);n&&(this._isViewportWrapping||this._ensureMaxLineWidth(n.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:n.scrollLeft},i.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),ys&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let o=i;o<=n;o++)if(this._visibleLines.getVisibleLine(o).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");const t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){const t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,i,n,o,r){const a=e.top,l=e.height,c=a+l;let d,h,u;if(o&&o.length>0){let b=o[0].startLineNumber,v=o[0].endLineNumber;for(let C=1,y=o.length;C<y;C++){const w=o[C];b=Math.min(b,w.startLineNumber),v=Math.max(v,w.endLineNumber)}d=!1,h=this._context.viewLayout.getVerticalOffsetForLineNumber(b),u=this._context.viewLayout.getVerticalOffsetForLineNumber(v)+this._lineHeight}else if(n)d=!0,h=this._context.viewLayout.getVerticalOffsetForLineNumber(n.startLineNumber),u=this._context.viewLayout.getVerticalOffsetForLineNumber(n.endLineNumber)+this._lineHeight;else return-1;const g=(t==="mouse"||i)&&this._cursorSurroundingLinesStyle==="default";let f=0,m=0;if(g)i||(f=this._lineHeight);else{const b=l/this._lineHeight,v=Math.max(this._cursorSurroundingLines,this._stickyScrollEnabled?this._maxNumberStickyLines:0),C=Math.min(b/2,v);f=C*this._lineHeight,m=Math.max(0,C-1)*this._lineHeight}i||(r===0||r===4)&&(m+=this._lineHeight),h-=f,u+=m;let _;if(u-h>l){if(!d)return-1;_=h}else if(r===5||r===6)if(r===6&&a<=h&&u<=c)_=a;else{const b=Math.max(5*this._lineHeight,l*.2),v=h-b,C=u-l;_=Math.max(C,v)}else if(r===1||r===2)if(r===2&&a<=h&&u<=c)_=a;else{const b=(h+u)/2;_=Math.max(0,b-l/2)}else _=this._computeMinimumScrolling(a,c,h,u,r===3,r===4);return _}_computeScrollLeftToReveal(e){const t=this._context.viewLayout.getCurrentViewport(),i=this._context.configuration.options.get(146),n=t.left,o=n+t.width-i.verticalScrollbarWidth;let r=1073741824,a=0;if(e.type==="range"){const c=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!c)return null;for(const d of c.ranges)r=Math.min(r,Math.round(d.left)),a=Math.max(a,Math.round(d.left+d.width))}else for(const c of e.selections){if(c.startLineNumber!==c.endLineNumber)return null;const d=this._visibleRangesForLineRange(c.startLineNumber,c.startColumn,c.endColumn);if(!d)return null;for(const h of d.ranges)r=Math.min(r,Math.round(h.left)),a=Math.max(a,Math.round(h.left+h.width))}return e.minimalReveal||(r=Math.max(0,r-eF.HORIZONTAL_EXTRA_PX),a+=this._revealHorizontalRightPadding),e.type==="selections"&&a-r>t.width?null:{scrollLeft:this._computeMinimumScrolling(n,o,r,a),maxHorizontalOffset:a}}_computeMinimumScrolling(e,t,i,n,o,r){e=e|0,t=t|0,i=i|0,n=n|0,o=!!o,r=!!r;const a=t-e;if(n-i<a){if(o)return i;if(r)return Math.max(0,n-a);if(i<e)return i;if(n>t)return Math.max(0,n-a)}else return i;return e}}class nbe extends J${constructor(e){super(),this._context=e;const i=this._context.configuration.options.get(146);this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const i=this._context.configuration.options.get(146);return this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let n=0;for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.options.linesDecorationsClassName,c=a.options.zIndex;l&&(i[n++]=new wR(a.range.startLineNumber,a.range.endLineNumber,l,a.options.linesDecorationsTooltip??null,c));const d=a.options.firstLineDecorationClassName;d&&(i[n++]=new wR(a.range.startLineNumber,a.range.startLineNumber,d,a.options.linesDecorationsTooltip??null,c))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),o=this._decorationsLeft.toString(),r=this._decorationsWidth.toString(),a='" style="left:'+o+"px;width:"+r+'px;"></div>',l=[];for(let c=t;c<=i;c++){const d=c-t,h=n[d].getDecorations();let u="";for(const g of h){let f='<div class="cldr '+g.className;g.tooltip!==null&&(f+='" title="'+g.tooltip),f+=a,u+=f}l[d]=u}this._renderResult=l}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}class sbe extends J${constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let n=0;for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.options.marginClassName,c=a.options.zIndex;l&&(i[n++]=new wR(a.range.startLineNumber,a.range.endLineNumber,l,null,c))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),o=[];for(let r=t;r<=i;r++){const a=r-t,l=n[a].getDecorations();let c="";for(const d of l)c+='<div class="cmdr '+d.className+'" style=""></div>';o[a]=c}this._renderResult=o}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}class hr{static{this.Empty=new hr(0,0,0,0)}constructor(e,t,i,n){this._rgba8Brand=void 0,this.r=hr._clamp(e),this.g=hr._clamp(t),this.b=hr._clamp(i),this.a=hr._clamp(n)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:e|0}}class Rx extends B{static{this._INSTANCE=null}static getInstance(){return this._INSTANCE||(this._INSTANCE=new Rx),this._INSTANCE}constructor(){super(),this._onDidChange=new O,this.onDidChange=this._onDidChange.event,this._updateColorMap(),this._register(mi.onDidChange(e=>{e.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){const e=mi.getColorMap();if(!e){this._colors=[hr.Empty],this._backgroundIsLight=!0;return}this._colors=[hr.Empty];for(let i=1;i<e.length;i++){const n=e[i].rgba;this._colors[i]=new hr(n.r,n.g,n.b,Math.round(n.a*255))}const t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}}const obe=(()=>{const s=[];for(let e=32;e<=126;e++)s.push(e);return s.push(65533),s})(),rbe=(s,e)=>(s-=32,s<0||s>96?e<=2?(s+96)%96:95:s);class Mv{constructor(e,t){this.scale=t,this._minimapCharRendererBrand=void 0,this.charDataNormal=Mv.soften(e,12/15),this.charDataLight=Mv.soften(e,50/60)}static soften(e,t){const i=new Uint8ClampedArray(e.length);for(let n=0,o=e.length;n<o;n++)i[n]=G1(e[n]*t);return i}renderChar(e,t,i,n,o,r,a,l,c,d,h){const u=1*this.scale,g=2*this.scale,f=h?1:g;if(t+u>e.width||i+f>e.height){console.warn("bad render request outside image data");return}const m=d?this.charDataLight:this.charDataNormal,_=rbe(n,c),b=e.width*4,v=a.r,C=a.g,y=a.b,w=o.r-v,x=o.g-C,L=o.b-y,D=Math.max(r,l),T=e.data;let F=_*u*g,W=i*b+t*4;for(let H=0;H<f;H++){let $=W;for(let V=0;V<u;V++){const Y=m[F++]/255*(r/255);T[$++]=v+w*Y,T[$++]=C+x*Y,T[$++]=y+L*Y,T[$++]=D}W+=b}}blockRenderChar(e,t,i,n,o,r,a,l){const c=1*this.scale,d=2*this.scale,h=l?1:d;if(t+c>e.width||i+h>e.height){console.warn("bad render request outside image data");return}const u=e.width*4,g=.5*(o/255),f=r.r,m=r.g,_=r.b,b=n.r-f,v=n.g-m,C=n.b-_,y=f+b*g,w=m+v*g,x=_+C*g,L=Math.max(o,a),D=e.data;let T=i*u+t*4;for(let F=0;F<h;F++){let W=T;for(let H=0;H<c;H++)D[W++]=y,D[W++]=w,D[W++]=x,D[W++]=L;T+=u}}}const c9={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},d9=s=>{const e=new Uint8ClampedArray(s.length/2);for(let t=0;t<s.length;t+=2)e[t>>1]=c9[s[t]]<<4|c9[s[t+1]]&15;return e},h9={1:eh(()=>d9("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:eh(()=>d9("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};class gb{static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let i;return h9[e]?i=new Mv(h9[e](),e):i=gb.createFromSampleData(gb.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=i,i}static createSampleData(e){const t=document.createElement("canvas"),i=t.getContext("2d");t.style.height="16px",t.height=16,t.width=96*10,t.style.width=96*10+"px",i.fillStyle="#ffffff",i.font=`bold 16px ${e}`,i.textBaseline="middle";let n=0;for(const o of obe)i.fillText(String.fromCharCode(o),n,16/2),n+=10;return i.getImageData(0,0,96*10,16)}static createFromSampleData(e,t){if(e.length!==61440)throw new Error("Unexpected source in MinimapCharRenderer");const n=gb._downsample(e,t);return new Mv(n,t)}static _downsampleChar(e,t,i,n,o){const r=1*o,a=2*o;let l=n,c=0;for(let d=0;d<a;d++){const h=d/a*16,u=(d+1)/a*16;for(let g=0;g<r;g++){const f=g/r*10,m=(g+1)/r*10;let _=0,b=0;for(let C=h;C<u;C++){const y=t+Math.floor(C)*3840,w=1-(C-Math.floor(C));for(let x=f;x<m;x++){const L=1-(x-Math.floor(x)),D=y+Math.floor(x)*4,T=L*w;b+=T,_+=e[D]*e[D+3]/255*T}}const v=_/b;c=Math.max(c,v),i[l++]=G1(v)}}return c}static _downsample(e,t){const i=2*t*1*t,n=i*96,o=new Uint8ClampedArray(n);let r=0,a=0,l=0;for(let c=0;c<96;c++)l=Math.max(l,this._downsampleChar(e,a,o,r,t)),r+=i,a+=10*4;if(l>0){const c=255/l;for(let d=0;d<n;d++)o[d]*=c}return o}}const ej=An?'"Segoe WPC", "Segoe UI", sans-serif':Qe?"-apple-system, BlinkMacSystemFont, sans-serif":'system-ui, "Ubuntu", "Droid Sans", sans-serif',abe=140,lbe=2;class hp{constructor(e,t,i){const n=e.options,o=n.get(144),r=n.get(146),a=r.minimap,l=n.get(50),c=n.get(73);this.renderMinimap=a.renderMinimap,this.size=c.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=n.get(106),this.paddingTop=n.get(84).top,this.paddingBottom=n.get(84).bottom,this.showSlider=c.showSlider,this.autohide=c.autohide,this.pixelRatio=o,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=n.get(67),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=r.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=r.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.sectionHeaderFontFamily=ej,this.sectionHeaderFontSize=c.sectionHeaderFontSize*o,this.sectionHeaderLetterSpacing=c.sectionHeaderLetterSpacing,this.sectionHeaderFontColor=hp._getSectionHeaderColor(t,i.getColor(1)),this.charRenderer=eh(()=>gb.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=i.getColor(2),this.backgroundColor=hp._getMinimapBackground(t,this.defaultBackgroundColor),this.foregroundAlpha=hp._getMinimapForegroundOpacity(t)}static _getMinimapBackground(e,t){const i=e.getColor(Xoe);return i?new hr(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):t}static _getMinimapForegroundOpacity(e){const t=e.getColor(Qoe);return t?hr._clamp(Math.round(255*t.rgba.a)):255}static _getSectionHeaderColor(e,t){const i=e.getColor(Hl);return i?new hr(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):t}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.paddingTop===e.paddingTop&&this.paddingBottom===e.paddingBottom&&this.showSlider===e.showSlider&&this.autohide===e.autohide&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.sectionHeaderFontSize===e.sectionHeaderFontSize&&this.sectionHeaderLetterSpacing===e.sectionHeaderLetterSpacing&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(e.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)&&this.foregroundAlpha===e.foregroundAlpha}}class fb{constructor(e,t,i,n,o,r,a,l,c){this.scrollTop=e,this.scrollHeight=t,this.sliderNeeded=i,this._computedSliderRatio=n,this.sliderTop=o,this.sliderHeight=r,this.topPaddingLineCount=a,this.startLineNumber=l,this.endLineNumber=c}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(e){const t=Math.max(this.startLineNumber,e.startLineNumber),i=Math.min(this.endLineNumber,e.endLineNumber);return t>i?null:[t,i]}getYForLineNumber(e,t){return+(e-this.startLineNumber+this.topPaddingLineCount)*t}static create(e,t,i,n,o,r,a,l,c,d,h){const u=e.pixelRatio,g=e.minimapLineHeight,f=Math.floor(e.canvasInnerHeight/g),m=e.lineHeight;if(e.minimapHeightIsEditorHeight){let x=l*e.lineHeight+e.paddingTop+e.paddingBottom;e.scrollBeyondLastLine&&(x+=Math.max(0,o-e.lineHeight-e.paddingBottom));const L=Math.max(1,Math.floor(o*o/x)),D=Math.max(0,e.minimapHeight-L),T=D/(d-o),F=c*T,W=D>0,H=Math.floor(e.canvasInnerHeight/e.minimapLineHeight),$=Math.floor(e.paddingTop/e.lineHeight);return new fb(c,d,W,T,F,L,$,1,Math.min(a,H))}let _;if(r&&i!==a){const x=i-t+1;_=Math.floor(x*g/u)}else{const x=o/m;_=Math.floor(x*g/u)}const b=Math.floor(e.paddingTop/m);let v=Math.floor(e.paddingBottom/m);if(e.scrollBeyondLastLine){const x=o/m;v=Math.max(v,x-1)}let C;if(v>0){const x=o/m;C=(b+a+v-x-1)*g/u}else C=Math.max(0,(b+a)*g/u-_);C=Math.min(e.minimapHeight-_,C);const y=C/(d-o),w=c*y;if(f>=b+a+v){const x=C>0;return new fb(c,d,x,y,w,_,b,1,a)}else{let x;t>1?x=t+b:x=Math.max(1,c/m);let L,D=Math.max(1,Math.floor(x-w*u/g));D<b?(L=b-D+1,D=1):(L=0,D=Math.max(1,D-b)),h&&h.scrollHeight===d&&(h.scrollTop>c&&(D=Math.min(D,h.startLineNumber),L=Math.max(L,h.topPaddingLineCount)),h.scrollTop<c&&(D=Math.max(D,h.startLineNumber),L=Math.min(L,h.topPaddingLineCount)));const T=Math.min(a,D-L+f-1),F=(c-n)/m;let W;return c>=e.paddingTop?W=(t-D+L+F)*g/u:W=c/e.paddingTop*(L+F)*g/u,new fb(c,d,!0,y,W,_,L,D,T)}}}class Mx{static{this.INVALID=new Mx(-1)}constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}}class u9{constructor(e,t,i){this.renderedLayout=e,this._imageData=t,this._renderedLines=new G$({createLine:()=>Mx.INVALID}),this._renderedLines._set(e.startLineNumber,i)}linesEquals(e){if(!this.scrollEquals(e))return!1;const i=this._renderedLines._get().lines;for(let n=0,o=i.length;n<o;n++)if(i[n].dy===-1)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){const e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}}class tF{constructor(e,t,i,n){this._backgroundFillData=tF._createBackgroundFillData(t,i,n),this._buffers=[e.createImageData(t,i),e.createImageData(t,i)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;const e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,i){const n=i.r,o=i.g,r=i.b,a=i.a,l=new Uint8ClampedArray(e*t*4);let c=0;for(let d=0;d<t;d++)for(let h=0;h<e;h++)l[c]=n,l[c+1]=o,l[c+2]=r,l[c+3]=a,c+=4;return l}}class Av{static compute(e,t,i){if(e.renderMinimap===0||!e.isSampling)return[null,[]];const{minimapLineCount:n}=$f.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:e.scrollBeyondLastLine,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:e.editorHeight,lineHeight:e.lineHeight,pixelRatio:e.pixelRatio}),o=t/n,r=o/2;if(!i||i.minimapLines.length===0){const _=[];if(_[0]=1,n>1){for(let b=0,v=n-1;b<v;b++)_[b]=Math.round(b*o+r);_[n-1]=t}return[new Av(o,_),[]]}const a=i.minimapLines,l=a.length,c=[];let d=0,h=0,u=1;const g=10;let f=[],m=null;for(let _=0;_<n;_++){const b=Math.max(u,Math.round(_*o)),v=Math.max(b,Math.round((_+1)*o));for(;d<l&&a[d]<b;){if(f.length<g){const y=d+1+h;m&&m.type==="deleted"&&m._oldIndex===d-1?m.deleteToLineNumber++:(m={type:"deleted",_oldIndex:d,deleteFromLineNumber:y,deleteToLineNumber:y},f.push(m)),h--}d++}let C;if(d<l&&a[d]<=v)C=a[d],d++;else if(_===0?C=1:_+1===n?C=t:C=Math.round(_*o+r),f.length<g){const y=d+1+h;m&&m.type==="inserted"&&m._i===_-1?m.insertToLineNumber++:(m={type:"inserted",_i:_,insertFromLineNumber:y,insertToLineNumber:y},f.push(m)),h++}c[_]=C,u=C}if(f.length<g)for(;d<l;){const _=d+1+h;m&&m.type==="deleted"&&m._oldIndex===d-1?m.deleteToLineNumber++:(m={type:"deleted",_oldIndex:d,deleteFromLineNumber:_,deleteToLineNumber:_},f.push(m)),h--,d++}else f=[{type:"flush"}];return[new Av(o,c),f]}constructor(e,t){this.samplingRatio=e,this.minimapLines=t}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e)-1;for(;i>0&&this.minimapLines[i-1]>=e;)i--;let n=this.modelLineToMinimapLine(t)-1;for(;n+1<this.minimapLines.length&&this.minimapLines[n+1]<=t;)n++;if(i===n){const o=this.minimapLines[i];if(o<e||o>t)return null}return[i+1,n+1]}decorationLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e),n=this.modelLineToMinimapLine(t);return e!==t&&n===i&&(n===this.minimapLines.length?i>1&&i--:n++),[i,n]}onLinesDeleted(e){const t=e.toLineNumber-e.fromLineNumber+1;let i=this.minimapLines.length,n=0;for(let o=this.minimapLines.length-1;o>=0&&!(this.minimapLines[o]<e.fromLineNumber);o--)this.minimapLines[o]<=e.toLineNumber?(this.minimapLines[o]=Math.max(1,e.fromLineNumber-1),i=Math.min(i,o),n=Math.max(n,o)):this.minimapLines[o]-=t;return[i,n]}onLinesInserted(e){const t=e.toLineNumber-e.fromLineNumber+1;for(let i=this.minimapLines.length-1;i>=0&&!(this.minimapLines[i]<e.fromLineNumber);i--)this.minimapLines[i]+=t}}class cbe extends yo{constructor(e){super(e),this._sectionHeaderCache=new Wl(10,1.5),this.tokensColorTracker=Rx.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new hp(this._context.configuration,this._context.theme,this.tokensColorTracker);const[t]=Av.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new Af(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){const e=new hp(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(e)?!1:(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return e.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){const t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.fromLineNumber+e.count-1);return t?this._actual.onLinesChanged(t[0],t[1]-t[0]+1):!1}else return this._actual.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){if(this._samplingState){const[t,i]=this._samplingState.onLinesDeleted(e);return t<=i&&this._actual.onLinesChanged(t+1,i-t+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged()}onThemeChanged(e){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){const t=[];for(const i of e.ranges){const n=this._samplingState.modelLineRangeToMinimapLineRange(i.fromLineNumber,i.toLineNumber);n&&t.push({fromLineNumber:n[0],toLineNumber:n[1]})}return t.length?this._actual.onTokensChanged(t):!1}else return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),i=this._samplingState.modelLineToMinimapLine(i));const n={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:i,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(n)}_recreateLineSampling(){this._minimapSelections=null;const e=!!this._samplingState,[t,i]=Av.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(const n of i)switch(n.type){case"deleted":this._actual.onLinesDeleted(n.deleteFromLineNumber,n.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(n.insertFromLineNumber,n.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(e){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineContent(e)}getLineMaxColumn(e){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineMaxColumn(e)}getMinimapLinesRenderingData(e,t,i){if(this._samplingState){const n=[];for(let o=0,r=t-e+1;o<r;o++)i[o]?n[o]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[e+o-1]):n[o]=null;return n}return this._context.viewModel.getMinimapLinesRenderingData(e,t,i).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(const e of this._selections){const[t,i]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new me(t,e.startColumn,i,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){const i=this._getMinimapDecorationsInViewport(e,t).filter(n=>!n.options.minimap?.sectionHeaderStyle);if(this._samplingState){const n=[];for(const o of i){if(!o.options.minimap)continue;const r=o.range,a=this._samplingState.modelLineToMinimapLine(r.startLineNumber),l=this._samplingState.modelLineToMinimapLine(r.endLineNumber);n.push(new O$(new k(a,r.startColumn,l,r.endColumn),o.options))}return n}return i}getSectionHeaderDecorationsInViewport(e,t){const i=this.options.minimapLineHeight,o=this.options.sectionHeaderFontSize/i;return e=Math.floor(Math.max(1,e-o)),this._getMinimapDecorationsInViewport(e,t).filter(r=>!!r.options.minimap?.sectionHeaderStyle)}_getMinimapDecorationsInViewport(e,t){let i;if(this._samplingState){const n=this._samplingState.minimapLines[e-1],o=this._samplingState.minimapLines[t-1];i=new k(n,1,o,this._context.viewModel.getLineMaxColumn(o))}else i=new k(e,1,t,this._context.viewModel.getLineMaxColumn(t));return this._context.viewModel.getMinimapDecorationsInRange(i)}getSectionHeaderText(e,t){const i=e.options.minimap?.sectionHeaderText;if(!i)return null;const n=this._sectionHeaderCache.get(i);if(n)return n;const o=t(i);return this._sectionHeaderCache.set(i,o),o}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.viewModel.revealRange("mouse",!1,new k(e,1,e,1),1,0)}setScrollTop(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e},1)}}class Af extends B{constructor(e,t){super(),this._renderDecorations=!1,this._gestureInProgress=!1,this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(lB),this._domNode=Ct(document.createElement("div")),Ua.write(this._domNode,9),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=Ct(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=Ct(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=Ct(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=Ct(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=Ct(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._pointerDownListener=gi(this._domNode.domNode,ee.POINTER_DOWN,i=>{if(i.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(i.button===0&&this._lastRenderData){const c=Si(this._slider.domNode),d=c.top+c.height/2;this._startSliderDragging(i,d,this._lastRenderData.renderedLayout)}return}const o=this._model.options.minimapLineHeight,r=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*i.offsetY;let l=Math.floor(r/o)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;l=Math.min(l,this._model.getLineCount()),this._model.revealLineNumber(l)}),this._sliderPointerMoveMonitor=new wm,this._sliderPointerDownListener=gi(this._slider.domNode,ee.POINTER_DOWN,i=>{i.preventDefault(),i.stopPropagation(),i.button===0&&this._lastRenderData&&this._startSliderDragging(i,i.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=ti.addTarget(this._domNode.domNode),this._sliderTouchStartListener=U(this._domNode.domNode,Wt.Start,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(i))},{passive:!1}),this._sliderTouchMoveListener=U(this._domNode.domNode,Wt.Change,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(i)},{passive:!1}),this._sliderTouchEndListener=gi(this._domNode.domNode,Wt.End,i=>{i.preventDefault(),i.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_startSliderDragging(e,t,i){if(!e.target||!(e.target instanceof Element))return;const n=e.pageX;this._slider.toggleClassName("active",!0);const o=(r,a)=>{const l=Si(this._domNode.domNode),c=Math.min(Math.abs(a-n),Math.abs(a-l.left),Math.abs(a-l.left-l.width));if(An&&c>abe){this._model.setScrollTop(i.scrollTop);return}const d=r-t;this._model.setScrollTop(i.getDesiredScrollTopFromDelta(d))};e.pageY!==t&&o(e.pageY,n),this._sliderPointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,r=>o(r.pageY,r.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(e){const t=this._domNode.domNode.getBoundingClientRect().top,i=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(i)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){const e=["minimap"];return this._model.options.showSlider==="always"?e.push("slider-always"):e.push("slider-mouseover"),this._model.options.autohide&&e.push("autohide"),e.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new tF(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return this._lastRenderData?this._lastRenderData.onLinesChanged(e,t):!1}onLinesDeleted(e,t){return this._lastRenderData?.onLinesDeleted(e,t),!0}onLinesInserted(e,t){return this._lastRenderData?.onLinesInserted(e,t),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(lB),this._renderDecorations=!0,!0}onTokensChanged(e){return this._lastRenderData?this._lastRenderData.onTokensChanged(e):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");const i=fb.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(i.sliderNeeded?"block":"none"),this._slider.setTop(i.sliderTop),this._slider.setHeight(i.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(i.sliderHeight),this.renderDecorations(i),this._lastRenderData=this.renderLines(i)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;const t=this._model.getSelections();t.sort(k.compareRangesUsingStarts);const i=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber);i.sort((u,g)=>(u.options.zIndex||0)-(g.options.zIndex||0));const{canvasInnerWidth:n,canvasInnerHeight:o}=this._model.options,r=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,c=this._decorationsCanvas.domNode.getContext("2d");c.clearRect(0,0,n,o);const d=new g9(e.startLineNumber,e.endLineNumber,!1);this._renderSelectionLineHighlights(c,t,d,e,r),this._renderDecorationsLineHighlights(c,i,d,e,r);const h=new g9(e.startLineNumber,e.endLineNumber,null);this._renderSelectionsHighlights(c,t,h,e,r,l,a,n),this._renderDecorationsHighlights(c,i,h,e,r,l,a,n),this._renderSectionHeaders(e)}}_renderSelectionLineHighlights(e,t,i,n,o){if(!this._selectionColor||this._selectionColor.isTransparent())return;e.fillStyle=this._selectionColor.transparent(.5).toString();let r=0,a=0;for(const l of t){const c=n.intersectWithViewport(l);if(!c)continue;const[d,h]=c;for(let f=d;f<=h;f++)i.set(f,!0);const u=n.getYForLineNumber(d,o),g=n.getYForLineNumber(h,o);a>=u||(a>r&&e.fillRect(ol,r,e.canvas.width,a-r),r=u),a=g}a>r&&e.fillRect(ol,r,e.canvas.width,a-r)}_renderDecorationsLineHighlights(e,t,i,n,o){const r=new Map;for(let a=t.length-1;a>=0;a--){const l=t[a],c=l.options.minimap;if(!c||c.position!==1)continue;const d=n.intersectWithViewport(l.range);if(!d)continue;const[h,u]=d,g=c.getColor(this._theme.value);if(!g||g.isTransparent())continue;let f=r.get(g.toString());f||(f=g.transparent(.5).toString(),r.set(g.toString(),f)),e.fillStyle=f;for(let m=h;m<=u;m++){if(i.has(m))continue;i.set(m,!0);const _=n.getYForLineNumber(h,o);e.fillRect(ol,_,e.canvas.width,o)}}}_renderSelectionsHighlights(e,t,i,n,o,r,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(const c of t){const d=n.intersectWithViewport(c);if(!d)continue;const[h,u]=d;for(let g=h;g<=u;g++)this.renderDecorationOnLine(e,i,c,this._selectionColor,n,g,o,o,r,a,l)}}_renderDecorationsHighlights(e,t,i,n,o,r,a,l){for(const c of t){const d=c.options.minimap;if(!d)continue;const h=n.intersectWithViewport(c.range);if(!h)continue;const[u,g]=h,f=d.getColor(this._theme.value);if(!(!f||f.isTransparent()))for(let m=u;m<=g;m++)switch(d.position){case 1:this.renderDecorationOnLine(e,i,c.range,f,n,m,o,o,r,a,l);continue;case 2:{const _=n.getYForLineNumber(m,o);this.renderDecoration(e,f,2,_,lbe,o);continue}}}}renderDecorationOnLine(e,t,i,n,o,r,a,l,c,d,h){const u=o.getYForLineNumber(r,l);if(u+a<0||u>this._model.options.canvasInnerHeight)return;const{startLineNumber:g,endLineNumber:f}=i,m=g===r?i.startColumn:1,_=f===r?i.endColumn:this._model.getLineMaxColumn(r),b=this.getXOffsetForPosition(t,r,m,c,d,h),v=this.getXOffsetForPosition(t,r,_,c,d,h);this.renderDecoration(e,n,b,u,v-b,a)}getXOffsetForPosition(e,t,i,n,o,r){if(i===1)return ol;if((i-1)*o>=r)return r;let l=e.get(t);if(!l){const c=this._model.getLineContent(t);l=[ol];let d=ol;for(let h=1;h<c.length+1;h++){const u=c.charCodeAt(h-1),g=u===9?n*o:ih(u)?2*o:o,f=d+g;if(f>=r){l[h]=r;break}l[h]=f,d=f}e.set(t,l)}return i-1<l.length?l[i-1]:r}renderDecoration(e,t,i,n,o,r){e.fillStyle=t&&t.toString()||"",e.fillRect(i,n,o,r)}_renderSectionHeaders(e){const t=this._model.options.minimapLineHeight,i=this._model.options.sectionHeaderFontSize,n=this._model.options.sectionHeaderLetterSpacing,o=i*1.5,{canvasInnerWidth:r}=this._model.options,a=this._model.options.backgroundColor,l=`rgb(${a.r} ${a.g} ${a.b} / .7)`,c=this._model.options.sectionHeaderFontColor,d=`rgb(${c.r} ${c.g} ${c.b})`,h=d,u=this._decorationsCanvas.domNode.getContext("2d");u.letterSpacing=n+"px",u.font="500 "+i+"px "+this._model.options.sectionHeaderFontFamily,u.strokeStyle=h,u.lineWidth=.2;const g=this._model.getSectionHeaderDecorationsInViewport(e.startLineNumber,e.endLineNumber);g.sort((m,_)=>m.range.startLineNumber-_.range.startLineNumber);const f=Af._fitSectionHeader.bind(null,u,r-ol);for(const m of g){const _=e.getYForLineNumber(m.range.startLineNumber,t)+i,b=_-i,v=b+2,C=this._model.getSectionHeaderText(m,f);Af._renderSectionLabel(u,C,m.options.minimap?.sectionHeaderStyle===2,l,d,r,b,o,_,v)}}static _fitSectionHeader(e,t,i){if(!i)return i;const n="",o=e.measureText(i).width,r=e.measureText(n).width;if(o<=t||o<=r)return i;const a=i.length,l=o/i.length,c=Math.floor((t-r)/l)-1;let d=Math.ceil(c/2);for(;d>0&&/\s/.test(i[d-1]);)--d;return i.substring(0,d)+n+i.substring(a-(c-d))}static _renderSectionLabel(e,t,i,n,o,r,a,l,c,d){t&&(e.fillStyle=n,e.fillRect(0,a,r,l),e.fillStyle=o,e.fillText(t,ol,c)),i&&(e.beginPath(),e.moveTo(0,d),e.lineTo(r,d),e.closePath(),e.stroke())}renderLines(e){const t=e.startLineNumber,i=e.endLineNumber,n=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){const Y=this._lastRenderData._get();return new u9(e,Y.imageData,Y.lines)}const o=this._getBuffer();if(!o)return null;const[r,a,l]=Af._renderUntouchedLines(o,e.topPaddingLineCount,t,i,n,this._lastRenderData),c=this._model.getMinimapLinesRenderingData(t,i,l),d=this._model.getOptions().tabSize,h=this._model.options.defaultBackgroundColor,u=this._model.options.backgroundColor,g=this._model.options.foregroundAlpha,f=this._model.tokensColorTracker,m=f.backgroundIsLight(),_=this._model.options.renderMinimap,b=this._model.options.charRenderer(),v=this._model.options.fontScale,C=this._model.options.minimapCharWidth,w=(_===1?2:3)*v,x=n>w?Math.floor((n-w)/2):0,L=u.a/255,D=new hr(Math.round((u.r-h.r)*L+h.r),Math.round((u.g-h.g)*L+h.g),Math.round((u.b-h.b)*L+h.b),255);let T=e.topPaddingLineCount*n;const F=[];for(let Y=0,ie=i-t+1;Y<ie;Y++)l[Y]&&Af._renderLine(o,D,u.a,m,_,C,f,g,b,T,x,d,c[Y],v,n),F[Y]=new Mx(T),T+=n;const W=r===-1?0:r,$=(a===-1?o.height:a)-W;return this._canvas.domNode.getContext("2d").putImageData(o,0,0,0,W,o.width,$),new u9(e,o,F)}static _renderUntouchedLines(e,t,i,n,o,r){const a=[];if(!r){for(let T=0,F=n-i+1;T<F;T++)a[T]=!0;return[-1,-1,a]}const l=r._get(),c=l.imageData.data,d=l.rendLineNumberStart,h=l.lines,u=h.length,g=e.width,f=e.data,m=(n-i+1)*o*g*4;let _=-1,b=-1,v=-1,C=-1,y=-1,w=-1,x=t*o;for(let T=i;T<=n;T++){const F=T-i,W=T-d,H=W>=0&&W<u?h[W].dy:-1;if(H===-1){a[F]=!0,x+=o;continue}const $=H*g*4,V=(H+o)*g*4,Y=x*g*4,ie=(x+o)*g*4;C===$&&w===Y?(C=V,w=ie):(v!==-1&&(f.set(c.subarray(v,C),y),_===-1&&v===0&&v===y&&(_=C),b===-1&&C===m&&v===y&&(b=v)),v=$,C=V,y=Y,w=ie),a[F]=!1,x+=o}v!==-1&&(f.set(c.subarray(v,C),y),_===-1&&v===0&&v===y&&(_=C),b===-1&&C===m&&v===y&&(b=v));const L=_===-1?-1:_/(g*4),D=b===-1?-1:b/(g*4);return[L,D,a]}static _renderLine(e,t,i,n,o,r,a,l,c,d,h,u,g,f,m){const _=g.content,b=g.tokens,v=e.width-r,C=m===1;let y=ol,w=0,x=0;for(let L=0,D=b.getCount();L<D;L++){const T=b.getEndOffset(L),F=b.getForeground(L),W=a.getColor(F);for(;w<T;w++){if(y>v)return;const H=_.charCodeAt(w);if(H===9){const $=u-(w+x)%u;x+=$-1,y+=$*r}else if(H===32)y+=r;else{const $=ih(H)?2:1;for(let V=0;V<$;V++)if(o===2?c.blockRenderChar(e,y,d+h,W,l,t,i,C):c.renderChar(e,y,d+h,H,W,l,t,i,f,n,C),y+=r,y>v)return}}}}}class g9{constructor(e,t,i){this._startLineNumber=e,this._endLineNumber=t,this._defaultValue=i,this._values=[];for(let n=0,o=this._endLineNumber-this._startLineNumber+1;n<o;n++)this._values[n]=i}has(e){return this.get(e)!==this._defaultValue}set(e,t){e<this._startLineNumber||e>this._endLineNumber||(this._values[e-this._startLineNumber]=t)}get(e){return e<this._startLineNumber||e>this._endLineNumber?this._defaultValue:this._values[e-this._startLineNumber]}}class dbe extends yo{constructor(e,t){super(e),this._viewDomNode=t;const n=this._context.configuration.options.get(146);this._widgets={},this._verticalScrollbarWidth=n.verticalScrollbarWidth,this._minimapWidth=n.minimap.minimapWidth,this._horizontalScrollbarHeight=n.horizontalScrollbarHeight,this._editorHeight=n.height,this._editorWidth=n.width,this._viewDomNodeRect={top:0,left:0,width:0,height:0},this._domNode=Ct(document.createElement("div")),Ua.write(this._domNode,4),this._domNode.setClassName("overlayWidgets"),this.overflowingOverlayWidgetsDomNode=Ct(document.createElement("div")),Ua.write(this.overflowingOverlayWidgetsDomNode,5),this.overflowingOverlayWidgetsDomNode.setClassName("overflowingOverlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){const i=this._context.configuration.options.get(146);return this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,!0}addWidget(e){const t=Ct(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),e.allowEditorOverflow?this.overflowingOverlayWidgetsDomNode.appendChild(t):this._domNode.appendChild(t),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(e,t){const i=this._widgets[e.getId()],n=t?t.preference:null,o=t?.stackOridinal;return i.preference===n&&i.stack===o?(this._updateMaxMinWidth(),!1):(i.preference=n,i.stack=o,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const n=this._widgets[t].domNode.domNode;delete this._widgets[t],n.remove(),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){let e=0;const t=Object.keys(this._widgets);for(let i=0,n=t.length;i<n;i++){const o=t[i],a=this._widgets[o].widget.getMinContentWidthInPx?.();typeof a<"u"&&(e=Math.max(e,a))}this._context.viewLayout.setOverlayWidgetsMinWidth(e)}_renderWidget(e,t){const i=e.domNode;if(e.preference===null){i.setTop("");return}const n=2*this._verticalScrollbarWidth+this._minimapWidth;if(e.preference===0||e.preference===1){if(e.preference===1){const o=i.domNode.clientHeight;i.setTop(this._editorHeight-o-2*this._horizontalScrollbarHeight)}else i.setTop(0);e.stack!==void 0?(i.setTop(t[e.preference]),t[e.preference]+=i.domNode.clientWidth):i.setRight(n)}else if(e.preference===2)i.domNode.style.right="50%",e.stack!==void 0?(i.setTop(t[2]),t[2]+=i.domNode.clientHeight):i.setTop(0);else{const{top:o,left:r}=e.preference;if(this._context.configuration.options.get(42)&&e.widget.allowEditorOverflow){const l=this._viewDomNodeRect;i.setTop(o+l.top),i.setLeft(r+l.left),i.setPosition("fixed")}else i.setTop(o),i.setLeft(r),i.setPosition("absolute")}}prepareRender(e){this._viewDomNodeRect=Si(this._viewDomNode.domNode)}render(e){this._domNode.setWidth(this._editorWidth);const t=Object.keys(this._widgets),i=Array.from({length:3},()=>0);t.sort((n,o)=>(this._widgets[n].stack||0)-(this._widgets[o].stack||0));for(let n=0,o=t.length;n<o;n++){const r=t[n];this._renderWidget(this._widgets[r],i)}}}class hbe{constructor(e,t){const i=e.options;this.lineHeight=i.get(67),this.pixelRatio=i.get(144),this.overviewRulerLanes=i.get(83),this.renderBorder=i.get(82);const n=t.getColor(lhe);this.borderColor=n?n.toString():null,this.hideCursor=i.get(59);const o=t.getColor(dx);this.cursorColorSingle=o?o.transparent(.7).toString():null;const r=t.getColor(hU);this.cursorColorPrimary=r?r.transparent(.7).toString():null;const a=t.getColor(uU);this.cursorColorSecondary=a?a.transparent(.7).toString():null,this.themeType=t.type;const l=i.get(73),c=l.enabled,d=l.side,h=t.getColor(che),u=mi.getDefaultBackground();h?this.backgroundColor=h:c&&d==="right"?this.backgroundColor=u:this.backgroundColor=null;const f=i.get(146).overviewRuler;this.top=f.top,this.right=f.right,this.domWidth=f.width,this.domHeight=f.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);const[m,_]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=m,this.w=_}_initLanes(e,t,i){const n=t-e;if(i>=3){const o=Math.floor(n/3),r=Math.floor(n/3),a=n-o-r,l=e,c=l+o,d=l+o+a;return[[0,l,c,l,d,l,c,l],[0,o,a,o+a,r,o+a+r,a+r,o+a+r]]}else if(i===2){const o=Math.floor(n/2),r=n-o,a=e,l=a+o;return[[0,a,a,a,l,a,a,a],[0,o,o,o,r,o+r,o+r,o+r]]}else{const o=e,r=n;return[[0,o,o,o,o,o,o,o],[0,r,r,r,r,r,r,r]]}}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColorSingle===e.cursorColorSingle&&this.cursorColorPrimary===e.cursorColorPrimary&&this.cursorColorSecondary===e.cursorColorSecondary&&this.themeType===e.themeType&&G.equals(this.backgroundColor,e.backgroundColor)&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}}class ube extends yo{constructor(e){super(e),this._actualShouldRender=0,this._renderedDecorations=[],this._renderedCursorPositions=[],this._domNode=Ct(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=mi.onDidChange(t=>{t.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[{position:new P(1,1),color:this._settings.cursorColorSingle}]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){const t=new hbe(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(t)?!1:(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,i=e.selections.length;t<i;t++){let n=this._settings.cursorColorSingle;i>1&&(n=t===0?this._settings.cursorColorPrimary:this._settings.cursorColorSecondary),this._cursorPositions.push({position:e.selections[t].getPosition(),color:n})}return this._cursorPositions.sort((t,i)=>P.compare(t.position,i.position)),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(e){return e.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(e){return this._markRenderingIsNeeded()}onScrollChanged(e){return e.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(e){return this._markRenderingIsNeeded()}onThemeChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render(),this._actualShouldRender=0}_render(){const e=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(e?G.Format.CSS.formatHexA(e):""),this._domNode.setDisplay("none");return}const t=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(t.sort(kv.compareByRenderingProps),this._actualShouldRender===1&&!kv.equalsArr(this._renderedDecorations,t)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!ii(this._renderedCursorPositions,this._cursorPositions,(f,m)=>f.position.lineNumber===m.position.lineNumber&&f.color===m.color)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=t,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");const i=this._settings.canvasWidth,n=this._settings.canvasHeight,o=this._settings.lineHeight,r=this._context.viewLayout,a=this._context.viewLayout.getScrollHeight(),l=n/a,c=6*this._settings.pixelRatio|0,d=c/2|0,h=this._domNode.domNode.getContext("2d");e?e.isOpaque()?(h.fillStyle=G.Format.CSS.formatHexA(e),h.fillRect(0,0,i,n)):(h.clearRect(0,0,i,n),h.fillStyle=G.Format.CSS.formatHexA(e),h.fillRect(0,0,i,n)):h.clearRect(0,0,i,n);const u=this._settings.x,g=this._settings.w;for(const f of t){const m=f.color,_=f.data;h.fillStyle=m;let b=0,v=0,C=0;for(let y=0,w=_.length/3;y<w;y++){const x=_[3*y],L=_[3*y+1],D=_[3*y+2];let T=r.getVerticalOffsetForLineNumber(L)*l|0,F=(r.getVerticalOffsetForLineNumber(D)+o)*l|0;if(F-T<c){let H=(T+F)/2|0;H<d?H=d:H+d>n&&(H=n-d),T=H-d,F=H+d}T>C+1||x!==b?(y!==0&&h.fillRect(u[b],v,g[b],C-v),b=x,v=T,C=F):F>C&&(C=F)}h.fillRect(u[b],v,g[b],C-v)}if(!this._settings.hideCursor){const f=2*this._settings.pixelRatio|0,m=f/2|0,_=this._settings.x[7],b=this._settings.w[7];let v=-100,C=-100,y=null;for(let w=0,x=this._cursorPositions.length;w<x;w++){const L=this._cursorPositions[w].color;if(!L)continue;const D=this._cursorPositions[w].position;let T=r.getVerticalOffsetForLineNumber(D.lineNumber)*l|0;T<m?T=m:T+m>n&&(T=n-m);const F=T-m,W=F+f;F>C+1||L!==y?(w!==0&&y&&h.fillRect(_,v,b,C-v),v=F,C=W):W>C&&(C=W),y=L,h.fillStyle=L}y&&h.fillRect(_,v,b,C-v)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(h.beginPath(),h.lineWidth=1,h.strokeStyle=this._settings.borderColor,h.moveTo(0,0),h.lineTo(0,n),h.moveTo(1,0),h.lineTo(i,0),h.stroke())}}class f9{constructor(e,t,i){this._colorZoneBrand=void 0,this.from=e|0,this.to=t|0,this.colorId=i|0}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}}class tj{constructor(e,t,i,n){this._overviewRulerZoneBrand=void 0,this.startLineNumber=e,this.endLineNumber=t,this.heightInLines=i,this.color=n,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.heightInLines===t.heightInLines?e.endLineNumber-t.endLineNumber:e.heightInLines-t.heightInLines:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}}class gbe{constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(tj.compare)}setLineHeight(e){return this._lineHeight===e?!1:(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth===e?!1:(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight===e?!1:(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight===e?!1:(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){const e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),i=Math.floor(this.getCanvasHeight()),n=Math.floor(this._outerHeight),o=i/n,r=Math.floor(4*this._pixelRatio/2),a=[];for(let l=0,c=this._zones.length;l<c;l++){const d=this._zones[l];if(!e){const y=d.getColorZones();if(y){a.push(y);continue}}const h=this._getVerticalOffsetForLine(d.startLineNumber),u=d.heightInLines===0?this._getVerticalOffsetForLine(d.endLineNumber)+t:h+d.heightInLines*t,g=Math.floor(o*h),f=Math.floor(o*u);let m=Math.floor((g+f)/2),_=f-m;_<r&&(_=r),m-_<0&&(m=_),m+_>i&&(m=i-_);const b=d.color;let v=this._color2Id[b];v||(v=++this._lastAssignedId,this._color2Id[b]=v,this._id2Color[v]=b);const C=new f9(m-_,m+_,v);d.setColorZone(C),a.push(C)}return this._colorZonesInvalid=!1,a.sort(f9.compare),a}}class fbe extends UC{constructor(e,t){super(),this._context=e;const i=this._context.configuration.options;this._domNode=Ct(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new gbe(n=>this._context.viewLayout.getVerticalOffsetForLineNumber(n)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(i.get(67)),this._zoneManager.setPixelRatio(i.get(144)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return e.hasChanged(67)&&(this._zoneManager.setLineHeight(t.get(67)),this._render()),e.hasChanged(144)&&(this._zoneManager.setPixelRatio(t.get(144)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;const e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),i=this._zoneManager.resolveColorZones(),n=this._zoneManager.getId2Color(),o=this._domNode.domNode.getContext("2d");return o.clearRect(0,0,e,t),i.length>0&&this._renderOneLane(o,i,n,e),!0}_renderOneLane(e,t,i,n){let o=0,r=0,a=0;for(const l of t){const c=l.colorId,d=l.from,h=l.to;c!==o?(e.fillRect(0,r,n,a-r),o=c,e.fillStyle=i[o],r=d,a=h):a>=d?a=Math.max(a,h):(e.fillRect(0,r,n,a-r),r=d,a=h)}e.fillRect(0,r,n,a-r)}}class pbe extends yo{constructor(e){super(e),this.domNode=Ct(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];const t=this._context.configuration.options;this._rulers=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._rulers=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){const e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){const{tabSize:n}=this._context.viewModel.model.getOptions(),o=n;let r=t-e;for(;r>0;){const a=Ct(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(o),this.domNode.appendChild(a),this._renderedRulers.push(a),r--}return}let i=e-t;for(;i>0;){const n=this._renderedRulers.pop();this.domNode.removeChild(n),i--}}render(e){this._ensureRulersCount();for(let t=0,i=this._rulers.length;t<i;t++){const n=this._renderedRulers[t],o=this._rulers[t];n.setBoxShadow(o.color?`1px 0 0 0 ${o.color} inset`:""),n.setHeight(Math.min(e.scrollHeight,1e6)),n.setLeft(o.column*this._typicalHalfwidthCharacterWidth)}}}class mbe extends yo{constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;const i=this._context.configuration.options.get(104);this._useShadows=i.useShadows,this._domNode=Ct(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){const e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e?(this._shouldShow=e,!0):!1}getDomNode(){return this._domNode}_updateWidth(){const t=this._context.configuration.options.get(146);t.minimap.renderMinimap===0||t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?this._width=t.width:this._width=t.width-t.verticalScrollbarWidth}onConfigurationChanged(e){const i=this._context.configuration.options.get(104);return this._useShadows=i.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}}class _be{constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}}class bbe{constructor(e,t){this.lineNumber=e,this.ranges=t}}function vbe(s){return new _be(s)}function Cbe(s){return new bbe(s.lineNumber,s.ranges.map(vbe))}class pn extends Sg{static{this.SELECTION_CLASS_NAME="selected-text"}static{this.SELECTION_TOP_LEFT="top-left-radius"}static{this.SELECTION_BOTTOM_LEFT="bottom-left-radius"}static{this.SELECTION_TOP_RIGHT="top-right-radius"}static{this.SELECTION_BOTTOM_RIGHT="bottom-right-radius"}static{this.EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background"}static{this.ROUNDED_PIECE_WIDTH=10}constructor(e){super(),this._previousFrameVisibleRangesWithStyle=[],this._context=e;const t=this._context.configuration.options;this._roundedSelection=t.get(102),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._roundedSelection=t.get(102),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,i=e.length;t<i;t++)if(e[t].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(e,t,i){const n=this._typicalHalfwidthCharacterWidth/4;let o=null,r=null;if(i&&i.length>0&&t.length>0){const a=t[0].lineNumber;if(a===e.startLineNumber)for(let c=0;!o&&c<i.length;c++)i[c].lineNumber===a&&(o=i[c].ranges[0]);const l=t[t.length-1].lineNumber;if(l===e.endLineNumber)for(let c=i.length-1;!r&&c>=0;c--)i[c].lineNumber===l&&(r=i[c].ranges[0]);o&&!o.startStyle&&(o=null),r&&!r.startStyle&&(r=null)}for(let a=0,l=t.length;a<l;a++){const c=t[a].ranges[0],d=c.left,h=c.left+c.width,u={top:0,bottom:0},g={top:0,bottom:0};if(a>0){const f=t[a-1].ranges[0].left,m=t[a-1].ranges[0].left+t[a-1].ranges[0].width;Yy(d-f)<n?u.top=2:d>f&&(u.top=1),Yy(h-m)<n?g.top=2:f<h&&h<m&&(g.top=1)}else o&&(u.top=o.startStyle.top,g.top=o.endStyle.top);if(a+1<l){const f=t[a+1].ranges[0].left,m=t[a+1].ranges[0].left+t[a+1].ranges[0].width;Yy(d-f)<n?u.bottom=2:f<d&&d<m&&(u.bottom=1),Yy(h-m)<n?g.bottom=2:h<m&&(g.bottom=1)}else r&&(u.bottom=r.startStyle.bottom,g.bottom=r.endStyle.bottom);c.startStyle=u,c.endStyle=g}}_getVisibleRangesWithStyle(e,t,i){const o=(t.linesVisibleRangesForRange(e,!0)||[]).map(Cbe);return!this._visibleRangesHaveGaps(o)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,o,i),o}_createSelectionPiece(e,t,i,n,o){return'<div class="cslr '+i+'" style="top:'+e.toString()+"px;bottom:"+t.toString()+"px;left:"+n.toString()+"px;width:"+o.toString()+'px;"></div>'}_actualRenderOneSelection(e,t,i,n){if(n.length===0)return;const o=!!n[0].ranges[0].startStyle,r=n[0].lineNumber,a=n[n.length-1].lineNumber;for(let l=0,c=n.length;l<c;l++){const d=n[l],h=d.lineNumber,u=h-t,g=i&&h===r?1:0,f=i&&h!==r&&h===a?1:0;let m="",_="";for(let b=0,v=d.ranges.length;b<v;b++){const C=d.ranges[b];if(o){const w=C.startStyle,x=C.endStyle;if(w.top===1||w.bottom===1){m+=this._createSelectionPiece(g,f,pn.SELECTION_CLASS_NAME,C.left-pn.ROUNDED_PIECE_WIDTH,pn.ROUNDED_PIECE_WIDTH);let L=pn.EDITOR_BACKGROUND_CLASS_NAME;w.top===1&&(L+=" "+pn.SELECTION_TOP_RIGHT),w.bottom===1&&(L+=" "+pn.SELECTION_BOTTOM_RIGHT),m+=this._createSelectionPiece(g,f,L,C.left-pn.ROUNDED_PIECE_WIDTH,pn.ROUNDED_PIECE_WIDTH)}if(x.top===1||x.bottom===1){m+=this._createSelectionPiece(g,f,pn.SELECTION_CLASS_NAME,C.left+C.width,pn.ROUNDED_PIECE_WIDTH);let L=pn.EDITOR_BACKGROUND_CLASS_NAME;x.top===1&&(L+=" "+pn.SELECTION_TOP_LEFT),x.bottom===1&&(L+=" "+pn.SELECTION_BOTTOM_LEFT),m+=this._createSelectionPiece(g,f,L,C.left+C.width,pn.ROUNDED_PIECE_WIDTH)}}let y=pn.SELECTION_CLASS_NAME;if(o){const w=C.startStyle,x=C.endStyle;w.top===0&&(y+=" "+pn.SELECTION_TOP_LEFT),w.bottom===0&&(y+=" "+pn.SELECTION_BOTTOM_LEFT),x.top===0&&(y+=" "+pn.SELECTION_TOP_RIGHT),x.bottom===0&&(y+=" "+pn.SELECTION_BOTTOM_RIGHT)}_+=this._createSelectionPiece(g,f,y,C.left,C.width)}e[u][0]+=m,e[u][1]+=_}}prepareRender(e){const t=[],i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;for(let r=i;r<=n;r++){const a=r-i;t[a]=["",""]}const o=[];for(let r=0,a=this._selections.length;r<a;r++){const l=this._selections[r];if(l.isEmpty()){o[r]=null;continue}const c=this._getVisibleRangesWithStyle(l,e,this._previousFrameVisibleRangesWithStyle[r]);o[r]=c,this._actualRenderOneSelection(t,i,this._selections.length>1,c)}this._previousFrameVisibleRangesWithStyle=o,this._renderResult=t.map(([r,a])=>r+a)}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}kr((s,e)=>{const t=s.getColor(Toe);t&&!t.isTransparent()&&e.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${t}; }`)});function Yy(s){return s<0?-s:s}class p9{constructor(e,t,i,n,o,r,a){this.top=e,this.left=t,this.paddingLeft=i,this.width=n,this.height=o,this.textContent=r,this.textContentClassName=a}}var kc;(function(s){s[s.Single=0]="Single",s[s.MultiPrimary=1]="MultiPrimary",s[s.MultiSecondary=2]="MultiSecondary"})(kc||(kc={}));class m9{constructor(e,t){this._context=e;const i=this._context.configuration.options,n=i.get(50);this._cursorStyle=i.get(28),this._lineHeight=i.get(67),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(i.get(31),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=Ct(document.createElement("div")),this._domNode.setClassName(`cursor ${lp}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),wn(this._domNode,n),this._domNode.setDisplay("none"),this._position=new P(1,1),this._pluralityClass="",this.setPlurality(t),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}setPlurality(e){switch(e){default:case kc.Single:this._pluralityClass="";break;case kc.MultiPrimary:this._pluralityClass="cursor-primary";break;case kc.MultiSecondary:this._pluralityClass="cursor-secondary";break}}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(50);return this._cursorStyle=t.get(28),this._lineHeight=t.get(67),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(31),this._typicalHalfwidthCharacterWidth),wn(this._domNode,i),!0}onCursorPositionChanged(e,t){return t?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=e,!0}_getGraphemeAwarePosition(){const{lineNumber:e,column:t}=this._position,i=this._context.viewModel.getLineContent(e),[n,o]=wee(i,t-1);return[new P(e,n+1),i.substring(n,o)]}_prepareRender(e){let t="",i="";const[n,o]=this._getGraphemeAwarePosition();if(this._cursorStyle===bn.Line||this._cursorStyle===bn.LineThin){const u=e.visibleRangeForPosition(n);if(!u||u.outsideRenderedLine)return null;const g=ke(this._domNode.domNode);let f;this._cursorStyle===bn.Line?(f=Z5(g,this._lineCursorWidth>0?this._lineCursorWidth:2),f>2&&(t=o,i=this._getTokenClassName(n))):f=Z5(g,1);let m=u.left,_=0;f>=2&&m>=1&&(_=1,m-=_);const b=e.getVerticalOffsetForLineNumber(n.lineNumber)-e.bigNumbersDelta;return new p9(b,m,_,f,this._lineHeight,t,i)}const r=e.linesVisibleRangesForRange(new k(n.lineNumber,n.column,n.lineNumber,n.column+o.length),!1);if(!r||r.length===0)return null;const a=r[0];if(a.outsideRenderedLine||a.ranges.length===0)return null;const l=a.ranges[0],c=o==="	"?this._typicalHalfwidthCharacterWidth:l.width<1?this._typicalHalfwidthCharacterWidth:l.width;this._cursorStyle===bn.Block&&(t=o,i=this._getTokenClassName(n));let d=e.getVerticalOffsetForLineNumber(n.lineNumber)-e.bigNumbersDelta,h=this._lineHeight;return(this._cursorStyle===bn.Underline||this._cursorStyle===bn.UnderlineThin)&&(d+=this._lineHeight-2,h=2),new p9(d,l.left,0,c,h,t,i)}_getTokenClassName(e){const t=this._context.viewModel.getViewLineData(e.lineNumber),i=t.tokens.findTokenIndexAtOffset(e.column-1);return t.tokens.getClassName(i)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${this._pluralityClass} ${lp} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}}class cS extends yo{static{this.BLINK_INTERVAL=500}constructor(e){super(e);const t=this._context.configuration.options;this._readOnly=t.get(92),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new m9(this._context,kc.Single),this._secondaryCursors=[],this._renderData=[],this._domNode=Ct(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new ia,this._cursorFlatBlinkInterval=new XP,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){const t=this._context.configuration.options;this._readOnly=t.get(92),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let i=0,n=this._secondaryCursors.length;i<n;i++)this._secondaryCursors[i].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t,i){const n=this._secondaryCursors.length!==t.length||this._cursorSmoothCaretAnimation==="explicit"&&i!==3;if(this._primaryCursor.setPlurality(t.length?kc.MultiPrimary:kc.Single),this._primaryCursor.onCursorPositionChanged(e,n),this._updateBlinking(),this._secondaryCursors.length<t.length){const o=t.length-this._secondaryCursors.length;for(let r=0;r<o;r++){const a=new m9(this._context,kc.MultiSecondary);this._domNode.domNode.insertBefore(a.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(a)}}else if(this._secondaryCursors.length>t.length){const o=this._secondaryCursors.length-t.length;for(let r=0;r<o;r++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let o=0;o<t.length;o++)this._secondaryCursors[o].onCursorPositionChanged(t[o],n)}onCursorStateChanged(e){const t=[];for(let n=0,o=e.selections.length;n<o;n++)t[n]=e.selections[n].getPosition();this._onCursorPositionChanged(t[0],t.slice(1),e.reason);const i=e.selections[0].isEmpty();return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){const t=i=>{for(let n=0,o=e.ranges.length;n<o;n++)if(e.ranges[n].fromLineNumber<=i.lineNumber&&i.lineNumber<=e.ranges[n].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(const i of this._secondaryCursors)if(t(i.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput||!this._editorHasFocus?0:this._readOnly?5:this._cursorBlinking}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();const e=this._getCursorBlinking(),t=e===0,i=e===5;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!t&&!i&&(e===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},cS.BLINK_INTERVAL,ke(this._domNode.domNode)):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},cS.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case bn.Line:e+=" cursor-line-style";break;case bn.Block:e+=" cursor-block-style";break;case bn.Underline:e+=" cursor-underline-style";break;case bn.LineThin:e+=" cursor-line-thin-style";break;case bn.BlockOutline:e+=" cursor-block-outline-style";break;case bn.UnderlineThin:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;case 5:e+=" cursor-solid";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,i=this._secondaryCursors.length;t<i;t++)this._secondaryCursors[t].prepareRender(e)}render(e){const t=[];let i=0;const n=this._primaryCursor.render(e);n&&(t[i++]=n);for(let o=0,r=this._secondaryCursors.length;o<r;o++){const a=this._secondaryCursors[o].render(e);a&&(t[i++]=a)}this._renderData=t}getLastRenderData(){return this._renderData}}kr((s,e)=>{const t=[{class:".cursor",foreground:dx,background:eO},{class:".cursor-primary",foreground:hU,background:jde},{class:".cursor-secondary",foreground:uU,background:Zde}];for(const i of t){const n=s.getColor(i.foreground);if(n){let o=s.getColor(i.background);o||(o=n.opposite()),e.addRule(`.monaco-editor .cursors-layer ${i.class} { background-color: ${n}; border-color: ${n}; color: ${o}; }`),Ra(s.type)&&e.addRule(`.monaco-editor .cursors-layer.has-selection ${i.class} { border-left: 1px solid ${o}; border-right: 1px solid ${o}; }`)}}});const YD=()=>{throw new Error("Invalid change accessor")};class ybe extends yo{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(146);this._lineHeight=t.get(67),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,this.domNode=Ct(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=Ct(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){const e=this._context.viewLayout.getWhitespaces(),t=new Map;for(const n of e)t.set(n.id,n);let i=!1;return this._context.viewModel.changeWhitespace(n=>{const o=Object.keys(this._zones);for(let r=0,a=o.length;r<a;r++){const l=o[r],c=this._zones[l],d=this._computeWhitespaceProps(c.delegate);c.isInHiddenArea=d.isInHiddenArea;const h=t.get(l);h&&(h.afterLineNumber!==d.afterViewLineNumber||h.height!==d.heightInPx)&&(n.changeOneWhitespace(l,d.afterViewLineNumber,d.heightInPx),this._safeCallOnComputedHeight(c.delegate,d.heightInPx),i=!0)}}),i}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(146);return this._lineHeight=t.get(67),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,e.hasChanged(67)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){return e.ordinal??e.afterColumn??1e4}_computeWhitespaceProps(e){if(e.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t;if(typeof e.afterColumn<"u")t=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{const r=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new P(r,this._context.viewModel.model.getLineMaxColumn(r))}let i;t.column===this._context.viewModel.model.getLineMaxColumn(t.lineNumber)?i=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber+1,column:1}):i=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber,column:t.column+1});const n=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t,e.afterColumnAffinity,!0),o=e.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(i);return{isInHiddenArea:!o,afterViewLineNumber:n.lineNumber,heightInPx:o?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.viewModel.changeWhitespace(i=>{const n={addZone:o=>(t=!0,this._addZone(i,o)),removeZone:o=>{o&&(t=this._removeZone(i,o)||t)},layoutZone:o=>{o&&(t=this._layoutZone(i,o)||t)}};wbe(e,n),n.addZone=YD,n.removeZone=YD,n.layoutZone=YD}),t}_addZone(e,t){const i=this._computeWhitespaceProps(t),o={whitespaceId:e.insertWhitespace(i.afterViewLineNumber,this._getZoneOrdinal(t),i.heightInPx,i.minWidthInPx),delegate:t,isInHiddenArea:i.isInHiddenArea,isVisible:!1,domNode:Ct(t.domNode),marginDomNode:t.marginDomNode?Ct(t.marginDomNode):null};return this._safeCallOnComputedHeight(o.delegate,i.heightInPx),o.domNode.setPosition("absolute"),o.domNode.domNode.style.width="100%",o.domNode.setDisplay("none"),o.domNode.setAttribute("monaco-view-zone",o.whitespaceId),this.domNode.appendChild(o.domNode),o.marginDomNode&&(o.marginDomNode.setPosition("absolute"),o.marginDomNode.domNode.style.width="100%",o.marginDomNode.setDisplay("none"),o.marginDomNode.setAttribute("monaco-view-zone",o.whitespaceId),this.marginDomNode.appendChild(o.marginDomNode)),this._zones[o.whitespaceId]=o,this.setShouldRender(),o.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t];return delete this._zones[t],e.removeWhitespace(i.whitespaceId),i.domNode.removeAttribute("monaco-visible-view-zone"),i.domNode.removeAttribute("monaco-view-zone"),i.domNode.domNode.remove(),i.marginDomNode&&(i.marginDomNode.removeAttribute("monaco-visible-view-zone"),i.marginDomNode.removeAttribute("monaco-view-zone"),i.marginDomNode.domNode.remove()),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t],n=this._computeWhitespaceProps(i.delegate);return i.isInHiddenArea=n.isInHiddenArea,e.changeOneWhitespace(i.whitespaceId,n.afterViewLineNumber,n.heightInPx),this._safeCallOnComputedHeight(i.delegate,n.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){return this._zones.hasOwnProperty(e)?!!this._zones[e].delegate.suppressMouseDown:!1}_heightInPixels(e){return typeof e.heightInPx=="number"?e.heightInPx:typeof e.heightInLines=="number"?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return typeof e.minWidthInPx=="number"?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if(typeof e.onComputedHeight=="function")try{e.onComputedHeight(t)}catch(i){Oe(i)}}_safeCallOnDomNodeTop(e,t){if(typeof e.onDomNodeTop=="function")try{e.onDomNodeTop(t)}catch(i){Oe(i)}}prepareRender(e){}render(e){const t=e.viewportData.whitespaceViewportData,i={};let n=!1;for(const r of t)this._zones[r.id].isInHiddenArea||(i[r.id]=r,n=!0);const o=Object.keys(this._zones);for(let r=0,a=o.length;r<a;r++){const l=o[r],c=this._zones[l];let d=0,h=0,u="none";i.hasOwnProperty(l)?(d=i[l].verticalOffset-e.bigNumbersDelta,h=i[l].height,u="block",c.isVisible||(c.domNode.setAttribute("monaco-visible-view-zone","true"),c.isVisible=!0),this._safeCallOnDomNodeTop(c.delegate,e.getScrolledTopFromAbsoluteTop(i[l].verticalOffset))):(c.isVisible&&(c.domNode.removeAttribute("monaco-visible-view-zone"),c.isVisible=!1),this._safeCallOnDomNodeTop(c.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),c.domNode.setTop(d),c.domNode.setHeight(h),c.domNode.setDisplay(u),c.marginDomNode&&(c.marginDomNode.setTop(d),c.marginDomNode.setHeight(h),c.marginDomNode.setDisplay(u))}n&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}}function wbe(s,e){try{return s(e)}catch(t){Oe(t)}}class Sbe extends Sg{constructor(e){super(),this._context=e,this._options=new _9(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=new _9(this._context.configuration);return this._options.equals(t)?e.hasChanged(146):(this._options=t,!0)}onCursorStateChanged(e){return this._selection=e.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}prepareRender(e){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}const t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber-t+1,o=new Array(n);for(let a=0;a<n;a++)o[a]=!0;const r=this._context.viewModel.getMinimapLinesRenderingData(e.viewportData.startLineNumber,e.viewportData.endLineNumber,o);this._renderResult=[];for(let a=e.viewportData.startLineNumber;a<=e.viewportData.endLineNumber;a++){const l=a-e.viewportData.startLineNumber,c=r.data[l];let d=null;if(this._options.renderWhitespace==="selection"){const h=this._selection;for(const u of h){if(u.endLineNumber<a||u.startLineNumber>a)continue;const g=u.startLineNumber===a?u.startColumn:c.minColumn,f=u.endLineNumber===a?u.endColumn:c.maxColumn;g<f&&(d||(d=[]),d.push(new M$(g-1,f-1)))}}this._renderResult[l]=this._applyRenderWhitespace(e,a,d,c)}}_applyRenderWhitespace(e,t,i,n){if(this._options.renderWhitespace==="selection"&&!i||this._options.renderWhitespace==="trailing"&&n.continuesWithWrappedLine)return"";const o=this._context.theme.getColor(tO),r=this._options.renderWithSVG,a=n.content,l=this._options.stopRenderingLineAfter===-1?a.length:Math.min(this._options.stopRenderingLineAfter,a.length),c=n.continuesWithWrappedLine,d=n.minColumn-1,h=this._options.renderWhitespace==="boundary",u=this._options.renderWhitespace==="trailing",g=this._options.lineHeight,f=this._options.middotWidth,m=this._options.wsmiddotWidth,_=this._options.spaceWidth,b=Math.abs(m-_),v=Math.abs(f-_),C=b<v?11825:183,y=this._options.canUseHalfwidthRightwardsArrow;let w="",x=!1,L=rs(a),D;L===-1?(x=!0,L=l,D=l):D=Na(a);let T=0,F=i&&i[T],W=0;for(let H=d;H<l;H++){const $=a.charCodeAt(H);if(F&&H>=F.endOffset&&(T++,F=i&&i[T]),$!==9&&$!==32||u&&!x&&H<=D)continue;if(h&&H>=L&&H<=D&&$===32){const Y=H-1>=0?a.charCodeAt(H-1):0,ie=H+1<l?a.charCodeAt(H+1):0;if(Y!==32&&ie!==32)continue}if(h&&c&&H===l-1){const Y=H-1>=0?a.charCodeAt(H-1):0;if($===32&&Y!==32&&Y!==9)continue}if(i&&(!F||F.startOffset>H||F.endOffset<=H))continue;const V=e.visibleRangeForPosition(new P(t,H+1));V&&(r?(W=Math.max(W,V.left),$===9?w+=this._renderArrow(g,_,V.left):w+=`<circle cx="${(V.left+_/2).toFixed(2)}" cy="${(g/2).toFixed(2)}" r="${(_/7).toFixed(2)}" />`):$===9?w+=`<div class="mwh" style="left:${V.left}px;height:${g}px;">${y?"":""}</div>`:w+=`<div class="mwh" style="left:${V.left}px;height:${g}px;">${String.fromCharCode(C)}</div>`)}return r?(W=Math.round(W+_),`<svg style="bottom:0;position:absolute;width:${W}px;height:${g}px" viewBox="0 0 ${W} ${g}" xmlns="http://www.w3.org/2000/svg" fill="${o}">`+w+"</svg>"):w}_renderArrow(e,t,i){const n=t/7,o=t,r=e/2,a=i,l={x:0,y:n/2},c={x:100/125*o,y:l.y},d={x:c.x-.2*c.x,y:c.y+.2*c.x},h={x:d.x+.1*c.x,y:d.y+.1*c.x},u={x:h.x+.35*c.x,y:h.y-.35*c.x},g={x:u.x,y:-u.y},f={x:h.x,y:-h.y},m={x:d.x,y:-d.y},_={x:c.x,y:-c.y},b={x:l.x,y:-l.y};return`<path d="M ${[l,c,d,h,u,g,f,m,_,b].map(y=>`${(a+y.x).toFixed(2)} ${(r+y.y).toFixed(2)}`).join(" L ")}" />`}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class _9{constructor(e){const t=e.options,i=t.get(50),n=t.get(38);n==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):n==="svg"?(this.renderWhitespace=t.get(100),this.renderWithSVG=!0):(this.renderWhitespace=t.get(100),this.renderWithSVG=!1),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=t.get(67),this.stopRenderingLineAfter=t.get(118)}equals(e){return this.renderWhitespace===e.renderWhitespace&&this.renderWithSVG===e.renderWithSVG&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter}}class Lbe{constructor(e,t,i,n){this.selections=e,this.startLineNumber=t.startLineNumber|0,this.endLineNumber=t.endLineNumber|0,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=t.bigNumbersDelta|0,this.lineHeight=t.lineHeight|0,this.whitespaceViewportData=i,this._model=n,this.visibleRange=new k(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewportViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}}class xbe{get type(){return this._theme.type}get value(){return this._theme}constructor(e){this._theme=e}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}}class kbe{constructor(e,t,i){this.configuration=e,this.theme=new xbe(t),this.viewModel=i,this.viewLayout=i.viewLayout}addEventHandler(e){this.viewModel.addViewEventHandler(e)}removeEventHandler(e){this.viewModel.removeViewEventHandler(e)}}var Dbe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Ibe=function(s,e){return function(t,i){e(t,i,s)}};let SR=class extends UC{constructor(e,t,i,n,o,r,a){super(),this._instantiationService=a,this._shouldRecomputeGlyphMarginLanes=!1,this._selections=[new me(1,1,1,1)],this._renderAnimationFrame=null;const l=new O_e(t,n,o,e);this._context=new kbe(t,i,n),this._context.addEventHandler(this),this._viewParts=[],this._textAreaHandler=this._instantiationService.createInstance(vR,this._context,l,this._createTextAreaHandlerHelper()),this._viewParts.push(this._textAreaHandler),this._linesContent=Ct(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=Ct(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=Ct(document.createElement("div")),Ua.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new Z_e(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new eF(this._context,this._linesContent),this._viewZones=new ybe(this._context),this._viewParts.push(this._viewZones);const c=new ube(this._context);this._viewParts.push(c);const d=new mbe(this._context);this._viewParts.push(d);const h=new B_e(this._context);this._viewParts.push(h),h.addDynamicOverlay(new U_e(this._context)),h.addDynamicOverlay(new pn(this._context)),h.addDynamicOverlay(new J_e(this._context)),h.addDynamicOverlay(new j_e(this._context)),h.addDynamicOverlay(new Sbe(this._context));const u=new W_e(this._context);this._viewParts.push(u),u.addDynamicOverlay(new $_e(this._context)),u.addDynamicOverlay(new sbe(this._context)),u.addDynamicOverlay(new nbe(this._context)),u.addDynamicOverlay(new Dx(this._context)),this._glyphMarginWidgets=new G_e(this._context),this._viewParts.push(this._glyphMarginWidgets);const g=new Nv(this._context);g.getDomNode().appendChild(this._viewZones.marginDomNode),g.getDomNode().appendChild(u.getDomNode()),g.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(g),this._contentWidgets=new V_e(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new cS(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new dbe(this._context,this.domNode),this._viewParts.push(this._overlayWidgets);const f=new pbe(this._context);this._viewParts.push(f);const m=new H_e(this._context);this._viewParts.push(m);const _=new cbe(this._context);if(this._viewParts.push(_),c){const b=this._scrollbar.getOverviewRulerLayoutInfo();b.parent.insertBefore(c.getDomNode(),b.insertBefore)}this._linesContent.appendChild(h.getDomNode()),this._linesContent.appendChild(f.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(g.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(d.getDomNode()),this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea),this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(_.getDomNode()),this._overflowGuardContainer.appendChild(m.domNode),this.domNode.appendChild(this._overflowGuardContainer),r?(r.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode),r.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode)):(this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode)),this._applyLayout(),this._pointerHandler=this._register(new s_e(this._context,l,this._createPointerHandlerHelper()))}_computeGlyphMarginLanes(){const e=this._context.viewModel.model,t=this._context.viewModel.glyphLanes;let i=[],n=0;i=i.concat(e.getAllMarginDecorations().map(o=>{const r=o.options.glyphMargin?.position??Jr.Center;return n=Math.max(n,o.range.endLineNumber),{range:o.range,lane:r,persist:o.options.glyphMargin?.persistLane}})),i=i.concat(this._glyphMarginWidgets.getWidgets().map(o=>{const r=e.validateRange(o.preference.range);return n=Math.max(n,r.endLineNumber),{range:r,lane:o.preference.lane}})),i.sort((o,r)=>k.compareRangesUsingStarts(o.range,r.range)),t.reset(n);for(const o of i)t.push(o.lane,o.range,o.persist);return t}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:e=>{this._textAreaHandler.textArea.domNode.dispatchEvent(e)},getLastRenderData:()=>{const e=this._viewCursors.getLastRenderData()||[],t=this._textAreaHandler.getLastRenderData();return new Zme(e,t)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:e=>this._viewZones.shouldSuppressMouseDownOnViewZone(e),shouldSuppressMouseDownOnWidget:e=>this._contentWidgets.shouldSuppressMouseDownOnWidget(e),getPositionFromDOMInfo:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(e,t)),visibleRangeForPosition:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new P(e,t))),getLineWidth:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(e))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(e))}}_applyLayout(){const t=this._context.configuration.options.get(146);this.domNode.setWidth(t.width),this.domNode.setHeight(t.height),this._overflowGuardContainer.setWidth(t.width),this._overflowGuardContainer.setHeight(t.height),this._linesContent.setWidth(16777216),this._linesContent.setHeight(16777216)}_getEditorClassName(){const e=this._textAreaHandler.isFocused()?" focused":"";return this._context.configuration.options.get(143)+" "+SE(this._context.theme.type)+e}handleEvents(e){super.handleEvents(e),this._scheduleRender()}onConfigurationChanged(e){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(e){return this._selections=e.selections,!1}onDecorationsChanged(e){return e.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(e){return this._context.theme.update(e.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(const e of this._viewParts)e.dispose();super.dispose()}_scheduleRender(){if(this._store.isDisposed)throw new mt;if(this._renderAnimationFrame===null){const e=this._createCoordinatedRendering();this._renderAnimationFrame=iF.INSTANCE.scheduleCoordinatedRendering({window:ke(this.domNode?.domNode),prepareRenderText:()=>{if(this._store.isDisposed)throw new mt;try{return e.prepareRenderText()}finally{this._renderAnimationFrame=null}},renderText:()=>{if(this._store.isDisposed)throw new mt;return e.renderText()},prepareRender:(t,i)=>{if(this._store.isDisposed)throw new mt;return e.prepareRender(t,i)},render:(t,i)=>{if(this._store.isDisposed)throw new mt;return e.render(t,i)}})}}_flushAccumulatedAndRenderNow(){const e=this._createCoordinatedRendering();Bd(()=>e.prepareRenderText());const t=Bd(()=>e.renderText());if(t){const[i,n]=t;Bd(()=>e.prepareRender(i,n)),Bd(()=>e.render(i,n))}}_getViewPartsToRender(){const e=[];let t=0;for(const i of this._viewParts)i.shouldRender()&&(e[t++]=i);return e}_createCoordinatedRendering(){return{prepareRenderText:()=>{if(this._shouldRecomputeGlyphMarginLanes){this._shouldRecomputeGlyphMarginLanes=!1;const e=this._computeGlyphMarginLanes();this._context.configuration.setGlyphMarginDecorationLaneCount(e.requiredLanes)}Fd.onRenderStart()},renderText:()=>{if(!this.domNode.domNode.isConnected)return null;let e=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&e.length===0)return null;const t=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(t.startLineNumber,t.endLineNumber,t.centeredLineNumber);const i=new Lbe(this._selections,t,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);return this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),e=this._getViewPartsToRender()),[e,new Wme(this._context.viewLayout,i,this._viewLines)]},prepareRender:(e,t)=>{for(const i of e)i.prepareRender(t)},render:(e,t)=>{for(const i of e)i.render(t),i.onDidRender()}}}delegateVerticalScrollbarPointerDown(e){this._scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this._scrollbar.delegateScrollFromMouseWheelEvent(e)}restoreState(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(e,t){const i=this._context.viewModel.model.validatePosition({lineNumber:e,column:t}),n=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();const o=this._viewLines.visibleRangeForPosition(new P(n.lineNumber,n.column));return o?o.left:-1}getTargetAtClientPoint(e,t){const i=this._pointerHandler.getTargetAtClientPoint(e,t);return i?Nx.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(e){return new fbe(this._context,e)}change(e){this._viewZones.changeViewZones(e),this._scheduleRender()}render(e,t){if(t){this._viewLines.forceShouldRender();for(const i of this._viewParts)i.forceShouldRender()}e?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(e){this._textAreaHandler.writeScreenReaderContent(e)}focus(){this._textAreaHandler.focusTextArea()}isFocused(){return this._textAreaHandler.isFocused()}setAriaOptions(e){this._textAreaHandler.setAriaOptions(e)}addContentWidget(e){this._contentWidgets.addWidget(e.widget),this.layoutContentWidget(e),this._scheduleRender()}layoutContentWidget(e){this._contentWidgets.setWidgetPosition(e.widget,e.position?.position??null,e.position?.secondaryPosition??null,e.position?.preference??null,e.position?.positionAffinity??null),this._scheduleRender()}removeContentWidget(e){this._contentWidgets.removeWidget(e.widget),this._scheduleRender()}addOverlayWidget(e){this._overlayWidgets.addWidget(e.widget),this.layoutOverlayWidget(e),this._scheduleRender()}layoutOverlayWidget(e){this._overlayWidgets.setWidgetPosition(e.widget,e.position)&&this._scheduleRender()}removeOverlayWidget(e){this._overlayWidgets.removeWidget(e.widget),this._scheduleRender()}addGlyphMarginWidget(e){this._glyphMarginWidgets.addWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(e){const t=e.position;this._glyphMarginWidgets.setWidgetPosition(e.widget,t)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(e){this._glyphMarginWidgets.removeWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};SR=Dbe([Ibe(6,ye)],SR);function Bd(s){try{return s()}catch(e){return Oe(e),null}}class iF{static{this.INSTANCE=new iF}constructor(){this._coordinatedRenderings=[],this._animationFrameRunners=new Map}scheduleCoordinatedRendering(e){return this._coordinatedRenderings.push(e),this._scheduleRender(e.window),{dispose:()=>{const t=this._coordinatedRenderings.indexOf(e);if(t!==-1&&(this._coordinatedRenderings.splice(t,1),this._coordinatedRenderings.length===0)){for(const[i,n]of this._animationFrameRunners)n.dispose();this._animationFrameRunners.clear()}}}}_scheduleRender(e){if(!this._animationFrameRunners.has(e)){const t=()=>{this._animationFrameRunners.delete(e),this._onRenderScheduled()};this._animationFrameRunners.set(e,V1(e,t,100))}}_onRenderScheduled(){const e=this._coordinatedRenderings.slice(0);this._coordinatedRenderings=[];for(const i of e)Bd(()=>i.prepareRenderText());const t=[];for(let i=0,n=e.length;i<n;i++){const o=e[i];t[i]=Bd(()=>o.renderText())}for(let i=0,n=e.length;i<n;i++){const o=e[i],r=t[i];if(!r)continue;const[a,l]=r;Bd(()=>o.prepareRender(a,l))}for(let i=0,n=e.length;i<n;i++){const o=e[i],r=t[i];if(!r)continue;const[a,l]=r;Bd(()=>o.render(a,l))}}}class pb{constructor(e,t,i,n,o){this.injectionOffsets=e,this.injectionOptions=t,this.breakOffsets=i,this.breakOffsetsVisibleColumn=n,this.wrappedTextIndentLength=o}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(e){return e>0?this.wrappedTextIndentLength:0}getLineLength(e){const t=e>0?this.breakOffsets[e-1]:0;let n=this.breakOffsets[e]-t;return e>0&&(n+=this.wrappedTextIndentLength),n}getMaxOutputOffset(e){return this.getLineLength(e)}translateToInputOffset(e,t){e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength));let n=e===0?t:this.breakOffsets[e-1]+t;if(this.injectionOffsets!==null)for(let o=0;o<this.injectionOffsets.length&&n>this.injectionOffsets[o];o++)n<this.injectionOffsets[o]+this.injectionOptions[o].content.length?n=this.injectionOffsets[o]:n-=this.injectionOptions[o].content.length;return n}translateToOutputPosition(e,t=2){let i=e;if(this.injectionOffsets!==null)for(let n=0;n<this.injectionOffsets.length&&!(e<this.injectionOffsets[n]||t!==1&&e===this.injectionOffsets[n]);n++)i+=this.injectionOptions[n].content.length;return this.offsetInInputWithInjectionsToOutputPosition(i,t)}offsetInInputWithInjectionsToOutputPosition(e,t=2){let i=0,n=this.breakOffsets.length-1,o=0,r=0;for(;i<=n;){o=i+(n-i)/2|0;const l=this.breakOffsets[o];if(r=o>0?this.breakOffsets[o-1]:0,t===0)if(e<=r)n=o-1;else if(e>l)i=o+1;else break;else if(e<r)n=o-1;else if(e>=l)i=o+1;else break}let a=e-r;return o>0&&(a+=this.wrappedTextIndentLength),new Xy(o,a)}normalizeOutputPosition(e,t,i){if(this.injectionOffsets!==null){const n=this.outputPositionToOffsetInInputWithInjections(e,t),o=this.normalizeOffsetInInputWithInjectionsAroundInjections(n,i);if(o!==n)return this.offsetInInputWithInjectionsToOutputPosition(o,i)}if(i===0){if(e>0&&t===this.getMinOutputOffset(e))return new Xy(e-1,this.getMaxOutputOffset(e-1))}else if(i===1){const n=this.getOutputLineCount()-1;if(e<n&&t===this.getMaxOutputOffset(e))return new Xy(e+1,this.getMinOutputOffset(e+1))}return new Xy(e,t)}outputPositionToOffsetInInputWithInjections(e,t){return e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength)),(e>0?this.breakOffsets[e-1]:0)+t}normalizeOffsetInInputWithInjectionsAroundInjections(e,t){const i=this.getInjectedTextAtOffset(e);if(!i)return e;if(t===2){if(e===i.offsetInInputWithInjections+i.length&&b9(this.injectionOptions[i.injectedTextIndex].cursorStops))return i.offsetInInputWithInjections+i.length;{let n=i.offsetInInputWithInjections;if(v9(this.injectionOptions[i.injectedTextIndex].cursorStops))return n;let o=i.injectedTextIndex-1;for(;o>=0&&this.injectionOffsets[o]===this.injectionOffsets[i.injectedTextIndex]&&!(b9(this.injectionOptions[o].cursorStops)||(n-=this.injectionOptions[o].content.length,v9(this.injectionOptions[o].cursorStops)));)o--;return n}}else if(t===1||t===4){let n=i.offsetInInputWithInjections+i.length,o=i.injectedTextIndex;for(;o+1<this.injectionOffsets.length&&this.injectionOffsets[o+1]===this.injectionOffsets[o];)n+=this.injectionOptions[o+1].content.length,o++;return n}else if(t===0||t===3){let n=i.offsetInInputWithInjections,o=i.injectedTextIndex;for(;o-1>=0&&this.injectionOffsets[o-1]===this.injectionOffsets[o];)n-=this.injectionOptions[o-1].content.length,o--;return n}ML()}getInjectedText(e,t){const i=this.outputPositionToOffsetInInputWithInjections(e,t),n=this.getInjectedTextAtOffset(i);return n?{options:this.injectionOptions[n.injectedTextIndex]}:null}getInjectedTextAtOffset(e){const t=this.injectionOffsets,i=this.injectionOptions;if(t!==null){let n=0;for(let o=0;o<t.length;o++){const r=i[o].content.length,a=t[o]+n,l=t[o]+n+r;if(a>e)break;if(e<=l)return{injectedTextIndex:o,offsetInInputWithInjections:a,length:r};n+=r}}}}function b9(s){return s==null?!0:s===Zr.Right||s===Zr.Both}function v9(s){return s==null?!0:s===Zr.Left||s===Zr.Both}class Xy{constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(e){return new P(e+this.outputLineIndex,this.outputOffset+1)}}const Tbe=Gc("domLineBreaksComputer",{createHTML:s=>s});class nF{static create(e){return new nF(new WeakRef(e))}constructor(e){this.targetWindow=e}createLineBreaksComputer(e,t,i,n,o){const r=[],a=[];return{addRequest:(l,c,d)=>{r.push(l),a.push(c)},finalize:()=>Ebe(Id(this.targetWindow.deref()),r,e,t,i,n,o,a)}}}function Ebe(s,e,t,i,n,o,r,a){function l(T){const F=a[T];if(F){const W=Ha.applyInjectedText(e[T],F),H=F.map(V=>V.options),$=F.map(V=>V.column-1);return new pb($,H,[W.length],[],0)}else return null}if(n===-1){const T=[];for(let F=0,W=e.length;F<W;F++)T[F]=l(F);return T}const c=Math.round(n*t.typicalHalfwidthCharacterWidth),h=Math.round(i*(o===3?2:o===2?1:0)),u=Math.ceil(t.spaceWidth*h),g=document.createElement("div");wn(g,t);const f=new vm(1e4),m=[],_=[],b=[],v=[],C=[];for(let T=0;T<e.length;T++){const F=Ha.applyInjectedText(e[T],a[T]);let W=0,H=0,$=c;if(o!==0)if(W=rs(F),W===-1)W=0;else{for(let ue=0;ue<W;ue++){const fe=F.charCodeAt(ue)===9?i-H%i:1;H+=fe}const ie=Math.ceil(t.spaceWidth*H);ie+t.typicalFullwidthCharacterWidth>c?(W=0,H=0):$=c-ie}const V=F.substr(W),Y=Nbe(V,H,i,$,f,u);m[T]=W,_[T]=H,b[T]=V,v[T]=Y[0],C[T]=Y[1]}const y=f.build(),w=Tbe?.createHTML(y)??y;g.innerHTML=w,g.style.position="absolute",g.style.top="10000",r==="keepAll"?(g.style.wordBreak="keep-all",g.style.overflowWrap="anywhere"):(g.style.wordBreak="inherit",g.style.overflowWrap="break-word"),s.document.body.appendChild(g);const x=document.createRange(),L=Array.prototype.slice.call(g.children,0),D=[];for(let T=0;T<e.length;T++){const F=L[T],W=Rbe(x,F,b[T],v[T]);if(W===null){D[T]=l(T);continue}const H=m[T],$=_[T]+h,V=C[T],Y=[];for(let oe=0,be=W.length;oe<be;oe++)Y[oe]=V[W[oe]];if(H!==0)for(let oe=0,be=W.length;oe<be;oe++)W[oe]+=H;let ie,ue;const fe=a[T];fe?(ie=fe.map(oe=>oe.options),ue=fe.map(oe=>oe.column-1)):(ie=null,ue=null),D[T]=new pb(ue,ie,W,Y,$)}return g.remove(),D}function Nbe(s,e,t,i,n,o){if(o!==0){const u=String(o);n.appendString('<div style="text-indent: -'),n.appendString(u),n.appendString("px; padding-left: "),n.appendString(u),n.appendString("px; box-sizing: border-box; width:")}else n.appendString('<div style="width:');n.appendString(String(i)),n.appendString('px;">');const r=s.length;let a=e,l=0;const c=[],d=[];let h=0<r?s.charCodeAt(0):0;n.appendString("<span>");for(let u=0;u<r;u++){u!==0&&u%16384===0&&n.appendString("</span><span>"),c[u]=l,d[u]=a;const g=h;h=u+1<r?s.charCodeAt(u+1):0;let f=1,m=1;switch(g){case 9:f=t-a%t,m=f;for(let _=1;_<=f;_++)_<f?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 32:h===32?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 60:n.appendString("&lt;");break;case 62:n.appendString("&gt;");break;case 38:n.appendString("&amp;");break;case 0:n.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:n.appendCharCode(65533);break;default:ih(g)&&m++,g<32?n.appendCharCode(9216+g):n.appendCharCode(g)}l+=f,a+=m}return n.appendString("</span>"),c[s.length]=l,d[s.length]=a,n.appendString("</div>"),[c,d]}function Rbe(s,e,t,i){if(t.length<=1)return null;const n=Array.prototype.slice.call(e.children,0),o=[];try{LR(s,n,i,0,null,t.length-1,null,o)}catch(r){return console.log(r),null}return o.length===0?null:(o.push(t.length),o)}function LR(s,e,t,i,n,o,r,a){if(i===o||(n=n||XD(s,e,t[i],t[i+1]),r=r||XD(s,e,t[o],t[o+1]),Math.abs(n[0].top-r[0].top)<=.1))return;if(i+1===o){a.push(o);return}const l=i+(o-i)/2|0,c=XD(s,e,t[l],t[l+1]);LR(s,e,t,i,n,l,c,a),LR(s,e,t,l,c,o,r,a)}function XD(s,e,t,i){return s.setStart(e[t/16384|0].firstChild,t%16384),s.setEnd(e[i/16384|0].firstChild,i%16384),s.getClientRects()}class Mbe extends B{constructor(){super(),this._editor=null,this._instantiationService=null,this._instances=this._register(new RP),this._pending=new Map,this._finishedInstantiation=[],this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,i){this._editor=e,this._instantiationService=i;for(const n of t){if(this._pending.has(n.id)){Oe(new Error(`Cannot have two contributions with the same id ${n.id}`));continue}this._pending.set(n.id,n)}this._instantiateSome(0),this._register(v_(ke(this._editor.getDomNode()),()=>{this._instantiateSome(1)})),this._register(v_(ke(this._editor.getDomNode()),()=>{this._instantiateSome(2)})),this._register(v_(ke(this._editor.getDomNode()),()=>{this._instantiateSome(3)},5e3))}saveViewState(){const e={};for(const[t,i]of this._instances)typeof i.saveViewState=="function"&&(e[t]=i.saveViewState());return e}restoreViewState(e){for(const[t,i]of this._instances)typeof i.restoreViewState=="function"&&i.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){return v_(ke(this._editor?.getDomNode()),()=>{this._instantiateSome(1)},50)}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;const t=this._findPendingContributionsByInstantiation(e);for(const i of t)this._instantiateById(i.id)}_findPendingContributionsByInstantiation(e){const t=[];for(const[,i]of this._pending)i.instantiation===e&&t.push(i);return t}_instantiateById(e){const t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{const i=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,i),typeof i.restoreViewState=="function"&&t.instantiation!==0&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(i){Oe(i)}}}}class ij{constructor(e,t,i,n,o,r,a){this.id=e,this.label=t,this.alias=i,this.metadata=n,this._precondition=o,this._run=r,this._contextKeyService=a}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(e){return this.isSupported()?this._run(e):Promise.resolve(void 0)}}class sF{static create(e){return new sF(e.get(135),e.get(134))}constructor(e,t){this.classifier=new Abe(e,t)}createLineBreaksComputer(e,t,i,n,o){const r=[],a=[],l=[];return{addRequest:(c,d,h)=>{r.push(c),a.push(d),l.push(h)},finalize:()=>{const c=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth,d=[];for(let h=0,u=r.length;h<u;h++){const g=a[h],f=l[h];f&&!f.injectionOptions&&!g?d[h]=Pbe(this.classifier,f,r[h],t,i,c,n,o):d[h]=Obe(this.classifier,r[h],g,t,i,c,n,o)}return xR.length=0,kR.length=0,d}}}}class Abe extends Cm{constructor(e,t){super(0);for(let i=0;i<e.length;i++)this.set(e.charCodeAt(i),1);for(let i=0;i<t.length;i++)this.set(t.charCodeAt(i),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}}let xR=[],kR=[];function Pbe(s,e,t,i,n,o,r,a){if(n===-1)return null;const l=t.length;if(l<=1)return null;const c=a==="keepAll",d=e.breakOffsets,h=e.breakOffsetsVisibleColumn,u=nj(t,i,n,o,r),g=n-u,f=xR,m=kR;let _=0,b=0,v=0,C=n;const y=d.length;let w=0;if(w>=0){let x=Math.abs(h[w]-C);for(;w+1<y;){const L=Math.abs(h[w+1]-C);if(L>=x)break;x=L,w++}}for(;w<y;){let x=w<0?0:d[w],L=w<0?0:h[w];b>x&&(x=b,L=v);let D=0,T=0,F=0,W=0;if(L<=C){let $=L,V=x===0?0:t.charCodeAt(x-1),Y=x===0?0:s.get(V),ie=!0;for(let ue=x;ue<l;ue++){const fe=ue,oe=t.charCodeAt(ue);let be,xe;if(Qi(oe)?(ue++,be=0,xe=2):(be=s.get(oe),xe=mb(oe,$,i,o)),fe>b&&DR(V,Y,oe,be,c)&&(D=fe,T=$),$+=xe,$>C){fe>b?(F=fe,W=$-xe):(F=ue+1,W=$),$-T>g&&(D=0),ie=!1;break}V=oe,Y=be}if(ie){_>0&&(f[_]=d[d.length-1],m[_]=h[d.length-1],_++);break}}if(D===0){let $=L,V=t.charCodeAt(x),Y=s.get(V),ie=!1;for(let ue=x-1;ue>=b;ue--){const fe=ue+1,oe=t.charCodeAt(ue);if(oe===9){ie=!0;break}let be,xe;if(Uu(oe)?(ue--,be=0,xe=2):(be=s.get(oe),xe=ih(oe)?o:1),$<=C){if(F===0&&(F=fe,W=$),$<=C-g)break;if(DR(oe,be,V,Y,c)){D=fe,T=$;break}}$-=xe,V=oe,Y=be}if(D!==0){const ue=g-(W-T);if(ue<=i){const fe=t.charCodeAt(F);let oe;Qi(fe)?oe=2:oe=mb(fe,W,i,o),ue-oe<0&&(D=0)}}if(ie){w--;continue}}if(D===0&&(D=F,T=W),D<=b){const $=t.charCodeAt(b);Qi($)?(D=b+2,T=v+2):(D=b+1,T=v+mb($,v,i,o))}for(b=D,f[_]=D,v=T,m[_]=T,_++,C=T+g;w<0||w<y&&h[w]<T;)w++;let H=Math.abs(h[w]-C);for(;w+1<y;){const $=Math.abs(h[w+1]-C);if($>=H)break;H=$,w++}}return _===0?null:(f.length=_,m.length=_,xR=e.breakOffsets,kR=e.breakOffsetsVisibleColumn,e.breakOffsets=f,e.breakOffsetsVisibleColumn=m,e.wrappedTextIndentLength=u,e)}function Obe(s,e,t,i,n,o,r,a){const l=Ha.applyInjectedText(e,t);let c,d;if(t&&t.length>0?(c=t.map(T=>T.options),d=t.map(T=>T.column-1)):(c=null,d=null),n===-1)return c?new pb(d,c,[l.length],[],0):null;const h=l.length;if(h<=1)return c?new pb(d,c,[l.length],[],0):null;const u=a==="keepAll",g=nj(l,i,n,o,r),f=n-g,m=[],_=[];let b=0,v=0,C=0,y=n,w=l.charCodeAt(0),x=s.get(w),L=mb(w,0,i,o),D=1;Qi(w)&&(L+=1,w=l.charCodeAt(1),x=s.get(w),D++);for(let T=D;T<h;T++){const F=T,W=l.charCodeAt(T);let H,$;Qi(W)?(T++,H=0,$=2):(H=s.get(W),$=mb(W,L,i,o)),DR(w,x,W,H,u)&&(v=F,C=L),L+=$,L>y&&((v===0||L-C>f)&&(v=F,C=L-$),m[b]=v,_[b]=C,b++,y=C+f,v=0),w=W,x=H}return b===0&&(!t||t.length===0)?null:(m[b]=h,_[b]=L,new pb(d,c,m,_,g))}function mb(s,e,t,i){return s===9?t-e%t:ih(s)||s<32?i:1}function C9(s,e){return e-s%e}function DR(s,e,t,i,n){return t!==32&&(e===2&&i!==2||e!==1&&i===1||!n&&e===3&&i!==2||!n&&i===3&&e!==1)}function nj(s,e,t,i,n){let o=0;if(n!==0){const r=rs(s);if(r!==-1){for(let l=0;l<r;l++){const c=s.charCodeAt(l)===9?C9(o,e):1;o+=c}const a=n===3?2:n===2?1:0;for(let l=0;l<a;l++){const c=C9(o,e);o+=c}o+i>t&&(o=0)}}return o}class dS{constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new _n(new k(1,1,1,1),0,0,new P(1,1),0),new _n(new k(1,1,1,1),0,0,new P(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new ut(this.modelState,this.viewState)}readSelectionFromMarkers(e){const t=e.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!t.isEmpty()?me.fromRange(t.collapseToEnd(),this.modelState.selection.getDirection()):me.fromRange(t,this.modelState.selection.getDirection())}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,i){this._setState(e,t,i)}static _validatePositionWithCache(e,t,i,n){return t.equals(i)?n:e.normalizePosition(t,2)}static _validateViewState(e,t){const i=t.position,n=t.selectionStart.getStartPosition(),o=t.selectionStart.getEndPosition(),r=e.normalizePosition(i,2),a=this._validatePositionWithCache(e,n,i,r),l=this._validatePositionWithCache(e,o,n,a);return i.equals(r)&&n.equals(a)&&o.equals(l)?t:new _n(k.fromPositions(a,l),t.selectionStartKind,t.selectionStartLeftoverVisibleColumns+n.column-a.column,r,t.leftoverVisibleColumns+i.column-r.column)}_setState(e,t,i){if(i&&(i=dS._validateViewState(e.viewModel,i)),t){const n=e.model.validateRange(t.selectionStart),o=t.selectionStart.equalsRange(n)?t.selectionStartLeftoverVisibleColumns:0,r=e.model.validatePosition(t.position),a=t.position.equals(r)?t.leftoverVisibleColumns:0;t=new _n(n,t.selectionStartKind,o,r,a)}else{if(!i)return;const n=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(i.selectionStart)),o=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(i.position));t=new _n(n,i.selectionStartKind,i.selectionStartLeftoverVisibleColumns,o,i.leftoverVisibleColumns)}if(i){const n=e.coordinatesConverter.validateViewRange(i.selectionStart,t.selectionStart),o=e.coordinatesConverter.validateViewPosition(i.position,t.position);i=new _n(n,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,o,t.leftoverVisibleColumns)}else{const n=e.coordinatesConverter.convertModelPositionToViewPosition(new P(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),o=e.coordinatesConverter.convertModelPositionToViewPosition(new P(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),r=new k(n.lineNumber,n.column,o.lineNumber,o.column),a=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);i=new _n(r,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,a,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=i,this._updateTrackedRange(e)}}class y9{constructor(e){this.context=e,this.cursors=[new dS(e)],this.lastAddedCursorIndex=0}dispose(){for(const e of this.cursors)e.dispose(this.context)}startTrackingSelections(){for(const e of this.cursors)e.startTrackingSelection(this.context)}stopTrackingSelections(){for(const e of this.cursors)e.stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){for(const e of this.cursors)e.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(e=>e.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(e=>e.asCursorState())}getViewPositions(){return this.cursors.map(e=>e.viewState.position)}getTopMostViewPosition(){return jne(this.cursors,bs(e=>e.viewState.position,P.compare)).viewState.position}getBottomMostViewPosition(){return $ne(this.cursors,bs(e=>e.viewState.position,P.compare)).viewState.position}getSelections(){return this.cursors.map(e=>e.modelState.selection)}getViewSelections(){return this.cursors.map(e=>e.viewState.selection)}setSelections(e){this.setStates(ut.fromModelSelections(e))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(e){e!==null&&(this.cursors[0].setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){const t=this.cursors.length-1,i=e.length;if(t<i){const n=i-t;for(let o=0;o<n;o++)this._addSecondaryCursor()}else if(t>i){const n=t-i;for(let o=0;o<n;o++)this._removeSecondaryCursor(this.cursors.length-2)}for(let n=0;n<i;n++)this.cursors[n+1].setState(this.context,e[n].modelState,e[n].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new dS(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.cursors[e+1].dispose(this.context),this.cursors.splice(e+1,1)}normalize(){if(this.cursors.length===1)return;const e=this.cursors.slice(0),t=[];for(let i=0,n=e.length;i<n;i++)t.push({index:i,selection:e[i].modelState.selection});t.sort(bs(i=>i.selection,k.compareRangesUsingStarts));for(let i=0;i<t.length-1;i++){const n=t[i],o=t[i+1],r=n.selection,a=o.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||r.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(r.getEndPosition()):l=a.getStartPosition().isBefore(r.getEndPosition()),l){const c=n.index<o.index?i:i+1,d=n.index<o.index?i+1:i,h=t[d].index,u=t[c].index,g=t[d].selection,f=t[c].selection;if(!g.equalsSelection(f)){const m=g.plusRange(f),_=g.selectionStartLineNumber===g.startLineNumber&&g.selectionStartColumn===g.startColumn,b=f.selectionStartLineNumber===f.startLineNumber&&f.selectionStartColumn===f.startColumn;let v;h===this.lastAddedCursorIndex?(v=_,this.lastAddedCursorIndex=u):v=b;let C;v?C=new me(m.startLineNumber,m.startColumn,m.endLineNumber,m.endColumn):C=new me(m.endLineNumber,m.endColumn,m.startLineNumber,m.startColumn),t[c].selection=C;const y=ut.fromModelSelection(C);e[u].setState(this.context,y.modelState,y.viewState)}for(const m of t)m.index>h&&m.index--;e.splice(h,1),t.splice(d,1),this._removeSecondaryCursor(h-1),i--}}}}class w9{constructor(e,t,i,n){this._cursorContextBrand=void 0,this.model=e,this.viewModel=t,this.coordinatesConverter=i,this.cursorConfig=n}}class Fbe{constructor(){this.type=0}}class Bbe{constructor(){this.type=1}}class Wbe{constructor(e){this.type=2,this._source=e}hasChanged(e){return this._source.hasChanged(e)}}class Hbe{constructor(e,t,i){this.selections=e,this.modelSelections=t,this.reason=i,this.type=3}}class Wh{constructor(e){this.type=4,e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler,this.affectsGlyphMargin=e.affectsGlyphMargin,this.affectsLineNumber=e.affectsLineNumber):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0,this.affectsLineNumber=!0)}}class Qy{constructor(){this.type=5}}class Vbe{constructor(e){this.type=6,this.isFocused=e}}class zbe{constructor(){this.type=7}}class Jy{constructor(){this.type=8}}class sj{constructor(e,t){this.fromLineNumber=e,this.count=t,this.type=9}}class IR{constructor(e,t){this.type=10,this.fromLineNumber=e,this.toLineNumber=t}}class TR{constructor(e,t){this.type=11,this.fromLineNumber=e,this.toLineNumber=t}}class _b{constructor(e,t,i,n,o,r,a){this.source=e,this.minimalReveal=t,this.range=i,this.selections=n,this.verticalType=o,this.revealHorizontal=r,this.scrollType=a,this.type=12}}class Ube{constructor(e){this.type=13,this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}}class $be{constructor(e){this.theme=e,this.type=14}}class jbe{constructor(e){this.type=15,this.ranges=e}}class Zbe{constructor(){this.type=16}}let Kbe=class{constructor(){this.type=17}};class qbe extends B{constructor(){super(),this._onEvent=this._register(new O),this.onEvent=this._onEvent.event,this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let t=0,i=this._outgoingEvents.length;t<i;t++){const n=this._outgoingEvents[t].kind===e.kind?this._outgoingEvents[t].attemptToMerge(e):null;if(n){this._outgoingEvents[t]=n;return}}this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;const e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,i=this._eventHandlers.length;t<i;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e);this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new Gbe),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){const e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(const i of e)this._addOutgoingEvent(i);t.length>0&&this._emitMany(t)}this._emitOutgoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){const e=this._viewEventQueue;this._viewEventQueue=null;const t=this._eventHandlers.slice(0);for(const i of t)i.handleEvents(e)}}}class Gbe{constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}}class oF{constructor(e,t,i,n){this.kind=0,this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=i,this.contentHeight=n,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(e){return e.kind!==this.kind?null:new oF(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}}class rF{constructor(e,t){this.kind=1,this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new rF(this.oldHasFocus,e.hasFocus)}}class aF{constructor(e,t,i,n,o,r,a,l){this.kind=2,this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=i,this._oldScrollTop=n,this.scrollWidth=o,this.scrollLeft=r,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(e){return e.kind!==this.kind?null:new aF(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}}class Ybe{constructor(){this.kind=3}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class Xbe{constructor(){this.kind=4}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class hS{constructor(e,t,i,n,o,r,a){this.kind=6,this.oldSelections=e,this.selections=t,this.oldModelVersionId=i,this.modelVersionId=n,this.source=o,this.reason=r,this.reachedMaxCursorCount=a}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;const i=e.length,n=t.length;if(i!==n)return!1;for(let o=0;o<i;o++)if(!e[o].equalsSelection(t[o]))return!1;return!0}isNoOp(){return hS._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(e){return e.kind!==this.kind?null:new hS(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}}class Qbe{constructor(){this.kind=5}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class Jbe{constructor(e){this.event=e,this.kind=7}isNoOp(){return!1}attemptToMerge(e){return null}}class eve{constructor(e){this.event=e,this.kind=8}isNoOp(){return!1}attemptToMerge(e){return null}}class tve{constructor(e){this.event=e,this.kind=9}isNoOp(){return!1}attemptToMerge(e){return null}}class ive{constructor(e){this.event=e,this.kind=10}isNoOp(){return!1}attemptToMerge(e){return null}}class nve{constructor(e){this.event=e,this.kind=11}isNoOp(){return!1}attemptToMerge(e){return null}}class sve{constructor(e){this.event=e,this.kind=12}isNoOp(){return!1}attemptToMerge(e){return null}}class ove extends B{constructor(e,t,i,n){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=i,this.context=new w9(this._model,this._viewModel,this._coordinatesConverter,n),this._cursors=new y9(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=At(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new w9(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){const e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){const i=this._autoClosedActions[t];i.isValid(e)||(i.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,i,n){let o=!1;const r=this.context.cursorConfig.multiCursorLimit;n!==null&&n.length>r&&(n=n.slice(0,r),o=!0);const a=bb.from(this._model,this);return this._cursors.setStates(n),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,i,a,o)}setCursorColumnSelectData(e){this._columnSelectData=e}revealAll(e,t,i,n,o,r){const a=this._cursors.getViewPositions();let l=null,c=null;a.length>1?c=this._cursors.getViewSelections():l=k.fromPositions(a[0],a[0]),e.emitViewEvent(new _b(t,i,l,c,n,o,r))}revealPrimary(e,t,i,n,o,r){const l=[this._cursors.getPrimaryCursor().viewState.selection];e.emitViewEvent(new _b(t,i,null,l,n,o,r))}saveState(){const e=[],t=this._cursors.getSelections();for(let i=0,n=t.length;i<n;i++){const o=t[i];e.push({inSelectionMode:!o.isEmpty(),selectionStart:{lineNumber:o.selectionStartLineNumber,column:o.selectionStartColumn},position:{lineNumber:o.positionLineNumber,column:o.positionColumn}})}return e}restoreState(e,t){const i=[];for(let n=0,o=t.length;n<o;n++){const r=t[n];let a=1,l=1;r.position&&r.position.lineNumber&&(a=r.position.lineNumber),r.position&&r.position.column&&(l=r.position.column);let c=a,d=l;r.selectionStart&&r.selectionStart.lineNumber&&(c=r.selectionStart.lineNumber),r.selectionStart&&r.selectionStart.column&&(d=r.selectionStart.column),i.push({selectionStartLineNumber:c,selectionStartColumn:d,positionLineNumber:a,positionColumn:l})}this.setStates(e,"restoreState",0,ut.fromModelSelections(i)),this.revealAll(e,"restoreState",!1,0,!0,1)}onModelContentChanged(e,t){if(t instanceof HU){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{const i=t.rawContentChangedEvent;if(this._knownModelVersionId=i.versionId,this._isHandling)return;const n=i.containsEvent(1);if(this._prevEditOperationType=0,n)this._cursors.dispose(),this._cursors=new y9(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&i.resultingSelection&&i.resultingSelection.length>0){const o=ut.fromModelSelections(i.resultingSelection);this.setStates(e,"modelChange",i.isUndoing?5:i.isRedoing?6:2,o)&&this.revealAll(e,"modelChange",!1,0,!0,0)}else{const o=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,ut.fromModelSelections(o))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;const e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),i=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,t),toViewLineNumber:i.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,i)}}getSelections(){return this._cursors.getSelections()}setSelections(e,t,i,n){this.setStates(e,t,n,ut.fromModelSelections(i))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){const i=[],n=[];for(let a=0,l=e.length;a<l;a++)i.push({range:e[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),n.push({range:t[a],options:{description:"auto-closed-enclosing",stickiness:1}});const o=this._model.deltaDecorations([],i),r=this._model.deltaDecorations([],n);this._autoClosedActions.push(new S9(this._model,o,r))}_executeEditOperation(e){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();const t=rve.executeCommands(this._model,this._cursors.getSelections(),e.commands);if(t){this._interpretCommandResult(t);const i=[],n=[];for(let o=0;o<e.commands.length;o++){const r=e.commands[o];r instanceof XO&&r.enclosingRange&&r.closeCharacterRange&&(i.push(r.closeCharacterRange),n.push(r.enclosingRange))}i.length>0&&this._pushAutoClosedAction(i,n),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){(!e||e.length===0)&&(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,i,n,o){const r=bb.from(this._model,this);if(r.equals(n))return!1;const a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(e.emitViewEvent(new Hbe(l,a,i)),!n||n.cursorState.length!==r.cursorState.length||r.cursorState.some((c,d)=>!c.modelState.equals(n.cursorState[d].modelState))){const c=n?n.cursorState.map(h=>h.modelState.selection):null,d=n?n.modelVersionId:0;e.emitOutgoingEvent(new hS(c,a,d,r.modelVersionId,t||"keyboard",i,o))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;const t=[];for(let i=0,n=e.length;i<n;i++){const o=e[i];if(!o.text||o.text.indexOf(`
`)>=0)return null;const r=o.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!r)return null;const a=r[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;const c=l[0].open,d=o.text.length-r[2].length-1,h=o.text.lastIndexOf(c,d-1);if(h===-1)return null;t.push([h,d])}return t}executeEdits(e,t,i,n){let o=null;t==="snippet"&&(o=this._findAutoClosingPairs(i)),o&&(i[0]._isTracked=!0);const r=[],a=[],l=this._model.pushEditOperations(this.getSelections(),i,c=>{if(o)for(let h=0,u=o.length;h<u;h++){const[g,f]=o[h],m=c[h],_=m.range.startLineNumber,b=m.range.startColumn-1+g,v=m.range.startColumn-1+f;r.push(new k(_,v+1,_,v+2)),a.push(new k(_,b+1,_,v+2))}const d=n(c);return d&&(this._isHandling=!0),d});l&&(this._isHandling=!1,this.setSelections(e,t,l,0)),r.length>0&&this._pushAutoClosedAction(r,a)}_executeEdit(e,t,i,n=0){if(this.context.cursorConfig.readOnly)return;const o=bb.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(r){Oe(r)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,i,n,o,!1)&&this.revealAll(t,i,!1,0,!0,0)}getAutoClosedCharacters(){return S9.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._compositionState=new vb(this._model,this.getSelections())}endComposition(e,t){const i=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{t==="keyboard"&&this._executeEditOperation(xd.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,i,this.getSelections(),this.getAutoClosedCharacters()))},e,t)}type(e,t,i){this._executeEdit(()=>{if(i==="keyboard"){const n=t.length;let o=0;for(;o<n;){const r=zP(t,o),a=t.substr(o,r);this._executeEditOperation(xd.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),a)),o+=r}}else this._executeEditOperation(xd.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t))},e,i)}compositionType(e,t,i,n,o,r){if(t.length===0&&i===0&&n===0){if(o!==0){const a=this.getSelections().map(l=>{const c=l.getPosition();return new me(c.lineNumber,c.column+o,c.lineNumber,c.column+o)});this.setSelections(e,r,a,0)}return}this._executeEdit(()=>{this._executeEditOperation(xd.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,i,n,o))},e,r)}paste(e,t,i,n,o){this._executeEdit(()=>{this._executeEditOperation(xd.paste(this.context.cursorConfig,this._model,this.getSelections(),t,i,n||[]))},e,o,4)}cut(e,t){this._executeEdit(()=>{this._executeEditOperation(ig.cut(this.context.cursorConfig,this._model,this.getSelections()))},e,t)}executeCommand(e,t,i){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new js(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,i)}executeCommands(e,t,i){this._executeEdit(()=>{this._executeEditOperation(new js(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,i)}}class bb{static from(e,t){return new bb(e.getVersionId(),t.getCursorStates())}constructor(e,t){this.modelVersionId=e,this.cursorState=t}equals(e){if(!e||this.modelVersionId!==e.modelVersionId||this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,i=this.cursorState.length;t<i;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}}class S9{static getAllAutoClosedCharacters(e){let t=[];for(const i of e)t=t.concat(i.getAutoClosedCharactersRanges());return t}constructor(e,t,i){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=i}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){const e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){const i=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);i&&e.push(i)}return e}isValid(e){const t=[];for(let i=0;i<this._autoClosedEnclosingDecorations.length;i++){const n=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[i]);if(n&&(t.push(n),n.startLineNumber!==n.endLineNumber))return!1}t.sort(k.compareRangesUsingStarts),e.sort(k.compareRangesUsingStarts);for(let i=0;i<e.length;i++)if(i>=t.length||!t[i].strictContainsRange(e[i]))return!1;return!0}}class rve{static executeCommands(e,t,i){const n={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},o=this._innerExecuteCommands(n,i);for(let r=0,a=n.trackedRanges.length;r<a;r++)n.model._setTrackedRange(n.trackedRanges[r],null,0);return o}static _innerExecuteCommands(e,t){if(this._arrayIsEmpty(t))return null;const i=this._getEditOperations(e,t);if(i.operations.length===0)return null;const n=i.operations,o=this._getLoserCursorMap(n);if(o.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;const r=[];for(let c=0,d=n.length;c<d;c++)o.hasOwnProperty(n[c].identifier.major.toString())||r.push(n[c]);i.hadTrackedEditOperation&&r.length>0&&(r[0]._isTracked=!0);let a=e.model.pushEditOperations(e.selectionsBefore,r,c=>{const d=[];for(let g=0;g<e.selectionsBefore.length;g++)d[g]=[];for(const g of c)g.identifier&&d[g.identifier.major].push(g);const h=(g,f)=>g.identifier.minor-f.identifier.minor,u=[];for(let g=0;g<e.selectionsBefore.length;g++)d[g].length>0?(d[g].sort(h),u[g]=t[g].computeCursorState(e.model,{getInverseEditOperations:()=>d[g],getTrackedSelection:f=>{const m=parseInt(f,10),_=e.model._getTrackedRange(e.trackedRanges[m]);return e.trackedRangesDirection[m]===0?new me(_.startLineNumber,_.startColumn,_.endLineNumber,_.endColumn):new me(_.endLineNumber,_.endColumn,_.startLineNumber,_.startColumn)}})):u[g]=e.selectionsBefore[g];return u});a||(a=e.selectionsBefore);const l=[];for(const c in o)o.hasOwnProperty(c)&&l.push(parseInt(c,10));l.sort((c,d)=>d-c);for(const c of l)a.splice(c,1);return a}static _arrayIsEmpty(e){for(let t=0,i=e.length;t<i;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let i=[],n=!1;for(let o=0,r=t.length;o<r;o++){const a=t[o];if(a){const l=this._getEditOperationsFromCommand(e,o,a);i=i.concat(l.operations),n=n||l.hadTrackedEditOperation}}return{operations:i,hadTrackedEditOperation:n}}static _getEditOperationsFromCommand(e,t,i){const n=[];let o=0;const r=(h,u,g=!1)=>{k.isEmpty(h)&&u===""||n.push({identifier:{major:t,minor:o++},range:h,text:u,forceMoveMarkers:g,isAutoWhitespaceEdit:i.insertsAutoWhitespace})};let a=!1;const d={addEditOperation:r,addTrackedEditOperation:(h,u,g)=>{a=!0,r(h,u,g)},trackSelection:(h,u)=>{const g=me.liftSelection(h);let f;if(g.isEmpty())if(typeof u=="boolean")u?f=2:f=3;else{const b=e.model.getLineMaxColumn(g.startLineNumber);g.startColumn===b?f=2:f=3}else f=1;const m=e.trackedRanges.length,_=e.model._setTrackedRange(null,g,f);return e.trackedRanges[m]=_,e.trackedRangesDirection[m]=g.getDirection(),m.toString()}};try{i.getEditOperations(e.model,d)}catch(h){return Oe(h),{operations:[],hadTrackedEditOperation:!1}}return{operations:n,hadTrackedEditOperation:a}}static _getLoserCursorMap(e){e=e.slice(0),e.sort((i,n)=>-k.compareRangesUsingEnds(i.range,n.range));const t={};for(let i=1;i<e.length;i++){const n=e[i-1],o=e[i];if(k.getStartPosition(n.range).isBefore(k.getEndPosition(o.range))){let r;n.identifier.major>o.identifier.major?r=n.identifier.major:r=o.identifier.major,t[r.toString()]=!0;for(let a=0;a<e.length;a++)e[a].identifier.major===r&&(e.splice(a,1),a<i&&i--,a--);i>0&&i--}}return t}}class ave{constructor(e,t,i){this.text=e,this.startSelection=t,this.endSelection=i}}class vb{static _capture(e,t){const i=[];for(const n of t){if(n.startLineNumber!==n.endLineNumber)return null;i.push(new ave(e.getLineContent(n.startLineNumber),n.startColumn-1,n.endColumn-1))}return i}constructor(e,t){this._original=vb._capture(e,t)}deduceOutcome(e,t){if(!this._original)return null;const i=vb._capture(e,t);if(!i||this._original.length!==i.length)return null;const n=[];for(let o=0,r=this._original.length;o<r;o++)n.push(vb._deduceOutcome(this._original[o],i[o]));return n}static _deduceOutcome(e,t){const i=Math.min(e.startSelection,t.startSelection,th(e.text,t.text)),n=Math.min(e.text.length-e.endSelection,t.text.length-t.endSelection,O1(e.text,t.text)),o=e.text.substring(i,e.text.length-n),r=t.text.substring(i,t.text.length-n);return new A_e(o,e.startSelection-i,e.endSelection-i,r,t.startSelection-i,t.endSelection-i)}}class lve{constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}mustCommit(){return this._hasPending}commit(e){if(!this._hasPending)return;const t=this._inserts,i=this._changes,n=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,i,n)}}class cve{constructor(e,t,i,n,o){this.id=e,this.afterLineNumber=t,this.ordinal=i,this.height=n,this.minWidth=o,this.prefixSum=0}}let dve=class ER{static{this.INSTANCE_COUNT=0}constructor(e,t,i,n){this._instanceId=N6(++ER.INSTANCE_COUNT),this._pendingChanges=new lve,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._lineHeight=t,this._paddingTop=i,this._paddingBottom=n}static findInsertionIndex(e,t,i){let n=0,o=e.length;for(;n<o;){const r=n+o>>>1;t===e[r].afterLineNumber?i<e[r].ordinal?o=r:n=r+1:t<e[r].afterLineNumber?o=r:n=r+1}return n}setLineHeight(e){this._checkPendingChanges(),this._lineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e){this._checkPendingChanges(),this._lineCount=e}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(n,o,r,a)=>{t=!0,n=n|0,o=o|0,r=r|0,a=a|0;const l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new cve(l,n,o,r,a)),l},changeOneWhitespace:(n,o,r)=>{t=!0,o=o|0,r=r|0,this._pendingChanges.change({id:n,newAfterLineNumber:o,newHeight:r})},removeWhitespace:n=>{t=!0,this._pendingChanges.remove({id:n})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,i){if((e.length>0||i.length>0)&&(this._minWidth=-1),e.length+t.length+i.length<=1){for(const l of e)this._insertWhitespace(l);for(const l of t)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(const l of i){const c=this._findWhitespaceIndex(l.id);c!==-1&&this._removeWhitespace(c)}return}const n=new Set;for(const l of i)n.add(l.id);const o=new Map;for(const l of t)o.set(l.id,l);const r=l=>{const c=[];for(const d of l)if(!n.has(d.id)){if(o.has(d.id)){const h=o.get(d.id);d.afterLineNumber=h.newAfterLineNumber,d.height=h.newHeight}c.push(d)}return c},a=r(this._arr).concat(r(e));a.sort((l,c)=>l.afterLineNumber===c.afterLineNumber?l.ordinal-c.ordinal:l.afterLineNumber-c.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(e){const t=ER.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){const t=this._arr;for(let i=0,n=t.length;i<n;i++)if(t[i].id===e)return i;return-1}_changeOneWhitespace(e,t,i){const n=this._findWhitespaceIndex(e);if(n!==-1&&(this._arr[n].height!==i&&(this._arr[n].height=i,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,n-1)),this._arr[n].afterLineNumber!==t)){const o=this._arr[n];this._removeWhitespace(n),o.afterLineNumber=t,this._insertWhitespace(o)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount-=t-e+1;for(let i=0,n=this._arr.length;i<n;i++){const o=this._arr[i].afterLineNumber;e<=o&&o<=t?this._arr[i].afterLineNumber=e-1:o>t&&(this._arr[i].afterLineNumber-=t-e+1)}}onLinesInserted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount+=t-e+1;for(let i=0,n=this._arr.length;i<n;i++){const o=this._arr[i].afterLineNumber;e<=o&&(this._arr[i].afterLineNumber+=t-e+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){this._checkPendingChanges(),e=e|0;let t=Math.max(0,this._prefixSumValidIndex+1);t===0&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let i=t;i<=e;i++)this._arr[i].prefixSum=this._arr[i-1].prefixSum+this._arr[i].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();const e=this._lineHeight*this._lineCount,t=this.getWhitespacesTotalHeight();return e+t+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){this._checkPendingChanges(),e=e|0;const t=this._findLastWhitespaceBeforeLineNumber(e);return t===-1?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e=e|0;const t=this._arr;let i=0,n=t.length-1;for(;i<=n;){const r=(n-i|0)/2|0,a=i+r|0;if(t[a].afterLineNumber<e){if(a+1>=t.length||t[a+1].afterLineNumber>=e)return a;i=a+1|0}else n=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e=e|0;const i=this._findLastWhitespaceBeforeLineNumber(e)+1;return i<this._arr.length?i:-1}getFirstWhitespaceIndexAfterLineNumber(e){return this._checkPendingChanges(),e=e|0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let i;e>1?i=this._lineHeight*(e-1):i=0;const n=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e-(t?1:0));return i+n+this._paddingTop}getVerticalOffsetAfterLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;const i=this._lineHeight*e,n=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e+(t?1:0));return i+n+this._paddingTop}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let e=0;for(let t=0,i=this._arr.length;t<i;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){this._checkPendingChanges();const t=this.getLinesTotalHeight();return e>t}isInTopPadding(e){return this._paddingTop===0?!1:(this._checkPendingChanges(),e<this._paddingTop)}isInBottomPadding(e){if(this._paddingBottom===0)return!1;this._checkPendingChanges();const t=this.getLinesTotalHeight();return e>=t-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(this._checkPendingChanges(),e=e|0,e<0)return 1;const t=this._lineCount|0,i=this._lineHeight;let n=1,o=t;for(;n<o;){const r=(n+o)/2|0,a=this.getVerticalOffsetForLineNumber(r)|0;if(e>=a+i)n=r+1;else{if(e>=a)return r;o=r}}return n>t?t:n}getLinesViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;const i=this._lineHeight,n=this.getLineNumberAtOrAfterVerticalOffset(e)|0,o=this.getVerticalOffsetForLineNumber(n)|0;let r=this._lineCount|0,a=this.getFirstWhitespaceIndexAfterLineNumber(n)|0;const l=this.getWhitespacesCount()|0;let c,d;a===-1?(a=l,d=r+1,c=0):(d=this.getAfterLineNumberForWhitespaceIndex(a)|0,c=this.getHeightForWhitespaceIndex(a)|0);let h=o,u=h;const g=5e5;let f=0;o>=g&&(f=Math.floor(o/g)*g,f=Math.floor(f/i)*i,u-=f);const m=[],_=e+(t-e)/2;let b=-1;for(let w=n;w<=r;w++){if(b===-1){const x=h,L=h+i;(x<=_&&_<L||x>_)&&(b=w)}for(h+=i,m[w-n]=u,u+=i;d===w;)u+=c,h+=c,a++,a>=l?d=r+1:(d=this.getAfterLineNumberForWhitespaceIndex(a)|0,c=this.getHeightForWhitespaceIndex(a)|0);if(h>=t){r=w;break}}b===-1&&(b=r);const v=this.getVerticalOffsetForLineNumber(r)|0;let C=n,y=r;return C<y&&o<e&&C++,C<y&&v+i>t&&y--,{bigNumbersDelta:f,startLineNumber:n,endLineNumber:r,relativeVerticalOffset:m,centeredLineNumber:b,completelyVisibleStartLineNumber:C,completelyVisibleEndLineNumber:y,lineHeight:this._lineHeight}}getVerticalOffsetForWhitespaceIndex(e){this._checkPendingChanges(),e=e|0;const t=this.getAfterLineNumberForWhitespaceIndex(e);let i;t>=1?i=this._lineHeight*t:i=0;let n;return e>0?n=this.getWhitespacesAccumulatedHeight(e-1):n=0,i+n+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){this._checkPendingChanges(),e=e|0;let t=0,i=this.getWhitespacesCount()-1;if(i<0)return-1;const n=this.getVerticalOffsetForWhitespaceIndex(i),o=this.getHeightForWhitespaceIndex(i);if(e>=n+o)return-1;for(;t<i;){const r=Math.floor((t+i)/2),a=this.getVerticalOffsetForWhitespaceIndex(r),l=this.getHeightForWhitespaceIndex(r);if(e>=a+l)t=r+1;else{if(e>=a)return r;i=r}}return t}getWhitespaceAtVerticalOffset(e){this._checkPendingChanges(),e=e|0;const t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0||t>=this.getWhitespacesCount())return null;const i=this.getVerticalOffsetForWhitespaceIndex(t);if(i>e)return null;const n=this.getHeightForWhitespaceIndex(t),o=this.getIdForWhitespaceIndex(t),r=this.getAfterLineNumberForWhitespaceIndex(t);return{id:o,afterLineNumber:r,verticalOffset:i,height:n}}getWhitespaceViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;const i=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),n=this.getWhitespacesCount()-1;if(i<0)return[];const o=[];for(let r=i;r<=n;r++){const a=this.getVerticalOffsetForWhitespaceIndex(r),l=this.getHeightForWhitespaceIndex(r);if(a>=t)break;o.push({id:this.getIdForWhitespaceIndex(r),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(r),verticalOffset:a,height:l})}return o}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].height}};const hve=125;class N_{constructor(e,t,i,n){e=e|0,t=t|0,i=i|0,n=n|0,e<0&&(e=0),t<0&&(t=0),i<0&&(i=0),n<0&&(n=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=i,this.contentHeight=n,this.scrollHeight=Math.max(i,n)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}}class uve extends B{constructor(e,t){super(),this._onDidContentSizeChange=this._register(new O),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._dimensions=new N_(0,0,0,0),this._scrollable=this._register(new Sm({forceIntegerValues:!0,smoothScrollDuration:e,scheduleAtNextAnimationFrame:t})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;const t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);const i=t.contentWidth!==e.contentWidth,n=t.contentHeight!==e.contentHeight;(i||n)&&this._onDidContentSizeChange.fire(new oF(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}}class gve extends B{constructor(e,t,i){super(),this._configuration=e;const n=this._configuration.options,o=n.get(146),r=n.get(84);this._linesLayout=new dve(t,n.get(67),r.top,r.bottom),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new uve(0,i)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new N_(o.contentWidth,0,o.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(115)?hve:0)}onConfigurationChanged(e){const t=this._configuration.options;if(e.hasChanged(67)&&this._linesLayout.setLineHeight(t.get(67)),e.hasChanged(84)){const i=t.get(84);this._linesLayout.setPadding(i.top,i.bottom)}if(e.hasChanged(146)){const i=t.get(146),n=i.contentWidth,o=i.height,r=this._scrollable.getScrollDimensions(),a=r.contentWidth;this._scrollable.setScrollDimensions(new N_(n,r.contentWidth,o,this._getContentHeight(n,o,a)))}else this._updateHeight();e.hasChanged(115)&&this._configureSmoothScrollDuration()}onFlushed(e){this._linesLayout.onFlushed(e)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){const n=this._configuration.options.get(104);return n.horizontal===2||e>=t?0:n.horizontalScrollbarSize}_getContentHeight(e,t,i){const n=this._configuration.options;let o=this._linesLayout.getLinesTotalHeight();return n.get(106)?o+=Math.max(0,t-n.get(67)-n.get(84).bottom):n.get(104).ignoreHorizontalScrollbarInContentHeight||(o+=this._getHorizontalScrollbarHeight(e,i)),o}_updateHeight(){const e=this._scrollable.getScrollDimensions(),t=e.width,i=e.height,n=e.contentWidth;this._scrollable.setScrollDimensions(new N_(t,e.contentWidth,i,this._getContentHeight(t,i,n)))}getCurrentViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new qW(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new qW(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(){const e=this._configuration.options,t=this._maxLineWidth,i=e.get(147),n=e.get(50),o=e.get(146);if(i.isViewportWrapping){const r=e.get(73);return t>o.contentWidth+n.typicalHalfwidthCharacterWidth&&r.enabled&&r.side==="right"?t+o.verticalScrollbarWidth:t}else{const r=e.get(105)*n.typicalHalfwidthCharacterWidth,a=this._linesLayout.getWhitespaceMinWidth();return Math.max(t+r+o.verticalScrollbarWidth,a,this._overlayWidgetsMinWidth)}}setMaxLineWidth(e){this._maxLineWidth=e,this._updateContentWidth()}setOverlayWidgetsMinWidth(e){this._overlayWidgetsMinWidth=e,this._updateContentWidth()}_updateContentWidth(){const e=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new N_(e.width,this._computeContentWidth(),e.height,e.contentHeight)),this._updateHeight()}saveState(){const e=this._scrollable.getFutureScrollPosition(),t=e.scrollTop,i=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t),n=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(i);return{scrollTop:t,scrollTopWithoutViewZones:t-n,scrollLeft:e.scrollLeft}}changeWhitespace(e){const t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(e,t)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){const t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){t===1?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(e,t){const i=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:i.scrollLeft+e,scrollTop:i.scrollTop+t})}}class fve{constructor(e,t,i,n,o){this.editorId=e,this.model=t,this.configuration=i,this._linesCollection=n,this._coordinatesConverter=o,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){const t=e.id;let i=this._decorationsCache[t];if(!i){const n=e.range,o=e.options;let r;if(o.isWholeLine){const a=this._coordinatesConverter.convertModelPositionToViewPosition(new P(n.startLineNumber,1),0,!1,!0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new P(n.endLineNumber,this.model.getLineMaxColumn(n.endLineNumber)),1);r=new k(a.lineNumber,a.column,l.lineNumber,l.column)}else r=this._coordinatesConverter.convertModelRangeToViewRange(n,1);i=new O$(r,o),this._decorationsCache[t]=i}return i}getMinimapDecorationsInRange(e){return this._getDecorationsInRange(e,!0,!1).decorations}getDecorationsViewportData(e){let t=this._cachedModelDecorationsResolver!==null;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(e,!1,!1),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}getInlineDecorationsOnLine(e,t=!1,i=!1){const n=new k(e,this._linesCollection.getViewLineMinColumn(e),e,this._linesCollection.getViewLineMaxColumn(e));return this._getDecorationsInRange(n,t,i).inlineDecorations[0]}_getDecorationsInRange(e,t,i){const n=this._linesCollection.getDecorationsInRange(e,this.editorId,D1(this.configuration.options),t,i),o=e.startLineNumber,r=e.endLineNumber,a=[];let l=0;const c=[];for(let d=o;d<=r;d++)c[d-o]=[];for(let d=0,h=n.length;d<h;d++){const u=n[d],g=u.options;if(!lF(this.model,u))continue;const f=this._getOrCreateViewModelDecoration(u),m=f.range;if(a[l++]=f,g.inlineClassName){const _=new db(m,g.inlineClassName,g.inlineClassNameAffectsLetterSpacing?3:0),b=Math.max(o,m.startLineNumber),v=Math.min(r,m.endLineNumber);for(let C=b;C<=v;C++)c[C-o].push(_)}if(g.beforeContentClassName&&o<=m.startLineNumber&&m.startLineNumber<=r){const _=new db(new k(m.startLineNumber,m.startColumn,m.startLineNumber,m.startColumn),g.beforeContentClassName,1);c[m.startLineNumber-o].push(_)}if(g.afterContentClassName&&o<=m.endLineNumber&&m.endLineNumber<=r){const _=new db(new k(m.endLineNumber,m.endColumn,m.endLineNumber,m.endColumn),g.afterContentClassName,2);c[m.endLineNumber-o].push(_)}}return{decorations:a,inlineDecorations:c}}}function lF(s,e){return!(e.options.hideInCommentTokens&&cF(s,e)||e.options.hideInStringTokens&&dF(s,e))}function cF(s,e){return oj(s,e.range,t=>t===1)}function dF(s,e){return oj(s,e.range,t=>t===2)}function oj(s,e,t){for(let i=e.startLineNumber;i<=e.endLineNumber;i++){const n=s.tokenization.getLineTokens(i),o=i===e.startLineNumber,r=i===e.endLineNumber;let a=o?n.findTokenIndexAtOffset(e.startColumn-1):0;for(;a<n.getCount()&&!(r&&n.getStartOffset(a)>e.endColumn-1);){if(!t(n.getStandardTokenType(a)))return!1;a++}}return!0}function QD(s,e){return s===null?e?Ax.INSTANCE:Px.INSTANCE:new pve(s,e)}class pve{constructor(e,t){this._projectionData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(e,t,i){this._assertVisible();const n=i>0?this._projectionData.breakOffsets[i-1]:0,o=this._projectionData.breakOffsets[i];let r;if(this._projectionData.injectionOffsets!==null){const a=this._projectionData.injectionOffsets.map((c,d)=>new Ha(0,0,c+1,this._projectionData.injectionOptions[d],0));r=Ha.applyInjectedText(e.getLineContent(t),a).substring(n,o)}else r=e.getValueInRange({startLineNumber:t,startColumn:n+1,endLineNumber:t,endColumn:o+1});return i>0&&(r=L9(this._projectionData.wrappedTextIndentLength)+r),r}getViewLineLength(e,t,i){return this._assertVisible(),this._projectionData.getLineLength(i)}getViewLineMinColumn(e,t,i){return this._assertVisible(),this._projectionData.getMinOutputOffset(i)+1}getViewLineMaxColumn(e,t,i){return this._assertVisible(),this._projectionData.getMaxOutputOffset(i)+1}getViewLineData(e,t,i){const n=new Array;return this.getViewLinesData(e,t,i,1,0,[!0],n),n[0]}getViewLinesData(e,t,i,n,o,r,a){this._assertVisible();const l=this._projectionData,c=l.injectionOffsets,d=l.injectionOptions;let h=null;if(c){h=[];let g=0,f=0;for(let m=0;m<l.getOutputLineCount();m++){const _=new Array;h[m]=_;const b=m>0?l.breakOffsets[m-1]:0,v=l.breakOffsets[m];for(;f<c.length;){const C=d[f].content.length,y=c[f]+g,w=y+C;if(y>v)break;if(b<w){const x=d[f];if(x.inlineClassName){const L=m>0?l.wrappedTextIndentLength:0,D=L+Math.max(y-b,0),T=L+Math.min(w-b,v-b);D!==T&&_.push(new ame(D,T,x.inlineClassName,x.inlineClassNameAffectsLetterSpacing))}}if(w<=v)g+=C,f++;else break}}}let u;c?u=e.tokenization.getLineTokens(t).withInserted(c.map((g,f)=>({offset:g,text:d[f].content,tokenMetadata:Pi.defaultTokenMetadata}))):u=e.tokenization.getLineTokens(t);for(let g=i;g<i+n;g++){const f=o+g-i;if(!r[f]){a[f]=null;continue}a[f]=this._getViewLineData(u,h?h[g]:null,g)}}_getViewLineData(e,t,i){this._assertVisible();const n=this._projectionData,o=i>0?n.wrappedTextIndentLength:0,r=i>0?n.breakOffsets[i-1]:0,a=n.breakOffsets[i],l=e.sliceAndInflate(r,a,o);let c=l.getLineContent();i>0&&(c=L9(n.wrappedTextIndentLength)+c);const d=this._projectionData.getMinOutputOffset(i)+1,h=c.length+1,u=i+1<this.getViewLineCount(),g=i===0?0:n.breakOffsetsVisibleColumn[i-1];return new HO(c,u,d,h,g,l,t)}getModelColumnOfViewPosition(e,t){return this._assertVisible(),this._projectionData.translateToInputOffset(e,t-1)+1}getViewPositionOfModelPosition(e,t,i=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(t-1,i).toPosition(e)}getViewLineNumberOfModelPosition(e,t){this._assertVisible();const i=this._projectionData.translateToOutputPosition(t-1);return e+i.outputLineIndex}normalizePosition(e,t,i){const n=t.lineNumber-e;return this._projectionData.normalizeOutputPosition(e,t.column-1,i).toPosition(n)}getInjectedTextAt(e,t){return this._projectionData.getInjectedText(e,t-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}}class Ax{static{this.INSTANCE=new Ax}constructor(){}isVisible(){return!0}setVisible(e){return e?this:Px.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,i){return e.getLineContent(t)}getViewLineLength(e,t,i){return e.getLineLength(t)}getViewLineMinColumn(e,t,i){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,i){return e.getLineMaxColumn(t)}getViewLineData(e,t,i){const n=e.tokenization.getLineTokens(t),o=n.getLineContent();return new HO(o,!1,1,o.length+1,0,n.inflate(),null)}getViewLinesData(e,t,i,n,o,r,a){if(!r[o]){a[o]=null;return}a[o]=this.getViewLineData(e,t,0)}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new P(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,i){return t}getInjectedTextAt(e,t){return null}}class Px{static{this.INSTANCE=new Px}constructor(){}isVisible(){return!1}setVisible(e){return e?Ax.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,i){throw new Error("Not supported")}getViewLineLength(e,t,i){throw new Error("Not supported")}getViewLineMinColumn(e,t,i){throw new Error("Not supported")}getViewLineMaxColumn(e,t,i){throw new Error("Not supported")}getViewLineData(e,t,i){throw new Error("Not supported")}getViewLinesData(e,t,i,n,o,r,a){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,i){throw new Error("Not supported")}getInjectedTextAt(e,t){throw new Error("Not supported")}}const JD=[""];function L9(s){if(s>=JD.length)for(let e=1;e<=s;e++)JD[e]=mve(e);return JD[s]}function mve(s){return new Array(s+1).join(" ")}class _ve{constructor(e,t,i,n,o,r,a,l,c,d){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=i,this._monospaceLineBreaksComputerFactory=n,this.fontInfo=o,this.tabSize=r,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=c,this.wordBreak=d,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new vve(this)}_constructLines(e,t){this.modelLineProjections=[],e&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));const i=this.model.getLinesContent(),n=this.model.getInjectedTextDecorations(this._editorId),o=i.length,r=this.createLineBreaksComputer(),a=new Oc(Ha.fromDecorations(n));for(let m=0;m<o;m++){const _=a.takeWhile(b=>b.lineNumber===m+1);r.addRequest(i[m],_,t?t[m]:null)}const l=r.finalize(),c=[],d=this.hiddenAreasDecorationIds.map(m=>this.model.getDecorationRange(m)).sort(k.compareRangesUsingStarts);let h=1,u=0,g=-1,f=g+1<d.length?u+1:o+2;for(let m=0;m<o;m++){const _=m+1;_===f&&(g++,h=d[g].startLineNumber,u=d[g].endLineNumber,f=g+1<d.length?u+1:o+2);const b=_>=h&&_<=u,v=QD(l[m],!b);c[m]=v.getViewLineCount(),this.modelLineProjections[m]=v}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new Tse(c)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(e=>this.model.getDecorationRange(e))}setHiddenAreas(e){const t=e.map(u=>this.model.validateRange(u)),i=bve(t),n=this.hiddenAreasDecorationIds.map(u=>this.model.getDecorationRange(u)).sort(k.compareRangesUsingStarts);if(i.length===n.length){let u=!1;for(let g=0;g<i.length;g++)if(!i[g].equalsRange(n[g])){u=!0;break}if(!u)return!1}const o=i.map(u=>({range:u,options:We.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,o);const r=i;let a=1,l=0,c=-1,d=c+1<r.length?l+1:this.modelLineProjections.length+2,h=!1;for(let u=0;u<this.modelLineProjections.length;u++){const g=u+1;g===d&&(c++,a=r[c].startLineNumber,l=r[c].endLineNumber,d=c+1<r.length?l+1:this.modelLineProjections.length+2);let f=!1;if(g>=a&&g<=l?this.modelLineProjections[u].isVisible()&&(this.modelLineProjections[u]=this.modelLineProjections[u].setVisible(!1),f=!0):(h=!0,this.modelLineProjections[u].isVisible()||(this.modelLineProjections[u]=this.modelLineProjections[u].setVisible(!0),f=!0)),f){const m=this.modelLineProjections[u].getViewLineCount();this.projectedModelLineLineCounts.setValue(u,m)}}return h||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return e<1||e>this.modelLineProjections.length?!1:this.modelLineProjections[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.modelLineProjections.length?1:this.modelLineProjections[e-1].getViewLineCount()}setTabSize(e){return this.tabSize===e?!1:(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,i,n,o){const r=this.fontInfo.equals(e),a=this.wrappingStrategy===t,l=this.wrappingColumn===i,c=this.wrappingIndent===n,d=this.wordBreak===o;if(r&&a&&l&&c&&d)return!1;const h=r&&a&&!l&&c&&d;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=i,this.wrappingIndent=n,this.wordBreak=o;let u=null;if(h){u=[];for(let g=0,f=this.modelLineProjections.length;g<f;g++)u[g]=this.modelLineProjections[g].getProjectionData()}return this._constructLines(!1,u),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,i){if(!e||e<=this._validModelVersionId)return null;const n=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,o=this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections.splice(t-1,i-t+1),this.projectedModelLineLineCounts.removeValues(t-1,i-t+1),new IR(n,o)}onModelLinesInserted(e,t,i,n){if(!e||e<=this._validModelVersionId)return null;const o=t>2&&!this.modelLineProjections[t-2].isVisible(),r=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1;let a=0;const l=[],c=[];for(let d=0,h=n.length;d<h;d++){const u=QD(n[d],!o);l.push(u);const g=u.getViewLineCount();a+=g,c[d]=g}return this.modelLineProjections=this.modelLineProjections.slice(0,t-1).concat(l).concat(this.modelLineProjections.slice(t-1)),this.projectedModelLineLineCounts.insertValues(t-1,c),new TR(r,r+a-1)}onModelLineChanged(e,t,i){if(e!==null&&e<=this._validModelVersionId)return[!1,null,null,null];const n=t-1,o=this.modelLineProjections[n].getViewLineCount(),r=this.modelLineProjections[n].isVisible(),a=QD(i,r);this.modelLineProjections[n]=a;const l=this.modelLineProjections[n].getViewLineCount();let c=!1,d=0,h=-1,u=0,g=-1,f=0,m=-1;o>l?(d=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,h=d+l-1,f=h+1,m=f+(o-l)-1,c=!0):o<l?(d=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,h=d+o-1,u=h+1,g=u+(l-o)-1,c=!0):(d=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,h=d+l-1),this.projectedModelLineLineCounts.setValue(n,l);const _=d<=h?new sj(d,h-d+1):null,b=u<=g?new TR(u,g):null,v=f<=m?new IR(f,m):null;return[c,_,b,v]}acceptVersionId(e){this._validModelVersionId=e,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(e){if(e<1)return 1;const t=this.getViewLineCount();return e>t?t:e|0}getActiveIndentGuide(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),i=this._toValidViewLineNumber(i);const n=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),o=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),r=this.convertViewPositionToModelPosition(i,this.getViewLineMinColumn(i)),a=this.model.guides.getActiveIndentGuide(n.lineNumber,o.lineNumber,r.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),c=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:c.lineNumber,indent:a.indent}}getViewLineInfo(e){e=this._toValidViewLineNumber(e);const t=this.projectedModelLineLineCounts.getIndexOf(e-1),i=t.index,n=t.remainder;return new x9(i+1,n)}getMinColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(e){const t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),n=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new P(e.modelLineNumber,n)}getModelEndPositionOfViewLine(e){const t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),n=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new P(e.modelLineNumber,n)}getViewLineInfosGroupedByModelRanges(e,t){const i=this.getViewLineInfo(e),n=this.getViewLineInfo(t),o=new Array;let r=this.getModelStartPositionOfViewLine(i),a=new Array;for(let l=i.modelLineNumber;l<=n.modelLineNumber;l++){const c=this.modelLineProjections[l-1];if(c.isVisible()){const d=l===i.modelLineNumber?i.modelLineWrappedLineIdx:0,h=l===n.modelLineNumber?n.modelLineWrappedLineIdx+1:c.getViewLineCount();for(let u=d;u<h;u++)a.push(new x9(l,u))}if(!c.isVisible()&&r){const d=new P(l-1,this.model.getLineMaxColumn(l-1)+1),h=k.fromPositions(r,d);o.push(new k9(h,a)),a=[],r=null}else c.isVisible()&&!r&&(r=new P(l,1))}if(r){const l=k.fromPositions(r,this.getModelEndPositionOfViewLine(n));o.push(new k9(l,a))}return o}getViewLinesBracketGuides(e,t,i,n){const o=i?this.convertViewPositionToModelPosition(i.lineNumber,i.column):null,r=[];for(const a of this.getViewLineInfosGroupedByModelRanges(e,t)){const l=a.modelRange.startLineNumber,c=this.model.guides.getLinesBracketGuides(l,a.modelRange.endLineNumber,o,n);for(const d of a.viewLines){const u=c[d.modelLineNumber-l].map(g=>{if(g.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,g.forWrappedLinesAfterColumn).lineNumber>=d.modelLineWrappedLineIdx||g.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,g.forWrappedLinesBeforeOrAtColumn).lineNumber<d.modelLineWrappedLineIdx)return;if(!g.horizontalLine)return g;let f=-1;if(g.column!==-1){const b=this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,g.column);if(b.lineNumber===d.modelLineWrappedLineIdx)f=b.column;else if(b.lineNumber<d.modelLineWrappedLineIdx)f=this.getMinColumnOfViewLine(d);else if(b.lineNumber>d.modelLineWrappedLineIdx)return}const m=this.convertModelPositionToViewPosition(d.modelLineNumber,g.horizontalLine.endColumn),_=this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,g.horizontalLine.endColumn);return _.lineNumber===d.modelLineWrappedLineIdx?new Cu(g.visibleColumn,f,g.className,new ib(g.horizontalLine.top,m.column),-1,-1):_.lineNumber<d.modelLineWrappedLineIdx||g.visibleColumn!==-1?void 0:new Cu(g.visibleColumn,f,g.className,new ib(g.horizontalLine.top,this.getMaxColumnOfViewLine(d)),-1,-1)});r.push(u.filter(g=>!!g))}}return r}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),n=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t));let o=[];const r=[],a=[],l=i.lineNumber-1,c=n.lineNumber-1;let d=null;for(let f=l;f<=c;f++){const m=this.modelLineProjections[f];if(m.isVisible()){const _=m.getViewLineNumberOfModelPosition(0,f===l?i.column:1),b=m.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(f+1)),v=b-_+1;let C=0;v>1&&m.getViewLineMinColumn(this.model,f+1,b)===1&&(C=_===0?1:2),r.push(v),a.push(C),d===null&&(d=new P(f+1,0))}else d!==null&&(o=o.concat(this.model.guides.getLinesIndentGuides(d.lineNumber,f)),d=null)}d!==null&&(o=o.concat(this.model.guides.getLinesIndentGuides(d.lineNumber,n.lineNumber)),d=null);const h=t-e+1,u=new Array(h);let g=0;for(let f=0,m=o.length;f<m;f++){let _=o[f];const b=Math.min(h-g,r[f]),v=a[f];let C;v===2?C=0:v===1?C=1:C=b;for(let y=0;y<b;y++)y===C&&(_=0),u[g++]=_}return u}getViewLineContent(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineContent(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineLength(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineLength(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMinColumn(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMaxColumn(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineData(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineData(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLinesData(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const n=this.projectedModelLineLineCounts.getIndexOf(e-1);let o=e;const r=n.index,a=n.remainder,l=[];for(let c=r,d=this.model.getLineCount();c<d;c++){const h=this.modelLineProjections[c];if(!h.isVisible())continue;const u=c===r?a:0;let g=h.getViewLineCount()-u,f=!1;if(o+g>t&&(f=!0,g=t-o+1),h.getViewLinesData(this.model,c+1,u,g,o-e,i,l),o+=g,f)break}return l}validateViewPosition(e,t,i){e=this._toValidViewLineNumber(e);const n=this.projectedModelLineLineCounts.getIndexOf(e-1),o=n.index,r=n.remainder,a=this.modelLineProjections[o],l=a.getViewLineMinColumn(this.model,o+1,r),c=a.getViewLineMaxColumn(this.model,o+1,r);t<l&&(t=l),t>c&&(t=c);const d=a.getModelColumnOfViewPosition(r,t);return this.model.validatePosition(new P(o+1,d)).equals(i)?new P(e,t):this.convertModelPositionToViewPosition(i.lineNumber,i.column)}validateViewRange(e,t){const i=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),n=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new k(i.lineNumber,i.column,n.lineNumber,n.column)}convertViewPositionToModelPosition(e,t){const i=this.getViewLineInfo(e),n=this.modelLineProjections[i.modelLineNumber-1].getModelColumnOfViewPosition(i.modelLineWrappedLineIdx,t);return this.model.validatePosition(new P(i.modelLineNumber,n))}convertViewRangeToModelRange(e){const t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),i=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new k(t.lineNumber,t.column,i.lineNumber,i.column)}convertModelPositionToViewPosition(e,t,i=2,n=!1,o=!1){const r=this.model.validatePosition(new P(e,t)),a=r.lineNumber,l=r.column;let c=a-1,d=!1;if(o)for(;c<this.modelLineProjections.length&&!this.modelLineProjections[c].isVisible();)c++,d=!0;else for(;c>0&&!this.modelLineProjections[c].isVisible();)c--,d=!0;if(c===0&&!this.modelLineProjections[c].isVisible())return new P(n?0:1,1);const h=1+this.projectedModelLineLineCounts.getPrefixSum(c);let u;return d?o?u=this.modelLineProjections[c].getViewPositionOfModelPosition(h,1,i):u=this.modelLineProjections[c].getViewPositionOfModelPosition(h,this.model.getLineMaxColumn(c+1),i):u=this.modelLineProjections[a-1].getViewPositionOfModelPosition(h,l,i),u}convertModelRangeToViewRange(e,t=0){if(e.isEmpty()){const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,t);return k.fromPositions(i)}else{const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,1),n=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn,0);return new k(i.lineNumber,i.column,n.lineNumber,n.column)}}getViewLineNumberOfModelPosition(e,t){let i=e-1;if(this.modelLineProjections[i].isVisible()){const o=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(o,t)}for(;i>0&&!this.modelLineProjections[i].isVisible();)i--;if(i===0&&!this.modelLineProjections[i].isVisible())return 1;const n=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(n,this.model.getLineMaxColumn(i+1))}getDecorationsInRange(e,t,i,n,o){const r=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),a=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(a.lineNumber-r.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new k(r.lineNumber,1,a.lineNumber,a.column),t,i,n,o);let l=[];const c=r.lineNumber-1,d=a.lineNumber-1;let h=null;for(let m=c;m<=d;m++)if(this.modelLineProjections[m].isVisible())h===null&&(h=new P(m+1,m===c?r.column:1));else if(h!==null){const b=this.model.getLineMaxColumn(m);l=l.concat(this.model.getDecorationsInRange(new k(h.lineNumber,h.column,m,b),t,i,n)),h=null}h!==null&&(l=l.concat(this.model.getDecorationsInRange(new k(h.lineNumber,h.column,a.lineNumber,a.column),t,i,n)),h=null),l.sort((m,_)=>{const b=k.compareRangesUsingStarts(m.range,_.range);return b===0?m.id<_.id?-1:m.id>_.id?1:0:b});const u=[];let g=0,f=null;for(const m of l){const _=m.id;f!==_&&(f=_,u[g++]=m)}return u}getInjectedTextAt(e){const t=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[t.modelLineNumber-1].getInjectedTextAt(t.modelLineWrappedLineIdx,e.column)}normalizePosition(e,t){const i=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[i.modelLineNumber-1].normalizePosition(i.modelLineWrappedLineIdx,e,t)}getLineIndentColumn(e){const t=this.getViewLineInfo(e);return t.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(t.modelLineNumber):0}}function bve(s){if(s.length===0)return[];const e=s.slice();e.sort(k.compareRangesUsingStarts);const t=[];let i=e[0].startLineNumber,n=e[0].endLineNumber;for(let o=1,r=e.length;o<r;o++){const a=e[o];a.startLineNumber>n+1?(t.push(new k(i,1,n,1)),i=a.startLineNumber,n=a.endLineNumber):a.endLineNumber>n&&(n=a.endLineNumber)}return t.push(new k(i,1,n,1)),t}class x9{constructor(e,t){this.modelLineNumber=e,this.modelLineWrappedLineIdx=t}}class k9{constructor(e,t){this.modelRange=e,this.viewLines=t}}class vve{constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e,t,i,n){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column,t,i,n)}convertModelRangeToViewRange(e,t){return this._lines.convertModelRangeToViewRange(e,t)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}getViewLineNumberOfModelPosition(e,t){return this._lines.getViewLineNumberOfModelPosition(e,t)}}class Cve{constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new yve(this)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,i,n){return!1}createLineBreaksComputer(){const e=[];return{addRequest:(t,i,n)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,i){return new IR(t,i)}onModelLinesInserted(e,t,i,n){return new TR(t,i)}onModelLineChanged(e,t,i){return[!1,new sj(t,1),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,i){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesBracketGuides(e,t,i){return new Array(t-e+1).fill([])}getViewLinesIndentGuides(e,t){const i=t-e+1,n=new Array(i);for(let o=0;o<i;o++)n[o]=0;return n}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){const t=this.model.tokenization.getLineTokens(e),i=t.getLineContent();return new HO(i,!1,1,i.length+1,0,t.inflate(),null)}getViewLinesData(e,t,i){const n=this.model.getLineCount();e=Math.min(Math.max(1,e),n),t=Math.min(Math.max(1,t),n);const o=[];for(let r=e;r<=t;r++){const a=r-e;o[a]=i[a]?this.getViewLineData(r):null}return o}getDecorationsInRange(e,t,i,n,o){return this.model.getDecorationsInRange(e,t,i,n,o)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}getInjectedTextAt(e){return null}}class yve{constructor(e){this._lines=e}_validPosition(e){return this._lines.model.validatePosition(e)}_validRange(e){return this._lines.model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){const t=this._lines.model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}getModelLineViewLineCount(e){return 1}getViewLineNumberOfModelPosition(e,t){return e}}const Hh=Jr.Right;class wve{constructor(e){this.persist=0,this._requiredLanes=1,this.lanes=new Uint8Array(Math.ceil((e+1)*Hh/8))}reset(e){const t=Math.ceil((e+1)*Hh/8);this.lanes.length<t?this.lanes=new Uint8Array(t):this.lanes.fill(0),this._requiredLanes=1}get requiredLanes(){return this._requiredLanes}push(e,t,i){i&&(this.persist|=1<<e-1);for(let n=t.startLineNumber;n<=t.endLineNumber;n++){const o=Hh*n+(e-1);this.lanes[o>>>3]|=1<<o%8,this._requiredLanes=Math.max(this._requiredLanes,this.countAtLine(n))}}getLanesAtLine(e){const t=[];let i=Hh*e;for(let n=0;n<Hh;n++)(this.persist&1<<n||this.lanes[i>>>3]&1<<i%8)&&t.push(n+1),i++;return t.length?t:[Jr.Center]}countAtLine(e){let t=Hh*e,i=0;for(let n=0;n<Hh;n++)(this.persist&1<<n||this.lanes[t>>>3]&1<<t%8)&&i++,t++;return i}}let Sve=class extends B{constructor(e,t,i,n,o,r,a,l,c,d){if(super(),this.languageConfigurationService=a,this._themeService=l,this._attachedView=c,this._transactionalTarget=d,this.hiddenAreasModel=new xve,this.previousHiddenAreas=[],this._editorId=e,this._configuration=t,this.model=i,this._eventDispatcher=new qbe,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new Kg(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new It(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=hF.create(this.model),this.glyphLanes=new wve(0),this.model.isTooLargeForTokenization())this._lines=new Cve(this.model);else{const h=this._configuration.options,u=h.get(50),g=h.get(140),f=h.get(147),m=h.get(139),_=h.get(130);this._lines=new _ve(this._editorId,this.model,n,o,u,this.model.getOptions().tabSize,g,f.wrappingColumn,m,_)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new ove(i,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new gve(this._configuration,this.getLineCount(),r)),this._register(this.viewLayout.onDidScroll(h=>{h.scrollTopChanged&&this._handleVisibleLinesChanged(),h.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new Ube(h)),this._eventDispatcher.emitOutgoingEvent(new aF(h.oldScrollWidth,h.oldScrollLeft,h.oldScrollHeight,h.oldScrollTop,h.scrollWidth,h.scrollLeft,h.scrollHeight,h.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(h=>{this._eventDispatcher.emitOutgoingEvent(h)})),this._decorations=new fve(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(h=>{try{const u=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(u,h)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(Rx.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new Zbe)})),this._register(this._themeService.onDidColorThemeChange(h=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new $be(h))})),this._updateConfigurationViewLineCountNow()}dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(e){this._eventDispatcher.addViewEventHandler(e)}removeViewEventHandler(e){this._eventDispatcher.removeViewEventHandler(e)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){const e=this.viewLayout.getLinesViewportData(),t=new k(e.startLineNumber,this.getLineMinColumn(e.startLineNumber),e.endLineNumber,this.getLineMaxColumn(e.endLineNumber));return this._toModelVisibleRanges(t)}visibleLinesStabilized(){const e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!0)}_handleVisibleLinesChanged(){const e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!1)}setHasFocus(e){this._hasFocus=e,this._cursor.setHasFocus(e),this._eventDispatcher.emitSingleViewEvent(new Vbe(e)),this._eventDispatcher.emitOutgoingEvent(new rF(!e,e))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new Fbe)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new Bbe)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){const e=new P(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),t=this.coordinatesConverter.convertViewPositionToModelPosition(e);return new I9(t,this._viewportStart.startLineDelta)}return new I9(null,0)}_onConfigurationChanged(e,t){const i=this._captureStableViewport(),n=this._configuration.options,o=n.get(50),r=n.get(140),a=n.get(147),l=n.get(139),c=n.get(130);this._lines.setWrappingSettings(o,r,a.wrappingColumn,l,c)&&(e.emitViewEvent(new Qy),e.emitViewEvent(new Jy),e.emitViewEvent(new Wh(null)),this._cursor.onLineMappingChanged(e),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this._updateConfigurationViewLineCount.schedule()),t.hasChanged(92)&&(this._decorations.reset(),e.emitViewEvent(new Wh(null))),t.hasChanged(99)&&(this._decorations.reset(),e.emitViewEvent(new Wh(null))),e.emitViewEvent(new Wbe(t)),this.viewLayout.onConfigurationChanged(t),i.recoverViewportStart(this.coordinatesConverter,this.viewLayout),Kg.shouldRecreate(t)&&(this.cursorConfig=new Kg(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(e=>{try{const i=this._eventDispatcher.beginEmitViewEvents();let n=!1,o=!1;const r=e instanceof Nu?e.rawContentChangedEvent.changes:e.changes,a=e instanceof Nu?e.rawContentChangedEvent.versionId:null,l=this._lines.createLineBreaksComputer();for(const h of r)switch(h.changeType){case 4:{for(let u=0;u<h.detail.length;u++){const g=h.detail[u];let f=h.injectedTexts[u];f&&(f=f.filter(m=>!m.ownerId||m.ownerId===this._editorId)),l.addRequest(g,f,null)}break}case 2:{let u=null;h.injectedText&&(u=h.injectedText.filter(g=>!g.ownerId||g.ownerId===this._editorId)),l.addRequest(h.detail,u,null);break}}const c=l.finalize(),d=new Oc(c);for(const h of r)switch(h.changeType){case 1:{this._lines.onModelFlushed(),i.emitViewEvent(new Qy),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),n=!0;break}case 3:{const u=this._lines.onModelLinesDeleted(a,h.fromLineNumber,h.toLineNumber);u!==null&&(i.emitViewEvent(u),this.viewLayout.onLinesDeleted(u.fromLineNumber,u.toLineNumber)),n=!0;break}case 4:{const u=d.takeCount(h.detail.length),g=this._lines.onModelLinesInserted(a,h.fromLineNumber,h.toLineNumber,u);g!==null&&(i.emitViewEvent(g),this.viewLayout.onLinesInserted(g.fromLineNumber,g.toLineNumber)),n=!0;break}case 2:{const u=d.dequeue(),[g,f,m,_]=this._lines.onModelLineChanged(a,h.lineNumber,u);o=g,f&&i.emitViewEvent(f),m&&(i.emitViewEvent(m),this.viewLayout.onLinesInserted(m.fromLineNumber,m.toLineNumber)),_&&(i.emitViewEvent(_),this.viewLayout.onLinesDeleted(_.fromLineNumber,_.toLineNumber));break}case 5:break}a!==null&&this._lines.acceptVersionId(a),this.viewLayout.onHeightMaybeChanged(),!n&&o&&(i.emitViewEvent(new Jy),i.emitViewEvent(new Wh(null)),this._cursor.onLineMappingChanged(i),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}const t=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&t){const i=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(i){const n=this.coordinatesConverter.convertModelPositionToViewPosition(i.getStartPosition()),o=this.viewLayout.getVerticalOffsetForLineNumber(n.lineNumber);this.viewLayout.setScrollPosition({scrollTop:o+this._viewportStart.startLineDelta},1)}}try{const i=this._eventDispatcher.beginEmitViewEvents();e instanceof Nu&&i.emitOutgoingEvent(new ive(e.contentChangedEvent)),this._cursor.onModelContentChanged(i,e)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._register(this.model.onDidChangeTokens(e=>{const t=[];for(let i=0,n=e.ranges.length;i<n;i++){const o=e.ranges[i],r=this.coordinatesConverter.convertModelPositionToViewPosition(new P(o.fromLineNumber,1)).lineNumber,a=this.coordinatesConverter.convertModelPositionToViewPosition(new P(o.toLineNumber,this.model.getLineMaxColumn(o.toLineNumber))).lineNumber;t[i]={fromLineNumber:r,toLineNumber:a}}this._eventDispatcher.emitSingleViewEvent(new jbe(t)),this._eventDispatcher.emitOutgoingEvent(new sve(e))})),this._register(this.model.onDidChangeLanguageConfiguration(e=>{this._eventDispatcher.emitSingleViewEvent(new zbe),this.cursorConfig=new Kg(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new tve(e))})),this._register(this.model.onDidChangeLanguage(e=>{this.cursorConfig=new Kg(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new eve(e))})),this._register(this.model.onDidChangeOptions(e=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{const t=this._eventDispatcher.beginEmitViewEvents();t.emitViewEvent(new Qy),t.emitViewEvent(new Jy),t.emitViewEvent(new Wh(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new Kg(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new nve(e))})),this._register(this.model.onDidChangeDecorations(e=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new Wh(e)),this._eventDispatcher.emitOutgoingEvent(new Jbe(e))}))}setHiddenAreas(e,t){this.hiddenAreasModel.setHiddenAreas(t,e);const i=this.hiddenAreasModel.getMergedRanges();if(i===this.previousHiddenAreas)return;this.previousHiddenAreas=i;const n=this._captureStableViewport();let o=!1;try{const r=this._eventDispatcher.beginEmitViewEvents();o=this._lines.setHiddenAreas(i),o&&(r.emitViewEvent(new Qy),r.emitViewEvent(new Jy),r.emitViewEvent(new Wh(null)),this._cursor.onLineMappingChanged(r),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged());const a=n.viewportStartModelPosition?.lineNumber;a&&i.some(c=>c.startLineNumber<=a&&a<=c.endLineNumber)||n.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),o&&this._eventDispatcher.emitOutgoingEvent(new Xbe)}getVisibleRangesPlusViewportAboveBelow(){const e=this._configuration.options.get(146),t=this._configuration.options.get(67),i=Math.max(20,Math.round(e.height/t)),n=this.viewLayout.getLinesViewportData(),o=Math.max(1,n.completelyVisibleStartLineNumber-i),r=Math.min(this.getLineCount(),n.completelyVisibleEndLineNumber+i);return this._toModelVisibleRanges(new k(o,this.getLineMinColumn(o),r,this.getLineMaxColumn(r)))}getVisibleRanges(){const e=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(e)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(e){const t=this.coordinatesConverter.convertViewRangeToModelRange(e),i=this._lines.getHiddenAreas();if(i.length===0)return[t];const n=[];let o=0,r=t.startLineNumber,a=t.startColumn;const l=t.endLineNumber,c=t.endColumn;for(let d=0,h=i.length;d<h;d++){const u=i[d].startLineNumber,g=i[d].endLineNumber;g<r||u>l||(r<u&&(n[o++]=new k(r,a,u-1,this.model.getLineMaxColumn(u-1))),r=g+1,a=1)}return(r<l||r===l&&a<c)&&(n[o++]=new k(r,a,l,c)),n}getCompletelyVisibleViewRange(){const e=this.viewLayout.getLinesViewportData(),t=e.completelyVisibleStartLineNumber,i=e.completelyVisibleEndLineNumber;return new k(t,this.getLineMinColumn(t),i,this.getLineMaxColumn(i))}getCompletelyVisibleViewRangeAtScrollTop(e){const t=this.viewLayout.getLinesViewportDataAtScrollTop(e),i=t.completelyVisibleStartLineNumber,n=t.completelyVisibleEndLineNumber;return new k(i,this.getLineMinColumn(i),n,this.getLineMaxColumn(n))}saveState(){const e=this.viewLayout.saveState(),t=e.scrollTop,i=this.viewLayout.getLineNumberAtVerticalOffset(t),n=this.coordinatesConverter.convertViewPositionToModelPosition(new P(i,this.getLineMinColumn(i))),o=this.viewLayout.getVerticalOffsetForLineNumber(i)-t;return{scrollLeft:e.scrollLeft,firstPosition:n,firstPositionDeltaTop:o}}reduceRestoreState(e){if(typeof e.firstPosition>"u")return this._reduceRestoreStateCompatibility(e);const t=this.model.validatePosition(e.firstPosition),i=this.coordinatesConverter.convertModelPositionToViewPosition(t),n=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber)-e.firstPositionDeltaTop;return{scrollLeft:e.scrollLeft,scrollTop:n}}_reduceRestoreStateCompatibility(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(e,t,i){this._viewportStart.update(this,e)}getActiveIndentGuide(e,t,i){return this._lines.getActiveIndentGuide(e,t,i)}getLinesIndentGuides(e,t){return this._lines.getViewLinesIndentGuides(e,t)}getBracketGuidesInRangeByLine(e,t,i,n){return this._lines.getViewLinesBracketGuides(e,t,i,n)}getLineContent(e){return this._lines.getViewLineContent(e)}getLineLength(e){return this._lines.getViewLineLength(e)}getLineMinColumn(e){return this._lines.getViewLineMinColumn(e)}getLineMaxColumn(e){return this._lines.getViewLineMaxColumn(e)}getLineFirstNonWhitespaceColumn(e){const t=rs(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=Na(this.getLineContent(e));return t===-1?0:t+2}getMinimapDecorationsInRange(e){return this._decorations.getMinimapDecorationsInRange(e)}getDecorationsInViewport(e){return this._decorations.getDecorationsViewportData(e).decorations}getInjectedTextAt(e){return this._lines.getInjectedTextAt(e)}getViewportViewLineRenderingData(e,t){const n=this._decorations.getDecorationsViewportData(e).inlineDecorations[t-e.startLineNumber];return this._getViewLineRenderingData(t,n)}getViewLineRenderingData(e){const t=this._decorations.getInlineDecorationsOnLine(e);return this._getViewLineRenderingData(e,t)}_getViewLineRenderingData(e,t){const i=this.model.mightContainRTL(),n=this.model.mightContainNonBasicASCII(),o=this.getTabSize(),r=this._lines.getViewLineData(e);return r.inlineDecorations&&(t=[...t,...r.inlineDecorations.map(a=>a.toInlineDecoration(e))]),new Zo(r.minColumn,r.maxColumn,r.content,r.continuesWithWrappedLine,i,n,r.tokens,t,o,r.startVisibleColumn)}getViewLineData(e){return this._lines.getViewLineData(e)}getMinimapLinesRenderingData(e,t,i){const n=this._lines.getViewLinesData(e,t,i);return new rme(this.getTabSize(),n)}getAllOverviewRulerDecorations(e){const t=this.model.getOverviewRulerDecorations(this._editorId,D1(this._configuration.options)),i=new Lve;for(const n of t){const o=n.options,r=o.overviewRuler;if(!r)continue;const a=r.position;if(a===0)continue;const l=r.getColor(e.value),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(n.range.startLineNumber,n.range.startColumn),d=this.coordinatesConverter.getViewLineNumberOfModelPosition(n.range.endLineNumber,n.range.endColumn);i.accept(l,o.zIndex,c,d,a)}return i.asArray}_invalidateDecorationsColorCache(){const e=this.model.getOverviewRulerDecorations();for(const t of e)t.options.overviewRuler?.invalidateCachedColor(),t.options.minimap?.invalidateCachedColor()}getValueInRange(e,t){const i=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueInRange(i,t)}getValueLengthInRange(e,t){const i=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueLengthInRange(i,t)}modifyPosition(e,t){const i=this.coordinatesConverter.convertViewPositionToModelPosition(e),n=this.model.modifyPosition(i,t);return this.coordinatesConverter.convertModelPositionToViewPosition(n)}deduceModelPositionRelativeToViewPosition(e,t,i){const n=this.coordinatesConverter.convertViewPositionToModelPosition(e);this.model.getEOL().length===2&&(t<0?t-=i:t+=i);const r=this.model.getOffsetAt(n)+t;return this.model.getPositionAt(r)}getPlainTextToCopy(e,t,i){const n=i?`\r
`:this.model.getEOL();e=e.slice(0),e.sort(k.compareRangesUsingStarts);let o=!1,r=!1;for(const l of e)l.isEmpty()?o=!0:r=!0;if(!r){if(!t)return"";const l=e.map(d=>d.startLineNumber);let c="";for(let d=0;d<l.length;d++)d>0&&l[d-1]===l[d]||(c+=this.model.getLineContent(l[d])+n);return c}if(o&&t){const l=[];let c=0;for(const d of e){const h=d.startLineNumber;d.isEmpty()?h!==c&&l.push(this.model.getLineContent(h)):l.push(this.model.getValueInRange(d,i?2:0)),c=h}return l.length===1?l[0]:l}const a=[];for(const l of e)l.isEmpty()||a.push(this.model.getValueInRange(l,i?2:0));return a.length===1?a[0]:a}getRichTextToCopy(e,t){const i=this.model.getLanguageId();if(i===Cs||e.length!==1)return null;let n=e[0];if(n.isEmpty()){if(!t)return null;const d=n.startLineNumber;n=new k(d,this.model.getLineMinColumn(d),d,this.model.getLineMaxColumn(d))}const o=this._configuration.options.get(50),r=this._getColorMap(),l=/[:;\\\/<>]/.test(o.fontFamily)||o.fontFamily===vs.fontFamily;let c;return l?c=vs.fontFamily:(c=o.fontFamily,c=c.replace(/"/g,"'"),/[,']/.test(c)||/[+ ]/.test(c)&&(c=`'${c}'`),c=`${c}, ${vs.fontFamily}`),{mode:i,html:`<div style="color: ${r[1]};background-color: ${r[2]};font-family: ${c};font-weight: ${o.fontWeight};font-size: ${o.fontSize}px;line-height: ${o.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(n,r)+"</div>"}}_getHTMLToCopy(e,t){const i=e.startLineNumber,n=e.startColumn,o=e.endLineNumber,r=e.endColumn,a=this.getTabSize();let l="";for(let c=i;c<=o;c++){const d=this.model.tokenization.getLineTokens(c),h=d.getLineContent(),u=c===i?n-1:0,g=c===o?r-1:h.length;h===""?l+="<br>":l+=Ale(h,d.inflate(),t,u,g,a,An)}return l}_getColorMap(){const e=mi.getColorMap(),t=["#000000"];if(e)for(let i=1,n=e.length;i<n;i++)t[i]=G.Format.CSS.formatHex(e[i]);return t}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(e,t,i){return this._withViewEventsCollector(n=>this._cursor.setStates(n,e,t,i))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(e){this._cursor.setCursorColumnSelectData(e)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(e){this._cursor.setPrevEditOperationType(e)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(e,t,i=0){this._withViewEventsCollector(n=>this._cursor.setSelections(n,e,t,i))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(e){this._withViewEventsCollector(t=>this._cursor.restoreState(t,e))}_executeCursorEdit(e){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new Qbe);return}this._withViewEventsCollector(e)}executeEdits(e,t,i){this._executeCursorEdit(n=>this._cursor.executeEdits(n,e,t,i))}startComposition(){this._executeCursorEdit(e=>this._cursor.startComposition(e))}endComposition(e){this._executeCursorEdit(t=>this._cursor.endComposition(t,e))}type(e,t){this._executeCursorEdit(i=>this._cursor.type(i,e,t))}compositionType(e,t,i,n,o){this._executeCursorEdit(r=>this._cursor.compositionType(r,e,t,i,n,o))}paste(e,t,i,n){this._executeCursorEdit(o=>this._cursor.paste(o,e,t,i,n))}cut(e){this._executeCursorEdit(t=>this._cursor.cut(t,e))}executeCommand(e,t){this._executeCursorEdit(i=>this._cursor.executeCommand(i,e,t))}executeCommands(e,t){this._executeCursorEdit(i=>this._cursor.executeCommands(i,e,t))}revealAllCursors(e,t,i=!1){this._withViewEventsCollector(n=>this._cursor.revealAll(n,e,i,0,t,0))}revealPrimaryCursor(e,t,i=!1){this._withViewEventsCollector(n=>this._cursor.revealPrimary(n,e,i,0,t,0))}revealTopMostCursor(e){const t=this._cursor.getTopMostViewPosition(),i=new k(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector(n=>n.emitViewEvent(new _b(e,!1,i,null,0,!0,0)))}revealBottomMostCursor(e){const t=this._cursor.getBottomMostViewPosition(),i=new k(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector(n=>n.emitViewEvent(new _b(e,!1,i,null,0,!0,0)))}revealRange(e,t,i,n,o){this._withViewEventsCollector(r=>r.emitViewEvent(new _b(e,!1,i,null,n,t,o)))}changeWhitespace(e){this.viewLayout.changeWhitespace(e)&&(this._eventDispatcher.emitSingleViewEvent(new Kbe),this._eventDispatcher.emitOutgoingEvent(new Ybe))}_withViewEventsCollector(e){return this._transactionalTarget.batchChanges(()=>{try{const t=this._eventDispatcher.beginEmitViewEvents();return e(t)}finally{this._eventDispatcher.endEmitViewEvents()}})}batchEvents(e){this._withViewEventsCollector(()=>{e()})}normalizePosition(e,t){return this._lines.normalizePosition(e,t)}getLineIndentColumn(e){return this._lines.getLineIndentColumn(e)}};class hF{static create(e){const t=e._setTrackedRange(null,new k(1,1,1,1),1);return new hF(e,1,!1,t,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}constructor(e,t,i,n,o){this._model=e,this._viewLineNumber=t,this._isValid=i,this._modelTrackedRange=n,this._startLineDelta=o}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(e,t){const i=e.coordinatesConverter.convertViewPositionToModelPosition(new P(t,e.getLineMinColumn(t))),n=e.model._setTrackedRange(this._modelTrackedRange,new k(i.lineNumber,i.column,i.lineNumber,i.column),1),o=e.viewLayout.getVerticalOffsetForLineNumber(t),r=e.viewLayout.getCurrentScrollTop();this._viewLineNumber=t,this._isValid=!0,this._modelTrackedRange=n,this._startLineDelta=r-o}invalidate(){this._isValid=!1}}class Lve{constructor(){this._asMap=Object.create(null),this.asArray=[]}accept(e,t,i,n,o){const r=this._asMap[e];if(r){const a=r.data,l=a[a.length-3],c=a[a.length-1];if(l===o&&c+1>=i){n>c&&(a[a.length-1]=n);return}a.push(o,i,n)}else{const a=new kv(e,t,[o,i,n]);this._asMap[e]=a,this.asArray.push(a)}}}class xve{constructor(){this.hiddenAreas=new Map,this.shouldRecompute=!1,this.ranges=[]}setHiddenAreas(e,t){const i=this.hiddenAreas.get(e);i&&D9(i,t)||(this.hiddenAreas.set(e,t),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;const e=Array.from(this.hiddenAreas.values()).reduce((t,i)=>kve(t,i),[]);return D9(this.ranges,e)?this.ranges:(this.ranges=e,this.ranges)}}function kve(s,e){const t=[];let i=0,n=0;for(;i<s.length&&n<e.length;){const o=s[i],r=e[n];if(o.endLineNumber<r.startLineNumber-1)t.push(s[i++]);else if(r.endLineNumber<o.startLineNumber-1)t.push(e[n++]);else{const a=Math.min(o.startLineNumber,r.startLineNumber),l=Math.max(o.endLineNumber,r.endLineNumber);t.push(new k(a,1,l,1)),i++,n++}}for(;i<s.length;)t.push(s[i++]);for(;n<e.length;)t.push(e[n++]);return t}function D9(s,e){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(!s[t].equalsRange(e[t]))return!1;return!0}class I9{constructor(e,t){this.viewportStartModelPosition=e,this.startLineDelta=t}recoverViewportStart(e,t){if(!this.viewportStartModelPosition)return;const i=e.convertModelPositionToViewPosition(this.viewportStartModelPosition),n=t.getVerticalOffsetForLineNumber(i.lineNumber);t.setScrollPosition({scrollTop:n+this.startLineDelta},1)}}var Dve=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Yl=function(s,e){return function(t,i){e(t,i,s)}},Xh;let Pv=class extends B{static{Xh=this}static{this.dropIntoEditorDecorationOptions=We.register({description:"workbench-dnd-target",className:"dnd-target"})}get isSimpleWidget(){return this._configuration.isSimpleWidget}get contextMenuId(){return this._configuration.contextMenuId}constructor(e,t,i,n,o,r,a,l,c,d,h,u){super(),this.languageConfigurationService=h,this._deliveryQueue=RJ(),this._contributions=this._register(new Mbe),this._onDidDispose=this._register(new O),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeModelTokens=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelTokens=this._onDidChangeModelTokens.event,this._onDidChangeConfiguration=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onWillChangeModel=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onWillChangeModel=this._onWillChangeModel.event,this._onDidChangeModel=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new Gn(this._contributions,this._deliveryQueue)),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new T9({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new T9({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new Gn(this._contributions,this._deliveryQueue)),this.onWillType=this._onWillType.event,this._onDidType=this._register(new Gn(this._contributions,this._deliveryQueue)),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new Gn(this._contributions,this._deliveryQueue)),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new Gn(this._contributions,this._deliveryQueue)),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new Gn(this._contributions,this._deliveryQueue)),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new Gn(this._contributions,this._deliveryQueue)),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new Gn(this._contributions,this._deliveryQueue)),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new Gn(this._contributions,this._deliveryQueue)),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new Gn(this._contributions,this._deliveryQueue)),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new Gn(this._contributions,this._deliveryQueue)),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onDropIntoEditor=this._register(new Gn(this._contributions,this._deliveryQueue)),this.onDropIntoEditor=this._onDropIntoEditor.event,this._onContextMenu=this._register(new Gn(this._contributions,this._deliveryQueue)),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new Gn(this._contributions,this._deliveryQueue)),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new Gn(this._contributions,this._deliveryQueue)),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new Gn(this._contributions,this._deliveryQueue)),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new Gn(this._contributions,this._deliveryQueue)),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new Gn(this._contributions,this._deliveryQueue)),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event,this._updateCounter=0,this._onBeginUpdate=this._register(new O),this.onBeginUpdate=this._onBeginUpdate.event,this._onEndUpdate=this._register(new O),this.onEndUpdate=this._onEndUpdate.event,this._actions=new Map,this._bannerDomNode=null,this._dropIntoEditorDecorations=this.createDecorationsCollection(),o.willCreateCodeEditor();const g={...t};this._domElement=e,this._overflowWidgetsDomNode=g.overflowWidgetsDomNode,delete g.overflowWidgetsDomNode,this._id=++Ive,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,i.contextMenuId??(i.isSimpleWidget?M.SimpleEditorContext:M.EditorContext),g,d)),this._register(this._configuration.onDidChange(_=>{this._onDidChangeConfiguration.fire(_);const b=this._configuration.options;if(_.hasChanged(146)){const v=b.get(146);this._onDidLayoutChange.fire(v)}})),this._contextKeyService=this._register(a.createScoped(this._domElement)),this._notificationService=c,this._codeEditorService=o,this._commandService=r,this._themeService=l,this._register(new Eve(this,this._contextKeyService)),this._register(new Nve(this,this._contextKeyService,u)),this._instantiationService=this._register(n.createChild(new Nm([Ee,this._contextKeyService]))),this._modelData=null,this._focusTracker=new Rve(e,this._overflowWidgetsDomNode),this._register(this._focusTracker.onChange(()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let f;Array.isArray(i.contributions)?f=i.contributions:f=Iu.getEditorContributions(),this._contributions.initialize(this,f,this._instantiationService);for(const _ of Iu.getEditorActions()){if(this._actions.has(_.id)){Oe(new Error(`Cannot have two actions with the same id ${_.id}`));continue}const b=new ij(_.id,_.label,_.alias,_.metadata,_.precondition??void 0,v=>this._instantiationService.invokeFunction(C=>Promise.resolve(_.runEditorCommand(C,this,v))),this._contextKeyService);this._actions.set(b.id,b)}const m=()=>!this._configuration.options.get(92)&&this._configuration.options.get(36).enabled;this._register(new jte(this._domElement,{onDragOver:_=>{if(!m())return;const b=this.getTargetAtClientPoint(_.clientX,_.clientY);b?.position&&this.showDropIndicatorAt(b.position)},onDrop:async _=>{if(!m()||(this.removeDropIndicator(),!_.dataTransfer))return;const b=this.getTargetAtClientPoint(_.clientX,_.clientY);b?.position&&this._onDropIntoEditor.fire({position:b.position,event:_})},onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}writeScreenReaderContent(e){this._modelData?.view.writeScreenReaderContent(e)}_createConfiguration(e,t,i,n){return new pR(e,t,i,this._domElement,n)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return VC.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e||{})}getOptions(){return this._configuration.options}getOption(e){return this._configuration.options.get(e)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(e){return this._modelData?vt.getWordAtPosition(this._modelData.model,this._configuration.options.get(132),this._configuration.options.get(131),e):null}getValue(e=null){if(!this._modelData)return"";const t=!!(e&&e.preserveBOM);let i=0;return e&&e.lineEnding&&e.lineEnding===`
`?i=1:e&&e.lineEnding&&e.lineEnding===`\r
`&&(i=2),this._modelData.model.getValue(i,t)}setValue(e){try{if(this._beginUpdate(),!this._modelData)return;this._modelData.model.setValue(e)}finally{this._endUpdate()}}getModel(){return this._modelData?this._modelData.model:null}setModel(e=null){try{this._beginUpdate();const t=e;if(this._modelData===null&&t===null||this._modelData&&this._modelData.model===t)return;const i={oldModelUrl:this._modelData?.model.uri||null,newModelUrl:t?.uri||null};this._onWillChangeModel.fire(i);const n=this.hasTextFocus(),o=this._detachModel();this._attachModel(t),n&&this.hasModel()&&this.focus(),this._removeDecorationTypes(),this._onDidChangeModel.fire(i),this._postDetachModelCleanup(o),this._contributionsDisposable=this._contributions.onAfterModelAttached()}finally{this._endUpdate()}}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(const e in this._decorationTypeSubtypes){const t=this._decorationTypeSubtypes[e];for(const i in t)this._removeDecorationType(e+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(e,t,i,n){const o=e.model.validatePosition({lineNumber:t,column:i}),r=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(o);return e.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(r.lineNumber,n)}getTopForLineNumber(e,t=!1){return this._modelData?Xh._getVerticalOffsetForPosition(this._modelData,e,1,t):-1}getTopForPosition(e,t){return this._modelData?Xh._getVerticalOffsetForPosition(this._modelData,e,t,!1):-1}static _getVerticalOffsetForPosition(e,t,i,n=!1){const o=e.model.validatePosition({lineNumber:t,column:i}),r=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(o);return e.viewModel.viewLayout.getVerticalOffsetForLineNumber(r.lineNumber,n)}getBottomForLineNumber(e,t=!1){if(!this._modelData)return-1;const i=this._modelData.model.getLineMaxColumn(e);return Xh._getVerticalOffsetAfterPosition(this._modelData,e,i,t)}setHiddenAreas(e,t){this._modelData?.viewModel.setHiddenAreas(e.map(i=>k.lift(i)),t)}getVisibleColumnFromPosition(e){if(!this._modelData)return e.column;const t=this._modelData.model.validatePosition(e),i=this._modelData.model.getOptions().tabSize;return $i.visibleColumnFromColumn(this._modelData.model.getLineContent(t.lineNumber),t.column,i)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(e,t="api"){if(this._modelData){if(!P.isIPosition(e))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,[{selectionStartLineNumber:e.lineNumber,selectionStartColumn:e.column,positionLineNumber:e.lineNumber,positionColumn:e.column}])}}_sendRevealRange(e,t,i,n){if(!this._modelData)return;if(!k.isIRange(e))throw new Error("Invalid arguments");const o=this._modelData.model.validateRange(e),r=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(o);this._modelData.viewModel.revealRange("api",i,r,t,n)}revealLine(e,t=0){this._revealLine(e,0,t)}revealLineInCenter(e,t=0){this._revealLine(e,1,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._revealLine(e,2,t)}revealLineNearTop(e,t=0){this._revealLine(e,5,t)}_revealLine(e,t,i){if(typeof e!="number")throw new Error("Invalid arguments");this._sendRevealRange(new k(e,1,e,1),t,!1,i)}revealPosition(e,t=0){this._revealPosition(e,0,!0,t)}revealPositionInCenter(e,t=0){this._revealPosition(e,1,!0,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._revealPosition(e,2,!0,t)}revealPositionNearTop(e,t=0){this._revealPosition(e,5,!0,t)}_revealPosition(e,t,i,n){if(!P.isIPosition(e))throw new Error("Invalid arguments");this._sendRevealRange(new k(e.lineNumber,e.column,e.lineNumber,e.column),t,i,n)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(e,t="api"){const i=me.isISelection(e),n=k.isIRange(e);if(!i&&!n)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(e,t);else if(n){const o={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn};this._setSelectionImpl(o,t)}}_setSelectionImpl(e,t){if(!this._modelData)return;const i=new me(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn);this._modelData.viewModel.setSelections(t,[i])}revealLines(e,t,i=0){this._revealLines(e,t,0,i)}revealLinesInCenter(e,t,i=0){this._revealLines(e,t,1,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._revealLines(e,t,2,i)}revealLinesNearTop(e,t,i=0){this._revealLines(e,t,5,i)}_revealLines(e,t,i,n){if(typeof e!="number"||typeof t!="number")throw new Error("Invalid arguments");this._sendRevealRange(new k(e,1,t,1),i,!1,n)}revealRange(e,t=0,i=!1,n=!0){this._revealRange(e,i?1:0,n,t)}revealRangeInCenter(e,t=0){this._revealRange(e,1,!0,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._revealRange(e,2,!0,t)}revealRangeNearTop(e,t=0){this._revealRange(e,5,!0,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._revealRange(e,6,!0,t)}revealRangeAtTop(e,t=0){this._revealRange(e,3,!0,t)}_revealRange(e,t,i,n){if(!k.isIRange(e))throw new Error("Invalid arguments");this._sendRevealRange(k.lift(e),t,i,n)}setSelections(e,t="api",i=0){if(this._modelData){if(!e||e.length===0)throw new Error("Invalid arguments");for(let n=0,o=e.length;n<o;n++)if(!me.isISelection(e[n]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,e,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e,t=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:e},t)}}setScrollTop(e,t=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:e},t)}}setScrollPosition(e,t=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(e,t)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;const e=this._contributions.saveViewState(),t=this._modelData.viewModel.saveCursorState(),i=this._modelData.viewModel.saveState();return{cursorState:t,viewState:i,contributionsState:e}}restoreViewState(e){if(!this._modelData||!this._modelData.hasRealView)return;const t=e;if(t&&t.cursorState&&t.viewState){const i=t.cursorState;Array.isArray(i)?i.length>0&&this._modelData.viewModel.restoreCursorState(i):this._modelData.viewModel.restoreCursorState([i]),this._contributions.restoreViewState(t.contributionsState||{});const n=this._modelData.viewModel.reduceRestoreState(t.viewState);this._modelData.view.restoreState(n)}}handleInitialized(){this._getViewModel()?.visibleLinesStabilized()}getContribution(e){return this._contributions.get(e)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let e=this.getActions();return e=e.filter(t=>t.isSupported()),e}getAction(e){return this._actions.get(e)||null}trigger(e,t,i){i=i||{};try{switch(this._beginUpdate(),t){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(e);return;case"type":{const o=i;this._type(e,o.text||"");return}case"replacePreviousChar":{const o=i;this._compositionType(e,o.text||"",o.replaceCharCnt||0,0,0);return}case"compositionType":{const o=i;this._compositionType(e,o.text||"",o.replacePrevCharCnt||0,o.replaceNextCharCnt||0,o.positionDelta||0);return}case"paste":{const o=i;this._paste(e,o.text||"",o.pasteOnNewLine||!1,o.multicursorText||null,o.mode||null,o.clipboardEvent);return}case"cut":this._cut(e);return}const n=this.getAction(t);if(n){Promise.resolve(n.run(i)).then(void 0,Oe);return}if(!this._modelData||this._triggerEditorCommand(e,t,i))return;this._triggerCommand(t,i)}finally{this._endUpdate()}}_triggerCommand(e,t){this._commandService.executeCommand(e,t)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(e){this._modelData&&(this._modelData.viewModel.endComposition(e),this._onDidCompositionEnd.fire())}_type(e,t){!this._modelData||t.length===0||(e==="keyboard"&&this._onWillType.fire(t),this._modelData.viewModel.type(t,e),e==="keyboard"&&this._onDidType.fire(t))}_compositionType(e,t,i,n,o){this._modelData&&this._modelData.viewModel.compositionType(t,i,n,o,e)}_paste(e,t,i,n,o,r){if(!this._modelData)return;const a=this._modelData.viewModel,l=a.getSelection().getStartPosition();a.paste(t,i,n,e);const c=a.getSelection().getStartPosition();e==="keyboard"&&this._onDidPaste.fire({clipboardEvent:r,range:new k(l.lineNumber,l.column,c.lineNumber,c.column),languageId:o})}_cut(e){this._modelData&&this._modelData.viewModel.cut(e)}_triggerEditorCommand(e,t,i){const n=Iu.getEditorCommand(t);return n?(i=i||{},i.source=e,this._instantiationService.invokeFunction(o=>{Promise.resolve(n.runEditorCommand(o,this,i)).then(void 0,Oe)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(92)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(92)?!1:(this._modelData.model.popStackElement(),!0)}executeEdits(e,t,i){if(!this._modelData||this._configuration.options.get(92))return!1;let n;return i?Array.isArray(i)?n=()=>i:n=i:n=()=>null,this._modelData.viewModel.executeEdits(e,t,n),!0}executeCommand(e,t){this._modelData&&this._modelData.viewModel.executeCommand(t,e)}executeCommands(e,t){this._modelData&&this._modelData.viewModel.executeCommands(t,e)}createDecorationsCollection(e){return new Mve(this,e)}changeDecorations(e){return this._modelData?this._modelData.model.changeDecorations(e,this._id):null}getLineDecorations(e){return this._modelData?this._modelData.model.getLineDecorations(e,this._id,D1(this._configuration.options)):null}getDecorationsInRange(e){return this._modelData?this._modelData.model.getDecorationsInRange(e,this._id,D1(this._configuration.options)):null}deltaDecorations(e,t){return this._modelData?e.length===0&&t.length===0?e:this._modelData.model.deltaDecorations(e,t,this._id):[]}removeDecorations(e){!this._modelData||e.length===0||this._modelData.model.changeDecorations(t=>{t.deltaDecorations(e,[])})}removeDecorationsByType(e){const t=this._decorationTypeKeysToIds[e];t&&this.changeDecorations(i=>i.deltaDecorations(t,[])),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){return this._configuration.options.get(146)}createOverviewRuler(e){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(e)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(e)}layout(e,t=!1){this._configuration.observeContainer(e),t||this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(e){const t={widget:e,position:e.getPosition()};this._contentWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a content widget with the same id:"+e.getId()),this._contentWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(t)}layoutContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];delete this._contentWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(i)}}addOverlayWidget(e){const t={widget:e,position:e.getPosition()};this._overlayWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(t)}layoutOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];delete this._overlayWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(i)}}addGlyphMarginWidget(e){const t={widget:e,position:e.getPosition()};this._glyphMarginWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(t)}layoutGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const i=this._glyphMarginWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(i)}}removeGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const i=this._glyphMarginWidgets[t];delete this._glyphMarginWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(i)}}changeViewZones(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(e)}getTargetAtClientPoint(e,t){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(e,t)}getScrolledVisiblePosition(e){if(!this._modelData||!this._modelData.hasRealView)return null;const t=this._modelData.model.validatePosition(e),i=this._configuration.options,n=i.get(146),o=Xh._getVerticalOffsetForPosition(this._modelData,t.lineNumber,t.column)-this.getScrollTop(),r=this._modelData.view.getOffsetForColumn(t.lineNumber,t.column)+n.glyphMarginWidth+n.lineNumbersWidth+n.decorationsWidth-this.getScrollLeft();return{top:o,left:r,height:i.get(67)}}getOffsetForColumn(e,t){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(e,t)}render(e=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.viewModel.batchEvents(()=>{this._modelData.view.render(!0,e)})}setAriaOptions(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(e)}applyFontInfo(e){wn(e,this._configuration.options.get(50))}setBanner(e,t){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),this._bannerDomNode=e,this._configuration.setReservedHeight(e?t:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(e){if(!e){this._modelData=null;return}const t=[];this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._configuration.setIsDominatedByLongLines(e.isDominatedByLongLines()),this._configuration.setModelLineCount(e.getLineCount());const i=e.onBeforeAttached(),n=new Sve(this._id,this._configuration,e,nF.create(ke(this._domElement)),sF.create(this._configuration.options),a=>mo(ke(this._domElement),a),this.languageConfigurationService,this._themeService,i,{batchChanges:a=>{try{return this._beginUpdate(),a()}finally{this._endUpdate()}}});t.push(e.onWillDispose(()=>this.setModel(null))),t.push(n.onEvent(a=>{switch(a.kind){case 0:this._onDidContentSizeChange.fire(a);break;case 1:this._editorTextFocus.setValue(a.hasFocus);break;case 2:this._onDidScrollChange.fire(a);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(a.reachedMaxCursorCount){const h=this.getOption(80),u=p("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",h);this._notificationService.prompt(HL.Warning,u,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:p("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}const l=[];for(let h=0,u=a.selections.length;h<u;h++)l[h]=a.selections[h].getPosition();const c={position:l[0],secondaryPositions:l.slice(1),reason:a.reason,source:a.source};this._onDidChangeCursorPosition.fire(c);const d={selection:a.selections[0],secondarySelections:a.selections.slice(1),modelVersionId:a.modelVersionId,oldSelections:a.oldSelections,oldModelVersionId:a.oldModelVersionId,source:a.source,reason:a.reason};this._onDidChangeCursorSelection.fire(d);break}case 7:this._onDidChangeModelDecorations.fire(a.event);break;case 8:this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._onDidChangeModelLanguage.fire(a.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(a.event);break;case 10:this._onDidChangeModelContent.fire(a.event);break;case 11:this._onDidChangeModelOptions.fire(a.event);break;case 12:this._onDidChangeModelTokens.fire(a.event);break}}));const[o,r]=this._createView(n);if(r){this._domElement.appendChild(o.domNode.domNode);let a=Object.keys(this._contentWidgets);for(let l=0,c=a.length;l<c;l++){const d=a[l];o.addContentWidget(this._contentWidgets[d])}a=Object.keys(this._overlayWidgets);for(let l=0,c=a.length;l<c;l++){const d=a[l];o.addOverlayWidget(this._overlayWidgets[d])}a=Object.keys(this._glyphMarginWidgets);for(let l=0,c=a.length;l<c;l++){const d=a[l];o.addGlyphMarginWidget(this._glyphMarginWidgets[d])}o.render(!1,!0),o.domNode.domNode.setAttribute("data-uri",e.uri.toString())}this._modelData=new Tve(e,n,o,r,t,i)}_createView(e){let t;this.isSimpleWidget?t={paste:(o,r,a,l)=>{this._paste("keyboard",o,r,a,l)},type:o=>{this._type("keyboard",o)},compositionType:(o,r,a,l)=>{this._compositionType("keyboard",o,r,a,l)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:t={paste:(o,r,a,l)=>{const c={text:o,pasteOnNewLine:r,multicursorText:a,mode:l};this._commandService.executeCommand("paste",c)},type:o=>{const r={text:o};this._commandService.executeCommand("type",r)},compositionType:(o,r,a,l)=>{if(a||l){const c={text:o,replacePrevCharCnt:r,replaceNextCharCnt:a,positionDelta:l};this._commandService.executeCommand("compositionType",c)}else{const c={text:o,replaceCharCnt:r};this._commandService.executeCommand("replacePreviousChar",c)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const i=new Nx(e.coordinatesConverter);return i.onKeyDown=o=>this._onKeyDown.fire(o),i.onKeyUp=o=>this._onKeyUp.fire(o),i.onContextMenu=o=>this._onContextMenu.fire(o),i.onMouseMove=o=>this._onMouseMove.fire(o),i.onMouseLeave=o=>this._onMouseLeave.fire(o),i.onMouseDown=o=>this._onMouseDown.fire(o),i.onMouseUp=o=>this._onMouseUp.fire(o),i.onMouseDrag=o=>this._onMouseDrag.fire(o),i.onMouseDrop=o=>this._onMouseDrop.fire(o),i.onMouseDropCanceled=o=>this._onMouseDropCanceled.fire(o),i.onMouseWheel=o=>this._onMouseWheel.fire(o),[new SR(t,this._configuration,this._themeService.getColorTheme(),e,i,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(e){e?.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(this._contributionsDisposable?.dispose(),this._contributionsDisposable=void 0,!this._modelData)return null;const e=this._modelData.model,t=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),t&&this._domElement.contains(t)&&t.remove(),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),e}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}hasModel(){return this._modelData!==null}showDropIndicatorAt(e){const t=[{range:new k(e.lineNumber,e.column,e.lineNumber,e.column),options:Xh.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(t),this.revealPosition(e,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(e,t){this._contextKeyService.createKey(e,t)}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&this._onBeginUpdate.fire()}_endUpdate(){this._updateCounter--,this._updateCounter===0&&this._onEndUpdate.fire()}};Pv=Xh=Dve([Yl(3,ye),Yl(4,ft),Yl(5,Ht),Yl(6,Ee),Yl(7,Ki),Yl(8,Ii),Yl(9,vo),Yl(10,di),Yl(11,pe)],Pv);let Ive=0;class Tve{constructor(e,t,i,n,o,r){this.model=e,this.viewModel=t,this.view=i,this.hasRealView=n,this.listenersToRemove=o,this.attachedView=r}dispose(){At(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}}class T9 extends B{constructor(e){super(),this._emitterOptions=e,this._onDidChangeToTrue=this._register(new O(this._emitterOptions)),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new O(this._emitterOptions)),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(e){const t=e?2:1;this._value!==t&&(this._value=t,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}}class Gn extends O{constructor(e,t){super({deliveryQueue:t}),this._contributions=e}fire(e){this._contributions.onBeforeInteractionEvent(),super.fire(e)}}class Eve extends B{constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=I.editorSimpleInput.bindTo(t),this._editorFocus=I.focus.bindTo(t),this._textInputFocus=I.textInputFocus.bindTo(t),this._editorTextFocus=I.editorTextFocus.bindTo(t),this._tabMovesFocus=I.tabMovesFocus.bindTo(t),this._editorReadonly=I.readOnly.bindTo(t),this._inDiffEditor=I.inDiffEditor.bindTo(t),this._editorColumnSelection=I.columnSelection.bindTo(t),this._hasMultipleSelections=I.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=I.hasNonEmptySelection.bindTo(t),this._canUndo=I.canUndo.bindTo(t),this._canRedo=I.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(Up.onDidChangeTabFocus(i=>this._tabMovesFocus.set(i))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const e=this._editor.getOptions();this._tabMovesFocus.set(Up.getTabFocusMode()),this._editorReadonly.set(e.get(92)),this._inDiffEditor.set(e.get(61)),this._editorColumnSelection.set(e.get(22))}_updateFromSelection(){const e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some(t=>!t.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const e=this._editor.getModel();this._canUndo.set(!!(e&&e.canUndo())),this._canRedo.set(!!(e&&e.canRedo()))}}class Nve extends B{constructor(e,t,i){super(),this._editor=e,this._contextKeyService=t,this._languageFeaturesService=i,this._langId=I.languageId.bindTo(t),this._hasCompletionItemProvider=I.hasCompletionItemProvider.bindTo(t),this._hasCodeActionsProvider=I.hasCodeActionsProvider.bindTo(t),this._hasCodeLensProvider=I.hasCodeLensProvider.bindTo(t),this._hasDefinitionProvider=I.hasDefinitionProvider.bindTo(t),this._hasDeclarationProvider=I.hasDeclarationProvider.bindTo(t),this._hasImplementationProvider=I.hasImplementationProvider.bindTo(t),this._hasTypeDefinitionProvider=I.hasTypeDefinitionProvider.bindTo(t),this._hasHoverProvider=I.hasHoverProvider.bindTo(t),this._hasDocumentHighlightProvider=I.hasDocumentHighlightProvider.bindTo(t),this._hasDocumentSymbolProvider=I.hasDocumentSymbolProvider.bindTo(t),this._hasReferenceProvider=I.hasReferenceProvider.bindTo(t),this._hasRenameProvider=I.hasRenameProvider.bindTo(t),this._hasSignatureHelpProvider=I.hasSignatureHelpProvider.bindTo(t),this._hasInlayHintsProvider=I.hasInlayHintsProvider.bindTo(t),this._hasDocumentFormattingProvider=I.hasDocumentFormattingProvider.bindTo(t),this._hasDocumentSelectionFormattingProvider=I.hasDocumentSelectionFormattingProvider.bindTo(t),this._hasMultipleDocumentFormattingProvider=I.hasMultipleDocumentFormattingProvider.bindTo(t),this._hasMultipleDocumentSelectionFormattingProvider=I.hasMultipleDocumentSelectionFormattingProvider.bindTo(t),this._isInEmbeddedEditor=I.isInEmbeddedEditor.bindTo(t);const n=()=>this._update();this._register(e.onDidChangeModel(n)),this._register(e.onDidChangeModelLanguage(n)),this._register(i.completionProvider.onDidChange(n)),this._register(i.codeActionProvider.onDidChange(n)),this._register(i.codeLensProvider.onDidChange(n)),this._register(i.definitionProvider.onDidChange(n)),this._register(i.declarationProvider.onDidChange(n)),this._register(i.implementationProvider.onDidChange(n)),this._register(i.typeDefinitionProvider.onDidChange(n)),this._register(i.hoverProvider.onDidChange(n)),this._register(i.documentHighlightProvider.onDidChange(n)),this._register(i.documentSymbolProvider.onDidChange(n)),this._register(i.referenceProvider.onDidChange(n)),this._register(i.renameProvider.onDidChange(n)),this._register(i.documentFormattingEditProvider.onDidChange(n)),this._register(i.documentRangeFormattingEditProvider.onDidChange(n)),this._register(i.signatureHelpProvider.onDidChange(n)),this._register(i.inlayHintsProvider.onDidChange(n)),n()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInEmbeddedEditor.reset()})}_update(){const e=this._editor.getModel();if(!e){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(e.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(e)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(e)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(e)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(e)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(e)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(e)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(e)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(e)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(e)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(e)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(e)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(e)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(e)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(e)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(e)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(e).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._isInEmbeddedEditor.set(e.uri.scheme===Fe.walkThroughSnippet||e.uri.scheme===Fe.vscodeChatCodeBlock)})}}class Rve extends B{constructor(e,t){super(),this._onChange=this._register(new O),this.onChange=this._onChange.event,this._hadFocus=void 0,this._hasDomElementFocus=!1,this._domFocusTracker=this._register(Wa(e)),this._overflowWidgetsDomNodeHasFocus=!1,this._register(this._domFocusTracker.onDidFocus(()=>{this._hasDomElementFocus=!0,this._update()})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasDomElementFocus=!1,this._update()})),t&&(this._overflowWidgetsDomNode=this._register(Wa(t)),this._register(this._overflowWidgetsDomNode.onDidFocus(()=>{this._overflowWidgetsDomNodeHasFocus=!0,this._update()})),this._register(this._overflowWidgetsDomNode.onDidBlur(()=>{this._overflowWidgetsDomNodeHasFocus=!1,this._update()})))}_update(){const e=this._hasDomElementFocus||this._overflowWidgetsDomNodeHasFocus;this._hadFocus!==e&&(this._hadFocus=e,this._onChange.fire(void 0))}hasFocus(){return this._hadFocus??!1}}class Mve{get length(){return this._decorationIds.length}constructor(e,t){this._editor=e,this._decorationIds=[],this._isChangingDecorations=!1,Array.isArray(t)&&t.length>0&&this.set(t)}onDidChange(e,t,i){return this._editor.onDidChangeModelDecorations(n=>{this._isChangingDecorations||e.call(t,n)},i)}getRange(e){return!this._editor.hasModel()||e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e])}getRanges(){if(!this._editor.hasModel())return[];const e=this._editor.getModel(),t=[];for(const i of this._decorationIds){const n=e.getDecorationRange(i);n&&t.push(n)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations(t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)})}finally{this._isChangingDecorations=!1}return this._decorationIds}append(e){let t=[];try{this._isChangingDecorations=!0,this._editor.changeDecorations(i=>{t=i.deltaDecorations([],e),this._decorationIds=this._decorationIds.concat(t)})}finally{this._isChangingDecorations=!1}return t}}const Ave=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),Pve=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function eI(s){return Ave+encodeURIComponent(s.toString())+Pve}const Ove=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),Fve=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function Bve(s){return Ove+encodeURIComponent(s.toString())+Fve}kr((s,e)=>{const t=s.getColor($L);t&&e.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${eI(t)}") repeat-x bottom left; }`);const i=s.getColor(Vc);i&&e.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${eI(i)}") repeat-x bottom left; }`);const n=s.getColor(El);n&&e.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${eI(n)}") repeat-x bottom left; }`);const o=s.getColor(Doe);o&&e.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${Bve(o)}") no-repeat bottom left; }`);const r=s.getColor(dhe);r&&e.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${r.rgba.a}; }`)});class $a{static capture(e){if(e.getScrollTop()===0||e.hasPendingScrollAnimation())return new $a(e.getScrollTop(),e.getContentHeight(),null,0,null);let t=null,i=0;const n=e.getVisibleRanges();if(n.length>0){t=n[0].getStartPosition();const o=e.getTopForPosition(t.lineNumber,t.column);i=e.getScrollTop()-o}return new $a(e.getScrollTop(),e.getContentHeight(),t,i,e.getPosition())}constructor(e,t,i,n,o){this._initialScrollTop=e,this._initialContentHeight=t,this._visiblePosition=i,this._visiblePositionScrollDelta=n,this._cursorPosition=o}restore(e){if(!(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())&&this._visiblePosition){const t=e.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);e.setScrollTop(t+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(e){if(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())return;const t=e.getPosition();if(!this._cursorPosition||!t)return;const i=e.getTopForLineNumber(t.lineNumber)-e.getTopForLineNumber(this._cursorPosition.lineNumber);e.setScrollTop(e.getScrollTop()+i,1)}}function Wve(s,e,t,i){if(s.length===0)return e;if(e.length===0)return s;const n=[];let o=0,r=0;for(;o<s.length&&r<e.length;){const a=s[o],l=e[r],c=t(a),d=t(l);c<d?(n.push(a),o++):c>d?(n.push(l),r++):(n.push(i(a,l)),o++,r++)}for(;o<s.length;)n.push(s[o]),o++;for(;r<e.length;)n.push(e[r]),r++;return n}function uS(s,e){const t=new Z,i=s.createDecorationsCollection();return t.add(MC({debugName:()=>`Apply decorations from ${e.debugName}`},n=>{const o=e.read(n);i.set(o)})),t.add({dispose:()=>{i.clear()}}),t}function Pf(s,e){return s.appendChild(e),Ce(()=>{e.remove()})}function Hve(s,e){return s.prepend(e),Ce(()=>{e.remove()})}class rj extends B{get width(){return this._width}get height(){return this._height}get automaticLayout(){return this._automaticLayout}constructor(e,t){super(),this._automaticLayout=!1,this.elementSizeObserver=this._register(new W$(e,t)),this._width=Ze(this,this.elementSizeObserver.getWidth()),this._height=Ze(this,this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange(i=>ai(n=>{this._width.set(this.elementSizeObserver.getWidth(),n),this._height.set(this.elementSizeObserver.getHeight(),n)})))}observe(e){this.elementSizeObserver.observe(e)}setAutomaticLayout(e){this._automaticLayout=e,e?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}}function E9(s,e,t){let i=e.get(),n=i,o=i;const r=Ze("animatedValue",i);let a=-1;const l=300;let c;t.add(AC({createEmptyChangeSummary:()=>({animate:!1}),handleChange:(h,u)=>(h.didChange(e)&&(u.animate=u.animate||h.change),!0)},(h,u)=>{c!==void 0&&(s.cancelAnimationFrame(c),c=void 0),n=o,i=e.read(h),a=Date.now()-(u.animate?0:l),d()}));function d(){const h=Date.now()-a;o=Math.floor(Vve(h,n,i-n,l)),h<l?c=s.requestAnimationFrame(d):o=i,r.set(o,void 0)}return r}function Vve(s,e,t,i){return s===i?e+t:t*(-Math.pow(2,-10*s/i)+1)+e}class uF extends B{constructor(e,t,i){super(),this._register(new gF(e,i)),this._register(Uc(i,{height:t.actualHeight,top:t.actualTop}))}}class Of{get afterLineNumber(){return this._afterLineNumber.get()}constructor(e,t){this._afterLineNumber=e,this.heightInPx=t,this.domNode=document.createElement("div"),this._actualTop=Ze(this,void 0),this._actualHeight=Ze(this,void 0),this.actualTop=this._actualTop,this.actualHeight=this._actualHeight,this.showInHiddenAreas=!0,this.onChange=this._afterLineNumber,this.onDomNodeTop=i=>{this._actualTop.set(i,void 0)},this.onComputedHeight=i=>{this._actualHeight.set(i,void 0)}}}class gF{static{this._counter=0}constructor(e,t){this._editor=e,this._domElement=t,this._overlayWidgetId=`managedOverlayWidget-${gF._counter++}`,this._overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null},this._editor.addOverlayWidget(this._overlayWidget)}dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}}function Uc(s,e){return Pe(t=>{for(let[i,n]of Object.entries(e))n&&typeof n=="object"&&"read"in n&&(n=n.read(t)),typeof n=="number"&&(n=`${n}px`),i=i.replace(/[A-Z]/g,o=>"-"+o.toLowerCase()),s.style[i]=n})}function gS(s,e,t,i){const n=new Z,o=[];return n.add(Us((r,a)=>{const l=e.read(r),c=new Map,d=new Map;t&&t(!0),s.changeViewZones(h=>{for(const u of o)h.removeZone(u),i?.delete(u);o.length=0;for(const u of l){const g=h.addZone(u);u.setZoneId&&u.setZoneId(g),o.push(g),i?.add(g),c.set(u,g)}}),t&&t(!1),a.add(AC({createEmptyChangeSummary(){return{zoneIds:[]}},handleChange(h,u){const g=d.get(h.changedObservable);return g!==void 0&&u.zoneIds.push(g),!0}},(h,u)=>{for(const g of l)g.onChange&&(d.set(g.onChange,c.get(g)),g.onChange.read(h));t&&t(!0),s.changeViewZones(g=>{for(const f of u.zoneIds)g.layoutZone(f)}),t&&t(!1)}))})),n.add({dispose(){t&&t(!0),s.changeViewZones(r=>{for(const a of o)r.removeZone(a)}),i?.clear(),t&&t(!1)}}),n}class zve extends li{dispose(){super.dispose(!0)}}function N9(s,e){const t=Xb(e,n=>n.original.startLineNumber<=s.lineNumber);if(!t)return k.fromPositions(s);if(t.original.endLineNumberExclusive<=s.lineNumber){const n=s.lineNumber-t.original.endLineNumberExclusive+t.modified.endLineNumberExclusive;return k.fromPositions(new P(n,s.column))}if(!t.innerChanges)return k.fromPositions(new P(t.modified.startLineNumber,1));const i=Xb(t.innerChanges,n=>n.originalRange.getStartPosition().isBeforeOrEqual(s));if(!i){const n=s.lineNumber-t.original.startLineNumber+t.modified.startLineNumber;return k.fromPositions(new P(n,s.column))}if(i.originalRange.containsPosition(s))return i.modifiedRange;{const n=Uve(i.originalRange.getEndPosition(),s);return k.fromPositions(n.addToPosition(i.modifiedRange.getEndPosition()))}}function Uve(s,e){return s.lineNumber===e.lineNumber?new Hs(0,e.column-s.column):new Hs(e.lineNumber-s.lineNumber,e.column-1)}function $ve(s,e){let t;return s.filter(i=>{const n=e(i,t);return t=i,n})}class fS{static create(e,t=void 0){return new R9(e,e,t)}static createWithDisposable(e,t,i=void 0){const n=new Z;return n.add(t),n.add(e),new R9(e,n,i)}}class R9 extends fS{constructor(e,t,i){super(),this.object=e,this._disposable=t,this._debugOwner=i,this._refCount=1,this._isDisposed=!1,this._owners=[],i&&this._addOwner(i)}_addOwner(e){e&&this._owners.push(e)}createNewRef(e){return this._refCount++,e&&this._addOwner(e),new jve(this,e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._decreaseRefCount(this._debugOwner))}_decreaseRefCount(e){if(this._refCount--,this._refCount===0&&this._disposable.dispose(),e){const t=this._owners.indexOf(e);t!==-1&&this._owners.splice(t,1)}}}class jve extends fS{constructor(e,t){super(),this._base=e,this._debugOwner=t,this._isDisposed=!1}get object(){return this._base.object}createNewRef(e){return this._base.createNewRef(e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._base._decreaseRefCount(this._debugOwner))}}var fF=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},pF=function(s,e){return function(t,i){e(t,i,s)}};const Zve=Kt("diff-review-insert",J.add,p("accessibleDiffViewerInsertIcon","Icon for 'Insert' in accessible diff viewer.")),Kve=Kt("diff-review-remove",J.remove,p("accessibleDiffViewerRemoveIcon","Icon for 'Remove' in accessible diff viewer.")),qve=Kt("diff-review-close",J.close,p("accessibleDiffViewerCloseIcon","Icon for 'Close' in accessible diff viewer."));let wu=class extends B{static{this._ttPolicy=Gc("diffReview",{createHTML:e=>e})}constructor(e,t,i,n,o,r,a,l,c){super(),this._parentNode=e,this._visible=t,this._setVisible=i,this._canClose=n,this._width=o,this._height=r,this._diffs=a,this._models=l,this._instantiationService=c,this._state=wh(this,(d,h)=>{const u=this._visible.read(d);if(this._parentNode.style.visibility=u?"visible":"hidden",!u)return null;const g=h.add(this._instantiationService.createInstance(NR,this._diffs,this._models,this._setVisible,this._canClose)),f=h.add(this._instantiationService.createInstance(RR,this._parentNode,g,this._width,this._height,this._models));return{model:g,view:f}}).recomputeInitiallyAndOnChange(this._store)}next(){ai(e=>{const t=this._visible.get();this._setVisible(!0,e),t&&this._state.get().model.nextGroup(e)})}prev(){ai(e=>{this._setVisible(!0,e),this._state.get().model.previousGroup(e)})}close(){ai(e=>{this._setVisible(!1,e)})}};wu=fF([pF(8,ye)],wu);let NR=class extends B{constructor(e,t,i,n,o){super(),this._diffs=e,this._models=t,this._setVisible=i,this.canClose=n,this._accessibilitySignalService=o,this._groups=Ze(this,[]),this._currentGroupIdx=Ze(this,0),this._currentElementIdx=Ze(this,0),this.groups=this._groups,this.currentGroup=this._currentGroupIdx.map((r,a)=>this._groups.read(a)[r]),this.currentGroupIndex=this._currentGroupIdx,this.currentElement=this._currentElementIdx.map((r,a)=>this.currentGroup.read(a)?.lines[r]),this._register(Pe(r=>{const a=this._diffs.read(r);if(!a){this._groups.set([],void 0);return}const l=Gve(a,this._models.getOriginalModel().getLineCount(),this._models.getModifiedModel().getLineCount());ai(c=>{const d=this._models.getModifiedPosition();if(d){const h=l.findIndex(u=>d?.lineNumber<u.range.modified.endLineNumberExclusive);h!==-1&&this._currentGroupIdx.set(h,c)}this._groups.set(l,c)})})),this._register(Pe(r=>{const a=this.currentElement.read(r);a?.type===hs.Deleted?this._accessibilitySignalService.playSignal(Lt.diffLineDeleted,{source:"accessibleDiffViewer.currentElementChanged"}):a?.type===hs.Added&&this._accessibilitySignalService.playSignal(Lt.diffLineInserted,{source:"accessibleDiffViewer.currentElementChanged"})})),this._register(Pe(r=>{const a=this.currentElement.read(r);if(a&&a.type!==hs.Header){const l=a.modifiedLineNumber??a.diff.modified.startLineNumber;this._models.modifiedSetSelection(k.fromPositions(new P(l,1)))}}))}_goToGroupDelta(e,t){const i=this.groups.get();!i||i.length<=1||Qu(t,n=>{this._currentGroupIdx.set(qe.ofLength(i.length).clipCyclic(this._currentGroupIdx.get()+e),n),this._currentElementIdx.set(0,n)})}nextGroup(e){this._goToGroupDelta(1,e)}previousGroup(e){this._goToGroupDelta(-1,e)}_goToLineDelta(e){const t=this.currentGroup.get();!t||t.lines.length<=1||ai(i=>{this._currentElementIdx.set(qe.ofLength(t.lines.length).clip(this._currentElementIdx.get()+e),i)})}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(e){const t=this.currentGroup.get();if(!t)return;const i=t.lines.indexOf(e);i!==-1&&ai(n=>{this._currentElementIdx.set(i,n)})}revealCurrentElementInEditor(){if(!this.canClose.get())return;this._setVisible(!1,void 0);const e=this.currentElement.get();e&&(e.type===hs.Deleted?this._models.originalReveal(k.fromPositions(new P(e.originalLineNumber,1))):this._models.modifiedReveal(e.type!==hs.Header?k.fromPositions(new P(e.modifiedLineNumber,1)):void 0))}close(){this.canClose.get()&&(this._setVisible(!1,void 0),this._models.modifiedFocus())}};NR=fF([pF(4,Lh)],NR);const l_=3;function Gve(s,e,t){const i=[];for(const n of SP(s,(o,r)=>r.modified.startLineNumber-o.modified.endLineNumberExclusive<2*l_)){const o=[];o.push(new Xve);const r=new He(Math.max(1,n[0].original.startLineNumber-l_),Math.min(n[n.length-1].original.endLineNumberExclusive+l_,e+1)),a=new He(Math.max(1,n[0].modified.startLineNumber-l_),Math.min(n[n.length-1].modified.endLineNumberExclusive+l_,t+1));$H(n,(d,h)=>{const u=new He(d?d.original.endLineNumberExclusive:r.startLineNumber,h?h.original.startLineNumber:r.endLineNumberExclusive),g=new He(d?d.modified.endLineNumberExclusive:a.startLineNumber,h?h.modified.startLineNumber:a.endLineNumberExclusive);u.forEach(f=>{o.push(new eCe(f,g.startLineNumber+(f-u.startLineNumber)))}),h&&(h.original.forEach(f=>{o.push(new Qve(h,f))}),h.modified.forEach(f=>{o.push(new Jve(h,f))}))});const l=n[0].modified.join(n[n.length-1].modified),c=n[0].original.join(n[n.length-1].original);i.push(new Yve(new is(l,c),o))}return i}var hs;(function(s){s[s.Header=0]="Header",s[s.Unchanged=1]="Unchanged",s[s.Deleted=2]="Deleted",s[s.Added=3]="Added"})(hs||(hs={}));class Yve{constructor(e,t){this.range=e,this.lines=t}}class Xve{constructor(){this.type=hs.Header}}class Qve{constructor(e,t){this.diff=e,this.originalLineNumber=t,this.type=hs.Deleted,this.modifiedLineNumber=void 0}}class Jve{constructor(e,t){this.diff=e,this.modifiedLineNumber=t,this.type=hs.Added,this.originalLineNumber=void 0}}class eCe{constructor(e,t){this.originalLineNumber=e,this.modifiedLineNumber=t,this.type=hs.Unchanged}}let RR=class extends B{constructor(e,t,i,n,o,r){super(),this._element=e,this._model=t,this._width=i,this._height=n,this._models=o,this._languageService=r,this.domNode=this._element,this.domNode.className="monaco-component diff-review monaco-editor-background";const a=document.createElement("div");a.className="diff-review-actions",this._actionBar=this._register(new zo(a)),this._register(Pe(l=>{this._actionBar.clear(),this._model.canClose.read(l)&&this._actionBar.push(new ho("diffreview.close",p("label.close","Close"),"close-diff-review "+Ie.asClassName(qve),!0,async()=>t.close()),{label:!1,icon:!0})})),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new DC(this._content,{})),yn(this.domNode,this._scrollbar.getDomNode(),a),this._register(Pe(l=>{this._height.read(l),this._width.read(l),this._scrollbar.scanDomNode()})),this._register(Ce(()=>{yn(this.domNode)})),this._register(Uc(this.domNode,{width:this._width,height:this._height})),this._register(Uc(this._content,{width:this._width,height:this._height})),this._register(Us((l,c)=>{this._model.currentGroup.read(l),this._render(c)})),this._register(gi(this.domNode,"keydown",l=>{(l.equals(18)||l.equals(2066)||l.equals(530))&&(l.preventDefault(),this._model.goToNextLine()),(l.equals(16)||l.equals(2064)||l.equals(528))&&(l.preventDefault(),this._model.goToPreviousLine()),(l.equals(9)||l.equals(2057)||l.equals(521)||l.equals(1033))&&(l.preventDefault(),this._model.close()),(l.equals(10)||l.equals(3))&&(l.preventDefault(),this._model.revealCurrentElementInEditor())}))}_render(e){const t=this._models.getOriginalOptions(),i=this._models.getModifiedOptions(),n=document.createElement("div");n.className="diff-review-table",n.setAttribute("role","list"),n.setAttribute("aria-label",p("ariaLabel","Accessible Diff Viewer. Use arrow up and down to navigate.")),wn(n,i.get(50)),yn(this._content,n);const o=this._models.getOriginalModel(),r=this._models.getModifiedModel();if(!o||!r)return;const a=o.getOptions(),l=r.getOptions(),c=i.get(67),d=this._model.currentGroup.get();for(const h of d?.lines||[]){if(!d)break;let u;if(h.type===hs.Header){const f=document.createElement("div");f.className="diff-review-row",f.setAttribute("role","listitem");const m=d.range,_=this._model.currentGroupIndex.get(),b=this._model.groups.get().length,v=x=>x===0?p("no_lines_changed","no lines changed"):x===1?p("one_line_changed","1 line changed"):p("more_lines_changed","{0} lines changed",x),C=v(m.original.length),y=v(m.modified.length);f.setAttribute("aria-label",p({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",_+1,b,m.original.startLineNumber,C,m.modified.startLineNumber,y));const w=document.createElement("div");w.className="diff-review-cell diff-review-summary",w.appendChild(document.createTextNode(`${_+1}/${b}: @@ -${m.original.startLineNumber},${m.original.length} +${m.modified.startLineNumber},${m.modified.length} @@`)),f.appendChild(w),u=f}else u=this._createRow(h,c,this._width.get(),t,o,a,i,r,l);n.appendChild(u);const g=_e(f=>this._model.currentElement.read(f)===h);e.add(Pe(f=>{const m=g.read(f);u.tabIndex=m?0:-1,m&&u.focus()})),e.add(U(u,"focus",()=>{this._model.goToLine(h)}))}this._scrollbar.scanDomNode()}_createRow(e,t,i,n,o,r,a,l,c){const d=n.get(146),h=d.glyphMarginWidth+d.lineNumbersWidth,u=a.get(146),g=10+u.glyphMarginWidth+u.lineNumbersWidth;let f="diff-review-row",m="";const _="diff-review-spacer";let b=null;switch(e.type){case hs.Added:f="diff-review-row line-insert",m=" char-insert",b=Zve;break;case hs.Deleted:f="diff-review-row line-delete",m=" char-delete",b=Kve;break}const v=document.createElement("div");v.style.minWidth=i+"px",v.className=f,v.setAttribute("role","listitem"),v.ariaLevel="";const C=document.createElement("div");C.className="diff-review-cell",C.style.height=`${t}px`,v.appendChild(C);const y=document.createElement("span");y.style.width=h+"px",y.style.minWidth=h+"px",y.className="diff-review-line-number"+m,e.originalLineNumber!==void 0?y.appendChild(document.createTextNode(String(e.originalLineNumber))):y.innerText="",C.appendChild(y);const w=document.createElement("span");w.style.width=g+"px",w.style.minWidth=g+"px",w.style.paddingRight="10px",w.className="diff-review-line-number"+m,e.modifiedLineNumber!==void 0?w.appendChild(document.createTextNode(String(e.modifiedLineNumber))):w.innerText="",C.appendChild(w);const x=document.createElement("span");if(x.className=_,b){const T=document.createElement("span");T.className=Ie.asClassName(b),T.innerText="",x.appendChild(T)}else x.innerText="";C.appendChild(x);let L;if(e.modifiedLineNumber!==void 0){let T=this._getLineHtml(l,a,c.tabSize,e.modifiedLineNumber,this._languageService.languageIdCodec);wu._ttPolicy&&(T=wu._ttPolicy.createHTML(T)),C.insertAdjacentHTML("beforeend",T),L=l.getLineContent(e.modifiedLineNumber)}else{let T=this._getLineHtml(o,n,r.tabSize,e.originalLineNumber,this._languageService.languageIdCodec);wu._ttPolicy&&(T=wu._ttPolicy.createHTML(T)),C.insertAdjacentHTML("beforeend",T),L=o.getLineContent(e.originalLineNumber)}L.length===0&&(L=p("blankLine","blank"));let D="";switch(e.type){case hs.Unchanged:e.originalLineNumber===e.modifiedLineNumber?D=p({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",L,e.originalLineNumber):D=p("equalLine","{0} original line {1} modified line {2}",L,e.originalLineNumber,e.modifiedLineNumber);break;case hs.Added:D=p("insertLine","+ {0} modified line {1}",L,e.modifiedLineNumber);break;case hs.Deleted:D=p("deleteLine","- {0} original line {1}",L,e.originalLineNumber);break}return v.setAttribute("aria-label",D),v}_getLineHtml(e,t,i,n,o){const r=e.getLineContent(n),a=t.get(50),l=Pi.createEmpty(r,o),c=Zo.isBasicASCII(r,e.mightContainNonBasicASCII()),d=Zo.containsRTL(r,c,e.mightContainRTL());return Sx(new xh(a.isMonospace&&!t.get(33),a.canUseHalfwidthRightwardsArrow,r,!1,c,d,0,l,[],i,0,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,t.get(118),t.get(100),t.get(95),t.get(51)!==Ur.OFF,null)).html}};RR=fF([pF(5,ni)],RR);class tCe{constructor(e){this.editors=e}getOriginalModel(){return this.editors.original.getModel()}getOriginalOptions(){return this.editors.original.getOptions()}originalReveal(e){this.editors.original.revealRange(e),this.editors.original.setSelection(e),this.editors.original.focus()}getModifiedModel(){return this.editors.modified.getModel()}getModifiedOptions(){return this.editors.modified.getOptions()}modifiedReveal(e){e&&(this.editors.modified.revealRange(e),this.editors.modified.setSelection(e)),this.editors.modified.focus()}modifiedSetSelection(e){this.editors.modified.setSelection(e)}modifiedFocus(){this.editors.modified.focus()}getModifiedPosition(){return this.editors.modified.getPosition()??void 0}}E("diffEditor.move.border","#8b8b8b9c",p("diffEditor.move.border","The border color for text that got moved in the diff editor."));E("diffEditor.moveActive.border","#FFA500",p("diffEditor.moveActive.border","The active border color for text that got moved in the diff editor."));E("diffEditor.unchangedRegionShadow",{dark:"#000000",light:"#737373BF",hcDark:"#000000",hcLight:"#737373BF"},p("diffEditor.unchangedRegionShadow","The color of the shadow around unchanged region widgets."));const iCe=Kt("diff-insert",J.add,p("diffInsertIcon","Line decoration for inserts in the diff editor.")),aj=Kt("diff-remove",J.remove,p("diffRemoveIcon","Line decoration for removals in the diff editor.")),pS=We.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+Ie.asClassName(iCe),marginClassName:"gutter-insert"}),Ov=We.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+Ie.asClassName(aj),marginClassName:"gutter-delete"}),M9=We.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),A9=We.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),mS=We.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),mF=We.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),_F=We.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),jp=We.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),bF=We.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),vF=We.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"});var lj=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},MR=function(s,e){return function(t,i){e(t,i,s)}},Qh;const $C=Je("diffProviderFactoryService");let AR=class{constructor(e){this.instantiationService=e}createDiffProvider(e){return this.instantiationService.createInstance(PR,e)}};AR=lj([MR(0,ye)],AR);nt($C,AR,1);let PR=class{static{Qh=this}static{this.diffCache=new Map}constructor(e,t,i){this.editorWorkerService=t,this.telemetryService=i,this.onDidChangeEventEmitter=new O,this.onDidChange=this.onDidChangeEventEmitter.event,this.diffAlgorithm="advanced",this.diffAlgorithmOnDidChangeSubscription=void 0,this.setOptions(e)}dispose(){this.diffAlgorithmOnDidChangeSubscription?.dispose()}async computeDiff(e,t,i,n){if(typeof this.diffAlgorithm!="string")return this.diffAlgorithm.computeDiff(e,t,i,n);if(e.isDisposed()||t.isDisposed())return{changes:[],identical:!0,quitEarly:!1,moves:[]};if(e.getLineCount()===1&&e.getLineMaxColumn(1)===1)return t.getLineCount()===1&&t.getLineMaxColumn(1)===1?{changes:[],identical:!0,quitEarly:!1,moves:[]}:{changes:[new Vo(new He(1,2),new He(1,t.getLineCount()+1),[new No(e.getFullModelRange(),t.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};const o=JSON.stringify([e.uri.toString(),t.uri.toString()]),r=JSON.stringify([e.id,t.id,e.getAlternativeVersionId(),t.getAlternativeVersionId(),JSON.stringify(i)]),a=Qh.diffCache.get(o);if(a&&a.context===r)return a.result;const l=un.create(),c=await this.editorWorkerService.computeDiff(e.uri,t.uri,i,this.diffAlgorithm),d=l.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:d,timedOut:c?.quitEarly??!0,detectedMoves:i.computeMoves?c?.moves.length??0:-1}),n.isCancellationRequested)return{changes:[],identical:!1,quitEarly:!0,moves:[]};if(!c)throw new Error("no diff result available");return Qh.diffCache.size>10&&Qh.diffCache.delete(Qh.diffCache.keys().next().value),Qh.diffCache.set(o,{result:c,context:r}),c}setOptions(e){let t=!1;e.diffAlgorithm&&this.diffAlgorithm!==e.diffAlgorithm&&(this.diffAlgorithmOnDidChangeSubscription?.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=e.diffAlgorithm,typeof e.diffAlgorithm!="string"&&(this.diffAlgorithmOnDidChangeSubscription=e.diffAlgorithm.onDidChange(()=>this.onDidChangeEventEmitter.fire())),t=!0),t&&this.onDidChangeEventEmitter.fire()}};PR=Qh=lj([MR(1,Xs),MR(2,jn)],PR);function Ox(){return eT&&!!eT.VSCODE_DEV}function cj(s){if(Ox()){const e=nCe();return e.add(s),{dispose(){e.delete(s)}}}else return{dispose(){}}}function nCe(){ew||(ew=new Set);const s=globalThis;return s.$hotReload_applyNewExports||(s.$hotReload_applyNewExports=e=>{const t={config:{mode:void 0},...e},i=[];for(const n of ew){const o=n(t);o&&i.push(o)}if(i.length>0)return n=>{let o=!1;for(const r of i)r(n)&&(o=!0);return o}}),ew}let ew;Ox()&&cj(({oldExports:s,newSrc:e,config:t})=>{if(t.mode==="patch-prototype")return i=>{for(const n in i){const o=i[n];if(console.log(`[hot-reload] Patching prototype methods of '${n}'`,{exportedItem:o}),typeof o=="function"&&o.prototype){const r=s[n];if(r){for(const a of Object.getOwnPropertyNames(o.prototype)){const l=Object.getOwnPropertyDescriptor(o.prototype,a),c=Object.getOwnPropertyDescriptor(r.prototype,a);l?.value?.toString()!==c?.value?.toString()&&console.log(`[hot-reload] Patching prototype method '${n}.${a}'`),Object.defineProperty(r.prototype,a,l)}i[n]=r}}}return!0}});function so(s,e){return sCe([s],e),s}function sCe(s,e){Ox()&&En("reload",i=>cj(({oldExports:n})=>{if([...Object.values(n)].some(o=>s.includes(o)))return o=>(i(void 0),!0)})).read(e)}var oCe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},rCe=function(s,e){return function(t,i){e(t,i,s)}};let OR=class extends B{setActiveMovedText(e){this._activeMovedText.set(e,void 0)}constructor(e,t,i){super(),this.model=e,this._options=t,this._diffProviderFactoryService=i,this._isDiffUpToDate=Ze(this,!1),this.isDiffUpToDate=this._isDiffUpToDate,this._diff=Ze(this,void 0),this.diff=this._diff,this._unchangedRegions=Ze(this,void 0),this.unchangedRegions=_e(this,a=>this._options.hideUnchangedRegions.read(a)?this._unchangedRegions.read(a)?.regions??[]:(ai(l=>{for(const c of this._unchangedRegions.get()?.regions||[])c.collapseAll(l)}),[])),this.movedTextToCompare=Ze(this,void 0),this._activeMovedText=Ze(this,void 0),this._hoveredMovedText=Ze(this,void 0),this.activeMovedText=_e(this,a=>this.movedTextToCompare.read(a)??this._hoveredMovedText.read(a)??this._activeMovedText.read(a)),this._cancellationTokenSource=new li,this._diffProvider=_e(this,a=>{const l=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:this._options.diffAlgorithm.read(a)}),c=En("onDidChange",l.onDidChange);return{diffProvider:l,onChangeSignal:c}}),this._register(Ce(()=>this._cancellationTokenSource.cancel()));const n=km("contentChangedSignal"),o=this._register(new It(()=>n.trigger(void 0),200));this._register(Pe(a=>{const l=this._unchangedRegions.read(a);if(!l||l.regions.some(f=>f.isDragged.read(a)))return;const c=l.originalDecorationIds.map(f=>e.original.getDecorationRange(f)).map(f=>f?He.fromRangeInclusive(f):void 0),d=l.modifiedDecorationIds.map(f=>e.modified.getDecorationRange(f)).map(f=>f?He.fromRangeInclusive(f):void 0),h=l.regions.map((f,m)=>!c[m]||!d[m]?void 0:new Wd(c[m].startLineNumber,d[m].startLineNumber,c[m].length,f.visibleLineCountTop.read(a),f.visibleLineCountBottom.read(a))).filter(Sl),u=[];let g=!1;for(const f of SP(h,(m,_)=>m.getHiddenModifiedRange(a).endLineNumberExclusive===_.getHiddenModifiedRange(a).startLineNumber))if(f.length>1){g=!0;const m=f.reduce((b,v)=>b+v.lineCount,0),_=new Wd(f[0].originalLineNumber,f[0].modifiedLineNumber,m,f[0].visibleLineCountTop.get(),f[f.length-1].visibleLineCountBottom.get());u.push(_)}else u.push(f[0]);if(g){const f=e.original.deltaDecorations(l.originalDecorationIds,u.map(_=>({range:_.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),m=e.modified.deltaDecorations(l.modifiedDecorationIds,u.map(_=>({range:_.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));ai(_=>{this._unchangedRegions.set({regions:u,originalDecorationIds:f,modifiedDecorationIds:m},_)})}}));const r=(a,l,c)=>{const d=Wd.fromDiffs(a.changes,e.original.getLineCount(),e.modified.getLineCount(),this._options.hideUnchangedRegionsMinimumLineCount.read(c),this._options.hideUnchangedRegionsContextLineCount.read(c));let h;const u=this._unchangedRegions.get();if(u){const _=u.originalDecorationIds.map(y=>e.original.getDecorationRange(y)).map(y=>y?He.fromRangeInclusive(y):void 0),b=u.modifiedDecorationIds.map(y=>e.modified.getDecorationRange(y)).map(y=>y?He.fromRangeInclusive(y):void 0);let C=$ve(u.regions.map((y,w)=>{if(!_[w]||!b[w])return;const x=_[w].length;return new Wd(_[w].startLineNumber,b[w].startLineNumber,x,Math.min(y.visibleLineCountTop.get(),x),Math.min(y.visibleLineCountBottom.get(),x-y.visibleLineCountTop.get()))}).filter(Sl),(y,w)=>!w||y.modifiedLineNumber>=w.modifiedLineNumber+w.lineCount&&y.originalLineNumber>=w.originalLineNumber+w.lineCount).map(y=>new is(y.getHiddenOriginalRange(c),y.getHiddenModifiedRange(c)));C=is.clip(C,He.ofLength(1,e.original.getLineCount()),He.ofLength(1,e.modified.getLineCount())),h=is.inverse(C,e.original.getLineCount(),e.modified.getLineCount())}const g=[];if(h)for(const _ of d){const b=h.filter(v=>v.original.intersectsStrict(_.originalUnchangedRange)&&v.modified.intersectsStrict(_.modifiedUnchangedRange));g.push(..._.setVisibleRanges(b,l))}else g.push(...d);const f=e.original.deltaDecorations(u?.originalDecorationIds||[],g.map(_=>({range:_.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),m=e.modified.deltaDecorations(u?.modifiedDecorationIds||[],g.map(_=>({range:_.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));this._unchangedRegions.set({regions:g,originalDecorationIds:f,modifiedDecorationIds:m},l)};this._register(e.modified.onDidChangeContent(a=>{if(this._diff.get()){const c=Lc.fromModelContentChanges(a.changes);this._lastDiff,e.original,e.modified}this._isDiffUpToDate.set(!1,void 0),o.schedule()})),this._register(e.original.onDidChangeContent(a=>{if(this._diff.get()){const c=Lc.fromModelContentChanges(a.changes);this._lastDiff,e.original,e.modified}this._isDiffUpToDate.set(!1,void 0),o.schedule()})),this._register(Us(async(a,l)=>{this._options.hideUnchangedRegionsMinimumLineCount.read(a),this._options.hideUnchangedRegionsContextLineCount.read(a),o.cancel(),n.read(a);const c=this._diffProvider.read(a);c.onChangeSignal.read(a),so(MV,a),so(CE,a),this._isDiffUpToDate.set(!1,void 0);let d=[];l.add(e.original.onDidChangeContent(g=>{const f=Lc.fromModelContentChanges(g.changes);d=M0(d,f)}));let h=[];l.add(e.modified.onDidChangeContent(g=>{const f=Lc.fromModelContentChanges(g.changes);h=M0(h,f)}));let u=await c.diffProvider.computeDiff(e.original,e.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(a),maxComputationTimeMs:this._options.maxComputationTimeMs.read(a),computeMoves:this._options.showMoves.read(a)},this._cancellationTokenSource.token);this._cancellationTokenSource.token.isCancellationRequested||e.original.isDisposed()||e.modified.isDisposed()||(u=aCe(u,e.original,e.modified),u=(e.original,e.modified,void 0)??u,u=(e.original,e.modified,void 0)??u,ai(g=>{r(u,g),this._lastDiff=u;const f=CF.fromDiffResult(u);this._diff.set(f,g),this._isDiffUpToDate.set(!0,g);const m=this.movedTextToCompare.get();this.movedTextToCompare.set(m?this._lastDiff.moves.find(_=>_.lineRangeMapping.modified.intersect(m.lineRangeMapping.modified)):void 0,g)}))}))}ensureModifiedLineIsVisible(e,t,i){if(this.diff.get()?.mappings.length===0)return;const n=this._unchangedRegions.get()?.regions||[];for(const o of n)if(o.getHiddenModifiedRange(void 0).contains(e)){o.showModifiedLine(e,t,i);return}}ensureOriginalLineIsVisible(e,t,i){if(this.diff.get()?.mappings.length===0)return;const n=this._unchangedRegions.get()?.regions||[];for(const o of n)if(o.getHiddenOriginalRange(void 0).contains(e)){o.showOriginalLine(e,t,i);return}}async waitForDiff(){await Xz(this.isDiffUpToDate,e=>e)}serializeState(){return{collapsedRegions:this._unchangedRegions.get()?.regions.map(t=>({range:t.getHiddenModifiedRange(void 0).serialize()}))}}restoreSerializedState(e){const t=e.collapsedRegions?.map(n=>He.deserialize(n.range)),i=this._unchangedRegions.get();!i||!t||ai(n=>{for(const o of i.regions)for(const r of t)if(o.modifiedUnchangedRange.intersect(r)){o.setHiddenModifiedRange(r,n);break}})}};OR=oCe([rCe(2,$C)],OR);function aCe(s,e,t){return{changes:s.changes.map(i=>new Vo(i.original,i.modified,i.innerChanges?i.innerChanges.map(n=>lCe(n,e,t)):void 0)),moves:s.moves,identical:s.identical,quitEarly:s.quitEarly}}function lCe(s,e,t){let i=s.originalRange,n=s.modifiedRange;return i.startColumn===1&&n.startColumn===1&&(i.endColumn!==1||n.endColumn!==1)&&i.endColumn===e.getLineMaxColumn(i.endLineNumber)&&n.endColumn===t.getLineMaxColumn(n.endLineNumber)&&i.endLineNumber<e.getLineCount()&&n.endLineNumber<t.getLineCount()&&(i=i.setEndPosition(i.endLineNumber+1,1),n=n.setEndPosition(n.endLineNumber+1,1)),new No(i,n)}class CF{static fromDiffResult(e){return new CF(e.changes.map(t=>new dj(t)),e.moves||[],e.identical,e.quitEarly)}constructor(e,t,i,n){this.mappings=e,this.movedTexts=t,this.identical=i,this.quitEarly=n}}class dj{constructor(e){this.lineRangeMapping=e}}class Wd{static fromDiffs(e,t,i,n,o){const r=Vo.inverse(e,t,i),a=[];for(const l of r){let c=l.original.startLineNumber,d=l.modified.startLineNumber,h=l.original.length;const u=c===1&&d===1,g=c+h===t+1&&d+h===i+1;(u||g)&&h>=o+n?(u&&!g&&(h-=o),g&&!u&&(c+=o,d+=o,h-=o),a.push(new Wd(c,d,h,0,0))):h>=o*2+n&&(c+=o,d+=o,h-=o*2,a.push(new Wd(c,d,h,0,0)))}return a}get originalUnchangedRange(){return He.ofLength(this.originalLineNumber,this.lineCount)}get modifiedUnchangedRange(){return He.ofLength(this.modifiedLineNumber,this.lineCount)}constructor(e,t,i,n,o){this.originalLineNumber=e,this.modifiedLineNumber=t,this.lineCount=i,this._visibleLineCountTop=Ze(this,0),this.visibleLineCountTop=this._visibleLineCountTop,this._visibleLineCountBottom=Ze(this,0),this.visibleLineCountBottom=this._visibleLineCountBottom,this._shouldHideControls=_e(this,l=>this.visibleLineCountTop.read(l)+this.visibleLineCountBottom.read(l)===this.lineCount&&!this.isDragged.read(l)),this.isDragged=Ze(this,void 0);const r=Math.max(Math.min(n,this.lineCount),0),a=Math.max(Math.min(o,this.lineCount-n),0);Y5(n===r),Y5(o===a),this._visibleLineCountTop.set(r,void 0),this._visibleLineCountBottom.set(a,void 0)}setVisibleRanges(e,t){const i=[],n=new dr(e.map(l=>l.modified)).subtractFrom(this.modifiedUnchangedRange);let o=this.originalLineNumber,r=this.modifiedLineNumber;const a=this.modifiedLineNumber+this.lineCount;if(n.ranges.length===0)this.showAll(t),i.push(this);else{let l=0;for(const c of n.ranges){const d=l===n.ranges.length-1;l++;const h=(d?a:c.endLineNumberExclusive)-r,u=new Wd(o,r,h,0,0);u.setHiddenModifiedRange(c,t),i.push(u),o=u.originalUnchangedRange.endLineNumberExclusive,r=u.modifiedUnchangedRange.endLineNumberExclusive}}return i}shouldHideControls(e){return this._shouldHideControls.read(e)}getHiddenOriginalRange(e){return He.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}getHiddenModifiedRange(e){return He.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}setHiddenModifiedRange(e,t){const i=e.startLineNumber-this.modifiedLineNumber,n=this.modifiedLineNumber+this.lineCount-e.endLineNumberExclusive;this.setState(i,n,t)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(e=10,t){const i=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+e,i),t)}showMoreBelow(e=10,t){const i=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+e,i),t)}showAll(e){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),e)}showModifiedLine(e,t,i){const n=e+1-(this.modifiedLineNumber+this._visibleLineCountTop.get()),o=this.modifiedLineNumber-this._visibleLineCountBottom.get()+this.lineCount-e;t===0&&n<o||t===1?this._visibleLineCountTop.set(this._visibleLineCountTop.get()+n,i):this._visibleLineCountBottom.set(this._visibleLineCountBottom.get()+o,i)}showOriginalLine(e,t,i){const n=e-this.originalLineNumber,o=this.originalLineNumber+this.lineCount-e;t===0&&n<o||t===1?this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+o-n,this.getMaxVisibleLineCountTop()),i):this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+n-o,this.getMaxVisibleLineCountBottom()),i)}collapseAll(e){this._visibleLineCountTop.set(0,e),this._visibleLineCountBottom.set(0,e)}setState(e,t,i){e=Math.max(Math.min(e,this.lineCount),0),t=Math.max(Math.min(t,this.lineCount-e),0),this._visibleLineCountTop.set(e,i),this._visibleLineCountBottom.set(t,i)}}class cCe extends B{get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}constructor(e,t,i,n,o,r,a,l,c){super(),this._getViewZoneId=e,this._marginDomNode=t,this._modifiedEditor=i,this._diff=n,this._editor=o,this._viewLineCounts=r,this._originalTextModel=a,this._contextMenuService=l,this._clipboardService=c,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=Ie.asClassName(J.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const d=this._modifiedEditor.getOption(67);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${d}px`,this._diffActions.style.lineHeight=`${d}px`,this._marginDomNode.appendChild(this._diffActions);let h=0;const u=i.getOption(128)&&!Oa,g=(f,m)=>{this._contextMenuService.showContextMenu({domForShadowRoot:u?i.getDomNode()??void 0:void 0,getAnchor:()=>({x:f,y:m}),getActions:()=>{const _=[],b=n.modified.isEmpty;return _.push(new ho("diff.clipboard.copyDeletedContent",b?n.original.length>1?p("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):p("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):n.original.length>1?p("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):p("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,async()=>{const C=this._originalTextModel.getValueInRange(n.original.toExclusiveRange());await this._clipboardService.writeText(C)})),n.original.length>1&&_.push(new ho("diff.clipboard.copyDeletedLineContent",b?p("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",n.original.startLineNumber+h):p("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",n.original.startLineNumber+h),void 0,!0,async()=>{let C=this._originalTextModel.getLineContent(n.original.startLineNumber+h);C===""&&(C=this._originalTextModel.getEndOfLineSequence()===0?`
`:`\r
`),await this._clipboardService.writeText(C)})),i.getOption(92)||_.push(new ho("diff.inline.revertChange",p("diff.inline.revertChange.label","Revert this change"),void 0,!0,async()=>{this._editor.revert(this._diff)})),_},autoSelectFirstItem:!0})};this._register(gi(this._diffActions,"mousedown",f=>{if(!f.leftButton)return;const{top:m,height:_}=Si(this._diffActions),b=Math.floor(d/3);f.preventDefault(),g(f.posx,m+_+b)})),this._register(i.onMouseMove(f=>{(f.target.type===8||f.target.type===5)&&f.target.detail.viewZoneId===this._getViewZoneId()?(h=this._updateLightBulbPosition(this._marginDomNode,f.event.browserEvent.y,d),this.visibility=!0):this.visibility=!1})),this._register(i.onMouseDown(f=>{f.event.leftButton&&(f.target.type===8||f.target.type===5)&&f.target.detail.viewZoneId===this._getViewZoneId()&&(f.event.preventDefault(),h=this._updateLightBulbPosition(this._marginDomNode,f.event.browserEvent.y,d),g(f.event.posx,f.event.posy+d))}))}_updateLightBulbPosition(e,t,i){const{top:n}=Si(e),o=t-n,r=Math.floor(o/i),a=r*i;if(this._diffActions.style.top=`${a}px`,this._viewLineCounts){let l=0;for(let c=0;c<this._viewLineCounts.length;c++)if(l+=this._viewLineCounts[c],r<l)return c}return r}}const P9=Gc("diffEditorWidget",{createHTML:s=>s});function dCe(s,e,t,i){wn(i,e.fontInfo);const n=t.length>0,o=new vm(1e4);let r=0,a=0;const l=[];for(let u=0;u<s.lineTokens.length;u++){const g=u+1,f=s.lineTokens[u],m=s.lineBreakData[u],_=ms.filter(t,g,1,Number.MAX_SAFE_INTEGER);if(m){let b=0;for(const v of m.breakOffsets){const C=f.sliceAndInflate(b,v,0);r=Math.max(r,O9(a,C,ms.extractWrapped(_,b,v),n,s.mightContainNonBasicASCII,s.mightContainRTL,e,o)),a++,b=v}l.push(m.breakOffsets.length)}else l.push(1),r=Math.max(r,O9(a,f,_,n,s.mightContainNonBasicASCII,s.mightContainRTL,e,o)),a++}r+=e.scrollBeyondLastColumn;const c=o.build(),d=P9?P9.createHTML(c):c;i.innerHTML=d;const h=r*e.typicalHalfwidthCharacterWidth;return{heightInLines:a,minWidthInPx:h,viewLineCounts:l}}class hCe{constructor(e,t,i,n){this.lineTokens=e,this.lineBreakData=t,this.mightContainNonBasicASCII=i,this.mightContainRTL=n}}class yF{static fromEditor(e){const t=e.getOptions(),i=t.get(50),n=t.get(146);return new yF(e.getModel()?.getOptions().tabSize||0,i,t.get(33),i.typicalHalfwidthCharacterWidth,t.get(105),t.get(67),n.decorationsWidth,t.get(118),t.get(100),t.get(95),t.get(51))}constructor(e,t,i,n,o,r,a,l,c,d,h){this.tabSize=e,this.fontInfo=t,this.disableMonospaceOptimizations=i,this.typicalHalfwidthCharacterWidth=n,this.scrollBeyondLastColumn=o,this.lineHeight=r,this.lineDecorationsWidth=a,this.stopRenderingLineAfter=l,this.renderWhitespace=c,this.renderControlCharacters=d,this.fontLigatures=h}}function O9(s,e,t,i,n,o,r,a){a.appendString('<div class="view-line'),i||a.appendString(" char-delete"),a.appendString('" style="top:'),a.appendString(String(s*r.lineHeight)),a.appendString('px;width:1000000px;">');const l=e.getLineContent(),c=Zo.isBasicASCII(l,n),d=Zo.containsRTL(l,c,o),h=zC(new xh(r.fontInfo.isMonospace&&!r.disableMonospaceOptimizations,r.fontInfo.canUseHalfwidthRightwardsArrow,l,!1,c,d,0,e,t,r.tabSize,0,r.fontInfo.spaceWidth,r.fontInfo.middotWidth,r.fontInfo.wsmiddotWidth,r.stopRenderingLineAfter,r.renderWhitespace,r.renderControlCharacters,r.fontLigatures!==Ur.OFF,null),a);return a.appendString("</div>"),h.characterMapping.getHorizontalOffset(h.characterMapping.length)}var uCe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},F9=function(s,e){return function(t,i){e(t,i,s)}};let FR=class extends B{constructor(e,t,i,n,o,r,a,l,c,d){super(),this._targetWindow=e,this._editors=t,this._diffModel=i,this._options=n,this._diffEditorWidget=o,this._canIgnoreViewZoneUpdateEvent=r,this._origViewZonesToIgnore=a,this._modViewZonesToIgnore=l,this._clipboardService=c,this._contextMenuService=d,this._originalTopPadding=Ze(this,0),this._originalScrollOffset=Ze(this,0),this._originalScrollOffsetAnimated=E9(this._targetWindow,this._originalScrollOffset,this._store),this._modifiedTopPadding=Ze(this,0),this._modifiedScrollOffset=Ze(this,0),this._modifiedScrollOffsetAnimated=E9(this._targetWindow,this._modifiedScrollOffset,this._store);const h=Ze("invalidateAlignmentsState",0),u=this._register(new It(()=>{h.set(h.get()+1,void 0)},0));this._register(this._editors.original.onDidChangeViewZones(C=>{this._canIgnoreViewZoneUpdateEvent()||u.schedule()})),this._register(this._editors.modified.onDidChangeViewZones(C=>{this._canIgnoreViewZoneUpdateEvent()||u.schedule()})),this._register(this._editors.original.onDidChangeConfiguration(C=>{(C.hasChanged(147)||C.hasChanged(67))&&u.schedule()})),this._register(this._editors.modified.onDidChangeConfiguration(C=>{(C.hasChanged(147)||C.hasChanged(67))&&u.schedule()}));const g=this._diffModel.map(C=>C?kt(this,C.model.original.onDidChangeTokens,()=>C.model.original.tokenization.backgroundTokenizationState===2):void 0).map((C,y)=>C?.read(y)),f=_e(C=>{const y=this._diffModel.read(C),w=y?.diff.read(C);if(!y||!w)return null;h.read(C);const L=this._options.renderSideBySide.read(C);return B9(this._editors.original,this._editors.modified,w.mappings,this._origViewZonesToIgnore,this._modViewZonesToIgnore,L)}),m=_e(C=>{const y=this._diffModel.read(C)?.movedTextToCompare.read(C);if(!y)return null;h.read(C);const w=y.changes.map(x=>new dj(x));return B9(this._editors.original,this._editors.modified,w,this._origViewZonesToIgnore,this._modViewZonesToIgnore,!0)});function _(){const C=document.createElement("div");return C.className="diagonal-fill",C}const b=this._register(new Z);this.viewZones=wh(this,(C,y)=>{b.clear();const w=f.read(C)||[],x=[],L=[],D=this._modifiedTopPadding.read(C);D>0&&L.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:D,showInHiddenAreas:!0,suppressMouseDown:!0});const T=this._originalTopPadding.read(C);T>0&&x.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:T,showInHiddenAreas:!0,suppressMouseDown:!0});const F=this._options.renderSideBySide.read(C),W=F?void 0:this._editors.modified._getViewModel()?.createLineBreaksComputer();if(W){const oe=this._editors.original.getModel();for(const be of w)if(be.diff)for(let xe=be.originalRange.startLineNumber;xe<be.originalRange.endLineNumberExclusive;xe++){if(xe>oe.getLineCount())return{orig:x,mod:L};W?.addRequest(oe.getLineContent(xe),null,null)}}const H=W?.finalize()??[];let $=0;const V=this._editors.modified.getOption(67),Y=this._diffModel.read(C)?.movedTextToCompare.read(C),ie=this._editors.original.getModel()?.mightContainNonBasicASCII()??!1,ue=this._editors.original.getModel()?.mightContainRTL()??!1,fe=yF.fromEditor(this._editors.modified);for(const oe of w)if(oe.diff&&!F&&(!this._options.useTrueInlineDiffRendering.read(C)||!wF(oe.diff))){if(!oe.originalRange.isEmpty){g.read(C);const xe=document.createElement("div");xe.classList.add("view-lines","line-delete","monaco-mouse-cursor-text");const wt=this._editors.original.getModel();if(oe.originalRange.endLineNumberExclusive-1>wt.getLineCount())return{orig:x,mod:L};const pt=new hCe(oe.originalRange.mapToLineArray(ei=>wt.tokenization.getLineTokens(ei)),oe.originalRange.mapToLineArray(ei=>H[$++]),ie,ue),Et=[];for(const ei of oe.diff.innerChanges||[])Et.push(new db(ei.originalRange.delta(-(oe.diff.original.startLineNumber-1)),jp.className,0));const Ei=dCe(pt,fe,Et,xe),Fi=document.createElement("div");if(Fi.className="inline-deleted-margin-view-zone",wn(Fi,fe.fontInfo),this._options.renderIndicators.read(C))for(let ei=0;ei<Ei.heightInLines;ei++){const wo=document.createElement("div");wo.className=`delete-sign ${Ie.asClassName(aj)}`,wo.setAttribute("style",`position:absolute;top:${ei*V}px;width:${fe.lineDecorationsWidth}px;height:${V}px;right:0;`),Fi.appendChild(wo)}let Fn;b.add(new cCe(()=>Id(Fn),Fi,this._editors.modified,oe.diff,this._diffEditorWidget,Ei.viewLineCounts,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let ei=0;ei<Ei.viewLineCounts.length;ei++){const wo=Ei.viewLineCounts[ei];wo>1&&x.push({afterLineNumber:oe.originalRange.startLineNumber+ei,domNode:_(),heightInPx:(wo-1)*V,showInHiddenAreas:!0,suppressMouseDown:!0})}L.push({afterLineNumber:oe.modifiedRange.startLineNumber-1,domNode:xe,heightInPx:Ei.heightInLines*V,minWidthInPx:Ei.minWidthInPx,marginDomNode:Fi,setZoneId(ei){Fn=ei},showInHiddenAreas:!0,suppressMouseDown:!0})}const be=document.createElement("div");be.className="gutter-delete",x.push({afterLineNumber:oe.originalRange.endLineNumberExclusive-1,domNode:_(),heightInPx:oe.modifiedHeightInPx,marginDomNode:be,showInHiddenAreas:!0,suppressMouseDown:!0})}else{const be=oe.modifiedHeightInPx-oe.originalHeightInPx;if(be>0){if(Y?.lineRangeMapping.original.delta(-1).deltaLength(2).contains(oe.originalRange.endLineNumberExclusive-1))continue;x.push({afterLineNumber:oe.originalRange.endLineNumberExclusive-1,domNode:_(),heightInPx:be,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let xe=function(){const pt=document.createElement("div");return pt.className="arrow-revert-change "+Ie.asClassName(J.arrowRight),y.add(U(pt,"mousedown",Et=>Et.stopPropagation())),y.add(U(pt,"click",Et=>{Et.stopPropagation(),o.revert(oe.diff)})),te("div",{},pt)};if(Y?.lineRangeMapping.modified.delta(-1).deltaLength(2).contains(oe.modifiedRange.endLineNumberExclusive-1))continue;let wt;oe.diff&&oe.diff.modified.isEmpty&&this._options.shouldRenderOldRevertArrows.read(C)&&(wt=xe()),L.push({afterLineNumber:oe.modifiedRange.endLineNumberExclusive-1,domNode:_(),heightInPx:-be,marginDomNode:wt,showInHiddenAreas:!0,suppressMouseDown:!0})}}for(const oe of m.read(C)??[]){if(!Y?.lineRangeMapping.original.intersect(oe.originalRange)||!Y?.lineRangeMapping.modified.intersect(oe.modifiedRange))continue;const be=oe.modifiedHeightInPx-oe.originalHeightInPx;be>0?x.push({afterLineNumber:oe.originalRange.endLineNumberExclusive-1,domNode:_(),heightInPx:be,showInHiddenAreas:!0,suppressMouseDown:!0}):L.push({afterLineNumber:oe.modifiedRange.endLineNumberExclusive-1,domNode:_(),heightInPx:-be,showInHiddenAreas:!0,suppressMouseDown:!0})}return{orig:x,mod:L}});let v=!1;this._register(this._editors.original.onDidScrollChange(C=>{C.scrollLeftChanged&&!v&&(v=!0,this._editors.modified.setScrollLeft(C.scrollLeft),v=!1)})),this._register(this._editors.modified.onDidScrollChange(C=>{C.scrollLeftChanged&&!v&&(v=!0,this._editors.original.setScrollLeft(C.scrollLeft),v=!1)})),this._originalScrollTop=kt(this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=kt(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._register(Pe(C=>{const y=this._originalScrollTop.read(C)-(this._originalScrollOffsetAnimated.get()-this._modifiedScrollOffsetAnimated.read(C))-(this._originalTopPadding.get()-this._modifiedTopPadding.read(C));y!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(y,1)})),this._register(Pe(C=>{const y=this._modifiedScrollTop.read(C)-(this._modifiedScrollOffsetAnimated.get()-this._originalScrollOffsetAnimated.read(C))-(this._modifiedTopPadding.get()-this._originalTopPadding.read(C));y!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(y,1)})),this._register(Pe(C=>{const y=this._diffModel.read(C)?.movedTextToCompare.read(C);let w=0;if(y){const x=this._editors.original.getTopForLineNumber(y.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.get();w=this._editors.modified.getTopForLineNumber(y.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.get()-x}w>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(w,void 0)):w<0?(this._modifiedTopPadding.set(-w,void 0),this._originalTopPadding.set(0,void 0)):setTimeout(()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)},400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.get()-w,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.get()+w,void 0,!0)}))}};FR=uCe([F9(8,Jc),F9(9,bo)],FR);function B9(s,e,t,i,n,o){const r=new Oc(W9(s,i)),a=new Oc(W9(e,n)),l=s.getOption(67),c=e.getOption(67),d=[];let h=0,u=0;function g(f,m){for(;;){let _=r.peek(),b=a.peek();if(_&&_.lineNumber>=f&&(_=void 0),b&&b.lineNumber>=m&&(b=void 0),!_&&!b)break;const v=_?_.lineNumber-h:Number.MAX_VALUE,C=b?b.lineNumber-u:Number.MAX_VALUE;v<C?(r.dequeue(),b={lineNumber:_.lineNumber-h+u,heightInPx:0}):v>C?(a.dequeue(),_={lineNumber:b.lineNumber-u+h,heightInPx:0}):(r.dequeue(),a.dequeue()),d.push({originalRange:He.ofLength(_.lineNumber,1),modifiedRange:He.ofLength(b.lineNumber,1),originalHeightInPx:l+_.heightInPx,modifiedHeightInPx:c+b.heightInPx,diff:void 0})}}for(const f of t){let C=function(y,w,x=!1){if(y<v||w<b)return;if(_)_=!1;else if(!x&&(y===v||w===b))return;const L=new He(v,y),D=new He(b,w);if(L.isEmpty&&D.isEmpty)return;const T=r.takeWhile(W=>W.lineNumber<y)?.reduce((W,H)=>W+H.heightInPx,0)??0,F=a.takeWhile(W=>W.lineNumber<w)?.reduce((W,H)=>W+H.heightInPx,0)??0;d.push({originalRange:L,modifiedRange:D,originalHeightInPx:L.length*l+T,modifiedHeightInPx:D.length*c+F,diff:f.lineRangeMapping}),v=y,b=w};const m=f.lineRangeMapping;g(m.original.startLineNumber,m.modified.startLineNumber);let _=!0,b=m.modified.startLineNumber,v=m.original.startLineNumber;if(o)for(const y of m.innerChanges||[]){y.originalRange.startColumn>1&&y.modifiedRange.startColumn>1&&C(y.originalRange.startLineNumber,y.modifiedRange.startLineNumber);const w=s.getModel(),x=y.originalRange.endLineNumber<=w.getLineCount()?w.getLineMaxColumn(y.originalRange.endLineNumber):Number.MAX_SAFE_INTEGER;y.originalRange.endColumn<x&&C(y.originalRange.endLineNumber,y.modifiedRange.endLineNumber)}C(m.original.endLineNumberExclusive,m.modified.endLineNumberExclusive,!0),h=m.original.endLineNumberExclusive,u=m.modified.endLineNumberExclusive}return g(Number.MAX_VALUE,Number.MAX_VALUE),d}function W9(s,e){const t=[],i=[],n=s.getOption(147).wrappingColumn!==-1,o=s._getViewModel().coordinatesConverter,r=s.getOption(67);if(n)for(let l=1;l<=s.getModel().getLineCount();l++){const c=o.getModelLineViewLineCount(l);c>1&&i.push({lineNumber:l,heightInPx:r*(c-1)})}for(const l of s.getWhitespaces()){if(e.has(l.id))continue;const c=l.afterLineNumber===0?0:o.convertViewPositionToModelPosition(new P(l.afterLineNumber,1)).lineNumber;t.push({lineNumber:c,heightInPx:l.height})}return Wve(t,i,l=>l.lineNumber,(l,c)=>({lineNumber:l.lineNumber,heightInPx:l.heightInPx+c.heightInPx}))}function wF(s){return s.innerChanges?s.innerChanges.every(e=>H9(e.modifiedRange)&&H9(e.originalRange)||e.originalRange.equalsRange(new k(1,1,1,1))):!1}function H9(s){return s.startLineNumber===s.endLineNumber}class Ou extends B{static{this.movedCodeBlockPadding=4}constructor(e,t,i,n,o){super(),this._rootElement=e,this._diffModel=t,this._originalEditorLayoutInfo=i,this._modifiedEditorLayoutInfo=n,this._editors=o,this._originalScrollTop=kt(this,this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=kt(this,this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._viewZonesChanged=En("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this.width=Ze(this,0),this._modifiedViewZonesChangedSignal=En("modified.onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this._originalViewZonesChangedSignal=En("original.onDidChangeViewZones",this._editors.original.onDidChangeViewZones),this._state=wh(this,(d,h)=>{this._element.replaceChildren();const u=this._diffModel.read(d),g=u?.diff.read(d)?.movedTexts;if(!g||g.length===0){this.width.set(0,void 0);return}this._viewZonesChanged.read(d);const f=this._originalEditorLayoutInfo.read(d),m=this._modifiedEditorLayoutInfo.read(d);if(!f||!m){this.width.set(0,void 0);return}this._modifiedViewZonesChangedSignal.read(d),this._originalViewZonesChangedSignal.read(d);const _=g.map(L=>{function D(ue,fe){const oe=fe.getTopForLineNumber(ue.startLineNumber,!0),be=fe.getTopForLineNumber(ue.endLineNumberExclusive,!0);return(oe+be)/2}const T=D(L.lineRangeMapping.original,this._editors.original),F=this._originalScrollTop.read(d),W=D(L.lineRangeMapping.modified,this._editors.modified),H=this._modifiedScrollTop.read(d),$=T-F,V=W-H,Y=Math.min(T,W),ie=Math.max(T,W);return{range:new qe(Y,ie),from:$,to:V,fromWithoutScroll:T,toWithoutScroll:W,move:L}});_.sort(cQ(bs(L=>L.fromWithoutScroll>L.toWithoutScroll,dQ),bs(L=>L.fromWithoutScroll>L.toWithoutScroll?L.fromWithoutScroll:-L.toWithoutScroll,qr)));const b=SF.compute(_.map(L=>L.range)),v=10,C=f.verticalScrollbarWidth,y=(b.getTrackCount()-1)*10+v*2,w=C+y+(m.contentLeft-Ou.movedCodeBlockPadding);let x=0;for(const L of _){const D=b.getTrack(x),T=C+v+D*10,F=15,W=15,H=w,$=m.glyphMarginWidth+m.lineNumbersWidth,V=18,Y=document.createElementNS("http://www.w3.org/2000/svg","rect");Y.classList.add("arrow-rectangle"),Y.setAttribute("x",`${H-$}`),Y.setAttribute("y",`${L.to-V/2}`),Y.setAttribute("width",`${$}`),Y.setAttribute("height",`${V}`),this._element.appendChild(Y);const ie=document.createElementNS("http://www.w3.org/2000/svg","g"),ue=document.createElementNS("http://www.w3.org/2000/svg","path");ue.setAttribute("d",`M 0 ${L.from} L ${T} ${L.from} L ${T} ${L.to} L ${H-W} ${L.to}`),ue.setAttribute("fill","none"),ie.appendChild(ue);const fe=document.createElementNS("http://www.w3.org/2000/svg","polygon");fe.classList.add("arrow"),h.add(Pe(oe=>{ue.classList.toggle("currentMove",L.move===u.activeMovedText.read(oe)),fe.classList.toggle("currentMove",L.move===u.activeMovedText.read(oe))})),fe.setAttribute("points",`${H-W},${L.to-F/2} ${H},${L.to} ${H-W},${L.to+F/2}`),ie.appendChild(fe),this._element.appendChild(ie),x++}this.width.set(y,void 0)}),this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(this._element),this._register(Ce(()=>this._element.remove())),this._register(Pe(d=>{const h=this._originalEditorLayoutInfo.read(d),u=this._modifiedEditorLayoutInfo.read(d);!h||!u||(this._element.style.left=`${h.width-h.verticalScrollbarWidth}px`,this._element.style.height=`${h.height}px`,this._element.style.width=`${h.verticalScrollbarWidth+h.contentLeft-Ou.movedCodeBlockPadding+this.width.read(d)}px`)})),this._register(Dm(this._state));const r=_e(d=>{const u=this._diffModel.read(d)?.diff.read(d);return u?u.movedTexts.map(g=>({move:g,original:new Of(fr(g.lineRangeMapping.original.startLineNumber-1),18),modified:new Of(fr(g.lineRangeMapping.modified.startLineNumber-1),18)})):[]});this._register(gS(this._editors.original,r.map(d=>d.map(h=>h.original)))),this._register(gS(this._editors.modified,r.map(d=>d.map(h=>h.modified)))),this._register(Us((d,h)=>{const u=r.read(d);for(const g of u)h.add(new V9(this._editors.original,g.original,g.move,"original",this._diffModel.get())),h.add(new V9(this._editors.modified,g.modified,g.move,"modified",this._diffModel.get()))}));const a=En("original.onDidFocusEditorWidget",d=>this._editors.original.onDidFocusEditorWidget(()=>setTimeout(()=>d(void 0),0))),l=En("modified.onDidFocusEditorWidget",d=>this._editors.modified.onDidFocusEditorWidget(()=>setTimeout(()=>d(void 0),0)));let c="modified";this._register(AC({createEmptyChangeSummary:()=>{},handleChange:(d,h)=>(d.didChange(a)&&(c="original"),d.didChange(l)&&(c="modified"),!0)},d=>{a.read(d),l.read(d);const h=this._diffModel.read(d);if(!h)return;const u=h.diff.read(d);let g;if(u&&c==="original"){const f=this._editors.originalCursor.read(d);f&&(g=u.movedTexts.find(m=>m.lineRangeMapping.original.contains(f.lineNumber)))}if(u&&c==="modified"){const f=this._editors.modifiedCursor.read(d);f&&(g=u.movedTexts.find(m=>m.lineRangeMapping.modified.contains(f.lineNumber)))}g!==h.movedTextToCompare.get()&&h.movedTextToCompare.set(void 0,void 0),h.setActiveMovedText(g)}))}}class SF{static compute(e){const t=[],i=[];for(const n of e){let o=t.findIndex(r=>!r.intersectsStrict(n));o===-1&&(t.length>=6?o=Zne(t,bs(a=>a.intersectWithRangeLength(n),qr)):(o=t.length,t.push(new u2))),t[o].addRange(n),i.push(o)}return new SF(t.length,i)}constructor(e,t){this._trackCount=e,this.trackPerLineIdx=t}getTrack(e){return this.trackPerLineIdx[e]}getTrackCount(){return this._trackCount}}class V9 extends uF{constructor(e,t,i,n,o){const r=Ye("div.diff-hidden-lines-widget");super(e,t,r.root),this._editor=e,this._move=i,this._kind=n,this._diffModel=o,this._nodes=Ye("div.diff-moved-code-block",{style:{marginRight:"4px"}},[Ye("div.text-content@textContent"),Ye("div.action-bar@actionBar")]),r.root.appendChild(this._nodes.root);const a=kt(this._editor.onDidLayoutChange,()=>this._editor.getLayoutInfo());this._register(Uc(this._nodes.root,{paddingRight:a.map(u=>u.verticalScrollbarWidth)}));let l;i.changes.length>0?l=this._kind==="original"?p("codeMovedToWithChanges","Code moved with changes to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):p("codeMovedFromWithChanges","Code moved with changes from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1):l=this._kind==="original"?p("codeMovedTo","Code moved to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):p("codeMovedFrom","Code moved from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1);const c=this._register(new zo(this._nodes.actionBar,{highlightToggledItems:!0})),d=new ho("",l,"",!1);c.push(d,{icon:!1,label:!0});const h=new ho("","Compare",Ie.asClassName(J.compareChanges),!0,()=>{this._editor.focus(),this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get()===i?void 0:this._move,void 0)});this._register(Pe(u=>{const g=this._diffModel.movedTextToCompare.read(u)===i;h.checked=g})),c.push(h,{icon:!1,label:!0})}}class gCe extends B{constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._decorations=_e(this,o=>{const r=this._diffModel.read(o),a=r?.diff.read(o);if(!a)return null;const l=this._diffModel.read(o).movedTextToCompare.read(o),c=this._options.renderIndicators.read(o),d=this._options.showEmptyDecorations.read(o),h=[],u=[];if(!l)for(const f of a.mappings)if(f.lineRangeMapping.original.isEmpty||h.push({range:f.lineRangeMapping.original.toInclusiveRange(),options:c?Ov:A9}),f.lineRangeMapping.modified.isEmpty||u.push({range:f.lineRangeMapping.modified.toInclusiveRange(),options:c?pS:M9}),f.lineRangeMapping.modified.isEmpty||f.lineRangeMapping.original.isEmpty)f.lineRangeMapping.original.isEmpty||h.push({range:f.lineRangeMapping.original.toInclusiveRange(),options:bF}),f.lineRangeMapping.modified.isEmpty||u.push({range:f.lineRangeMapping.modified.toInclusiveRange(),options:mF});else{const m=this._options.useTrueInlineDiffRendering.read(o)&&wF(f.lineRangeMapping);for(const _ of f.lineRangeMapping.innerChanges||[])if(f.lineRangeMapping.original.contains(_.originalRange.startLineNumber)&&h.push({range:_.originalRange,options:_.originalRange.isEmpty()&&d?vF:jp}),f.lineRangeMapping.modified.contains(_.modifiedRange.startLineNumber)&&u.push({range:_.modifiedRange,options:_.modifiedRange.isEmpty()&&d&&!m?_F:mS}),m){const b=r.model.original.getValueInRange(_.originalRange);u.push({range:_.modifiedRange,options:{description:"deleted-text",before:{content:b,inlineClassName:"inline-deleted-text"},zIndex:1e5,showIfCollapsed:!0}})}}if(l)for(const f of l.changes){const m=f.original.toInclusiveRange();m&&h.push({range:m,options:c?Ov:A9});const _=f.modified.toInclusiveRange();_&&u.push({range:_,options:c?pS:M9});for(const b of f.innerChanges||[])h.push({range:b.originalRange,options:jp}),u.push({range:b.modifiedRange,options:mS})}const g=this._diffModel.read(o).activeMovedText.read(o);for(const f of a.movedTexts)h.push({range:f.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal"+(f===g?" currentMove":""),blockPadding:[Ou.movedCodeBlockPadding,0,Ou.movedCodeBlockPadding,Ou.movedCodeBlockPadding]}}),u.push({range:f.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified"+(f===g?" currentMove":""),blockPadding:[4,0,4,4]}});return{originalDecorations:h,modifiedDecorations:u}}),this._register(uS(this._editors.original,this._decorations.map(o=>o?.originalDecorations||[]))),this._register(uS(this._editors.modified,this._decorations.map(o=>o?.modifiedDecorations||[])))}}class fCe{resetSash(){this._sashRatio.set(void 0,void 0)}constructor(e,t){this._options=e,this.dimensions=t,this.sashLeft=RC(this,i=>{const n=this._sashRatio.read(i)??this._options.splitViewDefaultRatio.read(i);return this._computeSashLeft(n,i)},(i,n)=>{const o=this.dimensions.width.get();this._sashRatio.set(i/o,n)}),this._sashRatio=Ze(this,void 0)}_computeSashLeft(e,t){const i=this.dimensions.width.read(t),n=Math.floor(this._options.splitViewDefaultRatio.read(t)*i),o=this._options.enableSplitViewResizing.read(t)?Math.floor(e*i):n,r=100;return i<=r*2?n:o<r?r:o>i-r?i-r:o}}class hj extends B{constructor(e,t,i,n,o,r){super(),this._domNode=e,this._dimensions=t,this._enabled=i,this._boundarySashes=n,this.sashLeft=o,this._resetSash=r,this._sash=this._register(new Hn(this._domNode,{getVerticalSashTop:a=>0,getVerticalSashLeft:a=>this.sashLeft.get(),getVerticalSashHeight:a=>this._dimensions.height.get()},{orientation:0})),this._startSashPosition=void 0,this._register(this._sash.onDidStart(()=>{this._startSashPosition=this.sashLeft.get()})),this._register(this._sash.onDidChange(a=>{this.sashLeft.set(this._startSashPosition+(a.currentX-a.startX),void 0)})),this._register(this._sash.onDidEnd(()=>this._sash.layout())),this._register(this._sash.onDidReset(()=>this._resetSash())),this._register(Pe(a=>{const l=this._boundarySashes.read(a);l&&(this._sash.orthogonalEndSash=l.bottom)})),this._register(Pe(a=>{const l=this._enabled.read(a);this._sash.state=l?3:0,this.sashLeft.read(a),this._dimensions.height.read(a),this._sash.layout()}))}}class pCe extends B{constructor(e,t,i){super(),this._editor=e,this._domNode=t,this.itemProvider=i,this.scrollTop=kt(this,this._editor.onDidScrollChange,r=>this._editor.getScrollTop()),this.isScrollTopZero=this.scrollTop.map(r=>r===0),this.modelAttached=kt(this,this._editor.onDidChangeModel,r=>this._editor.hasModel()),this.editorOnDidChangeViewZones=En("onDidChangeViewZones",this._editor.onDidChangeViewZones),this.editorOnDidContentSizeChange=En("onDidContentSizeChange",this._editor.onDidContentSizeChange),this.domNodeSizeChanged=km("domNodeSizeChanged"),this.views=new Map,this._domNode.className="gutter monaco-editor";const n=this._domNode.appendChild(Ye("div.scroll-decoration",{role:"presentation",ariaHidden:"true",style:{width:"100%"}}).root),o=new ResizeObserver(()=>{ai(r=>{this.domNodeSizeChanged.trigger(r)})});o.observe(this._domNode),this._register(Ce(()=>o.disconnect())),this._register(Pe(r=>{n.className=this.isScrollTopZero.read(r)?"":"scroll-decoration"})),this._register(Pe(r=>this.render(r)))}dispose(){super.dispose(),yn(this._domNode)}render(e){if(!this.modelAttached.read(e))return;this.domNodeSizeChanged.read(e),this.editorOnDidChangeViewZones.read(e),this.editorOnDidContentSizeChange.read(e);const t=this.scrollTop.read(e),i=this._editor.getVisibleRanges(),n=new Set(this.views.keys()),o=qe.ofStartAndLength(0,this._domNode.clientHeight);if(!o.isEmpty)for(const r of i){const a=new He(r.startLineNumber,r.endLineNumber+1),l=this.itemProvider.getIntersectingGutterItems(a,e);ai(c=>{for(const d of l){if(!d.range.intersect(a))continue;n.delete(d.id);let h=this.views.get(d.id);if(h)h.item.set(d,c);else{const m=document.createElement("div");this._domNode.appendChild(m);const _=Ze("item",d),b=this.itemProvider.createView(_,m);h=new mCe(_,b,m),this.views.set(d.id,h)}const u=d.range.startLineNumber<=this._editor.getModel().getLineCount()?this._editor.getTopForLineNumber(d.range.startLineNumber,!0)-t:this._editor.getBottomForLineNumber(d.range.startLineNumber-1,!1)-t,f=(d.range.endLineNumberExclusive===1?Math.max(u,this._editor.getTopForLineNumber(d.range.startLineNumber,!1)-t):Math.max(u,this._editor.getBottomForLineNumber(d.range.endLineNumberExclusive-1,!0)-t))-u;h.domNode.style.top=`${u}px`,h.domNode.style.height=`${f}px`,h.gutterItemView.layout(qe.ofStartAndLength(u,f),o)}})}for(const r of n){const a=this.views.get(r);a.gutterItemView.dispose(),a.domNode.remove(),this.views.delete(r)}}}class mCe{constructor(e,t,i){this.item=e,this.gutterItemView=t,this.domNode=i}}class uj extends Zu{constructor(e){super(),this._getContext=e}runAction(e,t){const i=this._getContext();return super.runAction(e,i)}}class z9 extends EV{constructor(e){super(),this._textModel=e}getValueOfRange(e){return this._textModel.getValueInRange(e)}get length(){const e=this._textModel.getLineCount(),t=this._textModel.getLineLength(e);return new Hs(e-1,t)}}class _Ce extends B{constructor(e,t,i={orientation:0}){super(),this.submenuActionViewItems=[],this.hasSecondaryActions=!1,this._onDidChangeDropdownVisibility=this._register(new AJ),this.onDidChangeDropdownVisibility=this._onDidChangeDropdownVisibility.event,this.disposables=this._register(new Z),i.hoverDelegate=i.hoverDelegate??this._register(Fp()),this.options=i,this.toggleMenuAction=this._register(new Fv(()=>this.toggleMenuActionViewItem?.show(),i.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",e.appendChild(this.element),this.actionBar=this._register(new zo(this.element,{orientation:i.orientation,ariaLabel:i.ariaLabel,actionRunner:i.actionRunner,allowContextMenu:i.allowContextMenu,highlightToggledItems:i.highlightToggledItems,hoverDelegate:i.hoverDelegate,actionViewItemProvider:(n,o)=>{if(n.id===Fv.ID)return this.toggleMenuActionViewItem=new S0(n,n.menuActions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:Ie.asClassNameArray(i.moreIcon??J.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,isMenu:!0,hoverDelegate:this.options.hoverDelegate}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(i.actionViewItemProvider){const r=i.actionViewItemProvider(n,o);if(r)return r}if(n instanceof Lp){const r=new S0(n,n.actions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:n.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,hoverDelegate:this.options.hoverDelegate});return r.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(r),this.disposables.add(this._onDidChangeDropdownVisibility.add(r.onDidChangeVisibility)),r}}}))}set actionRunner(e){this.actionBar.actionRunner=e}get actionRunner(){return this.actionBar.actionRunner}getElement(){return this.element}getItemAction(e){return this.actionBar.getAction(e)}setActions(e,t){this.clear();const i=e?e.slice(0):[];this.hasSecondaryActions=!!(t&&t.length>0),this.hasSecondaryActions&&t&&(this.toggleMenuAction.menuActions=t.slice(0),i.push(this.toggleMenuAction)),i.forEach(n=>{this.actionBar.push(n,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(n)})})}getKeybindingLabel(e){return this.options.getKeyBinding?.(e)?.getLabel()??void 0}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}}class Fv extends ho{static{this.ID="toolbar.toggle.more"}constructor(e,t){t=t||p("moreActions","More Actions..."),super(Fv.ID,t,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=e}async run(){this.toggleDropdownMenu()}get menuActions(){return this._menuActions}set menuActions(e){this._menuActions=e}}var gj=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Vr=function(s,e){return function(t,i){e(t,i,s)}};let Bv=class extends _Ce{constructor(e,t,i,n,o,r,a,l){super(e,o,{getKeyBinding:d=>r.lookupKeybinding(d.id)??void 0,...t,allowContextMenu:!0,skipTelemetry:typeof t?.telemetrySource=="string"}),this._options=t,this._menuService=i,this._contextKeyService=n,this._contextMenuService=o,this._keybindingService=r,this._commandService=a,this._sessionDisposables=this._store.add(new Z);const c=t?.telemetrySource;c&&this._store.add(this.actionBar.onDidRun(d=>l.publicLog2("workbenchActionExecuted",{id:d.action.id,from:c})))}setActions(e,t=[],i){this._sessionDisposables.clear();const n=e.slice(),o=t.slice(),r=[];let a=0;const l=[];let c=!1;if(this._options?.hiddenItemStrategy!==-1)for(let d=0;d<n.length;d++){const h=n[d];!(h instanceof uo)&&!(h instanceof qf)||h.hideActions&&(r.push(h.hideActions.toggle),h.hideActions.toggle.checked&&a++,h.hideActions.isHidden&&(c=!0,n[d]=void 0,this._options?.hiddenItemStrategy!==0&&(l[d]=h)))}if(this._options?.overflowBehavior!==void 0){const d=Ehe(new Set(this._options.overflowBehavior.exempted),st.map(n,g=>g?.id)),h=this._options.overflowBehavior.maxItems-d.size;let u=0;for(let g=0;g<n.length;g++){const f=n[g];f&&(u++,!d.has(f.id)&&u>=h&&(n[g]=void 0,l[g]=f))}}C5(n),C5(l),super.setActions(n,ji.join(l,o)),(r.length>0||n.length>0)&&this._sessionDisposables.add(U(this.getElement(),"contextmenu",d=>{const h=new jr(ke(this.getElement()),d),u=this.getItemAction(h.target);if(!u)return;h.preventDefault(),h.stopPropagation();const g=[];if(u instanceof uo&&u.menuKeybinding)g.push(u.menuKeybinding);else if(!(u instanceof qf||u instanceof Fv)){const m=!!this._keybindingService.lookupKeybinding(u.id);g.push(E$(this._commandService,this._keybindingService,u.id,void 0,m))}if(r.length>0){let m=!1;if(a===1&&this._options?.hiddenItemStrategy===0){m=!0;for(let _=0;_<r.length;_++)if(r[_].checked){r[_]=Du({id:u.id,label:u.label,checked:!0,enabled:!1,run(){}});break}}if(!m&&(u instanceof uo||u instanceof qf)){if(!u.hideActions)return;g.push(u.hideActions.hide)}else g.push(Du({id:"label",label:p("hide","Hide"),enabled:!1,run(){}}))}const f=ji.join(g,r);this._options?.resetMenu&&!i&&(i=[this._options.resetMenu]),c&&i&&(f.push(new ji),f.push(Du({id:"resetThisMenu",label:p("resetThisMenu","Reset Menu"),run:()=>this._menuService.resetHiddenStates(i)}))),f.length!==0&&this._contextMenuService.showContextMenu({getAnchor:()=>h,getActions:()=>f,menuId:this._options?.contextMenu,menuActionOptions:{renderShortTitle:!0,...this._options?.menuOptions},skipTelemetry:typeof this._options?.telemetrySource=="string",contextKeyService:this._contextKeyService})}))}};Bv=gj([Vr(2,qo),Vr(3,Ee),Vr(4,bo),Vr(5,yt),Vr(6,Ht),Vr(7,jn)],Bv);let _S=class extends Bv{constructor(e,t,i,n,o,r,a,l,c){super(e,{resetMenu:t,...i},n,o,r,a,l,c),this._onDidChangeMenuItems=this._store.add(new O),this.onDidChangeMenuItems=this._onDidChangeMenuItems.event;const d=this._store.add(n.createMenu(t,o,{emitEventsForSubmenuChanges:!0})),h=()=>{const u=[],g=[];cx(d,i?.menuOptions,{primary:u,secondary:g},i?.toolbarOptions?.primaryGroup,i?.toolbarOptions?.shouldInlineSubmenu,i?.toolbarOptions?.useSeparatorsInPrimaryActions),e.classList.toggle("has-no-actions",u.length===0&&g.length===0),super.setActions(u,g)};this._store.add(d.onDidChange(()=>{h(),this._onDidChangeMenuItems.fire(this)})),h()}setActions(){throw new mt("This toolbar is populated from a menu.")}};_S=gj([Vr(3,qo),Vr(4,Ee),Vr(5,bo),Vr(6,yt),Vr(7,Ht),Vr(8,jn)],_S);var fj=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},i1=function(s,e){return function(t,i){e(t,i,s)}};const tI=[],tw=35;let BR=class extends B{constructor(e,t,i,n,o,r,a,l,c){super(),this._diffModel=t,this._editors=i,this._options=n,this._sashLayout=o,this._boundarySashes=r,this._instantiationService=a,this._contextKeyService=l,this._menuService=c,this._menu=this._register(this._menuService.createMenu(M.DiffEditorHunkToolbar,this._contextKeyService)),this._actions=kt(this,this._menu.onDidChange,()=>this._menu.getActions()),this._hasActions=this._actions.map(d=>d.length>0),this._showSash=_e(this,d=>this._options.renderSideBySide.read(d)&&this._hasActions.read(d)),this.width=_e(this,d=>this._hasActions.read(d)?tw:0),this.elements=Ye("div.gutter@gutter",{style:{position:"absolute",height:"100%",width:tw+"px"}},[]),this._currentDiff=_e(this,d=>{const h=this._diffModel.read(d);if(!h)return;const u=h.diff.read(d)?.mappings,g=this._editors.modifiedCursor.read(d);if(g)return u?.find(f=>f.lineRangeMapping.modified.contains(g.lineNumber))}),this._selectedDiffs=_e(this,d=>{const u=this._diffModel.read(d)?.diff.read(d);if(!u)return tI;const g=this._editors.modifiedSelections.read(d);if(g.every(b=>b.isEmpty()))return tI;const f=new dr(g.map(b=>He.fromRangeInclusive(b))),_=u.mappings.filter(b=>b.lineRangeMapping.innerChanges&&f.intersects(b.lineRangeMapping.modified)).map(b=>({mapping:b,rangeMappings:b.lineRangeMapping.innerChanges.filter(v=>g.some(C=>k.areIntersecting(v.modifiedRange,C)))}));return _.length===0||_.every(b=>b.rangeMappings.length===0)?tI:_}),this._register(Hve(e,this.elements.root)),this._register(U(this.elements.root,"click",()=>{this._editors.modified.focus()})),this._register(Uc(this.elements.root,{display:this._hasActions.map(d=>d?"block":"none")})),Jn(this,d=>this._showSash.read(d)?new hj(e,this._sashLayout.dimensions,this._options.enableSplitViewResizing,this._boundarySashes,RC(this,u=>this._sashLayout.sashLeft.read(u)-tw,(u,g)=>this._sashLayout.sashLeft.set(u+tw,g)),()=>this._sashLayout.resetSash()):void 0).recomputeInitiallyAndOnChange(this._store),this._register(new pCe(this._editors.modified,this.elements.root,{getIntersectingGutterItems:(d,h)=>{const u=this._diffModel.read(h);if(!u)return[];const g=u.diff.read(h);if(!g)return[];const f=this._selectedDiffs.read(h);if(f.length>0){const _=Vo.fromRangeMappings(f.flatMap(b=>b.rangeMappings));return[new U9(_,!0,M.DiffEditorSelectionToolbar,void 0,u.model.original.uri,u.model.modified.uri)]}const m=this._currentDiff.read(h);return g.mappings.map(_=>new U9(_.lineRangeMapping.withInnerChangesFromLineRanges(),_.lineRangeMapping===m?.lineRangeMapping,M.DiffEditorHunkToolbar,void 0,u.model.original.uri,u.model.modified.uri))},createView:(d,h)=>this._instantiationService.createInstance(WR,d,h,this)})),this._register(U(this.elements.gutter,ee.MOUSE_WHEEL,d=>{this._editors.modified.getOption(104).handleMouseWheel&&this._editors.modified.delegateScrollFromMouseWheelEvent(d)},{passive:!1}))}computeStagedValue(e){const t=e.innerChanges??[],i=new z9(this._editors.modifiedModel.get()),n=new z9(this._editors.original.getModel());return new f2(t.map(a=>a.toTextEdit(i))).apply(n)}layout(e){this.elements.gutter.style.left=e+"px"}};BR=fj([i1(6,ye),i1(7,Ee),i1(8,qo)],BR);class U9{constructor(e,t,i,n,o,r){this.mapping=e,this.showAlways=t,this.menuId=i,this.rangeOverride=n,this.originalUri=o,this.modifiedUri=r}get id(){return this.mapping.modified.toString()}get range(){return this.rangeOverride??this.mapping.modified}}let WR=class extends B{constructor(e,t,i,n){super(),this._item=e,this._elements=Ye("div.gutterItem",{style:{height:"20px",width:"34px"}},[Ye("div.background@background",{},[]),Ye("div.buttons@buttons",{},[])]),this._showAlways=this._item.map(this,r=>r.showAlways),this._menuId=this._item.map(this,r=>r.menuId),this._isSmall=Ze(this,!1),this._lastItemRange=void 0,this._lastViewRange=void 0;const o=this._register(n.createInstance(Ep,"element",!0,{position:{hoverPosition:1}}));this._register(Pf(t,this._elements.root)),this._register(Pe(r=>{const a=this._showAlways.read(r);this._elements.root.classList.toggle("noTransition",!0),this._elements.root.classList.toggle("showAlways",a),setTimeout(()=>{this._elements.root.classList.toggle("noTransition",!1)},0)})),this._register(Us((r,a)=>{this._elements.buttons.replaceChildren();const l=a.add(n.createInstance(_S,this._elements.buttons,this._menuId.read(r),{orientation:1,hoverDelegate:o,toolbarOptions:{primaryGroup:c=>c.startsWith("primary")},overflowBehavior:{maxItems:this._isSmall.read(r)?1:3},hiddenItemStrategy:0,actionRunner:new uj(()=>{const c=this._item.get(),d=c.mapping;return{mapping:d,originalWithModifiedChanges:i.computeStagedValue(d),originalUri:c.originalUri,modifiedUri:c.modifiedUri}}),menuOptions:{shouldForwardArgs:!0}}));a.add(l.onDidChangeMenuItems(()=>{this._lastItemRange&&this.layout(this._lastItemRange,this._lastViewRange)}))}))}layout(e,t){this._lastItemRange=e,this._lastViewRange=t;let i=this._elements.buttons.clientHeight;this._isSmall.set(this._item.get().mapping.original.startLineNumber===1&&e.length<30,void 0),i=this._elements.buttons.clientHeight;const n=e.length/2-i/2,o=i;let r=e.start+n;const a=qe.tryCreate(o,t.endExclusive-o-i),l=qe.tryCreate(e.start+o,e.endExclusive-i-o);l&&a&&l.start<l.endExclusive&&(r=a.clip(r),r=l.clip(r)),this._elements.buttons.style.top=`${r-e.start}px`}};WR=fj([i1(3,ye)],WR);function ao(s){return fu.get(s)}class fu extends B{static{this._map=new Map}static get(e){let t=fu._map.get(e);if(!t){t=new fu(e),fu._map.set(e,t);const i=e.onDidDispose(()=>{const n=fu._map.get(e);n&&(fu._map.delete(e),n.dispose(),i.dispose())})}return t}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&(this._currentTransaction=new xm(()=>{}))}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){const e=this._currentTransaction;this._currentTransaction=void 0,e.finish()}}constructor(e){super(),this.editor=e,this._updateCounter=0,this._currentTransaction=void 0,this._model=Ze(this,this.editor.getModel()),this.model=this._model,this.isReadonly=kt(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(92)),this._versionId=dN({owner:this,lazy:!0},this.editor.getModel()?.getVersionId()??null),this.versionId=this._versionId,this._selections=dN({owner:this,equalsFn:aN(v0(me.selectionsEqual)),lazy:!0},this.editor.getSelections()??null),this.selections=this._selections,this.isFocused=kt(this,t=>{const i=this.editor.onDidFocusEditorWidget(t),n=this.editor.onDidBlurEditorWidget(t);return{dispose(){i.dispose(),n.dispose()}}},()=>this.editor.hasWidgetFocus()),this.value=RC(this,t=>(this.versionId.read(t),this.model.read(t)?.getValue()??""),(t,i)=>{const n=this.model.get();n!==null&&t!==n.getValue()&&n.setValue(t)}),this.valueIsEmpty=_e(this,t=>(this.versionId.read(t),this.editor.getModel()?.getValueLength()===0)),this.cursorSelection=Ao({owner:this,equalsFn:aN(me.selectionsEqual)},t=>this.selections.read(t)?.[0]??null),this.onDidType=km(this),this.scrollTop=kt(this.editor.onDidScrollChange,()=>this.editor.getScrollTop()),this.scrollLeft=kt(this.editor.onDidScrollChange,()=>this.editor.getScrollLeft()),this.layoutInfo=kt(this.editor.onDidLayoutChange,()=>this.editor.getLayoutInfo()),this.layoutInfoContentLeft=this.layoutInfo.map(t=>t.contentLeft),this.layoutInfoDecorationsLeft=this.layoutInfo.map(t=>t.decorationsLeft),this.contentWidth=kt(this.editor.onDidContentSizeChange,()=>this.editor.getContentWidth()),this._overlayWidgetCounter=0,this._register(this.editor.onBeginUpdate(()=>this._beginUpdate())),this._register(this.editor.onEndUpdate(()=>this._endUpdate())),this._register(this.editor.onDidChangeModel(()=>{this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidType(t=>{this._beginUpdate();try{this._forceUpdate(),this.onDidType.trigger(this._currentTransaction,t)}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeModelContent(t=>{this._beginUpdate();try{this._versionId.set(this.editor.getModel()?.getVersionId()??null,this._currentTransaction,t),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeCursorSelection(t=>{this._beginUpdate();try{this._selections.set(this.editor.getSelections(),this._currentTransaction,t),this._forceUpdate()}finally{this._endUpdate()}}))}forceUpdate(e){this._beginUpdate();try{return this._forceUpdate(),e?e(this._currentTransaction):void 0}finally{this._endUpdate()}}_forceUpdate(){this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._versionId.set(this.editor.getModel()?.getVersionId()??null,this._currentTransaction,void 0),this._selections.set(this.editor.getSelections(),this._currentTransaction,void 0)}finally{this._endUpdate()}}getOption(e){return kt(this,t=>this.editor.onDidChangeConfiguration(i=>{i.hasChanged(e)&&t(void 0)}),()=>this.editor.getOption(e))}setDecorations(e){const t=new Z,i=this.editor.createDecorationsCollection();return t.add(MC({owner:this,debugName:()=>`Apply decorations from ${e.debugName}`},n=>{const o=e.read(n);i.set(o)})),t.add({dispose:()=>{i.clear()}}),t}createOverlayWidget(e){const t="observableOverlayWidget"+this._overlayWidgetCounter++,i={getDomNode:()=>e.domNode,getPosition:()=>e.position.get(),getId:()=>t,allowEditorOverflow:e.allowEditorOverflow,getMinContentWidthInPx:()=>e.minContentWidthInPx.get()};this.editor.addOverlayWidget(i);const n=Pe(o=>{e.position.read(o),e.minContentWidthInPx.read(o),this.editor.layoutOverlayWidget(i)});return Ce(()=>{n.dispose(),this.editor.removeOverlayWidget(i)})}}function HR(s,e){return Hce({createEmptyChangeSummary:()=>({deltas:[],didChange:!1}),handleChange:(t,i)=>{if(t.didChange(s)){const n=t.change;n!==void 0&&i.deltas.push(n),i.didChange=!0}return!0}},(t,i)=>{const n=s.read(t);i.didChange&&e(n,i.deltas)})}function bCe(s,e){const t=new Z,i=HR(s,(n,o)=>{t.clear(),e(n,o,t)});return{dispose(){i.dispose(),t.dispose()}}}var vCe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},CCe=function(s,e){return function(t,i){e(t,i,s)}},n1;let bS=class extends B{static{n1=this}static{this._breadcrumbsSourceFactory=Ze(n1,()=>({dispose(){},getBreadcrumbItems(e,t){return[]}}))}static setBreadcrumbsSourceFactory(e){this._breadcrumbsSourceFactory.set(e,void 0)}get isUpdatingHiddenAreas(){return this._isUpdatingHiddenAreas}constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._instantiationService=n,this._modifiedOutlineSource=Jn(this,l=>{const c=this._editors.modifiedModel.read(l),d=n1._breadcrumbsSourceFactory.read(l);return!c||!d?void 0:d(c,this._instantiationService)}),this._isUpdatingHiddenAreas=!1,this._register(this._editors.original.onDidChangeCursorPosition(l=>{if(l.reason===1)return;const c=this._diffModel.get();ai(d=>{for(const h of this._editors.original.getSelections()||[])c?.ensureOriginalLineIsVisible(h.getStartPosition().lineNumber,0,d),c?.ensureOriginalLineIsVisible(h.getEndPosition().lineNumber,0,d)})})),this._register(this._editors.modified.onDidChangeCursorPosition(l=>{if(l.reason===1)return;const c=this._diffModel.get();ai(d=>{for(const h of this._editors.modified.getSelections()||[])c?.ensureModifiedLineIsVisible(h.getStartPosition().lineNumber,0,d),c?.ensureModifiedLineIsVisible(h.getEndPosition().lineNumber,0,d)})}));const o=this._diffModel.map((l,c)=>{const d=l?.unchangedRegions.read(c)??[];return d.length===1&&d[0].modifiedLineNumber===1&&d[0].lineCount===this._editors.modifiedModel.read(c)?.getLineCount()?[]:d});this.viewZones=wh(this,(l,c)=>{const d=this._modifiedOutlineSource.read(l);if(!d)return{origViewZones:[],modViewZones:[]};const h=[],u=[],g=this._options.renderSideBySide.read(l),f=this._options.compactMode.read(l),m=o.read(l);for(let _=0;_<m.length;_++){const b=m[_];if(!b.shouldHideControls(l)&&!(f&&(_===0||_===m.length-1)))if(f){{const v=_e(this,y=>b.getHiddenOriginalRange(y).startLineNumber-1),C=new Of(v,12);h.push(C),c.add(new $9(this._editors.original,C,b,!g))}{const v=_e(this,y=>b.getHiddenModifiedRange(y).startLineNumber-1),C=new Of(v,12);u.push(C),c.add(new $9(this._editors.modified,C,b))}}else{{const v=_e(this,y=>b.getHiddenOriginalRange(y).startLineNumber-1),C=new Of(v,24);h.push(C),c.add(new j9(this._editors.original,C,b,b.originalUnchangedRange,!g,d,y=>this._diffModel.get().ensureModifiedLineIsVisible(y,2,void 0),this._options))}{const v=_e(this,y=>b.getHiddenModifiedRange(y).startLineNumber-1),C=new Of(v,24);u.push(C),c.add(new j9(this._editors.modified,C,b,b.modifiedUnchangedRange,!1,d,y=>this._diffModel.get().ensureModifiedLineIsVisible(y,2,void 0),this._options))}}}return{origViewZones:h,modViewZones:u}});const r={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},a={description:"Fold Unchanged",glyphMarginHoverMessage:new zn(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(p("foldUnchanged","Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+Ie.asClassName(J.fold),zIndex:10001};this._register(uS(this._editors.original,_e(this,l=>{const c=o.read(l),d=c.map(h=>({range:h.originalUnchangedRange.toInclusiveRange(),options:r}));for(const h of c)h.shouldHideControls(l)&&d.push({range:k.fromPositions(new P(h.originalLineNumber,1)),options:a});return d}))),this._register(uS(this._editors.modified,_e(this,l=>{const c=o.read(l),d=c.map(h=>({range:h.modifiedUnchangedRange.toInclusiveRange(),options:r}));for(const h of c)h.shouldHideControls(l)&&d.push({range:He.ofLength(h.modifiedLineNumber,1).toInclusiveRange(),options:a});return d}))),this._register(Pe(l=>{const c=o.read(l);this._isUpdatingHiddenAreas=!0;try{this._editors.original.setHiddenAreas(c.map(d=>d.getHiddenOriginalRange(l).toInclusiveRange()).filter(Sl)),this._editors.modified.setHiddenAreas(c.map(d=>d.getHiddenModifiedRange(l).toInclusiveRange()).filter(Sl))}finally{this._isUpdatingHiddenAreas=!1}})),this._register(this._editors.modified.onMouseUp(l=>{if(!l.event.rightButton&&l.target.position&&l.target.element?.className.includes("fold-unchanged")){const c=l.target.position.lineNumber,d=this._diffModel.get();if(!d)return;const h=d.unchangedRegions.get().find(u=>u.modifiedUnchangedRange.includes(c));if(!h)return;h.collapseAll(void 0),l.event.stopPropagation(),l.event.preventDefault()}})),this._register(this._editors.original.onMouseUp(l=>{if(!l.event.rightButton&&l.target.position&&l.target.element?.className.includes("fold-unchanged")){const c=l.target.position.lineNumber,d=this._diffModel.get();if(!d)return;const h=d.unchangedRegions.get().find(u=>u.originalUnchangedRange.includes(c));if(!h)return;h.collapseAll(void 0),l.event.stopPropagation(),l.event.preventDefault()}}))}};bS=n1=vCe([CCe(3,ye)],bS);class $9 extends uF{constructor(e,t,i,n=!1){const o=Ye("div.diff-hidden-lines-widget");super(e,t,o.root),this._unchangedRegion=i,this._hide=n,this._nodes=Ye("div.diff-hidden-lines-compact",[Ye("div.line-left",[]),Ye("div.text@text",[]),Ye("div.line-right",[])]),o.root.appendChild(this._nodes.root),this._hide&&this._nodes.root.replaceChildren(),this._register(Pe(r=>{if(!this._hide){const a=this._unchangedRegion.getHiddenModifiedRange(r).length,l=p("hiddenLines","{0} hidden lines",a);this._nodes.text.innerText=l}}))}}class j9 extends uF{constructor(e,t,i,n,o,r,a,l){const c=Ye("div.diff-hidden-lines-widget");super(e,t,c.root),this._editor=e,this._unchangedRegion=i,this._unchangedRegionRange=n,this._hide=o,this._modifiedOutlineSource=r,this._revealModifiedHiddenLine=a,this._options=l,this._nodes=Ye("div.diff-hidden-lines",[Ye("div.top@top",{title:p("diff.hiddenLines.top","Click or drag to show more above")}),Ye("div.center@content",{style:{display:"flex"}},[Ye("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:"0"}},[te("a",{title:p("showUnchangedRegion","Show Unchanged Region"),role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...Kd("$(unfold)"))]),Ye("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),Ye("div.bottom@bottom",{title:p("diff.bottom","Click or drag to show more below"),role:"button"})]),c.root.appendChild(this._nodes.root),this._hide?yn(this._nodes.first):this._register(Uc(this._nodes.first,{width:ao(this._editor).layoutInfoContentLeft})),this._register(Pe(h=>{const u=this._unchangedRegion.visibleLineCountTop.read(h)+this._unchangedRegion.visibleLineCountBottom.read(h)===this._unchangedRegion.lineCount;this._nodes.bottom.classList.toggle("canMoveTop",!u),this._nodes.bottom.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(h)>0),this._nodes.top.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(h)>0),this._nodes.top.classList.toggle("canMoveBottom",!u);const g=this._unchangedRegion.isDragged.read(h),f=this._editor.getDomNode();f&&(f.classList.toggle("draggingUnchangedRegion",!!g),g==="top"?(f.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(h)>0),f.classList.toggle("canMoveBottom",!u)):g==="bottom"?(f.classList.toggle("canMoveTop",!u),f.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(h)>0)):(f.classList.toggle("canMoveTop",!1),f.classList.toggle("canMoveBottom",!1)))}));const d=this._editor;this._register(U(this._nodes.top,"mousedown",h=>{if(h.button!==0)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),h.preventDefault();const u=h.clientY;let g=!1;const f=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set("top",void 0);const m=ke(this._nodes.top),_=U(m,"mousemove",v=>{const y=v.clientY-u;g=g||Math.abs(y)>2;const w=Math.round(y/d.getOption(67)),x=Math.max(0,Math.min(f+w,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(x,void 0)}),b=U(m,"mouseup",v=>{g||this._unchangedRegion.showMoreAbove(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(void 0,void 0),_.dispose(),b.dispose()})})),this._register(U(this._nodes.bottom,"mousedown",h=>{if(h.button!==0)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),h.preventDefault();const u=h.clientY;let g=!1;const f=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set("bottom",void 0);const m=ke(this._nodes.bottom),_=U(m,"mousemove",v=>{const y=v.clientY-u;g=g||Math.abs(y)>2;const w=Math.round(y/d.getOption(67)),x=Math.max(0,Math.min(f-w,this._unchangedRegion.getMaxVisibleLineCountBottom())),L=this._unchangedRegionRange.endLineNumberExclusive>d.getModel().getLineCount()?d.getContentHeight():d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(x,void 0);const D=this._unchangedRegionRange.endLineNumberExclusive>d.getModel().getLineCount()?d.getContentHeight():d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);d.setScrollTop(d.getScrollTop()+(D-L))}),b=U(m,"mouseup",v=>{if(this._unchangedRegion.isDragged.set(void 0,void 0),!g){const C=d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0);const y=d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);d.setScrollTop(d.getScrollTop()+(y-C))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),_.dispose(),b.dispose()})})),this._register(Pe(h=>{const u=[];if(!this._hide){const g=i.getHiddenModifiedRange(h).length,f=p("hiddenLines","{0} hidden lines",g),m=te("span",{title:p("diff.hiddenLines.expandAll","Double click to unfold")},f);m.addEventListener("dblclick",v=>{v.button===0&&(v.preventDefault(),this._unchangedRegion.showAll(void 0))}),u.push(m);const _=this._unchangedRegion.getHiddenModifiedRange(h),b=this._modifiedOutlineSource.getBreadcrumbItems(_,h);if(b.length>0){u.push(te("span",void 0,"|"));for(let v=0;v<b.length;v++){const C=b[v],y=M1.toIcon(C.kind),w=Ye("div.breadcrumb-item",{style:{display:"flex",alignItems:"center"}},[Gu(y),"",C.name,...v===b.length-1?[]:[Gu(J.chevronRight)]]).root;u.push(w),w.onclick=()=>{this._revealModifiedHiddenLine(C.startLineNumber)}}}}yn(this._nodes.others,...u)}))}}var yCe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},wCe=function(s,e){return function(t,i){e(t,i,s)}},ua;let Wv=class extends B{static{ua=this}static{this.ONE_OVERVIEW_WIDTH=15}static{this.ENTIRE_DIFF_OVERVIEW_WIDTH=this.ONE_OVERVIEW_WIDTH*2}constructor(e,t,i,n,o,r,a){super(),this._editors=e,this._rootElement=t,this._diffModel=i,this._rootWidth=n,this._rootHeight=o,this._modifiedEditorLayoutInfo=r,this._themeService=a,this.width=ua.ENTIRE_DIFF_OVERVIEW_WIDTH;const l=kt(this._themeService.onDidColorThemeChange,()=>this._themeService.getColorTheme()),c=_e(u=>{const g=l.read(u),f=g.getColor(Hoe)||(g.getColor(Boe)||NE).transparent(2),m=g.getColor(Voe)||(g.getColor(Woe)||RE).transparent(2);return{insertColor:f,removeColor:m}}),d=Ct(document.createElement("div"));d.setClassName("diffViewport"),d.setPosition("absolute");const h=Ye("div.diffOverview",{style:{position:"absolute",top:"0px",width:ua.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;this._register(Pf(h,d.domNode)),this._register(gi(h,ee.POINTER_DOWN,u=>{this._editors.modified.delegateVerticalScrollbarPointerDown(u)})),this._register(U(h,ee.MOUSE_WHEEL,u=>{this._editors.modified.delegateScrollFromMouseWheelEvent(u)},{passive:!1})),this._register(Pf(this._rootElement,h)),this._register(Us((u,g)=>{const f=this._diffModel.read(u),m=this._editors.original.createOverviewRuler("original diffOverviewRuler");m&&(g.add(m),g.add(Pf(h,m.getDomNode())));const _=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(_&&(g.add(_),g.add(Pf(h,_.getDomNode()))),!m||!_)return;const b=En("viewZoneChanged",this._editors.original.onDidChangeViewZones),v=En("viewZoneChanged",this._editors.modified.onDidChangeViewZones),C=En("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),y=En("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);g.add(Pe(w=>{b.read(w),v.read(w),C.read(w),y.read(w);const x=c.read(w),L=f?.diff.read(w)?.mappings;function D(W,H,$){const V=$._getViewModel();return V?W.filter(Y=>Y.length>0).map(Y=>{const ie=V.coordinatesConverter.convertModelPositionToViewPosition(new P(Y.startLineNumber,1)),ue=V.coordinatesConverter.convertModelPositionToViewPosition(new P(Y.endLineNumberExclusive,1)),fe=ue.lineNumber-ie.lineNumber;return new tj(ie.lineNumber,ue.lineNumber,fe,H.toString())}):[]}const T=D((L||[]).map(W=>W.lineRangeMapping.original),x.removeColor,this._editors.original),F=D((L||[]).map(W=>W.lineRangeMapping.modified),x.insertColor,this._editors.modified);m?.setZones(T),_?.setZones(F)})),g.add(Pe(w=>{const x=this._rootHeight.read(w),L=this._rootWidth.read(w),D=this._modifiedEditorLayoutInfo.read(w);if(D){const T=ua.ENTIRE_DIFF_OVERVIEW_WIDTH-2*ua.ONE_OVERVIEW_WIDTH;m.setLayout({top:0,height:x,right:T+ua.ONE_OVERVIEW_WIDTH,width:ua.ONE_OVERVIEW_WIDTH}),_.setLayout({top:0,height:x,right:0,width:ua.ONE_OVERVIEW_WIDTH});const F=this._editors.modifiedScrollTop.read(w),W=this._editors.modifiedScrollHeight.read(w),H=this._editors.modified.getOption(104),$=new Rp(H.verticalHasArrows?H.arrowSize:0,H.verticalScrollbarSize,0,D.height,W,F);d.setTop($.getSliderPosition()),d.setHeight($.getSliderSize())}else d.setTop(0),d.setHeight(0);h.style.height=x+"px",h.style.left=L-ua.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",d.setWidth(ua.ENTIRE_DIFF_OVERVIEW_WIDTH)}))}))}};Wv=ua=yCe([wCe(6,Ki)],Wv);const iI=[];class SCe extends B{constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._widget=n,this._selectedDiffs=_e(this,o=>{const a=this._diffModel.read(o)?.diff.read(o);if(!a)return iI;const l=this._editors.modifiedSelections.read(o);if(l.every(u=>u.isEmpty()))return iI;const c=new dr(l.map(u=>He.fromRangeInclusive(u))),h=a.mappings.filter(u=>u.lineRangeMapping.innerChanges&&c.intersects(u.lineRangeMapping.modified)).map(u=>({mapping:u,rangeMappings:u.lineRangeMapping.innerChanges.filter(g=>l.some(f=>k.areIntersecting(g.modifiedRange,f)))}));return h.length===0||h.every(u=>u.rangeMappings.length===0)?iI:h}),this._register(Us((o,r)=>{if(!this._options.shouldRenderOldRevertArrows.read(o))return;const a=this._diffModel.read(o),l=a?.diff.read(o);if(!a||!l||a.movedTextToCompare.read(o))return;const c=[],d=this._selectedDiffs.read(o),h=new Set(d.map(u=>u.mapping));if(d.length>0){const u=this._editors.modifiedSelections.read(o),g=r.add(new vS(u[u.length-1].positionLineNumber,this._widget,d.flatMap(f=>f.rangeMappings),!0));this._editors.modified.addGlyphMarginWidget(g),c.push(g)}for(const u of l.mappings)if(!h.has(u)&&!u.lineRangeMapping.modified.isEmpty&&u.lineRangeMapping.innerChanges){const g=r.add(new vS(u.lineRangeMapping.modified.startLineNumber,this._widget,u.lineRangeMapping,!1));this._editors.modified.addGlyphMarginWidget(g),c.push(g)}r.add(Ce(()=>{for(const u of c)this._editors.modified.removeGlyphMarginWidget(u)}))}))}}class vS extends B{static{this.counter=0}getId(){return this._id}constructor(e,t,i,n){super(),this._lineNumber=e,this._widget=t,this._diffs=i,this._revertSelection=n,this._id=`revertButton${vS.counter++}`,this._domNode=Ye("div.revertButton",{title:this._revertSelection?p("revertSelectedChanges","Revert Selected Changes"):p("revertChange","Revert Change")},[Gu(J.arrowRight)]).root,this._register(U(this._domNode,ee.MOUSE_DOWN,o=>{o.button!==2&&(o.stopPropagation(),o.preventDefault())})),this._register(U(this._domNode,ee.MOUSE_UP,o=>{o.stopPropagation(),o.preventDefault()})),this._register(U(this._domNode,ee.CLICK,o=>{this._diffs instanceof is?this._widget.revert(this._diffs):this._widget.revertRangeMappings(this._diffs),o.stopPropagation(),o.preventDefault()}))}getDomNode(){return this._domNode}getPosition(){return{lane:Jr.Right,range:{startColumn:1,startLineNumber:this._lineNumber,endColumn:1,endLineNumber:this._lineNumber},zIndex:10001}}}function LCe(s,e,t){return zce({debugName:()=>`Configuration Key "${s}"`},i=>t.onDidChangeConfiguration(n=>{n.affectsConfiguration(s)&&i(n)}),()=>t.getValue(s)??e)}function fa(s,e,t){const i=s.bindTo(e);return MC({debugName:()=>`Set Context Key "${s.key}"`},n=>{i.set(t(n))})}var xCe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Z9=function(s,e){return function(t,i){e(t,i,s)}};let VR=class extends B{get onDidContentSizeChange(){return this._onDidContentSizeChange.event}constructor(e,t,i,n,o,r,a){super(),this.originalEditorElement=e,this.modifiedEditorElement=t,this._options=i,this._argCodeEditorWidgetOptions=n,this._createInnerEditor=o,this._instantiationService=r,this._keybindingService=a,this.original=this._register(this._createLeftHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.originalEditor||{})),this.modified=this._register(this._createRightHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.modifiedEditor||{})),this._onDidContentSizeChange=this._register(new O),this.modifiedScrollTop=kt(this,this.modified.onDidScrollChange,()=>this.modified.getScrollTop()),this.modifiedScrollHeight=kt(this,this.modified.onDidScrollChange,()=>this.modified.getScrollHeight()),this.modifiedObs=ao(this.modified),this.originalObs=ao(this.original),this.modifiedModel=this.modifiedObs.model,this.modifiedSelections=kt(this,this.modified.onDidChangeCursorSelection,()=>this.modified.getSelections()??[]),this.modifiedCursor=Ao({owner:this,equalsFn:P.equals},l=>this.modifiedSelections.read(l)[0]?.getPosition()??new P(1,1)),this.originalCursor=kt(this,this.original.onDidChangeCursorPosition,()=>this.original.getPosition()??new P(1,1)),this._argCodeEditorWidgetOptions=null,this._register(AC({createEmptyChangeSummary:()=>({}),handleChange:(l,c)=>(l.didChange(i.editorOptions)&&Object.assign(c,l.change.changedOptions),!0)},(l,c)=>{i.editorOptions.read(l),this._options.renderSideBySide.read(l),this.modified.updateOptions(this._adjustOptionsForRightHandSide(l,c)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(l,c))}))}_createLeftHandSideEditor(e,t){const i=this._adjustOptionsForLeftHandSide(void 0,e),n=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,i,t);return n.setContextValue("isInDiffLeftEditor",!0),n}_createRightHandSideEditor(e,t){const i=this._adjustOptionsForRightHandSide(void 0,e),n=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,i,t);return n.setContextValue("isInDiffRightEditor",!0),n}_constructInnerEditor(e,t,i,n){const o=this._createInnerEditor(e,t,i,n);return this._register(o.onDidContentSizeChange(r=>{const a=this.original.getContentWidth()+this.modified.getContentWidth()+Wv.ENTIRE_DIFF_OVERVIEW_WIDTH,l=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:l,contentWidth:a,contentHeightChanged:r.contentHeightChanged,contentWidthChanged:r.contentWidthChanged})})),o}_adjustOptionsForLeftHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return this._options.renderSideBySide.get()?(i.unicodeHighlight=this._options.editorOptions.get().unicodeHighlight||{},i.wordWrapOverride1=this._options.diffWordWrap.get()):(i.wordWrapOverride1="off",i.wordWrapOverride2="off",i.stickyScroll={enabled:!1},i.unicodeHighlight={nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}),i.glyphMargin=this._options.renderSideBySide.get(),t.originalAriaLabel&&(i.ariaLabel=t.originalAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.readOnly=!this._options.originalEditable.get(),i.dropIntoEditor={enabled:!i.readOnly},i.extraEditorClassName="original-in-monaco-diff-editor",i}_adjustOptionsForRightHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return t.modifiedAriaLabel&&(i.ariaLabel=t.modifiedAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.wordWrapOverride1=this._options.diffWordWrap.get(),i.revealHorizontalRightPadding=ja.revealHorizontalRightPadding.defaultValue+Wv.ENTIRE_DIFF_OVERVIEW_WIDTH,i.scrollbar.verticalHasArrows=!1,i.extraEditorClassName="modified-in-monaco-diff-editor",i}_adjustOptionsForSubEditor(e){const t={...e,dimension:{height:0,width:0}};return t.inDiffEditor=!0,t.automaticLayout=!1,t.scrollbar={...t.scrollbar||{}},t.folding=!1,t.codeLens=this._options.diffCodeLens.get(),t.fixedOverflowWidgets=!0,t.minimap={...t.minimap||{}},t.minimap.enabled=!1,this._options.hideUnchangedRegions.get()?t.stickyScroll={enabled:!1}:t.stickyScroll=this._options.editorOptions.get().stickyScroll,t}_updateAriaLabel(e){e||(e="");const t=p("diff-aria-navigation-tip"," use {0} to open the accessibility help.",this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp")?.getAriaLabel());return this._options.accessibilityVerbose.get()?e+t:e?e.replaceAll(t,""):""}};VR=xCe([Z9(5,ye),Z9(6,yt)],VR);class LF extends B{constructor(){super(...arguments),this._id=++LF.idCounter,this._onDidDispose=this._register(new O),this.onDidDispose=this._onDidDispose.event}static{this.idCounter=0}getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(e){return this._targetEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._targetEditor.getPosition()}setPosition(e,t="api"){this._targetEditor.setPosition(e,t)}revealLine(e,t=0){this._targetEditor.revealLine(e,t)}revealLineInCenter(e,t=0){this._targetEditor.revealLineInCenter(e,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealLineInCenterIfOutsideViewport(e,t)}revealLineNearTop(e,t=0){this._targetEditor.revealLineNearTop(e,t)}revealPosition(e,t=0){this._targetEditor.revealPosition(e,t)}revealPositionInCenter(e,t=0){this._targetEditor.revealPositionInCenter(e,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(e,t)}revealPositionNearTop(e,t=0){this._targetEditor.revealPositionNearTop(e,t)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(e,t="api"){this._targetEditor.setSelection(e,t)}setSelections(e,t="api"){this._targetEditor.setSelections(e,t)}revealLines(e,t,i=0){this._targetEditor.revealLines(e,t,i)}revealLinesInCenter(e,t,i=0){this._targetEditor.revealLinesInCenter(e,t,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(e,t,i)}revealLinesNearTop(e,t,i=0){this._targetEditor.revealLinesNearTop(e,t,i)}revealRange(e,t=0,i=!1,n=!0){this._targetEditor.revealRange(e,t,i,n)}revealRangeInCenter(e,t=0){this._targetEditor.revealRangeInCenter(e,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(e,t)}revealRangeNearTop(e,t=0){this._targetEditor.revealRangeNearTop(e,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(e,t)}revealRangeAtTop(e,t=0){this._targetEditor.revealRangeAtTop(e,t)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(e,t,i){this._targetEditor.trigger(e,t,i)}createDecorationsCollection(e){return this._targetEditor.createDecorationsCollection(e)}changeDecorations(e){return this._targetEditor.changeDecorations(e)}}var kCe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},DCe=function(s,e){return function(t,i){e(t,i,s)}};let zR=class{get editorOptions(){return this._options}constructor(e,t){this._accessibilityService=t,this._diffEditorWidth=Ze(this,0),this._screenReaderMode=kt(this,this._accessibilityService.onDidChangeScreenReaderOptimized,()=>this._accessibilityService.isScreenReaderOptimized()),this.couldShowInlineViewBecauseOfSize=_e(this,n=>this._options.read(n).renderSideBySide&&this._diffEditorWidth.read(n)<=this._options.read(n).renderSideBySideInlineBreakpoint),this.renderOverviewRuler=_e(this,n=>this._options.read(n).renderOverviewRuler),this.renderSideBySide=_e(this,n=>this.compactMode.read(n)&&this.shouldRenderInlineViewInSmartMode.read(n)?!1:this._options.read(n).renderSideBySide&&!(this._options.read(n).useInlineViewWhenSpaceIsLimited&&this.couldShowInlineViewBecauseOfSize.read(n)&&!this._screenReaderMode.read(n))),this.readOnly=_e(this,n=>this._options.read(n).readOnly),this.shouldRenderOldRevertArrows=_e(this,n=>!(!this._options.read(n).renderMarginRevertIcon||!this.renderSideBySide.read(n)||this.readOnly.read(n)||this.shouldRenderGutterMenu.read(n))),this.shouldRenderGutterMenu=_e(this,n=>this._options.read(n).renderGutterMenu),this.renderIndicators=_e(this,n=>this._options.read(n).renderIndicators),this.enableSplitViewResizing=_e(this,n=>this._options.read(n).enableSplitViewResizing),this.splitViewDefaultRatio=_e(this,n=>this._options.read(n).splitViewDefaultRatio),this.ignoreTrimWhitespace=_e(this,n=>this._options.read(n).ignoreTrimWhitespace),this.maxComputationTimeMs=_e(this,n=>this._options.read(n).maxComputationTime),this.showMoves=_e(this,n=>this._options.read(n).experimental.showMoves&&this.renderSideBySide.read(n)),this.isInEmbeddedEditor=_e(this,n=>this._options.read(n).isInEmbeddedEditor),this.diffWordWrap=_e(this,n=>this._options.read(n).diffWordWrap),this.originalEditable=_e(this,n=>this._options.read(n).originalEditable),this.diffCodeLens=_e(this,n=>this._options.read(n).diffCodeLens),this.accessibilityVerbose=_e(this,n=>this._options.read(n).accessibilityVerbose),this.diffAlgorithm=_e(this,n=>this._options.read(n).diffAlgorithm),this.showEmptyDecorations=_e(this,n=>this._options.read(n).experimental.showEmptyDecorations),this.onlyShowAccessibleDiffViewer=_e(this,n=>this._options.read(n).onlyShowAccessibleDiffViewer),this.compactMode=_e(this,n=>this._options.read(n).compactMode),this.trueInlineDiffRenderingEnabled=_e(this,n=>this._options.read(n).experimental.useTrueInlineView),this.useTrueInlineDiffRendering=_e(this,n=>!this.renderSideBySide.read(n)&&this.trueInlineDiffRenderingEnabled.read(n)),this.hideUnchangedRegions=_e(this,n=>this._options.read(n).hideUnchangedRegions.enabled),this.hideUnchangedRegionsRevealLineCount=_e(this,n=>this._options.read(n).hideUnchangedRegions.revealLineCount),this.hideUnchangedRegionsContextLineCount=_e(this,n=>this._options.read(n).hideUnchangedRegions.contextLineCount),this.hideUnchangedRegionsMinimumLineCount=_e(this,n=>this._options.read(n).hideUnchangedRegions.minimumLineCount),this._model=Ze(this,void 0),this.shouldRenderInlineViewInSmartMode=this._model.map(this,n=>Zce(this,o=>{const r=n?.diff.read(o);return r?ICe(r,this.trueInlineDiffRenderingEnabled.read(o)):void 0})).flatten().map(this,n=>!!n),this.inlineViewHideOriginalLineNumbers=this.compactMode;const i={...e,...K9(e,xn)};this._options=Ze(this,i)}updateOptions(e){const t=K9(e,this._options.get()),i={...this._options.get(),...e,...t};this._options.set(i,void 0,{changedOptions:e})}setWidth(e){this._diffEditorWidth.set(e,void 0)}setModel(e){this._model.set(e,void 0)}};zR=kCe([DCe(1,vo)],zR);function ICe(s,e){return s.mappings.every(t=>TCe(t.lineRangeMapping)||ECe(t.lineRangeMapping)||e&&wF(t.lineRangeMapping))}function TCe(s){return s.original.length===0}function ECe(s){return s.modified.length===0}function K9(s,e){return{enableSplitViewResizing:ve(s.enableSplitViewResizing,e.enableSplitViewResizing),splitViewDefaultRatio:NQ(s.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:ve(s.renderSideBySide,e.renderSideBySide),renderMarginRevertIcon:ve(s.renderMarginRevertIcon,e.renderMarginRevertIcon),maxComputationTime:jh(s.maxComputationTime,e.maxComputationTime,0,1073741824),maxFileSize:jh(s.maxFileSize,e.maxFileSize,0,1073741824),ignoreTrimWhitespace:ve(s.ignoreTrimWhitespace,e.ignoreTrimWhitespace),renderIndicators:ve(s.renderIndicators,e.renderIndicators),originalEditable:ve(s.originalEditable,e.originalEditable),diffCodeLens:ve(s.diffCodeLens,e.diffCodeLens),renderOverviewRuler:ve(s.renderOverviewRuler,e.renderOverviewRuler),diffWordWrap:pi(s.diffWordWrap,e.diffWordWrap,["off","on","inherit"]),diffAlgorithm:pi(s.diffAlgorithm,e.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:ve(s.accessibilityVerbose,e.accessibilityVerbose),experimental:{showMoves:ve(s.experimental?.showMoves,e.experimental.showMoves),showEmptyDecorations:ve(s.experimental?.showEmptyDecorations,e.experimental.showEmptyDecorations),useTrueInlineView:ve(s.experimental?.useTrueInlineView,e.experimental.useTrueInlineView)},hideUnchangedRegions:{enabled:ve(s.hideUnchangedRegions?.enabled??s.experimental?.collapseUnchangedRegions,e.hideUnchangedRegions.enabled),contextLineCount:jh(s.hideUnchangedRegions?.contextLineCount,e.hideUnchangedRegions.contextLineCount,0,1073741824),minimumLineCount:jh(s.hideUnchangedRegions?.minimumLineCount,e.hideUnchangedRegions.minimumLineCount,0,1073741824),revealLineCount:jh(s.hideUnchangedRegions?.revealLineCount,e.hideUnchangedRegions.revealLineCount,0,1073741824)},isInEmbeddedEditor:ve(s.isInEmbeddedEditor,e.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:ve(s.onlyShowAccessibleDiffViewer,e.onlyShowAccessibleDiffViewer),renderSideBySideInlineBreakpoint:jh(s.renderSideBySideInlineBreakpoint,e.renderSideBySideInlineBreakpoint,0,1073741824),useInlineViewWhenSpaceIsLimited:ve(s.useInlineViewWhenSpaceIsLimited,e.useInlineViewWhenSpaceIsLimited),renderGutterMenu:ve(s.renderGutterMenu,e.renderGutterMenu),compactMode:ve(s.compactMode,e.compactMode)}}var NCe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},c_=function(s,e){return function(t,i){e(t,i,s)}};let $c=class extends LF{get onDidContentSizeChange(){return this._editors.onDidContentSizeChange}constructor(e,t,i,n,o,r,a,l){super(),this._domElement=e,this._parentContextKeyService=n,this._parentInstantiationService=o,this._accessibilitySignalService=a,this._editorProgressService=l,this.elements=Ye("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[Ye("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),Ye("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),Ye("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]),this._diffModelSrc=this._register(gv(this,void 0)),this._diffModel=_e(this,y=>this._diffModelSrc.read(y)?.object),this.onDidChangeModel=se.fromObservableLight(this._diffModel),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement)),this._instantiationService=this._register(this._parentInstantiationService.createChild(new Nm([Ee,this._contextKeyService]))),this._boundarySashes=Ze(this,void 0),this._accessibleDiffViewerShouldBeVisible=Ze(this,!1),this._accessibleDiffViewerVisible=_e(this,y=>this._options.onlyShowAccessibleDiffViewer.read(y)?!0:this._accessibleDiffViewerShouldBeVisible.read(y)),this._movedBlocksLinesPart=Ze(this,void 0),this._layoutInfo=_e(this,y=>{const w=this._rootSizeObserver.width.read(y),x=this._rootSizeObserver.height.read(y);this._rootSizeObserver.automaticLayout?this.elements.root.style.height="100%":this.elements.root.style.height=x+"px";const L=this._sash.read(y),D=this._gutter.read(y),T=D?.width.read(y)??0,F=this._overviewRulerPart.read(y)?.width??0;let W,H,$,V,Y;if(!!L){const ue=L.sashLeft.read(y),fe=this._movedBlocksLinesPart.read(y)?.width.read(y)??0;W=0,H=ue-T-fe,Y=ue-T,$=ue,V=w-$-F}else{Y=0;const ue=this._options.inlineViewHideOriginalLineNumbers.read(y);W=T,ue?H=0:H=Math.max(5,this._editors.originalObs.layoutInfoDecorationsLeft.read(y)),$=T+H,V=w-$-F}return this.elements.original.style.left=W+"px",this.elements.original.style.width=H+"px",this._editors.original.layout({width:H,height:x},!0),D?.layout(Y),this.elements.modified.style.left=$+"px",this.elements.modified.style.width=V+"px",this._editors.modified.layout({width:V,height:x},!0),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}}),this._diffValue=this._diffModel.map((y,w)=>y?.diff.read(w)),this.onDidUpdateDiff=se.fromObservableLight(this._diffValue),r.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._domElement.appendChild(this.elements.root),this._register(Ce(()=>this.elements.root.remove())),this._rootSizeObserver=this._register(new rj(this.elements.root,t.dimension)),this._rootSizeObserver.setAutomaticLayout(t.automaticLayout??!1),this._options=this._instantiationService.createInstance(zR,t),this._register(Pe(y=>{this._options.setWidth(this._rootSizeObserver.width.read(y))})),this._contextKeyService.createKey(I.isEmbeddedDiffEditor.key,!1),this._register(fa(I.isEmbeddedDiffEditor,this._contextKeyService,y=>this._options.isInEmbeddedEditor.read(y))),this._register(fa(I.comparingMovedCode,this._contextKeyService,y=>!!this._diffModel.read(y)?.movedTextToCompare.read(y))),this._register(fa(I.diffEditorRenderSideBySideInlineBreakpointReached,this._contextKeyService,y=>this._options.couldShowInlineViewBecauseOfSize.read(y))),this._register(fa(I.diffEditorInlineMode,this._contextKeyService,y=>!this._options.renderSideBySide.read(y))),this._register(fa(I.hasChanges,this._contextKeyService,y=>(this._diffModel.read(y)?.diff.read(y)?.mappings.length??0)>0)),this._editors=this._register(this._instantiationService.createInstance(VR,this.elements.original,this.elements.modified,this._options,i,(y,w,x,L)=>this._createInnerEditor(y,w,x,L))),this._register(fa(I.diffEditorOriginalWritable,this._contextKeyService,y=>this._options.originalEditable.read(y))),this._register(fa(I.diffEditorModifiedWritable,this._contextKeyService,y=>!this._options.readOnly.read(y))),this._register(fa(I.diffEditorOriginalUri,this._contextKeyService,y=>this._diffModel.read(y)?.model.original.uri.toString()??"")),this._register(fa(I.diffEditorModifiedUri,this._contextKeyService,y=>this._diffModel.read(y)?.model.modified.uri.toString()??"")),this._overviewRulerPart=Jn(this,y=>this._options.renderOverviewRuler.read(y)?this._instantiationService.createInstance(so(Wv,y),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map(w=>w.modifiedEditor)):void 0).recomputeInitiallyAndOnChange(this._store);const c={height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map((y,w)=>y-(this._overviewRulerPart.read(w)?.width??0))};this._sashLayout=new fCe(this._options,c),this._sash=Jn(this,y=>{const w=this._options.renderSideBySide.read(y);return this.elements.root.classList.toggle("side-by-side",w),w?new hj(this.elements.root,c,this._options.enableSplitViewResizing,this._boundarySashes,this._sashLayout.sashLeft,()=>this._sashLayout.resetSash()):void 0}).recomputeInitiallyAndOnChange(this._store);const d=Jn(this,y=>this._instantiationService.createInstance(so(bS,y),this._editors,this._diffModel,this._options)).recomputeInitiallyAndOnChange(this._store);Jn(this,y=>this._instantiationService.createInstance(so(gCe,y),this._editors,this._diffModel,this._options,this)).recomputeInitiallyAndOnChange(this._store);const h=new Set,u=new Set;let g=!1;const f=Jn(this,y=>this._instantiationService.createInstance(so(FR,y),ke(this._domElement),this._editors,this._diffModel,this._options,this,()=>g||d.get().isUpdatingHiddenAreas,h,u)).recomputeInitiallyAndOnChange(this._store),m=_e(this,y=>{const w=f.read(y).viewZones.read(y).orig,x=d.read(y).viewZones.read(y).origViewZones;return w.concat(x)}),_=_e(this,y=>{const w=f.read(y).viewZones.read(y).mod,x=d.read(y).viewZones.read(y).modViewZones;return w.concat(x)});this._register(gS(this._editors.original,m,y=>{g=y},h));let b;this._register(gS(this._editors.modified,_,y=>{g=y,g?b=$a.capture(this._editors.modified):(b?.restore(this._editors.modified),b=void 0)},u)),this._accessibleDiffViewer=Jn(this,y=>this._instantiationService.createInstance(so(wu,y),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,(w,x)=>this._accessibleDiffViewerShouldBeVisible.set(w,x),this._options.onlyShowAccessibleDiffViewer.map(w=>!w),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map((w,x)=>w?.diff.read(x)?.mappings.map(L=>L.lineRangeMapping)),new tCe(this._editors))).recomputeInitiallyAndOnChange(this._store);const v=this._accessibleDiffViewerVisible.map(y=>y?"hidden":"visible");this._register(Uc(this.elements.modified,{visibility:v})),this._register(Uc(this.elements.original,{visibility:v})),this._createDiffEditorContributions(),r.addDiffEditor(this),this._gutter=Jn(this,y=>this._options.shouldRenderGutterMenu.read(y)?this._instantiationService.createInstance(so(BR,y),this.elements.root,this._diffModel,this._editors,this._options,this._sashLayout,this._boundarySashes):void 0),this._register(Dm(this._layoutInfo)),Jn(this,y=>new(so(Ou,y))(this.elements.root,this._diffModel,this._layoutInfo.map(w=>w.originalEditor),this._layoutInfo.map(w=>w.modifiedEditor),this._editors)).recomputeInitiallyAndOnChange(this._store,y=>{this._movedBlocksLinesPart.set(y,void 0)}),this._register(se.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,y=>this._handleCursorPositionChange(y,!0))),this._register(se.runAndSubscribe(this._editors.original.onDidChangeCursorPosition,y=>this._handleCursorPositionChange(y,!1)));const C=this._diffModel.map(this,(y,w)=>{if(y)return y.diff.read(w)===void 0&&!y.isDiffUpToDate.read(w)});this._register(Us((y,w)=>{if(C.read(y)===!0){const x=this._editorProgressService.show(!0,1e3);w.add(Ce(()=>x.done()))}})),this._register(Us((y,w)=>{w.add(new(so(SCe,y))(this._editors,this._diffModel,this._options,this))})),this._register(Us((y,w)=>{const x=this._diffModel.read(y);if(x)for(const L of[x.model.original,x.model.modified])w.add(L.onWillDispose(D=>{Oe(new mt("TextModel got disposed before DiffEditorWidget model got reset")),this.setModel(null)}))})),this._register(Pe(y=>{this._options.setModel(this._diffModel.read(y))}))}_createInnerEditor(e,t,i,n){return e.createInstance(Pv,t,i,n)}_createDiffEditorContributions(){const e=Iu.getDiffEditorContributions();for(const t of e)try{this._register(this._instantiationService.createInstance(t.ctor,this))}catch(i){Oe(i)}}get _targetEditor(){return this._editors.modified}getEditorType(){return VC.IDiffEditor}layout(e){this._rootSizeObserver.observe(e)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){const e=this._editors.original.saveViewState(),t=this._editors.modified.saveViewState();return{original:e,modified:t,modelState:this._diffModel.get()?.serializeState()}}restoreViewState(e){if(e&&e.original&&e.modified){const t=e;this._editors.original.restoreViewState(t.original),this._editors.modified.restoreViewState(t.modified),t.modelState&&this._diffModel.get()?.restoreSerializedState(t.modelState)}}handleInitialized(){this._editors.original.handleInitialized(),this._editors.modified.handleInitialized()}createViewModel(e){return this._instantiationService.createInstance(OR,e,this._options)}getModel(){return this._diffModel.get()?.model??null}setModel(e){const t=e?"model"in e?fS.create(e).createNewRef(this):fS.create(this.createViewModel(e),this):null;this.setDiffModel(t)}setDiffModel(e,t){const i=this._diffModel.get();!e&&i&&this._accessibleDiffViewer.get().close(),this._diffModel.get()!==e?.object&&Qu(t,n=>{const o=e?.object;kt.batchEventsGlobally(n,()=>{this._editors.original.setModel(o?o.model.original:null),this._editors.modified.setModel(o?o.model.modified:null)});const r=this._diffModelSrc.get()?.createNewRef(this);this._diffModelSrc.set(e?.createNewRef(this),n),setTimeout(()=>{r?.dispose()},0)})}updateOptions(e){this._options.updateOptions(e)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}getLineChanges(){const e=this._diffModel.get()?.diff.get();return e?RCe(e):null}revert(e){const t=this._diffModel.get();!t||!t.isDiffUpToDate.get()||this._editors.modified.executeEdits("diffEditor",[{range:e.modified.toExclusiveRange(),text:t.model.original.getValueInRange(e.original.toExclusiveRange())}])}revertRangeMappings(e){const t=this._diffModel.get();if(!t||!t.isDiffUpToDate.get())return;const i=e.map(n=>({range:n.modifiedRange,text:t.model.original.getValueInRange(n.originalRange)}));this._editors.modified.executeEdits("diffEditor",i)}_goTo(e){this._editors.modified.setPosition(new P(e.lineRangeMapping.modified.startLineNumber,1)),this._editors.modified.revealRangeInCenter(e.lineRangeMapping.modified.toExclusiveRange())}goToDiff(e){const t=this._diffModel.get()?.diff.get()?.mappings;if(!t||t.length===0)return;const i=this._editors.modified.getPosition().lineNumber;let n;e==="next"?n=t.find(o=>o.lineRangeMapping.modified.startLineNumber>i)??t[0]:n=Xb(t,o=>o.lineRangeMapping.modified.startLineNumber<i)??t[t.length-1],this._goTo(n),n.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(Lt.diffLineDeleted,{source:"diffEditor.goToDiff"}):n.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(Lt.diffLineInserted,{source:"diffEditor.goToDiff"}):n&&this._accessibilitySignalService.playSignal(Lt.diffLineModified,{source:"diffEditor.goToDiff"})}revealFirstDiff(){const e=this._diffModel.get();e&&this.waitForDiff().then(()=>{const t=e.diff.get()?.mappings;!t||t.length===0||this._goTo(t[0])})}accessibleDiffViewerNext(){this._accessibleDiffViewer.get().next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.get().prev()}async waitForDiff(){const e=this._diffModel.get();e&&await e.waitForDiff()}mapToOtherSide(){const e=this._editors.modified.hasWidgetFocus(),t=e?this._editors.modified:this._editors.original,i=e?this._editors.original:this._editors.modified;let n;const o=t.getSelection();if(o){const r=this._diffModel.get()?.diff.get()?.mappings.map(a=>e?a.lineRangeMapping.flip():a.lineRangeMapping);if(r){const a=N9(o.getStartPosition(),r),l=N9(o.getEndPosition(),r);n=k.plusRange(a,l)}}return{destination:i,destinationSelection:n}}switchSide(){const{destination:e,destinationSelection:t}=this.mapToOtherSide();e.focus(),t&&e.setSelection(t)}exitCompareMove(){const e=this._diffModel.get();e&&e.movedTextToCompare.set(void 0,void 0)}collapseAllUnchangedRegions(){const e=this._diffModel.get()?.unchangedRegions.get();e&&ai(t=>{for(const i of e)i.collapseAll(t)})}showAllUnchangedRegions(){const e=this._diffModel.get()?.unchangedRegions.get();e&&ai(t=>{for(const i of e)i.showAll(t)})}_handleCursorPositionChange(e,t){if(e?.reason===3){const i=this._diffModel.get()?.diff.get()?.mappings.find(n=>t?n.lineRangeMapping.modified.contains(e.position.lineNumber):n.lineRangeMapping.original.contains(e.position.lineNumber));i?.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(Lt.diffLineDeleted,{source:"diffEditor.cursorPositionChanged"}):i?.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(Lt.diffLineInserted,{source:"diffEditor.cursorPositionChanged"}):i&&this._accessibilitySignalService.playSignal(Lt.diffLineModified,{source:"diffEditor.cursorPositionChanged"})}}};$c=NCe([c_(3,Ee),c_(4,ye),c_(5,ft),c_(6,Lh),c_(7,yh)],$c);function RCe(s){return s.mappings.map(e=>{const t=e.lineRangeMapping;let i,n,o,r,a=t.innerChanges;return t.original.isEmpty?(i=t.original.startLineNumber-1,n=0,a=void 0):(i=t.original.startLineNumber,n=t.original.endLineNumberExclusive-1),t.modified.isEmpty?(o=t.modified.startLineNumber-1,r=0,a=void 0):(o=t.modified.startLineNumber,r=t.modified.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:n,modifiedStartLineNumber:o,modifiedEndLineNumber:r,charChanges:a?.map(l=>({originalStartLineNumber:l.originalRange.startLineNumber,originalStartColumn:l.originalRange.startColumn,originalEndLineNumber:l.originalRange.endLineNumber,originalEndColumn:l.originalRange.endColumn,modifiedStartLineNumber:l.modifiedRange.startLineNumber,modifiedStartColumn:l.modifiedRange.startColumn,modifiedEndLineNumber:l.modifiedRange.endLineNumber,modifiedEndColumn:l.modifiedRange.endColumn}))}})}var xF=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Vt=function(s,e){return function(t,i){e(t,i,s)}};let MCe=0,q9=!1;function ACe(s){if(!s){if(q9)return;q9=!0}Fle(s||Nt.document.body)}let CS=class extends Pv{constructor(e,t,i,n,o,r,a,l,c,d,h,u,g){const f={...t};f.ariaLabel=f.ariaLabel||sN.editorViewAccessibleLabel,super(e,f,{},i,n,o,r,c,d,h,u,g),l instanceof zp?this._standaloneKeybindingService=l:this._standaloneKeybindingService=null,ACe(f.ariaContainerElement),Xce((m,_)=>i.createInstance(Ep,m,_,{})),Qce(a)}addCommand(e,t,i){if(!this._standaloneKeybindingService)return console.warn("Cannot add command because the editor is configured with an unrecognized KeybindingService"),null;const n="DYNAMIC_"+ ++MCe,o=q.deserialize(i);return this._standaloneKeybindingService.addDynamicKeybinding(n,e,t,o),n}createContextKey(e,t){return this._contextKeyService.createKey(e,t)}addAction(e){if(typeof e.id!="string"||typeof e.label!="string"||typeof e.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");if(!this._standaloneKeybindingService)return console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),B.None;const t=e.id,i=e.label,n=q.and(q.equals("editorId",this.getId()),q.deserialize(e.precondition)),o=e.keybindings,r=q.and(n,q.deserialize(e.keybindingContext)),a=e.contextMenuGroupId||null,l=e.contextMenuOrder||0,c=(g,...f)=>Promise.resolve(e.run(this,...f)),d=new Z,h=this.getId()+":"+t;if(d.add(ot.registerCommand(h,c)),a){const g={command:{id:h,title:i},when:n,group:a,order:l};d.add(hn.appendMenuItem(M.EditorContext,g))}if(Array.isArray(o))for(const g of o)d.add(this._standaloneKeybindingService.addDynamicKeybinding(h,g,c,r));const u=new ij(h,i,i,void 0,n,(...g)=>Promise.resolve(e.run(this,...g)),this._contextKeyService);return this._actions.set(t,u),d.add(Ce(()=>{this._actions.delete(t)})),d}_triggerCommand(e,t){if(this._codeEditorService instanceof t0)try{this._codeEditorService.setActiveCodeEditor(this),super._triggerCommand(e,t)}finally{this._codeEditorService.setActiveCodeEditor(null)}else super._triggerCommand(e,t)}};CS=xF([Vt(2,ye),Vt(3,ft),Vt(4,Ht),Vt(5,Ee),Vt(6,Vl),Vt(7,yt),Vt(8,Ki),Vt(9,Ii),Vt(10,vo),Vt(11,di),Vt(12,pe)],CS);let UR=class extends CS{constructor(e,t,i,n,o,r,a,l,c,d,h,u,g,f,m,_){const b={...t};tS(h,b,!1);const v=c.registerEditorContainer(e);typeof b.theme=="string"&&c.setTheme(b.theme),typeof b.autoDetectHighContrast<"u"&&c.setAutoDetectHighContrast(!!b.autoDetectHighContrast);const C=b.model;delete b.model,super(e,b,i,n,o,r,a,l,c,d,u,m,_),this._configurationService=h,this._standaloneThemeService=c,this._register(v);let y;if(typeof C>"u"){const w=f.getLanguageIdByMimeType(b.language)||b.language||Cs;y=pj(g,f,b.value||"",w,void 0),this._ownsModel=!0}else y=C,this._ownsModel=!1;if(this._attachModel(y),y){const w={oldModelUrl:null,newModelUrl:y.uri};this._onDidChangeModel.fire(w)}}dispose(){super.dispose()}updateOptions(e){tS(this._configurationService,e,!1),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_postDetachModelCleanup(e){super._postDetachModelCleanup(e),e&&this._ownsModel&&(e.dispose(),this._ownsModel=!1)}};UR=xF([Vt(2,ye),Vt(3,ft),Vt(4,Ht),Vt(5,Ee),Vt(6,Vl),Vt(7,yt),Vt(8,Qo),Vt(9,Ii),Vt(10,Ke),Vt(11,vo),Vt(12,Zt),Vt(13,ni),Vt(14,di),Vt(15,pe)],UR);let $R=class extends $c{constructor(e,t,i,n,o,r,a,l,c,d,h,u){const g={...t};tS(l,g,!0);const f=r.registerEditorContainer(e);typeof g.theme=="string"&&r.setTheme(g.theme),typeof g.autoDetectHighContrast<"u"&&r.setAutoDetectHighContrast(!!g.autoDetectHighContrast),super(e,g,{},n,i,o,u,d),this._configurationService=l,this._standaloneThemeService=r,this._register(f)}dispose(){super.dispose()}updateOptions(e){tS(this._configurationService,e,!0),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_createInnerEditor(e,t,i){return e.createInstance(CS,t,i)}getOriginalEditor(){return super.getOriginalEditor()}getModifiedEditor(){return super.getModifiedEditor()}addCommand(e,t,i){return this.getModifiedEditor().addCommand(e,t,i)}createContextKey(e,t){return this.getModifiedEditor().createContextKey(e,t)}addAction(e){return this.getModifiedEditor().addAction(e)}};$R=xF([Vt(2,ye),Vt(3,Ee),Vt(4,ft),Vt(5,Qo),Vt(6,Ii),Vt(7,Ke),Vt(8,bo),Vt(9,yh),Vt(10,Jc),Vt(11,Lh)],$R);function pj(s,e,t,i,n){if(t=t||"",!i){const o=t.indexOf(`
`);let r=t;return o!==-1&&(r=t.substring(0,o)),G9(s,t,e.createByFilepathOrFirstLine(n||null,r),n)}return G9(s,t,e.createById(i),n)}function G9(s,e,t,i){return s.createModel(e,t,i)}var PCe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Y9=function(s,e){return function(t,i){e(t,i,s)}};class OCe{constructor(e,t){this.viewModel=e,this.deltaScrollVertical=t}getId(){return this.viewModel}}let yS=class extends B{constructor(e,t,i,n,o){super(),this._container=e,this._overflowWidgetsDomNode=t,this._workbenchUIElementFactory=i,this._instantiationService=n,this._viewModel=Ze(this,void 0),this._collapsed=_e(this,l=>this._viewModel.read(l)?.collapsed.read(l)),this._editorContentHeight=Ze(this,500),this.contentHeight=_e(this,l=>(this._collapsed.read(l)?0:this._editorContentHeight.read(l))+this._outerEditorHeight),this._modifiedContentWidth=Ze(this,0),this._modifiedWidth=Ze(this,0),this._originalContentWidth=Ze(this,0),this._originalWidth=Ze(this,0),this.maxScroll=_e(this,l=>{const c=this._modifiedContentWidth.read(l)-this._modifiedWidth.read(l),d=this._originalContentWidth.read(l)-this._originalWidth.read(l);return c>d?{maxScroll:c,width:this._modifiedWidth.read(l)}:{maxScroll:d,width:this._originalWidth.read(l)}}),this._elements=Ye("div.multiDiffEntry",[Ye("div.header@header",[Ye("div.header-content",[Ye("div.collapse-button@collapseButton"),Ye("div.file-path",[Ye("div.title.modified.show-file-icons@primaryPath",[]),Ye("div.status.deleted@status",["R"]),Ye("div.title.original.show-file-icons@secondaryPath",[])]),Ye("div.actions@actions")])]),Ye("div.editorParent",[Ye("div.editorContainer@editor")])]),this.editor=this._register(this._instantiationService.createInstance($c,this._elements.editor,{overflowWidgetsDomNode:this._overflowWidgetsDomNode},{})),this.isModifedFocused=ao(this.editor.getModifiedEditor()).isFocused,this.isOriginalFocused=ao(this.editor.getOriginalEditor()).isFocused,this.isFocused=_e(this,l=>this.isModifedFocused.read(l)||this.isOriginalFocused.read(l)),this._resourceLabel=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.primaryPath)):void 0,this._resourceLabel2=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.secondaryPath)):void 0,this._dataStore=this._register(new Z),this._headerHeight=40,this._lastScrollTop=-1,this._isSettingScrollTop=!1;const r=new O0(this._elements.collapseButton,{});this._register(Pe(l=>{r.element.className="",r.icon=this._collapsed.read(l)?J.chevronRight:J.chevronDown})),this._register(r.onDidClick(()=>{this._viewModel.get()?.collapsed.set(!this._collapsed.get(),void 0)})),this._register(Pe(l=>{this._elements.editor.style.display=this._collapsed.read(l)?"none":"block"})),this._register(this.editor.getModifiedEditor().onDidLayoutChange(l=>{const c=this.editor.getModifiedEditor().getLayoutInfo().contentWidth;this._modifiedWidth.set(c,void 0)})),this._register(this.editor.getOriginalEditor().onDidLayoutChange(l=>{const c=this.editor.getOriginalEditor().getLayoutInfo().contentWidth;this._originalWidth.set(c,void 0)})),this._register(this.editor.onDidContentSizeChange(l=>{k_(c=>{this._editorContentHeight.set(l.contentHeight,c),this._modifiedContentWidth.set(this.editor.getModifiedEditor().getContentWidth(),c),this._originalContentWidth.set(this.editor.getOriginalEditor().getContentWidth(),c)})})),this._register(this.editor.getOriginalEditor().onDidScrollChange(l=>{if(this._isSettingScrollTop||!l.scrollTopChanged||!this._data)return;const c=l.scrollTop-this._lastScrollTop;this._data.deltaScrollVertical(c)})),this._register(Pe(l=>{const c=this._viewModel.read(l)?.isActive.read(l);this._elements.root.classList.toggle("active",c)})),this._container.appendChild(this._elements.root),this._outerEditorHeight=this._headerHeight,this._contextKeyService=this._register(o.createScoped(this._elements.actions));const a=this._register(this._instantiationService.createChild(new Nm([Ee,this._contextKeyService])));this._register(a.createInstance(_S,this._elements.actions,M.MultiDiffEditorFileToolbar,{actionRunner:this._register(new uj(()=>this._viewModel.get()?.modifiedUri)),menuOptions:{shouldForwardArgs:!0},toolbarOptions:{primaryGroup:l=>l.startsWith("navigation")},actionViewItemProvider:(l,c)=>lU(a,l,c)}))}setScrollLeft(e){this._modifiedContentWidth.get()-this._modifiedWidth.get()>this._originalContentWidth.get()-this._originalWidth.get()?this.editor.getModifiedEditor().setScrollLeft(e):this.editor.getOriginalEditor().setScrollLeft(e)}setData(e){this._data=e;function t(n){return{...n,scrollBeyondLastLine:!1,hideUnchangedRegions:{enabled:!0},scrollbar:{vertical:"hidden",horizontal:"hidden",handleMouseWheel:!1,useShadows:!1},renderOverviewRuler:!1,fixedOverflowWidgets:!0,overviewRulerBorder:!1}}if(!e){k_(n=>{this._viewModel.set(void 0,n),this.editor.setDiffModel(null,n),this._dataStore.clear()});return}const i=e.viewModel.documentDiffItem;if(k_(n=>{this._resourceLabel?.setUri(e.viewModel.modifiedUri??e.viewModel.originalUri,{strikethrough:e.viewModel.modifiedUri===void 0});let o=!1,r=!1,a=!1,l="";e.viewModel.modifiedUri&&e.viewModel.originalUri&&e.viewModel.modifiedUri.path!==e.viewModel.originalUri.path?(l="R",o=!0):e.viewModel.modifiedUri?e.viewModel.originalUri||(l="A",a=!0):(l="D",r=!0),this._elements.status.classList.toggle("renamed",o),this._elements.status.classList.toggle("deleted",r),this._elements.status.classList.toggle("added",a),this._elements.status.innerText=l,this._resourceLabel2?.setUri(o?e.viewModel.originalUri:void 0,{strikethrough:!0}),this._dataStore.clear(),this._viewModel.set(e.viewModel,n),this.editor.setDiffModel(e.viewModel.diffEditorViewModelRef,n),this.editor.updateOptions(t(i.options??{}))}),i.onOptionsDidChange&&this._dataStore.add(i.onOptionsDidChange(()=>{this.editor.updateOptions(t(i.options??{}))})),e.viewModel.isAlive.recomputeInitiallyAndOnChange(this._dataStore,n=>{n||this.setData(void 0)}),e.viewModel.documentDiffItem.contextKeys)for(const[n,o]of Object.entries(e.viewModel.documentDiffItem.contextKeys))this._contextKeyService.createKey(n,o)}render(e,t,i,n){this._elements.root.style.visibility="visible",this._elements.root.style.top=`${e.start}px`,this._elements.root.style.height=`${e.length}px`,this._elements.root.style.width=`${t}px`,this._elements.root.style.position="absolute";const o=e.length-this._headerHeight,r=Math.max(0,Math.min(n.start-e.start,o));this._elements.header.style.transform=`translateY(${r}px)`,k_(a=>{this.editor.layout({width:t-2*8-2*1,height:e.length-this._outerEditorHeight})});try{this._isSettingScrollTop=!0,this._lastScrollTop=i,this.editor.getOriginalEditor().setScrollTop(i)}finally{this._isSettingScrollTop=!1}this._elements.header.classList.toggle("shadow",r>0||i>0),this._elements.header.classList.toggle("collapsed",r===o)}hide(){this._elements.root.style.top="-100000px",this._elements.root.style.visibility="hidden"}};yS=PCe([Y9(3,ye),Y9(4,Ee)],yS);class FCe{constructor(e){this._create=e,this._unused=new Set,this._used=new Set,this._itemData=new Map}getUnusedObj(e){let t;if(this._unused.size===0)t=this._create(e),this._itemData.set(t,e);else{const i=[...this._unused.values()];t=i.find(n=>this._itemData.get(n).getId()===e.getId())??i[0],this._unused.delete(t),this._itemData.set(t,e),t.setData(e)}return this._used.add(t),{object:t,dispose:()=>{this._used.delete(t),this._unused.size>5?t.dispose():this._unused.add(t)}}}dispose(){for(const e of this._used)e.dispose();for(const e of this._unused)e.dispose();this._used.clear(),this._unused.clear()}}var BCe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},X9=function(s,e){return function(t,i){e(t,i,s)}};let jR=class extends B{constructor(e,t,i,n,o,r){super(),this._element=e,this._dimension=t,this._viewModel=i,this._workbenchUIElementFactory=n,this._parentContextKeyService=o,this._parentInstantiationService=r,this._scrollableElements=Ye("div.scrollContent",[Ye("div@content",{style:{overflow:"hidden"}}),Ye("div.monaco-editor@overflowWidgetsDomNode",{})]),this._scrollable=this._register(new Sm({forceIntegerValues:!1,scheduleAtNextAnimationFrame:l=>mo(ke(this._element),l),smoothScrollDuration:100})),this._scrollableElement=this._register(new YL(this._scrollableElements.root,{vertical:1,horizontal:1,useShadows:!1},this._scrollable)),this._elements=Ye("div.monaco-component.multiDiffEditor",{},[Ye("div",{},[this._scrollableElement.getDomNode()]),Ye("div.placeholder@placeholder",{},[Ye("div",[p("noChangedFiles","No Changed Files")])])]),this._sizeObserver=this._register(new rj(this._element,void 0)),this._objectPool=this._register(new FCe(l=>{const c=this._instantiationService.createInstance(yS,this._scrollableElements.content,this._scrollableElements.overflowWidgetsDomNode,this._workbenchUIElementFactory);return c.setData(l),c})),this.scrollTop=kt(this,this._scrollableElement.onScroll,()=>this._scrollableElement.getScrollPosition().scrollTop),this.scrollLeft=kt(this,this._scrollableElement.onScroll,()=>this._scrollableElement.getScrollPosition().scrollLeft),this._viewItemsInfo=wh(this,(l,c)=>{const d=this._viewModel.read(l);if(!d)return{items:[],getItem:f=>{throw new mt}};const h=d.items.read(l),u=new Map;return{items:h.map(f=>{const m=c.add(new WCe(f,this._objectPool,this.scrollLeft,b=>{this._scrollableElement.setScrollPosition({scrollTop:this._scrollableElement.getScrollPosition().scrollTop+b})})),_=this._lastDocStates?.[m.getKey()];return _&&ai(b=>{m.setViewState(_,b)}),u.set(f,m),m}),getItem:f=>u.get(f)}}),this._viewItems=this._viewItemsInfo.map(this,l=>l.items),this._spaceBetweenPx=0,this._totalHeight=this._viewItems.map(this,(l,c)=>l.reduce((d,h)=>d+h.contentHeight.read(c)+this._spaceBetweenPx,0)),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._element)),this._instantiationService=this._register(this._parentInstantiationService.createChild(new Nm([Ee,this._contextKeyService]))),this._lastDocStates={},this._contextKeyService.createKey(I.inMultiDiffEditor.key,!0),this._register(Us((l,c)=>{const d=this._viewModel.read(l);if(d&&d.contextKeys)for(const[h,u]of Object.entries(d.contextKeys)){const g=this._contextKeyService.createKey(h,void 0);g.set(u),c.add(Ce(()=>g.reset()))}}));const a=this._parentContextKeyService.createKey(I.multiDiffEditorAllCollapsed.key,!1);this._register(Pe(l=>{const c=this._viewModel.read(l);if(c){const d=c.items.read(l).every(h=>h.collapsed.read(l));a.set(d)}})),this._register(Pe(l=>{const c=this._dimension.read(l);this._sizeObserver.observe(c)})),this._register(Pe(l=>{const c=this._viewItems.read(l);this._elements.placeholder.classList.toggle("visible",c.length===0)})),this._scrollableElements.content.style.position="relative",this._register(Pe(l=>{const c=this._sizeObserver.height.read(l);this._scrollableElements.root.style.height=`${c}px`;const d=this._totalHeight.read(l);this._scrollableElements.content.style.height=`${d}px`;const h=this._sizeObserver.width.read(l);let u=h;const g=this._viewItems.read(l),f=g2(g,bs(m=>m.maxScroll.read(l).maxScroll,qr));if(f){const m=f.maxScroll.read(l);u=h+m.maxScroll}this._scrollableElement.setScrollDimensions({width:h,height:c,scrollHeight:d,scrollWidth:u})})),e.replaceChildren(this._elements.root),this._register(Ce(()=>{e.replaceChildren()})),this._register(this._register(Pe(l=>{k_(c=>{this.render(l)})})))}render(e){const t=this.scrollTop.read(e);let i=0,n=0,o=0;const r=this._sizeObserver.height.read(e),a=qe.ofStartAndLength(t,r),l=this._sizeObserver.width.read(e);for(const c of this._viewItems.read(e)){const d=c.contentHeight.read(e),h=Math.min(d,r),u=qe.ofStartAndLength(n,h),g=qe.ofStartAndLength(o,d);if(g.isBefore(a))i-=d-h,c.hide();else if(g.isAfter(a))c.hide();else{const f=Math.max(0,Math.min(a.start-g.start,d-h));i-=f;const m=qe.ofStartAndLength(t+i,r);c.render(u,f,l,m)}n+=h+this._spaceBetweenPx,o+=d+this._spaceBetweenPx}this._scrollableElements.content.style.transform=`translateY(${-(t+i)}px)`}};jR=BCe([X9(4,Ee),X9(5,ye)],jR);class WCe extends B{constructor(e,t,i,n){super(),this.viewModel=e,this._objectPool=t,this._scrollLeft=i,this._deltaScrollVertical=n,this._templateRef=this._register(gv(this,void 0)),this.contentHeight=_e(this,o=>this._templateRef.read(o)?.object.contentHeight?.read(o)??this.viewModel.lastTemplateData.read(o).contentHeight),this.maxScroll=_e(this,o=>this._templateRef.read(o)?.object.maxScroll.read(o)??{maxScroll:0,scrollWidth:0}),this.template=_e(this,o=>this._templateRef.read(o)?.object),this._isHidden=Ze(this,!1),this._isFocused=_e(this,o=>this.template.read(o)?.isFocused.read(o)??!1),this.viewModel.setIsFocused(this._isFocused,void 0),this._register(Pe(o=>{const r=this._scrollLeft.read(o);this._templateRef.read(o)?.object.setScrollLeft(r)})),this._register(Pe(o=>{const r=this._templateRef.read(o);!r||!this._isHidden.read(o)||r.object.isFocused.read(o)||this._clear()}))}dispose(){this._clear(),super.dispose()}toString(){return`VirtualViewItem(${this.viewModel.documentDiffItem.modified?.uri.toString()})`}getKey(){return this.viewModel.getKey()}setViewState(e,t){this.viewModel.collapsed.set(e.collapsed,t),this._updateTemplateData(t);const i=this.viewModel.lastTemplateData.get(),n=e.selections?.map(me.liftSelection);this.viewModel.lastTemplateData.set({...i,selections:n},t);const o=this._templateRef.get();o&&n&&o.object.editor.setSelections(n)}_updateTemplateData(e){const t=this._templateRef.get();t&&this.viewModel.lastTemplateData.set({contentHeight:t.object.contentHeight.get(),selections:t.object.editor.getSelections()??void 0},e)}_clear(){const e=this._templateRef.get();e&&ai(t=>{this._updateTemplateData(t),e.object.hide(),this._templateRef.set(void 0,t)})}hide(){this._isHidden.set(!0,void 0)}render(e,t,i,n){this._isHidden.set(!1,void 0);let o=this._templateRef.get();if(!o){o=this._objectPool.getUnusedObj(new OCe(this.viewModel,this._deltaScrollVertical)),this._templateRef.set(o,void 0);const r=this.viewModel.lastTemplateData.get().selections;r&&o.object.editor.setSelections(r)}o.object.render(e,i,t,n)}}E("multiDiffEditor.headerBackground",{dark:"#262626",light:"tab.inactiveBackground",hcDark:"tab.inactiveBackground",hcLight:"tab.inactiveBackground"},p("multiDiffEditor.headerBackground","The background color of the diff editor's header"));E("multiDiffEditor.background",ea,p("multiDiffEditor.background","The background color of the multi file diff editor"));E("multiDiffEditor.border",{dark:"sideBarSectionHeader.border",light:"#cccccc",hcDark:"sideBarSectionHeader.border",hcLight:"#cccccc"},p("multiDiffEditor.border","The border color of the multi file diff editor"));var HCe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},VCe=function(s,e){return function(t,i){e(t,i,s)}};let ZR=class extends B{constructor(e,t,i){super(),this._element=e,this._workbenchUIElementFactory=t,this._instantiationService=i,this._dimension=Ze(this,void 0),this._viewModel=Ze(this,void 0),this._widgetImpl=wh(this,(n,o)=>(so(yS,n),o.add(this._instantiationService.createInstance(so(jR,n),this._element,this._dimension,this._viewModel,this._workbenchUIElementFactory)))),this._register(Dm(this._widgetImpl))}};ZR=HCe([VCe(2,ye)],ZR);function zCe(s,e,t){return Me.initialize(t||{}).createInstance(UR,s,e)}function UCe(s){return Me.get(ft).onCodeEditorAdd(t=>{s(t)})}function $Ce(s){return Me.get(ft).onDiffEditorAdd(t=>{s(t)})}function jCe(){return Me.get(ft).listCodeEditors()}function ZCe(){return Me.get(ft).listDiffEditors()}function KCe(s,e,t){return Me.initialize(t||{}).createInstance($R,s,e)}function qCe(s,e){const t=Me.initialize(e||{});return new ZR(s,{},t)}function GCe(s){if(typeof s.id!="string"||typeof s.run!="function")throw new Error("Invalid command descriptor, `id` and `run` are required properties!");return ot.registerCommand(s.id,s.run)}function YCe(s){if(typeof s.id!="string"||typeof s.label!="string"||typeof s.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");const e=q.deserialize(s.precondition),t=(n,...o)=>Zi.runEditorCommand(n,o,e,(r,a,l)=>Promise.resolve(s.run(a,...l))),i=new Z;if(i.add(ot.registerCommand(s.id,t)),s.contextMenuGroupId){const n={command:{id:s.id,title:s.label},when:e,group:s.contextMenuGroupId,order:s.contextMenuOrder||0};i.add(hn.appendMenuItem(M.EditorContext,n))}if(Array.isArray(s.keybindings)){const n=Me.get(yt);if(!(n instanceof zp))console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService");else{const o=q.and(e,q.deserialize(s.keybindingContext));i.add(n.addDynamicKeybindings(s.keybindings.map(r=>({keybinding:r,command:s.id,when:o}))))}}return i}function XCe(s){return mj([s])}function mj(s){const e=Me.get(yt);return e instanceof zp?e.addDynamicKeybindings(s.map(t=>({keybinding:t.keybinding,command:t.command,commandArgs:t.commandArgs,when:q.deserialize(t.when)}))):(console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),B.None)}function QCe(s,e,t){const i=Me.get(ni),n=i.getLanguageIdByMimeType(e)||e;return pj(Me.get(Zt),i,s,n,t)}function JCe(s,e){const t=Me.get(ni),i=t.getLanguageIdByMimeType(e)||e||Cs;s.setLanguage(t.createById(i))}function eye(s,e,t){s&&Me.get(zl).changeOne(e,s.uri,t)}function tye(s){Me.get(zl).changeAll(s,[])}function iye(s){return Me.get(zl).read(s)}function nye(s){return Me.get(zl).onMarkerChanged(s)}function sye(s){return Me.get(Zt).getModel(s)}function oye(){return Me.get(Zt).getModels()}function rye(s){return Me.get(Zt).onModelAdded(s)}function aye(s){return Me.get(Zt).onModelRemoved(s)}function lye(s){return Me.get(Zt).onModelLanguageChanged(t=>{s({model:t.model,oldLanguage:t.oldLanguageId})})}function cye(s){return Zpe(Me.get(Zt),s)}function dye(s,e){const t=Me.get(ni),i=Me.get(Qo);return VO.colorizeElement(i,t,s,e).then(()=>{i.registerEditorContainer(s)})}function hye(s,e,t){const i=Me.get(ni);return Me.get(Qo).registerEditorContainer(Nt.document.body),VO.colorize(i,s,e,t)}function uye(s,e,t=4){return Me.get(Qo).registerEditorContainer(Nt.document.body),VO.colorizeModelLine(s,e,t)}function gye(s){const e=mi.get(s);return e||{getInitialState:()=>Ap,tokenize:(t,i,n)=>$2(s,n)}}function fye(s,e){mi.getOrCreate(e);const t=gye(e),i=Fl(s),n=[];let o=t.getInitialState();for(let r=0,a=i.length;r<a;r++){const l=i[r],c=t.tokenize(l,!0,o);n[r]=c.tokens,o=c.endState}return n}function pye(s,e){Me.get(Qo).defineTheme(s,e)}function mye(s){Me.get(Qo).setTheme(s)}function _ye(){cE.clearAllFontInfos()}function bye(s,e){return ot.registerCommand({id:s,handler:e})}function vye(s){return Me.get(Ys).registerOpener({async open(t){return typeof t=="string"&&(t=Se.parse(t)),s.open(t)}})}function Cye(s){return Me.get(ft).registerCodeEditorOpenHandler(async(t,i,n)=>{if(!i)return null;const o=t.options?.selection;let r;return o&&typeof o.endLineNumber=="number"&&typeof o.endColumn=="number"?r=o:o&&(r={lineNumber:o.startLineNumber,column:o.startColumn}),await s.openCodeEditor(i,t.resource,r)?i:null})}function yye(){return{create:zCe,getEditors:jCe,getDiffEditors:ZCe,onDidCreateEditor:UCe,onDidCreateDiffEditor:$Ce,createDiffEditor:KCe,addCommand:GCe,addEditorAction:YCe,addKeybindingRule:XCe,addKeybindingRules:mj,createModel:QCe,setModelLanguage:JCe,setModelMarkers:eye,getModelMarkers:iye,removeAllMarkers:tye,onDidChangeMarkers:nye,getModels:oye,getModel:sye,onDidCreateModel:rye,onWillDisposeModel:aye,onDidChangeModelLanguage:lye,createWebWorker:cye,colorizeElement:dye,colorize:hye,colorizeModelLine:uye,tokenize:fye,defineTheme:pye,setTheme:mye,remeasureFonts:_ye,registerCommand:bye,registerLinkOpener:vye,registerEditorOpener:Cye,AccessibilitySupport:aT,ContentWidgetPositionPreference:gT,CursorChangeReason:fT,DefaultEndOfLine:pT,EditorAutoIndentStrategy:_T,EditorOption:bT,EndOfLinePreference:vT,EndOfLineSequence:CT,MinimapPosition:NT,MinimapSectionHeaderStyle:RT,MouseTargetType:MT,OverlayWidgetPositionPreference:OT,OverviewRulerLane:FT,GlyphMarginLane:yT,RenderLineNumbersType:HT,RenderMinimap:VT,ScrollbarVisibility:UT,ScrollType:zT,TextEditorCursorBlinkingStyle:GT,TextEditorCursorStyle:YT,TrackedRangeStickiness:XT,WrappingIndent:QT,InjectedTextCursorStops:LT,PositionAffinity:WT,ShowLightbulbIconMode:jT,ConfigurationChangedEvent:r6,BareFontInfo:ku,FontInfo:lE,TextModelResolvedOptions:Ow,FindMatch:Yb,ApplyUpdateResult:Z_,EditorZoom:lr,createMultiFileDiffEditor:qCe,EditorType:VC,EditorOptions:ja}}function wye(s,e){if(!e||!Array.isArray(e))return!1;for(const t of e)if(!s(t))return!1;return!0}function iw(s,e){return typeof s=="boolean"?s:e}function Q9(s,e){return typeof s=="string"?s:e}function Sye(s){const e={};for(const t of s)e[t]=!0;return e}function J9(s,e=!1){e&&(s=s.map(function(i){return i.toLowerCase()}));const t=Sye(s);return e?function(i){return t[i.toLowerCase()]!==void 0&&t.hasOwnProperty(i.toLowerCase())}:function(i){return t[i]!==void 0&&t.hasOwnProperty(i)}}function KR(s,e,t){e=e.replace(/@@/g,"");let i=0,n;do n=!1,e=e.replace(/@(\w+)/g,function(r,a){n=!0;let l="";if(typeof s[a]=="string")l=s[a];else if(s[a]&&s[a]instanceof RegExp)l=s[a].source;else throw s[a]===void 0?Gt(s,"language definition does not contain attribute '"+a+"', used at: "+e):Gt(s,"attribute reference '"+a+"' must be a string, used at: "+e);return du(l)?"":"(?:"+l+")"}),i++;while(n&&i<5);e=e.replace(/\x01/g,"@");const o=(s.ignoreCase?"i":"")+(s.unicode?"u":"");if(t&&e.match(/\$[sS](\d\d?)/g)){let a=null,l=null;return c=>(l&&a===c||(a=c,l=new RegExp(hme(s,e,c),o)),l)}return new RegExp(e,o)}function Lye(s,e,t,i){if(i<0)return s;if(i<e.length)return e[i];if(i>=100){i=i-100;const n=t.split(".");if(n.unshift(t),i<n.length)return n[i]}return null}function xye(s,e,t,i){let n=-1,o=t,r=t.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);r&&(r[3]&&(n=parseInt(r[3]),r[2]&&(n=n+100)),o=r[4]);let a="~",l=o;!o||o.length===0?(a="!=",l=""):/^\w*$/.test(l)?a="==":(r=o.match(/^(@|!@|~|!~|==|!=)(.*)$/),r&&(a=r[1],l=r[2]));let c;if((a==="~"||a==="!~")&&/^(\w|\|)*$/.test(l)){const d=J9(l.split("|"),s.ignoreCase);c=function(h){return a==="~"?d(h):!d(h)}}else if(a==="@"||a==="!@"){const d=s[l];if(!d)throw Gt(s,"the @ match target '"+l+"' is not defined, in rule: "+e);if(!wye(function(u){return typeof u=="string"},d))throw Gt(s,"the @ match target '"+l+"' must be an array of strings, in rule: "+e);const h=J9(d,s.ignoreCase);c=function(u){return a==="@"?h(u):!h(u)}}else if(a==="~"||a==="!~")if(l.indexOf("$")<0){const d=KR(s,"^"+l+"$",!1);c=function(h){return a==="~"?d.test(h):!d.test(h)}}else c=function(d,h,u,g){return KR(s,"^"+wd(s,l,h,u,g)+"$",!1).test(d)};else if(l.indexOf("$")<0){const d=Rc(s,l);c=function(h){return a==="=="?h===d:h!==d}}else{const d=Rc(s,l);c=function(h,u,g,f,m){const _=wd(s,d,u,g,f);return a==="=="?h===_:h!==_}}return n===-1?{name:t,value:i,test:function(d,h,u,g){return c(d,d,h,u,g)}}:{name:t,value:i,test:function(d,h,u,g){const f=Lye(d,h,u,n);return c(f||"",d,h,u,g)}}}function qR(s,e,t){if(t){if(typeof t=="string")return t;if(t.token||t.token===""){if(typeof t.token!="string")throw Gt(s,"a 'token' attribute must be of type string, in rule: "+e);{const i={token:t.token};if(t.token.indexOf("$")>=0&&(i.tokenSubst=!0),typeof t.bracket=="string")if(t.bracket==="@open")i.bracket=1;else if(t.bracket==="@close")i.bracket=-1;else throw Gt(s,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+e);if(t.next){if(typeof t.next!="string")throw Gt(s,"the next state must be a string value in rule: "+e);{let n=t.next;if(!/^(@pop|@push|@popall)$/.test(n)&&(n[0]==="@"&&(n=n.substr(1)),n.indexOf("$")<0&&!ume(s,wd(s,n,"",[],""))))throw Gt(s,"the next state '"+t.next+"' is not defined in rule: "+e);i.next=n}}return typeof t.goBack=="number"&&(i.goBack=t.goBack),typeof t.switchTo=="string"&&(i.switchTo=t.switchTo),typeof t.log=="string"&&(i.log=t.log),typeof t.nextEmbedded=="string"&&(i.nextEmbedded=t.nextEmbedded,s.usesEmbedded=!0),i}}else if(Array.isArray(t)){const i=[];for(let n=0,o=t.length;n<o;n++)i[n]=qR(s,e,t[n]);return{group:i}}else if(t.cases){const i=[];for(const o in t.cases)if(t.cases.hasOwnProperty(o)){const r=qR(s,e,t.cases[o]);o==="@default"||o==="@"||o===""?i.push({test:void 0,value:r,name:o}):o==="@eos"?i.push({test:function(a,l,c,d){return d},value:r,name:o}):i.push(xye(s,e,o,r))}const n=s.defaultToken;return{test:function(o,r,a,l){for(const c of i)if(!c.test||c.test(o,r,a,l))return c.value;return n}}}else throw Gt(s,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+e)}else return{token:""}}class kye{constructor(e){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=e}setRegex(e,t){let i;if(typeof t=="string")i=t;else if(t instanceof RegExp)i=t.source;else throw Gt(e,"rules must start with a match string or regular expression: "+this.name);this.matchOnlyAtLineStart=i.length>0&&i[0]==="^",this.name=this.name+": "+i,this.regex=KR(e,"^(?:"+(this.matchOnlyAtLineStart?i.substr(1):i)+")",!0)}setAction(e,t){this.action=qR(e,this.name,t)}resolveRegex(e){return this.regex instanceof RegExp?this.regex:this.regex(e)}}function _j(s,e){if(!e||typeof e!="object")throw new Error("Monarch: expecting a language definition object");const t={languageId:s,includeLF:iw(e.includeLF,!1),noThrow:!1,maxStack:100,start:typeof e.start=="string"?e.start:null,ignoreCase:iw(e.ignoreCase,!1),unicode:iw(e.unicode,!1),tokenPostfix:Q9(e.tokenPostfix,"."+s),defaultToken:Q9(e.defaultToken,"source"),usesEmbedded:!1,stateNames:{},tokenizer:{},brackets:[]},i=e;i.languageId=s,i.includeLF=t.includeLF,i.ignoreCase=t.ignoreCase,i.unicode=t.unicode,i.noThrow=t.noThrow,i.usesEmbedded=t.usesEmbedded,i.stateNames=e.tokenizer,i.defaultToken=t.defaultToken;function n(r,a,l){for(const c of l){let d=c.include;if(d){if(typeof d!="string")throw Gt(t,"an 'include' attribute must be a string at: "+r);if(d[0]==="@"&&(d=d.substr(1)),!e.tokenizer[d])throw Gt(t,"include target '"+d+"' is not defined at: "+r);n(r+"."+d,a,e.tokenizer[d])}else{const h=new kye(r);if(Array.isArray(c)&&c.length>=1&&c.length<=3)if(h.setRegex(i,c[0]),c.length>=3)if(typeof c[1]=="string")h.setAction(i,{token:c[1],next:c[2]});else if(typeof c[1]=="object"){const u=c[1];u.next=c[2],h.setAction(i,u)}else throw Gt(t,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+r);else h.setAction(i,c[1]);else{if(!c.regex)throw Gt(t,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+r);c.name&&typeof c.name=="string"&&(h.name=c.name),c.matchOnlyAtStart&&(h.matchOnlyAtLineStart=iw(c.matchOnlyAtLineStart,!1)),h.setRegex(i,c.regex),h.setAction(i,c.action)}a.push(h)}}}if(!e.tokenizer||typeof e.tokenizer!="object")throw Gt(t,"a language definition must define the 'tokenizer' attribute as an object");t.tokenizer=[];for(const r in e.tokenizer)if(e.tokenizer.hasOwnProperty(r)){t.start||(t.start=r);const a=e.tokenizer[r];t.tokenizer[r]=new Array,n("tokenizer."+r,t.tokenizer[r],a)}if(t.usesEmbedded=i.usesEmbedded,e.brackets){if(!Array.isArray(e.brackets))throw Gt(t,"the 'brackets' attribute must be defined as an array")}else e.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];const o=[];for(const r of e.brackets){let a=r;if(a&&Array.isArray(a)&&a.length===3&&(a={token:a[2],open:a[0],close:a[1]}),a.open===a.close)throw Gt(t,"open and close brackets in a 'brackets' attribute must be different: "+a.open+`
 hint: use the 'bracket' attribute if matching on equal brackets is required.`);if(typeof a.open=="string"&&typeof a.token=="string"&&typeof a.close=="string")o.push({token:a.token+t.tokenPostfix,open:Rc(t,a.open),close:Rc(t,a.close)});else throw Gt(t,"every element in the 'brackets' array must be a '{open,close,token}' object or array")}return t.brackets=o,t.noThrow=!0,t}function Dye(s){xp.registerLanguage(s)}function Iye(){let s=[];return s=s.concat(xp.getLanguages()),s}function Tye(s){return Me.get(ni).languageIdCodec.encodeLanguageId(s)}function Eye(s,e){return Me.withServices(()=>{const i=Me.get(ni).onDidRequestRichLanguageFeatures(n=>{n===s&&(i.dispose(),e())});return i})}function Nye(s,e){return Me.withServices(()=>{const i=Me.get(ni).onDidRequestBasicLanguageFeatures(n=>{n===s&&(i.dispose(),e())});return i})}function Rye(s,e){if(!Me.get(ni).isRegisteredLanguageId(s))throw new Error(`Cannot set configuration for unknown language ${s}`);return Me.get(di).register(s,e,100)}class Mye{constructor(e,t){this._languageId=e,this._actual=t}dispose(){}getInitialState(){return this._actual.getInitialState()}tokenize(e,t,i){if(typeof this._actual.tokenize=="function")return Hv.adaptTokenize(this._languageId,this._actual,e,i);throw new Error("Not supported!")}tokenizeEncoded(e,t,i){const n=this._actual.tokenizeEncoded(e,i);return new _L(n.tokens,n.endState)}}class Hv{constructor(e,t,i,n){this._languageId=e,this._actual=t,this._languageService=i,this._standaloneThemeService=n}dispose(){}getInitialState(){return this._actual.getInitialState()}static _toClassicTokens(e,t){const i=[];let n=0;for(let o=0,r=e.length;o<r;o++){const a=e[o];let l=a.startIndex;o===0?l=0:l<n&&(l=n),i[o]=new zb(l,a.scopes,t),n=l}return i}static adaptTokenize(e,t,i,n){const o=t.tokenize(i,n),r=Hv._toClassicTokens(o.tokens,e);let a;return o.endState.equals(n)?a=n:a=o.endState,new FP(r,a)}tokenize(e,t,i){return Hv.adaptTokenize(this._languageId,this._actual,e,i)}_toBinaryTokens(e,t){const i=e.encodeLanguageId(this._languageId),n=this._standaloneThemeService.getColorTheme().tokenTheme,o=[];let r=0,a=0;for(let c=0,d=t.length;c<d;c++){const h=t[c],u=n.match(i,h.scopes)|1024;if(r>0&&o[r-1]===u)continue;let g=h.startIndex;c===0?g=0:g<a&&(g=a),o[r++]=g,o[r++]=u,a=g}const l=new Uint32Array(r);for(let c=0;c<r;c++)l[c]=o[c];return l}tokenizeEncoded(e,t,i){const n=this._actual.tokenize(e,i),o=this._toBinaryTokens(this._languageService.languageIdCodec,n.tokens);let r;return n.endState.equals(i)?r=i:r=n.endState,new _L(o,r)}}function Aye(s){return typeof s.getInitialState=="function"}function Pye(s){return"tokenizeEncoded"in s}function bj(s){return s&&typeof s.then=="function"}function Oye(s){const e=Me.get(Qo);if(s){const t=[null];for(let i=1,n=s.length;i<n;i++)t[i]=G.fromHex(s[i]);e.setColorMapOverride(t)}else e.setColorMapOverride(null)}function vj(s,e){return Pye(e)?new Mye(s,e):new Hv(s,e,Me.get(ni),Me.get(Qo))}function kF(s,e){const t=new dee(async()=>{const i=await Promise.resolve(e.create());return i?Aye(i)?vj(s,i):new Iv(Me.get(ni),Me.get(Qo),s,_j(s,i),Me.get(Ke)):null});return mi.registerFactory(s,t)}function Fye(s,e){if(!Me.get(ni).isRegisteredLanguageId(s))throw new Error(`Cannot set tokens provider for unknown language ${s}`);return bj(e)?kF(s,{create:()=>e}):mi.register(s,vj(s,e))}function Bye(s,e){const t=i=>new Iv(Me.get(ni),Me.get(Qo),s,_j(s,i),Me.get(Ke));return bj(e)?kF(s,{create:()=>e}):mi.register(s,t(e))}function Wye(s,e){return Me.get(pe).referenceProvider.register(s,e)}function Hye(s,e){return Me.get(pe).renameProvider.register(s,e)}function Vye(s,e){return Me.get(pe).newSymbolNamesProvider.register(s,e)}function zye(s,e){return Me.get(pe).signatureHelpProvider.register(s,e)}function Uye(s,e){return Me.get(pe).hoverProvider.register(s,{provideHover:async(i,n,o,r)=>{const a=i.getWordAtPosition(n);return Promise.resolve(e.provideHover(i,n,o,r)).then(l=>{if(l)return!l.range&&a&&(l.range=new k(n.lineNumber,a.startColumn,n.lineNumber,a.endColumn)),l.range||(l.range=new k(n.lineNumber,n.column,n.lineNumber,n.column)),l})}})}function $ye(s,e){return Me.get(pe).documentSymbolProvider.register(s,e)}function jye(s,e){return Me.get(pe).documentHighlightProvider.register(s,e)}function Zye(s,e){return Me.get(pe).linkedEditingRangeProvider.register(s,e)}function Kye(s,e){return Me.get(pe).definitionProvider.register(s,e)}function qye(s,e){return Me.get(pe).implementationProvider.register(s,e)}function Gye(s,e){return Me.get(pe).typeDefinitionProvider.register(s,e)}function Yye(s,e){return Me.get(pe).codeLensProvider.register(s,e)}function Xye(s,e,t){return Me.get(pe).codeActionProvider.register(s,{providedCodeActionKinds:t?.providedCodeActionKinds,documentation:t?.documentation,provideCodeActions:(n,o,r,a)=>{const c=Me.get(zl).read({resource:n.uri}).filter(d=>k.areIntersectingOrTouching(d,o));return e.provideCodeActions(n,o,{markers:c,only:r.only,trigger:r.trigger},a)},resolveCodeAction:e.resolveCodeAction})}function Qye(s,e){return Me.get(pe).documentFormattingEditProvider.register(s,e)}function Jye(s,e){return Me.get(pe).documentRangeFormattingEditProvider.register(s,e)}function ewe(s,e){return Me.get(pe).onTypeFormattingEditProvider.register(s,e)}function twe(s,e){return Me.get(pe).linkProvider.register(s,e)}function iwe(s,e){return Me.get(pe).completionProvider.register(s,e)}function nwe(s,e){return Me.get(pe).colorProvider.register(s,e)}function swe(s,e){return Me.get(pe).foldingRangeProvider.register(s,e)}function owe(s,e){return Me.get(pe).declarationProvider.register(s,e)}function rwe(s,e){return Me.get(pe).selectionRangeProvider.register(s,e)}function awe(s,e){return Me.get(pe).documentSemanticTokensProvider.register(s,e)}function lwe(s,e){return Me.get(pe).documentRangeSemanticTokensProvider.register(s,e)}function cwe(s,e){return Me.get(pe).inlineCompletionsProvider.register(s,e)}function dwe(s,e){return Me.get(pe).inlineEditProvider.register(s,e)}function hwe(s,e){return Me.get(pe).inlayHintsProvider.register(s,e)}function uwe(){return{register:Dye,getLanguages:Iye,onLanguage:Eye,onLanguageEncountered:Nye,getEncodedLanguageId:Tye,setLanguageConfiguration:Rye,setColorMap:Oye,registerTokensProviderFactory:kF,setTokensProvider:Fye,setMonarchTokensProvider:Bye,registerReferenceProvider:Wye,registerRenameProvider:Hye,registerNewSymbolNameProvider:Vye,registerCompletionItemProvider:iwe,registerSignatureHelpProvider:zye,registerHoverProvider:Uye,registerDocumentSymbolProvider:$ye,registerDocumentHighlightProvider:jye,registerLinkedEditingRangeProvider:Zye,registerDefinitionProvider:Kye,registerImplementationProvider:qye,registerTypeDefinitionProvider:Gye,registerCodeLensProvider:Yye,registerCodeActionProvider:Xye,registerDocumentFormattingEditProvider:Qye,registerDocumentRangeFormattingEditProvider:Jye,registerOnTypeFormattingEditProvider:ewe,registerLinkProvider:twe,registerColorProvider:nwe,registerFoldingRangeProvider:swe,registerDeclarationProvider:owe,registerSelectionRangeProvider:rwe,registerDocumentSemanticTokensProvider:awe,registerDocumentRangeSemanticTokensProvider:lwe,registerInlineCompletionsProvider:cwe,registerInlineEditProvider:dwe,registerInlayHintsProvider:hwe,DocumentHighlightKind:mT,CompletionItemKind:dT,CompletionItemTag:hT,CompletionItemInsertTextRule:cT,SymbolKind:KT,SymbolTag:qT,IndentAction:ST,CompletionTriggerKind:uT,SignatureHelpTriggerKind:ZT,InlayHintKind:xT,InlineCompletionTriggerKind:kT,InlineEditTriggerKind:DT,CodeActionTriggerType:lT,NewSymbolNameTag:AT,NewSymbolNameTriggerKind:PT,PartialAcceptTriggerKind:BT,HoverVerbosityAction:wT,FoldingRangeKind:Eo,SelectedSuggestionInfo:w6}}const DF=Je("IEditorCancelService"),Cj=new le("cancellableOperation",!1,p("cancellableOperation","Whether the editor runs a cancellable operation, e.g. like 'Peek References'"));nt(DF,class{constructor(){this._tokens=new WeakMap}add(s,e){let t=this._tokens.get(s);t||(t=s.invokeWithinContext(n=>{const o=Cj.bindTo(n.get(Ee)),r=new fs;return{key:o,tokens:r}}),this._tokens.set(s,t));let i;return t.key.set(!0),i=t.tokens.push(e),()=>{i&&(i(),t.key.set(!t.tokens.isEmpty()),i=void 0)}}cancel(s){const e=this._tokens.get(s);if(!e)return;const t=e.tokens.pop();t&&(t.cancel(),e.key.set(!e.tokens.isEmpty()))}},1);class gwe extends li{constructor(e,t){super(t),this.editor=e,this._unregister=e.invokeWithinContext(i=>i.get(DF).add(e,this))}dispose(){this._unregister(),super.dispose()}}ae(new class extends Zi{constructor(){super({id:"editor.cancelOperation",kbOpts:{weight:100,primary:9},precondition:Cj})}runEditorCommand(s,e){s.get(DF).cancel(e)}});let yj=class GR{constructor(e,t){if(this.flags=t,this.flags&1){const i=e.getModel();this.modelVersionId=i?zu("{0}#{1}",i.uri.toString(),i.getVersionId()):null}else this.modelVersionId=null;this.flags&4?this.position=e.getPosition():this.position=null,this.flags&2?this.selection=e.getSelection():this.selection=null,this.flags&8?(this.scrollLeft=e.getScrollLeft(),this.scrollTop=e.getScrollTop()):(this.scrollLeft=-1,this.scrollTop=-1)}_equals(e){if(!(e instanceof GR))return!1;const t=e;return!(this.modelVersionId!==t.modelVersionId||this.scrollLeft!==t.scrollLeft||this.scrollTop!==t.scrollTop||!this.position&&t.position||this.position&&!t.position||this.position&&t.position&&!this.position.equals(t.position)||!this.selection&&t.selection||this.selection&&!t.selection||this.selection&&t.selection&&!this.selection.equalsRange(t.selection))}validate(e){return this._equals(new GR(e,this.flags))}};class gh extends gwe{constructor(e,t,i,n){super(e,n),this._listener=new Z,t&4&&this._listener.add(e.onDidChangeCursorPosition(o=>{(!i||!k.containsPosition(i,o.position))&&this.cancel()})),t&2&&this._listener.add(e.onDidChangeCursorSelection(o=>{(!i||!k.containsRange(i,o.selection))&&this.cancel()})),t&8&&this._listener.add(e.onDidScrollChange(o=>this.cancel())),t&1&&(this._listener.add(e.onDidChangeModel(o=>this.cancel())),this._listener.add(e.onDidChangeModelContent(o=>this.cancel())))}dispose(){this._listener.dispose(),super.dispose()}}class IF extends li{constructor(e,t){super(t),this._listener=e.onDidChangeContent(()=>this.cancel())}dispose(){this._listener.dispose(),super.dispose()}}function Ol(s){return s&&typeof s.getEditorType=="function"?s.getEditorType()===VC.ICodeEditor:!1}function TF(s){return s&&typeof s.getEditorType=="function"?s.getEditorType()===VC.IDiffEditor:!1}function fwe(s){return!!s&&typeof s=="object"&&typeof s.onDidChangeActiveEditor=="function"}function wj(s){return Ol(s)?s:TF(s)?s.getModifiedEditor():fwe(s)&&Ol(s.activeCodeEditor)?s.activeCodeEditor:null}class Zp{static _handleEolEdits(e,t){let i;const n=[];for(const o of t)typeof o.eol=="number"&&(i=o.eol),o.range&&typeof o.text=="string"&&n.push(o);return typeof i=="number"&&e.hasModel()&&e.getModel().pushEOL(i),n}static _isFullModelReplaceEdit(e,t){if(!e.hasModel())return!1;const i=e.getModel(),n=i.validateRange(t.range);return i.getFullModelRange().equalsRange(n)}static execute(e,t,i){i&&e.pushUndoStop();const n=$a.capture(e),o=Zp._handleEolEdits(e,t);o.length===1&&Zp._isFullModelReplaceEdit(e,o[0])?e.executeEdits("formatEditsCommand",o.map(r=>ri.replace(k.lift(r.range),r.text))):e.executeEdits("formatEditsCommand",o.map(r=>ri.replaceMove(k.lift(r.range),r.text))),i&&e.pushUndoStop(),n.restoreRelativeVerticalPositionOfCursor(e)}}class e7{constructor(e){this.value=e,this._lower=e.toLowerCase()}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}}class pwe{constructor(e){if(this._set=new Set,e)for(const t of e)this.add(t)}add(e){this._set.add(e7.toKey(e))}has(e){return this._set.has(e7.toKey(e))}}function Sj(s,e,t){const i=[],n=new pwe,o=s.ordered(t);for(const a of o)i.push(a),a.extensionId&&n.add(a.extensionId);const r=e.ordered(t);for(const a of r){if(a.extensionId){if(n.has(a.extensionId))continue;n.add(a.extensionId)}i.push({displayName:a.displayName,extensionId:a.extensionId,provideDocumentFormattingEdits(l,c,d){return a.provideDocumentRangeFormattingEdits(l,l.getFullModelRange(),c,d)}})}return i}class Kp{static{this._selectors=new fs}static setFormatterSelector(e){return{dispose:Kp._selectors.unshift(e)}}static async select(e,t,i,n){if(e.length===0)return;const o=st.first(Kp._selectors);if(o)return await o(e,t,i,n)}}async function Lj(s,e,t,i,n,o,r){const a=s.get(ye),{documentRangeFormattingEditProvider:l}=s.get(pe),c=Ol(e)?e.getModel():e,d=l.ordered(c),h=await Kp.select(d,c,i,2);h&&(n.report(h),await a.invokeFunction(mwe,h,e,t,o,r))}async function mwe(s,e,t,i,n,o){const r=s.get(Xs),a=s.get(Pn),l=s.get(Lh);let c,d;Ol(t)?(c=t.getModel(),d=new gh(t,5,void 0,n)):(c=t,d=new IF(t,n));const h=[];let u=0;for(const b of xP(i).sort(k.compareRangesUsingStarts))u>0&&k.areIntersectingOrTouching(h[u-1],b)?h[u-1]=k.fromPositions(h[u-1].getStartPosition(),b.getEndPosition()):u=h.push(b);const g=async b=>{a.trace("[format][provideDocumentRangeFormattingEdits] (request)",e.extensionId?.value,b);const v=await e.provideDocumentRangeFormattingEdits(c,b,c.getFormattingOptions(),d.token)||[];return a.trace("[format][provideDocumentRangeFormattingEdits] (response)",e.extensionId?.value,v),v},f=(b,v)=>{if(!b.length||!v.length)return!1;const C=b.reduce((y,w)=>k.plusRange(y,w.range),b[0].range);if(!v.some(y=>k.intersectRanges(C,y.range)))return!1;for(const y of b)for(const w of v)if(k.intersectRanges(y.range,w.range))return!0;return!1},m=[],_=[];try{if(typeof e.provideDocumentRangesFormattingEdits=="function"){a.trace("[format][provideDocumentRangeFormattingEdits] (request)",e.extensionId?.value,h);const b=await e.provideDocumentRangesFormattingEdits(c,h,c.getFormattingOptions(),d.token)||[];a.trace("[format][provideDocumentRangeFormattingEdits] (response)",e.extensionId?.value,b),_.push(b)}else{for(const b of h){if(d.token.isCancellationRequested)return!0;_.push(await g(b))}for(let b=0;b<h.length;++b)for(let v=b+1;v<h.length;++v){if(d.token.isCancellationRequested)return!0;if(f(_[b],_[v])){const C=k.plusRange(h[b],h[v]),y=await g(C);h.splice(v,1),h.splice(b,1),h.push(C),_.splice(v,1),_.splice(b,1),_.push(y),b=0,v=0}}}for(const b of _){if(d.token.isCancellationRequested)return!0;const v=await r.computeMoreMinimalEdits(c.uri,b);v&&m.push(...v)}}finally{d.dispose()}if(m.length===0)return!1;if(Ol(t))Zp.execute(t,m,!0),t.revealPositionInCenterIfOutsideViewport(t.getPosition(),1);else{const[{range:b}]=m,v=new me(b.startLineNumber,b.startColumn,b.endLineNumber,b.endColumn);c.pushEditOperations([v],m.map(C=>({text:C.text,range:k.lift(C.range),forceMoveMarkers:!0})),C=>{for(const{range:y}of C)if(k.areIntersectingOrTouching(y,v))return[new me(y.startLineNumber,y.startColumn,y.endLineNumber,y.endColumn)];return null})}return l.playSignal(Lt.format,{userGesture:o}),!0}async function _we(s,e,t,i,n,o){const r=s.get(ye),a=s.get(pe),l=Ol(e)?e.getModel():e,c=Sj(a.documentFormattingEditProvider,a.documentRangeFormattingEditProvider,l),d=await Kp.select(c,l,t,1);d&&(i.report(d),await r.invokeFunction(bwe,d,e,t,n,o))}async function bwe(s,e,t,i,n,o){const r=s.get(Xs),a=s.get(Lh);let l,c;Ol(t)?(l=t.getModel(),c=new gh(t,5,void 0,n)):(l=t,c=new IF(t,n));let d;try{const h=await e.provideDocumentFormattingEdits(l,l.getFormattingOptions(),c.token);if(d=await r.computeMoreMinimalEdits(l.uri,h),c.token.isCancellationRequested)return!0}finally{c.dispose()}if(!d||d.length===0)return!1;if(Ol(t))Zp.execute(t,d,i!==2),i!==2&&t.revealPositionInCenterIfOutsideViewport(t.getPosition(),1);else{const[{range:h}]=d,u=new me(h.startLineNumber,h.startColumn,h.endLineNumber,h.endColumn);l.pushEditOperations([u],d.map(g=>({text:g.text,range:k.lift(g.range),forceMoveMarkers:!0})),g=>{for(const{range:f}of g)if(k.areIntersectingOrTouching(f,u))return[new me(f.startLineNumber,f.startColumn,f.endLineNumber,f.endColumn)];return null})}return a.playSignal(Lt.format,{userGesture:o}),!0}async function vwe(s,e,t,i,n,o){const r=e.documentRangeFormattingEditProvider.ordered(t);for(const a of r){const l=await Promise.resolve(a.provideDocumentRangeFormattingEdits(t,i,n,o)).catch(Li);if(os(l))return await s.computeMoreMinimalEdits(t.uri,l)}}async function Cwe(s,e,t,i,n){const o=Sj(e.documentFormattingEditProvider,e.documentRangeFormattingEditProvider,t);for(const r of o){const a=await Promise.resolve(r.provideDocumentFormattingEdits(t,i,n)).catch(Li);if(os(a))return await s.computeMoreMinimalEdits(t.uri,a)}}function xj(s,e,t,i,n,o,r){const a=e.onTypeFormattingEditProvider.ordered(t);return a.length===0||a[0].autoFormatTriggerCharacters.indexOf(n)<0?Promise.resolve(void 0):Promise.resolve(a[0].provideOnTypeFormattingEdits(t,i,n,o,r)).catch(Li).then(l=>s.computeMoreMinimalEdits(t.uri,l))}ot.registerCommand("_executeFormatRangeProvider",async function(s,...e){const[t,i,n]=e;gt(Se.isUri(t)),gt(k.isIRange(i));const o=s.get(qs),r=s.get(Xs),a=s.get(pe),l=await o.createModelReference(t);try{return vwe(r,a,l.object.textEditorModel,k.lift(i),n,Ue.None)}finally{l.dispose()}});ot.registerCommand("_executeFormatDocumentProvider",async function(s,...e){const[t,i]=e;gt(Se.isUri(t));const n=s.get(qs),o=s.get(Xs),r=s.get(pe),a=await n.createModelReference(t);try{return Cwe(o,r,a.object.textEditorModel,i,Ue.None)}finally{a.dispose()}});ot.registerCommand("_executeFormatOnTypeProvider",async function(s,...e){const[t,i,n,o]=e;gt(Se.isUri(t)),gt(P.isIPosition(i)),gt(typeof n=="string");const r=s.get(qs),a=s.get(Xs),l=s.get(pe),c=await r.createModelReference(t);try{return xj(a,l,c.object.textEditorModel,P.lift(i),n,o,Ue.None)}finally{c.dispose()}});ja.wrappingIndent.defaultValue=0;ja.glyphMargin.defaultValue=!1;ja.autoIndent.defaultValue=3;ja.overviewRulerLanes.defaultValue=2;Kp.setFormatterSelector((s,e,t)=>Promise.resolve(s[0]));const Is=S6();Is.editor=yye();Is.languages=uwe();const ywe=Is.CancellationTokenSource,wwe=Is.Emitter,Swe=Is.KeyCode,Lwe=Is.KeyMod,xwe=Is.Position,kwe=Is.Range,Dwe=Is.Selection,Iwe=Is.SelectionDirection,kj=Is.MarkerSeverity,Twe=Is.MarkerTag,Ewe=Is.Uri,Nwe=Is.Token,Rwe=Is.editor,Mwe=Is.languages,Awe=globalThis.MonacoEnvironment;(Awe?.globalAPI||typeof define=="function"&&define.amd)&&(globalThis.monaco=Is);typeof globalThis.require<"u"&&typeof globalThis.require.config=="function"&&globalThis.require.config({ignoreDuplicateModules:["vscode-languageserver-types","vscode-languageserver-types/main","vscode-languageserver-textdocument","vscode-languageserver-textdocument/main","vscode-nls","vscode-nls/vscode-nls","jsonc-parser","jsonc-parser/main","vscode-uri","vscode-uri/index","vs/basic-languages/typescript/typescript"]});const jC=Object.freeze(Object.defineProperty({__proto__:null,CancellationTokenSource:ywe,Emitter:wwe,KeyCode:Swe,KeyMod:Lwe,MarkerSeverity:kj,MarkerTag:Twe,Position:xwe,Range:kwe,Selection:Dwe,SelectionDirection:Iwe,Token:Nwe,Uri:Ewe,editor:Rwe,languages:Mwe},Symbol.toStringTag,{value:"Module"}));/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.52.0(f6dc0eb8fce67e57f6036f4769d92c1666cdf546)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var Pwe=Object.defineProperty,Owe=Object.getOwnPropertyDescriptor,Fwe=Object.getOwnPropertyNames,Bwe=Object.prototype.hasOwnProperty,Wwe=(s,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Fwe(e))!Bwe.call(s,n)&&n!==t&&Pwe(s,n,{get:()=>e[n],enumerable:!(i=Owe(e,n))||i.enumerable});return s},Hwe=(s,e,t)=>(Wwe(s,e,"default"),t),R_={};Hwe(R_,jC);var Dj={},nI={},Vwe=class Ij{static getOrCreate(e){return nI[e]||(nI[e]=new Ij(e)),nI[e]}constructor(e){this._languageId=e,this._loadingTriggered=!1,this._lazyLoadPromise=new Promise((t,i)=>{this._lazyLoadPromiseResolve=t,this._lazyLoadPromiseReject=i})}load(){return this._loadingTriggered||(this._loadingTriggered=!0,Dj[this._languageId].loader().then(e=>this._lazyLoadPromiseResolve(e),e=>this._lazyLoadPromiseReject(e))),this._lazyLoadPromise}};function De(s){const e=s.id;Dj[e]=s,R_.languages.register(s);const t=Vwe.getOrCreate(e);R_.languages.registerTokensProviderFactory(e,{create:async()=>(await t.load()).language}),R_.languages.onLanguageEncountered(e,async()=>{const i=await t.load();R_.languages.setLanguageConfiguration(e,i.conf)})}De({id:"abap",extensions:[".abap"],aliases:["abap","ABAP"],loader:()=>Le(()=>import("./abap-Dwu-KH2x.js"),[],import.meta.url)});De({id:"apex",extensions:[".cls"],aliases:["Apex","apex"],mimetypes:["text/x-apex-source","text/x-apex"],loader:()=>Le(()=>import("./apex-Dn-XaljK.js"),[],import.meta.url)});De({id:"azcli",extensions:[".azcli"],aliases:["Azure CLI","azcli"],loader:()=>Le(()=>import("./azcli-C9RgAbUI.js"),[],import.meta.url)});De({id:"bat",extensions:[".bat",".cmd"],aliases:["Batch","bat"],loader:()=>Le(()=>import("./bat-CoZ5qQQA.js"),[],import.meta.url)});De({id:"bicep",extensions:[".bicep"],aliases:["Bicep"],loader:()=>Le(()=>import("./bicep-BTXPn4uT.js"),[],import.meta.url)});De({id:"cameligo",extensions:[".mligo"],aliases:["Cameligo"],loader:()=>Le(()=>import("./cameligo-J_4-LjdT.js"),[],import.meta.url)});De({id:"clojure",extensions:[".clj",".cljs",".cljc",".edn"],aliases:["clojure","Clojure"],loader:()=>Le(()=>import("./clojure-DDKRPAGl.js"),[],import.meta.url)});De({id:"coffeescript",extensions:[".coffee"],aliases:["CoffeeScript","coffeescript","coffee"],mimetypes:["text/x-coffeescript","text/coffeescript"],loader:()=>Le(()=>import("./coffee-C8z2l6sj.js"),[],import.meta.url)});De({id:"c",extensions:[".c",".h"],aliases:["C","c"],loader:()=>Le(()=>import("./cpp-DI3p9f9v.js"),[],import.meta.url)});De({id:"cpp",extensions:[".cpp",".cc",".cxx",".hpp",".hh",".hxx"],aliases:["C++","Cpp","cpp"],loader:()=>Le(()=>import("./cpp-DI3p9f9v.js"),[],import.meta.url)});De({id:"csharp",extensions:[".cs",".csx",".cake"],aliases:["C#","csharp"],loader:()=>Le(()=>import("./csharp-Bya7J2fC.js"),[],import.meta.url)});De({id:"csp",extensions:[".csp"],aliases:["CSP","csp"],loader:()=>Le(()=>import("./csp-g7vr-vut.js"),[],import.meta.url)});De({id:"css",extensions:[".css"],aliases:["CSS","css"],mimetypes:["text/css"],loader:()=>Le(()=>import("./css-fOVBx6Gk.js"),[],import.meta.url)});De({id:"cypher",extensions:[".cypher",".cyp"],aliases:["Cypher","OpenCypher"],loader:()=>Le(()=>import("./cypher-DciL1opS.js"),[],import.meta.url)});De({id:"dart",extensions:[".dart"],aliases:["Dart","dart"],mimetypes:["text/x-dart-source","text/x-dart"],loader:()=>Le(()=>import("./dart-CAkRrlCV.js"),[],import.meta.url)});De({id:"dockerfile",extensions:[".dockerfile"],filenames:["Dockerfile"],aliases:["Dockerfile"],loader:()=>Le(()=>import("./dockerfile-CHkS34TV.js"),[],import.meta.url)});De({id:"ecl",extensions:[".ecl"],aliases:["ECL","Ecl","ecl"],loader:()=>Le(()=>import("./ecl-qjrLrnvP.js"),[],import.meta.url)});De({id:"elixir",extensions:[".ex",".exs"],aliases:["Elixir","elixir","ex"],loader:()=>Le(()=>import("./elixir-Bn2aVyyF.js"),[],import.meta.url)});De({id:"flow9",extensions:[".flow"],aliases:["Flow9","Flow","flow9","flow"],loader:()=>Le(()=>import("./flow9-CcGMeAxr.js"),[],import.meta.url)});De({id:"fsharp",extensions:[".fs",".fsi",".ml",".mli",".fsx",".fsscript"],aliases:["F#","FSharp","fsharp"],loader:()=>Le(()=>import("./fsharp-P5WqO7sL.js"),[],import.meta.url)});De({id:"freemarker2",extensions:[".ftl",".ftlh",".ftlx"],aliases:["FreeMarker2","Apache FreeMarker2"],loader:()=>Le(()=>import("./freemarker2-iKSS_P_J.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url).then(s=>s.TagAutoInterpolationDollar)});De({id:"freemarker2.tag-angle.interpolation-dollar",aliases:["FreeMarker2 (Angle/Dollar)","Apache FreeMarker2 (Angle/Dollar)"],loader:()=>Le(()=>import("./freemarker2-iKSS_P_J.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url).then(s=>s.TagAngleInterpolationDollar)});De({id:"freemarker2.tag-bracket.interpolation-dollar",aliases:["FreeMarker2 (Bracket/Dollar)","Apache FreeMarker2 (Bracket/Dollar)"],loader:()=>Le(()=>import("./freemarker2-iKSS_P_J.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url).then(s=>s.TagBracketInterpolationDollar)});De({id:"freemarker2.tag-angle.interpolation-bracket",aliases:["FreeMarker2 (Angle/Bracket)","Apache FreeMarker2 (Angle/Bracket)"],loader:()=>Le(()=>import("./freemarker2-iKSS_P_J.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url).then(s=>s.TagAngleInterpolationBracket)});De({id:"freemarker2.tag-bracket.interpolation-bracket",aliases:["FreeMarker2 (Bracket/Bracket)","Apache FreeMarker2 (Bracket/Bracket)"],loader:()=>Le(()=>import("./freemarker2-iKSS_P_J.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url).then(s=>s.TagBracketInterpolationBracket)});De({id:"freemarker2.tag-auto.interpolation-dollar",aliases:["FreeMarker2 (Auto/Dollar)","Apache FreeMarker2 (Auto/Dollar)"],loader:()=>Le(()=>import("./freemarker2-iKSS_P_J.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url).then(s=>s.TagAutoInterpolationDollar)});De({id:"freemarker2.tag-auto.interpolation-bracket",aliases:["FreeMarker2 (Auto/Bracket)","Apache FreeMarker2 (Auto/Bracket)"],loader:()=>Le(()=>import("./freemarker2-iKSS_P_J.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url).then(s=>s.TagAutoInterpolationBracket)});De({id:"go",extensions:[".go"],aliases:["Go"],loader:()=>Le(()=>import("./go-DHzw8g6E.js"),[],import.meta.url)});De({id:"graphql",extensions:[".graphql",".gql"],aliases:["GraphQL","graphql","gql"],mimetypes:["application/graphql"],loader:()=>Le(()=>import("./graphql-DHR0rah7.js"),[],import.meta.url)});De({id:"handlebars",extensions:[".handlebars",".hbs"],aliases:["Handlebars","handlebars","hbs"],mimetypes:["text/x-handlebars-template"],loader:()=>Le(()=>import("./handlebars-BJ1Ug93s.js"),__vite__mapDeps([7,1,2,3,4,5,6]),import.meta.url)});De({id:"hcl",extensions:[".tf",".tfvars",".hcl"],aliases:["Terraform","tf","HCL","hcl"],loader:()=>Le(()=>import("./hcl-C75BKXms.js"),[],import.meta.url)});De({id:"html",extensions:[".html",".htm",".shtml",".xhtml",".mdoc",".jsp",".asp",".aspx",".jshtm"],aliases:["HTML","htm","html","xhtml"],mimetypes:["text/html","text/x-jshtm","text/template","text/ng-template"],loader:()=>Le(()=>import("./html-BNanwR7z.js"),__vite__mapDeps([8,1,2,3,4,5,6]),import.meta.url)});De({id:"ini",extensions:[".ini",".properties",".gitconfig"],filenames:["config",".gitattributes",".gitconfig",".editorconfig"],aliases:["Ini","ini"],loader:()=>Le(()=>import("./ini-BJrO4HmQ.js"),[],import.meta.url)});De({id:"java",extensions:[".java",".jav"],aliases:["Java","java"],mimetypes:["text/x-java-source","text/x-java"],loader:()=>Le(()=>import("./java-BZVcG1df.js"),[],import.meta.url)});De({id:"javascript",extensions:[".js",".es6",".jsx",".mjs",".cjs"],firstLine:"^#!.*\\bnode",filenames:["jakefile"],aliases:["JavaScript","javascript","js"],mimetypes:["text/javascript"],loader:()=>Le(()=>import("./javascript-BeYYW6DN.js"),__vite__mapDeps([9,10,1,2,3,4,5,6]),import.meta.url)});De({id:"julia",extensions:[".jl"],aliases:["julia","Julia"],loader:()=>Le(()=>import("./julia-y6tXNwRO.js"),[],import.meta.url)});De({id:"kotlin",extensions:[".kt",".kts"],aliases:["Kotlin","kotlin"],mimetypes:["text/x-kotlin-source","text/x-kotlin"],loader:()=>Le(()=>import("./kotlin-a3XSJ_gM.js"),[],import.meta.url)});De({id:"less",extensions:[".less"],aliases:["Less","less"],mimetypes:["text/x-less","text/less"],loader:()=>Le(()=>import("./less-DFUTkVLx.js"),[],import.meta.url)});De({id:"lexon",extensions:[".lex"],aliases:["Lexon"],loader:()=>Le(()=>import("./lexon-DVsYuwex.js"),[],import.meta.url)});De({id:"lua",extensions:[".lua"],aliases:["Lua","lua"],loader:()=>Le(()=>import("./lua-DYx-Jejz.js"),[],import.meta.url)});De({id:"liquid",extensions:[".liquid",".html.liquid"],aliases:["Liquid","liquid"],mimetypes:["application/liquid"],loader:()=>Le(()=>import("./liquid-Db0Z1PkM.js"),__vite__mapDeps([11,1,2,3,4,5,6]),import.meta.url)});De({id:"m3",extensions:[".m3",".i3",".mg",".ig"],aliases:["Modula-3","Modula3","modula3","m3"],loader:()=>Le(()=>import("./m3-BMrvfaad.js"),[],import.meta.url)});De({id:"markdown",extensions:[".md",".markdown",".mdown",".mkdn",".mkd",".mdwn",".mdtxt",".mdtext"],aliases:["Markdown","markdown"],loader:()=>Le(()=>import("./markdown-DuPmBnHi.js"),[],import.meta.url)});De({id:"mdx",extensions:[".mdx"],aliases:["MDX","mdx"],loader:()=>Le(()=>import("./mdx-D-joiJ4U.js"),__vite__mapDeps([12,1,2,3,4,5,6]),import.meta.url)});De({id:"mips",extensions:[".s"],aliases:["MIPS","MIPS-V"],mimetypes:["text/x-mips","text/mips","text/plaintext"],loader:()=>Le(()=>import("./mips-BqUeXQd9.js"),[],import.meta.url)});De({id:"msdax",extensions:[".dax",".msdax"],aliases:["DAX","MSDAX"],loader:()=>Le(()=>import("./msdax-Dw-TSVhm.js"),[],import.meta.url)});De({id:"mysql",extensions:[],aliases:["MySQL","mysql"],loader:()=>Le(()=>import("./mysql-CcpH9Ljq.js"),[],import.meta.url)});De({id:"objective-c",extensions:[".m"],aliases:["Objective-C"],loader:()=>Le(()=>import("./objective-c-BRNxDdm3.js"),[],import.meta.url)});De({id:"pascal",extensions:[".pas",".p",".pp"],aliases:["Pascal","pas"],mimetypes:["text/x-pascal-source","text/x-pascal"],loader:()=>Le(()=>import("./pascal-Cn8aAeCV.js"),[],import.meta.url)});De({id:"pascaligo",extensions:[".ligo"],aliases:["Pascaligo","ligo"],loader:()=>Le(()=>import("./pascaligo-dBAnVStS.js"),[],import.meta.url)});De({id:"perl",extensions:[".pl",".pm"],aliases:["Perl","pl"],loader:()=>Le(()=>import("./perl-C4L3BrdA.js"),[],import.meta.url)});De({id:"pgsql",extensions:[],aliases:["PostgreSQL","postgres","pg","postgre"],loader:()=>Le(()=>import("./pgsql-BOSk5tQb.js"),[],import.meta.url)});De({id:"php",extensions:[".php",".php4",".php5",".phtml",".ctp"],aliases:["PHP","php"],mimetypes:["application/x-php"],loader:()=>Le(()=>import("./php-DzsKq5vr.js"),[],import.meta.url)});De({id:"pla",extensions:[".pla"],loader:()=>Le(()=>import("./pla-C6GoMDq5.js"),[],import.meta.url)});De({id:"postiats",extensions:[".dats",".sats",".hats"],aliases:["ATS","ATS/Postiats"],loader:()=>Le(()=>import("./postiats-DQpJ_7Kk.js"),[],import.meta.url)});De({id:"powerquery",extensions:[".pq",".pqm"],aliases:["PQ","M","Power Query","Power Query M"],loader:()=>Le(()=>import("./powerquery-M-mSA4YD.js"),[],import.meta.url)});De({id:"powershell",extensions:[".ps1",".psm1",".psd1"],aliases:["PowerShell","powershell","ps","ps1"],loader:()=>Le(()=>import("./powershell-DzOgjbHk.js"),[],import.meta.url)});De({id:"proto",extensions:[".proto"],aliases:["protobuf","Protocol Buffers"],loader:()=>Le(()=>import("./protobuf-BIE5FnyZ.js"),[],import.meta.url)});De({id:"pug",extensions:[".jade",".pug"],aliases:["Pug","Jade","jade"],loader:()=>Le(()=>import("./pug-s9KOoKAL.js"),[],import.meta.url)});De({id:"python",extensions:[".py",".rpy",".pyw",".cpy",".gyp",".gypi"],aliases:["Python","py"],firstLine:"^#!/.*\\bpython[0-9.-]*\\b",loader:()=>Le(()=>import("./python-CMIRCxP9.js"),__vite__mapDeps([13,1,2,3,4,5,6]),import.meta.url)});De({id:"qsharp",extensions:[".qs"],aliases:["Q#","qsharp"],loader:()=>Le(()=>import("./qsharp-DWDrKSir.js"),[],import.meta.url)});De({id:"r",extensions:[".r",".rhistory",".rmd",".rprofile",".rt"],aliases:["R","r"],loader:()=>Le(()=>import("./r-DnKTOUT4.js"),[],import.meta.url)});De({id:"razor",extensions:[".cshtml"],aliases:["Razor","razor"],mimetypes:["text/x-cshtml"],loader:()=>Le(()=>import("./razor-DiJRVaBF.js"),__vite__mapDeps([14,1,2,3,4,5,6]),import.meta.url)});De({id:"redis",extensions:[".redis"],aliases:["redis"],loader:()=>Le(()=>import("./redis-CWZNkOVt.js"),[],import.meta.url)});De({id:"redshift",extensions:[],aliases:["Redshift","redshift"],loader:()=>Le(()=>import("./redshift-Bhrh1xcx.js"),[],import.meta.url)});De({id:"restructuredtext",extensions:[".rst"],aliases:["reStructuredText","restructuredtext"],loader:()=>Le(()=>import("./restructuredtext-CWmU_seV.js"),[],import.meta.url)});De({id:"ruby",extensions:[".rb",".rbx",".rjs",".gemspec",".pp"],filenames:["rakefile","Gemfile"],aliases:["Ruby","rb"],loader:()=>Le(()=>import("./ruby-2Tz7EiV8.js"),[],import.meta.url)});De({id:"rust",extensions:[".rs",".rlib"],aliases:["Rust","rust"],loader:()=>Le(()=>import("./rust-CrxrYIVW.js"),[],import.meta.url)});De({id:"sb",extensions:[".sb"],aliases:["Small Basic","sb"],loader:()=>Le(()=>import("./sb-DkpzO6Ij.js"),[],import.meta.url)});De({id:"scala",extensions:[".scala",".sc",".sbt"],aliases:["Scala","scala","SBT","Sbt","sbt","Dotty","dotty"],mimetypes:["text/x-scala-source","text/x-scala","text/x-sbt","text/x-dotty"],loader:()=>Le(()=>import("./scala-Du7mGxrp.js"),[],import.meta.url)});De({id:"scheme",extensions:[".scm",".ss",".sch",".rkt"],aliases:["scheme","Scheme"],loader:()=>Le(()=>import("./scheme-DnCYVA2x.js"),[],import.meta.url)});De({id:"scss",extensions:[".scss"],aliases:["Sass","sass","scss"],mimetypes:["text/x-scss","text/scss"],loader:()=>Le(()=>import("./scss-3iLYYaxs.js"),[],import.meta.url)});De({id:"shell",extensions:[".sh",".bash"],aliases:["Shell","sh"],loader:()=>Le(()=>import("./shell-D4ITwtg2.js"),[],import.meta.url)});De({id:"sol",extensions:[".sol"],aliases:["sol","solidity","Solidity"],loader:()=>Le(()=>import("./solidity-Bq53zNw4.js"),[],import.meta.url)});De({id:"aes",extensions:[".aes"],aliases:["aes","sophia","Sophia"],loader:()=>Le(()=>import("./sophia-BtzCauDs.js"),[],import.meta.url)});De({id:"sparql",extensions:[".rq"],aliases:["sparql","SPARQL"],loader:()=>Le(()=>import("./sparql-7--tI-JV.js"),[],import.meta.url)});De({id:"sql",extensions:[".sql"],aliases:["SQL"],loader:()=>Le(()=>import("./sql-B8Hnjumu.js"),[],import.meta.url)});De({id:"st",extensions:[".st",".iecst",".iecplc",".lc3lib",".TcPOU",".TcDUT",".TcGVL",".TcIO"],aliases:["StructuredText","scl","stl"],loader:()=>Le(()=>import("./st-BtpAQKub.js"),[],import.meta.url)});De({id:"swift",aliases:["Swift","swift"],extensions:[".swift"],mimetypes:["text/swift"],loader:()=>Le(()=>import("./swift-CVGPmAnX.js"),[],import.meta.url)});De({id:"systemverilog",extensions:[".sv",".svh"],aliases:["SV","sv","SystemVerilog","systemverilog"],loader:()=>Le(()=>import("./systemverilog-CzfWLrvP.js"),[],import.meta.url)});De({id:"verilog",extensions:[".v",".vh"],aliases:["V","v","Verilog","verilog"],loader:()=>Le(()=>import("./systemverilog-CzfWLrvP.js"),[],import.meta.url)});De({id:"tcl",extensions:[".tcl"],aliases:["tcl","Tcl","tcltk","TclTk","tcl/tk","Tcl/Tk"],loader:()=>Le(()=>import("./tcl-0V1PA5XN.js"),[],import.meta.url)});De({id:"twig",extensions:[".twig"],aliases:["Twig","twig"],mimetypes:["text/x-twig"],loader:()=>Le(()=>import("./twig-BwWq3-l7.js"),[],import.meta.url)});De({id:"typescript",extensions:[".ts",".tsx",".cts",".mts"],aliases:["TypeScript","ts","typescript"],mimetypes:["text/typescript"],loader:()=>Le(()=>import("./typescript-CUcK_uBK.js"),__vite__mapDeps([10,1,2,3,4,5,6]),import.meta.url)});De({id:"typespec",extensions:[".tsp"],aliases:["TypeSpec"],loader:()=>Le(()=>import("./typespec-B73e1L9X.js"),[],import.meta.url)});De({id:"vb",extensions:[".vb"],aliases:["Visual Basic","vb"],loader:()=>Le(()=>import("./vb-ByO2b-39.js"),[],import.meta.url)});De({id:"wgsl",extensions:[".wgsl"],aliases:["WebGPU Shading Language","WGSL","wgsl"],loader:()=>Le(()=>import("./wgsl-tTfWAqfG.js"),[],import.meta.url)});De({id:"xml",extensions:[".xml",".xsd",".dtd",".ascx",".csproj",".config",".props",".targets",".wxi",".wxl",".wxs",".xaml",".svg",".svgz",".opf",".xslt",".xsl"],firstLine:"(\\<\\?xml.*)|(\\<svg)|(\\<\\!doctype\\s+svg)",aliases:["XML","xml"],mimetypes:["text/xml","application/xml","application/xaml+xml","application/xml-dtd"],loader:()=>Le(()=>import("./xml-CdZT1Zxy.js"),__vite__mapDeps([15,1,2,3,4,5,6]),import.meta.url)});De({id:"yaml",extensions:[".yaml",".yml"],aliases:["YAML","yaml","YML","yml"],mimetypes:["application/x-yaml","text/x-yaml"],loader:()=>Le(()=>import("./yaml-8Bjt_smL.js"),__vite__mapDeps([16,1,2,3,4,5,6]),import.meta.url)});/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.52.0(f6dc0eb8fce67e57f6036f4769d92c1666cdf546)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var zwe=Object.defineProperty,Uwe=Object.getOwnPropertyDescriptor,$we=Object.getOwnPropertyNames,jwe=Object.prototype.hasOwnProperty,Zwe=(s,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of $we(e))!jwe.call(s,n)&&n!==t&&zwe(s,n,{get:()=>e[n],enumerable:!(i=Uwe(e,n))||i.enumerable});return s},Kwe=(s,e,t)=>(Zwe(s,e,"default"),t),Am={};Kwe(Am,jC);var EF=class{constructor(e,t,i){this._onDidChange=new Am.Emitter,this._languageId=e,this.setOptions(t),this.setModeConfiguration(i)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get modeConfiguration(){return this._modeConfiguration}get diagnosticsOptions(){return this.options}get options(){return this._options}setOptions(e){this._options=e||Object.create(null),this._onDidChange.fire(this)}setDiagnosticsOptions(e){this.setOptions(e)}setModeConfiguration(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)}},NF={validate:!0,lint:{compatibleVendorPrefixes:"ignore",vendorPrefix:"warning",duplicateProperties:"warning",emptyRules:"warning",importStatement:"ignore",boxModel:"ignore",universalSelector:"ignore",zeroUnits:"ignore",fontFaceProperties:"warning",hexColorLength:"error",argumentsInColorFunction:"error",unknownProperties:"warning",ieHack:"ignore",unknownVendorSpecificProperties:"ignore",propertyIgnoredDueToDisplay:"warning",important:"ignore",float:"ignore",idSelector:"ignore"},data:{useDefaultDataProvider:!0},format:{newlineBetweenSelectors:!0,newlineBetweenRules:!0,spaceAroundSelectorSeparator:!1,braceStyle:"collapse",maxPreserveNewLines:void 0,preserveNewLines:!0}},RF={completionItems:!0,hovers:!0,documentSymbols:!0,definitions:!0,references:!0,documentHighlights:!0,rename:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0,documentFormattingEdits:!0,documentRangeFormattingEdits:!0},Tj=new EF("css",NF,RF),Ej=new EF("scss",NF,RF),Nj=new EF("less",NF,RF);Am.languages.css={cssDefaults:Tj,lessDefaults:Nj,scssDefaults:Ej};function MF(){return Le(()=>import("./cssMode-C8zAVF2z.js"),__vite__mapDeps([17,1,2,3,4,5,6]),import.meta.url)}Am.languages.onLanguage("less",()=>{MF().then(s=>s.setupMode(Nj))});Am.languages.onLanguage("scss",()=>{MF().then(s=>s.setupMode(Ej))});Am.languages.onLanguage("css",()=>{MF().then(s=>s.setupMode(Tj))});/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.52.0(f6dc0eb8fce67e57f6036f4769d92c1666cdf546)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var qwe=Object.defineProperty,Gwe=Object.getOwnPropertyDescriptor,Ywe=Object.getOwnPropertyNames,Xwe=Object.prototype.hasOwnProperty,Qwe=(s,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Ywe(e))!Xwe.call(s,n)&&n!==t&&qwe(s,n,{get:()=>e[n],enumerable:!(i=Gwe(e,n))||i.enumerable});return s},Jwe=(s,e,t)=>(Qwe(s,e,"default"),t),Fx={};Jwe(Fx,jC);var e1e=class{constructor(e,t,i){this._onDidChange=new Fx.Emitter,this._languageId=e,this.setOptions(t),this.setModeConfiguration(i)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get options(){return this._options}get modeConfiguration(){return this._modeConfiguration}setOptions(e){this._options=e||Object.create(null),this._onDidChange.fire(this)}setModeConfiguration(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)}},t1e={tabSize:4,insertSpaces:!1,wrapLineLength:120,unformatted:'default": "a, abbr, acronym, b, bdo, big, br, button, cite, code, dfn, em, i, img, input, kbd, label, map, object, q, samp, select, small, span, strong, sub, sup, textarea, tt, var',contentUnformatted:"pre",indentInnerHtml:!1,preserveNewLines:!0,maxPreserveNewLines:void 0,indentHandlebars:!1,endWithNewline:!1,extraLiners:"head, body, /html",wrapAttributes:"auto"},Bx={format:t1e,suggest:{},data:{useDefaultDataProvider:!0}};function Wx(s){return{completionItems:!0,hovers:!0,documentSymbols:!0,links:!0,documentHighlights:!0,rename:!0,colors:!0,foldingRanges:!0,selectionRanges:!0,diagnostics:s===Cb,documentFormattingEdits:s===Cb,documentRangeFormattingEdits:s===Cb}}var Cb="html",t7="handlebars",i7="razor",Rj=Hx(Cb,Bx,Wx(Cb)),i1e=Rj.defaults,Mj=Hx(t7,Bx,Wx(t7)),n1e=Mj.defaults,Aj=Hx(i7,Bx,Wx(i7)),s1e=Aj.defaults;Fx.languages.html={htmlDefaults:i1e,razorDefaults:s1e,handlebarDefaults:n1e,htmlLanguageService:Rj,handlebarLanguageService:Mj,razorLanguageService:Aj,registerHTMLLanguageService:Hx};function o1e(){return Le(()=>import("./htmlMode-BEKPBxiE.js"),__vite__mapDeps([18,1,2,3,4,5,6]),import.meta.url)}function Hx(s,e=Bx,t=Wx(s)){const i=new e1e(s,e,t);let n;const o=Fx.languages.onLanguage(s,async()=>{n=(await o1e()).setupMode(i)});return{defaults:i,dispose(){o.dispose(),n?.dispose(),n=void 0}}}/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.52.0(f6dc0eb8fce67e57f6036f4769d92c1666cdf546)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var r1e=Object.defineProperty,a1e=Object.getOwnPropertyDescriptor,l1e=Object.getOwnPropertyNames,c1e=Object.prototype.hasOwnProperty,d1e=(s,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of l1e(e))!c1e.call(s,n)&&n!==t&&r1e(s,n,{get:()=>e[n],enumerable:!(i=a1e(e,n))||i.enumerable});return s},h1e=(s,e,t)=>(d1e(s,e,"default"),t),ZC={};h1e(ZC,jC);var u1e=class{constructor(e,t,i){this._onDidChange=new ZC.Emitter,this._languageId=e,this.setDiagnosticsOptions(t),this.setModeConfiguration(i)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get modeConfiguration(){return this._modeConfiguration}get diagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(e){this._diagnosticsOptions=e||Object.create(null),this._onDidChange.fire(this)}setModeConfiguration(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)}},g1e={validate:!0,allowComments:!0,schemas:[],enableSchemaRequest:!1,schemaRequest:"warning",schemaValidation:"warning",comments:"error",trailingCommas:"error"},f1e={documentFormattingEdits:!0,documentRangeFormattingEdits:!0,completionItems:!0,hovers:!0,documentSymbols:!0,tokens:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0},Pj=new u1e("json",g1e,f1e),p1e=()=>Oj().then(s=>s.getWorker());ZC.languages.json={jsonDefaults:Pj,getWorker:p1e};function Oj(){return Le(()=>import("./jsonMode-zOFsrIZs.js"),__vite__mapDeps([19,1,2,3,4,5,6]),import.meta.url)}ZC.languages.register({id:"json",extensions:[".json",".bowerrc",".jshintrc",".jscsrc",".eslintrc",".babelrc",".har"],aliases:["JSON","json"],mimetypes:["application/json"]});ZC.languages.onLanguage("json",()=>{Oj().then(s=>s.setupMode(Pj))});/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.52.0(f6dc0eb8fce67e57f6036f4769d92c1666cdf546)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var m1e=Object.defineProperty,_1e=Object.getOwnPropertyDescriptor,b1e=Object.getOwnPropertyNames,v1e=Object.prototype.hasOwnProperty,C1e=(s,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of b1e(e))!v1e.call(s,n)&&n!==t&&m1e(s,n,{get:()=>e[n],enumerable:!(i=_1e(e,n))||i.enumerable});return s},y1e=(s,e,t)=>(C1e(s,e,"default"),t),w1e="5.4.5",qp={};y1e(qp,jC);var Fj=(s=>(s[s.None=0]="None",s[s.CommonJS=1]="CommonJS",s[s.AMD=2]="AMD",s[s.UMD=3]="UMD",s[s.System=4]="System",s[s.ES2015=5]="ES2015",s[s.ESNext=99]="ESNext",s))(Fj||{}),Bj=(s=>(s[s.None=0]="None",s[s.Preserve=1]="Preserve",s[s.React=2]="React",s[s.ReactNative=3]="ReactNative",s[s.ReactJSX=4]="ReactJSX",s[s.ReactJSXDev=5]="ReactJSXDev",s))(Bj||{}),Wj=(s=>(s[s.CarriageReturnLineFeed=0]="CarriageReturnLineFeed",s[s.LineFeed=1]="LineFeed",s))(Wj||{}),Hj=(s=>(s[s.ES3=0]="ES3",s[s.ES5=1]="ES5",s[s.ES2015=2]="ES2015",s[s.ES2016=3]="ES2016",s[s.ES2017=4]="ES2017",s[s.ES2018=5]="ES2018",s[s.ES2019=6]="ES2019",s[s.ES2020=7]="ES2020",s[s.ESNext=99]="ESNext",s[s.JSON=100]="JSON",s[s.Latest=99]="Latest",s))(Hj||{}),Vj=(s=>(s[s.Classic=1]="Classic",s[s.NodeJs=2]="NodeJs",s))(Vj||{}),zj=class{constructor(s,e,t,i,n){this._onDidChange=new qp.Emitter,this._onDidExtraLibsChange=new qp.Emitter,this._extraLibs=Object.create(null),this._removedExtraLibs=Object.create(null),this._eagerModelSync=!1,this.setCompilerOptions(s),this.setDiagnosticsOptions(e),this.setWorkerOptions(t),this.setInlayHintsOptions(i),this.setModeConfiguration(n),this._onDidExtraLibsChangeTimeout=-1}get onDidChange(){return this._onDidChange.event}get onDidExtraLibsChange(){return this._onDidExtraLibsChange.event}get modeConfiguration(){return this._modeConfiguration}get workerOptions(){return this._workerOptions}get inlayHintsOptions(){return this._inlayHintsOptions}getExtraLibs(){return this._extraLibs}addExtraLib(s,e){let t;if(typeof e>"u"?t=`ts:extralib-${Math.random().toString(36).substring(2,15)}`:t=e,this._extraLibs[t]&&this._extraLibs[t].content===s)return{dispose:()=>{}};let i=1;return this._removedExtraLibs[t]&&(i=this._removedExtraLibs[t]+1),this._extraLibs[t]&&(i=this._extraLibs[t].version+1),this._extraLibs[t]={content:s,version:i},this._fireOnDidExtraLibsChangeSoon(),{dispose:()=>{let n=this._extraLibs[t];n&&n.version===i&&(delete this._extraLibs[t],this._removedExtraLibs[t]=i,this._fireOnDidExtraLibsChangeSoon())}}}setExtraLibs(s){for(const e in this._extraLibs)this._removedExtraLibs[e]=this._extraLibs[e].version;if(this._extraLibs=Object.create(null),s&&s.length>0)for(const e of s){const t=e.filePath||`ts:extralib-${Math.random().toString(36).substring(2,15)}`,i=e.content;let n=1;this._removedExtraLibs[t]&&(n=this._removedExtraLibs[t]+1),this._extraLibs[t]={content:i,version:n}}this._fireOnDidExtraLibsChangeSoon()}_fireOnDidExtraLibsChangeSoon(){this._onDidExtraLibsChangeTimeout===-1&&(this._onDidExtraLibsChangeTimeout=window.setTimeout(()=>{this._onDidExtraLibsChangeTimeout=-1,this._onDidExtraLibsChange.fire(void 0)},0))}getCompilerOptions(){return this._compilerOptions}setCompilerOptions(s){this._compilerOptions=s||Object.create(null),this._onDidChange.fire(void 0)}getDiagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(s){this._diagnosticsOptions=s||Object.create(null),this._onDidChange.fire(void 0)}setWorkerOptions(s){this._workerOptions=s||Object.create(null),this._onDidChange.fire(void 0)}setInlayHintsOptions(s){this._inlayHintsOptions=s||Object.create(null),this._onDidChange.fire(void 0)}setMaximumWorkerIdleTime(s){}setEagerModelSync(s){this._eagerModelSync=s}getEagerModelSync(){return this._eagerModelSync}setModeConfiguration(s){this._modeConfiguration=s||Object.create(null),this._onDidChange.fire(void 0)}},S1e=w1e,Uj={completionItems:!0,hovers:!0,documentSymbols:!0,definitions:!0,references:!0,documentHighlights:!0,rename:!0,diagnostics:!0,documentRangeFormattingEdits:!0,signatureHelp:!0,onTypeFormattingEdits:!0,codeActions:!0,inlayHints:!0},$j=new zj({allowNonTsExtensions:!0,target:99},{noSemanticValidation:!1,noSyntaxValidation:!1,onlyVisible:!1},{},{},Uj),jj=new zj({allowNonTsExtensions:!0,allowJs:!0,target:99},{noSemanticValidation:!0,noSyntaxValidation:!1,onlyVisible:!1},{},{},Uj),L1e=()=>Vx().then(s=>s.getTypeScriptWorker()),x1e=()=>Vx().then(s=>s.getJavaScriptWorker());qp.languages.typescript={ModuleKind:Fj,JsxEmit:Bj,NewLineKind:Wj,ScriptTarget:Hj,ModuleResolutionKind:Vj,typescriptVersion:S1e,typescriptDefaults:$j,javascriptDefaults:jj,getTypeScriptWorker:L1e,getJavaScriptWorker:x1e};function Vx(){return Le(()=>import("./tsMode-62CBXEki.js"),__vite__mapDeps([20,1,2,3,4,5,6]),import.meta.url)}qp.languages.onLanguage("typescript",()=>Vx().then(s=>s.setupTypeScript($j)));qp.languages.onLanguage("javascript",()=>Vx().then(s=>s.setupJavaScript(jj)));class k1e extends ks{constructor(){super({id:"diffEditor.toggleCollapseUnchangedRegions",title:Re("toggleCollapseUnchangedRegions","Toggle Collapse Unchanged Regions"),icon:J.map,toggled:q.has("config.diffEditor.hideUnchangedRegions.enabled"),precondition:q.has("isInDiffEditor"),menu:{when:q.has("isInDiffEditor"),id:M.EditorTitle,order:22,group:"navigation"}})}run(e,...t){const i=e.get(Ke),n=!i.getValue("diffEditor.hideUnchangedRegions.enabled");i.updateValue("diffEditor.hideUnchangedRegions.enabled",n)}}class Zj extends ks{constructor(){super({id:"diffEditor.toggleShowMovedCodeBlocks",title:Re("toggleShowMovedCodeBlocks","Toggle Show Moved Code Blocks"),precondition:q.has("isInDiffEditor")})}run(e,...t){const i=e.get(Ke),n=!i.getValue("diffEditor.experimental.showMoves");i.updateValue("diffEditor.experimental.showMoves",n)}}class Kj extends ks{constructor(){super({id:"diffEditor.toggleUseInlineViewWhenSpaceIsLimited",title:Re("toggleUseInlineViewWhenSpaceIsLimited","Toggle Use Inline View When Space Is Limited"),precondition:q.has("isInDiffEditor")})}run(e,...t){const i=e.get(Ke),n=!i.getValue("diffEditor.useInlineViewWhenSpaceIsLimited");i.updateValue("diffEditor.useInlineViewWhenSpaceIsLimited",n)}}const KC=Re("diffEditor","Diff Editor");class D1e extends Za{constructor(){super({id:"diffEditor.switchSide",title:Re("switchSide","Switch Side"),icon:J.arrowSwap,precondition:q.has("isInDiffEditor"),f1:!0,category:KC})}runEditorCommand(e,t,i){const n=Pm(e);if(n instanceof $c){if(i&&i.dryRun)return{destinationSelection:n.mapToOtherSide().destinationSelection};n.switchSide()}}}class I1e extends Za{constructor(){super({id:"diffEditor.exitCompareMove",title:Re("exitCompareMove","Exit Compare Move"),icon:J.close,precondition:I.comparingMovedCode,f1:!1,category:KC,keybinding:{weight:1e4,primary:9}})}runEditorCommand(e,t,...i){const n=Pm(e);n instanceof $c&&n.exitCompareMove()}}class T1e extends Za{constructor(){super({id:"diffEditor.collapseAllUnchangedRegions",title:Re("collapseAllUnchangedRegions","Collapse All Unchanged Regions"),icon:J.fold,precondition:q.has("isInDiffEditor"),f1:!0,category:KC})}runEditorCommand(e,t,...i){const n=Pm(e);n instanceof $c&&n.collapseAllUnchangedRegions()}}class E1e extends Za{constructor(){super({id:"diffEditor.showAllUnchangedRegions",title:Re("showAllUnchangedRegions","Show All Unchanged Regions"),icon:J.unfold,precondition:q.has("isInDiffEditor"),f1:!0,category:KC})}runEditorCommand(e,t,...i){const n=Pm(e);n instanceof $c&&n.showAllUnchangedRegions()}}class YR extends ks{constructor(){super({id:"diffEditor.revert",title:Re("revert","Revert"),f1:!1,category:KC})}run(e,t){const i=N1e(e,t.originalUri,t.modifiedUri);i instanceof $c&&i.revertRangeMappings(t.mapping.innerChanges??[])}}const qj=Re("accessibleDiffViewer","Accessible Diff Viewer");class qC extends ks{static{this.id="editor.action.accessibleDiffViewer.next"}constructor(){super({id:qC.id,title:Re("editor.action.accessibleDiffViewer.next","Go to Next Difference"),category:qj,precondition:q.has("isInDiffEditor"),keybinding:{primary:65,weight:100},f1:!0})}run(e){Pm(e)?.accessibleDiffViewerNext()}}class zx extends ks{static{this.id="editor.action.accessibleDiffViewer.prev"}constructor(){super({id:zx.id,title:Re("editor.action.accessibleDiffViewer.prev","Go to Previous Difference"),category:qj,precondition:q.has("isInDiffEditor"),keybinding:{primary:1089,weight:100},f1:!0})}run(e){Pm(e)?.accessibleDiffViewerPrev()}}function N1e(s,e,t){return s.get(ft).listDiffEditors().find(o=>{const r=o.getModifiedEditor(),a=o.getOriginalEditor();return r&&r.getModel()?.uri.toString()===t.toString()&&a&&a.getModel()?.uri.toString()===e.toString()})||null}function Pm(s){const t=s.get(ft).listDiffEditors(),i=Rn();if(i)for(const n of t){const o=n.getContainerDomNode();if(R1e(o,i))return n}return null}function R1e(s,e){let t=e;for(;t;){if(t===s)return!0;t=t.parentElement}return!1}Bt(k1e);Bt(Zj);Bt(Kj);hn.appendMenuItem(M.EditorTitle,{command:{id:new Kj().desc.id,title:p("useInlineViewWhenSpaceIsLimited","Use Inline View When Space Is Limited"),toggled:q.has("config.diffEditor.useInlineViewWhenSpaceIsLimited"),precondition:q.has("isInDiffEditor")},order:11,group:"1_diff",when:q.and(I.diffEditorRenderSideBySideInlineBreakpointReached,q.has("isInDiffEditor"))});hn.appendMenuItem(M.EditorTitle,{command:{id:new Zj().desc.id,title:p("showMoves","Show Moved Code Blocks"),icon:J.move,toggled:_m.create("config.diffEditor.experimental.showMoves",!0),precondition:q.has("isInDiffEditor")},order:10,group:"1_diff",when:q.has("isInDiffEditor")});Bt(YR);for(const s of[{icon:J.arrowRight,key:I.diffEditorInlineMode.toNegated()},{icon:J.discard,key:I.diffEditorInlineMode}])hn.appendMenuItem(M.DiffEditorHunkToolbar,{command:{id:new YR().desc.id,title:p("revertHunk","Revert Block"),icon:s.icon},when:q.and(I.diffEditorModifiedWritable,s.key),order:5,group:"primary"}),hn.appendMenuItem(M.DiffEditorSelectionToolbar,{command:{id:new YR().desc.id,title:p("revertSelection","Revert Selection"),icon:s.icon},when:q.and(I.diffEditorModifiedWritable,s.key),order:5,group:"primary"});Bt(D1e);Bt(I1e);Bt(T1e);Bt(E1e);hn.appendMenuItem(M.EditorTitle,{command:{id:qC.id,title:p("Open Accessible Diff Viewer","Open Accessible Diff Viewer"),precondition:q.has("isInDiffEditor")},order:10,group:"2_diff",when:q.and(I.accessibleDiffViewerVisible.negate(),q.has("isInDiffEditor"))});ot.registerCommandAlias("editor.action.diffReview.next",qC.id);Bt(qC);ot.registerCommandAlias("editor.action.diffReview.prev",zx.id);Bt(zx);var M1e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},A1e=function(s,e){return function(t,i){e(t,i,s)}},XR;const Ux=new le("selectionAnchorSet",!1);let fh=class{static{XR=this}static{this.ID="editor.contrib.selectionAnchorController"}static get(e){return e.getContribution(XR.ID)}constructor(e,t){this.editor=e,this.selectionAnchorSetContextKey=Ux.bindTo(t),this.modelChangeListener=e.onDidChangeModel(()=>this.selectionAnchorSetContextKey.reset())}setSelectionAnchor(){if(this.editor.hasModel()){const e=this.editor.getPosition();this.editor.changeDecorations(t=>{this.decorationId&&t.removeDecoration(this.decorationId),this.decorationId=t.addDecoration(me.fromPositions(e,e),{description:"selection-anchor",stickiness:1,hoverMessage:new zn().appendText(p("selectionAnchor","Selection Anchor")),className:"selection-anchor"})}),this.selectionAnchorSetContextKey.set(!!this.decorationId),Ls(p("anchorSet","Anchor set at {0}:{1}",e.lineNumber,e.column))}}goToSelectionAnchor(){if(this.editor.hasModel()&&this.decorationId){const e=this.editor.getModel().getDecorationRange(this.decorationId);e&&this.editor.setPosition(e.getStartPosition())}}selectFromAnchorToCursor(){if(this.editor.hasModel()&&this.decorationId){const e=this.editor.getModel().getDecorationRange(this.decorationId);if(e){const t=this.editor.getPosition();this.editor.setSelection(me.fromPositions(e.getStartPosition(),t)),this.cancelSelectionAnchor()}}}cancelSelectionAnchor(){if(this.decorationId){const e=this.decorationId;this.editor.changeDecorations(t=>{t.removeDecoration(e),this.decorationId=void 0}),this.selectionAnchorSetContextKey.set(!1)}}dispose(){this.cancelSelectionAnchor(),this.modelChangeListener.dispose()}};fh=XR=M1e([A1e(1,Ee)],fh);class P1e extends ge{constructor(){super({id:"editor.action.setSelectionAnchor",label:p("setSelectionAnchor","Set Selection Anchor"),alias:"Set Selection Anchor",precondition:void 0,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2080),weight:100}})}async run(e,t){fh.get(t)?.setSelectionAnchor()}}class O1e extends ge{constructor(){super({id:"editor.action.goToSelectionAnchor",label:p("goToSelectionAnchor","Go to Selection Anchor"),alias:"Go to Selection Anchor",precondition:Ux})}async run(e,t){fh.get(t)?.goToSelectionAnchor()}}class F1e extends ge{constructor(){super({id:"editor.action.selectFromAnchorToCursor",label:p("selectFromAnchorToCursor","Select from Anchor to Cursor"),alias:"Select from Anchor to Cursor",precondition:Ux,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2089),weight:100}})}async run(e,t){fh.get(t)?.selectFromAnchorToCursor()}}class B1e extends ge{constructor(){super({id:"editor.action.cancelSelectionAnchor",label:p("cancelSelectionAnchor","Cancel Selection Anchor"),alias:"Cancel Selection Anchor",precondition:Ux,kbOpts:{kbExpr:I.editorTextFocus,primary:9,weight:100}})}async run(e,t){fh.get(t)?.cancelSelectionAnchor()}}ct(fh.ID,fh,4);Q(P1e);Q(O1e);Q(F1e);Q(B1e);const W1e=E("editorOverviewRuler.bracketMatchForeground","#A0A0A0",p("overviewRulerBracketMatchForeground","Overview ruler marker color for matching brackets."));class H1e extends ge{constructor(){super({id:"editor.action.jumpToBracket",label:p("smartSelect.jumpBracket","Go to Bracket"),alias:"Go to Bracket",precondition:void 0,kbOpts:{kbExpr:I.editorTextFocus,primary:3165,weight:100}})}run(e,t){Mc.get(t)?.jumpToBracket()}}class V1e extends ge{constructor(){super({id:"editor.action.selectToBracket",label:p("smartSelect.selectToBracket","Select to Bracket"),alias:"Select to Bracket",precondition:void 0,metadata:{description:Re("smartSelect.selectToBracketDescription","Select the text inside and including the brackets or curly braces"),args:[{name:"args",schema:{type:"object",properties:{selectBrackets:{type:"boolean",default:!0}}}}]}})}run(e,t,i){let n=!0;i&&i.selectBrackets===!1&&(n=!1),Mc.get(t)?.selectToBracket(n)}}class z1e extends ge{constructor(){super({id:"editor.action.removeBrackets",label:p("smartSelect.removeBrackets","Remove Brackets"),alias:"Remove Brackets",precondition:void 0,kbOpts:{kbExpr:I.editorTextFocus,primary:2561,weight:100}})}run(e,t){Mc.get(t)?.removeBrackets(this.id)}}class U1e{constructor(e,t,i){this.position=e,this.brackets=t,this.options=i}}class Mc extends B{static{this.ID="editor.contrib.bracketMatchingController"}static get(e){return e.getContribution(Mc.ID)}constructor(e){super(),this._editor=e,this._lastBracketsData=[],this._lastVersionId=0,this._decorations=this._editor.createDecorationsCollection(),this._updateBracketsSoon=this._register(new It(()=>this._updateBrackets(),50)),this._matchBrackets=this._editor.getOption(72),this._updateBracketsSoon.schedule(),this._register(e.onDidChangeCursorPosition(t=>{this._matchBrackets!=="never"&&this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModelContent(t=>{this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModel(t=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModelLanguageConfiguration(t=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeConfiguration(t=>{t.hasChanged(72)&&(this._matchBrackets=this._editor.getOption(72),this._decorations.clear(),this._lastBracketsData=[],this._lastVersionId=0,this._updateBracketsSoon.schedule())})),this._register(e.onDidBlurEditorWidget(()=>{this._updateBracketsSoon.schedule()})),this._register(e.onDidFocusEditorWidget(()=>{this._updateBracketsSoon.schedule()}))}jumpToBracket(){if(!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getSelections().map(i=>{const n=i.getStartPosition(),o=e.bracketPairs.matchBracket(n);let r=null;if(o)o[0].containsPosition(n)&&!o[1].containsPosition(n)?r=o[1].getStartPosition():o[1].containsPosition(n)&&(r=o[0].getStartPosition());else{const a=e.bracketPairs.findEnclosingBrackets(n);if(a)r=a[1].getStartPosition();else{const l=e.bracketPairs.findNextBracket(n);l&&l.range&&(r=l.range.getStartPosition())}}return r?new me(r.lineNumber,r.column,r.lineNumber,r.column):new me(n.lineNumber,n.column,n.lineNumber,n.column)});this._editor.setSelections(t),this._editor.revealRange(t[0])}selectToBracket(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=[];this._editor.getSelections().forEach(n=>{const o=n.getStartPosition();let r=t.bracketPairs.matchBracket(o);if(!r&&(r=t.bracketPairs.findEnclosingBrackets(o),!r)){const c=t.bracketPairs.findNextBracket(o);c&&c.range&&(r=t.bracketPairs.matchBracket(c.range.getStartPosition()))}let a=null,l=null;if(r){r.sort(k.compareRangesUsingStarts);const[c,d]=r;if(a=e?c.getStartPosition():c.getEndPosition(),l=e?d.getEndPosition():d.getStartPosition(),d.containsPosition(o)){const h=a;a=l,l=h}}a&&l&&i.push(new me(a.lineNumber,a.column,l.lineNumber,l.column))}),i.length>0&&(this._editor.setSelections(i),this._editor.revealRange(i[0]))}removeBrackets(e){if(!this._editor.hasModel())return;const t=this._editor.getModel();this._editor.getSelections().forEach(i=>{const n=i.getPosition();let o=t.bracketPairs.matchBracket(n);o||(o=t.bracketPairs.findEnclosingBrackets(n)),o&&(this._editor.pushUndoStop(),this._editor.executeEdits(e,[{range:o[0],text:""},{range:o[1],text:""}]),this._editor.pushUndoStop())})}static{this._DECORATION_OPTIONS_WITH_OVERVIEW_RULER=We.register({description:"bracket-match-overview",stickiness:1,className:"bracket-match",overviewRuler:{color:_i(W1e),position:Ho.Center}})}static{this._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER=We.register({description:"bracket-match-no-overview",stickiness:1,className:"bracket-match"})}_updateBrackets(){if(this._matchBrackets==="never")return;this._recomputeBrackets();const e=[];let t=0;for(const i of this._lastBracketsData){const n=i.brackets;n&&(e[t++]={range:n[0],options:i.options},e[t++]={range:n[1],options:i.options})}this._decorations.set(e)}_recomputeBrackets(){if(!this._editor.hasModel()||!this._editor.hasWidgetFocus()){this._lastBracketsData=[],this._lastVersionId=0;return}const e=this._editor.getSelections();if(e.length>100){this._lastBracketsData=[],this._lastVersionId=0;return}const t=this._editor.getModel(),i=t.getVersionId();let n=[];this._lastVersionId===i&&(n=this._lastBracketsData);const o=[];let r=0;for(let h=0,u=e.length;h<u;h++){const g=e[h];g.isEmpty()&&(o[r++]=g.getStartPosition())}o.length>1&&o.sort(P.compare);const a=[];let l=0,c=0;const d=n.length;for(let h=0,u=o.length;h<u;h++){const g=o[h];for(;c<d&&n[c].position.isBefore(g);)c++;if(c<d&&n[c].position.equals(g))a[l++]=n[c];else{let f=t.bracketPairs.matchBracket(g,20),m=Mc._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;!f&&this._matchBrackets==="always"&&(f=t.bracketPairs.findEnclosingBrackets(g,20),m=Mc._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER),a[l++]=new U1e(g,f,m)}}this._lastBracketsData=a,this._lastVersionId=i}}ct(Mc.ID,Mc,1);Q(V1e);Q(H1e);Q(z1e);hn.appendMenuItem(M.MenubarGoMenu,{group:"5_infile_nav",command:{id:"editor.action.jumpToBracket",title:p({key:"miGoToBracket",comment:["&& denotes a mnemonic"]},"Go to &&Bracket")},order:2});class $1e{constructor(e,t){this._selection=e,this._isMovingLeft=t}getEditOperations(e,t){if(this._selection.startLineNumber!==this._selection.endLineNumber||this._selection.isEmpty())return;const i=this._selection.startLineNumber,n=this._selection.startColumn,o=this._selection.endColumn;if(!(this._isMovingLeft&&n===1)&&!(!this._isMovingLeft&&o===e.getLineMaxColumn(i)))if(this._isMovingLeft){const r=new k(i,n-1,i,n),a=e.getValueInRange(r);t.addEditOperation(r,null),t.addEditOperation(new k(i,o,i,o),a)}else{const r=new k(i,o,i,o+1),a=e.getValueInRange(r);t.addEditOperation(r,null),t.addEditOperation(new k(i,n,i,n),a)}}computeCursorState(e,t){return this._isMovingLeft?new me(this._selection.startLineNumber,this._selection.startColumn-1,this._selection.endLineNumber,this._selection.endColumn-1):new me(this._selection.startLineNumber,this._selection.startColumn+1,this._selection.endLineNumber,this._selection.endColumn+1)}}class Gj extends ge{constructor(e,t){super(t),this.left=e}run(e,t){if(!t.hasModel())return;const i=[],n=t.getSelections();for(const o of n)i.push(new $1e(o,this.left));t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}}class j1e extends Gj{constructor(){super(!0,{id:"editor.action.moveCarretLeftAction",label:p("caret.moveLeft","Move Selected Text Left"),alias:"Move Selected Text Left",precondition:I.writable})}}class Z1e extends Gj{constructor(){super(!1,{id:"editor.action.moveCarretRightAction",label:p("caret.moveRight","Move Selected Text Right"),alias:"Move Selected Text Right",precondition:I.writable})}}Q(j1e);Q(Z1e);class K1e extends ge{constructor(){super({id:"editor.action.transposeLetters",label:p("transposeLetters.label","Transpose Letters"),alias:"Transpose Letters",precondition:I.writable,kbOpts:{kbExpr:I.textInputFocus,primary:0,mac:{primary:306},weight:100}})}run(e,t){if(!t.hasModel())return;const i=t.getModel(),n=[],o=t.getSelections();for(const r of o){if(!r.isEmpty())continue;const a=r.startLineNumber,l=r.startColumn,c=i.getLineMaxColumn(a);if(a===1&&(l===1||l===2&&c===2))continue;const d=l===c?r.getPosition():xt.rightPosition(i,r.getPosition().lineNumber,r.getPosition().column),h=xt.leftPosition(i,d),u=xt.leftPosition(i,h),g=i.getValueInRange(k.fromPositions(u,h)),f=i.getValueInRange(k.fromPositions(h,d)),m=k.fromPositions(u,d);n.push(new Nn(m,f+g))}n.length>0&&(t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop())}}Q(K1e);const $x=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let s;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?s=crypto.getRandomValues.bind(crypto):s=function(i){for(let n=0;n<i.length;n++)i[n]=Math.floor(Math.random()*256);return i};const e=new Uint8Array(16),t=[];for(let i=0;i<256;i++)t.push(i.toString(16).padStart(2,"0"));return function(){s(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let n=0,o="";return o+=t[e[n++]],o+=t[e[n++]],o+=t[e[n++]],o+=t[e[n++]],o+="-",o+=t[e[n++]],o+=t[e[n++]],o+="-",o+=t[e[n++]],o+=t[e[n++]],o+="-",o+=t[e[n++]],o+=t[e[n++]],o+="-",o+=t[e[n++]],o+=t[e[n++]],o+=t[e[n++]],o+=t[e[n++]],o+=t[e[n++]],o+=t[e[n++]],o}}();function AF(s){return{asString:async()=>s,asFile:()=>{},value:typeof s=="string"?s:void 0}}function q1e(s,e,t){const i={id:$x(),name:s,uri:e,data:t};return{asString:async()=>"",asFile:()=>i,value:void 0}}class Yj{constructor(){this._entries=new Map}get size(){let e=0;for(const t of this._entries)e++;return e}has(e){return this._entries.has(this.toKey(e))}matches(e){const t=[...this._entries.keys()];return st.some(this,([i,n])=>n.asFile())&&t.push("files"),Qj(wS(e),t)}get(e){return this._entries.get(this.toKey(e))?.[0]}append(e,t){const i=this._entries.get(e);i?i.push(t):this._entries.set(this.toKey(e),[t])}replace(e,t){this._entries.set(this.toKey(e),[t])}delete(e){this._entries.delete(this.toKey(e))}*[Symbol.iterator](){for(const[e,t]of this._entries)for(const i of t)yield[e,i]}toKey(e){return wS(e)}}function wS(s){return s.toLowerCase()}function Xj(s,e){return Qj(wS(s),e.map(wS))}function Qj(s,e){if(s==="*/*")return e.length>0;if(e.includes(s))return!0;const t=s.match(/^([a-z]+)\/([a-z]+|\*)$/i);if(!t)return!1;const[i,n,o]=t;return o==="*"?e.some(r=>r.startsWith(n+"/")):!1}const jx=Object.freeze({create:s=>Pc(s.map(e=>e.toString())).join(`\r
`),split:s=>s.split(`\r
`),parse:s=>jx.split(s).filter(e=>!e.startsWith("#"))});class Ot{static{this.sep="."}static{this.None=new Ot("@@none@@")}static{this.Empty=new Ot("")}constructor(e){this.value=e}equals(e){return this.value===e.value}contains(e){return this.equals(e)||this.value===""||e.value.startsWith(this.value+Ot.sep)}intersects(e){return this.contains(e)||e.contains(this)}append(...e){return new Ot((this.value?[this.value,...e]:e).join(Ot.sep))}}const n7={EDITORS:"CodeEditors",FILES:"CodeFiles"};class G1e{}const Y1e={DragAndDropContribution:"workbench.contributions.dragAndDrop"};ci.add(Y1e.DragAndDropContribution,new G1e);class SS{static{this.INSTANCE=new SS}constructor(){}static getInstance(){return SS.INSTANCE}hasData(e){return e&&e===this.proto}getData(e){if(this.hasData(e))return this.data}}function Jj(s){const e=new Yj;for(const t of s.items){const i=t.type;if(t.kind==="string"){const n=new Promise(o=>t.getAsString(o));e.append(i,AF(n))}else if(t.kind==="file"){const n=t.getAsFile();n&&e.append(i,X1e(n))}}return e}function X1e(s){const e=s.path?Se.parse(s.path):void 0;return q1e(s.name,e,async()=>new Uint8Array(await s.arrayBuffer()))}const Q1e=Object.freeze([n7.EDITORS,n7.FILES,fv.RESOURCES,fv.INTERNAL_URI_LIST]);function eZ(s,e=!1){const t=Jj(s),i=t.get(fv.INTERNAL_URI_LIST);if(i)t.replace(wi.uriList,i);else if(e||!t.has(wi.uriList)){const n=[];for(const o of s.items){const r=o.getAsFile();if(r){const a=r.path;try{a?n.push(Se.file(a).toString()):n.push(Se.parse(r.name,!0).toString())}catch{}}}n.length&&t.replace(wi.uriList,AF(jx.create(n)))}for(const n of Q1e)t.delete(n);return t}var PF=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Vv=function(s,e){return function(t,i){e(t,i,s)}};class OF{async provideDocumentPasteEdits(e,t,i,n,o){const r=await this.getEdit(i,o);if(r)return{edits:[{insertText:r.insertText,title:r.title,kind:r.kind,handledMimeType:r.handledMimeType,yieldTo:r.yieldTo}],dispose(){}}}async provideDocumentDropEdits(e,t,i,n){const o=await this.getEdit(i,n);if(o)return{edits:[{insertText:o.insertText,title:o.title,kind:o.kind,handledMimeType:o.handledMimeType,yieldTo:o.yieldTo}],dispose(){}}}}class ng extends OF{constructor(){super(...arguments),this.kind=ng.kind,this.dropMimeTypes=[wi.text],this.pasteMimeTypes=[wi.text]}static{this.id="text"}static{this.kind=new Ot("text.plain")}async getEdit(e,t){const i=e.get(wi.text);if(!i||e.has(wi.uriList))return;const n=await i.asString();return{handledMimeType:wi.text,title:p("text.label","Insert Plain Text"),insertText:n,kind:this.kind}}}class tZ extends OF{constructor(){super(...arguments),this.kind=new Ot("uri.absolute"),this.dropMimeTypes=[wi.uriList],this.pasteMimeTypes=[wi.uriList]}async getEdit(e,t){const i=await iZ(e);if(!i.length||t.isCancellationRequested)return;let n=0;const o=i.map(({uri:a,originalText:l})=>a.scheme===Fe.file?a.fsPath:(n++,l)).join(" ");let r;return n>0?r=i.length>1?p("defaultDropProvider.uriList.uris","Insert Uris"):p("defaultDropProvider.uriList.uri","Insert Uri"):r=i.length>1?p("defaultDropProvider.uriList.paths","Insert Paths"):p("defaultDropProvider.uriList.path","Insert Path"),{handledMimeType:wi.uriList,insertText:o,title:r,kind:this.kind}}}let LS=class extends OF{constructor(e){super(),this._workspaceContextService=e,this.kind=new Ot("uri.relative"),this.dropMimeTypes=[wi.uriList],this.pasteMimeTypes=[wi.uriList]}async getEdit(e,t){const i=await iZ(e);if(!i.length||t.isCancellationRequested)return;const n=Yr(i.map(({uri:o})=>{const r=this._workspaceContextService.getWorkspaceFolder(o);return r?ele(r.uri,o):void 0}));if(n.length)return{handledMimeType:wi.uriList,insertText:n.join(" "),title:i.length>1?p("defaultDropProvider.uriList.relativePaths","Insert Relative Paths"):p("defaultDropProvider.uriList.relativePath","Insert Relative Path"),kind:this.kind}}};LS=PF([Vv(0,Xu)],LS);class J1e{constructor(){this.kind=new Ot("html"),this.pasteMimeTypes=["text/html"],this._yieldTo=[{mimeType:wi.text}]}async provideDocumentPasteEdits(e,t,i,n,o){if(n.triggerKind!==$b.PasteAs&&!n.only?.contains(this.kind))return;const a=await i.get("text/html")?.asString();if(!(!a||o.isCancellationRequested))return{dispose(){},edits:[{insertText:a,yieldTo:this._yieldTo,title:p("pasteHtmlLabel","Insert HTML"),kind:this.kind}]}}}async function iZ(s){const e=s.get(wi.uriList);if(!e)return[];const t=await e.asString(),i=[];for(const n of jx.parse(t))try{i.push({uri:Se.parse(n),originalText:n})}catch{}return i}let QR=class extends B{constructor(e,t){super(),this._register(e.documentDropEditProvider.register("*",new ng)),this._register(e.documentDropEditProvider.register("*",new tZ)),this._register(e.documentDropEditProvider.register("*",new LS(t)))}};QR=PF([Vv(0,pe),Vv(1,Xu)],QR);let JR=class extends B{constructor(e,t){super(),this._register(e.documentPasteEditProvider.register("*",new ng)),this._register(e.documentPasteEditProvider.register("*",new tZ)),this._register(e.documentPasteEditProvider.register("*",new LS(t))),this._register(e.documentPasteEditProvider.register("*",new J1e))}};JR=PF([Vv(0,pe),Vv(1,Xu)],JR);class pa{constructor(){this.value="",this.pos=0}static{this._table={36:0,58:1,44:2,123:3,125:4,92:5,47:6,124:7,43:11,45:12,63:13}}static isDigitCharacter(e){return e>=48&&e<=57}static isVariableCharacter(e){return e===95||e>=97&&e<=122||e>=65&&e<=90}text(e){this.value=e,this.pos=0}tokenText(e){return this.value.substr(e.pos,e.len)}next(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};const e=this.pos;let t=0,i=this.value.charCodeAt(e),n;if(n=pa._table[i],typeof n=="number")return this.pos+=1,{type:n,pos:e,len:1};if(pa.isDigitCharacter(i)){n=8;do t+=1,i=this.value.charCodeAt(e+t);while(pa.isDigitCharacter(i));return this.pos+=t,{type:n,pos:e,len:t}}if(pa.isVariableCharacter(i)){n=9;do i=this.value.charCodeAt(e+ ++t);while(pa.isVariableCharacter(i)||pa.isDigitCharacter(i));return this.pos+=t,{type:n,pos:e,len:t}}n=10;do t+=1,i=this.value.charCodeAt(e+t);while(!isNaN(i)&&typeof pa._table[i]>"u"&&!pa.isDigitCharacter(i)&&!pa.isVariableCharacter(i));return this.pos+=t,{type:n,pos:e,len:t}}}class Om{constructor(){this._children=[]}appendChild(e){return e instanceof us&&this._children[this._children.length-1]instanceof us?this._children[this._children.length-1].value+=e.value:(e.parent=this,this._children.push(e)),this}replace(e,t){const{parent:i}=e,n=i.children.indexOf(e),o=i.children.slice(0);o.splice(n,1,...t),i._children=o,function r(a,l){for(const c of a)c.parent=l,r(c.children,c)}(t,i)}get children(){return this._children}get rightMostDescendant(){return this._children.length>0?this._children[this._children.length-1].rightMostDescendant:this}get snippet(){let e=this;for(;;){if(!e)return;if(e instanceof GC)return e;e=e.parent}}toString(){return this.children.reduce((e,t)=>e+t.toString(),"")}len(){return 0}}class us extends Om{constructor(e){super(),this.value=e}toString(){return this.value}len(){return this.value.length}clone(){return new us(this.value)}}class nZ extends Om{}class ar extends nZ{static compareByIndex(e,t){return e.index===t.index?0:e.isFinalTabstop?1:t.isFinalTabstop||e.index<t.index?-1:e.index>t.index?1:0}constructor(e){super(),this.index=e}get isFinalTabstop(){return this.index===0}get choice(){return this._children.length===1&&this._children[0]instanceof Fm?this._children[0]:void 0}clone(){const e=new ar(this.index);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(t=>t.clone()),e}}class Fm extends Om{constructor(){super(...arguments),this.options=[]}appendChild(e){return e instanceof us&&(e.parent=this,this.options.push(e)),this}toString(){return this.options[0].value}len(){return this.options[0].len()}clone(){const e=new Fm;return this.options.forEach(e.appendChild,e),e}}class FF extends Om{constructor(){super(...arguments),this.regexp=new RegExp("")}resolve(e){const t=this;let i=!1,n=e.replace(this.regexp,function(){return i=!0,t._replace(Array.prototype.slice.call(arguments,0,-2))});return!i&&this._children.some(o=>o instanceof ya&&!!o.elseValue)&&(n=this._replace([])),n}_replace(e){let t="";for(const i of this._children)if(i instanceof ya){let n=e[i.index]||"";n=i.resolve(n),t+=n}else t+=i.toString();return t}toString(){return""}clone(){const e=new FF;return e.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),e._children=this.children.map(t=>t.clone()),e}}class ya extends Om{constructor(e,t,i,n){super(),this.index=e,this.shorthandName=t,this.ifValue=i,this.elseValue=n}resolve(e){return this.shorthandName==="upcase"?e?e.toLocaleUpperCase():"":this.shorthandName==="downcase"?e?e.toLocaleLowerCase():"":this.shorthandName==="capitalize"?e?e[0].toLocaleUpperCase()+e.substr(1):"":this.shorthandName==="pascalcase"?e?this._toPascalCase(e):"":this.shorthandName==="camelcase"?e?this._toCamelCase(e):"":e&&typeof this.ifValue=="string"?this.ifValue:!e&&typeof this.elseValue=="string"?this.elseValue:e||""}_toPascalCase(e){const t=e.match(/[a-z0-9]+/gi);return t?t.map(i=>i.charAt(0).toUpperCase()+i.substr(1)).join(""):e}_toCamelCase(e){const t=e.match(/[a-z0-9]+/gi);return t?t.map((i,n)=>n===0?i.charAt(0).toLowerCase()+i.substr(1):i.charAt(0).toUpperCase()+i.substr(1)).join(""):e}clone(){return new ya(this.index,this.shorthandName,this.ifValue,this.elseValue)}}class zv extends nZ{constructor(e){super(),this.name=e}resolve(e){let t=e.resolve(this);return this.transform&&(t=this.transform.resolve(t||"")),t!==void 0?(this._children=[new us(t)],!0):!1}clone(){const e=new zv(this.name);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(t=>t.clone()),e}}function s7(s,e){const t=[...s];for(;t.length>0;){const i=t.shift();if(!e(i))break;t.unshift(...i.children)}}class GC extends Om{get placeholderInfo(){if(!this._placeholders){const e=[];let t;this.walk(function(i){return i instanceof ar&&(e.push(i),t=!t||t.index<i.index?i:t),!0}),this._placeholders={all:e,last:t}}return this._placeholders}get placeholders(){const{all:e}=this.placeholderInfo;return e}offset(e){let t=0,i=!1;return this.walk(n=>n===e?(i=!0,!1):(t+=n.len(),!0)),i?t:-1}fullLen(e){let t=0;return s7([e],i=>(t+=i.len(),!0)),t}enclosingPlaceholders(e){const t=[];let{parent:i}=e;for(;i;)i instanceof ar&&t.push(i),i=i.parent;return t}resolveVariables(e){return this.walk(t=>(t instanceof zv&&t.resolve(e)&&(this._placeholders=void 0),!0)),this}appendChild(e){return this._placeholders=void 0,super.appendChild(e)}replace(e,t){return this._placeholders=void 0,super.replace(e,t)}clone(){const e=new GC;return this._children=this.children.map(t=>t.clone()),e}walk(e){s7(this.children,e)}}class sg{constructor(){this._scanner=new pa,this._token={type:14,pos:0,len:0}}static escape(e){return e.replace(/\$|}|\\/g,"\\$&")}static guessNeedsClipboard(e){return/\${?CLIPBOARD/.test(e)}parse(e,t,i){const n=new GC;return this.parseFragment(e,n),this.ensureFinalTabstop(n,i??!1,t??!1),n}parseFragment(e,t){const i=t.children.length;for(this._scanner.text(e),this._token=this._scanner.next();this._parse(t););const n=new Map,o=[];t.walk(l=>(l instanceof ar&&(l.isFinalTabstop?n.set(0,void 0):!n.has(l.index)&&l.children.length>0?n.set(l.index,l.children):o.push(l)),!0));const r=(l,c)=>{const d=n.get(l.index);if(!d)return;const h=new ar(l.index);h.transform=l.transform;for(const u of d){const g=u.clone();h.appendChild(g),g instanceof ar&&n.has(g.index)&&!c.has(g.index)&&(c.add(g.index),r(g,c),c.delete(g.index))}t.replace(l,[h])},a=new Set;for(const l of o)r(l,a);return t.children.slice(i)}ensureFinalTabstop(e,t,i){(t||i&&e.placeholders.length>0)&&(e.placeholders.find(o=>o.index===0)||e.appendChild(new ar(0)))}_accept(e,t){if(e===void 0||this._token.type===e){const i=t?this._scanner.tokenText(this._token):!0;return this._token=this._scanner.next(),i}return!1}_backTo(e){return this._scanner.pos=e.pos+e.len,this._token=e,!1}_until(e){const t=this._token;for(;this._token.type!==e;){if(this._token.type===14)return!1;if(this._token.type===5){const n=this._scanner.next();if(n.type!==0&&n.type!==4&&n.type!==5)return!1}this._token=this._scanner.next()}const i=this._scanner.value.substring(t.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),i}_parse(e){return this._parseEscaped(e)||this._parseTabstopOrVariableName(e)||this._parseComplexPlaceholder(e)||this._parseComplexVariable(e)||this._parseAnything(e)}_parseEscaped(e){let t;return(t=this._accept(5,!0))?(t=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||t,e.appendChild(new us(t)),!0):!1}_parseTabstopOrVariableName(e){let t;const i=this._token;return this._accept(0)&&(t=this._accept(9,!0)||this._accept(8,!0))?(e.appendChild(/^\d+$/.test(t)?new ar(Number(t)):new zv(t)),!0):this._backTo(i)}_parseComplexPlaceholder(e){let t;const i=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(8,!0))))return this._backTo(i);const o=new ar(Number(t));if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(o),!0;if(!this._parse(o))return e.appendChild(new us("${"+t+":")),o.children.forEach(e.appendChild,e),!0}else if(o.index>0&&this._accept(7)){const r=new Fm;for(;;){if(this._parseChoiceElement(r)){if(this._accept(2))continue;if(this._accept(7)&&(o.appendChild(r),this._accept(4)))return e.appendChild(o),!0}return this._backTo(i),!1}}else return this._accept(6)?this._parseTransform(o)?(e.appendChild(o),!0):(this._backTo(i),!1):this._accept(4)?(e.appendChild(o),!0):this._backTo(i)}_parseChoiceElement(e){const t=this._token,i=[];for(;!(this._token.type===2||this._token.type===7);){let n;if((n=this._accept(5,!0))?n=this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||n:n=this._accept(void 0,!0),!n)return this._backTo(t),!1;i.push(n)}return i.length===0?(this._backTo(t),!1):(e.appendChild(new us(i.join(""))),!0)}_parseComplexVariable(e){let t;const i=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(9,!0))))return this._backTo(i);const o=new zv(t);if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(o),!0;if(!this._parse(o))return e.appendChild(new us("${"+t+":")),o.children.forEach(e.appendChild,e),!0}else return this._accept(6)?this._parseTransform(o)?(e.appendChild(o),!0):(this._backTo(i),!1):this._accept(4)?(e.appendChild(o),!0):this._backTo(i)}_parseTransform(e){const t=new FF;let i="",n="";for(;!this._accept(6);){let o;if(o=this._accept(5,!0)){o=this._accept(6,!0)||o,i+=o;continue}if(this._token.type!==14){i+=this._accept(void 0,!0);continue}return!1}for(;!this._accept(6);){let o;if(o=this._accept(5,!0)){o=this._accept(5,!0)||this._accept(6,!0)||o,t.appendChild(new us(o));continue}if(!(this._parseFormatString(t)||this._parseAnything(t)))return!1}for(;!this._accept(4);){if(this._token.type!==14){n+=this._accept(void 0,!0);continue}return!1}try{t.regexp=new RegExp(i,n)}catch{return!1}return e.transform=t,!0}_parseFormatString(e){const t=this._token;if(!this._accept(0))return!1;let i=!1;this._accept(3)&&(i=!0);const n=this._accept(8,!0);if(n)if(i){if(this._accept(4))return e.appendChild(new ya(Number(n))),!0;if(!this._accept(1))return this._backTo(t),!1}else return e.appendChild(new ya(Number(n))),!0;else return this._backTo(t),!1;if(this._accept(6)){const o=this._accept(9,!0);return!o||!this._accept(4)?(this._backTo(t),!1):(e.appendChild(new ya(Number(n),o)),!0)}else if(this._accept(11)){const o=this._until(4);if(o)return e.appendChild(new ya(Number(n),void 0,o,void 0)),!0}else if(this._accept(12)){const o=this._until(4);if(o)return e.appendChild(new ya(Number(n),void 0,void 0,o)),!0}else if(this._accept(13)){const o=this._until(1);if(o){const r=this._until(4);if(r)return e.appendChild(new ya(Number(n),void 0,o,r)),!0}}else{const o=this._until(4);if(o)return e.appendChild(new ya(Number(n),void 0,void 0,o)),!0}return this._backTo(t),!1}_parseAnything(e){return this._token.type!==14?(e.appendChild(new us(this._scanner.tokenText(this._token))),this._accept(void 0),!0):!1}}function sZ(s,e,t){return(typeof t.insertText=="string"?t.insertText==="":t.insertText.snippet==="")?{edits:t.additionalEdit?.edits??[]}:{edits:[...e.map(i=>new qd(s,{range:i,text:typeof t.insertText=="string"?sg.escape(t.insertText)+"$0":t.insertText.snippet,insertAsSnippet:!0})),...t.additionalEdit?.edits??[]]}}function oZ(s){function e(r,a){return"mimeType"in r?r.mimeType===a.handledMimeType:!!a.kind&&r.kind.contains(a.kind)}const t=new Map;for(const r of s)for(const a of r.yieldTo??[])for(const l of s)if(l!==r&&e(a,l)){let c=t.get(r);c||(c=[],t.set(r,c)),c.push(l)}if(!t.size)return Array.from(s);const i=new Set,n=[];function o(r){if(!r.length)return[];const a=r[0];if(n.includes(a))return console.warn("Yield to cycle detected",a),r;if(i.has(a))return o(r.slice(1));let l=[];const c=t.get(a);return c&&(n.push(a),l=o(c),n.pop()),i.add(a),[...l,a,...o(r.slice(1))]}return o(Array.from(s))}var e0e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},t0e=function(s,e){return function(t,i){e(t,i,s)}};const i0e=We.register({description:"inline-progress-widget",stickiness:1,showIfCollapsed:!0,after:{content:R6,inlineClassName:"inline-editor-progress-decoration",inlineClassNameAffectsLetterSpacing:!0}});class BF extends B{static{this.baseId="editor.widget.inlineProgressWidget"}constructor(e,t,i,n,o){super(),this.typeId=e,this.editor=t,this.range=i,this.delegate=o,this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this.create(n),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this)}create(e){this.domNode=te(".inline-progress-widget"),this.domNode.role="button",this.domNode.title=e;const t=te("span.icon");this.domNode.append(t),t.classList.add(...Ie.asClassNameArray(J.loading),"codicon-modifier-spin");const i=()=>{const n=this.editor.getOption(67);this.domNode.style.height=`${n}px`,this.domNode.style.width=`${Math.ceil(.8*n)}px`};i(),this._register(this.editor.onDidChangeConfiguration(n=>{(n.hasChanged(52)||n.hasChanged(67))&&i()})),this._register(U(this.domNode,ee.CLICK,n=>{this.delegate.cancel()}))}getId(){return BF.baseId+"."+this.typeId}getDomNode(){return this.domNode}getPosition(){return{position:{lineNumber:this.range.startLineNumber,column:this.range.startColumn},preference:[0]}}dispose(){super.dispose(),this.editor.removeContentWidget(this)}}let xS=class extends B{constructor(e,t,i){super(),this.id=e,this._editor=t,this._instantiationService=i,this._showDelay=500,this._showPromise=this._register(new nn),this._currentWidget=this._register(new nn),this._operationIdPool=0,this._currentDecorations=t.createDecorationsCollection()}dispose(){super.dispose(),this._currentDecorations.clear()}async showWhile(e,t,i,n,o){const r=this._operationIdPool++;this._currentOperation=r,this.clear(),this._showPromise.value=nh(()=>{const a=k.fromPositions(e);this._currentDecorations.set([{range:a,options:i0e}]).length>0&&(this._currentWidget.value=this._instantiationService.createInstance(BF,this.id,this._editor,a,t,n))},o??this._showDelay);try{return await i}finally{this._currentOperation===r&&(this.clear(),this._currentOperation=void 0)}}clear(){this._showPromise.clear(),this._currentDecorations.clear(),this._currentWidget.clear()}};xS=e0e([t0e(2,ye)],xS);var n0e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},o7=function(s,e){return function(t,i){e(t,i,s)}},s1;let go=class{static{s1=this}static{this.ID="editor.contrib.messageController"}static{this.MESSAGE_VISIBLE=new le("messageVisible",!1,p("messageVisible","Whether the editor is currently showing an inline message"))}static get(e){return e.getContribution(s1.ID)}constructor(e,t,i){this._openerService=i,this._messageWidget=new nn,this._messageListeners=new Z,this._mouseOverMessage=!1,this._editor=e,this._visible=s1.MESSAGE_VISIBLE.bindTo(t)}dispose(){this._message?.dispose(),this._messageListeners.dispose(),this._messageWidget.dispose(),this._visible.reset()}showMessage(e,t){Ls(Pa(e)?e.value:e),this._visible.set(!0),this._messageWidget.clear(),this._messageListeners.clear(),this._message=Pa(e)?tx(e,{actionHandler:{callback:n=>{this.closeMessage(),j2(this._openerService,n,Pa(e)?e.isTrusted:void 0)},disposables:this._messageListeners}}):void 0,this._messageWidget.value=new r7(this._editor,t,typeof e=="string"?e:this._message.element),this._messageListeners.add(se.debounce(this._editor.onDidBlurEditorText,(n,o)=>o,0)(()=>{this._mouseOverMessage||this._messageWidget.value&&Ji(Rn(),this._messageWidget.value.getDomNode())||this.closeMessage()})),this._messageListeners.add(this._editor.onDidChangeCursorPosition(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidDispose(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidChangeModel(()=>this.closeMessage())),this._messageListeners.add(U(this._messageWidget.value.getDomNode(),ee.MOUSE_ENTER,()=>this._mouseOverMessage=!0,!0)),this._messageListeners.add(U(this._messageWidget.value.getDomNode(),ee.MOUSE_LEAVE,()=>this._mouseOverMessage=!1,!0));let i;this._messageListeners.add(this._editor.onMouseMove(n=>{n.target.position&&(i?i.containsPosition(n.target.position)||this.closeMessage():i=new k(t.lineNumber-3,1,n.target.position.lineNumber+3,1))}))}closeMessage(){this._visible.reset(),this._messageListeners.clear(),this._messageWidget.value&&this._messageListeners.add(r7.fadeOut(this._messageWidget.value))}};go=s1=n0e([o7(1,Ee),o7(2,Ys)],go);const s0e=Zi.bindToContribution(go.get);ae(new s0e({id:"leaveEditorMessage",precondition:go.MESSAGE_VISIBLE,handler:s=>s.closeMessage(),kbOpts:{weight:130,primary:9}}));let r7=class{static fadeOut(e){const t=()=>{e.dispose(),clearTimeout(i),e.getDomNode().removeEventListener("animationend",t)},i=setTimeout(t,110);return e.getDomNode().addEventListener("animationend",t),e.getDomNode().classList.add("fadeOut"),{dispose:t}}constructor(e,{lineNumber:t,column:i},n){this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._editor=e,this._editor.revealLinesInCenterIfOutsideViewport(t,t,0),this._position={lineNumber:t,column:i},this._domNode=document.createElement("div"),this._domNode.classList.add("monaco-editor-overlaymessage"),this._domNode.style.marginLeft="-6px";const o=document.createElement("div");o.classList.add("anchor","top"),this._domNode.appendChild(o);const r=document.createElement("div");typeof n=="string"?(r.classList.add("message"),r.textContent=n):(n.classList.add("message"),r.appendChild(n)),this._domNode.appendChild(r);const a=document.createElement("div");a.classList.add("anchor","below"),this._domNode.appendChild(a),this._editor.addContentWidget(this),this._domNode.classList.add("fadeIn")}dispose(){this._editor.removeContentWidget(this)}getId(){return"messageoverlay"}getDomNode(){return this._domNode}getPosition(){return{position:this._position,preference:[1,2],positionAffinity:1}}afterRender(e){this._domNode.classList.toggle("below",e===2)}};ct(go.ID,go,4);function sI(s,e){return e&&(s.stack||s.stacktrace)?p("stackTrace.format","{0}: {1}",l7(s),a7(s.stack)||a7(s.stacktrace)):l7(s)}function a7(s){return Array.isArray(s)?s.join(`
`):s}function l7(s){return s.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${s.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof s.code=="string"&&typeof s.errno=="number"&&typeof s.syscall=="string"?p("nodeExceptionMessage","A system error occurred ({0})",s.message):s.message||p("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function kS(s=null,e=!1){if(!s)return p("error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(s)){const t=Yr(s),i=kS(t[0],e);return t.length>1?p("error.moreErrors","{0} ({1} errors in total)",i,t.length):i}if(zs(s))return s;if(s.detail){const t=s.detail;if(t.error)return sI(t.error,e);if(t.exception)return sI(t.exception,e)}return s.stack?sI(s,e):s.message?s.message:p("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}var rZ=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},up=function(s,e){return function(t,i){e(t,i,s)}},eM;let tM=class extends B{static{eM=this}static{this.baseId="editor.widget.postEditWidget"}constructor(e,t,i,n,o,r,a,l,c,d){super(),this.typeId=e,this.editor=t,this.showCommand=n,this.range=o,this.edits=r,this.onSelectNewEdit=a,this._contextMenuService=l,this._keybindingService=d,this.allowEditorOverflow=!0,this.suppressMouseDown=!0,this.create(),this.visibleContext=i.bindTo(c),this.visibleContext.set(!0),this._register(Ce(()=>this.visibleContext.reset())),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this),this._register(Ce(()=>this.editor.removeContentWidget(this))),this._register(this.editor.onDidChangeCursorPosition(h=>{o.containsPosition(h.position)||this.dispose()})),this._register(se.runAndSubscribe(d.onDidUpdateKeybindings,()=>{this._updateButtonTitle()}))}_updateButtonTitle(){const e=this._keybindingService.lookupKeybinding(this.showCommand.id)?.getLabel();this.button.element.title=this.showCommand.label+(e?` (${e})`:"")}create(){this.domNode=te(".post-edit-widget"),this.button=this._register(new O0(this.domNode,{supportIcons:!0})),this.button.label="$(insert)",this._register(U(this.domNode,ee.CLICK,()=>this.showSelector()))}getId(){return eM.baseId+"."+this.typeId}getDomNode(){return this.domNode}getPosition(){return{position:this.range.getEndPosition(),preference:[2]}}showSelector(){this._contextMenuService.showContextMenu({getAnchor:()=>{const e=Si(this.button.element);return{x:e.left+e.width,y:e.top+e.height}},getActions:()=>this.edits.allEdits.map((e,t)=>Du({id:"",label:e.title,checked:t===this.edits.activeEditIndex,run:()=>{if(t!==this.edits.activeEditIndex)return this.onSelectNewEdit(t)}}))})}};tM=eM=rZ([up(7,bo),up(8,Ee),up(9,yt)],tM);let DS=class extends B{constructor(e,t,i,n,o,r,a){super(),this._id=e,this._editor=t,this._visibleContext=i,this._showCommand=n,this._instantiationService=o,this._bulkEditService=r,this._notificationService=a,this._currentWidget=this._register(new nn),this._register(se.any(t.onDidChangeModel,t.onDidChangeModelContent)(()=>this.clear()))}async applyEditAndShowIfNeeded(e,t,i,n,o){const r=this._editor.getModel();if(!r||!e.length)return;const a=t.allEdits.at(t.activeEditIndex);if(!a)return;const l=async _=>{const b=this._editor.getModel();b&&(await b.undo(),this.applyEditAndShowIfNeeded(e,{activeEditIndex:_,allEdits:t.allEdits},i,n,o))},c=(_,b)=>{xr(_)||(this._notificationService.error(b),i&&this.show(e[0],t,l))};let d;try{d=await n(a,o)}catch(_){return c(_,p("resolveError",`Error resolving edit '{0}':
{1}`,a.title,kS(_)))}if(o.isCancellationRequested)return;const h=sZ(r.uri,e,d),u=e[0],g=r.deltaDecorations([],[{range:u,options:{description:"paste-line-suffix",stickiness:0}}]);this._editor.focus();let f,m;try{f=await this._bulkEditService.apply(h,{editor:this._editor,token:o}),m=r.getDecorationRange(g[0])}catch(_){return c(_,p("applyError",`Error applying edit '{0}':
{1}`,a.title,kS(_)))}finally{r.deltaDecorations(g,[])}o.isCancellationRequested||i&&f.isApplied&&t.allEdits.length>1&&this.show(m??u,t,l)}show(e,t,i){this.clear(),this._editor.hasModel()&&(this._currentWidget.value=this._instantiationService.createInstance(tM,this._id,this._editor,this._visibleContext,this._showCommand,e,t,i))}clear(){this._currentWidget.clear()}tryShowSelector(){this._currentWidget.value?.showSelector()}};DS=rZ([up(4,ye),up(5,EC),up(6,Ii)],DS);var o0e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Gg=function(s,e){return function(t,i){e(t,i,s)}},Jh;const aZ="editor.changePasteType",WF=new le("pasteWidgetVisible",!1,p("pasteWidgetVisible","Whether the paste widget is showing")),oI="application/vnd.code.copyMetadata";let jc=class extends B{static{Jh=this}static{this.ID="editor.contrib.copyPasteActionController"}static get(e){return e.getContribution(Jh.ID)}constructor(e,t,i,n,o,r,a){super(),this._bulkEditService=i,this._clipboardService=n,this._languageFeaturesService=o,this._quickInputService=r,this._progressService=a,this._editor=e;const l=e.getContainerDomNode();this._register(U(l,"copy",c=>this.handleCopy(c))),this._register(U(l,"cut",c=>this.handleCopy(c))),this._register(U(l,"paste",c=>this.handlePaste(c),!0)),this._pasteProgressManager=this._register(new xS("pasteIntoEditor",e,t)),this._postPasteWidgetManager=this._register(t.createInstance(DS,"pasteIntoEditor",e,WF,{id:aZ,label:p("postPasteWidgetTitle","Show paste options...")}))}changePasteType(){this._postPasteWidgetManager.tryShowSelector()}pasteAs(e){this._editor.focus();try{this._pasteAsActionContext={preferred:e},mm().execCommand("paste")}finally{this._pasteAsActionContext=void 0}}clearWidgets(){this._postPasteWidgetManager.clear()}isPasteAsEnabled(){return this._editor.getOption(85).enabled}async finishedPaste(){await this._currentPasteOperation}handleCopy(e){if(!this._editor.hasTextFocus()||(this._clipboardService.clearInternalState?.(),!e.clipboardData||!this.isPasteAsEnabled()))return;const t=this._editor.getModel(),i=this._editor.getSelections();if(!t||!i?.length)return;const n=this._editor.getOption(37);let o=i;const r=i.length===1&&i[0].isEmpty();if(r){if(!n)return;o=[new k(o[0].startLineNumber,1,o[0].startLineNumber,1+t.getLineLength(o[0].startLineNumber))]}const a=this._editor._getViewModel()?.getPlainTextToCopy(i,n,An),c={multicursorText:Array.isArray(a)?a:null,pasteOnNewLine:r,mode:null},d=this._languageFeaturesService.documentPasteEditProvider.ordered(t).filter(m=>!!m.prepareDocumentPaste);if(!d.length){this.setCopyMetadata(e.clipboardData,{defaultPastePayload:c});return}const h=Jj(e.clipboardData),u=d.flatMap(m=>m.copyMimeTypes??[]),g=$x();this.setCopyMetadata(e.clipboardData,{id:g,providerCopyMimeTypes:u,defaultPastePayload:c});const f=en(async m=>{const _=Yr(await Promise.all(d.map(async b=>{try{return await b.prepareDocumentPaste(t,o,h,m)}catch(v){console.error(v);return}})));_.reverse();for(const b of _)for(const[v,C]of b)h.replace(v,C);return h});Jh._currentCopyOperation?.dataTransferPromise.cancel(),Jh._currentCopyOperation={handle:g,dataTransferPromise:f}}async handlePaste(e){if(!e.clipboardData||!this._editor.hasTextFocus())return;go.get(this._editor)?.closeMessage(),this._currentPasteOperation?.cancel(),this._currentPasteOperation=void 0;const t=this._editor.getModel(),i=this._editor.getSelections();if(!i?.length||!t||this._editor.getOption(92)||!this.isPasteAsEnabled()&&!this._pasteAsActionContext)return;const n=this.fetchCopyMetadata(e),o=eZ(e.clipboardData);o.delete(oI);const r=[...e.clipboardData.types,...n?.providerCopyMimeTypes??[],wi.uriList],a=this._languageFeaturesService.documentPasteEditProvider.ordered(t).filter(l=>{const c=this._pasteAsActionContext?.preferred;return c&&l.providedPasteEditKinds&&!this.providerMatchesPreference(l,c)?!1:l.pasteMimeTypes?.some(d=>Xj(d,r))});if(!a.length){this._pasteAsActionContext?.preferred&&this.showPasteAsNoEditMessage(i,this._pasteAsActionContext.preferred);return}e.preventDefault(),e.stopImmediatePropagation(),this._pasteAsActionContext?this.showPasteAsPick(this._pasteAsActionContext.preferred,a,i,o,n):this.doPasteInline(a,i,o,n,e)}showPasteAsNoEditMessage(e,t){go.get(this._editor)?.showMessage(p("pasteAsError","No paste edits for '{0}' found",t instanceof Ot?t.value:t.providerId),e[0].getStartPosition())}doPasteInline(e,t,i,n,o){const r=this._editor;if(!r.hasModel())return;const a=new gh(r,3,void 0),l=en(async c=>{const d=this._editor;if(!d.hasModel())return;const h=d.getModel(),u=new Z,g=u.add(new li(c));u.add(a.token.onCancellationRequested(()=>g.cancel()));const f=g.token;try{if(await this.mergeInDataFromCopy(i,n,f),f.isCancellationRequested)return;const m=e.filter(v=>this.isSupportedPasteProvider(v,i));if(!m.length||m.length===1&&m[0]instanceof ng)return this.applyDefaultPasteHandler(i,n,f,o);const _={triggerKind:$b.Automatic},b=await this.getPasteEdits(m,i,h,t,_,f);if(u.add(b),f.isCancellationRequested)return;if(b.edits.length===1&&b.edits[0].provider instanceof ng)return this.applyDefaultPasteHandler(i,n,f,o);if(b.edits.length){const v=d.getOption(85).showPasteSelector==="afterPaste";return this._postPasteWidgetManager.applyEditAndShowIfNeeded(t,{activeEditIndex:0,allEdits:b.edits},v,(C,y)=>new Promise((w,x)=>{(async()=>{try{const L=C.provider.resolveDocumentPasteEdit?.(C,y),D=new pm,T=L&&await this._pasteProgressManager.showWhile(t[0].getEndPosition(),p("resolveProcess","Resolving paste edit. Click to cancel"),Promise.race([D.p,L]),{cancel:()=>(D.cancel(),x(new Xr))},0);return T&&(C.additionalEdit=T.additionalEdit),w(C)}catch(L){return x(L)}})()}),f)}await this.applyDefaultPasteHandler(i,n,f,o)}finally{u.dispose(),this._currentPasteOperation===l&&(this._currentPasteOperation=void 0)}});this._pasteProgressManager.showWhile(t[0].getEndPosition(),p("pasteIntoEditorProgress","Running paste handlers. Click to cancel and do basic paste"),l,{cancel:async()=>{try{if(l.cancel(),a.token.isCancellationRequested)return;await this.applyDefaultPasteHandler(i,n,a.token,o)}finally{a.dispose()}}}).then(()=>{a.dispose()}),this._currentPasteOperation=l}showPasteAsPick(e,t,i,n,o){const r=en(async a=>{const l=this._editor;if(!l.hasModel())return;const c=l.getModel(),d=new Z,h=d.add(new gh(l,3,void 0,a));try{if(await this.mergeInDataFromCopy(n,o,h.token),h.token.isCancellationRequested)return;let u=t.filter(b=>this.isSupportedPasteProvider(b,n,e));e&&(u=u.filter(b=>this.providerMatchesPreference(b,e)));const g={triggerKind:$b.PasteAs,only:e&&e instanceof Ot?e:void 0};let f=d.add(await this.getPasteEdits(u,n,c,i,g,h.token));if(h.token.isCancellationRequested)return;if(e&&(f={edits:f.edits.filter(b=>e instanceof Ot?e.contains(b.kind):e.providerId===b.provider.id),dispose:f.dispose}),!f.edits.length){g.only&&this.showPasteAsNoEditMessage(i,g.only);return}let m;if(e?m=f.edits.at(0):m=(await this._quickInputService.pick(f.edits.map(v=>({label:v.title,description:v.kind?.value,edit:v})),{placeHolder:p("pasteAsPickerPlaceholder","Select Paste Action")}))?.edit,!m)return;const _=sZ(c.uri,i,m);await this._bulkEditService.apply(_,{editor:this._editor})}finally{d.dispose(),this._currentPasteOperation===r&&(this._currentPasteOperation=void 0)}});this._progressService.withProgress({location:10,title:p("pasteAsProgress","Running paste handlers")},()=>r)}setCopyMetadata(e,t){e.setData(oI,JSON.stringify(t))}fetchCopyMetadata(e){if(!e.clipboardData)return;const t=e.clipboardData.getData(oI);if(t)try{return JSON.parse(t)}catch{return}const[i,n]=bR.getTextData(e.clipboardData);if(n)return{defaultPastePayload:{mode:n.mode,multicursorText:n.multicursorText??null,pasteOnNewLine:!!n.isFromEmptySelection}}}async mergeInDataFromCopy(e,t,i){if(t?.id&&Jh._currentCopyOperation?.handle===t.id){const n=await Jh._currentCopyOperation.dataTransferPromise;if(i.isCancellationRequested)return;for(const[o,r]of n)e.replace(o,r)}if(!e.has(wi.uriList)){const n=await this._clipboardService.readResources();if(i.isCancellationRequested)return;n.length&&e.append(wi.uriList,AF(jx.create(n)))}}async getPasteEdits(e,t,i,n,o,r){const a=new Z,l=await yC(Promise.all(e.map(async d=>{try{const h=await d.provideDocumentPasteEdits?.(i,n,t,o,r);return h&&a.add(h),h?.edits?.map(u=>({...u,provider:d}))}catch(h){xr(h)||console.error(h);return}})),r),c=Yr(l??[]).flat().filter(d=>!o.only||o.only.contains(d.kind));return{edits:oZ(c),dispose:()=>a.dispose()}}async applyDefaultPasteHandler(e,t,i,n){const r=await(e.get(wi.text)??e.get("text"))?.asString()??"";if(i.isCancellationRequested)return;const a={clipboardEvent:n,text:r,pasteOnNewLine:t?.defaultPastePayload.pasteOnNewLine??!1,multicursorText:t?.defaultPastePayload.multicursorText??null,mode:null};this._editor.trigger("keyboard","paste",a)}isSupportedPasteProvider(e,t,i){return e.pasteMimeTypes?.some(n=>t.matches(n))?!i||this.providerMatchesPreference(e,i):!1}providerMatchesPreference(e,t){return t instanceof Ot?e.providedPasteEditKinds?e.providedPasteEditKinds.some(i=>t.contains(i)):!0:e.id===t.providerId}};jc=Jh=o0e([Gg(1,ye),Gg(2,EC),Gg(3,Jc),Gg(4,pe),Gg(5,Dr),Gg(6,Hz)],jc);const og="9_cutcopypaste",r0e=Ia||document.queryCommandSupported("cut"),lZ=Ia||document.queryCommandSupported("copy"),a0e=typeof navigator.clipboard>"u"||vr?document.queryCommandSupported("paste"):!0;function HF(s){return s.register(),s}const l0e=r0e?HF(new bm({id:"editor.action.clipboardCutAction",precondition:void 0,kbOpts:Ia?{primary:2102,win:{primary:2102,secondary:[1044]},weight:100}:void 0,menuOpts:[{menuId:M.MenubarEditMenu,group:"2_ccp",title:p({key:"miCut",comment:["&& denotes a mnemonic"]},"Cu&&t"),order:1},{menuId:M.EditorContext,group:og,title:p("actions.clipboard.cutLabel","Cut"),when:I.writable,order:1},{menuId:M.CommandPalette,group:"",title:p("actions.clipboard.cutLabel","Cut"),order:1},{menuId:M.SimpleEditorContext,group:og,title:p("actions.clipboard.cutLabel","Cut"),when:I.writable,order:1}]})):void 0,c0e=lZ?HF(new bm({id:"editor.action.clipboardCopyAction",precondition:void 0,kbOpts:Ia?{primary:2081,win:{primary:2081,secondary:[2067]},weight:100}:void 0,menuOpts:[{menuId:M.MenubarEditMenu,group:"2_ccp",title:p({key:"miCopy",comment:["&& denotes a mnemonic"]},"&&Copy"),order:2},{menuId:M.EditorContext,group:og,title:p("actions.clipboard.copyLabel","Copy"),order:2},{menuId:M.CommandPalette,group:"",title:p("actions.clipboard.copyLabel","Copy"),order:1},{menuId:M.SimpleEditorContext,group:og,title:p("actions.clipboard.copyLabel","Copy"),order:2}]})):void 0;hn.appendMenuItem(M.MenubarEditMenu,{submenu:M.MenubarCopy,title:Re("copy as","Copy As"),group:"2_ccp",order:3});hn.appendMenuItem(M.EditorContext,{submenu:M.EditorContextCopy,title:Re("copy as","Copy As"),group:og,order:3});hn.appendMenuItem(M.EditorContext,{submenu:M.EditorContextShare,title:Re("share","Share"),group:"11_share",order:-1,when:q.and(q.notEquals("resourceScheme","output"),I.editorTextFocus)});hn.appendMenuItem(M.ExplorerContext,{submenu:M.ExplorerContextShare,title:Re("share","Share"),group:"11_share",order:-1});const rI=a0e?HF(new bm({id:"editor.action.clipboardPasteAction",precondition:void 0,kbOpts:Ia?{primary:2100,win:{primary:2100,secondary:[1043]},linux:{primary:2100,secondary:[1043]},weight:100}:void 0,menuOpts:[{menuId:M.MenubarEditMenu,group:"2_ccp",title:p({key:"miPaste",comment:["&& denotes a mnemonic"]},"&&Paste"),order:4},{menuId:M.EditorContext,group:og,title:p("actions.clipboard.pasteLabel","Paste"),when:I.writable,order:4},{menuId:M.CommandPalette,group:"",title:p("actions.clipboard.pasteLabel","Paste"),order:1},{menuId:M.SimpleEditorContext,group:og,title:p("actions.clipboard.pasteLabel","Paste"),when:I.writable,order:4}]})):void 0;class d0e extends ge{constructor(){super({id:"editor.action.clipboardCopyWithSyntaxHighlightingAction",label:p("actions.clipboard.copyWithSyntaxHighlightingLabel","Copy With Syntax Highlighting"),alias:"Copy With Syntax Highlighting",precondition:void 0,kbOpts:{kbExpr:I.textInputFocus,primary:0,weight:100}})}run(e,t){!t.hasModel()||!t.getOption(37)&&t.getSelection().isEmpty()||(mR.forceCopyWithSyntaxHighlighting=!0,t.focus(),t.getContainerDomNode().ownerDocument.execCommand("copy"),mR.forceCopyWithSyntaxHighlighting=!1)}}function cZ(s,e){s&&(s.addImplementation(1e4,"code-editor",(t,i)=>{const n=t.get(ft).getFocusedCodeEditor();if(n&&n.hasTextFocus()){const o=n.getOption(37),r=n.getSelection();return r&&r.isEmpty()&&!o||n.getContainerDomNode().ownerDocument.execCommand(e),!0}return!1}),s.addImplementation(0,"generic-dom",(t,i)=>(mm().execCommand(e),!0)))}cZ(l0e,"cut");cZ(c0e,"copy");rI&&(rI.addImplementation(1e4,"code-editor",(s,e)=>{const t=s.get(ft),i=s.get(Jc),n=t.getFocusedCodeEditor();return n&&n.hasTextFocus()?n.getContainerDomNode().ownerDocument.execCommand("paste")?jc.get(n)?.finishedPaste()??Promise.resolve():gg?(async()=>{const r=await i.readText();if(r!==""){const a=Ev.INSTANCE.get(r);let l=!1,c=null,d=null;a&&(l=n.getOption(37)&&!!a.isFromEmptySelection,c=typeof a.multicursorText<"u"?a.multicursorText:null,d=a.mode),n.trigger("keyboard","paste",{text:r,pasteOnNewLine:l,multicursorText:c,mode:d})}})():!0:!1}),rI.addImplementation(0,"generic-dom",(s,e)=>(mm().execCommand("paste"),!0)));lZ&&Q(d0e);const Yt=new class{constructor(){this.QuickFix=new Ot("quickfix"),this.Refactor=new Ot("refactor"),this.RefactorExtract=this.Refactor.append("extract"),this.RefactorInline=this.Refactor.append("inline"),this.RefactorMove=this.Refactor.append("move"),this.RefactorRewrite=this.Refactor.append("rewrite"),this.Notebook=new Ot("notebook"),this.Source=new Ot("source"),this.SourceOrganizeImports=this.Source.append("organizeImports"),this.SourceFixAll=this.Source.append("fixAll"),this.SurroundWith=this.Refactor.append("surround")}};var _o;(function(s){s.Refactor="refactor",s.RefactorPreview="refactor preview",s.Lightbulb="lightbulb",s.Default="other (default)",s.SourceAction="source action",s.QuickFix="quick fix action",s.FixAll="fix all",s.OrganizeImports="organize imports",s.AutoFix="auto fix",s.QuickFixHover="quick fix hover window",s.OnSave="save participants",s.ProblemsView="problems view"})(_o||(_o={}));function h0e(s,e){return!(s.include&&!s.include.intersects(e)||s.excludes&&s.excludes.some(t=>dZ(e,t,s.include))||!s.includeSourceActions&&Yt.Source.contains(e))}function u0e(s,e){const t=e.kind?new Ot(e.kind):void 0;return!(s.include&&(!t||!s.include.contains(t))||s.excludes&&t&&s.excludes.some(i=>dZ(t,i,s.include))||!s.includeSourceActions&&t&&Yt.Source.contains(t)||s.onlyIncludePreferredActions&&!e.isPreferred)}function dZ(s,e,t){return!(!e.contains(s)||t&&e.contains(t))}class Cl{static fromUser(e,t){return!e||typeof e!="object"?new Cl(t.kind,t.apply,!1):new Cl(Cl.getKindFromUser(e,t.kind),Cl.getApplyFromUser(e,t.apply),Cl.getPreferredUser(e))}static getApplyFromUser(e,t){switch(typeof e.apply=="string"?e.apply.toLowerCase():""){case"first":return"first";case"never":return"never";case"ifsingle":return"ifSingle";default:return t}}static getKindFromUser(e,t){return typeof e.kind=="string"?new Ot(e.kind):t}static getPreferredUser(e){return typeof e.preferred=="boolean"?e.preferred:!1}constructor(e,t,i){this.kind=e,this.apply=t,this.preferred=i}}class g0e{constructor(e,t,i){this.action=e,this.provider=t,this.highlightRange=i}async resolve(e){if(this.provider?.resolveCodeAction&&!this.action.edit){let t;try{t=await this.provider.resolveCodeAction(this.action,e)}catch(i){Li(i)}t&&(this.action.edit=t.edit)}return this}}const hZ="editor.action.codeAction",VF="editor.action.quickFix",uZ="editor.action.autoFix",gZ="editor.action.refactor",fZ="editor.action.sourceAction",iM="editor.action.organizeImports",nM="editor.action.fixAll";class yb extends B{static codeActionsPreferredComparator(e,t){return e.isPreferred&&!t.isPreferred?-1:!e.isPreferred&&t.isPreferred?1:0}static codeActionsComparator({action:e},{action:t}){return e.isAI&&!t.isAI?1:!e.isAI&&t.isAI?-1:os(e.diagnostics)?os(t.diagnostics)?yb.codeActionsPreferredComparator(e,t):-1:os(t.diagnostics)?1:yb.codeActionsPreferredComparator(e,t)}constructor(e,t,i){super(),this.documentation=t,this._register(i),this.allActions=[...e].sort(yb.codeActionsComparator),this.validActions=this.allActions.filter(({action:n})=>!n.disabled)}get hasAutoFix(){return this.validActions.some(({action:e})=>!!e.kind&&Yt.QuickFix.contains(new Ot(e.kind))&&!!e.isPreferred)}get hasAIFix(){return this.validActions.some(({action:e})=>!!e.isAI)}get allAIFixes(){return this.validActions.every(({action:e})=>!!e.isAI)}}const c7={actions:[],documentation:void 0};async function Ff(s,e,t,i,n,o){const r=i.filter||{},a={...r,excludes:[...r.excludes||[],Yt.Notebook]},l={only:r.include?.value,trigger:i.type},c=new IF(e,o),d=i.type===2,h=f0e(s,e,d?a:r),u=new Z,g=h.map(async m=>{try{n.report(m);const _=await m.provideCodeActions(e,t,l,c.token);if(_&&u.add(_),c.token.isCancellationRequested)return c7;const b=(_?.actions||[]).filter(C=>C&&u0e(r,C)),v=m0e(m,b,r.include);return{actions:b.map(C=>new g0e(C,m)),documentation:v}}catch(_){if(xr(_))throw _;return Li(_),c7}}),f=s.onDidChange(()=>{const m=s.all(e);ii(m,h)||c.cancel()});try{const m=await Promise.all(g),_=m.map(v=>v.actions).flat(),b=[...Yr(m.map(v=>v.documentation)),...p0e(s,e,i,_)];return new yb(_,b,u)}finally{f.dispose(),c.dispose()}}function f0e(s,e,t){return s.all(e).filter(i=>i.providedCodeActionKinds?i.providedCodeActionKinds.some(n=>h0e(t,new Ot(n))):!0)}function*p0e(s,e,t,i){if(e&&i.length)for(const n of s.all(e))n._getAdditionalMenuItems&&(yield*n._getAdditionalMenuItems?.({trigger:t.type,only:t.filter?.include?.value},i.map(o=>o.action)))}function m0e(s,e,t){if(!s.documentation)return;const i=s.documentation.map(n=>({kind:new Ot(n.kind),command:n.command}));if(t){let n;for(const o of i)o.kind.contains(t)&&(n?n.kind.contains(o.kind)&&(n=o):n=o);if(n)return n?.command}for(const n of e)if(n.kind){for(const o of i)if(o.kind.contains(new Ot(n.kind)))return o.command}}var Su;(function(s){s.OnSave="onSave",s.FromProblemsView="fromProblemsView",s.FromCodeActions="fromCodeActions",s.FromAILightbulb="fromAILightbulb"})(Su||(Su={}));async function _0e(s,e,t,i,n=Ue.None){const o=s.get(EC),r=s.get(Ht),a=s.get(jn),l=s.get(Ii);if(a.publicLog2("codeAction.applyCodeAction",{codeActionTitle:e.action.title,codeActionKind:e.action.kind,codeActionIsPreferred:!!e.action.isPreferred,reason:t}),await e.resolve(n),!n.isCancellationRequested&&!(e.action.edit?.edits.length&&!(await o.apply(e.action.edit,{editor:i?.editor,label:e.action.title,quotableLabel:e.action.title,code:"undoredo.codeAction",respectAutoSaveConfig:t!==Su.OnSave,showPreview:i?.preview})).isApplied)&&e.action.command)try{await r.executeCommand(e.action.command.id,...e.action.command.arguments||[])}catch(c){const d=b0e(c);l.error(typeof d=="string"?d:p("applyCodeActionFailed","An unknown error occurred while applying the code action"))}}function b0e(s){return typeof s=="string"?s:s instanceof Error&&typeof s.message=="string"?s.message:void 0}ot.registerCommand("_executeCodeActionProvider",async function(s,e,t,i,n){if(!(e instanceof Se))throw mr();const{codeActionProvider:o}=s.get(pe),r=s.get(Zt).getModel(e);if(!r)throw mr();const a=me.isISelection(t)?me.liftSelection(t):k.isIRange(t)?r.validateRange(t):void 0;if(!a)throw mr();const l=typeof i=="string"?new Ot(i):void 0,c=await Ff(o,r,a,{type:1,triggerAction:_o.Default,filter:{includeSourceActions:!0,include:l}},Sc.None,Ue.None),d=[],h=Math.min(c.validActions.length,typeof n=="number"?n:0);for(let u=0;u<h;u++)d.push(c.validActions[u].resolve(Ue.None));try{return await Promise.all(d),c.validActions.map(u=>u.action)}finally{setTimeout(()=>c.dispose(),100)}});var v0e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},C0e=function(s,e){return function(t,i){e(t,i,s)}},sM;let oM=class{static{sM=this}static{this.codeActionCommands=[gZ,hZ,fZ,iM,nM]}constructor(e){this.keybindingService=e}getResolver(){const e=new Fa(()=>this.keybindingService.getKeybindings().filter(t=>sM.codeActionCommands.indexOf(t.command)>=0).filter(t=>t.resolvedKeybinding).map(t=>{let i=t.commandArgs;return t.command===iM?i={kind:Yt.SourceOrganizeImports.value}:t.command===nM&&(i={kind:Yt.SourceFixAll.value}),{resolvedKeybinding:t.resolvedKeybinding,...Cl.fromUser(i,{kind:Ot.None,apply:"never"})}}));return t=>{if(t.kind)return this.bestKeybindingForCodeAction(t,e.value)?.resolvedKeybinding}}bestKeybindingForCodeAction(e,t){if(!e.kind)return;const i=new Ot(e.kind);return t.filter(n=>n.kind.contains(i)).filter(n=>n.preferred?e.isPreferred:!0).reduceRight((n,o)=>n?n.kind.contains(o.kind)?o:n:o,void 0)}};oM=sM=v0e([C0e(0,yt)],oM);E("symbolIcon.arrayForeground",Ge,p("symbolIcon.arrayForeground","The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.booleanForeground",Ge,p("symbolIcon.booleanForeground","The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.classForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},p("symbolIcon.classForeground","The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.colorForeground",Ge,p("symbolIcon.colorForeground","The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.constantForeground",Ge,p("symbolIcon.constantForeground","The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.constructorForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},p("symbolIcon.constructorForeground","The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.enumeratorForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},p("symbolIcon.enumeratorForeground","The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.enumeratorMemberForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},p("symbolIcon.enumeratorMemberForeground","The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.eventForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},p("symbolIcon.eventForeground","The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.fieldForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},p("symbolIcon.fieldForeground","The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.fileForeground",Ge,p("symbolIcon.fileForeground","The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.folderForeground",Ge,p("symbolIcon.folderForeground","The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.functionForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},p("symbolIcon.functionForeground","The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.interfaceForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},p("symbolIcon.interfaceForeground","The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.keyForeground",Ge,p("symbolIcon.keyForeground","The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.keywordForeground",Ge,p("symbolIcon.keywordForeground","The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.methodForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},p("symbolIcon.methodForeground","The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.moduleForeground",Ge,p("symbolIcon.moduleForeground","The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.namespaceForeground",Ge,p("symbolIcon.namespaceForeground","The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.nullForeground",Ge,p("symbolIcon.nullForeground","The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.numberForeground",Ge,p("symbolIcon.numberForeground","The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.objectForeground",Ge,p("symbolIcon.objectForeground","The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.operatorForeground",Ge,p("symbolIcon.operatorForeground","The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.packageForeground",Ge,p("symbolIcon.packageForeground","The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.propertyForeground",Ge,p("symbolIcon.propertyForeground","The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.referenceForeground",Ge,p("symbolIcon.referenceForeground","The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.snippetForeground",Ge,p("symbolIcon.snippetForeground","The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.stringForeground",Ge,p("symbolIcon.stringForeground","The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.structForeground",Ge,p("symbolIcon.structForeground","The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.textForeground",Ge,p("symbolIcon.textForeground","The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.typeParameterForeground",Ge,p("symbolIcon.typeParameterForeground","The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.unitForeground",Ge,p("symbolIcon.unitForeground","The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.variableForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},p("symbolIcon.variableForeground","The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));const pZ=Object.freeze({kind:Ot.Empty,title:p("codeAction.widget.id.more","More Actions...")}),y0e=Object.freeze([{kind:Yt.QuickFix,title:p("codeAction.widget.id.quickfix","Quick Fix")},{kind:Yt.RefactorExtract,title:p("codeAction.widget.id.extract","Extract"),icon:J.wrench},{kind:Yt.RefactorInline,title:p("codeAction.widget.id.inline","Inline"),icon:J.wrench},{kind:Yt.RefactorRewrite,title:p("codeAction.widget.id.convert","Rewrite"),icon:J.wrench},{kind:Yt.RefactorMove,title:p("codeAction.widget.id.move","Move"),icon:J.wrench},{kind:Yt.SurroundWith,title:p("codeAction.widget.id.surround","Surround With"),icon:J.surroundWith},{kind:Yt.Source,title:p("codeAction.widget.id.source","Source Action"),icon:J.symbolFile},pZ]);function w0e(s,e,t){if(!e)return s.map(o=>({kind:"action",item:o,group:pZ,disabled:!!o.action.disabled,label:o.action.disabled||o.action.title,canPreview:!!o.action.edit?.edits.length}));const i=y0e.map(o=>({group:o,actions:[]}));for(const o of s){const r=o.action.kind?new Ot(o.action.kind):Ot.None;for(const a of i)if(a.group.kind.contains(r)){a.actions.push(o);break}}const n=[];for(const o of i)if(o.actions.length){n.push({kind:"header",group:o.group});for(const r of o.actions){const a=o.group;n.push({kind:"action",item:r,group:r.action.isAI?{title:a.title,kind:a.kind,icon:J.sparkle}:a,label:r.action.title,disabled:!!r.action.disabled,keybinding:t(r.action)})}}return n}var S0e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},L0e=function(s,e){return function(t,i){e(t,i,s)}},hf;const d7=Kt("gutter-lightbulb",J.lightBulb,p("gutterLightbulbWidget","Icon which spawns code actions menu from the gutter when there is no space in the editor.")),h7=Kt("gutter-lightbulb-auto-fix",J.lightbulbAutofix,p("gutterLightbulbAutoFixWidget","Icon which spawns code actions menu from the gutter when there is no space in the editor and a quick fix is available.")),u7=Kt("gutter-lightbulb-sparkle",J.lightbulbSparkle,p("gutterLightbulbAIFixWidget","Icon which spawns code actions menu from the gutter when there is no space in the editor and an AI fix is available.")),g7=Kt("gutter-lightbulb-aifix-auto-fix",J.lightbulbSparkleAutofix,p("gutterLightbulbAIFixAutoFixWidget","Icon which spawns code actions menu from the gutter when there is no space in the editor and an AI fix and a quick fix is available.")),f7=Kt("gutter-lightbulb-sparkle-filled",J.sparkleFilled,p("gutterLightbulbSparkleFilledWidget","Icon which spawns code actions menu from the gutter when there is no space in the editor and an AI fix and a quick fix is available."));var ma;(function(s){s.Hidden={type:0};class e{constructor(i,n,o,r){this.actions=i,this.trigger=n,this.editorPosition=o,this.widgetPosition=r,this.type=1}}s.Showing=e})(ma||(ma={}));let Uv=class extends B{static{hf=this}static{this.GUTTER_DECORATION=We.register({description:"codicon-gutter-lightbulb-decoration",glyphMarginClassName:Ie.asClassName(J.lightBulb),glyphMargin:{position:Jr.Left},stickiness:1})}static{this.ID="editor.contrib.lightbulbWidget"}static{this._posPref=[0]}constructor(e,t){super(),this._editor=e,this._keybindingService=t,this._onClick=this._register(new O),this.onClick=this._onClick.event,this._state=ma.Hidden,this._gutterState=ma.Hidden,this._iconClasses=[],this.lightbulbClasses=["codicon-"+d7.id,"codicon-"+g7.id,"codicon-"+h7.id,"codicon-"+u7.id,"codicon-"+f7.id],this.gutterDecoration=hf.GUTTER_DECORATION,this._domNode=te("div.lightBulbWidget"),this._domNode.role="listbox",this._register(ti.ignoreTarget(this._domNode)),this._editor.addContentWidget(this),this._register(this._editor.onDidChangeModelContent(i=>{const n=this._editor.getModel();(this.state.type!==1||!n||this.state.editorPosition.lineNumber>=n.getLineCount())&&this.hide(),(this.gutterState.type!==1||!n||this.gutterState.editorPosition.lineNumber>=n.getLineCount())&&this.gutterHide()})),this._register(kte(this._domNode,i=>{if(this.state.type!==1)return;this._editor.focus(),i.preventDefault();const{top:n,height:o}=Si(this._domNode),r=this._editor.getOption(67);let a=Math.floor(r/3);this.state.widgetPosition.position!==null&&this.state.widgetPosition.position.lineNumber<this.state.editorPosition.lineNumber&&(a+=r),this._onClick.fire({x:i.posx,y:n+o+a,actions:this.state.actions,trigger:this.state.trigger})})),this._register(U(this._domNode,"mouseenter",i=>{(i.buttons&1)===1&&this.hide()})),this._register(se.runAndSubscribe(this._keybindingService.onDidUpdateKeybindings,()=>{this._preferredKbLabel=this._keybindingService.lookupKeybinding(uZ)?.getLabel()??void 0,this._quickFixKbLabel=this._keybindingService.lookupKeybinding(VF)?.getLabel()??void 0,this._updateLightBulbTitleAndIcon()})),this._register(this._editor.onMouseDown(async i=>{if(!i.target.element||!this.lightbulbClasses.some(l=>i.target.element&&i.target.element.classList.contains(l))||this.gutterState.type!==1)return;this._editor.focus();const{top:n,height:o}=Si(i.target.element),r=this._editor.getOption(67);let a=Math.floor(r/3);this.gutterState.widgetPosition.position!==null&&this.gutterState.widgetPosition.position.lineNumber<this.gutterState.editorPosition.lineNumber&&(a+=r),this._onClick.fire({x:i.event.posx,y:n+o+a,actions:this.gutterState.actions,trigger:this.gutterState.trigger})}))}dispose(){super.dispose(),this._editor.removeContentWidget(this),this._gutterDecorationID&&this._removeGutterDecoration(this._gutterDecorationID)}getId(){return"LightBulbWidget"}getDomNode(){return this._domNode}getPosition(){return this._state.type===1?this._state.widgetPosition:null}update(e,t,i){if(e.validActions.length<=0)return this.gutterHide(),this.hide();if(!this._editor.hasTextFocus())return this.gutterHide(),this.hide();if(!this._editor.getOptions().get(65).enabled)return this.gutterHide(),this.hide();const r=this._editor.getModel();if(!r)return this.gutterHide(),this.hide();const{lineNumber:a,column:l}=r.validatePosition(i),c=r.getOptions().tabSize,d=this._editor.getOptions().get(50),h=r.getLineContent(a),u=hx(h,c),g=d.spaceWidth*u>22,f=w=>w>2&&this._editor.getTopForLineNumber(w)===this._editor.getTopForLineNumber(w-1),m=this._editor.getLineDecorations(a);let _=!1;if(m)for(const w of m){const x=w.options.glyphMarginClassName;if(x&&!this.lightbulbClasses.some(L=>x.includes(L))){_=!0;break}}let b=a,v=1;if(!g){const w=x=>{const L=r.getLineContent(x);return/^\s*$|^\s+/.test(L)||L.length<=v};if(a>1&&!f(a-1)){const x=r.getLineCount(),L=a===x,D=a>1&&w(a-1),T=!L&&w(a+1),F=w(a),W=!T&&!D;if(!T&&!D&&!_)return this.gutterState=new ma.Showing(e,t,i,{position:{lineNumber:b,column:v},preference:hf._posPref}),this.renderGutterLightbub(),this.hide();D||L||D&&!F?b-=1:(T||W&&F)&&(b+=1)}else if(a===1&&(a===r.getLineCount()||!w(a+1)&&!w(a)))if(this.gutterState=new ma.Showing(e,t,i,{position:{lineNumber:b,column:v},preference:hf._posPref}),_)this.gutterHide();else return this.renderGutterLightbub(),this.hide();else if(a<r.getLineCount()&&!f(a+1))b+=1;else if(l*d.spaceWidth<22)return this.hide();v=/^\S\s*$/.test(r.getLineContent(b))?2:1}this.state=new ma.Showing(e,t,i,{position:{lineNumber:b,column:v},preference:hf._posPref}),this._gutterDecorationID&&(this._removeGutterDecoration(this._gutterDecorationID),this.gutterHide());const C=e.validActions,y=e.validActions[0].action.kind;if(C.length!==1||!y){this._editor.layoutContentWidget(this);return}this._editor.layoutContentWidget(this)}hide(){this.state!==ma.Hidden&&(this.state=ma.Hidden,this._editor.layoutContentWidget(this))}gutterHide(){this.gutterState!==ma.Hidden&&(this._gutterDecorationID&&this._removeGutterDecoration(this._gutterDecorationID),this.gutterState=ma.Hidden)}get state(){return this._state}set state(e){this._state=e,this._updateLightBulbTitleAndIcon()}get gutterState(){return this._gutterState}set gutterState(e){this._gutterState=e,this._updateGutterLightBulbTitleAndIcon()}_updateLightBulbTitleAndIcon(){if(this._domNode.classList.remove(...this._iconClasses),this._iconClasses=[],this.state.type!==1)return;let e,t=!1;this.state.actions.allAIFixes?(e=J.sparkleFilled,this.state.actions.validActions.length===1&&(t=!0)):this.state.actions.hasAutoFix?this.state.actions.hasAIFix?e=J.lightbulbSparkleAutofix:e=J.lightbulbAutofix:this.state.actions.hasAIFix?e=J.lightbulbSparkle:e=J.lightBulb,this._updateLightbulbTitle(this.state.actions.hasAutoFix,t),this._iconClasses=Ie.asClassNameArray(e),this._domNode.classList.add(...this._iconClasses)}_updateGutterLightBulbTitleAndIcon(){if(this.gutterState.type!==1)return;let e,t=!1;this.gutterState.actions.allAIFixes?(e=f7,this.gutterState.actions.validActions.length===1&&(t=!0)):this.gutterState.actions.hasAutoFix?this.gutterState.actions.hasAIFix?e=g7:e=h7:this.gutterState.actions.hasAIFix?e=u7:e=d7,this._updateLightbulbTitle(this.gutterState.actions.hasAutoFix,t);const i=We.register({description:"codicon-gutter-lightbulb-decoration",glyphMarginClassName:Ie.asClassName(e),glyphMargin:{position:Jr.Left},stickiness:1});this.gutterDecoration=i}renderGutterLightbub(){const e=this._editor.getSelection();e&&(this._gutterDecorationID===void 0?this._addGutterDecoration(e.startLineNumber):this._updateGutterDecoration(this._gutterDecorationID,e.startLineNumber))}_addGutterDecoration(e){this._editor.changeDecorations(t=>{this._gutterDecorationID=t.addDecoration(new k(e,0,e,0),this.gutterDecoration)})}_removeGutterDecoration(e){this._editor.changeDecorations(t=>{t.removeDecoration(e),this._gutterDecorationID=void 0})}_updateGutterDecoration(e,t){this._editor.changeDecorations(i=>{i.changeDecoration(e,new k(t,0,t,0)),i.changeDecorationOptions(e,this.gutterDecoration)})}_updateLightbulbTitle(e,t){this.state.type===1&&(t?this.title=p("codeActionAutoRun","Run: {0}",this.state.actions.validActions[0].action.title):e&&this._preferredKbLabel?this.title=p("preferredcodeActionWithKb","Show Code Actions. Preferred Quick Fix Available ({0})",this._preferredKbLabel):!e&&this._quickFixKbLabel?this.title=p("codeActionWithKb","Show Code Actions ({0})",this._quickFixKbLabel):e||(this.title=p("codeAction","Show Code Actions")))}set title(e){this._domNode.title=e}};Uv=hf=S0e([L0e(1,yt)],Uv);var mZ=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},rM=function(s,e){return function(t,i){e(t,i,s)}};const _Z="acceptSelectedCodeAction",bZ="previewSelectedCodeAction";class x0e{get templateId(){return"header"}renderTemplate(e){e.classList.add("group-header");const t=document.createElement("span");return e.append(t),{container:e,text:t}}renderElement(e,t,i){i.text.textContent=e.group?.title??""}disposeTemplate(e){}}let aM=class{get templateId(){return"action"}constructor(e,t){this._supportsPreview=e,this._keybindingService=t}renderTemplate(e){e.classList.add(this.templateId);const t=document.createElement("div");t.className="icon",e.append(t);const i=document.createElement("span");i.className="title",e.append(i);const n=new Em(e,lo);return{container:e,icon:t,text:i,keybinding:n}}renderElement(e,t,i){if(e.group?.icon?(i.icon.className=Ie.asClassName(e.group.icon),e.group.icon.color&&(i.icon.style.color=he(e.group.icon.color.id))):(i.icon.className=Ie.asClassName(J.lightBulb),i.icon.style.color="var(--vscode-editorLightBulb-foreground)"),!e.item||!e.label)return;i.text.textContent=vZ(e.label),i.keybinding.set(e.keybinding),Vte(!!e.keybinding,i.keybinding.element);const n=this._keybindingService.lookupKeybinding(_Z)?.getLabel(),o=this._keybindingService.lookupKeybinding(bZ)?.getLabel();i.container.classList.toggle("option-disabled",e.disabled),e.disabled?i.container.title=e.label:n&&o?this._supportsPreview&&e.canPreview?i.container.title=p({key:"label-preview",comment:['placeholders are keybindings, e.g "F2 to Apply, Shift+F2 to Preview"']},"{0} to Apply, {1} to Preview",n,o):i.container.title=p({key:"label",comment:['placeholder is a keybinding, e.g "F2 to Apply"']},"{0} to Apply",n):i.container.title=""}disposeTemplate(e){e.keybinding.dispose()}};aM=mZ([rM(1,yt)],aM);class k0e extends UIEvent{constructor(){super("acceptSelectedAction")}}class p7 extends UIEvent{constructor(){super("previewSelectedAction")}}function D0e(s){if(s.kind==="action")return s.label}let lM=class extends B{constructor(e,t,i,n,o,r){super(),this._delegate=n,this._contextViewService=o,this._keybindingService=r,this._actionLineHeight=24,this._headerLineHeight=26,this.cts=this._register(new li),this.domNode=document.createElement("div"),this.domNode.classList.add("actionList");const a={getHeight:l=>l.kind==="header"?this._headerLineHeight:this._actionLineHeight,getTemplateId:l=>l.kind};this._list=this._register(new Xo(e,this.domNode,a,[new aM(t,this._keybindingService),new x0e],{keyboardSupport:!1,typeNavigationEnabled:!0,keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:D0e},accessibilityProvider:{getAriaLabel:l=>{if(l.kind==="action"){let c=l.label?vZ(l?.label):"";return l.disabled&&(c=p({key:"customQuickFixWidget.labels",comment:["Action widget labels for accessibility."]},"{0}, Disabled Reason: {1}",c,l.disabled)),c}return null},getWidgetAriaLabel:()=>p({key:"customQuickFixWidget",comment:["An action widget option"]},"Action Widget"),getRole:l=>l.kind==="action"?"option":"separator",getWidgetRole:()=>"listbox"}})),this._list.style(bg),this._register(this._list.onMouseClick(l=>this.onListClick(l))),this._register(this._list.onMouseOver(l=>this.onListHover(l))),this._register(this._list.onDidChangeFocus(()=>this.onFocus())),this._register(this._list.onDidChangeSelection(l=>this.onListSelection(l))),this._allMenuItems=i,this._list.splice(0,this._list.length,this._allMenuItems),this._list.length&&this.focusNext()}focusCondition(e){return!e.disabled&&e.kind==="action"}hide(e){this._delegate.onHide(e),this.cts.cancel(),this._contextViewService.hideContextView()}layout(e){const t=this._allMenuItems.filter(l=>l.kind==="header").length,n=this._allMenuItems.length*this._actionLineHeight+t*this._headerLineHeight-t*this._actionLineHeight;this._list.layout(n);let o=e;if(this._allMenuItems.length>=50)o=380;else{const l=this._allMenuItems.map((c,d)=>{const h=this.domNode.ownerDocument.getElementById(this._list.getElementID(d));if(h){h.style.width="auto";const u=h.getBoundingClientRect().width;return h.style.width="",u}return 0});o=Math.max(...l,e)}const a=Math.min(n,this.domNode.ownerDocument.body.clientHeight*.7);return this._list.layout(a,o),this.domNode.style.height=`${a}px`,this._list.domFocus(),o}focusPrevious(){this._list.focusPrevious(1,!0,void 0,this.focusCondition)}focusNext(){this._list.focusNext(1,!0,void 0,this.focusCondition)}acceptSelected(e){const t=this._list.getFocus();if(t.length===0)return;const i=t[0],n=this._list.element(i);if(!this.focusCondition(n))return;const o=e?new p7:new k0e;this._list.setSelection([i],o)}onListSelection(e){if(!e.elements.length)return;const t=e.elements[0];t.item&&this.focusCondition(t)?this._delegate.onSelect(t.item,e.browserEvent instanceof p7):this._list.setSelection([])}onFocus(){const e=this._list.getFocus();if(e.length===0)return;const t=e[0],i=this._list.element(t);this._delegate.onFocus?.(i.item)}async onListHover(e){const t=e.element;if(t&&t.item&&this.focusCondition(t)){if(this._delegate.onHover&&!t.disabled&&t.kind==="action"){const i=await this._delegate.onHover(t.item,this.cts.token);t.canPreview=i?i.canPreview:void 0}e.index&&this._list.splice(e.index,1,[t])}this._list.setFocus(typeof e.index=="number"?[e.index]:[])}onListClick(e){e.element&&this.focusCondition(e.element)&&this._list.setFocus([])}};lM=mZ([rM(4,Yc),rM(5,yt)],lM);function vZ(s){return s.replace(/\r\n|\r|\n/g," ")}var I0e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},aI=function(s,e){return function(t,i){e(t,i,s)}};E("actionBar.toggledBackground",kC,p("actionBar.toggledBackground","Background color for toggled action items in action bar."));const rg={Visible:new le("codeActionMenuVisible",!1,p("codeActionMenuVisible","Whether the action widget list is visible"))},xg=Je("actionWidgetService");let ag=class extends B{get isVisible(){return rg.Visible.getValue(this._contextKeyService)||!1}constructor(e,t,i){super(),this._contextViewService=e,this._contextKeyService=t,this._instantiationService=i,this._list=this._register(new nn)}show(e,t,i,n,o,r,a){const l=rg.Visible.bindTo(this._contextKeyService),c=this._instantiationService.createInstance(lM,e,t,i,n);this._contextViewService.showContextView({getAnchor:()=>o,render:d=>(l.set(!0),this._renderWidget(d,c,a??[])),onHide:d=>{l.reset(),this._onWidgetClosed(d)}},r,!1)}acceptSelected(e){this._list.value?.acceptSelected(e)}focusPrevious(){this._list?.value?.focusPrevious()}focusNext(){this._list?.value?.focusNext()}hide(e){this._list.value?.hide(e),this._list.clear()}_renderWidget(e,t,i){const n=document.createElement("div");if(n.classList.add("action-widget"),e.appendChild(n),this._list.value=t,this._list.value)n.appendChild(this._list.value.domNode);else throw new Error("List has no value");const o=new Z,r=document.createElement("div"),a=e.appendChild(r);a.classList.add("context-view-block"),o.add(U(a,ee.MOUSE_DOWN,g=>g.stopPropagation()));const l=document.createElement("div"),c=e.appendChild(l);c.classList.add("context-view-pointerBlock"),o.add(U(c,ee.POINTER_MOVE,()=>c.remove())),o.add(U(c,ee.MOUSE_DOWN,()=>c.remove()));let d=0;if(i.length){const g=this._createActionBar(".action-widget-action-bar",i);g&&(n.appendChild(g.getContainer().parentElement),o.add(g),d=g.getContainer().offsetWidth)}const h=this._list.value?.layout(d);n.style.width=`${h}px`;const u=o.add(Wa(e));return o.add(u.onDidBlur(()=>this.hide(!0))),o}_createActionBar(e,t){if(!t.length)return;const i=te(e),n=new zo(i);return n.push(t,{icon:!1,label:!0}),n}_onWidgetClosed(e){this._list.value?.hide(e)}};ag=I0e([aI(0,Yc),aI(1,Ee),aI(2,ye)],ag);nt(xg,ag,1);const YC=1100;Bt(class extends ks{constructor(){super({id:"hideCodeActionWidget",title:Re("hideCodeActionWidget.title","Hide action widget"),precondition:rg.Visible,keybinding:{weight:YC,primary:9,secondary:[1033]}})}run(s){s.get(xg).hide(!0)}});Bt(class extends ks{constructor(){super({id:"selectPrevCodeAction",title:Re("selectPrevCodeAction.title","Select previous action"),precondition:rg.Visible,keybinding:{weight:YC,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}})}run(s){const e=s.get(xg);e instanceof ag&&e.focusPrevious()}});Bt(class extends ks{constructor(){super({id:"selectNextCodeAction",title:Re("selectNextCodeAction.title","Select next action"),precondition:rg.Visible,keybinding:{weight:YC,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}})}run(s){const e=s.get(xg);e instanceof ag&&e.focusNext()}});Bt(class extends ks{constructor(){super({id:_Z,title:Re("acceptSelected.title","Accept selected action"),precondition:rg.Visible,keybinding:{weight:YC,primary:3,secondary:[2137]}})}run(s){const e=s.get(xg);e instanceof ag&&e.acceptSelected()}});Bt(class extends ks{constructor(){super({id:bZ,title:Re("previewSelected.title","Preview selected action"),precondition:rg.Visible,keybinding:{weight:YC,primary:2051}})}run(s){const e=s.get(xg);e instanceof ag&&e.acceptSelected(!0)}});const CZ=new le("supportedCodeAction",""),m7="_typescript.applyFixAllCodeAction";class T0e extends B{constructor(e,t,i,n=250){super(),this._editor=e,this._markerService=t,this._signalChange=i,this._delay=n,this._autoTriggerTimer=this._register(new ia),this._register(this._markerService.onMarkerChanged(o=>this._onMarkerChanges(o))),this._register(this._editor.onDidChangeCursorPosition(()=>this._tryAutoTrigger()))}trigger(e){const t=this._getRangeOfSelectionUnlessWhitespaceEnclosed(e);this._signalChange(t?{trigger:e,selection:t}:void 0)}_onMarkerChanges(e){const t=this._editor.getModel();t&&e.some(i=>dv(i,t.uri))&&this._tryAutoTrigger()}_tryAutoTrigger(){this._autoTriggerTimer.cancelAndSet(()=>{this.trigger({type:2,triggerAction:_o.Default})},this._delay)}_getRangeOfSelectionUnlessWhitespaceEnclosed(e){if(!this._editor.hasModel())return;const t=this._editor.getSelection();if(e.type===1)return t;const i=this._editor.getOption(65).enabled;if(i!==Wr.Off){{if(i===Wr.On)return t;if(i===Wr.OnCode){if(!t.isEmpty())return t;const o=this._editor.getModel(),{lineNumber:r,column:a}=t.getPosition(),l=o.getLineContent(r);if(l.length===0)return;if(a===1){if(/\s/.test(l[0]))return}else if(a===o.getLineMaxColumn(r)){if(/\s/.test(l[l.length-1]))return}else if(/\s/.test(l[a-2])&&/\s/.test(l[a-1]))return}}return t}}}var pu;(function(s){s.Empty={type:0};class e{constructor(i,n,o){this.trigger=i,this.position=n,this._cancellablePromise=o,this.type=1,this.actions=o.catch(r=>{if(xr(r))return yZ;throw r})}cancel(){this._cancellablePromise.cancel()}}s.Triggered=e})(pu||(pu={}));const yZ=Object.freeze({allActions:[],validActions:[],dispose:()=>{},documentation:[],hasAutoFix:!1,hasAIFix:!1,allAIFixes:!1});class E0e extends B{constructor(e,t,i,n,o,r,a){super(),this._editor=e,this._registry=t,this._markerService=i,this._progressService=o,this._configurationService=r,this._telemetryService=a,this._codeActionOracle=this._register(new nn),this._state=pu.Empty,this._onDidChangeState=this._register(new O),this.onDidChangeState=this._onDidChangeState.event,this._disposed=!1,this._supportedCodeActions=CZ.bindTo(n),this._register(this._editor.onDidChangeModel(()=>this._update())),this._register(this._editor.onDidChangeModelLanguage(()=>this._update())),this._register(this._registry.onDidChange(()=>this._update())),this._register(this._editor.onDidChangeConfiguration(l=>{l.hasChanged(65)&&this._update()})),this._update()}dispose(){this._disposed||(this._disposed=!0,super.dispose(),this.setState(pu.Empty,!0))}_settingEnabledNearbyQuickfixes(){const e=this._editor?.getModel();return this._configurationService?this._configurationService.getValue("editor.codeActionWidget.includeNearbyQuickFixes",{resource:e?.uri}):!1}_update(){if(this._disposed)return;this._codeActionOracle.value=void 0,this.setState(pu.Empty);const e=this._editor.getModel();if(e&&this._registry.has(e)&&!this._editor.getOption(92)){const t=this._registry.all(e).flatMap(i=>i.providedCodeActionKinds??[]);this._supportedCodeActions.set(t.join(" ")),this._codeActionOracle.value=new T0e(this._editor,this._markerService,i=>{if(!i){this.setState(pu.Empty);return}const n=i.selection.getStartPosition(),o=en(async l=>{if(this._settingEnabledNearbyQuickfixes()&&i.trigger.type===1&&(i.trigger.triggerAction===_o.QuickFix||i.trigger.filter?.include?.contains(Yt.QuickFix))){const c=await Ff(this._registry,e,i.selection,i.trigger,Sc.None,l),d=[...c.allActions];if(l.isCancellationRequested)return yZ;const h=c.validActions?.some(g=>g.action.kind?Yt.QuickFix.contains(new Ot(g.action.kind)):!1),u=this._markerService.read({resource:e.uri});if(h){for(const g of c.validActions)g.action.command?.arguments?.some(f=>typeof f=="string"&&f.includes(m7))&&(g.action.diagnostics=[...u.filter(f=>f.relatedInformation)]);return{validActions:c.validActions,allActions:d,documentation:c.documentation,hasAutoFix:c.hasAutoFix,hasAIFix:c.hasAIFix,allAIFixes:c.allAIFixes,dispose:()=>{c.dispose()}}}else if(!h&&u.length>0){const g=i.selection.getPosition();let f=g,m=Number.MAX_VALUE;const _=[...c.validActions];for(const v of u){const C=v.endColumn,y=v.endLineNumber,w=v.startLineNumber;if(y===g.lineNumber||w===g.lineNumber){f=new P(y,C);const x={type:i.trigger.type,triggerAction:i.trigger.triggerAction,filter:{include:i.trigger.filter?.include?i.trigger.filter?.include:Yt.QuickFix},autoApply:i.trigger.autoApply,context:{notAvailableMessage:i.trigger.context?.notAvailableMessage||"",position:f}},L=new me(f.lineNumber,f.column,f.lineNumber,f.column),D=await Ff(this._registry,e,L,x,Sc.None,l);if(D.validActions.length!==0){for(const T of D.validActions)T.action.command?.arguments?.some(F=>typeof F=="string"&&F.includes(m7))&&(T.action.diagnostics=[...u.filter(F=>F.relatedInformation)]);c.allActions.length===0&&d.push(...D.allActions),Math.abs(g.column-C)<m?_.unshift(...D.validActions):_.push(...D.validActions)}m=Math.abs(g.column-C)}}const b=_.filter((v,C,y)=>y.findIndex(w=>w.action.title===v.action.title)===C);return b.sort((v,C)=>v.action.isPreferred&&!C.action.isPreferred?-1:!v.action.isPreferred&&C.action.isPreferred||v.action.isAI&&!C.action.isAI?1:!v.action.isAI&&C.action.isAI?-1:0),{validActions:b,allActions:d,documentation:c.documentation,hasAutoFix:c.hasAutoFix,hasAIFix:c.hasAIFix,allAIFixes:c.allAIFixes,dispose:()=>{c.dispose()}}}}if(i.trigger.type===1){const c=new un,d=await Ff(this._registry,e,i.selection,i.trigger,Sc.None,l);return this._telemetryService&&this._telemetryService.publicLog2("codeAction.invokedDurations",{codeActions:d.validActions.length,duration:c.elapsed()}),d}return Ff(this._registry,e,i.selection,i.trigger,Sc.None,l)});i.trigger.type===1&&this._progressService?.showWhile(o,250);const r=new pu.Triggered(i.trigger,n,o);let a=!1;this._state.type===1&&(a=this._state.trigger.type===1&&r.type===1&&r.trigger.type===2&&this._state.position!==r.position),a?setTimeout(()=>{this.setState(r)},500):this.setState(r)},void 0),this._codeActionOracle.value.trigger({type:2,triggerAction:_o.Default})}else this._supportedCodeActions.reset()}trigger(e){this._codeActionOracle.value?.trigger(e)}setState(e,t){e!==this._state&&(this._state.type===1&&this._state.cancel(),this._state=e,!t&&!this._disposed&&this._onDidChangeState.fire(e))}}var N0e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},nl=function(s,e){return function(t,i){e(t,i,s)}},uf;const R0e="quickfix-edit-highlight";let Gp=class extends B{static{uf=this}static{this.ID="editor.contrib.codeActionController"}static get(e){return e.getContribution(uf.ID)}constructor(e,t,i,n,o,r,a,l,c,d,h){super(),this._commandService=a,this._configurationService=l,this._actionWidgetService=c,this._instantiationService=d,this._telemetryService=h,this._activeCodeActions=this._register(new nn),this._showDisabled=!1,this._disposed=!1,this._editor=e,this._model=this._register(new E0e(this._editor,o.codeActionProvider,t,i,r,l,this._telemetryService)),this._register(this._model.onDidChangeState(u=>this.update(u))),this._lightBulbWidget=new Fa(()=>{const u=this._editor.getContribution(Uv.ID);return u&&this._register(u.onClick(g=>this.showCodeActionsFromLightbulb(g.actions,g))),u}),this._resolver=n.createInstance(oM),this._register(this._editor.onDidLayoutChange(()=>this._actionWidgetService.hide()))}dispose(){this._disposed=!0,super.dispose()}async showCodeActionsFromLightbulb(e,t){if(e.allAIFixes&&e.validActions.length===1){const i=e.validActions[0],n=i.action.command;n&&n.id==="inlineChat.start"&&n.arguments&&n.arguments.length>=1&&(n.arguments[0]={...n.arguments[0],autoSend:!1}),await this._applyCodeAction(i,!1,!1,Su.FromAILightbulb);return}await this.showCodeActionList(e,t,{includeDisabledActions:!1,fromLightbulb:!0})}showCodeActions(e,t,i){return this.showCodeActionList(t,i,{includeDisabledActions:!1,fromLightbulb:!1})}manualTriggerAtCurrentPosition(e,t,i,n){if(!this._editor.hasModel())return;go.get(this._editor)?.closeMessage();const o=this._editor.getPosition();this._trigger({type:1,triggerAction:t,filter:i,autoApply:n,context:{notAvailableMessage:e,position:o}})}_trigger(e){return this._model.trigger(e)}async _applyCodeAction(e,t,i,n){try{await this._instantiationService.invokeFunction(_0e,e,n,{preview:i,editor:this._editor})}finally{t&&this._trigger({type:2,triggerAction:_o.QuickFix,filter:{}})}}hideLightBulbWidget(){this._lightBulbWidget.rawValue?.hide(),this._lightBulbWidget.rawValue?.gutterHide()}async update(e){if(e.type!==1){this.hideLightBulbWidget();return}let t;try{t=await e.actions}catch(n){Oe(n);return}if(!(this._disposed||this._editor.getSelection()?.startLineNumber!==e.position.lineNumber))if(this._lightBulbWidget.value?.update(t,e.trigger,e.position),e.trigger.type===1){if(e.trigger.filter?.include){const o=this.tryGetValidActionToApply(e.trigger,t);if(o){try{this.hideLightBulbWidget(),await this._applyCodeAction(o,!1,!1,Su.FromCodeActions)}finally{t.dispose()}return}if(e.trigger.context){const r=this.getInvalidActionThatWouldHaveBeenApplied(e.trigger,t);if(r&&r.action.disabled){go.get(this._editor)?.showMessage(r.action.disabled,e.trigger.context.position),t.dispose();return}}}const n=!!e.trigger.filter?.include;if(e.trigger.context&&(!t.allActions.length||!n&&!t.validActions.length)){go.get(this._editor)?.showMessage(e.trigger.context.notAvailableMessage,e.trigger.context.position),this._activeCodeActions.value=t,t.dispose();return}this._activeCodeActions.value=t,this.showCodeActionList(t,this.toCoords(e.position),{includeDisabledActions:n,fromLightbulb:!1})}else this._actionWidgetService.isVisible?t.dispose():this._activeCodeActions.value=t}getInvalidActionThatWouldHaveBeenApplied(e,t){if(t.allActions.length&&(e.autoApply==="first"&&t.validActions.length===0||e.autoApply==="ifSingle"&&t.allActions.length===1))return t.allActions.find(({action:i})=>i.disabled)}tryGetValidActionToApply(e,t){if(t.validActions.length&&(e.autoApply==="first"&&t.validActions.length>0||e.autoApply==="ifSingle"&&t.validActions.length===1))return t.validActions[0]}static{this.DECORATION=We.register({description:"quickfix-highlight",className:R0e})}async showCodeActionList(e,t,i){const n=this._editor.createDecorationsCollection(),o=this._editor.getDomNode();if(!o)return;const r=i.includeDisabledActions&&(this._showDisabled||e.validActions.length===0)?e.allActions:e.validActions;if(!r.length)return;const a=P.isIPosition(t)?this.toCoords(t):t,l={onSelect:async(c,d)=>{this._applyCodeAction(c,!0,!!d,i.fromLightbulb?Su.FromAILightbulb:Su.FromCodeActions),this._actionWidgetService.hide(!1),n.clear()},onHide:c=>{this._editor?.focus(),n.clear()},onHover:async(c,d)=>{if(d.isCancellationRequested)return;let h=!1;const u=c.action.kind;if(u){const g=new Ot(u);h=[Yt.RefactorExtract,Yt.RefactorInline,Yt.RefactorRewrite,Yt.RefactorMove,Yt.Source].some(m=>m.contains(g))}return{canPreview:h||!!c.action.edit?.edits.length}},onFocus:c=>{if(c&&c.action){const d=c.action.ranges,h=c.action.diagnostics;if(n.clear(),d&&d.length>0){const u=h&&h?.length>1?h.map(g=>({range:g,options:uf.DECORATION})):d.map(g=>({range:g,options:uf.DECORATION}));n.set(u)}else if(h&&h.length>0){const u=h.map(f=>({range:f,options:uf.DECORATION}));n.set(u);const g=h[0];if(g.startLineNumber&&g.startColumn){const f=this._editor.getModel()?.getWordAtPosition({lineNumber:g.startLineNumber,column:g.startColumn})?.word;Nl(p("editingNewSelection","Context: {0} at line {1} and column {2}.",f,g.startLineNumber,g.startColumn))}}}else n.clear()}};this._actionWidgetService.show("codeActionWidget",!0,w0e(r,this._shouldShowHeaders(),this._resolver.getResolver()),l,a,o,this._getActionBarActions(e,t,i))}toCoords(e){if(!this._editor.hasModel())return{x:0,y:0};this._editor.revealPosition(e,1),this._editor.render();const t=this._editor.getScrolledVisiblePosition(e),i=Si(this._editor.getDomNode()),n=i.left+t.left,o=i.top+t.top+t.height;return{x:n,y:o}}_shouldShowHeaders(){const e=this._editor?.getModel();return this._configurationService.getValue("editor.codeActionWidget.showHeaders",{resource:e?.uri})}_getActionBarActions(e,t,i){if(i.fromLightbulb)return[];const n=e.documentation.map(o=>({id:o.id,label:o.title,tooltip:o.tooltip??"",class:void 0,enabled:!0,run:()=>this._commandService.executeCommand(o.id,...o.arguments??[])}));return i.includeDisabledActions&&e.validActions.length>0&&e.allActions.length!==e.validActions.length&&n.push(this._showDisabled?{id:"hideMoreActions",label:p("hideMoreActions","Hide Disabled"),enabled:!0,tooltip:"",class:void 0,run:()=>(this._showDisabled=!1,this.showCodeActionList(e,t,i))}:{id:"showMoreActions",label:p("showMoreActions","Show Disabled"),enabled:!0,tooltip:"",class:void 0,run:()=>(this._showDisabled=!0,this.showCodeActionList(e,t,i))}),n}};Gp=uf=N0e([nl(1,zl),nl(2,Ee),nl(3,ye),nl(4,pe),nl(5,yh),nl(6,Ht),nl(7,Ke),nl(8,xg),nl(9,ye),nl(10,jn)],Gp);kr((s,e)=>{((n,o)=>{o&&e.addRule(`.monaco-editor ${n} { background-color: ${o}; }`)})(".quickfix-edit-highlight",s.getColor(wc));const i=s.getColor(Rd);i&&e.addRule(`.monaco-editor .quickfix-edit-highlight { border: 1px ${Ra(s.type)?"dotted":"solid"} ${i}; box-sizing: border-box; }`)});function XC(s){return q.regex(CZ.keys()[0],new RegExp("(\\s|^)"+Uo(s.value)+"\\b"))}const zF={type:"object",defaultSnippets:[{body:{kind:""}}],properties:{kind:{type:"string",description:p("args.schema.kind","Kind of the code action to run.")},apply:{type:"string",description:p("args.schema.apply","Controls when the returned actions are applied."),default:"ifSingle",enum:["first","ifSingle","never"],enumDescriptions:[p("args.schema.apply.first","Always apply the first returned code action."),p("args.schema.apply.ifSingle","Apply the first returned code action if it is the only one."),p("args.schema.apply.never","Do not apply the returned code actions.")]},preferred:{type:"boolean",default:!1,description:p("args.schema.preferred","Controls if only preferred code actions should be returned.")}}};function kg(s,e,t,i,n=_o.Default){s.hasModel()&&Gp.get(s)?.manualTriggerAtCurrentPosition(e,n,t,i)}class M0e extends ge{constructor(){super({id:VF,label:p("quickfix.trigger.label","Quick Fix..."),alias:"Quick Fix...",precondition:q.and(I.writable,I.hasCodeActionsProvider),kbOpts:{kbExpr:I.textInputFocus,primary:2137,weight:100}})}run(e,t){return kg(t,p("editor.action.quickFix.noneMessage","No code actions available"),void 0,void 0,_o.QuickFix)}}class A0e extends Zi{constructor(){super({id:hZ,precondition:q.and(I.writable,I.hasCodeActionsProvider),metadata:{description:"Trigger a code action",args:[{name:"args",schema:zF}]}})}runEditorCommand(e,t,i){const n=Cl.fromUser(i,{kind:Ot.Empty,apply:"ifSingle"});return kg(t,typeof i?.kind=="string"?n.preferred?p("editor.action.codeAction.noneMessage.preferred.kind","No preferred code actions for '{0}' available",i.kind):p("editor.action.codeAction.noneMessage.kind","No code actions for '{0}' available",i.kind):n.preferred?p("editor.action.codeAction.noneMessage.preferred","No preferred code actions available"):p("editor.action.codeAction.noneMessage","No code actions available"),{include:n.kind,includeSourceActions:!0,onlyIncludePreferredActions:n.preferred},n.apply)}}class P0e extends ge{constructor(){super({id:gZ,label:p("refactor.label","Refactor..."),alias:"Refactor...",precondition:q.and(I.writable,I.hasCodeActionsProvider),kbOpts:{kbExpr:I.textInputFocus,primary:3120,mac:{primary:1328},weight:100},contextMenuOpts:{group:"1_modification",order:2,when:q.and(I.writable,XC(Yt.Refactor))},metadata:{description:"Refactor...",args:[{name:"args",schema:zF}]}})}run(e,t,i){const n=Cl.fromUser(i,{kind:Yt.Refactor,apply:"never"});return kg(t,typeof i?.kind=="string"?n.preferred?p("editor.action.refactor.noneMessage.preferred.kind","No preferred refactorings for '{0}' available",i.kind):p("editor.action.refactor.noneMessage.kind","No refactorings for '{0}' available",i.kind):n.preferred?p("editor.action.refactor.noneMessage.preferred","No preferred refactorings available"):p("editor.action.refactor.noneMessage","No refactorings available"),{include:Yt.Refactor.contains(n.kind)?n.kind:Ot.None,onlyIncludePreferredActions:n.preferred},n.apply,_o.Refactor)}}class O0e extends ge{constructor(){super({id:fZ,label:p("source.label","Source Action..."),alias:"Source Action...",precondition:q.and(I.writable,I.hasCodeActionsProvider),contextMenuOpts:{group:"1_modification",order:2.1,when:q.and(I.writable,XC(Yt.Source))},metadata:{description:"Source Action...",args:[{name:"args",schema:zF}]}})}run(e,t,i){const n=Cl.fromUser(i,{kind:Yt.Source,apply:"never"});return kg(t,typeof i?.kind=="string"?n.preferred?p("editor.action.source.noneMessage.preferred.kind","No preferred source actions for '{0}' available",i.kind):p("editor.action.source.noneMessage.kind","No source actions for '{0}' available",i.kind):n.preferred?p("editor.action.source.noneMessage.preferred","No preferred source actions available"):p("editor.action.source.noneMessage","No source actions available"),{include:Yt.Source.contains(n.kind)?n.kind:Ot.None,includeSourceActions:!0,onlyIncludePreferredActions:n.preferred},n.apply,_o.SourceAction)}}class F0e extends ge{constructor(){super({id:iM,label:p("organizeImports.label","Organize Imports"),alias:"Organize Imports",precondition:q.and(I.writable,XC(Yt.SourceOrganizeImports)),kbOpts:{kbExpr:I.textInputFocus,primary:1581,weight:100}})}run(e,t){return kg(t,p("editor.action.organize.noneMessage","No organize imports action available"),{include:Yt.SourceOrganizeImports,includeSourceActions:!0},"ifSingle",_o.OrganizeImports)}}class B0e extends ge{constructor(){super({id:nM,label:p("fixAll.label","Fix All"),alias:"Fix All",precondition:q.and(I.writable,XC(Yt.SourceFixAll))})}run(e,t){return kg(t,p("fixAll.noneMessage","No fix all action available"),{include:Yt.SourceFixAll,includeSourceActions:!0},"ifSingle",_o.FixAll)}}class W0e extends ge{constructor(){super({id:uZ,label:p("autoFix.label","Auto Fix..."),alias:"Auto Fix...",precondition:q.and(I.writable,XC(Yt.QuickFix)),kbOpts:{kbExpr:I.textInputFocus,primary:1625,mac:{primary:2649},weight:100}})}run(e,t){return kg(t,p("editor.action.autoFix.noneMessage","No auto fixes available"),{include:Yt.QuickFix,onlyIncludePreferredActions:!0},"ifSingle",_o.AutoFix)}}ct(Gp.ID,Gp,3);ct(Uv.ID,Uv,4);Q(M0e);Q(P0e);Q(O0e);Q(F0e);Q(W0e);Q(B0e);ae(new A0e);ci.as(na.Configuration).registerConfiguration({...NC,properties:{"editor.codeActionWidget.showHeaders":{type:"boolean",scope:5,description:p("showCodeActionHeaders","Enable/disable showing group headers in the Code Action menu."),default:!0}}});ci.as(na.Configuration).registerConfiguration({...NC,properties:{"editor.codeActionWidget.includeNearbyQuickFixes":{type:"boolean",scope:5,description:p("includeNearbyQuickFixes","Enable/disable showing nearest Quick Fix within a line when not currently on a diagnostic."),default:!0}}});ci.as(na.Configuration).registerConfiguration({...NC,properties:{"editor.codeActions.triggerOnFocusChange":{type:"boolean",scope:5,markdownDescription:p("triggerOnFocusChange","Enable triggering {0} when {1} is set to {2}. Code Actions must be set to {3} to be triggered for window and focus changes.","`#editor.codeActionsOnSave#`","`#files.autoSave#`","`afterDelay`","`always`"),default:!1}}});class cM{constructor(){this.lenses=[],this._disposables=new Z}dispose(){this._disposables.dispose()}get isDisposed(){return this._disposables.isDisposed}add(e,t){this._disposables.add(e);for(const i of e.lenses)this.lenses.push({symbol:i,provider:t})}}async function wZ(s,e,t){const i=s.ordered(e),n=new Map,o=new cM,r=i.map(async(a,l)=>{n.set(a,l);try{const c=await Promise.resolve(a.provideCodeLenses(e,t));c&&o.add(c,a)}catch(c){Li(c)}});return await Promise.all(r),o.lenses=o.lenses.sort((a,l)=>a.symbol.range.startLineNumber<l.symbol.range.startLineNumber?-1:a.symbol.range.startLineNumber>l.symbol.range.startLineNumber?1:n.get(a.provider)<n.get(l.provider)?-1:n.get(a.provider)>n.get(l.provider)?1:a.symbol.range.startColumn<l.symbol.range.startColumn?-1:a.symbol.range.startColumn>l.symbol.range.startColumn?1:0),o}ot.registerCommand("_executeCodeLensProvider",function(s,...e){let[t,i]=e;gt(Se.isUri(t)),gt(typeof i=="number"||!i);const{codeLensProvider:n}=s.get(pe),o=s.get(Zt).getModel(t);if(!o)throw mr();const r=[],a=new Z;return wZ(n,o,Ue.None).then(l=>{a.add(l);const c=[];for(const d of l.lenses)i==null||d.symbol.command?r.push(d.symbol):i-- >0&&d.provider.resolveCodeLens&&c.push(Promise.resolve(d.provider.resolveCodeLens(o,d.symbol,Ue.None)).then(h=>r.push(h||d.symbol)));return Promise.all(c)}).then(()=>r).finally(()=>{setTimeout(()=>a.dispose(),100)})});var H0e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},V0e=function(s,e){return function(t,i){e(t,i,s)}};const SZ=Je("ICodeLensCache");class _7{constructor(e,t){this.lineCount=e,this.data=t}}let dM=class{constructor(e){this._fakeProvider=new class{provideCodeLenses(){throw new Error("not supported")}},this._cache=new Wl(20,.75);const t="codelens/cache";v_(Nt,()=>e.remove(t,1));const i="codelens/cache2",n=e.get(i,1,"{}");this._deserialize(n);const o=se.filter(e.onWillSaveState,r=>r.reason===mv.SHUTDOWN);se.once(o)(r=>{e.store(i,this._serialize(),1,1)})}put(e,t){const i=t.lenses.map(r=>({range:r.symbol.range,command:r.symbol.command&&{id:"",title:r.symbol.command?.title}})),n=new cM;n.add({lenses:i,dispose:()=>{}},this._fakeProvider);const o=new _7(e.getLineCount(),n);this._cache.set(e.uri.toString(),o)}get(e){const t=this._cache.get(e.uri.toString());return t&&t.lineCount===e.getLineCount()?t.data:void 0}delete(e){this._cache.delete(e.uri.toString())}_serialize(){const e=Object.create(null);for(const[t,i]of this._cache){const n=new Set;for(const o of i.data.lenses)n.add(o.symbol.range.startLineNumber);e[t]={lineCount:i.lineCount,lines:[...n.values()]}}return JSON.stringify(e)}_deserialize(e){try{const t=JSON.parse(e);for(const i in t){const n=t[i],o=[];for(const a of n.lines)o.push({range:new k(a,1,a,11)});const r=new cM;r.add({lenses:o,dispose(){}},this._fakeProvider),this._cache.set(i,new _7(n.lineCount,r))}}catch{}}};dM=H0e([V0e(0,oa)],dM);nt(SZ,dM,1);class z0e{constructor(e,t,i){this.afterColumn=1073741824,this.afterLineNumber=e,this.heightInPx=t,this._onHeight=i,this.suppressMouseDown=!0,this.domNode=document.createElement("div")}onComputedHeight(e){this._lastHeight===void 0?this._lastHeight=e:this._lastHeight!==e&&(this._lastHeight=e,this._onHeight())}isVisible(){return this._lastHeight!==0&&this.domNode.hasAttribute("monaco-visible-view-zone")}}class IS{static{this._idPool=0}constructor(e,t){this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this._commands=new Map,this._isEmpty=!0,this._editor=e,this._id=`codelens.widget-${IS._idPool++}`,this.updatePosition(t),this._domNode=document.createElement("span"),this._domNode.className="codelens-decoration"}withCommands(e,t){this._commands.clear();const i=[];let n=!1;for(let o=0;o<e.length;o++){const r=e[o];if(r&&(n=!0,r.command)){const a=Kd(r.command.title.trim());if(r.command.id){const l=`c${IS._idPool++}`;i.push(te("a",{id:l,title:r.command.tooltip,role:"button"},...a)),this._commands.set(l,r.command)}else i.push(te("span",{title:r.command.tooltip},...a));o+1<e.length&&i.push(te("span",void 0,"|"))}}n?(yn(this._domNode,...i),this._isEmpty&&t&&this._domNode.classList.add("fadein"),this._isEmpty=!1):yn(this._domNode,te("span",void 0,"no commands"))}getCommand(e){return e.parentElement===this._domNode?this._commands.get(e.id):void 0}getId(){return this._id}getDomNode(){return this._domNode}updatePosition(e){const t=this._editor.getModel().getLineFirstNonWhitespaceColumn(e);this._widgetPosition={position:{lineNumber:e,column:t},preference:[1]}}getPosition(){return this._widgetPosition||null}}class lI{constructor(){this._removeDecorations=[],this._addDecorations=[],this._addDecorationsCallbacks=[]}addDecoration(e,t){this._addDecorations.push(e),this._addDecorationsCallbacks.push(t)}removeDecoration(e){this._removeDecorations.push(e)}commit(e){const t=e.deltaDecorations(this._removeDecorations,this._addDecorations);for(let i=0,n=t.length;i<n;i++)this._addDecorationsCallbacks[i](t[i])}}const b7=We.register({collapseOnReplaceEdit:!0,description:"codelens"});class v7{constructor(e,t,i,n,o,r){this._isDisposed=!1,this._editor=t,this._data=e,this._decorationIds=[];let a;const l=[];this._data.forEach((c,d)=>{c.symbol.command&&l.push(c.symbol),i.addDecoration({range:c.symbol.range,options:b7},h=>this._decorationIds[d]=h),a?a=k.plusRange(a,c.symbol.range):a=k.lift(c.symbol.range)}),this._viewZone=new z0e(a.startLineNumber-1,o,r),this._viewZoneId=n.addZone(this._viewZone),l.length>0&&(this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(l,!1))}_createContentWidgetIfNecessary(){this._contentWidget?this._editor.layoutContentWidget(this._contentWidget):(this._contentWidget=new IS(this._editor,this._viewZone.afterLineNumber+1),this._editor.addContentWidget(this._contentWidget))}dispose(e,t){this._decorationIds.forEach(e.removeDecoration,e),this._decorationIds=[],t?.removeZone(this._viewZoneId),this._contentWidget&&(this._editor.removeContentWidget(this._contentWidget),this._contentWidget=void 0),this._isDisposed=!0}isDisposed(){return this._isDisposed}isValid(){return this._decorationIds.some((e,t)=>{const i=this._editor.getModel().getDecorationRange(e),n=this._data[t].symbol;return!!(i&&k.isEmpty(n.range)===i.isEmpty())})}updateCodeLensSymbols(e,t){this._decorationIds.forEach(t.removeDecoration,t),this._decorationIds=[],this._data=e,this._data.forEach((i,n)=>{t.addDecoration({range:i.symbol.range,options:b7},o=>this._decorationIds[n]=o)})}updateHeight(e,t){this._viewZone.heightInPx=e,t.layoutZone(this._viewZoneId),this._contentWidget&&this._editor.layoutContentWidget(this._contentWidget)}computeIfNecessary(e){if(!this._viewZone.isVisible())return null;for(let t=0;t<this._decorationIds.length;t++){const i=e.getDecorationRange(this._decorationIds[t]);i&&(this._data[t].symbol.range=i)}return this._data}updateCommands(e){this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(e,!0);for(let t=0;t<this._data.length;t++){const i=e[t];if(i){const{symbol:n}=this._data[t];n.command=i.command||n.command}}}getCommand(e){return this._contentWidget?.getCommand(e)}getLineNumber(){const e=this._editor.getModel().getDecorationRange(this._decorationIds[0]);return e?e.startLineNumber:-1}update(e){if(this.isValid()){const t=this._editor.getModel().getDecorationRange(this._decorationIds[0]);t&&(this._viewZone.afterLineNumber=t.startLineNumber-1,e.layoutZone(this._viewZoneId),this._contentWidget&&(this._contentWidget.updatePosition(t.startLineNumber),this._editor.layoutContentWidget(this._contentWidget)))}}}var U0e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},d_=function(s,e){return function(t,i){e(t,i,s)}};let $v=class{static{this.ID="css.editor.codeLens"}constructor(e,t,i,n,o,r){this._editor=e,this._languageFeaturesService=t,this._commandService=n,this._notificationService=o,this._codeLensCache=r,this._disposables=new Z,this._localToDispose=new Z,this._lenses=[],this._oldCodeLensModels=new Z,this._provideCodeLensDebounce=i.for(t.codeLensProvider,"CodeLensProvide",{min:250}),this._resolveCodeLensesDebounce=i.for(t.codeLensProvider,"CodeLensResolve",{min:250,salt:"resolve"}),this._resolveCodeLensesScheduler=new It(()=>this._resolveCodeLensesInViewport(),this._resolveCodeLensesDebounce.default()),this._disposables.add(this._editor.onDidChangeModel(()=>this._onModelChange())),this._disposables.add(this._editor.onDidChangeModelLanguage(()=>this._onModelChange())),this._disposables.add(this._editor.onDidChangeConfiguration(a=>{(a.hasChanged(50)||a.hasChanged(19)||a.hasChanged(18))&&this._updateLensStyle(),a.hasChanged(17)&&this._onModelChange()})),this._disposables.add(t.codeLensProvider.onDidChange(this._onModelChange,this)),this._onModelChange(),this._updateLensStyle()}dispose(){this._localDispose(),this._disposables.dispose(),this._oldCodeLensModels.dispose(),this._currentCodeLensModel?.dispose()}_getLayoutInfo(){const e=Math.max(1.3,this._editor.getOption(67)/this._editor.getOption(52));let t=this._editor.getOption(19);return(!t||t<5)&&(t=this._editor.getOption(52)*.9|0),{fontSize:t,codeLensHeight:t*e|0}}_updateLensStyle(){const{codeLensHeight:e,fontSize:t}=this._getLayoutInfo(),i=this._editor.getOption(18),n=this._editor.getOption(50),{style:o}=this._editor.getContainerDomNode();o.setProperty("--vscode-editorCodeLens-lineHeight",`${e}px`),o.setProperty("--vscode-editorCodeLens-fontSize",`${t}px`),o.setProperty("--vscode-editorCodeLens-fontFeatureSettings",n.fontFeatureSettings),i&&(o.setProperty("--vscode-editorCodeLens-fontFamily",i),o.setProperty("--vscode-editorCodeLens-fontFamilyDefault",vs.fontFamily)),this._editor.changeViewZones(r=>{for(const a of this._lenses)a.updateHeight(e,r)})}_localDispose(){this._getCodeLensModelPromise?.cancel(),this._getCodeLensModelPromise=void 0,this._resolveCodeLensesPromise?.cancel(),this._resolveCodeLensesPromise=void 0,this._localToDispose.clear(),this._oldCodeLensModels.clear(),this._currentCodeLensModel?.dispose()}_onModelChange(){this._localDispose();const e=this._editor.getModel();if(!e||!this._editor.getOption(17)||e.isTooLargeForTokenization())return;const t=this._codeLensCache.get(e);if(t&&this._renderCodeLensSymbols(t),!this._languageFeaturesService.codeLensProvider.has(e)){t&&nh(()=>{const n=this._codeLensCache.get(e);t===n&&(this._codeLensCache.delete(e),this._onModelChange())},30*1e3,this._localToDispose);return}for(const n of this._languageFeaturesService.codeLensProvider.all(e))if(typeof n.onDidChange=="function"){const o=n.onDidChange(()=>i.schedule());this._localToDispose.add(o)}const i=new It(()=>{const n=Date.now();this._getCodeLensModelPromise?.cancel(),this._getCodeLensModelPromise=en(o=>wZ(this._languageFeaturesService.codeLensProvider,e,o)),this._getCodeLensModelPromise.then(o=>{this._currentCodeLensModel&&this._oldCodeLensModels.add(this._currentCodeLensModel),this._currentCodeLensModel=o,this._codeLensCache.put(e,o);const r=this._provideCodeLensDebounce.update(e,Date.now()-n);i.delay=r,this._renderCodeLensSymbols(o),this._resolveCodeLensesInViewportSoon()},Oe)},this._provideCodeLensDebounce.get(e));this._localToDispose.add(i),this._localToDispose.add(Ce(()=>this._resolveCodeLensesScheduler.cancel())),this._localToDispose.add(this._editor.onDidChangeModelContent(()=>{this._editor.changeDecorations(n=>{this._editor.changeViewZones(o=>{const r=[];let a=-1;this._lenses.forEach(c=>{!c.isValid()||a===c.getLineNumber()?r.push(c):(c.update(o),a=c.getLineNumber())});const l=new lI;r.forEach(c=>{c.dispose(l,o),this._lenses.splice(this._lenses.indexOf(c),1)}),l.commit(n)})}),i.schedule(),this._resolveCodeLensesScheduler.cancel(),this._resolveCodeLensesPromise?.cancel(),this._resolveCodeLensesPromise=void 0})),this._localToDispose.add(this._editor.onDidFocusEditorText(()=>{i.schedule()})),this._localToDispose.add(this._editor.onDidBlurEditorText(()=>{i.cancel()})),this._localToDispose.add(this._editor.onDidScrollChange(n=>{n.scrollTopChanged&&this._lenses.length>0&&this._resolveCodeLensesInViewportSoon()})),this._localToDispose.add(this._editor.onDidLayoutChange(()=>{this._resolveCodeLensesInViewportSoon()})),this._localToDispose.add(Ce(()=>{if(this._editor.getModel()){const n=$a.capture(this._editor);this._editor.changeDecorations(o=>{this._editor.changeViewZones(r=>{this._disposeAllLenses(o,r)})}),n.restore(this._editor)}else this._disposeAllLenses(void 0,void 0)})),this._localToDispose.add(this._editor.onMouseDown(n=>{if(n.target.type!==9)return;let o=n.target.element;if(o?.tagName==="SPAN"&&(o=o.parentElement),o?.tagName==="A")for(const r of this._lenses){const a=r.getCommand(o);if(a){this._commandService.executeCommand(a.id,...a.arguments||[]).catch(l=>this._notificationService.error(l));break}}})),i.schedule()}_disposeAllLenses(e,t){const i=new lI;for(const n of this._lenses)n.dispose(i,t);e&&i.commit(e),this._lenses.length=0}_renderCodeLensSymbols(e){if(!this._editor.hasModel())return;const t=this._editor.getModel().getLineCount(),i=[];let n;for(const a of e.lenses){const l=a.symbol.range.startLineNumber;l<1||l>t||(n&&n[n.length-1].symbol.range.startLineNumber===l?n.push(a):(n=[a],i.push(n)))}if(!i.length&&!this._lenses.length)return;const o=$a.capture(this._editor),r=this._getLayoutInfo();this._editor.changeDecorations(a=>{this._editor.changeViewZones(l=>{const c=new lI;let d=0,h=0;for(;h<i.length&&d<this._lenses.length;){const u=i[h][0].symbol.range.startLineNumber,g=this._lenses[d].getLineNumber();g<u?(this._lenses[d].dispose(c,l),this._lenses.splice(d,1)):g===u?(this._lenses[d].updateCodeLensSymbols(i[h],c),h++,d++):(this._lenses.splice(d,0,new v7(i[h],this._editor,c,l,r.codeLensHeight,()=>this._resolveCodeLensesInViewportSoon())),d++,h++)}for(;d<this._lenses.length;)this._lenses[d].dispose(c,l),this._lenses.splice(d,1);for(;h<i.length;)this._lenses.push(new v7(i[h],this._editor,c,l,r.codeLensHeight,()=>this._resolveCodeLensesInViewportSoon())),h++;c.commit(a)})}),o.restore(this._editor)}_resolveCodeLensesInViewportSoon(){this._editor.getModel()&&this._resolveCodeLensesScheduler.schedule()}_resolveCodeLensesInViewport(){this._resolveCodeLensesPromise?.cancel(),this._resolveCodeLensesPromise=void 0;const e=this._editor.getModel();if(!e)return;const t=[],i=[];if(this._lenses.forEach(r=>{const a=r.computeIfNecessary(e);a&&(t.push(a),i.push(r))}),t.length===0)return;const n=Date.now(),o=en(r=>{const a=t.map((l,c)=>{const d=new Array(l.length),h=l.map((u,g)=>!u.symbol.command&&typeof u.provider.resolveCodeLens=="function"?Promise.resolve(u.provider.resolveCodeLens(e,u.symbol,r)).then(f=>{d[g]=f},Li):(d[g]=u.symbol,Promise.resolve(void 0)));return Promise.all(h).then(()=>{!r.isCancellationRequested&&!i[c].isDisposed()&&i[c].updateCommands(d)})});return Promise.all(a)});this._resolveCodeLensesPromise=o,this._resolveCodeLensesPromise.then(()=>{const r=this._resolveCodeLensesDebounce.update(e,Date.now()-n);this._resolveCodeLensesScheduler.delay=r,this._currentCodeLensModel&&this._codeLensCache.put(e,this._currentCodeLensModel),this._oldCodeLensModels.clear(),o===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)},r=>{Oe(r),o===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)})}async getModel(){return await this._getCodeLensModelPromise,await this._resolveCodeLensesPromise,this._currentCodeLensModel?.isDisposed?void 0:this._currentCodeLensModel}};$v=U0e([d_(1,pe),d_(2,Go),d_(3,Ht),d_(4,Ii),d_(5,SZ)],$v);ct($v.ID,$v,1);Q(class extends ge{constructor(){super({id:"codelens.showLensesInCurrentLine",precondition:I.hasCodeLensProvider,label:p("showLensOnLine","Show CodeLens Commands For Current Line"),alias:"Show CodeLens Commands For Current Line"})}async run(e,t){if(!t.hasModel())return;const i=e.get(Dr),n=e.get(Ht),o=e.get(Ii),r=t.getSelection().positionLineNumber,a=t.getContribution($v.ID);if(!a)return;const l=await a.getModel();if(!l)return;const c=[];for(const u of l.lenses)u.symbol.command&&u.symbol.range.startLineNumber===r&&c.push({label:u.symbol.command.title,command:u.symbol.command});if(c.length===0)return;const d=await i.pick(c,{canPickMany:!1,placeHolder:p("placeHolder","Select a command")});if(!d)return;let h=d.command;if(l.isDisposed){const g=(await a.getModel())?.lenses.find(f=>f.symbol.range.startLineNumber===r&&f.symbol.command?.title===h.title);if(!g||!g.symbol.command)return;h=g.symbol.command}try{await n.executeCommand(h.id,...h.arguments||[])}catch(u){o.error(u)}}});var LZ=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},hM=function(s,e){return function(t,i){e(t,i,s)}};let jv=class{constructor(e){this._editorWorkerService=e}async provideDocumentColors(e,t){return this._editorWorkerService.computeDefaultDocumentColors(e.uri)}provideColorPresentations(e,t,i){const n=t.range,o=t.color,r=o.alpha,a=new G(new dt(Math.round(255*o.red),Math.round(255*o.green),Math.round(255*o.blue),r)),l=r?G.Format.CSS.formatRGB(a):G.Format.CSS.formatRGBA(a),c=r?G.Format.CSS.formatHSL(a):G.Format.CSS.formatHSLA(a),d=r?G.Format.CSS.formatHex(a):G.Format.CSS.formatHexA(a),h=[];return h.push({label:l,textEdit:{range:n,text:l}}),h.push({label:c,textEdit:{range:n,text:c}}),h.push({label:d,textEdit:{range:n,text:d}}),h}};jv=LZ([hM(0,Xs)],jv);let uM=class extends B{constructor(e,t){super(),this._register(e.colorProvider.register("*",new jv(t)))}};uM=LZ([hM(0,pe),hM(1,Xs)],uM);Rm(uM);async function xZ(s,e,t,i=!0){return UF(new $0e,s,e,t,i)}function kZ(s,e,t,i){return Promise.resolve(t.provideColorPresentations(s,e,i))}class $0e{constructor(){}async compute(e,t,i,n){const o=await e.provideDocumentColors(t,i);if(Array.isArray(o))for(const r of o)n.push({colorInfo:r,provider:e});return Array.isArray(o)}}class j0e{constructor(){}async compute(e,t,i,n){const o=await e.provideDocumentColors(t,i);if(Array.isArray(o))for(const r of o)n.push({range:r.range,color:[r.color.red,r.color.green,r.color.blue,r.color.alpha]});return Array.isArray(o)}}class Z0e{constructor(e){this.colorInfo=e}async compute(e,t,i,n){const o=await e.provideColorPresentations(t,this.colorInfo,Ue.None);return Array.isArray(o)&&n.push(...o),Array.isArray(o)}}async function UF(s,e,t,i,n){let o=!1,r;const a=[],l=e.ordered(t);for(let c=l.length-1;c>=0;c--){const d=l[c];if(d instanceof jv)r=d;else try{await s.compute(d,t,i,a)&&(o=!0)}catch(h){Li(h)}}return o?a:r&&n?(await s.compute(r,t,i,a),a):[]}function DZ(s,e){const{colorProvider:t}=s.get(pe),i=s.get(Zt).getModel(e);if(!i)throw mr();const n=s.get(Ke).getValue("editor.defaultColorDecorators",{resource:e});return{model:i,colorProviderRegistry:t,isDefaultColorDecoratorsEnabled:n}}ot.registerCommand("_executeDocumentColorProvider",function(s,...e){const[t]=e;if(!(t instanceof Se))throw mr();const{model:i,colorProviderRegistry:n,isDefaultColorDecoratorsEnabled:o}=DZ(s,t);return UF(new j0e,n,i,Ue.None,o)});ot.registerCommand("_executeColorPresentationProvider",function(s,...e){const[t,i]=e,{uri:n,range:o}=i;if(!(n instanceof Se)||!Array.isArray(t)||t.length!==4||!k.isIRange(o))throw mr();const{model:r,colorProviderRegistry:a,isDefaultColorDecoratorsEnabled:l}=DZ(s,n),[c,d,h,u]=t;return UF(new Z0e({range:o,color:{red:c,green:d,blue:h,alpha:u}}),a,r,Ue.None,l)});var K0e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},cI=function(s,e){return function(t,i){e(t,i,s)}},gM;const IZ=Object.create({});let Yp=class extends B{static{gM=this}static{this.ID="editor.contrib.colorDetector"}static{this.RECOMPUTE_TIME=1e3}constructor(e,t,i,n){super(),this._editor=e,this._configurationService=t,this._languageFeaturesService=i,this._localToDispose=this._register(new Z),this._decorationsIds=[],this._colorDatas=new Map,this._colorDecoratorIds=this._editor.createDecorationsCollection(),this._ruleFactory=new xx(this._editor),this._decoratorLimitReporter=new q0e,this._colorDecorationClassRefs=this._register(new Z),this._debounceInformation=n.for(i.colorProvider,"Document Colors",{min:gM.RECOMPUTE_TIME}),this._register(e.onDidChangeModel(()=>{this._isColorDecoratorsEnabled=this.isEnabled(),this.updateColors()})),this._register(e.onDidChangeModelLanguage(()=>this.updateColors())),this._register(i.colorProvider.onDidChange(()=>this.updateColors())),this._register(e.onDidChangeConfiguration(o=>{const r=this._isColorDecoratorsEnabled;this._isColorDecoratorsEnabled=this.isEnabled(),this._isDefaultColorDecoratorsEnabled=this._editor.getOption(148);const a=r!==this._isColorDecoratorsEnabled||o.hasChanged(21),l=o.hasChanged(148);(a||l)&&(this._isColorDecoratorsEnabled?this.updateColors():this.removeAllDecorations())})),this._timeoutTimer=null,this._computePromise=null,this._isColorDecoratorsEnabled=this.isEnabled(),this._isDefaultColorDecoratorsEnabled=this._editor.getOption(148),this.updateColors()}isEnabled(){const e=this._editor.getModel();if(!e)return!1;const t=e.getLanguageId(),i=this._configurationService.getValue(t);if(i&&typeof i=="object"){const n=i.colorDecorators;if(n&&n.enable!==void 0&&!n.enable)return n.enable}return this._editor.getOption(20)}static get(e){return e.getContribution(this.ID)}dispose(){this.stop(),this.removeAllDecorations(),super.dispose()}updateColors(){if(this.stop(),!this._isColorDecoratorsEnabled)return;const e=this._editor.getModel();!e||!this._languageFeaturesService.colorProvider.has(e)||(this._localToDispose.add(this._editor.onDidChangeModelContent(()=>{this._timeoutTimer||(this._timeoutTimer=new ia,this._timeoutTimer.cancelAndSet(()=>{this._timeoutTimer=null,this.beginCompute()},this._debounceInformation.get(e)))})),this.beginCompute())}async beginCompute(){this._computePromise=en(async e=>{const t=this._editor.getModel();if(!t)return[];const i=new un(!1),n=await xZ(this._languageFeaturesService.colorProvider,t,e,this._isDefaultColorDecoratorsEnabled);return this._debounceInformation.update(t,i.elapsed()),n});try{const e=await this._computePromise;this.updateDecorations(e),this.updateColorDecorators(e),this._computePromise=null}catch(e){Oe(e)}}stop(){this._timeoutTimer&&(this._timeoutTimer.cancel(),this._timeoutTimer=null),this._computePromise&&(this._computePromise.cancel(),this._computePromise=null),this._localToDispose.clear()}updateDecorations(e){const t=e.map(i=>({range:{startLineNumber:i.colorInfo.range.startLineNumber,startColumn:i.colorInfo.range.startColumn,endLineNumber:i.colorInfo.range.endLineNumber,endColumn:i.colorInfo.range.endColumn},options:We.EMPTY}));this._editor.changeDecorations(i=>{this._decorationsIds=i.deltaDecorations(this._decorationsIds,t),this._colorDatas=new Map,this._decorationsIds.forEach((n,o)=>this._colorDatas.set(n,e[o]))})}updateColorDecorators(e){this._colorDecorationClassRefs.clear();const t=[],i=this._editor.getOption(21);for(let o=0;o<e.length&&t.length<i;o++){const{red:r,green:a,blue:l,alpha:c}=e[o].colorInfo.color,d=new dt(Math.round(r*255),Math.round(a*255),Math.round(l*255),c),h=`rgba(${d.r}, ${d.g}, ${d.b}, ${d.a})`,u=this._colorDecorationClassRefs.add(this._ruleFactory.createClassNameRef({backgroundColor:h}));t.push({range:{startLineNumber:e[o].colorInfo.range.startLineNumber,startColumn:e[o].colorInfo.range.startColumn,endLineNumber:e[o].colorInfo.range.endLineNumber,endColumn:e[o].colorInfo.range.endColumn},options:{description:"colorDetector",before:{content:R6,inlineClassName:`${u.className} colorpicker-color-decoration`,inlineClassNameAffectsLetterSpacing:!0,attachedData:IZ}}})}const n=i<e.length?i:!1;this._decoratorLimitReporter.update(e.length,n),this._colorDecoratorIds.set(t)}removeAllDecorations(){this._editor.removeDecorations(this._decorationsIds),this._decorationsIds=[],this._colorDecoratorIds.clear(),this._colorDecorationClassRefs.clear()}getColorData(e){const t=this._editor.getModel();if(!t)return null;const i=t.getDecorationsInRange(k.fromPositions(e,e)).filter(n=>this._colorDatas.has(n.id));return i.length===0?null:this._colorDatas.get(i[0].id)}isColorDecoration(e){return this._colorDecoratorIds.has(e)}};Yp=gM=K0e([cI(1,Ke),cI(2,pe),cI(3,Go)],Yp);class q0e{constructor(){this._onDidChange=new O,this._computed=0,this._limited=!1}update(e,t){(e!==this._computed||t!==this._limited)&&(this._computed=e,this._limited=t,this._onDidChange.fire())}}ct(Yp.ID,Yp,1);class G0e{get color(){return this._color}set color(e){this._color.equals(e)||(this._color=e,this._onDidChangeColor.fire(e))}get presentation(){return this.colorPresentations[this.presentationIndex]}get colorPresentations(){return this._colorPresentations}set colorPresentations(e){this._colorPresentations=e,this.presentationIndex>e.length-1&&(this.presentationIndex=0),this._onDidChangePresentation.fire(this.presentation)}constructor(e,t,i){this.presentationIndex=i,this._onColorFlushed=new O,this.onColorFlushed=this._onColorFlushed.event,this._onDidChangeColor=new O,this.onDidChangeColor=this._onDidChangeColor.event,this._onDidChangePresentation=new O,this.onDidChangePresentation=this._onDidChangePresentation.event,this.originalColor=e,this._color=e,this._colorPresentations=t}selectNextColorPresentation(){this.presentationIndex=(this.presentationIndex+1)%this.colorPresentations.length,this.flushColor(),this._onDidChangePresentation.fire(this.presentation)}guessColorPresentation(e,t){let i=-1;for(let n=0;n<this.colorPresentations.length;n++)if(t.toLowerCase()===this.colorPresentations[n].label){i=n;break}if(i===-1){const n=t.split("(")[0].toLowerCase();for(let o=0;o<this.colorPresentations.length;o++)if(this.colorPresentations[o].label.toLowerCase().startsWith(n)){i=o;break}}i!==-1&&i!==this.presentationIndex&&(this.presentationIndex=i,this._onDidChangePresentation.fire(this.presentation))}flushColor(){this._onColorFlushed.fire(this._color)}}const Oo=te;class Y0e extends B{constructor(e,t,i,n=!1){super(),this.model=t,this.showingStandaloneColorPicker=n,this._closeButton=null,this._domNode=Oo(".colorpicker-header"),X(e,this._domNode),this._pickedColorNode=X(this._domNode,Oo(".picked-color")),X(this._pickedColorNode,Oo("span.codicon.codicon-color-mode")),this._pickedColorPresentation=X(this._pickedColorNode,document.createElement("span")),this._pickedColorPresentation.classList.add("picked-color-presentation");const o=p("clickToToggleColorOptions","Click to toggle color options (rgb/hsl/hex)");this._pickedColorNode.setAttribute("title",o),this._originalColorNode=X(this._domNode,Oo(".original-color")),this._originalColorNode.style.backgroundColor=G.Format.CSS.format(this.model.originalColor)||"",this.backgroundColor=i.getColorTheme().getColor(a0)||G.white,this._register(i.onDidColorThemeChange(r=>{this.backgroundColor=r.getColor(a0)||G.white})),this._register(U(this._pickedColorNode,ee.CLICK,()=>this.model.selectNextColorPresentation())),this._register(U(this._originalColorNode,ee.CLICK,()=>{this.model.color=this.model.originalColor,this.model.flushColor()})),this._register(t.onDidChangeColor(this.onDidChangeColor,this)),this._register(t.onDidChangePresentation(this.onDidChangePresentation,this)),this._pickedColorNode.style.backgroundColor=G.Format.CSS.format(t.color)||"",this._pickedColorNode.classList.toggle("light",t.color.rgba.a<.5?this.backgroundColor.isLighter():t.color.isLighter()),this.onDidChangeColor(this.model.color),this.showingStandaloneColorPicker&&(this._domNode.classList.add("standalone-colorpicker"),this._closeButton=this._register(new X0e(this._domNode)))}get closeButton(){return this._closeButton}get pickedColorNode(){return this._pickedColorNode}get originalColorNode(){return this._originalColorNode}onDidChangeColor(e){this._pickedColorNode.style.backgroundColor=G.Format.CSS.format(e)||"",this._pickedColorNode.classList.toggle("light",e.rgba.a<.5?this.backgroundColor.isLighter():e.isLighter()),this.onDidChangePresentation()}onDidChangePresentation(){this._pickedColorPresentation.textContent=this.model.presentation?this.model.presentation.label:""}}class X0e extends B{constructor(e){super(),this._onClicked=this._register(new O),this.onClicked=this._onClicked.event,this._button=document.createElement("div"),this._button.classList.add("close-button"),X(e,this._button);const t=document.createElement("div");t.classList.add("close-button-inner-div"),X(this._button,t),X(t,Oo(".button"+Ie.asCSSSelector(Kt("color-picker-close",J.close,p("closeIcon","Icon to close the color picker"))))).classList.add("close-icon"),this._register(U(this._button,ee.CLICK,()=>{this._onClicked.fire()}))}}class Q0e extends B{constructor(e,t,i,n=!1){super(),this.model=t,this.pixelRatio=i,this._insertButton=null,this._domNode=Oo(".colorpicker-body"),X(e,this._domNode),this._saturationBox=new J0e(this._domNode,this.model,this.pixelRatio),this._register(this._saturationBox),this._register(this._saturationBox.onDidChange(this.onDidSaturationValueChange,this)),this._register(this._saturationBox.onColorFlushed(this.flushColor,this)),this._opacityStrip=new eSe(this._domNode,this.model,n),this._register(this._opacityStrip),this._register(this._opacityStrip.onDidChange(this.onDidOpacityChange,this)),this._register(this._opacityStrip.onColorFlushed(this.flushColor,this)),this._hueStrip=new tSe(this._domNode,this.model,n),this._register(this._hueStrip),this._register(this._hueStrip.onDidChange(this.onDidHueChange,this)),this._register(this._hueStrip.onColorFlushed(this.flushColor,this)),n&&(this._insertButton=this._register(new iSe(this._domNode)),this._domNode.classList.add("standalone-colorpicker"))}flushColor(){this.model.flushColor()}onDidSaturationValueChange({s:e,v:t}){const i=this.model.color.hsva;this.model.color=new G(new yl(i.h,e,t,i.a))}onDidOpacityChange(e){const t=this.model.color.hsva;this.model.color=new G(new yl(t.h,t.s,t.v,e))}onDidHueChange(e){const t=this.model.color.hsva,i=(1-e)*360;this.model.color=new G(new yl(i===360?0:i,t.s,t.v,t.a))}get domNode(){return this._domNode}get saturationBox(){return this._saturationBox}get enterButton(){return this._insertButton}layout(){this._saturationBox.layout(),this._opacityStrip.layout(),this._hueStrip.layout()}}class J0e extends B{constructor(e,t,i){super(),this.model=t,this.pixelRatio=i,this._onDidChange=new O,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new O,this.onColorFlushed=this._onColorFlushed.event,this._domNode=Oo(".saturation-wrap"),X(e,this._domNode),this._canvas=document.createElement("canvas"),this._canvas.className="saturation-box",X(this._domNode,this._canvas),this.selection=Oo(".saturation-selection"),X(this._domNode,this.selection),this.layout(),this._register(U(this._domNode,ee.POINTER_DOWN,n=>this.onPointerDown(n))),this._register(this.model.onDidChangeColor(this.onDidChangeColor,this)),this.monitor=null}get domNode(){return this._domNode}onPointerDown(e){if(!e.target||!(e.target instanceof Element))return;this.monitor=this._register(new wm);const t=Si(this._domNode);e.target!==this.selection&&this.onDidChangePosition(e.offsetX,e.offsetY),this.monitor.startMonitoring(e.target,e.pointerId,e.buttons,n=>this.onDidChangePosition(n.pageX-t.left,n.pageY-t.top),()=>null);const i=U(e.target.ownerDocument,ee.POINTER_UP,()=>{this._onColorFlushed.fire(),i.dispose(),this.monitor&&(this.monitor.stopMonitoring(!0),this.monitor=null)},!0)}onDidChangePosition(e,t){const i=Math.max(0,Math.min(1,e/this.width)),n=Math.max(0,Math.min(1,1-t/this.height));this.paintSelection(i,n),this._onDidChange.fire({s:i,v:n})}layout(){this.width=this._domNode.offsetWidth,this.height=this._domNode.offsetHeight,this._canvas.width=this.width*this.pixelRatio,this._canvas.height=this.height*this.pixelRatio,this.paint();const e=this.model.color.hsva;this.paintSelection(e.s,e.v)}paint(){const e=this.model.color.hsva,t=new G(new yl(e.h,1,1,1)),i=this._canvas.getContext("2d"),n=i.createLinearGradient(0,0,this._canvas.width,0);n.addColorStop(0,"rgba(255, 255, 255, 1)"),n.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),n.addColorStop(1,"rgba(255, 255, 255, 0)");const o=i.createLinearGradient(0,0,0,this._canvas.height);o.addColorStop(0,"rgba(0, 0, 0, 0)"),o.addColorStop(1,"rgba(0, 0, 0, 1)"),i.rect(0,0,this._canvas.width,this._canvas.height),i.fillStyle=G.Format.CSS.format(t),i.fill(),i.fillStyle=n,i.fill(),i.fillStyle=o,i.fill()}paintSelection(e,t){this.selection.style.left=`${e*this.width}px`,this.selection.style.top=`${this.height-t*this.height}px`}onDidChangeColor(e){if(this.monitor&&this.monitor.isMonitoring())return;this.paint();const t=e.hsva;this.paintSelection(t.s,t.v)}}class TZ extends B{constructor(e,t,i=!1){super(),this.model=t,this._onDidChange=new O,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new O,this.onColorFlushed=this._onColorFlushed.event,i?(this.domNode=X(e,Oo(".standalone-strip")),this.overlay=X(this.domNode,Oo(".standalone-overlay"))):(this.domNode=X(e,Oo(".strip")),this.overlay=X(this.domNode,Oo(".overlay"))),this.slider=X(this.domNode,Oo(".slider")),this.slider.style.top="0px",this._register(U(this.domNode,ee.POINTER_DOWN,n=>this.onPointerDown(n))),this._register(t.onDidChangeColor(this.onDidChangeColor,this)),this.layout()}layout(){this.height=this.domNode.offsetHeight-this.slider.offsetHeight;const e=this.getValue(this.model.color);this.updateSliderPosition(e)}onDidChangeColor(e){const t=this.getValue(e);this.updateSliderPosition(t)}onPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=this._register(new wm),i=Si(this.domNode);this.domNode.classList.add("grabbing"),e.target!==this.slider&&this.onDidChangeTop(e.offsetY),t.startMonitoring(e.target,e.pointerId,e.buttons,o=>this.onDidChangeTop(o.pageY-i.top),()=>null);const n=U(e.target.ownerDocument,ee.POINTER_UP,()=>{this._onColorFlushed.fire(),n.dispose(),t.stopMonitoring(!0),this.domNode.classList.remove("grabbing")},!0)}onDidChangeTop(e){const t=Math.max(0,Math.min(1,1-e/this.height));this.updateSliderPosition(t),this._onDidChange.fire(t)}updateSliderPosition(e){this.slider.style.top=`${(1-e)*this.height}px`}}class eSe extends TZ{constructor(e,t,i=!1){super(e,t,i),this.domNode.classList.add("opacity-strip"),this.onDidChangeColor(this.model.color)}onDidChangeColor(e){super.onDidChangeColor(e);const{r:t,g:i,b:n}=e.rgba,o=new G(new dt(t,i,n,1)),r=new G(new dt(t,i,n,0));this.overlay.style.background=`linear-gradient(to bottom, ${o} 0%, ${r} 100%)`}getValue(e){return e.hsva.a}}class tSe extends TZ{constructor(e,t,i=!1){super(e,t,i),this.domNode.classList.add("hue-strip")}getValue(e){return 1-e.hsva.h/360}}class iSe extends B{constructor(e){super(),this._onClicked=this._register(new O),this.onClicked=this._onClicked.event,this._button=X(e,document.createElement("button")),this._button.classList.add("insert-button"),this._button.textContent="Insert",this._register(U(this._button,ee.CLICK,()=>{this._onClicked.fire()}))}get button(){return this._button}}class nSe extends Yo{constructor(e,t,i,n,o=!1){super(),this.model=t,this.pixelRatio=i,this._register(qb.getInstance(ke(e)).onDidChange(()=>this.layout())),this._domNode=Oo(".colorpicker-widget"),e.appendChild(this._domNode),this.header=this._register(new Y0e(this._domNode,this.model,n,o)),this.body=this._register(new Q0e(this._domNode,this.model,this.pixelRatio,o))}layout(){this.body.layout()}get domNode(){return this._domNode}}class dI{constructor(e,t,i,n){this.priority=e,this.range=t,this.initialMousePosX=i,this.initialMousePosY=n,this.type=1}equals(e){return e.type===1&&this.range.equalsRange(e.range)}canAdoptVisibleHover(e,t){return e.type===1&&t.lineNumber===this.range.startLineNumber}}class o1{constructor(e,t,i,n,o,r){this.priority=e,this.owner=t,this.range=i,this.initialMousePosX=n,this.initialMousePosY=o,this.supportsMarkerHover=r,this.type=2}equals(e){return e.type===2&&this.owner===e.owner}canAdoptVisibleHover(e,t){return e.type===2&&this.owner===e.owner}}class lg{constructor(e){this.renderedHoverParts=e}dispose(){for(const e of this.renderedHoverParts)e.dispose()}}const Dg=new class{constructor(){this._participants=[]}register(e){this._participants.push(e)}getAll(){return this._participants}};var EZ=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},NZ=function(s,e){return function(t,i){e(t,i,s)}};class sSe{constructor(e,t,i,n){this.owner=e,this.range=t,this.model=i,this.provider=n,this.forceShowAtRange=!0}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let Zv=class{constructor(e,t){this._editor=e,this._themeService=t,this.hoverOrdinal=2}computeSync(e,t){return[]}computeAsync(e,t,i){return zi.fromPromise(this._computeAsync(e,t,i))}async _computeAsync(e,t,i){if(!this._editor.hasModel())return[];const n=Yp.get(this._editor);if(!n)return[];for(const o of t){if(!n.isColorDecoration(o))continue;const r=n.getColorData(o.range.getStartPosition());if(r)return[await RZ(this,this._editor.getModel(),r.colorInfo,r.provider)]}return[]}renderHoverParts(e,t){const i=MZ(this,this._editor,this._themeService,t,e);if(!i)return new lg([]);this._colorPicker=i.colorPicker;const n={hoverPart:i.hoverPart,hoverElement:this._colorPicker.domNode,dispose(){i.disposables.dispose()}};return new lg([n])}handleResize(){this._colorPicker?.layout()}isColorPickerVisible(){return!!this._colorPicker}};Zv=EZ([NZ(1,Ki)],Zv);class oSe{constructor(e,t,i,n){this.owner=e,this.range=t,this.model=i,this.provider=n}}let Kv=class{constructor(e,t){this._editor=e,this._themeService=t,this._color=null}async createColorHover(e,t,i){if(!this._editor.hasModel()||!Yp.get(this._editor))return null;const o=await xZ(i,this._editor.getModel(),Ue.None);let r=null,a=null;for(const h of o){const u=h.colorInfo;k.containsRange(u.range,e.range)&&(r=u,a=h.provider)}const l=r??e,c=a??t,d=!!r;return{colorHover:await RZ(this,this._editor.getModel(),l,c),foundInEditor:d}}async updateEditorModel(e){if(!this._editor.hasModel())return;const t=e.model;let i=new k(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn);this._color&&(await r1(this._editor.getModel(),t,this._color,i,e),i=AZ(this._editor,i,t))}renderHoverParts(e,t){return MZ(this,this._editor,this._themeService,t,e)}set color(e){this._color=e}get color(){return this._color}};Kv=EZ([NZ(1,Ki)],Kv);async function RZ(s,e,t,i){const n=e.getValueInRange(t.range),{red:o,green:r,blue:a,alpha:l}=t.color,c=new dt(Math.round(o*255),Math.round(r*255),Math.round(a*255),l),d=new G(c),h=await kZ(e,t,i,Ue.None),u=new G0e(d,[],0);return u.colorPresentations=h||[],u.guessColorPresentation(d,n),s instanceof Zv?new sSe(s,k.lift(t.range),u,i):new oSe(s,k.lift(t.range),u,i)}function MZ(s,e,t,i,n){if(i.length===0||!e.hasModel())return;if(n.setMinimumDimensions){const u=e.getOption(67)+8;n.setMinimumDimensions(new bt(302,u))}const o=new Z,r=i[0],a=e.getModel(),l=r.model,c=o.add(new nSe(n.fragment,l,e.getOption(144),t,s instanceof Kv));let d=!1,h=new k(r.range.startLineNumber,r.range.startColumn,r.range.endLineNumber,r.range.endColumn);if(s instanceof Kv){const u=r.model.color;s.color=u,r1(a,l,u,h,r),o.add(l.onColorFlushed(g=>{s.color=g}))}else o.add(l.onColorFlushed(async u=>{await r1(a,l,u,h,r),d=!0,h=AZ(e,h,l)}));return o.add(l.onDidChangeColor(u=>{r1(a,l,u,h,r)})),o.add(e.onDidChangeModelContent(u=>{d?d=!1:(n.hide(),e.focus())})),{hoverPart:r,colorPicker:c,disposables:o}}function AZ(s,e,t){const i=[],n=t.presentation.textEdit??{range:e,text:t.presentation.label,forceMoveMarkers:!1};i.push(n),t.presentation.additionalTextEdits&&i.push(...t.presentation.additionalTextEdits);const o=k.lift(n.range),r=s.getModel()._setTrackedRange(null,o,3);return s.executeEdits("colorpicker",i),s.pushUndoStop(),s.getModel()._getTrackedRange(r)??o}async function r1(s,e,t,i,n){const o=await kZ(s,{range:i,color:{red:t.rgba.r/255,green:t.rgba.g/255,blue:t.rgba.b/255,alpha:t.rgba.a}},n.provider,Ue.None);e.colorPresentations=o||[]}const PZ="editor.action.showHover",rSe="editor.action.showDefinitionPreviewHover",aSe="editor.action.scrollUpHover",lSe="editor.action.scrollDownHover",cSe="editor.action.scrollLeftHover",dSe="editor.action.scrollRightHover",hSe="editor.action.pageUpHover",uSe="editor.action.pageDownHover",gSe="editor.action.goToTopHover",fSe="editor.action.goToBottomHover",Zx="editor.action.increaseHoverVerbosityLevel",pSe=p({key:"increaseHoverVerbosityLevel",comment:["Label for action that will increase the hover verbosity level."]},"Increase Hover Verbosity Level"),Kx="editor.action.decreaseHoverVerbosityLevel",mSe=p({key:"decreaseHoverVerbosityLevel",comment:["Label for action that will decrease the hover verbosity level."]},"Decrease Hover Verbosity Level"),OZ="editor.action.inlineSuggest.commit",FZ="editor.action.inlineSuggest.showPrevious",BZ="editor.action.inlineSuggest.showNext";var $F=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},zr=function(s,e){return function(t,i){e(t,i,s)}},a1;let fM=class extends B{constructor(e,t,i){super(),this.editor=e,this.model=t,this.instantiationService=i,this.alwaysShowToolbar=kt(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(62).showToolbar==="always"),this.sessionPosition=void 0,this.position=_e(this,n=>{const o=this.model.read(n)?.primaryGhostText.read(n);if(!this.alwaysShowToolbar.read(n)||!o||o.parts.length===0)return this.sessionPosition=void 0,null;const r=o.parts[0].column;this.sessionPosition&&this.sessionPosition.lineNumber!==o.lineNumber&&(this.sessionPosition=void 0);const a=new P(o.lineNumber,Math.min(r,this.sessionPosition?.column??Number.MAX_SAFE_INTEGER));return this.sessionPosition=a,a}),this._register(Us((n,o)=>{const r=this.model.read(n);if(!r||!this.alwaysShowToolbar.read(n))return;const a=wh((c,d)=>{const h=d.add(this.instantiationService.createInstance(Xp,this.editor,!0,this.position,r.selectedInlineCompletionIndex,r.inlineCompletionsCount,r.activeCommands));return e.addContentWidget(h),d.add(Ce(()=>e.removeContentWidget(h))),d.add(Pe(u=>{this.position.read(u)&&r.lastTriggerKind.read(u)!==Ea.Explicit&&r.triggerExplicitly()})),h}),l=PC(this,(c,d)=>!!this.position.read(c)||!!d);o.add(Pe(c=>{l.read(c)&&a.read(c)}))}))}};fM=$F([zr(2,ye)],fM);const _Se=Kt("inline-suggestion-hints-next",J.chevronRight,p("parameterHintsNextIcon","Icon for show next parameter hint.")),bSe=Kt("inline-suggestion-hints-previous",J.chevronLeft,p("parameterHintsPreviousIcon","Icon for show previous parameter hint."));let Xp=class extends B{static{a1=this}static{this._dropDownVisible=!1}static get dropDownVisible(){return this._dropDownVisible}static{this.id=0}createCommandAction(e,t,i){const n=new ho(e,t,i,!0,()=>this._commandService.executeCommand(e)),o=this.keybindingService.lookupKeybinding(e,this._contextKeyService);let r=t;return o&&(r=p({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",t,o.getLabel())),n.tooltip=r,n}constructor(e,t,i,n,o,r,a,l,c,d,h){super(),this.editor=e,this.withBorder=t,this._position=i,this._currentSuggestionIdx=n,this._suggestionCount=o,this._extraCommands=r,this._commandService=a,this.keybindingService=c,this._contextKeyService=d,this._menuService=h,this.id=`InlineSuggestionHintsContentWidget${a1.id++}`,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this.nodes=Ye("div.inlineSuggestionsHints",{className:this.withBorder?".withBorder":""},[Ye("div@toolBar")]),this.previousAction=this.createCommandAction(FZ,p("previous","Previous"),Ie.asClassName(bSe)),this.availableSuggestionCountAction=new ho("inlineSuggestionHints.availableSuggestionCount","",void 0,!1),this.nextAction=this.createCommandAction(BZ,p("next","Next"),Ie.asClassName(_Se)),this.inlineCompletionsActionsMenus=this._register(this._menuService.createMenu(M.InlineCompletionsActions,this._contextKeyService)),this.clearAvailableSuggestionCountLabelDebounced=this._register(new It(()=>{this.availableSuggestionCountAction.label=""},100)),this.disableButtonsDebounced=this._register(new It(()=>{this.previousAction.enabled=this.nextAction.enabled=!1},100)),this.toolBar=this._register(l.createInstance(pM,this.nodes.toolBar,M.InlineSuggestionToolbar,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:u=>u.startsWith("primary")},actionViewItemProvider:(u,g)=>{if(u instanceof uo)return l.createInstance(CSe,u,void 0);if(u===this.availableSuggestionCountAction){const f=new vSe(void 0,u,{label:!0,icon:!1});return f.setClass("availableSuggestionCount"),f}},telemetrySource:"InlineSuggestionToolbar"})),this.toolBar.setPrependedPrimaryActions([this.previousAction,this.availableSuggestionCountAction,this.nextAction]),this._register(this.toolBar.onDidChangeDropdownVisibility(u=>{a1._dropDownVisible=u})),this._register(Pe(u=>{this._position.read(u),this.editor.layoutContentWidget(this)})),this._register(Pe(u=>{const g=this._suggestionCount.read(u),f=this._currentSuggestionIdx.read(u);g!==void 0?(this.clearAvailableSuggestionCountLabelDebounced.cancel(),this.availableSuggestionCountAction.label=`${f+1}/${g}`):this.clearAvailableSuggestionCountLabelDebounced.schedule(),g!==void 0&&g>1?(this.disableButtonsDebounced.cancel(),this.previousAction.enabled=this.nextAction.enabled=!0):this.disableButtonsDebounced.schedule()})),this._register(Pe(u=>{const f=this._extraCommands.read(u).map(m=>({class:void 0,id:m.id,enabled:!0,tooltip:m.tooltip||"",label:m.title,run:_=>this._commandService.executeCommand(m.id)}));for(const[m,_]of this.inlineCompletionsActionsMenus.getActions())for(const b of _)b instanceof uo&&f.push(b);f.length>0&&f.unshift(new ji),this.toolBar.setAdditionalSecondaryActions(f)}))}getId(){return this.id}getDomNode(){return this.nodes.root}getPosition(){return{position:this._position.get(),preference:[1,2],positionAffinity:3}}};Xp=a1=$F([zr(6,Ht),zr(7,ye),zr(8,yt),zr(9,Ee),zr(10,qo)],Xp);class vSe extends Bp{constructor(){super(...arguments),this._className=void 0}setClass(e){this._className=e}render(e){super.render(e),this._className&&e.classList.add(this._className)}updateTooltip(){}}let CSe=class extends lh{updateLabel(){const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){const t=Ye("div.keybinding").root;this._register(new Em(t,lo,{disableTitle:!0,..._$})).set(e),this.label.textContent=this._action.label,this.label.appendChild(t),this.label.classList.add("inlineSuggestionStatusBarItemLabel")}}updateTooltip(){}},pM=class extends Bv{constructor(e,t,i,n,o,r,a,l,c){super(e,{resetMenu:t,...i},n,o,r,a,l,c),this.menuId=t,this.options2=i,this.menuService=n,this.contextKeyService=o,this.menu=this._store.add(this.menuService.createMenu(this.menuId,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.additionalActions=[],this.prependedPrimaryActions=[],this._store.add(this.menu.onDidChange(()=>this.updateToolbar())),this.updateToolbar()}updateToolbar(){const e=[],t=[];cx(this.menu,this.options2?.menuOptions,{primary:e,secondary:t},this.options2?.toolbarOptions?.primaryGroup,this.options2?.toolbarOptions?.shouldInlineSubmenu,this.options2?.toolbarOptions?.useSeparatorsInPrimaryActions),t.push(...this.additionalActions),e.unshift(...this.prependedPrimaryActions),this.setActions(e,t)}setPrependedPrimaryActions(e){ii(this.prependedPrimaryActions,e,(t,i)=>t===i)||(this.prependedPrimaryActions=e,this.updateToolbar())}setAdditionalSecondaryActions(e){ii(this.additionalActions,e,(t,i)=>t===i)||(this.additionalActions=e,this.updateToolbar())}};pM=$F([zr(3,qo),zr(4,Ee),zr(5,bo),zr(6,yt),zr(7,Ht),zr(8,jn)],pM);function qx(s,e,t){const i=Si(s);return!(e<i.left||e>i.left+i.width||t<i.top||t>i.top+i.height)}let ySe=class{constructor(e,t,i){this.value=e,this.isComplete=t,this.hasLoadingMessage=i}};class WZ extends B{constructor(e,t){super(),this._editor=e,this._computer=t,this._onResult=this._register(new O),this.onResult=this._onResult.event,this._firstWaitScheduler=this._register(new It(()=>this._triggerAsyncComputation(),0)),this._secondWaitScheduler=this._register(new It(()=>this._triggerSyncComputation(),0)),this._loadingMessageScheduler=this._register(new It(()=>this._triggerLoadingMessage(),0)),this._state=0,this._asyncIterable=null,this._asyncIterableDone=!1,this._result=[]}dispose(){this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),super.dispose()}get _hoverTime(){return this._editor.getOption(60).delay}get _firstWaitTime(){return this._hoverTime/2}get _secondWaitTime(){return this._hoverTime-this._firstWaitTime}get _loadingMessageTime(){return 3*this._hoverTime}_setState(e,t=!0){this._state=e,t&&this._fireResult()}_triggerAsyncComputation(){this._setState(2),this._secondWaitScheduler.schedule(this._secondWaitTime),this._computer.computeAsync?(this._asyncIterableDone=!1,this._asyncIterable=Kee(e=>this._computer.computeAsync(e)),(async()=>{try{for await(const e of this._asyncIterable)e&&(this._result.push(e),this._fireResult());this._asyncIterableDone=!0,(this._state===3||this._state===4)&&this._setState(0)}catch(e){Oe(e)}})()):this._asyncIterableDone=!0}_triggerSyncComputation(){this._computer.computeSync&&(this._result=this._result.concat(this._computer.computeSync())),this._setState(this._asyncIterableDone?0:3)}_triggerLoadingMessage(){this._state===3&&this._setState(4)}_fireResult(){if(this._state===1||this._state===2)return;const e=this._state===0,t=this._state===4;this._onResult.fire(new ySe(this._result.slice(0),e,t))}start(e){if(e===0)this._state===0&&(this._setState(1),this._firstWaitScheduler.schedule(this._firstWaitTime),this._loadingMessageScheduler.schedule(this._loadingMessageTime));else switch(this._state){case 0:this._triggerAsyncComputation(),this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break;case 2:this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break}}cancel(){this._firstWaitScheduler.cancel(),this._secondWaitScheduler.cancel(),this._loadingMessageScheduler.cancel(),this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),this._result=[],this._setState(0,!1)}}class jF{constructor(){this._onDidWillResize=new O,this.onDidWillResize=this._onDidWillResize.event,this._onDidResize=new O,this.onDidResize=this._onDidResize.event,this._sashListener=new Z,this._size=new bt(0,0),this._minSize=new bt(0,0),this._maxSize=new bt(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),this.domNode=document.createElement("div"),this._eastSash=new Hn(this.domNode,{getVerticalSashLeft:()=>this._size.width},{orientation:0}),this._westSash=new Hn(this.domNode,{getVerticalSashLeft:()=>0},{orientation:0}),this._northSash=new Hn(this.domNode,{getHorizontalSashTop:()=>0},{orientation:1,orthogonalEdge:F0.North}),this._southSash=new Hn(this.domNode,{getHorizontalSashTop:()=>this._size.height},{orientation:1,orthogonalEdge:F0.South}),this._northSash.orthogonalStartSash=this._westSash,this._northSash.orthogonalEndSash=this._eastSash,this._southSash.orthogonalStartSash=this._westSash,this._southSash.orthogonalEndSash=this._eastSash;let e,t=0,i=0;this._sashListener.add(se.any(this._northSash.onDidStart,this._eastSash.onDidStart,this._southSash.onDidStart,this._westSash.onDidStart)(()=>{e===void 0&&(this._onDidWillResize.fire(),e=this._size,t=0,i=0)})),this._sashListener.add(se.any(this._northSash.onDidEnd,this._eastSash.onDidEnd,this._southSash.onDidEnd,this._westSash.onDidEnd)(()=>{e!==void 0&&(e=void 0,t=0,i=0,this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(this._eastSash.onDidChange(n=>{e&&(i=n.currentX-n.startX,this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,east:!0}))})),this._sashListener.add(this._westSash.onDidChange(n=>{e&&(i=-(n.currentX-n.startX),this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,west:!0}))})),this._sashListener.add(this._northSash.onDidChange(n=>{e&&(t=-(n.currentY-n.startY),this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,north:!0}))})),this._sashListener.add(this._southSash.onDidChange(n=>{e&&(t=n.currentY-n.startY,this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,south:!0}))})),this._sashListener.add(se.any(this._eastSash.onDidReset,this._westSash.onDidReset)(n=>{this._preferredSize&&(this.layout(this._size.height,this._preferredSize.width),this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(se.any(this._northSash.onDidReset,this._southSash.onDidReset)(n=>{this._preferredSize&&(this.layout(this._preferredSize.height,this._size.width),this._onDidResize.fire({dimension:this._size,done:!0}))}))}dispose(){this._northSash.dispose(),this._southSash.dispose(),this._eastSash.dispose(),this._westSash.dispose(),this._sashListener.dispose(),this._onDidResize.dispose(),this._onDidWillResize.dispose(),this.domNode.remove()}enableSashes(e,t,i,n){this._northSash.state=e?3:0,this._eastSash.state=t?3:0,this._southSash.state=i?3:0,this._westSash.state=n?3:0}layout(e=this.size.height,t=this.size.width){const{height:i,width:n}=this._minSize,{height:o,width:r}=this._maxSize;e=Math.max(i,Math.min(o,e)),t=Math.max(n,Math.min(r,t));const a=new bt(t,e);bt.equals(a,this._size)||(this.domNode.style.height=e+"px",this.domNode.style.width=t+"px",this._size=a,this._northSash.layout(),this._eastSash.layout(),this._southSash.layout(),this._westSash.layout())}clearSashHoverState(){this._eastSash.clearSashHoverState(),this._westSash.clearSashHoverState(),this._northSash.clearSashHoverState(),this._southSash.clearSashHoverState()}get size(){return this._size}set maxSize(e){this._maxSize=e}get maxSize(){return this._maxSize}set minSize(e){this._minSize=e}get minSize(){return this._minSize}set preferredSize(e){this._preferredSize=e}get preferredSize(){return this._preferredSize}}const wSe=30,SSe=24;class LSe extends B{constructor(e,t=new bt(10,10)){super(),this._editor=e,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._resizableNode=this._register(new jF),this._contentPosition=null,this._isResizing=!1,this._resizableNode.domNode.style.position="absolute",this._resizableNode.minSize=bt.lift(t),this._resizableNode.layout(t.height,t.width),this._resizableNode.enableSashes(!0,!0,!0,!0),this._register(this._resizableNode.onDidResize(i=>{this._resize(new bt(i.dimension.width,i.dimension.height)),i.done&&(this._isResizing=!1)})),this._register(this._resizableNode.onDidWillResize(()=>{this._isResizing=!0}))}get isResizing(){return this._isResizing}getDomNode(){return this._resizableNode.domNode}getPosition(){return this._contentPosition}get position(){return this._contentPosition?.position?P.lift(this._contentPosition.position):void 0}_availableVerticalSpaceAbove(e){const t=this._editor.getDomNode(),i=this._editor.getScrolledVisiblePosition(e);return!t||!i?void 0:Si(t).top+i.top-wSe}_availableVerticalSpaceBelow(e){const t=this._editor.getDomNode(),i=this._editor.getScrolledVisiblePosition(e);if(!t||!i)return;const n=Si(t),o=sh(t.ownerDocument.body),r=n.top+i.top+i.height;return o.height-r-SSe}_findPositionPreference(e,t){const i=Math.min(this._availableVerticalSpaceBelow(t)??1/0,e),n=Math.min(this._availableVerticalSpaceAbove(t)??1/0,e),o=Math.min(Math.max(n,i),e),r=Math.min(e,o);let a;return this._editor.getOption(60).above?a=r<=n?1:2:a=r<=i?2:1,a===1?this._resizableNode.enableSashes(!0,!0,!1,!1):this._resizableNode.enableSashes(!1,!0,!0,!1),a}_resize(e){this._resizableNode.layout(e.height,e.width)}}var xSe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},nw=function(s,e){return function(t,i){e(t,i,s)}},ll;const C7=30,kSe=6;let mM=class extends LSe{static{ll=this}static{this.ID="editor.contrib.resizableContentHoverWidget"}static{this._lastDimensions=new bt(0,0)}get isVisibleFromKeyboard(){return this._renderedHover?.source===1}get isVisible(){return this._hoverVisibleKey.get()??!1}get isFocused(){return this._hoverFocusedKey.get()??!1}constructor(e,t,i,n,o){const r=e.getOption(67)+8,a=150,l=new bt(a,r);super(e,l),this._configurationService=i,this._accessibilityService=n,this._keybindingService=o,this._hover=this._register(new R2),this._onDidResize=this._register(new O),this.onDidResize=this._onDidResize.event,this._minimumSize=l,this._hoverVisibleKey=I.hoverVisible.bindTo(t),this._hoverFocusedKey=I.hoverFocused.bindTo(t),X(this._resizableNode.domNode,this._hover.containerDomNode),this._resizableNode.domNode.style.zIndex="50",this._register(this._editor.onDidLayoutChange(()=>{this.isVisible&&this._updateMaxDimensions()})),this._register(this._editor.onDidChangeConfiguration(d=>{d.hasChanged(50)&&this._updateFont()}));const c=this._register(Wa(this._resizableNode.domNode));this._register(c.onDidFocus(()=>{this._hoverFocusedKey.set(!0)})),this._register(c.onDidBlur(()=>{this._hoverFocusedKey.set(!1)})),this._setRenderedHover(void 0),this._editor.addContentWidget(this)}dispose(){super.dispose(),this._renderedHover?.dispose(),this._editor.removeContentWidget(this)}getId(){return ll.ID}static _applyDimensions(e,t,i){const n=typeof t=="number"?`${t}px`:t,o=typeof i=="number"?`${i}px`:i;e.style.width=n,e.style.height=o}_setContentsDomNodeDimensions(e,t){const i=this._hover.contentsDomNode;return ll._applyDimensions(i,e,t)}_setContainerDomNodeDimensions(e,t){const i=this._hover.containerDomNode;return ll._applyDimensions(i,e,t)}_setHoverWidgetDimensions(e,t){this._setContentsDomNodeDimensions(e,t),this._setContainerDomNodeDimensions(e,t),this._layoutContentWidget()}static _applyMaxDimensions(e,t,i){const n=typeof t=="number"?`${t}px`:t,o=typeof i=="number"?`${i}px`:i;e.style.maxWidth=n,e.style.maxHeight=o}_setHoverWidgetMaxDimensions(e,t){ll._applyMaxDimensions(this._hover.contentsDomNode,e,t),ll._applyMaxDimensions(this._hover.containerDomNode,e,t),this._hover.containerDomNode.style.setProperty("--vscode-hover-maxWidth",typeof e=="number"?`${e}px`:e),this._layoutContentWidget()}_setAdjustedHoverWidgetDimensions(e){this._setHoverWidgetMaxDimensions("none","none");const t=e.width,i=e.height;this._setHoverWidgetDimensions(t,i)}_updateResizableNodeMaxDimensions(){const e=this._findMaximumRenderingWidth()??1/0,t=this._findMaximumRenderingHeight()??1/0;this._resizableNode.maxSize=new bt(e,t),this._setHoverWidgetMaxDimensions(e,t)}_resize(e){ll._lastDimensions=new bt(e.width,e.height),this._setAdjustedHoverWidgetDimensions(e),this._resizableNode.layout(e.height,e.width),this._updateResizableNodeMaxDimensions(),this._hover.scrollbar.scanDomNode(),this._editor.layoutContentWidget(this),this._onDidResize.fire()}_findAvailableSpaceVertically(){const e=this._renderedHover?.showAtPosition;if(e)return this._positionPreference===1?this._availableVerticalSpaceAbove(e):this._availableVerticalSpaceBelow(e)}_findMaximumRenderingHeight(){const e=this._findAvailableSpaceVertically();if(!e)return;let t=kSe;return Array.from(this._hover.contentsDomNode.children).forEach(i=>{t+=i.clientHeight}),Math.min(e,t)}_isHoverTextOverflowing(){this._hover.containerDomNode.style.setProperty("--vscode-hover-whiteSpace","nowrap"),this._hover.containerDomNode.style.setProperty("--vscode-hover-sourceWhiteSpace","nowrap");const e=Array.from(this._hover.contentsDomNode.children).some(t=>t.scrollWidth>t.clientWidth);return this._hover.containerDomNode.style.removeProperty("--vscode-hover-whiteSpace"),this._hover.containerDomNode.style.removeProperty("--vscode-hover-sourceWhiteSpace"),e}_findMaximumRenderingWidth(){if(!this._editor||!this._editor.hasModel())return;const e=this._isHoverTextOverflowing(),t=typeof this._contentWidth>"u"?0:this._contentWidth-2;return e||this._hover.containerDomNode.clientWidth<t?sh(this._hover.containerDomNode.ownerDocument.body).width-14:this._hover.containerDomNode.clientWidth+2}isMouseGettingCloser(e,t){if(!this._renderedHover)return!1;if(this._renderedHover.initialMousePosX===void 0||this._renderedHover.initialMousePosY===void 0)return this._renderedHover.initialMousePosX=e,this._renderedHover.initialMousePosY=t,!1;const i=Si(this.getDomNode());this._renderedHover.closestMouseDistance===void 0&&(this._renderedHover.closestMouseDistance=y7(this._renderedHover.initialMousePosX,this._renderedHover.initialMousePosY,i.left,i.top,i.width,i.height));const n=y7(e,t,i.left,i.top,i.width,i.height);return n>this._renderedHover.closestMouseDistance+4?!1:(this._renderedHover.closestMouseDistance=Math.min(this._renderedHover.closestMouseDistance,n),!0)}_setRenderedHover(e){this._renderedHover?.dispose(),this._renderedHover=e,this._hoverVisibleKey.set(!!e),this._hover.containerDomNode.classList.toggle("hidden",!e)}_updateFont(){const{fontSize:e,lineHeight:t}=this._editor.getOption(50),i=this._hover.contentsDomNode;i.style.fontSize=`${e}px`,i.style.lineHeight=`${t/e}`,Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach(o=>this._editor.applyFontInfo(o))}_updateContent(e){const t=this._hover.contentsDomNode;t.style.paddingBottom="",t.textContent="",t.appendChild(e)}_layoutContentWidget(){this._editor.layoutContentWidget(this),this._hover.onContentsChanged()}_updateMaxDimensions(){const e=Math.max(this._editor.getLayoutInfo().height/4,250,ll._lastDimensions.height),t=Math.max(this._editor.getLayoutInfo().width*.66,500,ll._lastDimensions.width);this._setHoverWidgetMaxDimensions(t,e)}_render(e){this._setRenderedHover(e),this._updateFont(),this._updateContent(e.domNode),this._updateMaxDimensions(),this.onContentsChanged(),this._editor.render()}getPosition(){return this._renderedHover?{position:this._renderedHover.showAtPosition,secondaryPosition:this._renderedHover.showAtSecondaryPosition,positionAffinity:this._renderedHover.shouldAppearBeforeContent?3:void 0,preference:[this._positionPreference??1]}:null}show(e){if(!this._editor||!this._editor.hasModel())return;this._render(e);const t=Cc(this._hover.containerDomNode),i=e.showAtPosition;this._positionPreference=this._findPositionPreference(t,i)??1,this.onContentsChanged(),e.shouldFocus&&this._hover.containerDomNode.focus(),this._onDidResize.fire();const o=this._hover.containerDomNode.ownerDocument.activeElement===this._hover.containerDomNode&&yz(this._configurationService.getValue("accessibility.verbosity.hover")===!0&&this._accessibilityService.isScreenReaderOptimized(),this._keybindingService.lookupKeybinding("editor.action.accessibleView")?.getAriaLabel()??"");o&&(this._hover.contentsDomNode.ariaLabel=this._hover.contentsDomNode.textContent+", "+o)}hide(){if(!this._renderedHover)return;const e=this._renderedHover.shouldFocus||this._hoverFocusedKey.get();this._setRenderedHover(void 0),this._resizableNode.maxSize=new bt(1/0,1/0),this._resizableNode.clearSashHoverState(),this._hoverFocusedKey.set(!1),this._editor.layoutContentWidget(this),e&&this._editor.focus()}_removeConstraintsRenderNormally(){const e=this._editor.getLayoutInfo();this._resizableNode.layout(e.height,e.width),this._setHoverWidgetDimensions("auto","auto")}setMinimumDimensions(e){this._minimumSize=new bt(Math.max(this._minimumSize.width,e.width),Math.max(this._minimumSize.height,e.height)),this._updateMinimumWidth()}_updateMinimumWidth(){const e=typeof this._contentWidth>"u"?this._minimumSize.width:Math.min(this._contentWidth,this._minimumSize.width);this._resizableNode.minSize=new bt(e,this._minimumSize.height)}onContentsChanged(){this._removeConstraintsRenderNormally();const e=this._hover.containerDomNode;let t=Cc(e),i=io(e);if(this._resizableNode.layout(t,i),this._setHoverWidgetDimensions(i,t),t=Cc(e),i=io(e),this._contentWidth=i,this._updateMinimumWidth(),this._resizableNode.layout(t,i),this._renderedHover?.showAtPosition){const n=Cc(this._hover.containerDomNode);this._positionPreference=this._findPositionPreference(n,this._renderedHover.showAtPosition)}this._layoutContentWidget()}focus(){this._hover.containerDomNode.focus()}scrollUp(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._editor.getOption(50);this._hover.scrollbar.setScrollPosition({scrollTop:e-t.lineHeight})}scrollDown(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._editor.getOption(50);this._hover.scrollbar.setScrollPosition({scrollTop:e+t.lineHeight})}scrollLeft(){const e=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:e-C7})}scrollRight(){const e=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:e+C7})}pageUp(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:e-t})}pageDown(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:e+t})}goToTop(){this._hover.scrollbar.setScrollPosition({scrollTop:0})}goToBottom(){this._hover.scrollbar.setScrollPosition({scrollTop:this._hover.scrollbar.getScrollDimensions().scrollHeight})}};mM=ll=xSe([nw(1,Ee),nw(2,Ke),nw(3,vo),nw(4,yt)],mM);function y7(s,e,t,i,n,o){const r=t+n/2,a=i+o/2,l=Math.max(Math.abs(s-r)-n/2,0),c=Math.max(Math.abs(e-a)-o/2,0);return Math.sqrt(l*l+c*c)}class TS{get anchor(){return this._anchor}set anchor(e){this._anchor=e}get shouldFocus(){return this._shouldFocus}set shouldFocus(e){this._shouldFocus=e}get source(){return this._source}set source(e){this._source=e}get insistOnKeepingHoverVisible(){return this._insistOnKeepingHoverVisible}set insistOnKeepingHoverVisible(e){this._insistOnKeepingHoverVisible=e}constructor(e,t){this._editor=e,this._participants=t,this._anchor=null,this._shouldFocus=!1,this._source=0,this._insistOnKeepingHoverVisible=!1}static _getLineDecorations(e,t){if(t.type!==1&&!t.supportsMarkerHover)return[];const i=e.getModel(),n=t.range.startLineNumber;if(n>i.getLineCount())return[];const o=i.getLineMaxColumn(n);return e.getLineDecorations(n).filter(r=>{if(r.options.isWholeLine)return!0;const a=r.range.startLineNumber===n?r.range.startColumn:1,l=r.range.endLineNumber===n?r.range.endColumn:o;if(r.options.showIfCollapsed){if(a>t.range.startColumn+1||t.range.endColumn-1>l)return!1}else if(a>t.range.startColumn||t.range.endColumn>l)return!1;return!0})}computeAsync(e){const t=this._anchor;if(!this._editor.hasModel()||!t)return zi.EMPTY;const i=TS._getLineDecorations(this._editor,t);return zi.merge(this._participants.map(n=>n.computeAsync?n.computeAsync(t,i,e):zi.EMPTY))}computeSync(){if(!this._editor.hasModel()||!this._anchor)return[];const e=TS._getLineDecorations(this._editor,this._anchor);let t=[];for(const i of this._participants)t=t.concat(i.computeSync(this._anchor,e));return Yr(t)}}class HZ{constructor(e,t,i){this.anchor=e,this.hoverParts=t,this.isComplete=i}filter(e){const t=this.hoverParts.filter(i=>i.isValidForHoverAnchor(e));return t.length===this.hoverParts.length?this:new DSe(this,this.anchor,t,this.isComplete)}}class DSe extends HZ{constructor(e,t,i,n){super(t,i,n),this.original=e}filter(e){return this.original.filter(e)}}var ISe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},TSe=function(s,e){return function(t,i){e(t,i,s)}};const w7=te;let ES=class extends B{get hasContent(){return this._hasContent}constructor(e){super(),this._keybindingService=e,this.actions=[],this._hasContent=!1,this.hoverElement=w7("div.hover-row.status-bar"),this.hoverElement.tabIndex=0,this.actionsElement=X(this.hoverElement,w7("div.actions"))}addAction(e){const t=this._keybindingService.lookupKeybinding(e.commandId),i=t?t.getLabel():null;this._hasContent=!0;const n=this._register(XL.render(this.actionsElement,e,i));return this.actions.push(n),n}append(e){const t=X(this.actionsElement,e);return this._hasContent=!0,t}};ES=ISe([TSe(0,yt)],ES);class ESe{constructor(e,t,i){this.provider=e,this.hover=t,this.ordinal=i}}async function NSe(s,e,t,i,n){const o=await Promise.resolve(s.provideHover(t,i,n)).catch(Li);if(!(!o||!RSe(o)))return new ESe(s,o,e)}function ZF(s,e,t,i,n=!1){const r=s.ordered(e,n).map((a,l)=>NSe(a,l,e,t,i));return zi.fromPromises(r).coalesce()}function VZ(s,e,t,i,n=!1){return ZF(s,e,t,i,n).map(o=>o.hover).toPromise()}Gs("_executeHoverProvider",(s,e,t)=>{const i=s.get(pe);return VZ(i.hoverProvider,e,t,Ue.None)});Gs("_executeHoverProvider_recursive",(s,e,t)=>{const i=s.get(pe);return VZ(i.hoverProvider,e,t,Ue.None,!0)});function RSe(s){const e=typeof s.range<"u",t=typeof s.contents<"u"&&s.contents&&s.contents.length>0;return e&&t}var MSe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Vh=function(s,e){return function(t,i){e(t,i,s)}};const Bf=te,ASe=Kt("hover-increase-verbosity",J.add,p("increaseHoverVerbosity","Icon for increaseing hover verbosity.")),PSe=Kt("hover-decrease-verbosity",J.remove,p("decreaseHoverVerbosity","Icon for decreasing hover verbosity."));class $r{constructor(e,t,i,n,o,r=void 0){this.owner=e,this.range=t,this.contents=i,this.isBeforeContent=n,this.ordinal=o,this.source=r}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}class zZ{constructor(e,t,i){this.hover=e,this.hoverProvider=t,this.hoverPosition=i}supportsVerbosityAction(e){switch(e){case oo.Increase:return this.hover.canIncreaseVerbosity??!1;case oo.Decrease:return this.hover.canDecreaseVerbosity??!1}}}let qv=class{constructor(e,t,i,n,o,r,a,l){this._editor=e,this._languageService=t,this._openerService=i,this._configurationService=n,this._languageFeaturesService=o,this._keybindingService=r,this._hoverService=a,this._commandService=l,this.hoverOrdinal=3}createLoadingMessage(e){return new $r(this,e.range,[new zn().appendText(p("modesContentHover.loading","Loading..."))],!1,2e3)}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1)return[];const i=this._editor.getModel(),n=e.range.startLineNumber,o=i.getLineMaxColumn(n),r=[];let a=1e3;const l=i.getLineLength(n),c=i.getLanguageIdAtPosition(e.range.startLineNumber,e.range.startColumn),d=this._editor.getOption(118),h=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:c});let u=!1;d>=0&&l>d&&e.range.startColumn>=d&&(u=!0,r.push(new $r(this,e.range,[{value:p("stopped rendering","Rendering paused for long line for performance reasons. This can be configured via `editor.stopRenderingLineAfter`.")}],!1,a++))),!u&&typeof h=="number"&&l>=h&&r.push(new $r(this,e.range,[{value:p("too many characters","Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.")}],!1,a++));let g=!1;for(const f of t){const m=f.range.startLineNumber===n?f.range.startColumn:1,_=f.range.endLineNumber===n?f.range.endColumn:o,b=f.options.hoverMessage;if(!b||Mp(b))continue;f.options.beforeContentClassName&&(g=!0);const v=new k(e.range.startLineNumber,m,e.range.startLineNumber,_);r.push(new $r(this,v,xP(b),g,a++))}return r}computeAsync(e,t,i){if(!this._editor.hasModel()||e.type!==1)return zi.EMPTY;const n=this._editor.getModel(),o=this._languageFeaturesService.hoverProvider;return o.has(n)?this._getMarkdownHovers(o,n,e,i):zi.EMPTY}_getMarkdownHovers(e,t,i,n){const o=i.range.getStartPosition();return ZF(e,t,o,n).filter(l=>!Mp(l.hover.contents)).map(l=>{const c=l.hover.range?k.lift(l.hover.range):i.range,d=new zZ(l.hover,l.provider,o);return new $r(this,c,l.hover.contents,!1,l.ordinal,d)})}renderHoverParts(e,t){return this._renderedHoverParts=new OSe(t,e.fragment,this,this._editor,this._languageService,this._openerService,this._commandService,this._keybindingService,this._hoverService,this._configurationService,e.onContentsChanged),this._renderedHoverParts}updateMarkdownHoverVerbosityLevel(e,t,i){return Promise.resolve(this._renderedHoverParts?.updateMarkdownHoverPartVerbosityLevel(e,t,i))}};qv=MSe([Vh(1,ni),Vh(2,Ys),Vh(3,Ke),Vh(4,pe),Vh(5,yt),Vh(6,Vl),Vh(7,Ht)],qv);class sw{constructor(e,t,i){this.hoverPart=e,this.hoverElement=t,this.disposables=i}dispose(){this.disposables.dispose()}}class OSe{constructor(e,t,i,n,o,r,a,l,c,d,h){this._hoverParticipant=i,this._editor=n,this._languageService=o,this._openerService=r,this._commandService=a,this._keybindingService=l,this._hoverService=c,this._configurationService=d,this._onFinishedRendering=h,this._ongoingHoverOperations=new Map,this._disposables=new Z,this.renderedHoverParts=this._renderHoverParts(e,t,this._onFinishedRendering),this._disposables.add(Ce(()=>{this.renderedHoverParts.forEach(u=>{u.dispose()}),this._ongoingHoverOperations.forEach(u=>{u.tokenSource.dispose(!0)})}))}_renderHoverParts(e,t,i){return e.sort(bs(n=>n.ordinal,qr)),e.map(n=>{const o=this._renderHoverPart(n,i);return t.appendChild(o.hoverElement),o})}_renderHoverPart(e,t){const i=this._renderMarkdownHover(e,t),n=i.hoverElement,o=e.source,r=new Z;if(r.add(i),!o)return new sw(e,n,r);const a=o.supportsVerbosityAction(oo.Increase),l=o.supportsVerbosityAction(oo.Decrease);if(!a&&!l)return new sw(e,n,r);const c=Bf("div.verbosity-actions");return n.prepend(c),r.add(this._renderHoverExpansionAction(c,oo.Increase,a)),r.add(this._renderHoverExpansionAction(c,oo.Decrease,l)),new sw(e,n,r)}_renderMarkdownHover(e,t){return UZ(this._editor,e,this._languageService,this._openerService,t)}_renderHoverExpansionAction(e,t,i){const n=new Z,o=t===oo.Increase,r=X(e,Bf(Ie.asCSSSelector(o?ASe:PSe)));r.tabIndex=0;const a=new Ep("mouse",!1,{target:e,position:{hoverPosition:0}},this._configurationService,this._hoverService);if(n.add(this._hoverService.setupManagedHover(a,r,BSe(this._keybindingService,t))),!i)return r.classList.add("disabled"),n;r.classList.add("enabled");const l=()=>this._commandService.executeCommand(t===oo.Increase?Zx:Kx);return n.add(new wz(r,l)),n.add(new Sz(r,l,[3,10])),n}async updateMarkdownHoverPartVerbosityLevel(e,t,i=!0){const n=this._editor.getModel();if(!n)return;const o=this._getRenderedHoverPartAtIndex(t),r=o?.hoverPart.source;if(!o||!r?.supportsVerbosityAction(e))return;const a=await this._fetchHover(r,n,e);if(!a)return;const l=new zZ(a,r.hoverProvider,r.hoverPosition),c=o.hoverPart,d=new $r(this._hoverParticipant,c.range,a.contents,c.isBeforeContent,c.ordinal,l),h=this._renderHoverPart(d,this._onFinishedRendering);return this._replaceRenderedHoverPartAtIndex(t,h,d),i&&this._focusOnHoverPartWithIndex(t),{hoverPart:d,hoverElement:h.hoverElement}}async _fetchHover(e,t,i){let n=i===oo.Increase?1:-1;const o=e.hoverProvider,r=this._ongoingHoverOperations.get(o);r&&(r.tokenSource.cancel(),n+=r.verbosityDelta);const a=new li;this._ongoingHoverOperations.set(o,{verbosityDelta:n,tokenSource:a});const l={verbosityRequest:{verbosityDelta:n,previousHover:e.hover}};let c;try{c=await Promise.resolve(o.provideHover(t,e.hoverPosition,a.token,l))}catch(d){Li(d)}return a.dispose(),this._ongoingHoverOperations.delete(o),c}_replaceRenderedHoverPartAtIndex(e,t,i){if(e>=this.renderedHoverParts.length||e<0)return;const n=this.renderedHoverParts[e],o=n.hoverElement,r=t.hoverElement,a=Array.from(r.children);o.replaceChildren(...a);const l=new sw(i,o,t.disposables);o.focus(),n.dispose(),this.renderedHoverParts[e]=l}_focusOnHoverPartWithIndex(e){this.renderedHoverParts[e].hoverElement.focus()}_getRenderedHoverPartAtIndex(e){return this.renderedHoverParts[e]}dispose(){this._disposables.dispose()}}function FSe(s,e,t,i,n){e.sort(bs(r=>r.ordinal,qr));const o=[];for(const r of e)o.push(UZ(t,r,i,n,s.onContentsChanged));return new lg(o)}function UZ(s,e,t,i,n){const o=new Z,r=Bf("div.hover-row"),a=Bf("div.hover-row-contents");r.appendChild(a);const l=e.contents;for(const d of l){if(Mp(d))continue;const h=Bf("div.markdown-hover"),u=X(h,Bf("div.hover-contents")),g=o.add(new zc({editor:s},t,i));o.add(g.onDidRenderAsync(()=>{u.className="hover-contents code-hover-contents",n()}));const f=o.add(g.render(d));u.appendChild(f.element),a.appendChild(h)}return{hoverPart:e,hoverElement:r,dispose(){o.dispose()}}}function BSe(s,e){switch(e){case oo.Increase:{const t=s.lookupKeybinding(Zx);return t?p("increaseVerbosityWithKb","Increase Hover Verbosity ({0})",t.getLabel()):p("increaseVerbosity","Increase Hover Verbosity")}case oo.Decrease:{const t=s.lookupKeybinding(Kx);return t?p("decreaseVerbosityWithKb","Decrease Hover Verbosity ({0})",t.getLabel()):p("decreaseVerbosity","Decrease Hover Verbosity")}}}function _M(s,e){return!!s[e]}class hI{constructor(e,t){this.target=e.target,this.isLeftClick=e.event.leftButton,this.isMiddleClick=e.event.middleButton,this.isRightClick=e.event.rightButton,this.hasTriggerModifier=_M(e.event,t.triggerModifier),this.hasSideBySideModifier=_M(e.event,t.triggerSideBySideModifier),this.isNoneOrSingleMouseDown=e.event.detail<=1}}class S7{constructor(e,t){this.keyCodeIsTriggerKey=e.keyCode===t.triggerKey,this.keyCodeIsSideBySideKey=e.keyCode===t.triggerSideBySideKey,this.hasTriggerModifier=_M(e,t.triggerModifier)}}class ow{constructor(e,t,i,n){this.triggerKey=e,this.triggerModifier=t,this.triggerSideBySideKey=i,this.triggerSideBySideModifier=n}equals(e){return this.triggerKey===e.triggerKey&&this.triggerModifier===e.triggerModifier&&this.triggerSideBySideKey===e.triggerSideBySideKey&&this.triggerSideBySideModifier===e.triggerSideBySideModifier}}function L7(s){return s==="altKey"?Qe?new ow(57,"metaKey",6,"altKey"):new ow(5,"ctrlKey",6,"altKey"):Qe?new ow(6,"altKey",57,"metaKey"):new ow(6,"altKey",5,"ctrlKey")}class Gx extends B{constructor(e,t){super(),this._onMouseMoveOrRelevantKeyDown=this._register(new O),this.onMouseMoveOrRelevantKeyDown=this._onMouseMoveOrRelevantKeyDown.event,this._onExecute=this._register(new O),this.onExecute=this._onExecute.event,this._onCancel=this._register(new O),this.onCancel=this._onCancel.event,this._editor=e,this._extractLineNumberFromMouseEvent=t?.extractLineNumberFromMouseEvent??(i=>i.target.position?i.target.position.lineNumber:0),this._opts=L7(this._editor.getOption(78)),this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._register(this._editor.onDidChangeConfiguration(i=>{if(i.hasChanged(78)){const n=L7(this._editor.getOption(78));if(this._opts.equals(n))return;this._opts=n,this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._onCancel.fire()}})),this._register(this._editor.onMouseMove(i=>this._onEditorMouseMove(new hI(i,this._opts)))),this._register(this._editor.onMouseDown(i=>this._onEditorMouseDown(new hI(i,this._opts)))),this._register(this._editor.onMouseUp(i=>this._onEditorMouseUp(new hI(i,this._opts)))),this._register(this._editor.onKeyDown(i=>this._onEditorKeyDown(new S7(i,this._opts)))),this._register(this._editor.onKeyUp(i=>this._onEditorKeyUp(new S7(i,this._opts)))),this._register(this._editor.onMouseDrag(()=>this._resetHandler())),this._register(this._editor.onDidChangeCursorSelection(i=>this._onDidChangeCursorSelection(i))),this._register(this._editor.onDidChangeModel(i=>this._resetHandler())),this._register(this._editor.onDidChangeModelContent(()=>this._resetHandler())),this._register(this._editor.onDidScrollChange(i=>{(i.scrollTopChanged||i.scrollLeftChanged)&&this._resetHandler()}))}_onDidChangeCursorSelection(e){e.selection&&e.selection.startColumn!==e.selection.endColumn&&this._resetHandler()}_onEditorMouseMove(e){this._lastMouseMoveEvent=e,this._onMouseMoveOrRelevantKeyDown.fire([e,null])}_onEditorMouseDown(e){this._hasTriggerKeyOnMouseDown=e.hasTriggerModifier,this._lineNumberOnMouseDown=this._extractLineNumberFromMouseEvent(e)}_onEditorMouseUp(e){const t=this._extractLineNumberFromMouseEvent(e);this._hasTriggerKeyOnMouseDown&&this._lineNumberOnMouseDown&&this._lineNumberOnMouseDown===t&&this._onExecute.fire(e)}_onEditorKeyDown(e){this._lastMouseMoveEvent&&(e.keyCodeIsTriggerKey||e.keyCodeIsSideBySideKey&&e.hasTriggerModifier)?this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent,e]):e.hasTriggerModifier&&this._onCancel.fire()}_onEditorKeyUp(e){e.keyCodeIsTriggerKey&&this._onCancel.fire()}_resetHandler(){this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}}class $Z{constructor(e,t){this.range=e,this.direction=t}}class KF{constructor(e,t,i){this.hint=e,this.anchor=t,this.provider=i,this._isResolved=!1}with(e){const t=new KF(this.hint,e.anchor,this.provider);return t._isResolved=this._isResolved,t._currentResolve=this._currentResolve,t}async resolve(e){if(typeof this.provider.resolveInlayHint=="function"){if(this._currentResolve)return await this._currentResolve,e.isCancellationRequested?void 0:this.resolve(e);this._isResolved||(this._currentResolve=this._doResolve(e).finally(()=>this._currentResolve=void 0)),await this._currentResolve}}async _doResolve(e){try{const t=await Promise.resolve(this.provider.resolveInlayHint(this.hint,e));this.hint.tooltip=t?.tooltip??this.hint.tooltip,this.hint.label=t?.label??this.hint.label,this.hint.textEdits=t?.textEdits??this.hint.textEdits,this._isResolved=!0}catch(t){Li(t),this._isResolved=!1}}}class gp{static{this._emptyInlayHintList=Object.freeze({dispose(){},hints:[]})}static async create(e,t,i,n){const o=[],r=e.ordered(t).reverse().map(a=>i.map(async l=>{try{const c=await a.provideInlayHints(t,l,n);(c?.hints.length||a.onDidChangeInlayHints)&&o.push([c??gp._emptyInlayHintList,a])}catch(c){Li(c)}}));if(await Promise.all(r.flat()),n.isCancellationRequested||t.isDisposed())throw new Xr;return new gp(i,o,t)}constructor(e,t,i){this._disposables=new Z,this.ranges=e,this.provider=new Set;const n=[];for(const[o,r]of t){this._disposables.add(o),this.provider.add(r);for(const a of o.hints){const l=i.validatePosition(a.position);let c="before";const d=gp._getRangeAtPosition(i,l);let h;d.getStartPosition().isBefore(l)?(h=k.fromPositions(d.getStartPosition(),l),c="after"):(h=k.fromPositions(l,d.getEndPosition()),c="before"),n.push(new KF(a,new $Z(h,c),r))}}this.items=n.sort((o,r)=>P.compare(o.hint.position,r.hint.position))}dispose(){this._disposables.dispose()}static _getRangeAtPosition(e,t){const i=t.lineNumber,n=e.getWordAtPosition(t);if(n)return new k(i,n.startColumn,i,n.endColumn);e.tokenization.tokenizeIfCheap(i);const o=e.tokenization.getLineTokens(i),r=t.column-1,a=o.findTokenIndexAtOffset(r);let l=o.getStartOffset(a),c=o.getEndOffset(a);return c-l===1&&(l===r&&a>1?(l=o.getStartOffset(a-1),c=o.getEndOffset(a-1)):c===r&&a<o.getCount()-1&&(l=o.getStartOffset(a+1),c=o.getEndOffset(a+1))),new k(i,l+1,i,c+1)}}function WSe(s){return Se.from({scheme:Fe.command,path:s.id,query:s.arguments&&encodeURIComponent(JSON.stringify(s.arguments))}).toString()}var HSe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Xl=function(s,e){return function(t,i){e(t,i,s)}};let ta=class extends Pv{constructor(e,t,i,n,o,r,a,l,c,d,h,u,g){super(e,{...n.getRawOptions(),overflowWidgetsDomNode:n.getOverflowWidgetsDomNode()},i,o,r,a,l,c,d,h,u,g),this._parentEditor=n,this._overwriteOptions=t,super.updateOptions(this._overwriteOptions),this._register(n.onDidChangeConfiguration(f=>this._onParentConfigurationChanged(f)))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(e){fL(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}};ta=HSe([Xl(4,ye),Xl(5,ft),Xl(6,Ht),Xl(7,Ee),Xl(8,Ki),Xl(9,Ii),Xl(10,vo),Xl(11,di),Xl(12,pe)],ta);const x7=new G(new dt(0,122,204)),VSe={showArrow:!0,showFrame:!0,className:"",frameColor:x7,arrowColor:x7,keepEditorSelection:!1},zSe="vs.editor.contrib.zoneWidget";class USe{constructor(e,t,i,n,o,r,a,l){this.id="",this.domNode=e,this.afterLineNumber=t,this.afterColumn=i,this.heightInLines=n,this.showInHiddenAreas=a,this.ordinal=l,this._onDomNodeTop=o,this._onComputedHeight=r}onDomNodeTop(e){this._onDomNodeTop(e)}onComputedHeight(e){this._onComputedHeight(e)}}class $Se{constructor(e,t){this._id=e,this._domNode=t}getId(){return this._id}getDomNode(){return this._domNode}getPosition(){return null}}class qF{static{this._IdGenerator=new z2(".arrow-decoration-")}constructor(e){this._editor=e,this._ruleName=qF._IdGenerator.nextId(),this._decorations=this._editor.createDecorationsCollection(),this._color=null,this._height=-1}dispose(){this.hide(),aE(this._ruleName)}set color(e){this._color!==e&&(this._color=e,this._updateStyle())}set height(e){this._height!==e&&(this._height=e,this._updateStyle())}_updateStyle(){aE(this._ruleName),U1(`.monaco-editor ${this._ruleName}`,`border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px !important; margin-left: -${this._height}px; `)}show(e){e.column===1&&(e={lineNumber:e.lineNumber,column:2}),this._decorations.set([{range:k.fromPositions(e),options:{description:"zone-widget-arrow",className:this._ruleName,stickiness:1}}])}hide(){this._decorations.clear()}}class jSe{constructor(e,t={}){this._arrow=null,this._overlayWidget=null,this._resizeSash=null,this._viewZone=null,this._disposables=new Z,this.container=null,this._isShowing=!1,this.editor=e,this._positionMarkerId=this.editor.createDecorationsCollection(),this.options=lc(t),fL(this.options,VSe,!1),this.domNode=document.createElement("div"),this.options.isAccessible||(this.domNode.setAttribute("aria-hidden","true"),this.domNode.setAttribute("role","presentation")),this._disposables.add(this.editor.onDidLayoutChange(i=>{const n=this._getWidth(i);this.domNode.style.width=n+"px",this.domNode.style.left=this._getLeft(i)+"px",this._onWidth(n)}))}dispose(){this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._viewZone&&this.editor.changeViewZones(e=>{this._viewZone&&e.removeZone(this._viewZone.id),this._viewZone=null}),this._positionMarkerId.clear(),this._disposables.dispose()}create(){this.domNode.classList.add("zone-widget"),this.options.className&&this.domNode.classList.add(this.options.className),this.container=document.createElement("div"),this.container.classList.add("zone-widget-container"),this.domNode.appendChild(this.container),this.options.showArrow&&(this._arrow=new qF(this.editor),this._disposables.add(this._arrow)),this._fillContainer(this.container),this._initSash(),this._applyStyles()}style(e){e.frameColor&&(this.options.frameColor=e.frameColor),e.arrowColor&&(this.options.arrowColor=e.arrowColor),this._applyStyles()}_applyStyles(){if(this.container&&this.options.frameColor){const e=this.options.frameColor.toString();this.container.style.borderTopColor=e,this.container.style.borderBottomColor=e}if(this._arrow&&this.options.arrowColor){const e=this.options.arrowColor.toString();this._arrow.color=e}}_getWidth(e){return e.width-e.minimap.minimapWidth-e.verticalScrollbarWidth}_getLeft(e){return e.minimap.minimapWidth>0&&e.minimap.minimapLeft===0?e.minimap.minimapWidth:0}_onViewZoneTop(e){this.domNode.style.top=e+"px"}_onViewZoneHeight(e){if(this.domNode.style.height=`${e}px`,this.container){const t=e-this._decoratingElementsHeight();this.container.style.height=`${t}px`;const i=this.editor.getLayoutInfo();this._doLayout(t,this._getWidth(i))}this._resizeSash?.layout()}get position(){const e=this._positionMarkerId.getRange(0);if(e)return e.getStartPosition()}show(e,t){const i=k.isIRange(e)?k.lift(e):k.fromPositions(e);this._isShowing=!0,this._showImpl(i,t),this._isShowing=!1,this._positionMarkerId.set([{range:i,options:We.EMPTY}])}hide(){this._viewZone&&(this.editor.changeViewZones(e=>{this._viewZone&&e.removeZone(this._viewZone.id)}),this._viewZone=null),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._arrow?.hide(),this._positionMarkerId.clear()}_decoratingElementsHeight(){const e=this.editor.getOption(67);let t=0;if(this.options.showArrow){const i=Math.round(e/3);t+=2*i}if(this.options.showFrame){const i=Math.round(e/9);t+=2*i}return t}_showImpl(e,t){const i=e.getStartPosition(),n=this.editor.getLayoutInfo(),o=this._getWidth(n);this.domNode.style.width=`${o}px`,this.domNode.style.left=this._getLeft(n)+"px";const r=document.createElement("div");r.style.overflow="hidden";const a=this.editor.getOption(67);if(!this.options.allowUnlimitedHeight){const u=Math.max(12,this.editor.getLayoutInfo().height/a*.8);t=Math.min(t,u)}let l=0,c=0;if(this._arrow&&this.options.showArrow&&(l=Math.round(a/3),this._arrow.height=l,this._arrow.show(i)),this.options.showFrame&&(c=Math.round(a/9)),this.editor.changeViewZones(u=>{this._viewZone&&u.removeZone(this._viewZone.id),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this.domNode.style.top="-1000px",this._viewZone=new USe(r,i.lineNumber,i.column,t,g=>this._onViewZoneTop(g),g=>this._onViewZoneHeight(g),this.options.showInHiddenAreas,this.options.ordinal),this._viewZone.id=u.addZone(this._viewZone),this._overlayWidget=new $Se(zSe+this._viewZone.id,this.domNode),this.editor.addOverlayWidget(this._overlayWidget)}),this.container&&this.options.showFrame){const u=this.options.frameWidth?this.options.frameWidth:c;this.container.style.borderTopWidth=u+"px",this.container.style.borderBottomWidth=u+"px"}const d=t*a-this._decoratingElementsHeight();this.container&&(this.container.style.top=l+"px",this.container.style.height=d+"px",this.container.style.overflow="hidden"),this._doLayout(d,o),this.options.keepEditorSelection||this.editor.setSelection(e);const h=this.editor.getModel();if(h){const u=h.validateRange(new k(e.startLineNumber,1,e.endLineNumber+1,1));this.revealRange(u,u.startLineNumber===h.getLineCount())}}revealRange(e,t){t?this.editor.revealLineNearTop(e.endLineNumber,0):this.editor.revealRange(e,0)}setCssClass(e,t){this.container&&(t&&this.container.classList.remove(t),this.container.classList.add(e))}_onWidth(e){}_doLayout(e,t){}_relayout(e){this._viewZone&&this._viewZone.heightInLines!==e&&this.editor.changeViewZones(t=>{this._viewZone&&(this._viewZone.heightInLines=e,t.layoutZone(this._viewZone.id))})}_initSash(){if(this._resizeSash)return;this._resizeSash=this._disposables.add(new Hn(this.domNode,this,{orientation:1})),this.options.isResizeable||(this._resizeSash.state=0);let e;this._disposables.add(this._resizeSash.onDidStart(t=>{this._viewZone&&(e={startY:t.startY,heightInLines:this._viewZone.heightInLines})})),this._disposables.add(this._resizeSash.onDidEnd(()=>{e=void 0})),this._disposables.add(this._resizeSash.onDidChange(t=>{if(e){const i=(t.currentY-e.startY)/this.editor.getOption(67),n=i<0?Math.ceil(i):Math.floor(i),o=e.heightInLines+n;o>5&&o<35&&this._relayout(o)}}))}getHorizontalSashLeft(){return 0}getHorizontalSashTop(){return(this.domNode.style.height===null?0:parseInt(this.domNode.style.height))-this._decoratingElementsHeight()/2}getHorizontalSashWidth(){const e=this.editor.getLayoutInfo();return e.width-e.minimap.minimapWidth}}var jZ=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},ZZ=function(s,e){return function(t,i){e(t,i,s)}};const KZ=Je("IPeekViewService");nt(KZ,class{constructor(){this._widgets=new Map}addExclusiveWidget(s,e){const t=this._widgets.get(s);t&&(t.listener.dispose(),t.widget.dispose());const i=()=>{const n=this._widgets.get(s);n&&n.widget===e&&(n.listener.dispose(),this._widgets.delete(s))};this._widgets.set(s,{widget:e,listener:e.onDidClose(i)})}},1);var Zs;(function(s){s.inPeekEditor=new le("inReferenceSearchEditor",!0,p("inReferenceSearchEditor","Whether the current code editor is embedded inside peek")),s.notInPeekEditor=s.inPeekEditor.toNegated()})(Zs||(Zs={}));let NS=class{static{this.ID="editor.contrib.referenceController"}constructor(e,t){e instanceof ta&&Zs.inPeekEditor.bindTo(t)}dispose(){}};NS=jZ([ZZ(1,Ee)],NS);ct(NS.ID,NS,0);function ZSe(s){const e=s.get(ft).getFocusedCodeEditor();return e instanceof ta?e.getParentEditor():e}const KSe={headerBackgroundColor:G.white,primaryHeadingColor:G.fromHex("#333333"),secondaryHeadingColor:G.fromHex("#6c6c6cb3")};let RS=class extends jSe{constructor(e,t,i){super(e,t),this.instantiationService=i,this._onDidClose=new O,this.onDidClose=this._onDidClose.event,fL(this.options,KSe,!1)}dispose(){this.disposed||(this.disposed=!0,super.dispose(),this._onDidClose.fire(this))}style(e){const t=this.options;e.headerBackgroundColor&&(t.headerBackgroundColor=e.headerBackgroundColor),e.primaryHeadingColor&&(t.primaryHeadingColor=e.primaryHeadingColor),e.secondaryHeadingColor&&(t.secondaryHeadingColor=e.secondaryHeadingColor),super.style(e)}_applyStyles(){super._applyStyles();const e=this.options;this._headElement&&e.headerBackgroundColor&&(this._headElement.style.backgroundColor=e.headerBackgroundColor.toString()),this._primaryHeading&&e.primaryHeadingColor&&(this._primaryHeading.style.color=e.primaryHeadingColor.toString()),this._secondaryHeading&&e.secondaryHeadingColor&&(this._secondaryHeading.style.color=e.secondaryHeadingColor.toString()),this._bodyElement&&e.frameColor&&(this._bodyElement.style.borderColor=e.frameColor.toString())}_fillContainer(e){this.setCssClass("peekview-widget"),this._headElement=te(".head"),this._bodyElement=te(".body"),this._fillHead(this._headElement),this._fillBody(this._bodyElement),e.appendChild(this._headElement),e.appendChild(this._bodyElement)}_fillHead(e,t){this._titleElement=te(".peekview-title"),this.options.supportOnTitleClick&&(this._titleElement.classList.add("clickable"),gi(this._titleElement,"click",o=>this._onTitleClick(o))),X(this._headElement,this._titleElement),this._fillTitleIcon(this._titleElement),this._primaryHeading=te("span.filename"),this._secondaryHeading=te("span.dirname"),this._metaHeading=te("span.meta"),X(this._titleElement,this._primaryHeading,this._secondaryHeading,this._metaHeading);const i=te(".peekview-actions");X(this._headElement,i);const n=this._getActionBarOptions();this._actionbarWidget=new zo(i,n),this._disposables.add(this._actionbarWidget),t||this._actionbarWidget.push(new ho("peekview.close",p("label.close","Close"),Ie.asClassName(J.close),!0,()=>(this.dispose(),Promise.resolve())),{label:!1,icon:!0})}_fillTitleIcon(e){}_getActionBarOptions(){return{actionViewItemProvider:lU.bind(void 0,this.instantiationService),orientation:0}}_onTitleClick(e){}setTitle(e,t){this._primaryHeading&&this._secondaryHeading&&(this._primaryHeading.innerText=e,this._primaryHeading.setAttribute("title",e),t?this._secondaryHeading.innerText=t:Cn(this._secondaryHeading))}setMetaTitle(e){this._metaHeading&&(e?(this._metaHeading.innerText=e,ro(this._metaHeading)):ds(this._metaHeading))}_doLayout(e,t){if(!this._isShowing&&e<0){this.dispose();return}const i=Math.ceil(this.editor.getOption(67)*1.2),n=Math.round(e-(i+2));this._doLayoutHead(i,t),this._doLayoutBody(n,t)}_doLayoutHead(e,t){this._headElement&&(this._headElement.style.height=`${e}px`,this._headElement.style.lineHeight=this._headElement.style.height)}_doLayoutBody(e,t){this._bodyElement&&(this._bodyElement.style.height=`${e}px`)}};RS=jZ([ZZ(2,ye)],RS);const qSe=E("peekViewTitle.background",{dark:"#252526",light:"#F3F3F3",hcDark:G.black,hcLight:G.white},p("peekViewTitleBackground","Background color of the peek view title area.")),qZ=E("peekViewTitleLabel.foreground",{dark:G.white,light:G.black,hcDark:G.white,hcLight:Hl},p("peekViewTitleForeground","Color of the peek view title.")),GZ=E("peekViewTitleDescription.foreground",{dark:"#ccccccb3",light:"#616161",hcDark:"#FFFFFF99",hcLight:"#292929"},p("peekViewTitleInfoForeground","Color of the peek view title info.")),GSe=E("peekView.border",{dark:El,light:El,hcDark:lt,hcLight:lt},p("peekViewBorder","Color of the peek view borders and arrow.")),YSe=E("peekViewResult.background",{dark:"#252526",light:"#F3F3F3",hcDark:G.black,hcLight:G.white},p("peekViewResultsBackground","Background color of the peek view result list."));E("peekViewResult.lineForeground",{dark:"#bbbbbb",light:"#646465",hcDark:G.white,hcLight:Hl},p("peekViewResultsMatchForeground","Foreground color for line nodes in the peek view result list."));E("peekViewResult.fileForeground",{dark:G.white,light:"#1E1E1E",hcDark:G.white,hcLight:Hl},p("peekViewResultsFileForeground","Foreground color for file nodes in the peek view result list."));E("peekViewResult.selectionBackground",{dark:"#3399ff33",light:"#3399ff33",hcDark:null,hcLight:null},p("peekViewResultsSelectionBackground","Background color of the selected entry in the peek view result list."));E("peekViewResult.selectionForeground",{dark:G.white,light:"#6C6C6C",hcDark:G.white,hcLight:Hl},p("peekViewResultsSelectionForeground","Foreground color of the selected entry in the peek view result list."));const YZ=E("peekViewEditor.background",{dark:"#001F33",light:"#F2F8FC",hcDark:G.black,hcLight:G.white},p("peekViewEditorBackground","Background color of the peek view editor."));E("peekViewEditorGutter.background",YZ,p("peekViewEditorGutterBackground","Background color of the gutter in the peek view editor."));E("peekViewEditorStickyScroll.background",YZ,p("peekViewEditorStickScrollBackground","Background color of sticky scroll in the peek view editor."));E("peekViewResult.matchHighlightBackground",{dark:"#ea5c004d",light:"#ea5c004d",hcDark:null,hcLight:null},p("peekViewResultsMatchHighlight","Match highlight color in the peek view result list."));E("peekViewEditor.matchHighlightBackground",{dark:"#ff8f0099",light:"#f5d802de",hcDark:null,hcLight:null},p("peekViewEditorMatchHighlight","Match highlight color in the peek view editor."));E("peekViewEditor.matchHighlightBorder",{dark:null,light:null,hcDark:Xt,hcLight:Xt},p("peekViewEditorMatchHighlightBorder","Match highlight border in the peek view editor."));class ph{constructor(e,t,i,n){this.isProviderFirst=e,this.parent=t,this.link=i,this._rangeCallback=n,this.id=$E.nextId()}get uri(){return this.link.uri}get range(){return this._range??this.link.targetSelectionRange??this.link.range}set range(e){this._range=e,this._rangeCallback(this)}get ariaMessage(){const e=this.parent.getPreview(this)?.preview(this.range);return e?p({key:"aria.oneReference.preview",comment:["Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code"]},"{0} in {1} on line {2} at column {3}",e.value,wr(this.uri),this.range.startLineNumber,this.range.startColumn):p("aria.oneReference","in {0} on line {1} at column {2}",wr(this.uri),this.range.startLineNumber,this.range.startColumn)}}class XSe{constructor(e){this._modelReference=e}dispose(){this._modelReference.dispose()}preview(e,t=8){const i=this._modelReference.object.textEditorModel;if(!i)return;const{startLineNumber:n,startColumn:o,endLineNumber:r,endColumn:a}=e,l=i.getWordUntilPosition({lineNumber:n,column:o-t}),c=new k(n,l.startColumn,n,o),d=new k(r,a,r,1073741824),h=i.getValueInRange(c).replace(/^\s+/,""),u=i.getValueInRange(e),g=i.getValueInRange(d).replace(/\s+$/,"");return{value:h+u+g,highlight:{start:h.length,end:h.length+u.length}}}}class Gv{constructor(e,t){this.parent=e,this.uri=t,this.children=[],this._previews=new Ui}dispose(){At(this._previews.values()),this._previews.clear()}getPreview(e){return this._previews.get(e.uri)}get ariaMessage(){const e=this.children.length;return e===1?p("aria.fileReferences.1","1 symbol in {0}, full path {1}",wr(this.uri),this.uri.fsPath):p("aria.fileReferences.N","{0} symbols in {1}, full path {2}",e,wr(this.uri),this.uri.fsPath)}async resolve(e){if(this._previews.size!==0)return this;for(const t of this.children)if(!this._previews.has(t.uri))try{const i=await e.createModelReference(t.uri);this._previews.set(t.uri,new XSe(i))}catch(i){Oe(i)}return this}}class fo{constructor(e,t){this.groups=[],this.references=[],this._onDidChangeReferenceRange=new O,this.onDidChangeReferenceRange=this._onDidChangeReferenceRange.event,this._links=e,this._title=t;const[i]=e;e.sort(fo._compareReferences);let n;for(const o of e)if((!n||!Qt.isEqual(n.uri,o.uri,!0))&&(n=new Gv(this,o.uri),this.groups.push(n)),n.children.length===0||fo._compareReferences(o,n.children[n.children.length-1])!==0){const r=new ph(i===o,n,o,a=>this._onDidChangeReferenceRange.fire(a));this.references.push(r),n.children.push(r)}}dispose(){At(this.groups),this._onDidChangeReferenceRange.dispose(),this.groups.length=0}clone(){return new fo(this._links,this._title)}get title(){return this._title}get isEmpty(){return this.groups.length===0}get ariaMessage(){return this.isEmpty?p("aria.result.0","No results found"):this.references.length===1?p("aria.result.1","Found 1 symbol in {0}",this.references[0].uri.fsPath):this.groups.length===1?p("aria.result.n1","Found {0} symbols in {1}",this.references.length,this.groups[0].uri.fsPath):p("aria.result.nm","Found {0} symbols in {1} files",this.references.length,this.groups.length)}nextOrPreviousReference(e,t){const{parent:i}=e;let n=i.children.indexOf(e);const o=i.children.length,r=i.parent.groups.length;return r===1||t&&n+1<o||!t&&n>0?(t?n=(n+1)%o:n=(n+o-1)%o,i.children[n]):(n=i.parent.groups.indexOf(i),t?(n=(n+1)%r,i.parent.groups[n].children[0]):(n=(n+r-1)%r,i.parent.groups[n].children[i.parent.groups[n].children.length-1]))}nearestReference(e,t){const i=this.references.map((n,o)=>({idx:o,prefixLen:th(n.uri.toString(),e.toString()),offsetDist:Math.abs(n.range.startLineNumber-t.lineNumber)*100+Math.abs(n.range.startColumn-t.column)})).sort((n,o)=>n.prefixLen>o.prefixLen?-1:n.prefixLen<o.prefixLen?1:n.offsetDist<o.offsetDist?-1:n.offsetDist>o.offsetDist?1:0)[0];if(i)return this.references[i.idx]}referenceAt(e,t){for(const i of this.references)if(i.uri.toString()===e.toString()&&k.containsPosition(i.range,t))return i}firstReference(){for(const e of this.references)if(e.isProviderFirst)return e;return this.references[0]}static _compareReferences(e,t){return Qt.compare(e.uri,t.uri)||k.compareRangesUsingStarts(e.range,t.range)}}var Yx=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Xx=function(s,e){return function(t,i){e(t,i,s)}},bM;let vM=class{constructor(e){this._resolverService=e}hasChildren(e){return e instanceof fo||e instanceof Gv}getChildren(e){if(e instanceof fo)return e.groups;if(e instanceof Gv)return e.resolve(this._resolverService).then(t=>t.children);throw new Error("bad tree")}};vM=Yx([Xx(0,qs)],vM);class QSe{getHeight(){return 23}getTemplateId(e){return e instanceof Gv?MS.id:Qx.id}}let CM=class{constructor(e){this._keybindingService=e}getKeyboardNavigationLabel(e){if(e instanceof ph){const t=e.parent.getPreview(e)?.preview(e.range);if(t)return t.value}return wr(e.uri)}};CM=Yx([Xx(0,yt)],CM);class JSe{getId(e){return e instanceof ph?e.id:e.uri}}let yM=class extends B{constructor(e,t){super(),this._labelService=t;const i=document.createElement("div");i.classList.add("reference-file"),this.file=this._register(new Z0(i,{supportHighlights:!0})),this.badge=new FN(X(i,te(".count")),{},rU),e.appendChild(i)}set(e,t){const i=JL(e.uri);this.file.setLabel(this._labelService.getUriBasenameLabel(e.uri),this._labelService.getUriLabel(i,{relative:!0}),{title:this._labelService.getUriLabel(e.uri),matches:t});const n=e.children.length;this.badge.setCount(n),n>1?this.badge.setTitleFormat(p("referencesCount","{0} references",n)):this.badge.setTitleFormat(p("referenceCount","{0} reference",n))}};yM=Yx([Xx(1,Pp)],yM);let MS=class{static{bM=this}static{this.id="FileReferencesRenderer"}constructor(e){this._instantiationService=e,this.templateId=bM.id}renderTemplate(e){return this._instantiationService.createInstance(yM,e)}renderElement(e,t,i){i.set(e.element,IC(e.filterData))}disposeTemplate(e){e.dispose()}};MS=bM=Yx([Xx(0,ye)],MS);class eLe extends B{constructor(e){super(),this.label=this._register(new Yd(e))}set(e,t){const i=e.parent.getPreview(e)?.preview(e.range);if(!i||!i.value)this.label.set(`${wr(e.uri)}:${e.range.startLineNumber+1}:${e.range.startColumn+1}`);else{const{value:n,highlight:o}=i;t&&!Aa.isDefault(t)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(n,IC(t))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(n,[o]))}}}class Qx{constructor(){this.templateId=Qx.id}static{this.id="OneReferenceRenderer"}renderTemplate(e){return new eLe(e)}renderElement(e,t,i){i.set(e.element,e.filterData)}disposeTemplate(e){e.dispose()}}class tLe{getWidgetAriaLabel(){return p("treeAriaLabel","References")}getAriaLabel(e){return e.ariaMessage}}var iLe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Yg=function(s,e){return function(t,i){e(t,i,s)}};class GF{static{this.DecorationOptions=We.register({description:"reference-decoration",stickiness:1,className:"reference-decoration"})}constructor(e,t){this._editor=e,this._model=t,this._decorations=new Map,this._decorationIgnoreSet=new Set,this._callOnDispose=new Z,this._callOnModelChange=new Z,this._callOnDispose.add(this._editor.onDidChangeModel(()=>this._onModelChanged())),this._onModelChanged()}dispose(){this._callOnModelChange.dispose(),this._callOnDispose.dispose(),this.removeDecorations()}_onModelChanged(){this._callOnModelChange.clear();const e=this._editor.getModel();if(e){for(const t of this._model.references)if(t.uri.toString()===e.uri.toString()){this._addDecorations(t.parent);return}}}_addDecorations(e){if(!this._editor.hasModel())return;this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(()=>this._onDecorationChanged()));const t=[],i=[];for(let n=0,o=e.children.length;n<o;n++){const r=e.children[n];this._decorationIgnoreSet.has(r.id)||r.uri.toString()===this._editor.getModel().uri.toString()&&(t.push({range:r.range,options:GF.DecorationOptions}),i.push(n))}this._editor.changeDecorations(n=>{const o=n.deltaDecorations([],t);for(let r=0;r<o.length;r++)this._decorations.set(o[r],e.children[i[r]])})}_onDecorationChanged(){const e=[],t=this._editor.getModel();if(t){for(const[i,n]of this._decorations){const o=t.getDecorationRange(i);if(!o)continue;let r=!1;if(!k.equalsRange(o,n.range)){if(k.spansMultipleLines(o))r=!0;else{const a=n.range.endColumn-n.range.startColumn,l=o.endColumn-o.startColumn;a!==l&&(r=!0)}r?(this._decorationIgnoreSet.add(n.id),e.push(i)):n.range=o}}for(let i=0,n=e.length;i<n;i++)this._decorations.delete(e[i]);this._editor.removeDecorations(e)}}removeDecorations(){this._editor.removeDecorations([...this._decorations.keys()]),this._decorations.clear()}}class nLe{constructor(){this.ratio=.7,this.heightInLines=18}static fromJSON(e){let t,i;try{const n=JSON.parse(e);t=n.ratio,i=n.heightInLines}catch{}return{ratio:t||.7,heightInLines:i||18}}}class sLe extends zN{}let wM=class extends RS{constructor(e,t,i,n,o,r,a,l,c){super(e,{showFrame:!1,showArrow:!0,isResizeable:!0,isAccessible:!0,supportOnTitleClick:!0},r),this._defaultTreeKeyboardSupport=t,this.layoutData=i,this._textModelResolverService=o,this._instantiationService=r,this._peekViewService=a,this._uriLabel=l,this._keybindingService=c,this._disposeOnNewModel=new Z,this._callOnDispose=new Z,this._onDidSelectReference=new O,this.onDidSelectReference=this._onDidSelectReference.event,this._dim=new bt(0,0),this._isClosing=!1,this._applyTheme(n.getColorTheme()),this._callOnDispose.add(n.onDidColorThemeChange(this._applyTheme.bind(this))),this._peekViewService.addExclusiveWidget(e,this),this.create()}get isClosing(){return this._isClosing}dispose(){this._isClosing=!0,this.setModel(void 0),this._callOnDispose.dispose(),this._disposeOnNewModel.dispose(),At(this._preview),At(this._previewNotAvailableMessage),At(this._tree),At(this._previewModelReference),this._splitView.dispose(),super.dispose()}_applyTheme(e){const t=e.getColor(GSe)||G.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(qSe)||G.transparent,primaryHeadingColor:e.getColor(qZ),secondaryHeadingColor:e.getColor(GZ)})}show(e){super.show(e,this.layoutData.heightInLines||18)}focusOnReferenceTree(){this._tree.domFocus()}focusOnPreviewEditor(){this._preview.focus()}isPreviewEditorFocused(){return this._preview.hasTextFocus()}_onTitleClick(e){this._preview&&this._preview.getModel()&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:e.ctrlKey||e.metaKey||e.altKey?"side":"open",source:"title"})}_fillBody(e){this.setCssClass("reference-zone-widget"),this._messageContainer=X(e,te("div.messages")),ds(this._messageContainer),this._splitView=new QU(e,{orientation:1}),this._previewContainer=X(e,te("div.preview.inline"));const t={scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!0},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}};this._preview=this._instantiationService.createInstance(ta,this._previewContainer,t,{},this.editor),ds(this._previewContainer),this._previewNotAvailableMessage=this._instantiationService.createInstance(Da,p("missingPreviewMessage","no preview available"),Cs,Da.DEFAULT_CREATION_OPTIONS,null),this._treeContainer=X(e,te("div.ref-tree.inline"));const i={keyboardSupport:this._defaultTreeKeyboardSupport,accessibilityProvider:new tLe,keyboardNavigationLabelProvider:this._instantiationService.createInstance(CM),identityProvider:new JSe,openOnSingleClick:!0,selectionNavigation:!0,overrideStyles:{listBackground:YSe}};this._defaultTreeKeyboardSupport&&this._callOnDispose.add(gi(this._treeContainer,"keydown",o=>{o.equals(9)&&(this._keybindingService.dispatchEvent(o,o.target),o.stopPropagation())},!0)),this._tree=this._instantiationService.createInstance(sLe,"ReferencesWidget",this._treeContainer,new QSe,[this._instantiationService.createInstance(MS),this._instantiationService.createInstance(Qx)],this._instantiationService.createInstance(vM),i),this._splitView.addView({onDidChange:se.None,element:this._previewContainer,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:o=>{this._preview.layout({height:this._dim.height,width:o})}},W0.Distribute),this._splitView.addView({onDidChange:se.None,element:this._treeContainer,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:o=>{this._treeContainer.style.height=`${this._dim.height}px`,this._treeContainer.style.width=`${o}px`,this._tree.layout(this._dim.height,o)}},W0.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this.layoutData.ratio=this._splitView.getViewSize(0)/this._dim.width)},void 0));const n=(o,r)=>{o instanceof ph&&(r==="show"&&this._revealReference(o,!1),this._onDidSelectReference.fire({element:o,kind:r,source:"tree"}))};this._disposables.add(this._tree.onDidOpen(o=>{o.sideBySide?n(o.element,"side"):o.editorOptions.pinned?n(o.element,"goto"):n(o.element,"show")})),ds(this._treeContainer)}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._dim=new bt(t,e),this.layoutData.heightInLines=this._viewZone?this._viewZone.heightInLines:this.layoutData.heightInLines,this._splitView.layout(t),this._splitView.resizeView(0,t*this.layoutData.ratio)}setSelection(e){return this._revealReference(e,!0).then(()=>{this._model&&(this._tree.setSelection([e]),this._tree.setFocus([e]))})}setModel(e){return this._disposeOnNewModel.clear(),this._model=e,this._model?this._onNewModel():Promise.resolve()}_onNewModel(){return this._model?this._model.isEmpty?(this.setTitle(""),this._messageContainer.innerText=p("noResults","No results"),ro(this._messageContainer),Promise.resolve(void 0)):(ds(this._messageContainer),this._decorationsManager=new GF(this._preview,this._model),this._disposeOnNewModel.add(this._decorationsManager),this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(e=>this._tree.rerender(e))),this._disposeOnNewModel.add(this._preview.onMouseDown(e=>{const{event:t,target:i}=e;if(t.detail!==2)return;const n=this._getFocusedReference();n&&this._onDidSelectReference.fire({element:{uri:n.uri,range:i.range},kind:t.ctrlKey||t.metaKey||t.altKey?"side":"open",source:"editor"})})),this.container.classList.add("results-loaded"),ro(this._treeContainer),ro(this._previewContainer),this._splitView.layout(this._dim.width),this.focusOnReferenceTree(),this._tree.setInput(this._model.groups.length===1?this._model.groups[0]:this._model)):Promise.resolve(void 0)}_getFocusedReference(){const[e]=this._tree.getFocus();if(e instanceof ph)return e;if(e instanceof Gv&&e.children.length>0)return e.children[0]}async revealReference(e){await this._revealReference(e,!1),this._onDidSelectReference.fire({element:e,kind:"goto",source:"tree"})}async _revealReference(e,t){if(this._revealedReference===e)return;this._revealedReference=e,e.uri.scheme!==Fe.inMemory?this.setTitle(Yae(e.uri),this._uriLabel.getUriLabel(JL(e.uri))):this.setTitle(p("peekView.alternateTitle","References"));const i=this._textModelResolverService.createModelReference(e.uri);this._tree.getInput()===e.parent?this._tree.reveal(e):(t&&this._tree.reveal(e.parent),await this._tree.expand(e.parent),this._tree.reveal(e));const n=await i;if(!this._model){n.dispose();return}At(this._previewModelReference);const o=n.object;if(o){const r=this._preview.getModel()===o.textEditorModel?0:1,a=k.lift(e.range).collapseToStart();this._previewModelReference=n,this._preview.setModel(o.textEditorModel),this._preview.setSelection(a),this._preview.revealRangeInCenter(a,r)}else this._preview.setModel(this._previewNotAvailableMessage),n.dispose()}};wM=iLe([Yg(3,Ki),Yg(4,qs),Yg(5,ye),Yg(6,KZ),Yg(7,Pp),Yg(8,yt)],wM);var oLe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Xg=function(s,e){return function(t,i){e(t,i,s)}},l1;const Ig=new le("referenceSearchVisible",!1,p("referenceSearchVisible","Whether reference peek is visible, like 'Peek References' or 'Peek Definition'"));let cg=class{static{l1=this}static{this.ID="editor.contrib.referencesController"}static get(e){return e.getContribution(l1.ID)}constructor(e,t,i,n,o,r,a,l){this._defaultTreeKeyboardSupport=e,this._editor=t,this._editorService=n,this._notificationService=o,this._instantiationService=r,this._storageService=a,this._configurationService=l,this._disposables=new Z,this._requestIdPool=0,this._ignoreModelChangeEvent=!1,this._referenceSearchVisible=Ig.bindTo(i)}dispose(){this._referenceSearchVisible.reset(),this._disposables.dispose(),this._widget?.dispose(),this._model?.dispose(),this._widget=void 0,this._model=void 0}toggleWidget(e,t,i){let n;if(this._widget&&(n=this._widget.position),this.closeWidget(),n&&e.containsPosition(n))return;this._peekMode=i,this._referenceSearchVisible.set(!0),this._disposables.add(this._editor.onDidChangeModelLanguage(()=>{this.closeWidget()})),this._disposables.add(this._editor.onDidChangeModel(()=>{this._ignoreModelChangeEvent||this.closeWidget()}));const o="peekViewLayout",r=nLe.fromJSON(this._storageService.get(o,0,"{}"));this._widget=this._instantiationService.createInstance(wM,this._editor,this._defaultTreeKeyboardSupport,r),this._widget.setTitle(p("labelLoading","Loading...")),this._widget.show(e),this._disposables.add(this._widget.onDidClose(()=>{t.cancel(),this._widget?(this._storageService.store(o,JSON.stringify(this._widget.layoutData),0,1),this._widget.isClosing||this.closeWidget(),this._widget=void 0):this.closeWidget()})),this._disposables.add(this._widget.onDidSelectReference(l=>{const{element:c,kind:d}=l;if(c)switch(d){case"open":(l.source!=="editor"||!this._configurationService.getValue("editor.stablePeek"))&&this.openReference(c,!1,!1);break;case"side":this.openReference(c,!0,!1);break;case"goto":i?this._gotoReference(c,!0):this.openReference(c,!1,!0);break}}));const a=++this._requestIdPool;t.then(l=>{if(a!==this._requestIdPool||!this._widget){l.dispose();return}return this._model?.dispose(),this._model=l,this._widget.setModel(this._model).then(()=>{if(this._widget&&this._model&&this._editor.hasModel()){this._model.isEmpty?this._widget.setMetaTitle(""):this._widget.setMetaTitle(p("metaTitle.N","{0} ({1})",this._model.title,this._model.references.length));const c=this._editor.getModel().uri,d=new P(e.startLineNumber,e.startColumn),h=this._model.nearestReference(c,d);if(h)return this._widget.setSelection(h).then(()=>{this._widget&&this._editor.getOption(87)==="editor"&&this._widget.focusOnPreviewEditor()})}})},l=>{this._notificationService.error(l)})}changeFocusBetweenPreviewAndReferences(){this._widget&&(this._widget.isPreviewEditorFocused()?this._widget.focusOnReferenceTree():this._widget.focusOnPreviewEditor())}async goToNextOrPreviousReference(e){if(!this._editor.hasModel()||!this._model||!this._widget)return;const t=this._widget.position;if(!t)return;const i=this._model.nearestReference(this._editor.getModel().uri,t);if(!i)return;const n=this._model.nextOrPreviousReference(i,e),o=this._editor.hasTextFocus(),r=this._widget.isPreviewEditorFocused();await this._widget.setSelection(n),await this._gotoReference(n,!1),o?this._editor.focus():this._widget&&r&&this._widget.focusOnPreviewEditor()}async revealReference(e){!this._editor.hasModel()||!this._model||!this._widget||await this._widget.revealReference(e)}closeWidget(e=!0){this._widget?.dispose(),this._model?.dispose(),this._referenceSearchVisible.reset(),this._disposables.clear(),this._widget=void 0,this._model=void 0,e&&this._editor.focus(),this._requestIdPool+=1}_gotoReference(e,t){this._widget?.hide(),this._ignoreModelChangeEvent=!0;const i=k.lift(e.range).collapseToStart();return this._editorService.openCodeEditor({resource:e.uri,options:{selection:i,selectionSource:"code.jump",pinned:t}},this._editor).then(n=>{if(this._ignoreModelChangeEvent=!1,!n||!this._widget){this.closeWidget();return}if(this._editor===n)this._widget.show(i),this._widget.focusOnReferenceTree();else{const o=l1.get(n),r=this._model.clone();this.closeWidget(),n.focus(),o?.toggleWidget(i,en(a=>Promise.resolve(r)),this._peekMode??!1)}},n=>{this._ignoreModelChangeEvent=!1,Oe(n)})}openReference(e,t,i){t||this.closeWidget();const{uri:n,range:o}=e;this._editorService.openCodeEditor({resource:n,options:{selection:o,selectionSource:"code.jump",pinned:i}},this._editor,t)}};cg=l1=oLe([Xg(2,Ee),Xg(3,ft),Xg(4,Ii),Xg(5,ye),Xg(6,oa),Xg(7,Ke)],cg);function Tg(s,e){const t=ZSe(s);if(!t)return;const i=cg.get(t);i&&e(i)}Ss.registerCommandAndKeybindingRule({id:"togglePeekWidgetFocus",weight:100,primary:Hi(2089,60),when:q.or(Ig,Zs.inPeekEditor),handler(s){Tg(s,e=>{e.changeFocusBetweenPreviewAndReferences()})}});Ss.registerCommandAndKeybindingRule({id:"goToNextReference",weight:90,primary:62,secondary:[70],when:q.or(Ig,Zs.inPeekEditor),handler(s){Tg(s,e=>{e.goToNextOrPreviousReference(!0)})}});Ss.registerCommandAndKeybindingRule({id:"goToPreviousReference",weight:90,primary:1086,secondary:[1094],when:q.or(Ig,Zs.inPeekEditor),handler(s){Tg(s,e=>{e.goToNextOrPreviousReference(!1)})}});ot.registerCommandAlias("goToNextReferenceFromEmbeddedEditor","goToNextReference");ot.registerCommandAlias("goToPreviousReferenceFromEmbeddedEditor","goToPreviousReference");ot.registerCommandAlias("closeReferenceSearchEditor","closeReferenceSearch");ot.registerCommand("closeReferenceSearch",s=>Tg(s,e=>e.closeWidget()));Ss.registerKeybindingRule({id:"closeReferenceSearch",weight:-1,primary:9,secondary:[1033],when:q.and(Zs.inPeekEditor,q.not("config.editor.stablePeek"))});Ss.registerKeybindingRule({id:"closeReferenceSearch",weight:250,primary:9,secondary:[1033],when:q.and(Ig,q.not("config.editor.stablePeek"),q.or(I.editorTextFocus,l$.negate()))});Ss.registerCommandAndKeybindingRule({id:"revealReference",weight:200,primary:3,mac:{primary:3,secondary:[2066]},when:q.and(Ig,h$,TO.negate(),EO.negate()),handler(s){const t=s.get(Ir).lastFocusedList?.getFocus();Array.isArray(t)&&t[0]instanceof ph&&Tg(s,i=>i.revealReference(t[0]))}});Ss.registerCommandAndKeybindingRule({id:"openReferenceToSide",weight:100,primary:2051,mac:{primary:259},when:q.and(Ig,h$,TO.negate(),EO.negate()),handler(s){const t=s.get(Ir).lastFocusedList?.getFocus();Array.isArray(t)&&t[0]instanceof ph&&Tg(s,i=>i.openReference(t[0],!0,!0))}});ot.registerCommand("openReference",s=>{const t=s.get(Ir).lastFocusedList?.getFocus();Array.isArray(t)&&t[0]instanceof ph&&Tg(s,i=>i.openReference(t[0],!1,!0))});var XZ=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},M_=function(s,e){return function(t,i){e(t,i,s)}};const YF=new le("hasSymbols",!1,p("hasSymbols","Whether there are symbol locations that can be navigated via keyboard-only.")),Jx=Je("ISymbolNavigationService");let SM=class{constructor(e,t,i,n){this._editorService=t,this._notificationService=i,this._keybindingService=n,this._currentModel=void 0,this._currentIdx=-1,this._ignoreEditorChange=!1,this._ctxHasSymbols=YF.bindTo(e)}reset(){this._ctxHasSymbols.reset(),this._currentState?.dispose(),this._currentMessage?.dispose(),this._currentModel=void 0,this._currentIdx=-1}put(e){const t=e.parent.parent;if(t.references.length<=1){this.reset();return}this._currentModel=t,this._currentIdx=t.references.indexOf(e),this._ctxHasSymbols.set(!0),this._showMessage();const i=new LM(this._editorService),n=i.onDidChange(o=>{if(this._ignoreEditorChange)return;const r=this._editorService.getActiveCodeEditor();if(!r)return;const a=r.getModel(),l=r.getPosition();if(!a||!l)return;let c=!1,d=!1;for(const h of t.references)if(dv(h.uri,a.uri))c=!0,d=d||k.containsPosition(h.range,l);else if(c)break;(!c||!d)&&this.reset()});this._currentState=Gr(i,n)}revealNext(e){if(!this._currentModel)return Promise.resolve();this._currentIdx+=1,this._currentIdx%=this._currentModel.references.length;const t=this._currentModel.references[this._currentIdx];return this._showMessage(),this._ignoreEditorChange=!0,this._editorService.openCodeEditor({resource:t.uri,options:{selection:k.collapseToStart(t.range),selectionRevealType:3}},e).finally(()=>{this._ignoreEditorChange=!1})}_showMessage(){this._currentMessage?.dispose();const e=this._keybindingService.lookupKeybinding("editor.gotoNextSymbolFromResult"),t=e?p("location.kb","Symbol {0} of {1}, {2} for next",this._currentIdx+1,this._currentModel.references.length,e.getLabel()):p("location","Symbol {0} of {1}",this._currentIdx+1,this._currentModel.references.length);this._currentMessage=this._notificationService.status(t)}};SM=XZ([M_(0,Ee),M_(1,ft),M_(2,Ii),M_(3,yt)],SM);nt(Jx,SM,1);ae(new class extends Zi{constructor(){super({id:"editor.gotoNextSymbolFromResult",precondition:YF,kbOpts:{weight:100,primary:70}})}runEditorCommand(s,e){return s.get(Jx).revealNext(e)}});Ss.registerCommandAndKeybindingRule({id:"editor.gotoNextSymbolFromResult.cancel",weight:100,when:YF,primary:9,handler(s){s.get(Jx).reset()}});let LM=class{constructor(e){this._listener=new Map,this._disposables=new Z,this._onDidChange=new O,this.onDidChange=this._onDidChange.event,this._disposables.add(e.onCodeEditorRemove(this._onDidRemoveEditor,this)),this._disposables.add(e.onCodeEditorAdd(this._onDidAddEditor,this)),e.listCodeEditors().forEach(this._onDidAddEditor,this)}dispose(){this._disposables.dispose(),this._onDidChange.dispose(),At(this._listener.values())}_onDidAddEditor(e){this._listener.set(e,Gr(e.onDidChangeCursorPosition(t=>this._onDidChange.fire({editor:e})),e.onDidChangeModelContent(t=>this._onDidChange.fire({editor:e}))))}_onDidRemoveEditor(e){this._listener.get(e)?.dispose(),this._listener.delete(e)}};LM=XZ([M_(0,ft)],LM);function xM(s,e){return e.uri.scheme===s.uri.scheme?!0:!oE(e.uri,Fe.walkThroughSnippet,Fe.vscodeChatCodeBlock,Fe.vscodeChatCodeCompareBlock)}async function QC(s,e,t,i,n){const r=t.ordered(s,i).map(l=>Promise.resolve(n(l,s,e)).then(void 0,c=>{Li(c)})),a=await Promise.all(r);return Yr(a.flat()).filter(l=>xM(s,l))}function JC(s,e,t,i,n){return QC(e,t,s,i,(o,r,a)=>o.provideDefinition(r,a,n))}function XF(s,e,t,i,n){return QC(e,t,s,i,(o,r,a)=>o.provideDeclaration(r,a,n))}function QF(s,e,t,i,n){return QC(e,t,s,i,(o,r,a)=>o.provideImplementation(r,a,n))}function JF(s,e,t,i,n){return QC(e,t,s,i,(o,r,a)=>o.provideTypeDefinition(r,a,n))}function ey(s,e,t,i,n,o){return QC(e,t,s,n,async(r,a,l)=>{const c=(await r.provideReferences(a,l,{includeDeclaration:!0},o))?.filter(h=>xM(a,h));if(!i||!c||c.length!==2)return c;const d=(await r.provideReferences(a,l,{includeDeclaration:!1},o))?.filter(h=>xM(a,h));return d&&d.length===1?d:c})}async function $l(s){const e=await s(),t=new fo(e,""),i=t.references.map(n=>n.link);return t.dispose(),i}Gs("_executeDefinitionProvider",(s,e,t)=>{const i=s.get(pe),n=JC(i.definitionProvider,e,t,!1,Ue.None);return $l(()=>n)});Gs("_executeDefinitionProvider_recursive",(s,e,t)=>{const i=s.get(pe),n=JC(i.definitionProvider,e,t,!0,Ue.None);return $l(()=>n)});Gs("_executeTypeDefinitionProvider",(s,e,t)=>{const i=s.get(pe),n=JF(i.typeDefinitionProvider,e,t,!1,Ue.None);return $l(()=>n)});Gs("_executeTypeDefinitionProvider_recursive",(s,e,t)=>{const i=s.get(pe),n=JF(i.typeDefinitionProvider,e,t,!0,Ue.None);return $l(()=>n)});Gs("_executeDeclarationProvider",(s,e,t)=>{const i=s.get(pe),n=XF(i.declarationProvider,e,t,!1,Ue.None);return $l(()=>n)});Gs("_executeDeclarationProvider_recursive",(s,e,t)=>{const i=s.get(pe),n=XF(i.declarationProvider,e,t,!0,Ue.None);return $l(()=>n)});Gs("_executeReferenceProvider",(s,e,t)=>{const i=s.get(pe),n=ey(i.referenceProvider,e,t,!1,!1,Ue.None);return $l(()=>n)});Gs("_executeReferenceProvider_recursive",(s,e,t)=>{const i=s.get(pe),n=ey(i.referenceProvider,e,t,!1,!0,Ue.None);return $l(()=>n)});Gs("_executeImplementationProvider",(s,e,t)=>{const i=s.get(pe),n=QF(i.implementationProvider,e,t,!1,Ue.None);return $l(()=>n)});Gs("_executeImplementationProvider_recursive",(s,e,t)=>{const i=s.get(pe),n=QF(i.implementationProvider,e,t,!0,Ue.None);return $l(()=>n)});hn.appendMenuItem(M.EditorContext,{submenu:M.EditorContextPeek,title:p("peek.submenu","Peek"),group:"navigation",order:100});class Qp{static is(e){return!e||typeof e!="object"?!1:!!(e instanceof Qp||P.isIPosition(e.position)&&e.model)}constructor(e,t){this.model=e,this.position=t}}class Ps extends Za{static{this._allSymbolNavigationCommands=new Map}static{this._activeAlternativeCommands=new Set}static all(){return Ps._allSymbolNavigationCommands.values()}static _patchConfig(e){const t={...e,f1:!0};if(t.menu)for(const i of st.wrap(t.menu))(i.id===M.EditorContext||i.id===M.EditorContextPeek)&&(i.when=q.and(e.precondition,i.when));return t}constructor(e,t){super(Ps._patchConfig(t)),this.configuration=e,Ps._allSymbolNavigationCommands.set(t.id,this)}runEditorCommand(e,t,i,n){if(!t.hasModel())return Promise.resolve(void 0);const o=e.get(Ii),r=e.get(ft),a=e.get(yh),l=e.get(Jx),c=e.get(pe),d=e.get(ye),h=t.getModel(),u=t.getPosition(),g=Qp.is(i)?i:new Qp(h,u),f=new gh(t,5),m=yC(this._getLocationModel(c,g.model,g.position,f.token),f.token).then(async _=>{if(!_||f.token.isCancellationRequested)return;Ls(_.ariaMessage);let b;if(_.referenceAt(h.uri,u)){const C=this._getAlternativeCommand(t);!Ps._activeAlternativeCommands.has(C)&&Ps._allSymbolNavigationCommands.has(C)&&(b=Ps._allSymbolNavigationCommands.get(C))}const v=_.references.length;if(v===0){if(!this.configuration.muteMessage){const C=h.getWordAtPosition(u);go.get(t)?.showMessage(this._getNoResultFoundMessage(C),u)}}else if(v===1&&b)Ps._activeAlternativeCommands.add(this.desc.id),d.invokeFunction(C=>b.runEditorCommand(C,t,i,n).finally(()=>{Ps._activeAlternativeCommands.delete(this.desc.id)}));else return this._onResult(r,l,t,_,n)},_=>{o.error(_)}).finally(()=>{f.dispose()});return a.showWhile(m,250),m}async _onResult(e,t,i,n,o){const r=this._getGoToPreference(i);if(!(i instanceof ta)&&(this.configuration.openInPeek||r==="peek"&&n.references.length>1))this._openInPeek(i,n,o);else{const a=n.firstReference(),l=n.references.length>1&&r==="gotoAndPeek",c=await this._openReference(i,e,a,this.configuration.openToSide,!l);l&&c?this._openInPeek(c,n,o):n.dispose(),r==="goto"&&t.put(a)}}async _openReference(e,t,i,n,o){let r;if(aee(i)&&(r=i.targetSelectionRange),r||(r=i.range),!r)return;const a=await t.openCodeEditor({resource:i.uri,options:{selection:k.collapseToStart(r),selectionRevealType:3,selectionSource:"code.jump"}},e,n);if(a){if(o){const l=a.getModel(),c=a.createDecorationsCollection([{range:r,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout(()=>{a.getModel()===l&&c.clear()},350)}return a}}_openInPeek(e,t,i){const n=cg.get(e);n&&e.hasModel()?n.toggleWidget(i??e.getSelection(),en(o=>Promise.resolve(t)),this.configuration.openInPeek):t.dispose()}}class ty extends Ps{async _getLocationModel(e,t,i,n){return new fo(await JC(e.definitionProvider,t,i,!1,n),p("def.title","Definitions"))}_getNoResultFoundMessage(e){return e&&e.word?p("noResultWord","No definition found for '{0}'",e.word):p("generic.noResults","No definition found")}_getAlternativeCommand(e){return e.getOption(58).alternativeDefinitionCommand}_getGoToPreference(e){return e.getOption(58).multipleDefinitions}}Bt(class kM extends ty{static{this.id="editor.action.revealDefinition"}constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:kM.id,title:{...Re("actions.goToDecl.label","Go to Definition"),mnemonicTitle:p({key:"miGotoDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Definition")},precondition:I.hasDefinitionProvider,keybinding:[{when:I.editorTextFocus,primary:70,weight:100},{when:q.and(I.editorTextFocus,r$),primary:2118,weight:100}],menu:[{id:M.EditorContext,group:"navigation",order:1.1},{id:M.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:2}]}),ot.registerCommandAlias("editor.action.goToDeclaration",kM.id)}});Bt(class DM extends ty{static{this.id="editor.action.revealDefinitionAside"}constructor(){super({openToSide:!0,openInPeek:!1,muteMessage:!1},{id:DM.id,title:Re("actions.goToDeclToSide.label","Open Definition to the Side"),precondition:q.and(I.hasDefinitionProvider,I.isInEmbeddedEditor.toNegated()),keybinding:[{when:I.editorTextFocus,primary:Hi(2089,70),weight:100},{when:q.and(I.editorTextFocus,r$),primary:Hi(2089,2118),weight:100}]}),ot.registerCommandAlias("editor.action.openDeclarationToTheSide",DM.id)}});Bt(class IM extends ty{static{this.id="editor.action.peekDefinition"}constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:IM.id,title:Re("actions.previewDecl.label","Peek Definition"),precondition:q.and(I.hasDefinitionProvider,Zs.notInPeekEditor,I.isInEmbeddedEditor.toNegated()),keybinding:{when:I.editorTextFocus,primary:582,linux:{primary:3140},weight:100},menu:{id:M.EditorContextPeek,group:"peek",order:2}}),ot.registerCommandAlias("editor.action.previewDeclaration",IM.id)}});class QZ extends Ps{async _getLocationModel(e,t,i,n){return new fo(await XF(e.declarationProvider,t,i,!1,n),p("decl.title","Declarations"))}_getNoResultFoundMessage(e){return e&&e.word?p("decl.noResultWord","No declaration found for '{0}'",e.word):p("decl.generic.noResults","No declaration found")}_getAlternativeCommand(e){return e.getOption(58).alternativeDeclarationCommand}_getGoToPreference(e){return e.getOption(58).multipleDeclarations}}Bt(class JZ extends QZ{static{this.id="editor.action.revealDeclaration"}constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:JZ.id,title:{...Re("actions.goToDeclaration.label","Go to Declaration"),mnemonicTitle:p({key:"miGotoDeclaration",comment:["&& denotes a mnemonic"]},"Go to &&Declaration")},precondition:q.and(I.hasDeclarationProvider,I.isInEmbeddedEditor.toNegated()),menu:[{id:M.EditorContext,group:"navigation",order:1.3},{id:M.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}_getNoResultFoundMessage(e){return e&&e.word?p("decl.noResultWord","No declaration found for '{0}'",e.word):p("decl.generic.noResults","No declaration found")}});Bt(class extends QZ{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.peekDeclaration",title:Re("actions.peekDecl.label","Peek Declaration"),precondition:q.and(I.hasDeclarationProvider,Zs.notInPeekEditor,I.isInEmbeddedEditor.toNegated()),menu:{id:M.EditorContextPeek,group:"peek",order:3}})}});class eK extends Ps{async _getLocationModel(e,t,i,n){return new fo(await JF(e.typeDefinitionProvider,t,i,!1,n),p("typedef.title","Type Definitions"))}_getNoResultFoundMessage(e){return e&&e.word?p("goToTypeDefinition.noResultWord","No type definition found for '{0}'",e.word):p("goToTypeDefinition.generic.noResults","No type definition found")}_getAlternativeCommand(e){return e.getOption(58).alternativeTypeDefinitionCommand}_getGoToPreference(e){return e.getOption(58).multipleTypeDefinitions}}Bt(class tK extends eK{static{this.ID="editor.action.goToTypeDefinition"}constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:tK.ID,title:{...Re("actions.goToTypeDefinition.label","Go to Type Definition"),mnemonicTitle:p({key:"miGotoTypeDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Type Definition")},precondition:I.hasTypeDefinitionProvider,keybinding:{when:I.editorTextFocus,primary:0,weight:100},menu:[{id:M.EditorContext,group:"navigation",order:1.4},{id:M.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}});Bt(class iK extends eK{static{this.ID="editor.action.peekTypeDefinition"}constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:iK.ID,title:Re("actions.peekTypeDefinition.label","Peek Type Definition"),precondition:q.and(I.hasTypeDefinitionProvider,Zs.notInPeekEditor,I.isInEmbeddedEditor.toNegated()),menu:{id:M.EditorContextPeek,group:"peek",order:4}})}});class nK extends Ps{async _getLocationModel(e,t,i,n){return new fo(await QF(e.implementationProvider,t,i,!1,n),p("impl.title","Implementations"))}_getNoResultFoundMessage(e){return e&&e.word?p("goToImplementation.noResultWord","No implementation found for '{0}'",e.word):p("goToImplementation.generic.noResults","No implementation found")}_getAlternativeCommand(e){return e.getOption(58).alternativeImplementationCommand}_getGoToPreference(e){return e.getOption(58).multipleImplementations}}Bt(class sK extends nK{static{this.ID="editor.action.goToImplementation"}constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:sK.ID,title:{...Re("actions.goToImplementation.label","Go to Implementations"),mnemonicTitle:p({key:"miGotoImplementation",comment:["&& denotes a mnemonic"]},"Go to &&Implementations")},precondition:I.hasImplementationProvider,keybinding:{when:I.editorTextFocus,primary:2118,weight:100},menu:[{id:M.EditorContext,group:"navigation",order:1.45},{id:M.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:4}]})}});Bt(class oK extends nK{static{this.ID="editor.action.peekImplementation"}constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:oK.ID,title:Re("actions.peekImplementation.label","Peek Implementations"),precondition:q.and(I.hasImplementationProvider,Zs.notInPeekEditor,I.isInEmbeddedEditor.toNegated()),keybinding:{when:I.editorTextFocus,primary:3142,weight:100},menu:{id:M.EditorContextPeek,group:"peek",order:5}})}});class rK extends Ps{_getNoResultFoundMessage(e){return e?p("references.no","No references found for '{0}'",e.word):p("references.noGeneric","No references found")}_getAlternativeCommand(e){return e.getOption(58).alternativeReferenceCommand}_getGoToPreference(e){return e.getOption(58).multipleReferences}}Bt(class extends rK{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:"editor.action.goToReferences",title:{...Re("goToReferences.label","Go to References"),mnemonicTitle:p({key:"miGotoReference",comment:["&& denotes a mnemonic"]},"Go to &&References")},precondition:q.and(I.hasReferenceProvider,Zs.notInPeekEditor,I.isInEmbeddedEditor.toNegated()),keybinding:{when:I.editorTextFocus,primary:1094,weight:100},menu:[{id:M.EditorContext,group:"navigation",order:1.45},{id:M.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:5}]})}async _getLocationModel(e,t,i,n){return new fo(await ey(e.referenceProvider,t,i,!0,!1,n),p("ref.title","References"))}});Bt(class extends rK{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.referenceSearch.trigger",title:Re("references.action.label","Peek References"),precondition:q.and(I.hasReferenceProvider,Zs.notInPeekEditor,I.isInEmbeddedEditor.toNegated()),menu:{id:M.EditorContextPeek,group:"peek",order:6}})}async _getLocationModel(e,t,i,n){return new fo(await ey(e.referenceProvider,t,i,!1,!1,n),p("ref.title","References"))}});class rLe extends Ps{constructor(e,t,i){super(e,{id:"editor.action.goToLocation",title:Re("label.generic","Go to Any Symbol"),precondition:q.and(Zs.notInPeekEditor,I.isInEmbeddedEditor.toNegated())}),this._references=t,this._gotoMultipleBehaviour=i}async _getLocationModel(e,t,i,n){return new fo(this._references,p("generic.title","Locations"))}_getNoResultFoundMessage(e){return e&&p("generic.noResult","No results for '{0}'",e.word)||""}_getGoToPreference(e){return this._gotoMultipleBehaviour??e.getOption(58).multipleReferences}_getAlternativeCommand(){return""}}ot.registerCommand({id:"editor.action.goToLocations",metadata:{description:"Go to locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:Se},{name:"position",description:"The position at which to start",constraint:P.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto`"},{name:"noResultsMessage",description:"Human readable message that shows when locations is empty."}]},handler:async(s,e,t,i,n,o,r)=>{gt(Se.isUri(e)),gt(P.isIPosition(t)),gt(Array.isArray(i)),gt(typeof n>"u"||typeof n=="string"),gt(typeof r>"u"||typeof r=="boolean");const a=s.get(ft),l=await a.openCodeEditor({resource:e},a.getFocusedCodeEditor());if(Ol(l))return l.setPosition(t),l.revealPositionInCenterIfOutsideViewport(t,0),l.invokeWithinContext(c=>{const d=new class extends rLe{_getNoResultFoundMessage(h){return o||super._getNoResultFoundMessage(h)}}({muteMessage:!o,openInPeek:!!r,openToSide:!1},i,n);c.get(ye).invokeFunction(d.run.bind(d),l)})}});ot.registerCommand({id:"editor.action.peekLocations",metadata:{description:"Peek locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:Se},{name:"position",description:"The position at which to start",constraint:P.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto`"}]},handler:async(s,e,t,i,n)=>{s.get(Ht).executeCommand("editor.action.goToLocations",e,t,i,n,void 0,!0)}});ot.registerCommand({id:"editor.action.findReferences",handler:(s,e,t)=>{gt(Se.isUri(e)),gt(P.isIPosition(t));const i=s.get(pe),n=s.get(ft);return n.openCodeEditor({resource:e},n.getFocusedCodeEditor()).then(o=>{if(!Ol(o)||!o.hasModel())return;const r=cg.get(o);if(!r)return;const a=en(c=>ey(i.referenceProvider,o.getModel(),P.lift(t),!1,!1,c).then(d=>new fo(d,p("ref.title","References")))),l=new k(t.lineNumber,t.column,t.lineNumber,t.column);return Promise.resolve(r.toggleWidget(l,a,!1))})}});ot.registerCommandAlias("editor.action.showReferences","editor.action.peekLocations");async function aLe(s,e,t,i){const n=s.get(qs),o=s.get(bo),r=s.get(Ht),a=s.get(ye),l=s.get(Ii);if(await i.item.resolve(Ue.None),!i.part.location)return;const c=i.part.location,d=[],h=new Set(hn.getMenuItems(M.EditorContext).map(g=>Kf(g)?g.command.id:$x()));for(const g of Ps.all())h.has(g.desc.id)&&d.push(new ho(g.desc.id,uo.label(g.desc,{renderShortTitle:!0}),void 0,!0,async()=>{const f=await n.createModelReference(c.uri);try{const m=new Qp(f.object.textEditorModel,k.getStartPosition(c.range)),_=i.item.anchor.range;await a.invokeFunction(g.runEditorCommand.bind(g),e,m,_)}finally{f.dispose()}}));if(i.part.command){const{command:g}=i.part;d.push(new ji),d.push(new ho(g.id,g.title,void 0,!0,async()=>{try{await r.executeCommand(g.id,...g.arguments??[])}catch(f){l.notify({severity:HL.Error,source:i.item.provider.displayName,message:f})}}))}const u=e.getOption(128);o.showContextMenu({domForShadowRoot:u?e.getDomNode()??void 0:void 0,getAnchor:()=>{const g=Si(t);return{x:g.left,y:g.top+g.height+8}},getActions:()=>d,onHide:()=>{e.focus()},autoSelectFirstItem:!0})}async function aK(s,e,t,i){const o=await s.get(qs).createModelReference(i.uri);await t.invokeWithinContext(async r=>{const a=e.hasSideBySideModifier,l=r.get(Ee),c=Zs.inPeekEditor.getValue(l),d=!a&&t.getOption(89)&&!c;return new ty({openToSide:a,openInPeek:d,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0}).run(r,new Qp(o.object.textEditorModel,k.getStartPosition(i.range)),k.lift(i.range))}),o.dispose()}var lLe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Qg=function(s,e){return function(t,i){e(t,i,s)}},gf;class AS{constructor(){this._entries=new Wl(50)}get(e){const t=AS._key(e);return this._entries.get(t)}set(e,t){const i=AS._key(e);this._entries.set(i,t)}static _key(e){return`${e.uri.toString()}/${e.getVersionId()}`}}const lK=Je("IInlayHintsCache");nt(lK,AS,1);class TM{constructor(e,t){this.item=e,this.index=t}get part(){const e=this.item.hint.label;return typeof e=="string"?{label:e}:e[this.index]}}class cLe{constructor(e,t){this.part=e,this.hasTriggerModifier=t}}let Yv=class{static{gf=this}static{this.ID="editor.contrib.InlayHints"}static{this._MAX_DECORATORS=1500}static{this._MAX_LABEL_LEN=43}static get(e){return e.getContribution(gf.ID)??void 0}constructor(e,t,i,n,o,r,a){this._editor=e,this._languageFeaturesService=t,this._inlayHintsCache=n,this._commandService=o,this._notificationService=r,this._instaService=a,this._disposables=new Z,this._sessionDisposables=new Z,this._decorationsMetadata=new Map,this._ruleFactory=new xx(this._editor),this._activeRenderMode=0,this._debounceInfo=i.for(t.inlayHintsProvider,"InlayHint",{min:25}),this._disposables.add(t.inlayHintsProvider.onDidChange(()=>this._update())),this._disposables.add(e.onDidChangeModel(()=>this._update())),this._disposables.add(e.onDidChangeModelLanguage(()=>this._update())),this._disposables.add(e.onDidChangeConfiguration(l=>{l.hasChanged(142)&&this._update()})),this._update()}dispose(){this._sessionDisposables.dispose(),this._removeAllDecorations(),this._disposables.dispose()}_update(){this._sessionDisposables.clear(),this._removeAllDecorations();const e=this._editor.getOption(142);if(e.enabled==="off")return;const t=this._editor.getModel();if(!t||!this._languageFeaturesService.inlayHintsProvider.has(t))return;if(e.enabled==="on")this._activeRenderMode=0;else{let a,l;e.enabled==="onUnlessPressed"?(a=0,l=1):(a=1,l=0),this._activeRenderMode=a,this._sessionDisposables.add(yc.getInstance().event(c=>{if(!this._editor.hasModel())return;const d=c.altKey&&c.ctrlKey&&!(c.shiftKey||c.metaKey)?l:a;if(d!==this._activeRenderMode){this._activeRenderMode=d;const h=this._editor.getModel(),u=this._copyInlayHintsWithCurrentAnchor(h);this._updateHintsDecorators([h.getFullModelRange()],u),r.schedule(0)}}))}const i=this._inlayHintsCache.get(t);i&&this._updateHintsDecorators([t.getFullModelRange()],i),this._sessionDisposables.add(Ce(()=>{t.isDisposed()||this._cacheHintsForFastRestore(t)}));let n;const o=new Set,r=new It(async()=>{const a=Date.now();n?.dispose(!0),n=new li;const l=t.onWillDispose(()=>n?.cancel());try{const c=n.token,d=await gp.create(this._languageFeaturesService.inlayHintsProvider,t,this._getHintsRanges(),c);if(r.delay=this._debounceInfo.update(t,Date.now()-a),c.isCancellationRequested){d.dispose();return}for(const h of d.provider)typeof h.onDidChangeInlayHints=="function"&&!o.has(h)&&(o.add(h),this._sessionDisposables.add(h.onDidChangeInlayHints(()=>{r.isScheduled()||r.schedule()})));this._sessionDisposables.add(d),this._updateHintsDecorators(d.ranges,d.items),this._cacheHintsForFastRestore(t)}catch(c){Oe(c)}finally{n.dispose(),l.dispose()}},this._debounceInfo.get(t));this._sessionDisposables.add(r),this._sessionDisposables.add(Ce(()=>n?.dispose(!0))),r.schedule(0),this._sessionDisposables.add(this._editor.onDidScrollChange(a=>{(a.scrollTopChanged||!r.isScheduled())&&r.schedule()})),this._sessionDisposables.add(this._editor.onDidChangeModelContent(a=>{n?.cancel();const l=Math.max(r.delay,1250);r.schedule(l)})),this._sessionDisposables.add(this._installDblClickGesture(()=>r.schedule(0))),this._sessionDisposables.add(this._installLinkGesture()),this._sessionDisposables.add(this._installContextMenu())}_installLinkGesture(){const e=new Z,t=e.add(new Gx(this._editor)),i=new Z;return e.add(i),e.add(t.onMouseMoveOrRelevantKeyDown(n=>{const[o]=n,r=this._getInlayHintLabelPart(o),a=this._editor.getModel();if(!r||!a){i.clear();return}const l=new li;i.add(Ce(()=>l.dispose(!0))),r.item.resolve(l.token),this._activeInlayHintPart=r.part.command||r.part.location?new cLe(r,o.hasTriggerModifier):void 0;const c=a.validatePosition(r.item.hint.position).lineNumber,d=new k(c,1,c,a.getLineMaxColumn(c)),h=this._getInlineHintsForRange(d);this._updateHintsDecorators([d],h),i.add(Ce(()=>{this._activeInlayHintPart=void 0,this._updateHintsDecorators([d],h)}))})),e.add(t.onCancel(()=>i.clear())),e.add(t.onExecute(async n=>{const o=this._getInlayHintLabelPart(n);if(o){const r=o.part;r.location?this._instaService.invokeFunction(aK,n,this._editor,r.location):oT.is(r.command)&&await this._invokeCommand(r.command,o.item)}})),e}_getInlineHintsForRange(e){const t=new Set;for(const i of this._decorationsMetadata.values())e.containsRange(i.item.anchor.range)&&t.add(i.item);return Array.from(t)}_installDblClickGesture(e){return this._editor.onMouseUp(async t=>{if(t.event.detail!==2)return;const i=this._getInlayHintLabelPart(t);if(i&&(t.event.preventDefault(),await i.item.resolve(Ue.None),os(i.item.hint.textEdits))){const n=i.item.hint.textEdits.map(o=>ri.replace(k.lift(o.range),o.text));this._editor.executeEdits("inlayHint.default",n),e()}})}_installContextMenu(){return this._editor.onContextMenu(async e=>{if(!tn(e.event.target))return;const t=this._getInlayHintLabelPart(e);t&&await this._instaService.invokeFunction(aLe,this._editor,e.event.target,t)})}_getInlayHintLabelPart(e){if(e.target.type!==6)return;const t=e.target.detail.injectedText?.options;if(t instanceof dh&&t?.attachedData instanceof TM)return t.attachedData}async _invokeCommand(e,t){try{await this._commandService.executeCommand(e.id,...e.arguments??[])}catch(i){this._notificationService.notify({severity:HL.Error,source:t.provider.displayName,message:i})}}_cacheHintsForFastRestore(e){const t=this._copyInlayHintsWithCurrentAnchor(e);this._inlayHintsCache.set(e,t)}_copyInlayHintsWithCurrentAnchor(e){const t=new Map;for(const[i,n]of this._decorationsMetadata){if(t.has(n.item))continue;const o=e.getDecorationRange(i);if(o){const r=new $Z(o,n.item.anchor.direction),a=n.item.with({anchor:r});t.set(n.item,a)}}return Array.from(t.values())}_getHintsRanges(){const t=this._editor.getModel(),i=this._editor.getVisibleRangesPlusViewportAboveBelow(),n=[];for(const o of i.sort(k.compareRangesUsingStarts)){const r=t.validateRange(new k(o.startLineNumber-30,o.startColumn,o.endLineNumber+30,o.endColumn));n.length===0||!k.areIntersectingOrTouching(n[n.length-1],r)?n.push(r):n[n.length-1]=k.plusRange(n[n.length-1],r)}return n}_updateHintsDecorators(e,t){const i=[],n=(f,m,_,b,v)=>{const C={content:_,inlineClassNameAffectsLetterSpacing:!0,inlineClassName:m.className,cursorStops:b,attachedData:v};i.push({item:f,classNameRef:m,decoration:{range:f.anchor.range,options:{description:"InlayHint",showIfCollapsed:f.anchor.range.isEmpty(),collapseOnReplaceEdit:!f.anchor.range.isEmpty(),stickiness:0,[f.anchor.direction]:this._activeRenderMode===0?C:void 0}}})},o=(f,m)=>{const _=this._ruleFactory.createClassNameRef({width:`${r/3|0}px`,display:"inline-block"});n(f,_,"",m?Zr.Right:Zr.None)},{fontSize:r,fontFamily:a,padding:l,isUniform:c}=this._getLayoutInfo(),d="--code-editorInlayHintsFontFamily";this._editor.getContainerDomNode().style.setProperty(d,a);let h={line:0,totalLen:0};for(const f of t){if(h.line!==f.anchor.range.startLineNumber&&(h={line:f.anchor.range.startLineNumber,totalLen:0}),h.totalLen>gf._MAX_LABEL_LEN)continue;f.hint.paddingLeft&&o(f,!1);const m=typeof f.hint.label=="string"?[{label:f.hint.label}]:f.hint.label;for(let _=0;_<m.length;_++){const b=m[_],v=_===0,C=_===m.length-1,y={fontSize:`${r}px`,fontFamily:`var(${d}), ${vs.fontFamily}`,verticalAlign:c?"baseline":"middle",unicodeBidi:"isolate"};os(f.hint.textEdits)&&(y.cursor="default"),this._fillInColors(y,f.hint),(b.command||b.location)&&this._activeInlayHintPart?.part.item===f&&this._activeInlayHintPart.part.index===_&&(y.textDecoration="underline",this._activeInlayHintPart.hasTriggerModifier&&(y.color=_i(Ioe),y.cursor="pointer")),l&&(v&&C?(y.padding=`1px ${Math.max(1,r/4)|0}px`,y.borderRadius=`${r/4|0}px`):v?(y.padding=`1px 0 1px ${Math.max(1,r/4)|0}px`,y.borderRadius=`${r/4|0}px 0 0 ${r/4|0}px`):C?(y.padding=`1px ${Math.max(1,r/4)|0}px 1px 0`,y.borderRadius=`0 ${r/4|0}px ${r/4|0}px 0`):y.padding="1px 0 1px 0");let w=b.label;h.totalLen+=w.length;let x=!1;const L=h.totalLen-gf._MAX_LABEL_LEN;if(L>0&&(w=w.slice(0,-L)+"",x=!0),n(f,this._ruleFactory.createClassNameRef(y),dLe(w),C&&!f.hint.paddingRight?Zr.Right:Zr.None,new TM(f,_)),x)break}if(f.hint.paddingRight&&o(f,!0),i.length>gf._MAX_DECORATORS)break}const u=[];for(const[f,m]of this._decorationsMetadata){const _=this._editor.getModel()?.getDecorationRange(f);_&&e.some(b=>b.containsRange(_))&&(u.push(f),m.classNameRef.dispose(),this._decorationsMetadata.delete(f))}const g=$a.capture(this._editor);this._editor.changeDecorations(f=>{const m=f.deltaDecorations(u,i.map(_=>_.decoration));for(let _=0;_<m.length;_++){const b=i[_];this._decorationsMetadata.set(m[_],b)}}),g.restore(this._editor)}_fillInColors(e,t){t.kind===A1.Parameter?(e.backgroundColor=_i(Ooe),e.color=_i(Poe)):t.kind===A1.Type?(e.backgroundColor=_i(Aoe),e.color=_i(Moe)):(e.backgroundColor=_i(k2),e.color=_i(x2))}_getLayoutInfo(){const e=this._editor.getOption(142),t=e.padding,i=this._editor.getOption(52),n=this._editor.getOption(49);let o=e.fontSize;(!o||o<5||o>i)&&(o=i);const r=e.fontFamily||n;return{fontSize:o,fontFamily:r,padding:t,isUniform:!t&&r===n&&o===i}}_removeAllDecorations(){this._editor.removeDecorations(Array.from(this._decorationsMetadata.keys()));for(const e of this._decorationsMetadata.values())e.classNameRef.dispose();this._decorationsMetadata.clear()}};Yv=gf=lLe([Qg(1,pe),Qg(2,Go),Qg(3,lK),Qg(4,Ht),Qg(5,Ii),Qg(6,ye)],Yv);function dLe(s){return s.replace(/[ \t]/g,"")}ot.registerCommand("_executeInlayHintProvider",async(s,...e)=>{const[t,i]=e;gt(Se.isUri(t)),gt(k.isIRange(i));const{inlayHintsProvider:n}=s.get(pe),o=await s.get(qs).createModelReference(t);try{const r=await gp.create(n,o.object.textEditorModel,[k.lift(i)],Ue.None),a=r.items.map(l=>l.hint);return setTimeout(()=>r.dispose(),0),a}finally{o.dispose()}});var hLe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},ld=function(s,e){return function(t,i){e(t,i,s)}};class k7 extends o1{constructor(e,t,i,n){super(10,t,e.item.anchor.range,i,n,!0),this.part=e}}let PS=class extends qv{constructor(e,t,i,n,o,r,a,l,c){super(e,t,i,r,l,n,o,c),this._resolverService=a,this.hoverOrdinal=6}suggestHoverAnchor(e){if(!Yv.get(this._editor)||e.target.type!==6)return null;const i=e.target.detail.injectedText?.options;return i instanceof dh&&i.attachedData instanceof TM?new k7(i.attachedData,this,e.event.posx,e.event.posy):null}computeSync(){return[]}computeAsync(e,t,i){return e instanceof k7?new zi(async n=>{const{part:o}=e;if(await o.item.resolve(i),i.isCancellationRequested)return;let r;typeof o.item.hint.tooltip=="string"?r=new zn().appendText(o.item.hint.tooltip):o.item.hint.tooltip&&(r=o.item.hint.tooltip),r&&n.emitOne(new $r(this,e.range,[r],!1,0)),os(o.item.hint.textEdits)&&n.emitOne(new $r(this,e.range,[new zn().appendText(p("hint.dbl","Double-click to insert"))],!1,10001));let a;if(typeof o.part.tooltip=="string"?a=new zn().appendText(o.part.tooltip):o.part.tooltip&&(a=o.part.tooltip),a&&n.emitOne(new $r(this,e.range,[a],!1,1)),o.part.location||o.part.command){let c;const h=this._editor.getOption(78)==="altKey"?Qe?p("links.navigate.kb.meta.mac","cmd + click"):p("links.navigate.kb.meta","ctrl + click"):Qe?p("links.navigate.kb.alt.mac","option + click"):p("links.navigate.kb.alt","alt + click");o.part.location&&o.part.command?c=new zn().appendText(p("hint.defAndCommand","Go to Definition ({0}), right click for more",h)):o.part.location?c=new zn().appendText(p("hint.def","Go to Definition ({0})",h)):o.part.command&&(c=new zn(`[${p("hint.cmd","Execute Command")}](${WSe(o.part.command)} "${o.part.command.title}") (${h})`,{isTrusted:!0})),c&&n.emitOne(new $r(this,e.range,[c],!1,1e4))}const l=await this._resolveInlayHintLabelPartHover(o,i);for await(const c of l)n.emitOne(c)}):zi.EMPTY}async _resolveInlayHintLabelPartHover(e,t){if(!e.part.location)return zi.EMPTY;const{uri:i,range:n}=e.part.location,o=await this._resolverService.createModelReference(i);try{const r=o.object.textEditorModel;return this._languageFeaturesService.hoverProvider.has(r)?ZF(this._languageFeaturesService.hoverProvider,r,new P(n.startLineNumber,n.startColumn),t).filter(a=>!Mp(a.hover.contents)).map(a=>new $r(this,e.item.anchor.range,a.hover.contents,!1,2+a.ordinal)):zi.EMPTY}finally{o.dispose()}}};PS=hLe([ld(1,ni),ld(2,Ys),ld(3,yt),ld(4,Vl),ld(5,Ke),ld(6,qs),ld(7,pe),ld(8,Ht)],PS);class e4 extends B{constructor(e,t,i,n,o,r){super();const a=t.anchor,l=t.hoverParts;this._renderedHoverParts=this._register(new t4(e,i,l,r,o));const{showAtPosition:c,showAtSecondaryPosition:d}=e4.computeHoverPositions(e,a.range,l);this.shouldAppearBeforeContent=l.some(h=>h.isBeforeContent),this.showAtPosition=c,this.showAtSecondaryPosition=d,this.initialMousePosX=a.initialMousePosX,this.initialMousePosY=a.initialMousePosY,this.shouldFocus=n.shouldFocus,this.source=n.source}get domNode(){return this._renderedHoverParts.domNode}get domNodeHasChildren(){return this._renderedHoverParts.domNodeHasChildren}get focusedHoverPartIndex(){return this._renderedHoverParts.focusedHoverPartIndex}async updateHoverVerbosityLevel(e,t,i){this._renderedHoverParts.updateHoverVerbosityLevel(e,t,i)}isColorPickerVisible(){return this._renderedHoverParts.isColorPickerVisible()}static computeHoverPositions(e,t,i){let n=1;if(e.hasModel()){const d=e._getViewModel(),h=d.coordinatesConverter,u=h.convertModelRangeToViewRange(t),g=d.getLineMinColumn(u.startLineNumber),f=new P(u.startLineNumber,g);n=h.convertViewPositionToModelPosition(f).column}const o=t.startLineNumber;let r=t.startColumn,a;for(const d of i){const h=d.range,u=h.startLineNumber===o,g=h.endLineNumber===o;if(u&&g){const m=h.startColumn,_=Math.min(r,m);r=Math.max(_,n)}d.forceShowAtRange&&(a=h)}let l,c;if(a){const d=a.getStartPosition();l=d,c=d}else l=t.getStartPosition(),c=new P(o,r);return{showAtPosition:l,showAtSecondaryPosition:c}}}class uLe{constructor(e,t){this._statusBar=t,e.appendChild(this._statusBar.hoverElement)}get hoverElement(){return this._statusBar.hoverElement}get actions(){return this._statusBar.actions}dispose(){this._statusBar.dispose()}}class t4 extends B{static{this._DECORATION_OPTIONS=We.register({description:"content-hover-highlight",className:"hoverHighlight"})}constructor(e,t,i,n,o){super(),this._renderedParts=[],this._focusedHoverPartIndex=-1,this._context=o,this._fragment=document.createDocumentFragment(),this._register(this._renderParts(t,i,o,n)),this._register(this._registerListenersOnRenderedParts()),this._register(this._createEditorDecorations(e,i)),this._updateMarkdownAndColorParticipantInfo(t)}_createEditorDecorations(e,t){if(t.length===0)return B.None;let i=t[0].range;for(const o of t){const r=o.range;i=k.plusRange(i,r)}const n=e.createDecorationsCollection();return n.set([{range:i,options:t4._DECORATION_OPTIONS}]),Ce(()=>{n.clear()})}_renderParts(e,t,i,n){const o=new ES(n),r={fragment:this._fragment,statusBar:o,...i},a=new Z;for(const c of e){const d=this._renderHoverPartsForParticipant(t,c,r);a.add(d);for(const h of d.renderedHoverParts)this._renderedParts.push({type:"hoverPart",participant:c,hoverPart:h.hoverPart,hoverElement:h.hoverElement})}const l=this._renderStatusBar(this._fragment,o);return l&&(a.add(l),this._renderedParts.push({type:"statusBar",hoverElement:l.hoverElement,actions:l.actions})),Ce(()=>{a.dispose()})}_renderHoverPartsForParticipant(e,t,i){const n=e.filter(r=>r.owner===t);return n.length>0?t.renderHoverParts(i,n):new lg([])}_renderStatusBar(e,t){if(t.hasContent)return new uLe(e,t)}_registerListenersOnRenderedParts(){const e=new Z;return this._renderedParts.forEach((t,i)=>{const n=t.hoverElement;n.tabIndex=0,e.add(U(n,ee.FOCUS_IN,o=>{o.stopPropagation(),this._focusedHoverPartIndex=i})),e.add(U(n,ee.FOCUS_OUT,o=>{o.stopPropagation(),this._focusedHoverPartIndex=-1}))}),e}_updateMarkdownAndColorParticipantInfo(e){const t=e.find(i=>i instanceof qv&&!(i instanceof PS));t&&(this._markdownHoverParticipant=t),this._colorHoverParticipant=e.find(i=>i instanceof Zv)}async updateHoverVerbosityLevel(e,t,i){if(!this._markdownHoverParticipant)return;const n=this._normalizedIndexToMarkdownHoverIndexRange(this._markdownHoverParticipant,t);if(n===void 0)return;const o=await this._markdownHoverParticipant.updateMarkdownHoverVerbosityLevel(e,n,i);o&&(this._renderedParts[t]={type:"hoverPart",participant:this._markdownHoverParticipant,hoverPart:o.hoverPart,hoverElement:o.hoverElement},this._context.onContentsChanged())}isColorPickerVisible(){return this._colorHoverParticipant?.isColorPickerVisible()??!1}_normalizedIndexToMarkdownHoverIndexRange(e,t){const i=this._renderedParts[t];if(!i||i.type!=="hoverPart"||!(i.participant===e))return;const o=this._renderedParts.findIndex(r=>r.type==="hoverPart"&&r.participant===e);if(o===-1)throw new mt;return t-o}get domNode(){return this._fragment}get domNodeHasChildren(){return this._fragment.hasChildNodes()}get focusedHoverPartIndex(){return this._focusedHoverPartIndex}}var gLe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},D7=function(s,e){return function(t,i){e(t,i,s)}};let EM=class extends B{constructor(e,t,i){super(),this._editor=e,this._instantiationService=t,this._keybindingService=i,this._currentResult=null,this._onContentsChanged=this._register(new O),this.onContentsChanged=this._onContentsChanged.event,this._contentHoverWidget=this._register(this._instantiationService.createInstance(mM,this._editor)),this._participants=this._initializeHoverParticipants(),this._computer=new TS(this._editor,this._participants),this._hoverOperation=this._register(new WZ(this._editor,this._computer)),this._registerListeners()}_initializeHoverParticipants(){const e=[];for(const t of Dg.getAll()){const i=this._instantiationService.createInstance(t,this._editor);e.push(i)}return e.sort((t,i)=>t.hoverOrdinal-i.hoverOrdinal),this._register(this._contentHoverWidget.onDidResize(()=>{this._participants.forEach(t=>t.handleResize?.())})),e}_registerListeners(){this._register(this._hoverOperation.onResult(t=>{if(!this._computer.anchor)return;const i=t.hasLoadingMessage?this._addLoadingMessage(t.value):t.value;this._withResult(new HZ(this._computer.anchor,i,t.isComplete))}));const e=this._contentHoverWidget.getDomNode();this._register(gi(e,"keydown",t=>{t.equals(9)&&this.hide()})),this._register(gi(e,"mouseleave",t=>{this._onMouseLeave(t)})),this._register(mi.onDidChange(()=>{this._contentHoverWidget.position&&this._currentResult&&this._setCurrentResult(this._currentResult)}))}_startShowingOrUpdateHover(e,t,i,n,o){if(!(this._contentHoverWidget.position&&this._currentResult))return e?(this._startHoverOperationIfNecessary(e,t,i,n,!1),!0):!1;const a=this._editor.getOption(60).sticky,l=o&&this._contentHoverWidget.isMouseGettingCloser(o.event.posx,o.event.posy);return a&&l?(e&&this._startHoverOperationIfNecessary(e,t,i,n,!0),!0):e?this._currentResult.anchor.equals(e)?!0:e.canAdoptVisibleHover(this._currentResult.anchor,this._contentHoverWidget.position)?(this._setCurrentResult(this._currentResult.filter(e)),this._startHoverOperationIfNecessary(e,t,i,n,!1),!0):(this._setCurrentResult(null),this._startHoverOperationIfNecessary(e,t,i,n,!1),!0):(this._setCurrentResult(null),!1)}_startHoverOperationIfNecessary(e,t,i,n,o){this._computer.anchor&&this._computer.anchor.equals(e)||(this._hoverOperation.cancel(),this._computer.anchor=e,this._computer.shouldFocus=n,this._computer.source=i,this._computer.insistOnKeepingHoverVisible=o,this._hoverOperation.start(t))}_setCurrentResult(e){let t=e;if(this._currentResult===t)return;t&&t.hoverParts.length===0&&(t=null),this._currentResult=t,this._currentResult?this._showHover(this._currentResult):this._hideHover()}_addLoadingMessage(e){if(!this._computer.anchor)return e;for(const t of this._participants){if(!t.createLoadingMessage)continue;const i=t.createLoadingMessage(this._computer.anchor);if(i)return e.slice(0).concat([i])}return e}_withResult(e){if(this._contentHoverWidget.position&&this._currentResult&&this._currentResult.isComplete||this._setCurrentResult(e),!e.isComplete)return;const n=e.hoverParts.length===0,o=this._computer.insistOnKeepingHoverVisible;n&&o||this._setCurrentResult(e)}_showHover(e){const t=this._getHoverContext();this._renderedContentHover=new e4(this._editor,e,this._participants,this._computer,t,this._keybindingService),this._renderedContentHover.domNodeHasChildren?this._contentHoverWidget.show(this._renderedContentHover):this._renderedContentHover.dispose()}_hideHover(){this._contentHoverWidget.hide()}_getHoverContext(){return{hide:()=>{this.hide()},onContentsChanged:()=>{this._onContentsChanged.fire(),this._contentHoverWidget.onContentsChanged()},setMinimumDimensions:n=>{this._contentHoverWidget.setMinimumDimensions(n)}}}showsOrWillShow(e){if(this._contentHoverWidget.isResizing)return!0;const i=this._findHoverAnchorCandidates(e);if(!(i.length>0))return this._startShowingOrUpdateHover(null,0,0,!1,e);const o=i[0];return this._startShowingOrUpdateHover(o,0,0,!1,e)}_findHoverAnchorCandidates(e){const t=[];for(const n of this._participants){if(!n.suggestHoverAnchor)continue;const o=n.suggestHoverAnchor(e);o&&t.push(o)}const i=e.target;switch(i.type){case 6:{t.push(new dI(0,i.range,e.event.posx,e.event.posy));break}case 7:{const n=this._editor.getOption(50).typicalHalfwidthCharacterWidth/2;if(!(!i.detail.isAfterLines&&typeof i.detail.horizontalDistanceToText=="number"&&i.detail.horizontalDistanceToText<n))break;t.push(new dI(0,i.range,e.event.posx,e.event.posy));break}}return t.sort((n,o)=>o.priority-n.priority),t}_onMouseLeave(e){const t=this._editor.getDomNode();(!t||!qx(t,e.x,e.y))&&this.hide()}startShowingAtRange(e,t,i,n){this._startShowingOrUpdateHover(new dI(0,e,void 0,void 0),t,i,n,null)}async updateHoverVerbosityLevel(e,t,i){this._renderedContentHover?.updateHoverVerbosityLevel(e,t,i)}focusedHoverPartIndex(){return this._renderedContentHover?.focusedHoverPartIndex??-1}containsNode(e){return e?this._contentHoverWidget.getDomNode().contains(e):!1}focus(){this._contentHoverWidget.focus()}scrollUp(){this._contentHoverWidget.scrollUp()}scrollDown(){this._contentHoverWidget.scrollDown()}scrollLeft(){this._contentHoverWidget.scrollLeft()}scrollRight(){this._contentHoverWidget.scrollRight()}pageUp(){this._contentHoverWidget.pageUp()}pageDown(){this._contentHoverWidget.pageDown()}goToTop(){this._contentHoverWidget.goToTop()}goToBottom(){this._contentHoverWidget.goToBottom()}hide(){this._computer.anchor=null,this._hoverOperation.cancel(),this._setCurrentResult(null)}getDomNode(){return this._contentHoverWidget.getDomNode()}get isColorPickerVisible(){return this._renderedContentHover?.isColorPickerVisible()??!1}get isVisibleFromKeyboard(){return this._contentHoverWidget.isVisibleFromKeyboard}get isVisible(){return this._contentHoverWidget.isVisible}get isFocused(){return this._contentHoverWidget.isFocused}get isResizing(){return this._contentHoverWidget.isResizing}get widget(){return this._contentHoverWidget}};EM=gLe([D7(1,ye),D7(2,yt)],EM);var fLe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},I7=function(s,e){return function(t,i){e(t,i,s)}},NM;const pLe=!1;let as=class extends B{static{NM=this}static{this.ID="editor.contrib.contentHover"}constructor(e,t,i){super(),this._editor=e,this._instantiationService=t,this._keybindingService=i,this._onHoverContentsChanged=this._register(new O),this.shouldKeepOpenOnEditorMouseMoveOrLeave=!1,this._listenersStore=new Z,this._hoverState={mouseDown:!1,activatedByDecoratorClick:!1},this._reactToEditorMouseMoveRunner=this._register(new It(()=>this._reactToEditorMouseMove(this._mouseMoveEvent),0)),this._hookListeners(),this._register(this._editor.onDidChangeConfiguration(n=>{n.hasChanged(60)&&(this._unhookListeners(),this._hookListeners())}))}static get(e){return e.getContribution(NM.ID)}_hookListeners(){const e=this._editor.getOption(60);this._hoverSettings={enabled:e.enabled,sticky:e.sticky,hidingDelay:e.hidingDelay},e.enabled?(this._listenersStore.add(this._editor.onMouseDown(t=>this._onEditorMouseDown(t))),this._listenersStore.add(this._editor.onMouseUp(()=>this._onEditorMouseUp())),this._listenersStore.add(this._editor.onMouseMove(t=>this._onEditorMouseMove(t))),this._listenersStore.add(this._editor.onKeyDown(t=>this._onKeyDown(t)))):(this._listenersStore.add(this._editor.onMouseMove(t=>this._onEditorMouseMove(t))),this._listenersStore.add(this._editor.onKeyDown(t=>this._onKeyDown(t)))),this._listenersStore.add(this._editor.onMouseLeave(t=>this._onEditorMouseLeave(t))),this._listenersStore.add(this._editor.onDidChangeModel(()=>{this._cancelScheduler(),this._hideWidgets()})),this._listenersStore.add(this._editor.onDidChangeModelContent(()=>this._cancelScheduler())),this._listenersStore.add(this._editor.onDidScrollChange(t=>this._onEditorScrollChanged(t)))}_unhookListeners(){this._listenersStore.clear()}_cancelScheduler(){this._mouseMoveEvent=void 0,this._reactToEditorMouseMoveRunner.cancel()}_onEditorScrollChanged(e){(e.scrollTopChanged||e.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(e){this._hoverState.mouseDown=!0,!this._shouldNotHideCurrentHoverWidget(e)&&this._hideWidgets()}_shouldNotHideCurrentHoverWidget(e){return this._isMouseOnContentHoverWidget(e)||this._isContentWidgetResizing()}_isMouseOnContentHoverWidget(e){const t=this._contentWidget?.getDomNode();return t?qx(t,e.event.posx,e.event.posy):!1}_onEditorMouseUp(){this._hoverState.mouseDown=!1}_onEditorMouseLeave(e){this.shouldKeepOpenOnEditorMouseMoveOrLeave||(this._cancelScheduler(),this._shouldNotHideCurrentHoverWidget(e))||this._hideWidgets()}_shouldNotRecomputeCurrentHoverWidget(e){const t=this._hoverSettings.sticky,i=(r,a)=>{const l=this._isMouseOnContentHoverWidget(r);return a&&l},n=r=>{const a=this._isMouseOnContentHoverWidget(r),l=this._contentWidget?.isColorPickerVisible??!1;return a&&l},o=(r,a)=>(a&&this._contentWidget?.containsNode(r.event.browserEvent.view?.document.activeElement)&&!r.event.browserEvent.view?.getSelection()?.isCollapsed)??!1;return i(e,t)||n(e)||o(e,t)}_onEditorMouseMove(e){if(this.shouldKeepOpenOnEditorMouseMoveOrLeave||(this._mouseMoveEvent=e,this._contentWidget?.isFocused||this._contentWidget?.isResizing))return;const t=this._hoverSettings.sticky;if(t&&this._contentWidget?.isVisibleFromKeyboard)return;if(this._shouldNotRecomputeCurrentHoverWidget(e)){this._reactToEditorMouseMoveRunner.cancel();return}const n=this._hoverSettings.hidingDelay;if(this._contentWidget?.isVisible&&t&&n>0){this._reactToEditorMouseMoveRunner.isScheduled()||this._reactToEditorMouseMoveRunner.schedule(n);return}this._reactToEditorMouseMove(e)}_reactToEditorMouseMove(e){if(!e)return;const i=e.target.element?.classList.contains("colorpicker-color-decoration"),n=this._editor.getOption(149),o=this._hoverSettings.enabled,r=this._hoverState.activatedByDecoratorClick;if(i&&(n==="click"&&!r||n==="hover"&&!o&&!pLe||n==="clickAndHover"&&!o&&!r)||!i&&!o&&!r){this._hideWidgets();return}this._tryShowHoverWidget(e)||this._hideWidgets()}_tryShowHoverWidget(e){return this._getOrCreateContentWidget().showsOrWillShow(e)}_onKeyDown(e){if(!this._editor.hasModel())return;const t=this._keybindingService.softDispatch(e,this._editor.getDomNode()),i=t.kind===1||t.kind===2&&(t.commandId===PZ||t.commandId===Zx||t.commandId===Kx)&&this._contentWidget?.isVisible;e.keyCode===5||e.keyCode===6||e.keyCode===57||e.keyCode===4||i||this._hideWidgets()}_hideWidgets(){this._hoverState.mouseDown&&this._contentWidget?.isColorPickerVisible||Xp.dropDownVisible||(this._hoverState.activatedByDecoratorClick=!1,this._contentWidget?.hide())}_getOrCreateContentWidget(){return this._contentWidget||(this._contentWidget=this._instantiationService.createInstance(EM,this._editor),this._listenersStore.add(this._contentWidget.onContentsChanged(()=>this._onHoverContentsChanged.fire()))),this._contentWidget}showContentHover(e,t,i,n,o=!1){this._hoverState.activatedByDecoratorClick=o,this._getOrCreateContentWidget().startShowingAtRange(e,t,i,n)}_isContentWidgetResizing(){return this._contentWidget?.widget.isResizing||!1}focusedHoverPartIndex(){return this._getOrCreateContentWidget().focusedHoverPartIndex()}updateHoverVerbosityLevel(e,t,i){this._getOrCreateContentWidget().updateHoverVerbosityLevel(e,t,i)}focus(){this._contentWidget?.focus()}scrollUp(){this._contentWidget?.scrollUp()}scrollDown(){this._contentWidget?.scrollDown()}scrollLeft(){this._contentWidget?.scrollLeft()}scrollRight(){this._contentWidget?.scrollRight()}pageUp(){this._contentWidget?.pageUp()}pageDown(){this._contentWidget?.pageDown()}goToTop(){this._contentWidget?.goToTop()}goToBottom(){this._contentWidget?.goToBottom()}get isColorPickerVisible(){return this._contentWidget?.isColorPickerVisible}get isHoverVisible(){return this._contentWidget?.isVisible}dispose(){super.dispose(),this._unhookListeners(),this._listenersStore.dispose(),this._contentWidget?.dispose()}};as=NM=fLe([I7(1,ye),I7(2,yt)],as);class T7 extends B{static{this.ID="editor.contrib.colorContribution"}constructor(e){super(),this._editor=e,this._register(e.onMouseDown(t=>this.onMouseDown(t)))}dispose(){super.dispose()}onMouseDown(e){const t=this._editor.getOption(149);if(t!=="click"&&t!=="clickAndHover")return;const i=e.target;if(i.type!==6||!i.detail.injectedText||i.detail.injectedText.options.attachedData!==IZ||!i.range)return;const n=this._editor.getContribution(as.ID);if(n&&!n.isColorPickerVisible){const o=new k(i.range.startLineNumber,i.range.startColumn+1,i.range.endLineNumber,i.range.endColumn+1);n.showContentHover(o,1,0,!1,!0)}}}ct(T7.ID,T7,2);Dg.register(Zv);var cK=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Wf=function(s,e){return function(t,i){e(t,i,s)}},RM,MM;let dg=class extends B{static{RM=this}static{this.ID="editor.contrib.standaloneColorPickerController"}constructor(e,t,i){super(),this._editor=e,this._instantiationService=i,this._standaloneColorPickerWidget=null,this._standaloneColorPickerVisible=I.standaloneColorPickerVisible.bindTo(t),this._standaloneColorPickerFocused=I.standaloneColorPickerFocused.bindTo(t)}showOrFocus(){this._editor.hasModel()&&(this._standaloneColorPickerVisible.get()?this._standaloneColorPickerFocused.get()||this._standaloneColorPickerWidget?.focus():this._standaloneColorPickerWidget=this._instantiationService.createInstance(AM,this._editor,this._standaloneColorPickerVisible,this._standaloneColorPickerFocused))}hide(){this._standaloneColorPickerFocused.set(!1),this._standaloneColorPickerVisible.set(!1),this._standaloneColorPickerWidget?.hide(),this._editor.focus()}insertColor(){this._standaloneColorPickerWidget?.updateEditor(),this.hide()}static get(e){return e.getContribution(RM.ID)}};dg=RM=cK([Wf(1,Ee),Wf(2,ye)],dg);ct(dg.ID,dg,1);const E7=8,mLe=22;let AM=class extends B{static{MM=this}static{this.ID="editor.contrib.standaloneColorPickerWidget"}constructor(e,t,i,n,o,r,a){super(),this._editor=e,this._standaloneColorPickerVisible=t,this._standaloneColorPickerFocused=i,this._keybindingService=o,this._languageFeaturesService=r,this._editorWorkerService=a,this.allowEditorOverflow=!0,this._position=void 0,this._body=document.createElement("div"),this._colorHover=null,this._selectionSetInEditor=!1,this._onResult=this._register(new O),this.onResult=this._onResult.event,this._standaloneColorPickerVisible.set(!0),this._standaloneColorPickerParticipant=n.createInstance(Kv,this._editor),this._position=this._editor._getViewModel()?.getPrimaryCursorState().modelState.position;const l=this._editor.getSelection(),c=l?{startLineNumber:l.startLineNumber,startColumn:l.startColumn,endLineNumber:l.endLineNumber,endColumn:l.endColumn}:{startLineNumber:0,endLineNumber:0,endColumn:0,startColumn:0},d=this._register(Wa(this._body));this._register(d.onDidBlur(h=>{this.hide()})),this._register(d.onDidFocus(h=>{this.focus()})),this._register(this._editor.onDidChangeCursorPosition(()=>{this._selectionSetInEditor?this._selectionSetInEditor=!1:this.hide()})),this._register(this._editor.onMouseMove(h=>{const u=h.target.element?.classList;u&&u.contains("colorpicker-color-decoration")&&this.hide()})),this._register(this.onResult(h=>{this._render(h.value,h.foundInEditor)})),this._start(c),this._body.style.zIndex="50",this._editor.addContentWidget(this)}updateEditor(){this._colorHover&&this._standaloneColorPickerParticipant.updateEditorModel(this._colorHover)}getId(){return MM.ID}getDomNode(){return this._body}getPosition(){if(!this._position)return null;const e=this._editor.getOption(60).above;return{position:this._position,secondaryPosition:this._position,preference:e?[1,2]:[2,1],positionAffinity:2}}hide(){this.dispose(),this._standaloneColorPickerVisible.set(!1),this._standaloneColorPickerFocused.set(!1),this._editor.removeContentWidget(this),this._editor.focus()}focus(){this._standaloneColorPickerFocused.set(!0),this._body.focus()}async _start(e){const t=await this._computeAsync(e);t&&this._onResult.fire(new _Le(t.result,t.foundInEditor))}async _computeAsync(e){if(!this._editor.hasModel())return null;const t={range:e,color:{red:0,green:0,blue:0,alpha:1}},i=await this._standaloneColorPickerParticipant.createColorHover(t,new jv(this._editorWorkerService),this._languageFeaturesService.colorProvider);return i?{result:i.colorHover,foundInEditor:i.foundInEditor}:null}_render(e,t){const i=document.createDocumentFragment(),n=this._register(new ES(this._keybindingService)),o={fragment:i,statusBar:n,onContentsChanged:()=>{},hide:()=>this.hide()};this._colorHover=e;const r=this._standaloneColorPickerParticipant.renderHoverParts(o,[e]);if(!r)return;this._register(r.disposables);const a=r.colorPicker;this._body.classList.add("standalone-colorpicker-body"),this._body.style.maxHeight=Math.max(this._editor.getLayoutInfo().height/4,250)+"px",this._body.style.maxWidth=Math.max(this._editor.getLayoutInfo().width*.66,500)+"px",this._body.tabIndex=0,this._body.appendChild(i),a.layout();const l=a.body,c=l.saturationBox.domNode.clientWidth,d=l.domNode.clientWidth-c-mLe-E7,h=a.body.enterButton;h?.onClicked(()=>{this.updateEditor(),this.hide()});const u=a.header,g=u.pickedColorNode;g.style.width=c+E7+"px";const f=u.originalColorNode;f.style.width=d+"px",a.header.closeButton?.onClicked(()=>{this.hide()}),t&&(h&&(h.button.textContent="Replace"),this._selectionSetInEditor=!0,this._editor.setSelection(e.range)),this._editor.layoutContentWidget(this)}};AM=MM=cK([Wf(3,ye),Wf(4,yt),Wf(5,pe),Wf(6,Xs)],AM);class _Le{constructor(e,t){this.value=e,this.foundInEditor=t}}class bLe extends Za{constructor(){super({id:"editor.action.showOrFocusStandaloneColorPicker",title:{...Re("showOrFocusStandaloneColorPicker","Show or Focus Standalone Color Picker"),mnemonicTitle:p({key:"mishowOrFocusStandaloneColorPicker",comment:["&& denotes a mnemonic"]},"&&Show or Focus Standalone Color Picker")},precondition:void 0,menu:[{id:M.CommandPalette}],metadata:{description:Re("showOrFocusStandaloneColorPickerDescription","Show or focus a standalone color picker which uses the default color provider. It displays hex/rgb/hsl colors.")}})}runEditorCommand(e,t){dg.get(t)?.showOrFocus()}}class vLe extends ge{constructor(){super({id:"editor.action.hideColorPicker",label:p({key:"hideColorPicker",comment:["Action that hides the color picker"]},"Hide the Color Picker"),alias:"Hide the Color Picker",precondition:I.standaloneColorPickerVisible.isEqualTo(!0),kbOpts:{primary:9,weight:100},metadata:{description:Re("hideColorPickerDescription","Hide the standalone color picker.")}})}run(e,t){dg.get(t)?.hide()}}class CLe extends ge{constructor(){super({id:"editor.action.insertColorWithStandaloneColorPicker",label:p({key:"insertColorWithStandaloneColorPicker",comment:["Action that inserts color with standalone color picker"]},"Insert Color with Standalone Color Picker"),alias:"Insert Color with Standalone Color Picker",precondition:I.standaloneColorPickerFocused.isEqualTo(!0),kbOpts:{primary:3,weight:100},metadata:{description:Re("insertColorWithStandaloneColorPickerDescription","Insert hex/rgb/hsl colors with the focused standalone color picker.")}})}run(e,t){dg.get(t)?.insertColor()}}Q(vLe);Q(CLe);Bt(bLe);class Hd{constructor(e,t,i){this.languageConfigurationService=i,this._selection=e,this._insertSpace=t,this._usedEndToken=null}static _haystackHasNeedleAtOffset(e,t,i){if(i<0)return!1;const n=t.length,o=e.length;if(i+n>o)return!1;for(let r=0;r<n;r++){const a=e.charCodeAt(i+r),l=t.charCodeAt(r);if(a!==l&&!(a>=65&&a<=90&&a+32===l)&&!(l>=65&&l<=90&&l+32===a))return!1}return!0}_createOperationsForBlockComment(e,t,i,n,o,r){const a=e.startLineNumber,l=e.startColumn,c=e.endLineNumber,d=e.endColumn,h=o.getLineContent(a),u=o.getLineContent(c);let g=h.lastIndexOf(t,l-1+t.length),f=u.indexOf(i,d-1-i.length);if(g!==-1&&f!==-1)if(a===c)h.substring(g+t.length,f).indexOf(i)>=0&&(g=-1,f=-1);else{const _=h.substring(g+t.length),b=u.substring(0,f);(_.indexOf(i)>=0||b.indexOf(i)>=0)&&(g=-1,f=-1)}let m;g!==-1&&f!==-1?(n&&g+t.length<h.length&&h.charCodeAt(g+t.length)===32&&(t=t+" "),n&&f>0&&u.charCodeAt(f-1)===32&&(i=" "+i,f-=1),m=Hd._createRemoveBlockCommentOperations(new k(a,g+t.length+1,c,f+1),t,i)):(m=Hd._createAddBlockCommentOperations(e,t,i,this._insertSpace),this._usedEndToken=m.length===1?i:null);for(const _ of m)r.addTrackedEditOperation(_.range,_.text)}static _createRemoveBlockCommentOperations(e,t,i){const n=[];return k.isEmpty(e)?n.push(ri.delete(new k(e.startLineNumber,e.startColumn-t.length,e.endLineNumber,e.endColumn+i.length))):(n.push(ri.delete(new k(e.startLineNumber,e.startColumn-t.length,e.startLineNumber,e.startColumn))),n.push(ri.delete(new k(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn+i.length)))),n}static _createAddBlockCommentOperations(e,t,i,n){const o=[];return k.isEmpty(e)?o.push(ri.replace(new k(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),t+"  "+i)):(o.push(ri.insert(new P(e.startLineNumber,e.startColumn),t+(n?" ":""))),o.push(ri.insert(new P(e.endLineNumber,e.endColumn),(n?" ":"")+i))),o}getEditOperations(e,t){const i=this._selection.startLineNumber,n=this._selection.startColumn;e.tokenization.tokenizeIfCheap(i);const o=e.getLanguageIdAtPosition(i,n),r=this.languageConfigurationService.getLanguageConfiguration(o).comments;!r||!r.blockCommentStartToken||!r.blockCommentEndToken||this._createOperationsForBlockComment(this._selection,r.blockCommentStartToken,r.blockCommentEndToken,this._insertSpace,e,t)}computeCursorState(e,t){const i=t.getInverseEditOperations();if(i.length===2){const n=i[0],o=i[1];return new me(n.range.endLineNumber,n.range.endColumn,o.range.startLineNumber,o.range.startColumn)}else{const n=i[0].range,o=this._usedEndToken?-this._usedEndToken.length-1:0;return new me(n.endLineNumber,n.endColumn+o,n.endLineNumber,n.endColumn+o)}}}class rc{constructor(e,t,i,n,o,r,a){this.languageConfigurationService=e,this._selection=t,this._indentSize=i,this._type=n,this._insertSpace=o,this._selectionId=null,this._deltaColumn=0,this._moveEndPositionDown=!1,this._ignoreEmptyLines=r,this._ignoreFirstLine=a||!1}static _gatherPreflightCommentStrings(e,t,i,n){e.tokenization.tokenizeIfCheap(t);const o=e.getLanguageIdAtPosition(t,1),r=n.getLanguageConfiguration(o).comments,a=r?r.lineCommentToken:null;if(!a)return null;const l=[];for(let c=0,d=i-t+1;c<d;c++)l[c]={ignore:!1,commentStr:a,commentStrOffset:0,commentStrLength:a.length};return l}static _analyzeLines(e,t,i,n,o,r,a,l){let c=!0,d;e===0?d=!0:e===1?d=!1:d=!0;for(let h=0,u=n.length;h<u;h++){const g=n[h],f=o+h;if(f===o&&a){g.ignore=!0;continue}const m=i.getLineContent(f),_=rs(m);if(_===-1){g.ignore=r,g.commentStrOffset=m.length;continue}if(c=!1,g.ignore=!1,g.commentStrOffset=_,d&&!Hd._haystackHasNeedleAtOffset(m,g.commentStr,_)&&(e===0?d=!1:e===1||(g.ignore=!0)),d&&t){const b=_+g.commentStrLength;b<m.length&&m.charCodeAt(b)===32&&(g.commentStrLength+=1)}}if(e===0&&c){d=!1;for(let h=0,u=n.length;h<u;h++)n[h].ignore=!1}return{supported:!0,shouldRemoveComments:d,lines:n}}static _gatherPreflightData(e,t,i,n,o,r,a,l){const c=rc._gatherPreflightCommentStrings(i,n,o,l);return c===null?{supported:!1}:rc._analyzeLines(e,t,i,c,n,r,a,l)}_executeLineComments(e,t,i,n){let o;i.shouldRemoveComments?o=rc._createRemoveLineCommentsOperations(i.lines,n.startLineNumber):(rc._normalizeInsertionPoint(e,i.lines,n.startLineNumber,this._indentSize),o=this._createAddLineCommentsOperations(i.lines,n.startLineNumber));const r=new P(n.positionLineNumber,n.positionColumn);for(let a=0,l=o.length;a<l;a++)t.addEditOperation(o[a].range,o[a].text),k.isEmpty(o[a].range)&&k.getStartPosition(o[a].range).equals(r)&&e.getLineContent(r.lineNumber).length+1===r.column&&(this._deltaColumn=(o[a].text||"").length);this._selectionId=t.trackSelection(n)}_attemptRemoveBlockComment(e,t,i,n){let o=t.startLineNumber,r=t.endLineNumber;const a=n.length+Math.max(e.getLineFirstNonWhitespaceColumn(t.startLineNumber),t.startColumn);let l=e.getLineContent(o).lastIndexOf(i,a-1),c=e.getLineContent(r).indexOf(n,t.endColumn-1-i.length);return l!==-1&&c===-1&&(c=e.getLineContent(o).indexOf(n,l+i.length),r=o),l===-1&&c!==-1&&(l=e.getLineContent(r).lastIndexOf(i,c),o=r),t.isEmpty()&&(l===-1||c===-1)&&(l=e.getLineContent(o).indexOf(i),l!==-1&&(c=e.getLineContent(o).indexOf(n,l+i.length))),l!==-1&&e.getLineContent(o).charCodeAt(l+i.length)===32&&(i+=" "),c!==-1&&e.getLineContent(r).charCodeAt(c-1)===32&&(n=" "+n,c-=1),l!==-1&&c!==-1?Hd._createRemoveBlockCommentOperations(new k(o,l+i.length+1,r,c+1),i,n):null}_executeBlockComment(e,t,i){e.tokenization.tokenizeIfCheap(i.startLineNumber);const n=e.getLanguageIdAtPosition(i.startLineNumber,1),o=this.languageConfigurationService.getLanguageConfiguration(n).comments;if(!o||!o.blockCommentStartToken||!o.blockCommentEndToken)return;const r=o.blockCommentStartToken,a=o.blockCommentEndToken;let l=this._attemptRemoveBlockComment(e,i,r,a);if(!l){if(i.isEmpty()){const c=e.getLineContent(i.startLineNumber);let d=rs(c);d===-1&&(d=c.length),l=Hd._createAddBlockCommentOperations(new k(i.startLineNumber,d+1,i.startLineNumber,c.length+1),r,a,this._insertSpace)}else l=Hd._createAddBlockCommentOperations(new k(i.startLineNumber,e.getLineFirstNonWhitespaceColumn(i.startLineNumber),i.endLineNumber,e.getLineMaxColumn(i.endLineNumber)),r,a,this._insertSpace);l.length===1&&(this._deltaColumn=r.length+1)}this._selectionId=t.trackSelection(i);for(const c of l)t.addEditOperation(c.range,c.text)}getEditOperations(e,t){let i=this._selection;if(this._moveEndPositionDown=!1,i.startLineNumber===i.endLineNumber&&this._ignoreFirstLine){t.addEditOperation(new k(i.startLineNumber,e.getLineMaxColumn(i.startLineNumber),i.startLineNumber+1,1),i.startLineNumber===e.getLineCount()?"":`
`),this._selectionId=t.trackSelection(i);return}i.startLineNumber<i.endLineNumber&&i.endColumn===1&&(this._moveEndPositionDown=!0,i=i.setEndPosition(i.endLineNumber-1,e.getLineMaxColumn(i.endLineNumber-1)));const n=rc._gatherPreflightData(this._type,this._insertSpace,e,i.startLineNumber,i.endLineNumber,this._ignoreEmptyLines,this._ignoreFirstLine,this.languageConfigurationService);return n.supported?this._executeLineComments(e,t,n,i):this._executeBlockComment(e,t,i)}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(i=i.setEndPosition(i.endLineNumber+1,1)),new me(i.selectionStartLineNumber,i.selectionStartColumn+this._deltaColumn,i.positionLineNumber,i.positionColumn+this._deltaColumn)}static _createRemoveLineCommentsOperations(e,t){const i=[];for(let n=0,o=e.length;n<o;n++){const r=e[n];r.ignore||i.push(ri.delete(new k(t+n,r.commentStrOffset+1,t+n,r.commentStrOffset+r.commentStrLength+1)))}return i}_createAddLineCommentsOperations(e,t){const i=[],n=this._insertSpace?" ":"";for(let o=0,r=e.length;o<r;o++){const a=e[o];a.ignore||i.push(ri.insert(new P(t+o,a.commentStrOffset+1),a.commentStr+n))}return i}static nextVisibleColumn(e,t,i,n){return i?e+(t-e%t):e+n}static _normalizeInsertionPoint(e,t,i,n){let o=1073741824,r,a;for(let l=0,c=t.length;l<c;l++){if(t[l].ignore)continue;const d=e.getLineContent(i+l);let h=0;for(let u=0,g=t[l].commentStrOffset;h<o&&u<g;u++)h=rc.nextVisibleColumn(h,n,d.charCodeAt(u)===9,1);h<o&&(o=h)}o=Math.floor(o/n)*n;for(let l=0,c=t.length;l<c;l++){if(t[l].ignore)continue;const d=e.getLineContent(i+l);let h=0;for(r=0,a=t[l].commentStrOffset;h<o&&r<a;r++)h=rc.nextVisibleColumn(h,n,d.charCodeAt(r)===9,1);h>o?t[l].commentStrOffset=r-1:t[l].commentStrOffset=r}}}class i4 extends ge{constructor(e,t){super(t),this._type=e}run(e,t){const i=e.get(di);if(!t.hasModel())return;const n=t.getModel(),o=[],r=n.getOptions(),a=t.getOption(23),l=t.getSelections().map((d,h)=>({selection:d,index:h,ignoreFirstLine:!1}));l.sort((d,h)=>k.compareRangesUsingStarts(d.selection,h.selection));let c=l[0];for(let d=1;d<l.length;d++){const h=l[d];c.selection.endLineNumber===h.selection.startLineNumber&&(c.index<h.index?h.ignoreFirstLine=!0:(c.ignoreFirstLine=!0,c=h))}for(const d of l)o.push(new rc(i,d.selection,r.indentSize,this._type,a.insertSpace,a.ignoreEmptyLines,d.ignoreFirstLine));t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}class yLe extends i4{constructor(){super(0,{id:"editor.action.commentLine",label:p("comment.line","Toggle Line Comment"),alias:"Toggle Line Comment",precondition:I.writable,kbOpts:{kbExpr:I.editorTextFocus,primary:2138,weight:100},menuOpts:{menuId:M.MenubarEditMenu,group:"5_insert",title:p({key:"miToggleLineComment",comment:["&& denotes a mnemonic"]},"&&Toggle Line Comment"),order:1}})}}class wLe extends i4{constructor(){super(1,{id:"editor.action.addCommentLine",label:p("comment.line.add","Add Line Comment"),alias:"Add Line Comment",precondition:I.writable,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2081),weight:100}})}}class SLe extends i4{constructor(){super(2,{id:"editor.action.removeCommentLine",label:p("comment.line.remove","Remove Line Comment"),alias:"Remove Line Comment",precondition:I.writable,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2099),weight:100}})}}class LLe extends ge{constructor(){super({id:"editor.action.blockComment",label:p("comment.block","Toggle Block Comment"),alias:"Toggle Block Comment",precondition:I.writable,kbOpts:{kbExpr:I.editorTextFocus,primary:1567,linux:{primary:3103},weight:100},menuOpts:{menuId:M.MenubarEditMenu,group:"5_insert",title:p({key:"miToggleBlockComment",comment:["&& denotes a mnemonic"]},"Toggle &&Block Comment"),order:2}})}run(e,t){const i=e.get(di);if(!t.hasModel())return;const n=t.getOption(23),o=[],r=t.getSelections();for(const a of r)o.push(new Hd(a,n.insertSpace,i));t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}Q(yLe);Q(wLe);Q(SLe);Q(LLe);var xLe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},zh=function(s,e){return function(t,i){e(t,i,s)}},PM;let Jp=class{static{PM=this}static{this.ID="editor.contrib.contextmenu"}static get(e){return e.getContribution(PM.ID)}constructor(e,t,i,n,o,r,a,l){this._contextMenuService=t,this._contextViewService=i,this._contextKeyService=n,this._keybindingService=o,this._menuService=r,this._configurationService=a,this._workspaceContextService=l,this._toDispose=new Z,this._contextMenuIsBeingShownCount=0,this._editor=e,this._toDispose.add(this._editor.onContextMenu(c=>this._onContextMenu(c))),this._toDispose.add(this._editor.onMouseWheel(c=>{if(this._contextMenuIsBeingShownCount>0){const d=this._contextViewService.getContextViewElement(),h=c.srcElement;h.shadowRoot&&ju(d)===h.shadowRoot||this._contextViewService.hideContextView()}})),this._toDispose.add(this._editor.onKeyDown(c=>{this._editor.getOption(24)&&c.keyCode===58&&(c.preventDefault(),c.stopPropagation(),this.showContextMenu())}))}_onContextMenu(e){if(!this._editor.hasModel())return;if(!this._editor.getOption(24)){this._editor.focus(),e.target.position&&!this._editor.getSelection().containsPosition(e.target.position)&&this._editor.setPosition(e.target.position);return}if(e.target.type===12||e.target.type===6&&e.target.detail.injectedText)return;if(e.event.preventDefault(),e.event.stopPropagation(),e.target.type===11)return this._showScrollbarContextMenu(e.event);if(e.target.type!==6&&e.target.type!==7&&e.target.type!==1)return;if(this._editor.focus(),e.target.position){let i=!1;for(const n of this._editor.getSelections())if(n.containsPosition(e.target.position)){i=!0;break}i||this._editor.setPosition(e.target.position)}let t=null;e.target.type!==1&&(t=e.event),this.showContextMenu(t)}showContextMenu(e){if(!this._editor.getOption(24)||!this._editor.hasModel())return;const t=this._getMenuActions(this._editor.getModel(),this._editor.contextMenuId);t.length>0&&this._doShowContextMenu(t,e)}_getMenuActions(e,t){const i=[],n=this._menuService.getMenuActions(t,this._contextKeyService,{arg:e.uri});for(const o of n){const[,r]=o;let a=0;for(const l of r)if(l instanceof qf){const c=this._getMenuActions(e,l.item.submenu);c.length>0&&(i.push(new Lp(l.id,l.label,c)),a++)}else i.push(l),a++;a&&i.push(new ji)}return i.length&&i.pop(),i}_doShowContextMenu(e,t=null){if(!this._editor.hasModel())return;const i=this._editor.getOption(60);this._editor.updateOptions({hover:{enabled:!1}});let n=t;if(!n){this._editor.revealPosition(this._editor.getPosition(),1),this._editor.render();const r=this._editor.getScrolledVisiblePosition(this._editor.getPosition()),a=Si(this._editor.getDomNode()),l=a.left+r.left,c=a.top+r.top+r.height;n={x:l,y:c}}const o=this._editor.getOption(128)&&!Oa;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:o?this._editor.getOverflowWidgetsDomNode()??this._editor.getDomNode():void 0,getAnchor:()=>n,getActions:()=>e,getActionViewItem:r=>{const a=this._keybindingFor(r);if(a)return new Bp(r,r,{label:!0,keybinding:a.getLabel(),isMenu:!0});const l=r;return typeof l.getActionViewItem=="function"?l.getActionViewItem():new Bp(r,r,{icon:!0,label:!0,isMenu:!0})},getKeyBinding:r=>this._keybindingFor(r),onHide:r=>{this._contextMenuIsBeingShownCount--,this._editor.updateOptions({hover:i})}})}_showScrollbarContextMenu(e){if(!this._editor.hasModel()||Cce(this._workspaceContextService.getWorkspace()))return;const t=this._editor.getOption(73);let i=0;const n=c=>({id:`menu-action-${++i}`,label:c.label,tooltip:"",class:void 0,enabled:typeof c.enabled>"u"?!0:c.enabled,checked:c.checked,run:c.run}),o=(c,d)=>new Lp(`menu-action-${++i}`,c,d,void 0),r=(c,d,h,u,g)=>{if(!d)return n({label:c,enabled:d,run:()=>{}});const f=_=>()=>{this._configurationService.updateValue(h,_)},m=[];for(const _ of g)m.push(n({label:_.label,checked:u===_.value,run:f(_.value)}));return o(c,m)},a=[];a.push(n({label:p("context.minimap.minimap","Minimap"),checked:t.enabled,run:()=>{this._configurationService.updateValue("editor.minimap.enabled",!t.enabled)}})),a.push(new ji),a.push(n({label:p("context.minimap.renderCharacters","Render Characters"),enabled:t.enabled,checked:t.renderCharacters,run:()=>{this._configurationService.updateValue("editor.minimap.renderCharacters",!t.renderCharacters)}})),a.push(r(p("context.minimap.size","Vertical size"),t.enabled,"editor.minimap.size",t.size,[{label:p("context.minimap.size.proportional","Proportional"),value:"proportional"},{label:p("context.minimap.size.fill","Fill"),value:"fill"},{label:p("context.minimap.size.fit","Fit"),value:"fit"}])),a.push(r(p("context.minimap.slider","Slider"),t.enabled,"editor.minimap.showSlider",t.showSlider,[{label:p("context.minimap.slider.mouseover","Mouse Over"),value:"mouseover"},{label:p("context.minimap.slider.always","Always"),value:"always"}]));const l=this._editor.getOption(128)&&!Oa;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:l?this._editor.getDomNode():void 0,getAnchor:()=>e,getActions:()=>a,onHide:c=>{this._contextMenuIsBeingShownCount--,this._editor.focus()}})}_keybindingFor(e){return this._keybindingService.lookupKeybinding(e.id)}dispose(){this._contextMenuIsBeingShownCount>0&&this._contextViewService.hideContextView(),this._toDispose.dispose()}};Jp=PM=xLe([zh(1,bo),zh(2,Yc),zh(3,Ee),zh(4,yt),zh(5,qo),zh(6,Ke),zh(7,Xu)],Jp);class kLe extends ge{constructor(){super({id:"editor.action.showContextMenu",label:p("action.showContextMenu.label","Show Editor Context Menu"),alias:"Show Editor Context Menu",precondition:void 0,kbOpts:{kbExpr:I.textInputFocus,primary:1092,weight:100}})}run(e,t){Jp.get(t)?.showContextMenu()}}ct(Jp.ID,Jp,2);Q(kLe);class uI{constructor(e){this.selections=e}equals(e){const t=this.selections.length,i=e.selections.length;if(t!==i)return!1;for(let n=0;n<t;n++)if(!this.selections[n].equalsSelection(e.selections[n]))return!1;return!0}}class gI{constructor(e,t,i){this.cursorState=e,this.scrollTop=t,this.scrollLeft=i}}class em extends B{static{this.ID="editor.contrib.cursorUndoRedoController"}static get(e){return e.getContribution(em.ID)}constructor(e){super(),this._editor=e,this._isCursorUndoRedo=!1,this._undoStack=[],this._redoStack=[],this._register(e.onDidChangeModel(t=>{this._undoStack=[],this._redoStack=[]})),this._register(e.onDidChangeModelContent(t=>{this._undoStack=[],this._redoStack=[]})),this._register(e.onDidChangeCursorSelection(t=>{if(this._isCursorUndoRedo||!t.oldSelections||t.oldModelVersionId!==t.modelVersionId)return;const i=new uI(t.oldSelections);this._undoStack.length>0&&this._undoStack[this._undoStack.length-1].cursorState.equals(i)||(this._undoStack.push(new gI(i,e.getScrollTop(),e.getScrollLeft())),this._redoStack=[],this._undoStack.length>50&&this._undoStack.shift())}))}cursorUndo(){!this._editor.hasModel()||this._undoStack.length===0||(this._redoStack.push(new gI(new uI(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._undoStack.pop()))}cursorRedo(){!this._editor.hasModel()||this._redoStack.length===0||(this._undoStack.push(new gI(new uI(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._redoStack.pop()))}_applyState(e){this._isCursorUndoRedo=!0,this._editor.setSelections(e.cursorState.selections),this._editor.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),this._isCursorUndoRedo=!1}}class DLe extends ge{constructor(){super({id:"cursorUndo",label:p("cursor.undo","Cursor Undo"),alias:"Cursor Undo",precondition:void 0,kbOpts:{kbExpr:I.textInputFocus,primary:2099,weight:100}})}run(e,t,i){em.get(t)?.cursorUndo()}}class ILe extends ge{constructor(){super({id:"cursorRedo",label:p("cursor.redo","Cursor Redo"),alias:"Cursor Redo",precondition:void 0})}run(e,t,i){em.get(t)?.cursorRedo()}}ct(em.ID,em,0);Q(DLe);Q(ILe);class TLe{constructor(e,t,i){this.selection=e,this.targetPosition=t,this.copy=i,this.targetSelection=null}getEditOperations(e,t){const i=e.getValueInRange(this.selection);if(this.copy||t.addEditOperation(this.selection,null),t.addEditOperation(new k(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column),i),this.selection.containsPosition(this.targetPosition)&&!(this.copy&&(this.selection.getEndPosition().equals(this.targetPosition)||this.selection.getStartPosition().equals(this.targetPosition)))){this.targetSelection=this.selection;return}if(this.copy){this.targetSelection=new me(this.targetPosition.lineNumber,this.targetPosition.column,this.selection.endLineNumber-this.selection.startLineNumber+this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn);return}if(this.targetPosition.lineNumber>this.selection.endLineNumber){this.targetSelection=new me(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn);return}if(this.targetPosition.lineNumber<this.selection.endLineNumber){this.targetSelection=new me(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber+this.selection.endLineNumber-this.selection.startLineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn);return}this.selection.endColumn<=this.targetPosition.column?this.targetSelection=new me(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column-this.selection.endColumn+this.selection.startColumn:this.targetPosition.column-this.selection.endColumn+this.selection.startColumn,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column:this.selection.endColumn):this.targetSelection=new me(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column+this.selection.endColumn-this.selection.startColumn)}computeCursorState(e,t){return this.targetSelection}}function Jg(s){return Qe?s.altKey:s.ctrlKey}class fp extends B{static{this.ID="editor.contrib.dragAndDrop"}static{this.TRIGGER_KEY_VALUE=Qe?6:5}constructor(e){super(),this._editor=e,this._dndDecorationIds=this._editor.createDecorationsCollection(),this._register(this._editor.onMouseDown(t=>this._onEditorMouseDown(t))),this._register(this._editor.onMouseUp(t=>this._onEditorMouseUp(t))),this._register(this._editor.onMouseDrag(t=>this._onEditorMouseDrag(t))),this._register(this._editor.onMouseDrop(t=>this._onEditorMouseDrop(t))),this._register(this._editor.onMouseDropCanceled(()=>this._onEditorMouseDropCanceled())),this._register(this._editor.onKeyDown(t=>this.onEditorKeyDown(t))),this._register(this._editor.onKeyUp(t=>this.onEditorKeyUp(t))),this._register(this._editor.onDidBlurEditorWidget(()=>this.onEditorBlur())),this._register(this._editor.onDidBlurEditorText(()=>this.onEditorBlur())),this._mouseDown=!1,this._modifierPressed=!1,this._dragSelection=null}onEditorBlur(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1}onEditorKeyDown(e){!this._editor.getOption(35)||this._editor.getOption(22)||(Jg(e)&&(this._modifierPressed=!0),this._mouseDown&&Jg(e)&&this._editor.updateOptions({mouseStyle:"copy"}))}onEditorKeyUp(e){!this._editor.getOption(35)||this._editor.getOption(22)||(Jg(e)&&(this._modifierPressed=!1),this._mouseDown&&e.keyCode===fp.TRIGGER_KEY_VALUE&&this._editor.updateOptions({mouseStyle:"default"}))}_onEditorMouseDown(e){this._mouseDown=!0}_onEditorMouseUp(e){this._mouseDown=!1,this._editor.updateOptions({mouseStyle:"text"})}_onEditorMouseDrag(e){const t=e.target;if(this._dragSelection===null){const n=(this._editor.getSelections()||[]).filter(o=>t.position&&o.containsPosition(t.position));if(n.length===1)this._dragSelection=n[0];else return}Jg(e.event)?this._editor.updateOptions({mouseStyle:"copy"}):this._editor.updateOptions({mouseStyle:"default"}),t.position&&(this._dragSelection.containsPosition(t.position)?this._removeDecoration():this.showAt(t.position))}_onEditorMouseDropCanceled(){this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}_onEditorMouseDrop(e){if(e.target&&(this._hitContent(e.target)||this._hitMargin(e.target))&&e.target.position){const t=new P(e.target.position.lineNumber,e.target.position.column);if(this._dragSelection===null){let i=null;if(e.event.shiftKey){const n=this._editor.getSelection();if(n){const{selectionStartLineNumber:o,selectionStartColumn:r}=n;i=[new me(o,r,t.lineNumber,t.column)]}}else i=(this._editor.getSelections()||[]).map(n=>n.containsPosition(t)?new me(t.lineNumber,t.column,t.lineNumber,t.column):n);this._editor.setSelections(i||[],"mouse",3)}else(!this._dragSelection.containsPosition(t)||(Jg(e.event)||this._modifierPressed)&&(this._dragSelection.getEndPosition().equals(t)||this._dragSelection.getStartPosition().equals(t)))&&(this._editor.pushUndoStop(),this._editor.executeCommand(fp.ID,new TLe(this._dragSelection,t,Jg(e.event)||this._modifierPressed)),this._editor.pushUndoStop())}this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}static{this._DECORATION_OPTIONS=We.register({description:"dnd-target",className:"dnd-target"})}showAt(e){this._dndDecorationIds.set([{range:new k(e.lineNumber,e.column,e.lineNumber,e.column),options:fp._DECORATION_OPTIONS}]),this._editor.revealPosition(e,1)}_removeDecoration(){this._dndDecorationIds.clear()}_hitContent(e){return e.type===6||e.type===7}_hitMargin(e){return e.type===2||e.type===3||e.type===4}dispose(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1,super.dispose()}}ct(fp.ID,fp,2);ct(jc.ID,jc,0);Rm(JR);ae(new class extends Zi{constructor(){super({id:aZ,precondition:WF,kbOpts:{weight:100,primary:2137}})}runEditorCommand(s,e){return jc.get(e)?.changePasteType()}});ae(new class extends Zi{constructor(){super({id:"editor.hidePasteWidget",precondition:WF,kbOpts:{weight:100,primary:9}})}runEditorCommand(s,e){jc.get(e)?.clearWidgets()}});Q(class dK extends ge{static{this.argsSchema={type:"object",properties:{kind:{type:"string",description:p("pasteAs.kind","The kind of the paste edit to try applying. If not provided or there are multiple edits for this kind, the editor will show a picker.")}}}}constructor(){super({id:"editor.action.pasteAs",label:p("pasteAs","Paste As..."),alias:"Paste As...",precondition:I.writable,metadata:{description:"Paste as",args:[{name:"args",schema:dK.argsSchema}]}})}run(e,t,i){let n=typeof i?.kind=="string"?i.kind:void 0;return!n&&i&&(n=typeof i.id=="string"?i.id:void 0),jc.get(t)?.pasteAs(n?new Ot(n):void 0)}});Q(class extends ge{constructor(){super({id:"editor.action.pasteAsText",label:p("pasteAsText","Paste as Text"),alias:"Paste as Text",precondition:I.writable})}run(s,e){return jc.get(e)?.pasteAs({providerId:ng.id})}});class ELe{constructor(){this._dragOperations=new Map}removeDragOperationTransfer(e){if(e&&this._dragOperations.has(e)){const t=this._dragOperations.get(e);return this._dragOperations.delete(e),t}}}class N7{constructor(e){this.identifier=e}}const hK=Je("treeViewsDndService");nt(hK,ELe,1);var NLe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},rw=function(s,e){return function(t,i){e(t,i,s)}},OM;const uK="editor.experimental.dropIntoEditor.defaultProvider",gK="editor.changeDropType",n4=new le("dropWidgetVisible",!1,p("dropWidgetVisible","Whether the drop widget is showing"));let tm=class extends B{static{OM=this}static{this.ID="editor.contrib.dropIntoEditorController"}static get(e){return e.getContribution(OM.ID)}constructor(e,t,i,n,o){super(),this._configService=i,this._languageFeaturesService=n,this._treeViewsDragAndDropService=o,this.treeItemsTransfer=SS.getInstance(),this._dropProgressManager=this._register(t.createInstance(xS,"dropIntoEditor",e)),this._postDropWidgetManager=this._register(t.createInstance(DS,"dropIntoEditor",e,n4,{id:gK,label:p("postDropWidgetTitle","Show drop options...")})),this._register(e.onDropIntoEditor(r=>this.onDropIntoEditor(e,r.position,r.event)))}clearWidgets(){this._postDropWidgetManager.clear()}changeDropType(){this._postDropWidgetManager.tryShowSelector()}async onDropIntoEditor(e,t,i){if(!i.dataTransfer||!e.hasModel())return;this._currentOperation?.cancel(),e.focus(),e.setPosition(t);const n=en(async o=>{const r=new Z,a=r.add(new gh(e,1,void 0,o));try{const l=await this.extractDataTransferData(i);if(l.size===0||a.token.isCancellationRequested)return;const c=e.getModel();if(!c)return;const d=this._languageFeaturesService.documentDropEditProvider.ordered(c).filter(u=>u.dropMimeTypes?u.dropMimeTypes.some(g=>l.matches(g)):!0),h=r.add(await this.getDropEdits(d,c,t,l,a));if(a.token.isCancellationRequested)return;if(h.edits.length){const u=this.getInitialActiveEditIndex(c,h.edits),g=e.getOption(36).showDropSelector==="afterDrop";await this._postDropWidgetManager.applyEditAndShowIfNeeded([k.fromPositions(t)],{activeEditIndex:u,allEdits:h.edits},g,async f=>f,o)}}finally{r.dispose(),this._currentOperation===n&&(this._currentOperation=void 0)}});this._dropProgressManager.showWhile(t,p("dropIntoEditorProgress","Running drop handlers. Click to cancel"),n,{cancel:()=>n.cancel()}),this._currentOperation=n}async getDropEdits(e,t,i,n,o){const r=new Z,a=await yC(Promise.all(e.map(async c=>{try{const d=await c.provideDocumentDropEdits(t,i,n,o.token);return d&&r.add(d),d?.edits.map(h=>({...h,providerId:c.id}))}catch(d){console.error(d)}})),o.token),l=Yr(a??[]).flat();return{edits:oZ(l),dispose:()=>r.dispose()}}getInitialActiveEditIndex(e,t){const i=this._configService.getValue(uK,{resource:e.uri});for(const[n,o]of Object.entries(i)){const r=new Ot(o),a=t.findIndex(l=>r.value===l.providerId&&l.handledMimeType&&Xj(n,[l.handledMimeType]));if(a>=0)return a}return 0}async extractDataTransferData(e){if(!e.dataTransfer)return new Yj;const t=eZ(e.dataTransfer);if(this.treeItemsTransfer.hasData(N7.prototype)){const i=this.treeItemsTransfer.getData(N7.prototype);if(Array.isArray(i))for(const n of i){const o=await this._treeViewsDragAndDropService.removeDragOperationTransfer(n.identifier);if(o)for(const[r,a]of o)t.replace(r,a)}}return t}};tm=OM=NLe([rw(1,ye),rw(2,Ke),rw(3,pe),rw(4,hK)],tm);ct(tm.ID,tm,2);Rm(QR);ae(new class extends Zi{constructor(){super({id:gK,precondition:n4,kbOpts:{weight:100,primary:2137}})}runEditorCommand(s,e,t){tm.get(e)?.changeDropType()}});ae(new class extends Zi{constructor(){super({id:"editor.hideDropWidget",precondition:n4,kbOpts:{weight:100,primary:9}})}runEditorCommand(s,e,t){tm.get(e)?.clearWidgets()}});ci.as(na.Configuration).registerConfiguration({...NC,properties:{[uK]:{type:"object",scope:5,description:p("defaultProviderDescription","Configures the default drop provider to use for content of a given mime type."),default:{},additionalProperties:{type:"string"}}}});class Or{constructor(e){this._editor=e,this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null,this._startPosition=this._editor.getPosition()}dispose(){this._editor.removeDecorations(this._allDecorations()),this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}reset(){this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}getCount(){return this._decorations.length}getFindScope(){return this._findScopeDecorationIds[0]?this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]):null}getFindScopes(){if(this._findScopeDecorationIds.length){const e=this._findScopeDecorationIds.map(t=>this._editor.getModel().getDecorationRange(t)).filter(t=>!!t);if(e.length)return e}return null}getStartPosition(){return this._startPosition}setStartPosition(e){this._startPosition=e,this.setCurrentFindMatch(null)}_getDecorationIndex(e){const t=this._decorations.indexOf(e);return t>=0?t+1:1}getDecorationRangeAt(e){const t=e<this._decorations.length?this._decorations[e]:null;return t?this._editor.getModel().getDecorationRange(t):null}getCurrentMatchesPosition(e){const t=this._editor.getModel().getDecorationsInRange(e);for(const i of t){const n=i.options;if(n===Or._FIND_MATCH_DECORATION||n===Or._CURRENT_FIND_MATCH_DECORATION)return this._getDecorationIndex(i.id)}return 0}setCurrentFindMatch(e){let t=null,i=0;if(e)for(let n=0,o=this._decorations.length;n<o;n++){const r=this._editor.getModel().getDecorationRange(this._decorations[n]);if(e.equalsRange(r)){t=this._decorations[n],i=n+1;break}}return(this._highlightedDecorationId!==null||t!==null)&&this._editor.changeDecorations(n=>{if(this._highlightedDecorationId!==null&&(n.changeDecorationOptions(this._highlightedDecorationId,Or._FIND_MATCH_DECORATION),this._highlightedDecorationId=null),t!==null&&(this._highlightedDecorationId=t,n.changeDecorationOptions(this._highlightedDecorationId,Or._CURRENT_FIND_MATCH_DECORATION)),this._rangeHighlightDecorationId!==null&&(n.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),t!==null){let o=this._editor.getModel().getDecorationRange(t);if(o.startLineNumber!==o.endLineNumber&&o.endColumn===1){const r=o.endLineNumber-1,a=this._editor.getModel().getLineMaxColumn(r);o=new k(o.startLineNumber,o.startColumn,r,a)}this._rangeHighlightDecorationId=n.addDecoration(o,Or._RANGE_HIGHLIGHT_DECORATION)}}),i}set(e,t){this._editor.changeDecorations(i=>{let n=Or._FIND_MATCH_DECORATION;const o=[];if(e.length>1e3){n=Or._FIND_MATCH_NO_OVERVIEW_DECORATION;const a=this._editor.getModel().getLineCount(),c=this._editor.getLayoutInfo().height/a,d=Math.max(2,Math.ceil(3/c));let h=e[0].range.startLineNumber,u=e[0].range.endLineNumber;for(let g=1,f=e.length;g<f;g++){const m=e[g].range;u+d>=m.startLineNumber?m.endLineNumber>u&&(u=m.endLineNumber):(o.push({range:new k(h,1,u,1),options:Or._FIND_MATCH_ONLY_OVERVIEW_DECORATION}),h=m.startLineNumber,u=m.endLineNumber)}o.push({range:new k(h,1,u,1),options:Or._FIND_MATCH_ONLY_OVERVIEW_DECORATION})}const r=new Array(e.length);for(let a=0,l=e.length;a<l;a++)r[a]={range:e[a].range,options:n};this._decorations=i.deltaDecorations(this._decorations,r),this._overviewRulerApproximateDecorations=i.deltaDecorations(this._overviewRulerApproximateDecorations,o),this._rangeHighlightDecorationId&&(i.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),this._findScopeDecorationIds.length&&(this._findScopeDecorationIds.forEach(a=>i.removeDecoration(a)),this._findScopeDecorationIds=[]),t?.length&&(this._findScopeDecorationIds=t.map(a=>i.addDecoration(a,Or._FIND_SCOPE_DECORATION)))})}matchBeforePosition(e){if(this._decorations.length===0)return null;for(let t=this._decorations.length-1;t>=0;t--){const i=this._decorations[t],n=this._editor.getModel().getDecorationRange(i);if(!(!n||n.endLineNumber>e.lineNumber)){if(n.endLineNumber<e.lineNumber)return n;if(!(n.endColumn>e.column))return n}}return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length-1])}matchAfterPosition(e){if(this._decorations.length===0)return null;for(let t=0,i=this._decorations.length;t<i;t++){const n=this._decorations[t],o=this._editor.getModel().getDecorationRange(n);if(!(!o||o.startLineNumber<e.lineNumber)){if(o.startLineNumber>e.lineNumber)return o;if(!(o.startColumn<e.column))return o}}return this._editor.getModel().getDecorationRange(this._decorations[0])}_allDecorations(){let e=[];return e=e.concat(this._decorations),e=e.concat(this._overviewRulerApproximateDecorations),this._findScopeDecorationIds.length&&e.push(...this._findScopeDecorationIds),this._rangeHighlightDecorationId&&e.push(this._rangeHighlightDecorationId),e}static{this._CURRENT_FIND_MATCH_DECORATION=We.register({description:"current-find-match",stickiness:1,zIndex:13,className:"currentFindMatch",inlineClassName:"currentFindMatchInline",showIfCollapsed:!0,overviewRuler:{color:_i(uD),position:Ho.Center},minimap:{color:_i(OE),position:1}})}static{this._FIND_MATCH_DECORATION=We.register({description:"find-match",stickiness:1,zIndex:10,className:"findMatch",inlineClassName:"findMatchInline",showIfCollapsed:!0,overviewRuler:{color:_i(uD),position:Ho.Center},minimap:{color:_i(OE),position:1}})}static{this._FIND_MATCH_NO_OVERVIEW_DECORATION=We.register({description:"find-match-no-overview",stickiness:1,className:"findMatch",showIfCollapsed:!0})}static{this._FIND_MATCH_ONLY_OVERVIEW_DECORATION=We.register({description:"find-match-only-overview",stickiness:1,overviewRuler:{color:_i(uD),position:Ho.Center}})}static{this._RANGE_HIGHLIGHT_DECORATION=We.register({description:"find-range-highlight",stickiness:1,className:"rangeHighlight",isWholeLine:!0})}static{this._FIND_SCOPE_DECORATION=We.register({description:"find-scope",className:"findScope",isWholeLine:!0})}}class RLe{constructor(e,t,i){this._editorSelection=e,this._ranges=t,this._replaceStrings=i,this._trackedEditorSelectionId=null}getEditOperations(e,t){if(this._ranges.length>0){const i=[];for(let r=0;r<this._ranges.length;r++)i.push({range:this._ranges[r],text:this._replaceStrings[r]});i.sort((r,a)=>k.compareRangesUsingStarts(r.range,a.range));const n=[];let o=i[0];for(let r=1;r<i.length;r++)o.range.endLineNumber===i[r].range.startLineNumber&&o.range.endColumn===i[r].range.startColumn?(o.range=o.range.plusRange(i[r].range),o.text=o.text+i[r].text):(n.push(o),o=i[r]);n.push(o);for(const r of n)t.addEditOperation(r.range,r.text)}this._trackedEditorSelectionId=t.trackSelection(this._editorSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._trackedEditorSelectionId)}}function fK(s,e){if(s&&s[0]!==""){const t=R7(s,e,"-"),i=R7(s,e,"_");return t&&!i?M7(s,e,"-"):!t&&i?M7(s,e,"_"):s[0].toUpperCase()===s[0]?e.toUpperCase():s[0].toLowerCase()===s[0]?e.toLowerCase():kee(s[0][0])&&e.length>0?e[0].toUpperCase()+e.substr(1):s[0][0].toUpperCase()!==s[0][0]&&e.length>0?e[0].toLowerCase()+e.substr(1):e}else return e}function R7(s,e,t){return s[0].indexOf(t)!==-1&&e.indexOf(t)!==-1&&s[0].split(t).length===e.split(t).length}function M7(s,e,t){const i=e.split(t),n=s[0].split(t);let o="";return i.forEach((r,a)=>{o+=fK([n[a]],r)+t}),o.slice(0,-1)}class A7{constructor(e){this.staticValue=e,this.kind=0}}class MLe{constructor(e){this.pieces=e,this.kind=1}}class im{static fromStaticValue(e){return new im([Fu.staticValue(e)])}get hasReplacementPatterns(){return this._state.kind===1}constructor(e){!e||e.length===0?this._state=new A7(""):e.length===1&&e[0].staticValue!==null?this._state=new A7(e[0].staticValue):this._state=new MLe(e)}buildReplaceString(e,t){if(this._state.kind===0)return t?fK(e,this._state.staticValue):this._state.staticValue;let i="";for(let n=0,o=this._state.pieces.length;n<o;n++){const r=this._state.pieces[n];if(r.staticValue!==null){i+=r.staticValue;continue}let a=im._substitute(r.matchIndex,e);if(r.caseOps!==null&&r.caseOps.length>0){const l=[],c=r.caseOps.length;let d=0;for(let h=0,u=a.length;h<u;h++){if(d>=c){l.push(a.slice(h));break}switch(r.caseOps[d]){case"U":l.push(a[h].toUpperCase());break;case"u":l.push(a[h].toUpperCase()),d++;break;case"L":l.push(a[h].toLowerCase());break;case"l":l.push(a[h].toLowerCase()),d++;break;default:l.push(a[h])}}a=l.join("")}i+=a}return i}static _substitute(e,t){if(t===null)return"";if(e===0)return t[0];let i="";for(;e>0;){if(e<t.length)return(t[e]||"")+i;i=String(e%10)+i,e=Math.floor(e/10)}return"$"+i}}class Fu{static staticValue(e){return new Fu(e,-1,null)}static caseOps(e,t){return new Fu(null,e,t)}constructor(e,t,i){this.staticValue=e,this.matchIndex=t,!i||i.length===0?this.caseOps=null:this.caseOps=i.slice(0)}}class ALe{constructor(e){this._source=e,this._lastCharIndex=0,this._result=[],this._resultLen=0,this._currentStaticPiece=""}emitUnchanged(e){this._emitStatic(this._source.substring(this._lastCharIndex,e)),this._lastCharIndex=e}emitStatic(e,t){this._emitStatic(e),this._lastCharIndex=t}_emitStatic(e){e.length!==0&&(this._currentStaticPiece+=e)}emitMatchIndex(e,t,i){this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=Fu.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),this._result[this._resultLen++]=Fu.caseOps(e,i),this._lastCharIndex=t}finalize(){return this.emitUnchanged(this._source.length),this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=Fu.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),new im(this._result)}}function PLe(s){if(!s||s.length===0)return new im(null);const e=[],t=new ALe(s);for(let i=0,n=s.length;i<n;i++){const o=s.charCodeAt(i);if(o===92){if(i++,i>=n)break;const r=s.charCodeAt(i);switch(r){case 92:t.emitUnchanged(i-1),t.emitStatic("\\",i+1);break;case 110:t.emitUnchanged(i-1),t.emitStatic(`
`,i+1);break;case 116:t.emitUnchanged(i-1),t.emitStatic("	",i+1);break;case 117:case 85:case 108:case 76:t.emitUnchanged(i-1),t.emitStatic("",i+1),e.push(String.fromCharCode(r));break}continue}if(o===36){if(i++,i>=n)break;const r=s.charCodeAt(i);if(r===36){t.emitUnchanged(i-1),t.emitStatic("$",i+1);continue}if(r===48||r===38){t.emitUnchanged(i-1),t.emitMatchIndex(0,i+1,e),e.length=0;continue}if(49<=r&&r<=57){let a=r-48;if(i+1<n){const l=s.charCodeAt(i+1);if(48<=l&&l<=57){i++,a=a*10+(l-48),t.emitUnchanged(i-2),t.emitMatchIndex(a,i+1,e),e.length=0;continue}}t.emitUnchanged(i-1),t.emitMatchIndex(a,i+1,e),e.length=0;continue}}}return t.finalize()}const ed=new le("findWidgetVisible",!1);ed.toNegated();const ek=new le("findInputFocussed",!1),s4=new le("replaceInputFocussed",!1),aw={primary:545,mac:{primary:2593}},lw={primary:565,mac:{primary:2613}},cw={primary:560,mac:{primary:2608}},dw={primary:554,mac:{primary:2602}},hw={primary:558,mac:{primary:2606}},Ut={StartFindAction:"actions.find",StartFindWithSelection:"actions.findWithSelection",StartFindWithArgs:"editor.actions.findWithArgs",NextMatchFindAction:"editor.action.nextMatchFindAction",PreviousMatchFindAction:"editor.action.previousMatchFindAction",GoToMatchFindAction:"editor.action.goToMatchFindAction",NextSelectionMatchFindAction:"editor.action.nextSelectionMatchFindAction",PreviousSelectionMatchFindAction:"editor.action.previousSelectionMatchFindAction",StartFindReplaceAction:"editor.action.startFindReplaceAction",CloseFindWidgetCommand:"closeFindWidget",ToggleCaseSensitiveCommand:"toggleFindCaseSensitive",ToggleWholeWordCommand:"toggleFindWholeWord",ToggleRegexCommand:"toggleFindRegex",ToggleSearchScopeCommand:"toggleFindInSelection",TogglePreserveCaseCommand:"togglePreserveCase",ReplaceOneAction:"editor.action.replaceOne",ReplaceAllAction:"editor.action.replaceAll",SelectAllMatchesAction:"editor.action.selectAllMatches"},Vd=19999,OLe=240;class wb{constructor(e,t){this._toDispose=new Z,this._editor=e,this._state=t,this._isDisposed=!1,this._startSearchingTimer=new ia,this._decorations=new Or(e),this._toDispose.add(this._decorations),this._updateDecorationsScheduler=new It(()=>{if(this._editor.hasModel())return this.research(!1)},100),this._toDispose.add(this._updateDecorationsScheduler),this._toDispose.add(this._editor.onDidChangeCursorPosition(i=>{(i.reason===3||i.reason===5||i.reason===6)&&this._decorations.setStartPosition(this._editor.getPosition())})),this._ignoreModelContentChanged=!1,this._toDispose.add(this._editor.onDidChangeModelContent(i=>{this._ignoreModelContentChanged||(i.isFlush&&this._decorations.reset(),this._decorations.setStartPosition(this._editor.getPosition()),this._updateDecorationsScheduler.schedule())})),this._toDispose.add(this._state.onFindReplaceStateChange(i=>this._onStateChanged(i))),this.research(!1,this._state.searchScope)}dispose(){this._isDisposed=!0,At(this._startSearchingTimer),this._toDispose.dispose()}_onStateChanged(e){this._isDisposed||this._editor.hasModel()&&(e.searchString||e.isReplaceRevealed||e.isRegex||e.wholeWord||e.matchCase||e.searchScope)&&(this._editor.getModel().isTooLargeForSyncing()?(this._startSearchingTimer.cancel(),this._startSearchingTimer.setIfNotSet(()=>{e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)},OLe)):e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor))}static _getSearchRange(e,t){return t||e.getFullModelRange()}research(e,t){let i=null;typeof t<"u"?t!==null&&(Array.isArray(t)?i=t:i=[t]):i=this._decorations.getFindScopes(),i!==null&&(i=i.map(a=>{if(a.startLineNumber!==a.endLineNumber){let l=a.endLineNumber;return a.endColumn===1&&(l=l-1),new k(a.startLineNumber,1,l,this._editor.getModel().getLineMaxColumn(l))}return a}));const n=this._findMatches(i,!1,Vd);this._decorations.set(n,i);const o=this._editor.getSelection();let r=this._decorations.getCurrentMatchesPosition(o);if(r===0&&n.length>0){const a=Jb(n.map(l=>l.range),l=>k.compareRangesUsingStarts(l,o)>=0);r=a>0?a-1+1:r}this._state.changeMatchInfo(r,this._decorations.getCount(),void 0),e&&this._editor.getOption(41).cursorMoveOnType&&this._moveToNextMatch(this._decorations.getStartPosition())}_hasMatches(){return this._state.matchesCount>0}_cannotFind(){if(!this._hasMatches()){const e=this._decorations.getFindScope();return e&&this._editor.revealRangeInCenterIfOutsideViewport(e,0),!0}return!1}_setCurrentFindMatch(e){const t=this._decorations.setCurrentFindMatch(e);this._state.changeMatchInfo(t,this._decorations.getCount(),e),this._editor.setSelection(e),this._editor.revealRangeInCenterIfOutsideViewport(e,0)}_prevSearchPosition(e){const t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:i,column:n}=e;const o=this._editor.getModel();return t||n===1?(i===1?i=o.getLineCount():i--,n=o.getLineMaxColumn(i)):n--,new P(i,n)}_moveToPrevMatch(e,t=!1){if(!this._state.canNavigateBack()){const d=this._decorations.matchAfterPosition(e);d&&this._setCurrentFindMatch(d);return}if(this._decorations.getCount()<Vd){let d=this._decorations.matchBeforePosition(e);d&&d.isEmpty()&&d.getStartPosition().equals(e)&&(e=this._prevSearchPosition(e),d=this._decorations.matchBeforePosition(e)),d&&this._setCurrentFindMatch(d);return}if(this._cannotFind())return;const i=this._decorations.getFindScope(),n=wb._getSearchRange(this._editor.getModel(),i);n.getEndPosition().isBefore(e)&&(e=n.getEndPosition()),e.isBefore(n.getStartPosition())&&(e=n.getEndPosition());const{lineNumber:o,column:r}=e,a=this._editor.getModel();let l=new P(o,r),c=a.findPreviousMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(132):null,!1);if(c&&c.range.isEmpty()&&c.range.getStartPosition().equals(l)&&(l=this._prevSearchPosition(l),c=a.findPreviousMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(132):null,!1)),!!c){if(!t&&!n.containsRange(c.range))return this._moveToPrevMatch(c.range.getStartPosition(),!0);this._setCurrentFindMatch(c.range)}}moveToPrevMatch(){this._moveToPrevMatch(this._editor.getSelection().getStartPosition())}_nextSearchPosition(e){const t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:i,column:n}=e;const o=this._editor.getModel();return t||n===o.getLineMaxColumn(i)?(i===o.getLineCount()?i=1:i++,n=1):n++,new P(i,n)}_moveToNextMatch(e){if(!this._state.canNavigateForward()){const i=this._decorations.matchBeforePosition(e);i&&this._setCurrentFindMatch(i);return}if(this._decorations.getCount()<Vd){let i=this._decorations.matchAfterPosition(e);i&&i.isEmpty()&&i.getStartPosition().equals(e)&&(e=this._nextSearchPosition(e),i=this._decorations.matchAfterPosition(e)),i&&this._setCurrentFindMatch(i);return}const t=this._getNextMatch(e,!1,!0);t&&this._setCurrentFindMatch(t.range)}_getNextMatch(e,t,i,n=!1){if(this._cannotFind())return null;const o=this._decorations.getFindScope(),r=wb._getSearchRange(this._editor.getModel(),o);r.getEndPosition().isBefore(e)&&(e=r.getStartPosition()),e.isBefore(r.getStartPosition())&&(e=r.getStartPosition());const{lineNumber:a,column:l}=e,c=this._editor.getModel();let d=new P(a,l),h=c.findNextMatch(this._state.searchString,d,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(132):null,t);return i&&h&&h.range.isEmpty()&&h.range.getStartPosition().equals(d)&&(d=this._nextSearchPosition(d),h=c.findNextMatch(this._state.searchString,d,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(132):null,t)),h?!n&&!r.containsRange(h.range)?this._getNextMatch(h.range.getEndPosition(),t,i,!0):h:null}moveToNextMatch(){this._moveToNextMatch(this._editor.getSelection().getEndPosition())}_moveToMatch(e){const t=this._decorations.getDecorationRangeAt(e);t&&this._setCurrentFindMatch(t)}moveToMatch(e){this._moveToMatch(e)}_getReplacePattern(){return this._state.isRegex?PLe(this._state.replaceString):im.fromStaticValue(this._state.replaceString)}replace(){if(!this._hasMatches())return;const e=this._getReplacePattern(),t=this._editor.getSelection(),i=this._getNextMatch(t.getStartPosition(),!0,!1);if(i)if(t.equalsRange(i.range)){const n=e.buildReplaceString(i.matches,this._state.preserveCase),o=new Nn(t,n);this._executeEditorCommand("replace",o),this._decorations.setStartPosition(new P(t.startLineNumber,t.startColumn+n.length)),this.research(!0)}else this._decorations.setStartPosition(this._editor.getPosition()),this._setCurrentFindMatch(i.range)}_findMatches(e,t,i){const n=(e||[null]).map(o=>wb._getSearchRange(this._editor.getModel(),o));return this._editor.getModel().findMatches(this._state.searchString,n,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(132):null,t,i)}replaceAll(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();e===null&&this._state.matchesCount>=Vd?this._largeReplaceAll():this._regularReplaceAll(e),this.research(!1)}_largeReplaceAll(){const t=new Kh(this._state.searchString,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(132):null).parseSearchRequest();if(!t)return;let i=t.regex;if(!i.multiline){let h="mu";i.ignoreCase&&(h+="i"),i.global&&(h+="g"),i=new RegExp(i.source,h)}const n=this._editor.getModel(),o=n.getValue(1),r=n.getFullModelRange(),a=this._getReplacePattern();let l;const c=this._state.preserveCase;a.hasReplacementPatterns||c?l=o.replace(i,function(){return a.buildReplaceString(arguments,c)}):l=o.replace(i,a.buildReplaceString(null,c));const d=new KO(r,l,this._editor.getSelection());this._executeEditorCommand("replaceAll",d)}_regularReplaceAll(e){const t=this._getReplacePattern(),i=this._findMatches(e,t.hasReplacementPatterns||this._state.preserveCase,1073741824),n=[];for(let r=0,a=i.length;r<a;r++)n[r]=t.buildReplaceString(i[r].matches,this._state.preserveCase);const o=new RLe(this._editor.getSelection(),i.map(r=>r.range),n);this._executeEditorCommand("replaceAll",o)}selectAllMatches(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();let i=this._findMatches(e,!1,1073741824).map(o=>new me(o.range.startLineNumber,o.range.startColumn,o.range.endLineNumber,o.range.endColumn));const n=this._editor.getSelection();for(let o=0,r=i.length;o<r;o++)if(i[o].equalsRange(n)){i=[n].concat(i.slice(0,o)).concat(i.slice(o+1));break}this._editor.setSelections(i)}_executeEditorCommand(e,t){try{this._ignoreModelContentChanged=!0,this._editor.pushUndoStop(),this._editor.executeCommand(e,t),this._editor.pushUndoStop()}finally{this._ignoreModelContentChanged=!1}}}class o4 extends Yo{static{this.ID="editor.contrib.findOptionsWidget"}constructor(e,t,i){super(),this._hideSoon=this._register(new It(()=>this._hide(),2e3)),this._isVisible=!1,this._editor=e,this._state=t,this._keybindingService=i,this._domNode=document.createElement("div"),this._domNode.className="findOptionsWidget",this._domNode.style.display="none",this._domNode.style.top="10px",this._domNode.style.zIndex="12",this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true");const n={inputActiveOptionBorder:he(ZL),inputActiveOptionForeground:he(KL),inputActiveOptionBackground:he(kC)},o=this._register(Fp());this.caseSensitive=this._register(new ZU({appendTitle:this._keybindingLabelFor(Ut.ToggleCaseSensitiveCommand),isChecked:this._state.matchCase,hoverDelegate:o,...n})),this._domNode.appendChild(this.caseSensitive.domNode),this._register(this.caseSensitive.onChange(()=>{this._state.change({matchCase:this.caseSensitive.checked},!1)})),this.wholeWords=this._register(new KU({appendTitle:this._keybindingLabelFor(Ut.ToggleWholeWordCommand),isChecked:this._state.wholeWord,hoverDelegate:o,...n})),this._domNode.appendChild(this.wholeWords.domNode),this._register(this.wholeWords.onChange(()=>{this._state.change({wholeWord:this.wholeWords.checked},!1)})),this.regex=this._register(new qU({appendTitle:this._keybindingLabelFor(Ut.ToggleRegexCommand),isChecked:this._state.isRegex,hoverDelegate:o,...n})),this._domNode.appendChild(this.regex.domNode),this._register(this.regex.onChange(()=>{this._state.change({isRegex:this.regex.checked},!1)})),this._editor.addOverlayWidget(this),this._register(this._state.onFindReplaceStateChange(r=>{let a=!1;r.isRegex&&(this.regex.checked=this._state.isRegex,a=!0),r.wholeWord&&(this.wholeWords.checked=this._state.wholeWord,a=!0),r.matchCase&&(this.caseSensitive.checked=this._state.matchCase,a=!0),!this._state.isRevealed&&a&&this._revealTemporarily()})),this._register(U(this._domNode,ee.MOUSE_LEAVE,r=>this._onMouseLeave())),this._register(U(this._domNode,"mouseover",r=>this._onMouseOver()))}_keybindingLabelFor(e){const t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return o4.ID}getDomNode(){return this._domNode}getPosition(){return{preference:0}}highlightFindOptions(){this._revealTemporarily()}_revealTemporarily(){this._show(),this._hideSoon.schedule()}_onMouseLeave(){this._hideSoon.schedule()}_onMouseOver(){this._hideSoon.cancel()}_show(){this._isVisible||(this._isVisible=!0,this._domNode.style.display="block")}_hide(){this._isVisible&&(this._isVisible=!1,this._domNode.style.display="none")}}function uw(s,e){return s===1?!0:s===2?!1:e}class FLe extends B{get searchString(){return this._searchString}get replaceString(){return this._replaceString}get isRevealed(){return this._isRevealed}get isReplaceRevealed(){return this._isReplaceRevealed}get isRegex(){return uw(this._isRegexOverride,this._isRegex)}get wholeWord(){return uw(this._wholeWordOverride,this._wholeWord)}get matchCase(){return uw(this._matchCaseOverride,this._matchCase)}get preserveCase(){return uw(this._preserveCaseOverride,this._preserveCase)}get actualIsRegex(){return this._isRegex}get actualWholeWord(){return this._wholeWord}get actualMatchCase(){return this._matchCase}get actualPreserveCase(){return this._preserveCase}get searchScope(){return this._searchScope}get matchesPosition(){return this._matchesPosition}get matchesCount(){return this._matchesCount}get currentMatch(){return this._currentMatch}constructor(){super(),this._onFindReplaceStateChange=this._register(new O),this.onFindReplaceStateChange=this._onFindReplaceStateChange.event,this._searchString="",this._replaceString="",this._isRevealed=!1,this._isReplaceRevealed=!1,this._isRegex=!1,this._isRegexOverride=0,this._wholeWord=!1,this._wholeWordOverride=0,this._matchCase=!1,this._matchCaseOverride=0,this._preserveCase=!1,this._preserveCaseOverride=0,this._searchScope=null,this._matchesPosition=0,this._matchesCount=0,this._currentMatch=null,this._loop=!0,this._isSearching=!1,this._filters=null}changeMatchInfo(e,t,i){const n={moveCursor:!1,updateHistory:!1,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let o=!1;t===0&&(e=0),e>t&&(e=t),this._matchesPosition!==e&&(this._matchesPosition=e,n.matchesPosition=!0,o=!0),this._matchesCount!==t&&(this._matchesCount=t,n.matchesCount=!0,o=!0),typeof i<"u"&&(k.equalsRange(this._currentMatch,i)||(this._currentMatch=i,n.currentMatch=!0,o=!0)),o&&this._onFindReplaceStateChange.fire(n)}change(e,t,i=!0){const n={moveCursor:t,updateHistory:i,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let o=!1;const r=this.isRegex,a=this.wholeWord,l=this.matchCase,c=this.preserveCase;typeof e.searchString<"u"&&this._searchString!==e.searchString&&(this._searchString=e.searchString,n.searchString=!0,o=!0),typeof e.replaceString<"u"&&this._replaceString!==e.replaceString&&(this._replaceString=e.replaceString,n.replaceString=!0,o=!0),typeof e.isRevealed<"u"&&this._isRevealed!==e.isRevealed&&(this._isRevealed=e.isRevealed,n.isRevealed=!0,o=!0),typeof e.isReplaceRevealed<"u"&&this._isReplaceRevealed!==e.isReplaceRevealed&&(this._isReplaceRevealed=e.isReplaceRevealed,n.isReplaceRevealed=!0,o=!0),typeof e.isRegex<"u"&&(this._isRegex=e.isRegex),typeof e.wholeWord<"u"&&(this._wholeWord=e.wholeWord),typeof e.matchCase<"u"&&(this._matchCase=e.matchCase),typeof e.preserveCase<"u"&&(this._preserveCase=e.preserveCase),typeof e.searchScope<"u"&&(e.searchScope?.every(d=>this._searchScope?.some(h=>!k.equalsRange(h,d)))||(this._searchScope=e.searchScope,n.searchScope=!0,o=!0)),typeof e.loop<"u"&&this._loop!==e.loop&&(this._loop=e.loop,n.loop=!0,o=!0),typeof e.isSearching<"u"&&this._isSearching!==e.isSearching&&(this._isSearching=e.isSearching,n.isSearching=!0,o=!0),typeof e.filters<"u"&&(this._filters?this._filters.update(e.filters):this._filters=e.filters,n.filters=!0,o=!0),this._isRegexOverride=typeof e.isRegexOverride<"u"?e.isRegexOverride:0,this._wholeWordOverride=typeof e.wholeWordOverride<"u"?e.wholeWordOverride:0,this._matchCaseOverride=typeof e.matchCaseOverride<"u"?e.matchCaseOverride:0,this._preserveCaseOverride=typeof e.preserveCaseOverride<"u"?e.preserveCaseOverride:0,r!==this.isRegex&&(o=!0,n.isRegex=!0),a!==this.wholeWord&&(o=!0,n.wholeWord=!0),l!==this.matchCase&&(o=!0,n.matchCase=!0),c!==this.preserveCase&&(o=!0,n.preserveCase=!0),o&&this._onFindReplaceStateChange.fire(n)}canNavigateBack(){return this.canNavigateInLoop()||this.matchesPosition!==1}canNavigateForward(){return this.canNavigateInLoop()||this.matchesPosition<this.matchesCount}canNavigateInLoop(){return this._loop||this.matchesCount>=Vd}}const BLe=p("defaultLabel","input"),WLe=p("label.preserveCaseToggle","Preserve Case");class HLe extends Im{constructor(e){super({icon:J.preserveCase,title:WLe+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??Ds("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class VLe extends Yo{constructor(e,t,i,n){super(),this._showOptionButtons=i,this.fixFocusOnOptionClickEnabled=!0,this.cachedOptionsWidth=0,this._onDidOptionChange=this._register(new O),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new O),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new O),this._onInput=this._register(new O),this._onKeyUp=this._register(new O),this._onPreserveCaseKeyDown=this._register(new O),this.onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event,this.contextViewProvider=t,this.placeholder=n.placeholder||"",this.validation=n.validation,this.label=n.label||BLe;const o=n.appendPreserveCaseLabel||"",r=n.history||[],a=!!n.flexibleHeight,l=!!n.flexibleWidth,c=n.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new GU(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},history:r,showHistoryHint:n.showHistoryHint,flexibleHeight:a,flexibleWidth:l,flexibleMaxHeight:c,inputBoxStyles:n.inputBoxStyles})),this.preserveCase=this._register(new HLe({appendTitle:o,isChecked:!1,...n.toggleStyles})),this._register(this.preserveCase.onChange(u=>{this._onDidOptionChange.fire(u),!u&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.preserveCase.onKeyDown(u=>{this._onPreserveCaseKeyDown.fire(u)})),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;const d=[this.preserveCase.domNode];this.onkeydown(this.domNode,u=>{if(u.equals(15)||u.equals(17)||u.equals(9)){const g=d.indexOf(this.domNode.ownerDocument.activeElement);if(g>=0){let f=-1;u.equals(17)?f=(g+1)%d.length:u.equals(15)&&(g===0?f=d.length-1:f=g-1),u.equals(9)?(d[g].blur(),this.inputBox.focus()):f>=0&&d[f].focus(),it.stop(u,!0)}}});const h=document.createElement("div");h.className="controls",h.style.display=this._showOptionButtons?"block":"none",h.appendChild(this.preserveCase.domNode),this.domNode.appendChild(h),e?.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,u=>this._onKeyDown.fire(u)),this.onkeyup(this.inputBox.inputElement,u=>this._onKeyUp.fire(u)),this.oninput(this.inputBox.inputElement,u=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,u=>this._onMouseDown.fire(u))}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setEnabled(e){e?this.enable():this.disable()}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(e){this.preserveCase.checked=e}focusOnPreserve(){this.preserveCase.focus()}validate(){this.inputBox?.validate()}set width(e){this.inputBox.paddingRight=this.cachedOptionsWidth,this.domNode.style.width=e+"px"}dispose(){super.dispose()}}var pK=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},mK=function(s,e){return function(t,i){e(t,i,s)}};const r4=new le("suggestWidgetVisible",!1,p("suggestWidgetVisible","Whether suggestion are visible")),a4="historyNavigationWidgetFocus",_K="historyNavigationForwardsEnabled",bK="historyNavigationBackwardsEnabled";let Sb;const gw=[];function vK(s,e){if(gw.includes(e))throw new Error("Cannot register the same widget multiple times");gw.push(e);const t=new Z,i=new le(a4,!1).bindTo(s),n=new le(_K,!0).bindTo(s),o=new le(bK,!0).bindTo(s),r=()=>{i.set(!0),Sb=e},a=()=>{i.set(!1),Sb===e&&(Sb=void 0)};return LL(e.element)&&r(),t.add(e.onDidFocus(()=>r())),t.add(e.onDidBlur(()=>a())),t.add(Ce(()=>{gw.splice(gw.indexOf(e),1),a()})),{historyNavigationForwardsEnablement:n,historyNavigationBackwardsEnablement:o,dispose(){t.dispose()}}}let FM=class extends YU{constructor(e,t,i,n){super(e,t,i);const o=this._register(n.createScoped(this.inputBox.element));this._register(vK(o,this.inputBox))}};FM=pK([mK(3,Ee)],FM);let BM=class extends VLe{constructor(e,t,i,n,o=!1){super(e,t,o,i);const r=this._register(n.createScoped(this.inputBox.element));this._register(vK(r,this.inputBox))}};BM=pK([mK(3,Ee)],BM);Ss.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:q.and(q.has(a4),q.equals(bK,!0),q.not("isComposing"),r4.isEqualTo(!1)),primary:16,secondary:[528],handler:s=>{Sb?.showPreviousValue()}});Ss.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:q.and(q.has(a4),q.equals(_K,!0),q.not("isComposing"),r4.isEqualTo(!1)),primary:18,secondary:[530],handler:s=>{Sb?.showNextValue()}});function P7(s){return s.lookupKeybinding("history.showPrevious")?.getElectronAccelerator()==="Up"&&s.lookupKeybinding("history.showNext")?.getElectronAccelerator()==="Down"}const O7=Kt("find-collapsed",J.chevronRight,p("findCollapsedIcon","Icon to indicate that the editor find widget is collapsed.")),F7=Kt("find-expanded",J.chevronDown,p("findExpandedIcon","Icon to indicate that the editor find widget is expanded.")),zLe=Kt("find-selection",J.selection,p("findSelectionIcon","Icon for 'Find in Selection' in the editor find widget.")),ULe=Kt("find-replace",J.replace,p("findReplaceIcon","Icon for 'Replace' in the editor find widget.")),$Le=Kt("find-replace-all",J.replaceAll,p("findReplaceAllIcon","Icon for 'Replace All' in the editor find widget.")),jLe=Kt("find-previous-match",J.arrowUp,p("findPreviousMatchIcon","Icon for 'Find Previous' in the editor find widget.")),ZLe=Kt("find-next-match",J.arrowDown,p("findNextMatchIcon","Icon for 'Find Next' in the editor find widget.")),KLe=p("label.findDialog","Find / Replace"),qLe=p("label.find","Find"),GLe=p("placeholder.find","Find"),YLe=p("label.previousMatchButton","Previous Match"),XLe=p("label.nextMatchButton","Next Match"),QLe=p("label.toggleSelectionFind","Find in Selection"),JLe=p("label.closeButton","Close"),exe=p("label.replace","Replace"),txe=p("placeholder.replace","Replace"),ixe=p("label.replaceButton","Replace"),nxe=p("label.replaceAllButton","Replace All"),sxe=p("label.toggleReplaceButton","Toggle Replace"),oxe=p("title.matchesCountLimit","Only the first {0} results are highlighted, but all find operations work on the entire text.",Vd),rxe=p("label.matchesLocation","{0} of {1}"),B7=p("label.noResults","No results"),sl=419,axe=275,lxe=axe-54;let h_=69;const cxe=33,W7="ctrlEnterReplaceAll.windows.donotask",H7=Qe?256:2048;class fI{constructor(e){this.afterLineNumber=e,this.heightInPx=cxe,this.suppressMouseDown=!1,this.domNode=document.createElement("div"),this.domNode.className="dock-find-viewzone"}}function V7(s,e,t){const i=!!e.match(/\n/);if(t&&i&&t.selectionStart>0){s.stopPropagation();return}}function z7(s,e,t){const i=!!e.match(/\n/);if(t&&i&&t.selectionEnd<t.value.length){s.stopPropagation();return}}class l4 extends Yo{static{this.ID="editor.contrib.findWidget"}constructor(e,t,i,n,o,r,a,l,c,d){super(),this._hoverService=d,this._cachedHeight=null,this._revealTimeouts=[],this._codeEditor=e,this._controller=t,this._state=i,this._contextViewProvider=n,this._keybindingService=o,this._contextKeyService=r,this._storageService=l,this._notificationService=c,this._ctrlEnterReplaceAllWarningPrompted=!!l.getBoolean(W7,0),this._isVisible=!1,this._isReplaceVisible=!1,this._ignoreChangeEvent=!1,this._updateHistoryDelayer=new Cr(500),this._register(Ce(()=>this._updateHistoryDelayer.cancel())),this._register(this._state.onFindReplaceStateChange(h=>this._onStateChanged(h))),this._buildDomNode(),this._updateButtons(),this._tryUpdateWidgetWidth(),this._findInput.inputBox.layout(),this._register(this._codeEditor.onDidChangeConfiguration(h=>{if(h.hasChanged(92)&&(this._codeEditor.getOption(92)&&this._state.change({isReplaceRevealed:!1},!1),this._updateButtons()),h.hasChanged(146)&&this._tryUpdateWidgetWidth(),h.hasChanged(2)&&this.updateAccessibilitySupport(),h.hasChanged(41)){const u=this._codeEditor.getOption(41).loop;this._state.change({loop:u},!1);const g=this._codeEditor.getOption(41).addExtraSpaceOnTop;g&&!this._viewZone&&(this._viewZone=new fI(0),this._showViewZone()),!g&&this._viewZone&&this._removeViewZone()}})),this.updateAccessibilitySupport(),this._register(this._codeEditor.onDidChangeCursorSelection(()=>{this._isVisible&&this._updateToggleSelectionFindButton()})),this._register(this._codeEditor.onDidFocusEditorWidget(async()=>{if(this._isVisible){const h=await this._controller.getGlobalBufferTerm();h&&h!==this._state.searchString&&(this._state.change({searchString:h},!1),this._findInput.select())}})),this._findInputFocused=ek.bindTo(r),this._findFocusTracker=this._register(Wa(this._findInput.inputBox.inputElement)),this._register(this._findFocusTracker.onDidFocus(()=>{this._findInputFocused.set(!0),this._updateSearchScope()})),this._register(this._findFocusTracker.onDidBlur(()=>{this._findInputFocused.set(!1)})),this._replaceInputFocused=s4.bindTo(r),this._replaceFocusTracker=this._register(Wa(this._replaceInput.inputBox.inputElement)),this._register(this._replaceFocusTracker.onDidFocus(()=>{this._replaceInputFocused.set(!0),this._updateSearchScope()})),this._register(this._replaceFocusTracker.onDidBlur(()=>{this._replaceInputFocused.set(!1)})),this._codeEditor.addOverlayWidget(this),this._codeEditor.getOption(41).addExtraSpaceOnTop&&(this._viewZone=new fI(0)),this._register(this._codeEditor.onDidChangeModel(()=>{this._isVisible&&(this._viewZoneId=void 0)})),this._register(this._codeEditor.onDidScrollChange(h=>{if(h.scrollTopChanged){this._layoutViewZone();return}setTimeout(()=>{this._layoutViewZone()},0)}))}getId(){return l4.ID}getDomNode(){return this._domNode}getPosition(){return this._isVisible?{preference:0}:null}_onStateChanged(e){if(e.searchString){try{this._ignoreChangeEvent=!0,this._findInput.setValue(this._state.searchString)}finally{this._ignoreChangeEvent=!1}this._updateButtons()}if(e.replaceString&&(this._replaceInput.inputBox.value=this._state.replaceString),e.isRevealed&&(this._state.isRevealed?this._reveal():this._hide(!0)),e.isReplaceRevealed&&(this._state.isReplaceRevealed?!this._codeEditor.getOption(92)&&!this._isReplaceVisible&&(this._isReplaceVisible=!0,this._replaceInput.width=io(this._findInput.domNode),this._updateButtons(),this._replaceInput.inputBox.layout()):this._isReplaceVisible&&(this._isReplaceVisible=!1,this._updateButtons())),(e.isRevealed||e.isReplaceRevealed)&&(this._state.isRevealed||this._state.isReplaceRevealed)&&this._tryUpdateHeight()&&this._showViewZone(),e.isRegex&&this._findInput.setRegex(this._state.isRegex),e.wholeWord&&this._findInput.setWholeWords(this._state.wholeWord),e.matchCase&&this._findInput.setCaseSensitive(this._state.matchCase),e.preserveCase&&this._replaceInput.setPreserveCase(this._state.preserveCase),e.searchScope&&(this._state.searchScope?this._toggleSelectionFind.checked=!0:this._toggleSelectionFind.checked=!1,this._updateToggleSelectionFindButton()),e.searchString||e.matchesCount||e.matchesPosition){const t=this._state.searchString.length>0&&this._state.matchesCount===0;this._domNode.classList.toggle("no-results",t),this._updateMatchesCount(),this._updateButtons()}(e.searchString||e.currentMatch)&&this._layoutViewZone(),e.updateHistory&&this._delayedUpdateHistory(),e.loop&&this._updateButtons()}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(void 0,Oe)}_updateHistory(){this._state.searchString&&this._findInput.inputBox.addToHistory(),this._state.replaceString&&this._replaceInput.inputBox.addToHistory()}_updateMatchesCount(){this._matchesCount.style.minWidth=h_+"px",this._state.matchesCount>=Vd?this._matchesCount.title=oxe:this._matchesCount.title="",this._matchesCount.firstChild?.remove();let e;if(this._state.matchesCount>0){let t=String(this._state.matchesCount);this._state.matchesCount>=Vd&&(t+="+");let i=String(this._state.matchesPosition);i==="0"&&(i="?"),e=zu(rxe,i,t)}else e=B7;this._matchesCount.appendChild(document.createTextNode(e)),Ls(this._getAriaLabel(e,this._state.currentMatch,this._state.searchString)),h_=Math.max(h_,this._matchesCount.clientWidth)}_getAriaLabel(e,t,i){if(e===B7)return i===""?p("ariaSearchNoResultEmpty","{0} found",e):p("ariaSearchNoResult","{0} found for '{1}'",e,i);if(t){const n=p("ariaSearchNoResultWithLineNum","{0} found for '{1}', at {2}",e,i,t.startLineNumber+":"+t.startColumn),o=this._codeEditor.getModel();return o&&t.startLineNumber<=o.getLineCount()&&t.startLineNumber>=1?`${o.getLineContent(t.startLineNumber)}, ${n}`:n}return p("ariaSearchNoResultWithLineNumNoCurrentMatch","{0} found for '{1}'",e,i)}_updateToggleSelectionFindButton(){const e=this._codeEditor.getSelection(),t=e?e.startLineNumber!==e.endLineNumber||e.startColumn!==e.endColumn:!1,i=this._toggleSelectionFind.checked;this._isVisible&&(i||t)?this._toggleSelectionFind.enable():this._toggleSelectionFind.disable()}_updateButtons(){this._findInput.setEnabled(this._isVisible),this._replaceInput.setEnabled(this._isVisible&&this._isReplaceVisible),this._updateToggleSelectionFindButton(),this._closeBtn.setEnabled(this._isVisible);const e=this._state.searchString.length>0,t=!!this._state.matchesCount;this._prevBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateBack()),this._nextBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateForward()),this._replaceBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._replaceAllBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._domNode.classList.toggle("replaceToggled",this._isReplaceVisible),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);const i=!this._codeEditor.getOption(92);this._toggleReplaceBtn.setEnabled(this._isVisible&&i)}_reveal(){if(this._revealTimeouts.forEach(e=>{clearTimeout(e)}),this._revealTimeouts=[],!this._isVisible){this._isVisible=!0;const e=this._codeEditor.getSelection();switch(this._codeEditor.getOption(41).autoFindInSelection){case"always":this._toggleSelectionFind.checked=!0;break;case"never":this._toggleSelectionFind.checked=!1;break;case"multiline":{const i=!!e&&e.startLineNumber!==e.endLineNumber;this._toggleSelectionFind.checked=i;break}}this._tryUpdateWidgetWidth(),this._updateButtons(),this._revealTimeouts.push(setTimeout(()=>{this._domNode.classList.add("visible"),this._domNode.setAttribute("aria-hidden","false")},0)),this._revealTimeouts.push(setTimeout(()=>{this._findInput.validate()},200)),this._codeEditor.layoutOverlayWidget(this);let t=!0;if(this._codeEditor.getOption(41).seedSearchStringFromSelection&&e){const i=this._codeEditor.getDomNode();if(i){const n=Si(i),o=this._codeEditor.getScrolledVisiblePosition(e.getStartPosition()),r=n.left+(o?o.left:0),a=o?o.top:0;if(this._viewZone&&a<this._viewZone.heightInPx){e.endLineNumber>e.startLineNumber&&(t=!1);const l=G6(this._domNode).left;r>l&&(t=!1);const c=this._codeEditor.getScrolledVisiblePosition(e.getEndPosition());n.left+(c?c.left:0)>l&&(t=!1)}}}this._showViewZone(t)}}_hide(e){this._revealTimeouts.forEach(t=>{clearTimeout(t)}),this._revealTimeouts=[],this._isVisible&&(this._isVisible=!1,this._updateButtons(),this._domNode.classList.remove("visible"),this._domNode.setAttribute("aria-hidden","true"),this._findInput.clearMessage(),e&&this._codeEditor.focus(),this._codeEditor.layoutOverlayWidget(this),this._removeViewZone())}_layoutViewZone(e){if(!this._codeEditor.getOption(41).addExtraSpaceOnTop){this._removeViewZone();return}if(!this._isVisible)return;const i=this._viewZone;this._viewZoneId!==void 0||!i||this._codeEditor.changeViewZones(n=>{i.heightInPx=this._getHeight(),this._viewZoneId=n.addZone(i),this._codeEditor.setScrollTop(e||this._codeEditor.getScrollTop()+i.heightInPx)})}_showViewZone(e=!0){if(!this._isVisible||!this._codeEditor.getOption(41).addExtraSpaceOnTop)return;this._viewZone===void 0&&(this._viewZone=new fI(0));const i=this._viewZone;this._codeEditor.changeViewZones(n=>{if(this._viewZoneId!==void 0){const o=this._getHeight();if(o===i.heightInPx)return;const r=o-i.heightInPx;i.heightInPx=o,n.layoutZone(this._viewZoneId),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+r);return}else{let o=this._getHeight();if(o-=this._codeEditor.getOption(84).top,o<=0)return;i.heightInPx=o,this._viewZoneId=n.addZone(i),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+o)}})}_removeViewZone(){this._codeEditor.changeViewZones(e=>{this._viewZoneId!==void 0&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0,this._viewZone&&(this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()-this._viewZone.heightInPx),this._viewZone=void 0))})}_tryUpdateWidgetWidth(){if(!this._isVisible||!this._domNode.isConnected)return;const e=this._codeEditor.getLayoutInfo();if(e.contentWidth<=0){this._domNode.classList.add("hiddenEditor");return}else this._domNode.classList.contains("hiddenEditor")&&this._domNode.classList.remove("hiddenEditor");const i=e.width,n=e.minimap.minimapWidth;let o=!1,r=!1,a=!1;if(this._resized&&io(this._domNode)>sl){this._domNode.style.maxWidth=`${i-28-n-15}px`,this._replaceInput.width=io(this._findInput.domNode);return}if(sl+28+n>=i&&(r=!0),sl+28+n-h_>=i&&(a=!0),sl+28+n-h_>=i+50&&(o=!0),this._domNode.classList.toggle("collapsed-find-widget",o),this._domNode.classList.toggle("narrow-find-widget",a),this._domNode.classList.toggle("reduced-find-widget",r),!a&&!o&&(this._domNode.style.maxWidth=`${i-28-n-15}px`),this._findInput.layout({collapsedFindWidget:o,narrowFindWidget:a,reducedFindWidget:r}),this._resized){const l=this._findInput.inputBox.element.clientWidth;l>0&&(this._replaceInput.width=l)}else this._isReplaceVisible&&(this._replaceInput.width=io(this._findInput.domNode))}_getHeight(){let e=0;return e+=4,e+=this._findInput.inputBox.height+2,this._isReplaceVisible&&(e+=4,e+=this._replaceInput.inputBox.height+2),e+=4,e}_tryUpdateHeight(){const e=this._getHeight();return this._cachedHeight!==null&&this._cachedHeight===e?!1:(this._cachedHeight=e,this._domNode.style.height=`${e}px`,!0)}focusFindInput(){this._findInput.select(),this._findInput.focus()}focusReplaceInput(){this._replaceInput.select(),this._replaceInput.focus()}highlightFindOptions(){this._findInput.highlightFindOptions()}_updateSearchScope(){if(this._codeEditor.hasModel()&&this._toggleSelectionFind.checked){const e=this._codeEditor.getSelections();e.map(t=>{t.endColumn===1&&t.endLineNumber>t.startLineNumber&&(t=t.setEndPosition(t.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(t.endLineNumber-1)));const i=this._state.currentMatch;return t.startLineNumber!==t.endLineNumber&&!k.equalsRange(t,i)?t:null}).filter(t=>!!t),e.length&&this._state.change({searchScope:e},!0)}}_onFindInputMouseDown(e){e.middleButton&&e.stopPropagation()}_onFindInputKeyDown(e){if(e.equals(H7|3))if(this._keybindingService.dispatchEvent(e,e.target)){e.preventDefault();return}else{this._findInput.inputBox.insertAtCursor(`
`),e.preventDefault();return}if(e.equals(2)){this._isReplaceVisible?this._replaceInput.focus():this._findInput.focusOnCaseSensitive(),e.preventDefault();return}if(e.equals(2066)){this._codeEditor.focus(),e.preventDefault();return}if(e.equals(16))return V7(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea"));if(e.equals(18))return z7(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea"))}_onReplaceInputKeyDown(e){if(e.equals(H7|3))if(this._keybindingService.dispatchEvent(e,e.target)){e.preventDefault();return}else{An&&Ia&&!this._ctrlEnterReplaceAllWarningPrompted&&(this._notificationService.info(p("ctrlEnter.keybindingChanged","Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.")),this._ctrlEnterReplaceAllWarningPrompted=!0,this._storageService.store(W7,!0,0,0)),this._replaceInput.inputBox.insertAtCursor(`
`),e.preventDefault();return}if(e.equals(2)){this._findInput.focusOnCaseSensitive(),e.preventDefault();return}if(e.equals(1026)){this._findInput.focus(),e.preventDefault();return}if(e.equals(2066)){this._codeEditor.focus(),e.preventDefault();return}if(e.equals(16))return V7(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea"));if(e.equals(18))return z7(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea"))}getVerticalSashLeft(e){return 0}_keybindingLabelFor(e){const t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}_buildDomNode(){this._findInput=this._register(new FM(null,this._contextViewProvider,{width:lxe,label:qLe,placeholder:GLe,appendCaseSensitiveLabel:this._keybindingLabelFor(Ut.ToggleCaseSensitiveCommand),appendWholeWordsLabel:this._keybindingLabelFor(Ut.ToggleWholeWordCommand),appendRegexLabel:this._keybindingLabelFor(Ut.ToggleRegexCommand),validation:d=>{if(d.length===0||!this._findInput.getRegex())return null;try{return new RegExp(d,"gu"),null}catch(h){return{content:h.message}}},flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showCommonFindToggles:!0,showHistoryHint:()=>P7(this._keybindingService),inputBoxStyles:x0,toggleStyles:L0},this._contextKeyService)),this._findInput.setRegex(!!this._state.isRegex),this._findInput.setCaseSensitive(!!this._state.matchCase),this._findInput.setWholeWords(!!this._state.wholeWord),this._register(this._findInput.onKeyDown(d=>this._onFindInputKeyDown(d))),this._register(this._findInput.inputBox.onDidChange(()=>{this._ignoreChangeEvent||this._state.change({searchString:this._findInput.getValue()},!0)})),this._register(this._findInput.onDidOptionChange(()=>{this._state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)})),this._register(this._findInput.onCaseSensitiveKeyDown(d=>{d.equals(1026)&&this._isReplaceVisible&&(this._replaceInput.focus(),d.preventDefault())})),this._register(this._findInput.onRegexKeyDown(d=>{d.equals(2)&&this._isReplaceVisible&&(this._replaceInput.focusOnPreserve(),d.preventDefault())})),this._register(this._findInput.inputBox.onDidHeightChange(d=>{this._tryUpdateHeight()&&this._showViewZone()})),ys&&this._register(this._findInput.onMouseDown(d=>this._onFindInputMouseDown(d))),this._matchesCount=document.createElement("div"),this._matchesCount.className="matchesCount",this._updateMatchesCount();const i=this._register(Fp());this._prevBtn=this._register(new ef({label:YLe+this._keybindingLabelFor(Ut.PreviousMatchFindAction),icon:jLe,hoverDelegate:i,onTrigger:()=>{Id(this._codeEditor.getAction(Ut.PreviousMatchFindAction)).run().then(void 0,Oe)}},this._hoverService)),this._nextBtn=this._register(new ef({label:XLe+this._keybindingLabelFor(Ut.NextMatchFindAction),icon:ZLe,hoverDelegate:i,onTrigger:()=>{Id(this._codeEditor.getAction(Ut.NextMatchFindAction)).run().then(void 0,Oe)}},this._hoverService));const n=document.createElement("div");n.className="find-part",n.appendChild(this._findInput.domNode);const o=document.createElement("div");o.className="find-actions",n.appendChild(o),o.appendChild(this._matchesCount),o.appendChild(this._prevBtn.domNode),o.appendChild(this._nextBtn.domNode),this._toggleSelectionFind=this._register(new Im({icon:zLe,title:QLe+this._keybindingLabelFor(Ut.ToggleSearchScopeCommand),isChecked:!1,hoverDelegate:i,inputActiveOptionBackground:he(kC),inputActiveOptionBorder:he(ZL),inputActiveOptionForeground:he(KL)})),this._register(this._toggleSelectionFind.onChange(()=>{if(this._toggleSelectionFind.checked){if(this._codeEditor.hasModel()){let d=this._codeEditor.getSelections();d=d.map(h=>(h.endColumn===1&&h.endLineNumber>h.startLineNumber&&(h=h.setEndPosition(h.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(h.endLineNumber-1))),h.isEmpty()?null:h)).filter(h=>!!h),d.length&&this._state.change({searchScope:d},!0)}}else this._state.change({searchScope:null},!0)})),o.appendChild(this._toggleSelectionFind.domNode),this._closeBtn=this._register(new ef({label:JLe+this._keybindingLabelFor(Ut.CloseFindWidgetCommand),icon:k$,hoverDelegate:i,onTrigger:()=>{this._state.change({isRevealed:!1,searchScope:null},!1)},onKeyDown:d=>{d.equals(2)&&this._isReplaceVisible&&(this._replaceBtn.isEnabled()?this._replaceBtn.focus():this._codeEditor.focus(),d.preventDefault())}},this._hoverService)),this._replaceInput=this._register(new BM(null,void 0,{label:exe,placeholder:txe,appendPreserveCaseLabel:this._keybindingLabelFor(Ut.TogglePreserveCaseCommand),history:[],flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showHistoryHint:()=>P7(this._keybindingService),inputBoxStyles:x0,toggleStyles:L0},this._contextKeyService,!0)),this._replaceInput.setPreserveCase(!!this._state.preserveCase),this._register(this._replaceInput.onKeyDown(d=>this._onReplaceInputKeyDown(d))),this._register(this._replaceInput.inputBox.onDidChange(()=>{this._state.change({replaceString:this._replaceInput.inputBox.value},!1)})),this._register(this._replaceInput.inputBox.onDidHeightChange(d=>{this._isReplaceVisible&&this._tryUpdateHeight()&&this._showViewZone()})),this._register(this._replaceInput.onDidOptionChange(()=>{this._state.change({preserveCase:this._replaceInput.getPreserveCase()},!0)})),this._register(this._replaceInput.onPreserveCaseKeyDown(d=>{d.equals(2)&&(this._prevBtn.isEnabled()?this._prevBtn.focus():this._nextBtn.isEnabled()?this._nextBtn.focus():this._toggleSelectionFind.enabled?this._toggleSelectionFind.focus():this._closeBtn.isEnabled()&&this._closeBtn.focus(),d.preventDefault())}));const r=this._register(Fp());this._replaceBtn=this._register(new ef({label:ixe+this._keybindingLabelFor(Ut.ReplaceOneAction),icon:ULe,hoverDelegate:r,onTrigger:()=>{this._controller.replace()},onKeyDown:d=>{d.equals(1026)&&(this._closeBtn.focus(),d.preventDefault())}},this._hoverService)),this._replaceAllBtn=this._register(new ef({label:nxe+this._keybindingLabelFor(Ut.ReplaceAllAction),icon:$Le,hoverDelegate:r,onTrigger:()=>{this._controller.replaceAll()}},this._hoverService));const a=document.createElement("div");a.className="replace-part",a.appendChild(this._replaceInput.domNode);const l=document.createElement("div");l.className="replace-actions",a.appendChild(l),l.appendChild(this._replaceBtn.domNode),l.appendChild(this._replaceAllBtn.domNode),this._toggleReplaceBtn=this._register(new ef({label:sxe,className:"codicon toggle left",onTrigger:()=>{this._state.change({isReplaceRevealed:!this._isReplaceVisible},!1),this._isReplaceVisible&&(this._replaceInput.width=io(this._findInput.domNode),this._replaceInput.inputBox.layout()),this._showViewZone()}},this._hoverService)),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible),this._domNode=document.createElement("div"),this._domNode.className="editor-widget find-widget",this._domNode.setAttribute("aria-hidden","true"),this._domNode.ariaLabel=KLe,this._domNode.role="dialog",this._domNode.style.width=`${sl}px`,this._domNode.appendChild(this._toggleReplaceBtn.domNode),this._domNode.appendChild(n),this._domNode.appendChild(this._closeBtn.domNode),this._domNode.appendChild(a),this._resizeSash=this._register(new Hn(this._domNode,this,{orientation:0,size:2})),this._resized=!1;let c=sl;this._register(this._resizeSash.onDidStart(()=>{c=io(this._domNode)})),this._register(this._resizeSash.onDidChange(d=>{this._resized=!0;const h=c+d.startX-d.currentX;if(h<sl)return;const u=parseFloat(SL(this._domNode).maxWidth)||0;h>u||(this._domNode.style.width=`${h}px`,this._isReplaceVisible&&(this._replaceInput.width=io(this._findInput.domNode)),this._findInput.inputBox.layout(),this._tryUpdateHeight())})),this._register(this._resizeSash.onDidReset(()=>{const d=io(this._domNode);if(d<sl)return;let h=sl;if(!this._resized||d===sl){const u=this._codeEditor.getLayoutInfo();h=u.width-28-u.minimap.minimapWidth-15,this._resized=!0}this._domNode.style.width=`${h}px`,this._isReplaceVisible&&(this._replaceInput.width=io(this._findInput.domNode)),this._findInput.inputBox.layout()}))}updateAccessibilitySupport(){const e=this._codeEditor.getOption(2);this._findInput.setFocusInputOnOptionClick(e!==2)}}class ef extends Yo{constructor(e,t){super(),this._opts=e;let i="button";this._opts.className&&(i=i+" "+this._opts.className),this._opts.icon&&(i=i+" "+Ie.asClassName(this._opts.icon)),this._domNode=document.createElement("div"),this._domNode.tabIndex=0,this._domNode.className=i,this._domNode.setAttribute("role","button"),this._domNode.setAttribute("aria-label",this._opts.label),this._register(t.setupManagedHover(e.hoverDelegate??Ds("element"),this._domNode,this._opts.label)),this.onclick(this._domNode,n=>{this._opts.onTrigger(),n.preventDefault()}),this.onkeydown(this._domNode,n=>{if(n.equals(10)||n.equals(3)){this._opts.onTrigger(),n.preventDefault();return}this._opts.onKeyDown?.(n)})}get domNode(){return this._domNode}isEnabled(){return this._domNode.tabIndex>=0}focus(){this._domNode.focus()}setEnabled(e){this._domNode.classList.toggle("disabled",!e),this._domNode.setAttribute("aria-disabled",String(!e)),this._domNode.tabIndex=e?0:-1}setExpanded(e){this._domNode.setAttribute("aria-expanded",String(!!e)),e?(this._domNode.classList.remove(...Ie.asClassNameArray(O7)),this._domNode.classList.add(...Ie.asClassNameArray(F7))):(this._domNode.classList.remove(...Ie.asClassNameArray(F7)),this._domNode.classList.add(...Ie.asClassNameArray(O7)))}}kr((s,e)=>{const t=s.getColor(Rd);t&&e.addRule(`.monaco-editor .findMatch { border: 1px ${Ra(s.type)?"dotted":"solid"} ${t}; box-sizing: border-box; }`);const i=s.getColor(Roe);i&&e.addRule(`.monaco-editor .findScope { border: 1px ${Ra(s.type)?"dashed":"solid"} ${i}; }`);const n=s.getColor(lt);n&&e.addRule(`.monaco-editor .find-widget { border: 1px solid ${n}; }`);const o=s.getColor(Eoe);o&&e.addRule(`.monaco-editor .findMatchInline { color: ${o}; }`);const r=s.getColor(Noe);r&&e.addRule(`.monaco-editor .currentFindMatchInline { color: ${r}; }`)});var CK=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},or=function(s,e){return function(t,i){e(t,i,s)}},WM;const dxe=524288;function HM(s,e="single",t=!1){if(!s.hasModel())return null;const i=s.getSelection();if(e==="single"&&i.startLineNumber===i.endLineNumber||e==="multiple"){if(i.isEmpty()){const n=s.getConfiguredWordAtPosition(i.getStartPosition());if(n&&t===!1)return n.word}else if(s.getModel().getValueLengthInRange(i)<dxe)return s.getModel().getValueInRange(i)}return null}let Ks=class extends B{static{WM=this}static{this.ID="editor.contrib.findController"}get editor(){return this._editor}static get(e){return e.getContribution(WM.ID)}constructor(e,t,i,n,o,r){super(),this._editor=e,this._findWidgetVisible=ed.bindTo(t),this._contextKeyService=t,this._storageService=i,this._clipboardService=n,this._notificationService=o,this._hoverService=r,this._updateHistoryDelayer=new Cr(500),this._state=this._register(new FLe),this.loadQueryState(),this._register(this._state.onFindReplaceStateChange(a=>this._onStateChanged(a))),this._model=null,this._register(this._editor.onDidChangeModel(()=>{const a=this._editor.getModel()&&this._state.isRevealed;this.disposeModel(),this._state.change({searchScope:null,matchCase:this._storageService.getBoolean("editor.matchCase",1,!1),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,!1),isRegex:this._storageService.getBoolean("editor.isRegex",1,!1),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,!1)},!1),a&&this._start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!1,updateSearchScope:!1,loop:this._editor.getOption(41).loop})}))}dispose(){this.disposeModel(),super.dispose()}disposeModel(){this._model&&(this._model.dispose(),this._model=null)}_onStateChanged(e){this.saveQueryState(e),e.isRevealed&&(this._state.isRevealed?this._findWidgetVisible.set(!0):(this._findWidgetVisible.reset(),this.disposeModel())),e.searchString&&this.setGlobalBufferTerm(this._state.searchString)}saveQueryState(e){e.isRegex&&this._storageService.store("editor.isRegex",this._state.actualIsRegex,1,1),e.wholeWord&&this._storageService.store("editor.wholeWord",this._state.actualWholeWord,1,1),e.matchCase&&this._storageService.store("editor.matchCase",this._state.actualMatchCase,1,1),e.preserveCase&&this._storageService.store("editor.preserveCase",this._state.actualPreserveCase,1,1)}loadQueryState(){this._state.change({matchCase:this._storageService.getBoolean("editor.matchCase",1,this._state.matchCase),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,this._state.wholeWord),isRegex:this._storageService.getBoolean("editor.isRegex",1,this._state.isRegex),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,this._state.preserveCase)},!1)}isFindInputFocused(){return!!ek.getValue(this._contextKeyService)}getState(){return this._state}closeFindWidget(){this._state.change({isRevealed:!1,searchScope:null},!1),this._editor.focus()}toggleCaseSensitive(){this._state.change({matchCase:!this._state.matchCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleWholeWords(){this._state.change({wholeWord:!this._state.wholeWord},!1),this._state.isRevealed||this.highlightFindOptions()}toggleRegex(){this._state.change({isRegex:!this._state.isRegex},!1),this._state.isRevealed||this.highlightFindOptions()}togglePreserveCase(){this._state.change({preserveCase:!this._state.preserveCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleSearchScope(){if(this._state.searchScope)this._state.change({searchScope:null},!0);else if(this._editor.hasModel()){let e=this._editor.getSelections();e=e.map(t=>(t.endColumn===1&&t.endLineNumber>t.startLineNumber&&(t=t.setEndPosition(t.endLineNumber-1,this._editor.getModel().getLineMaxColumn(t.endLineNumber-1))),t.isEmpty()?null:t)).filter(t=>!!t),e.length&&this._state.change({searchScope:e},!0)}}setSearchString(e){this._state.isRegex&&(e=Uo(e)),this._state.change({searchString:e},!1)}highlightFindOptions(e=!1){}async _start(e,t){if(this.disposeModel(),!this._editor.hasModel())return;const i={...t,isRevealed:!0};if(e.seedSearchStringFromSelection==="single"){const n=HM(this._editor,e.seedSearchStringFromSelection,e.seedSearchStringFromNonEmptySelection);n&&(this._state.isRegex?i.searchString=Uo(n):i.searchString=n)}else if(e.seedSearchStringFromSelection==="multiple"&&!e.updateSearchScope){const n=HM(this._editor,e.seedSearchStringFromSelection);n&&(i.searchString=n)}if(!i.searchString&&e.seedSearchStringFromGlobalClipboard){const n=await this.getGlobalBufferTerm();if(!this._editor.hasModel())return;n&&(i.searchString=n)}if(e.forceRevealReplace||i.isReplaceRevealed?i.isReplaceRevealed=!0:this._findWidgetVisible.get()||(i.isReplaceRevealed=!1),e.updateSearchScope){const n=this._editor.getSelections();n.some(o=>!o.isEmpty())&&(i.searchScope=n)}i.loop=e.loop,this._state.change(i,!1),this._model||(this._model=new wb(this._editor,this._state))}start(e,t){return this._start(e,t)}moveToNextMatch(){return this._model?(this._model.moveToNextMatch(),!0):!1}moveToPrevMatch(){return this._model?(this._model.moveToPrevMatch(),!0):!1}goToMatch(e){return this._model?(this._model.moveToMatch(e),!0):!1}replace(){return this._model?(this._model.replace(),!0):!1}replaceAll(){return this._model?this._editor.getModel()?.isTooLargeForHeapOperation()?(this._notificationService.warn(p("too.large.for.replaceall","The file is too large to perform a replace all operation.")),!1):(this._model.replaceAll(),!0):!1}selectAllMatches(){return this._model?(this._model.selectAllMatches(),this._editor.focus(),!0):!1}async getGlobalBufferTerm(){return this._editor.getOption(41).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()?this._clipboardService.readFindText():""}setGlobalBufferTerm(e){this._editor.getOption(41).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()&&this._clipboardService.writeFindText(e)}};Ks=WM=CK([or(1,Ee),or(2,oa),or(3,Jc),or(4,Ii),or(5,Vl)],Ks);let VM=class extends Ks{constructor(e,t,i,n,o,r,a,l,c){super(e,i,a,l,r,c),this._contextViewService=t,this._keybindingService=n,this._themeService=o,this._widget=null,this._findOptionsWidget=null}async _start(e,t){this._widget||this._createFindWidget();const i=this._editor.getSelection();let n=!1;switch(this._editor.getOption(41).autoFindInSelection){case"always":n=!0;break;case"never":n=!1;break;case"multiline":{n=!!i&&i.startLineNumber!==i.endLineNumber;break}}e.updateSearchScope=e.updateSearchScope||n,await super._start(e,t),this._widget&&(e.shouldFocus===2?this._widget.focusReplaceInput():e.shouldFocus===1&&this._widget.focusFindInput())}highlightFindOptions(e=!1){this._widget||this._createFindWidget(),this._state.isRevealed&&!e?this._widget.highlightFindOptions():this._findOptionsWidget.highlightFindOptions()}_createFindWidget(){this._widget=this._register(new l4(this._editor,this,this._state,this._contextViewService,this._keybindingService,this._contextKeyService,this._themeService,this._storageService,this._notificationService,this._hoverService)),this._findOptionsWidget=this._register(new o4(this._editor,this._state,this._keybindingService))}};VM=CK([or(1,Yc),or(2,Ee),or(3,yt),or(4,Ki),or(5,Ii),or(6,oa),or(7,Jc),or(8,Vl)],VM);const hxe=uV(new hV({id:Ut.StartFindAction,label:p("startFindAction","Find"),alias:"Find",precondition:q.or(I.focus,q.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2084,weight:100},menuOpts:{menuId:M.MenubarEditMenu,group:"3_find",title:p({key:"miFind",comment:["&& denotes a mnemonic"]},"&&Find"),order:1}}));hxe.addImplementation(0,(s,e,t)=>{const i=Ks.get(e);return i?i.start({forceRevealReplace:!1,seedSearchStringFromSelection:e.getOption(41).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:e.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:e.getOption(41).globalFindClipboard,shouldFocus:1,shouldAnimate:!0,updateSearchScope:!1,loop:e.getOption(41).loop}):!1});const uxe={description:"Open a new In-Editor Find Widget.",args:[{name:"Open a new In-Editor Find Widget args",schema:{properties:{searchString:{type:"string"},replaceString:{type:"string"},isRegex:{type:"boolean"},matchWholeWord:{type:"boolean"},isCaseSensitive:{type:"boolean"},preserveCase:{type:"boolean"},findInSelection:{type:"boolean"}}}}]};class gxe extends ge{constructor(){super({id:Ut.StartFindWithArgs,label:p("startFindWithArgsAction","Find With Arguments"),alias:"Find With Arguments",precondition:void 0,kbOpts:{kbExpr:null,primary:0,weight:100},metadata:uxe})}async run(e,t,i){const n=Ks.get(t);if(n){const o=i?{searchString:i.searchString,replaceString:i.replaceString,isReplaceRevealed:i.replaceString!==void 0,isRegex:i.isRegex,wholeWord:i.matchWholeWord,matchCase:i.isCaseSensitive,preserveCase:i.preserveCase}:{};await n.start({forceRevealReplace:!1,seedSearchStringFromSelection:n.getState().searchString.length===0&&t.getOption(41).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:t.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:!0,shouldFocus:1,shouldAnimate:!0,updateSearchScope:i?.findInSelection||!1,loop:t.getOption(41).loop},o),n.setGlobalBufferTerm(n.getState().searchString)}}}class fxe extends ge{constructor(){super({id:Ut.StartFindWithSelection,label:p("startFindWithSelectionAction","Find With Selection"),alias:"Find With Selection",precondition:void 0,kbOpts:{kbExpr:null,primary:0,mac:{primary:2083},weight:100}})}async run(e,t){const i=Ks.get(t);i&&(await i.start({forceRevealReplace:!1,seedSearchStringFromSelection:"multiple",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop}),i.setGlobalBufferTerm(i.getState().searchString))}}class yK extends ge{async run(e,t){const i=Ks.get(t);i&&!this._run(i)&&(await i.start({forceRevealReplace:!1,seedSearchStringFromSelection:i.getState().searchString.length===0&&t.getOption(41).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:t.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:!0,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop}),this._run(i))}}class pxe extends yK{constructor(){super({id:Ut.NextMatchFindAction,label:p("findNextMatchAction","Find Next"),alias:"Find Next",precondition:void 0,kbOpts:[{kbExpr:I.focus,primary:61,mac:{primary:2085,secondary:[61]},weight:100},{kbExpr:q.and(I.focus,ek),primary:3,weight:100}]})}_run(e){return e.moveToNextMatch()?(e.editor.pushUndoStop(),!0):!1}}class mxe extends yK{constructor(){super({id:Ut.PreviousMatchFindAction,label:p("findPreviousMatchAction","Find Previous"),alias:"Find Previous",precondition:void 0,kbOpts:[{kbExpr:I.focus,primary:1085,mac:{primary:3109,secondary:[1085]},weight:100},{kbExpr:q.and(I.focus,ek),primary:1027,weight:100}]})}_run(e){return e.moveToPrevMatch()}}class _xe extends ge{constructor(){super({id:Ut.GoToMatchFindAction,label:p("findMatchAction.goToMatch","Go to Match..."),alias:"Go to Match...",precondition:ed}),this._highlightDecorations=[]}run(e,t,i){const n=Ks.get(t);if(!n)return;const o=n.getState().matchesCount;if(o<1){e.get(Ii).notify({severity:HL.Warning,message:p("findMatchAction.noResults","No matches. Try searching for something else.")});return}const r=e.get(Dr),a=new Z,l=a.add(r.createInputBox());l.placeholder=p("findMatchAction.inputPlaceHolder","Type a number to go to a specific match (between 1 and {0})",o);const c=h=>{const u=parseInt(h);if(isNaN(u))return;const g=n.getState().matchesCount;if(u>0&&u<=g)return u-1;if(u<0&&u>=-g)return g+u},d=h=>{const u=c(h);if(typeof u=="number"){l.validationMessage=void 0,n.goToMatch(u);const g=n.getState().currentMatch;g&&this.addDecorations(t,g)}else l.validationMessage=p("findMatchAction.inputValidationMessage","Please type a number between 1 and {0}",n.getState().matchesCount),this.clearDecorations(t)};a.add(l.onDidChangeValue(h=>{d(h)})),a.add(l.onDidAccept(()=>{const h=c(l.value);typeof h=="number"?(n.goToMatch(h),l.hide()):l.validationMessage=p("findMatchAction.inputValidationMessage","Please type a number between 1 and {0}",n.getState().matchesCount)})),a.add(l.onDidHide(()=>{this.clearDecorations(t),a.dispose()})),l.show()}clearDecorations(e){e.changeDecorations(t=>{this._highlightDecorations=t.deltaDecorations(this._highlightDecorations,[])})}addDecorations(e,t){e.changeDecorations(i=>{this._highlightDecorations=i.deltaDecorations(this._highlightDecorations,[{range:t,options:{description:"find-match-quick-access-range-highlight",className:"rangeHighlight",isWholeLine:!0}},{range:t,options:{description:"find-match-quick-access-range-highlight-overview",overviewRuler:{color:_i(gU),position:Ho.Full}}}])})}}class wK extends ge{async run(e,t){const i=Ks.get(t);if(!i)return;const n=HM(t,"single",!1);n&&i.setSearchString(n),this._run(i)||(await i.start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop}),this._run(i))}}class bxe extends wK{constructor(){super({id:Ut.NextSelectionMatchFindAction,label:p("nextSelectionMatchFindAction","Find Next Selection"),alias:"Find Next Selection",precondition:void 0,kbOpts:{kbExpr:I.focus,primary:2109,weight:100}})}_run(e){return e.moveToNextMatch()}}class vxe extends wK{constructor(){super({id:Ut.PreviousSelectionMatchFindAction,label:p("previousSelectionMatchFindAction","Find Previous Selection"),alias:"Find Previous Selection",precondition:void 0,kbOpts:{kbExpr:I.focus,primary:3133,weight:100}})}_run(e){return e.moveToPrevMatch()}}const Cxe=uV(new hV({id:Ut.StartFindReplaceAction,label:p("startReplace","Replace"),alias:"Replace",precondition:q.or(I.focus,q.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2086,mac:{primary:2596},weight:100},menuOpts:{menuId:M.MenubarEditMenu,group:"3_find",title:p({key:"miReplace",comment:["&& denotes a mnemonic"]},"&&Replace"),order:2}}));Cxe.addImplementation(0,(s,e,t)=>{if(!e.hasModel()||e.getOption(92))return!1;const i=Ks.get(e);if(!i)return!1;const n=e.getSelection(),o=i.isFindInputFocused(),r=!n.isEmpty()&&n.startLineNumber===n.endLineNumber&&e.getOption(41).seedSearchStringFromSelection!=="never"&&!o,a=o||r?2:1;return i.start({forceRevealReplace:!0,seedSearchStringFromSelection:r?"single":"none",seedSearchStringFromNonEmptySelection:e.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:e.getOption(41).seedSearchStringFromSelection!=="never",shouldFocus:a,shouldAnimate:!0,updateSearchScope:!1,loop:e.getOption(41).loop})});ct(Ks.ID,VM,0);Q(gxe);Q(fxe);Q(pxe);Q(mxe);Q(_xe);Q(bxe);Q(vxe);const Ga=Zi.bindToContribution(Ks.get);ae(new Ga({id:Ut.CloseFindWidgetCommand,precondition:ed,handler:s=>s.closeFindWidget(),kbOpts:{weight:105,kbExpr:q.and(I.focus,q.not("isComposing")),primary:9,secondary:[1033]}}));ae(new Ga({id:Ut.ToggleCaseSensitiveCommand,precondition:void 0,handler:s=>s.toggleCaseSensitive(),kbOpts:{weight:105,kbExpr:I.focus,primary:aw.primary,mac:aw.mac,win:aw.win,linux:aw.linux}}));ae(new Ga({id:Ut.ToggleWholeWordCommand,precondition:void 0,handler:s=>s.toggleWholeWords(),kbOpts:{weight:105,kbExpr:I.focus,primary:lw.primary,mac:lw.mac,win:lw.win,linux:lw.linux}}));ae(new Ga({id:Ut.ToggleRegexCommand,precondition:void 0,handler:s=>s.toggleRegex(),kbOpts:{weight:105,kbExpr:I.focus,primary:cw.primary,mac:cw.mac,win:cw.win,linux:cw.linux}}));ae(new Ga({id:Ut.ToggleSearchScopeCommand,precondition:void 0,handler:s=>s.toggleSearchScope(),kbOpts:{weight:105,kbExpr:I.focus,primary:dw.primary,mac:dw.mac,win:dw.win,linux:dw.linux}}));ae(new Ga({id:Ut.TogglePreserveCaseCommand,precondition:void 0,handler:s=>s.togglePreserveCase(),kbOpts:{weight:105,kbExpr:I.focus,primary:hw.primary,mac:hw.mac,win:hw.win,linux:hw.linux}}));ae(new Ga({id:Ut.ReplaceOneAction,precondition:ed,handler:s=>s.replace(),kbOpts:{weight:105,kbExpr:I.focus,primary:3094}}));ae(new Ga({id:Ut.ReplaceOneAction,precondition:ed,handler:s=>s.replace(),kbOpts:{weight:105,kbExpr:q.and(I.focus,s4),primary:3}}));ae(new Ga({id:Ut.ReplaceAllAction,precondition:ed,handler:s=>s.replaceAll(),kbOpts:{weight:105,kbExpr:I.focus,primary:2563}}));ae(new Ga({id:Ut.ReplaceAllAction,precondition:ed,handler:s=>s.replaceAll(),kbOpts:{weight:105,kbExpr:q.and(I.focus,s4),primary:void 0,mac:{primary:2051}}}));ae(new Ga({id:Ut.SelectAllMatchesAction,precondition:ed,handler:s=>s.selectAllMatches(),kbOpts:{weight:105,kbExpr:I.focus,primary:515}}));const yxe={0:" ",1:"u",2:"r"},U7=65535,wa=16777215,$7=4278190080;class pI{constructor(e){const t=Math.ceil(e/32);this._states=new Uint32Array(t)}get(e){const t=e/32|0,i=e%32;return(this._states[t]&1<<i)!==0}set(e,t){const i=e/32|0,n=e%32,o=this._states[i];t?this._states[i]=o|1<<n:this._states[i]=o&~(1<<n)}}class Ro{constructor(e,t,i){if(e.length!==t.length||e.length>U7)throw new Error("invalid startIndexes or endIndexes size");this._startIndexes=e,this._endIndexes=t,this._collapseStates=new pI(e.length),this._userDefinedStates=new pI(e.length),this._recoveredStates=new pI(e.length),this._types=i,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;const e=[],t=(i,n)=>{const o=e[e.length-1];return this.getStartLineNumber(o)<=i&&this.getEndLineNumber(o)>=n};for(let i=0,n=this._startIndexes.length;i<n;i++){const o=this._startIndexes[i],r=this._endIndexes[i];if(o>wa||r>wa)throw new Error("startLineNumber or endLineNumber must not exceed "+wa);for(;e.length>0&&!t(o,r);)e.pop();const a=e.length>0?e[e.length-1]:-1;e.push(i),this._startIndexes[i]=o+((a&255)<<24),this._endIndexes[i]=r+((a&65280)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(e){return this._startIndexes[e]&wa}getEndLineNumber(e){return this._endIndexes[e]&wa}getType(e){return this._types?this._types[e]:void 0}hasTypes(){return!!this._types}isCollapsed(e){return this._collapseStates.get(e)}setCollapsed(e,t){this._collapseStates.set(e,t)}isUserDefined(e){return this._userDefinedStates.get(e)}setUserDefined(e,t){return this._userDefinedStates.set(e,t)}isRecovered(e){return this._recoveredStates.get(e)}setRecovered(e,t){return this._recoveredStates.set(e,t)}getSource(e){return this.isUserDefined(e)?1:this.isRecovered(e)?2:0}setSource(e,t){t===1?(this.setUserDefined(e,!0),this.setRecovered(e,!1)):t===2?(this.setUserDefined(e,!1),this.setRecovered(e,!0)):(this.setUserDefined(e,!1),this.setRecovered(e,!1))}setCollapsedAllOfType(e,t){let i=!1;if(this._types)for(let n=0;n<this._types.length;n++)this._types[n]===e&&(this.setCollapsed(n,t),i=!0);return i}toRegion(e){return new wxe(this,e)}getParentIndex(e){this.ensureParentIndices();const t=((this._startIndexes[e]&$7)>>>24)+((this._endIndexes[e]&$7)>>>16);return t===U7?-1:t}contains(e,t){return this.getStartLineNumber(e)<=t&&this.getEndLineNumber(e)>=t}findIndex(e){let t=0,i=this._startIndexes.length;if(i===0)return-1;for(;t<i;){const n=Math.floor((t+i)/2);e<this.getStartLineNumber(n)?i=n:t=n+1}return t-1}findRange(e){let t=this.findIndex(e);if(t>=0){if(this.getEndLineNumber(t)>=e)return t;for(t=this.getParentIndex(t);t!==-1;){if(this.contains(t,e))return t;t=this.getParentIndex(t)}}return-1}toString(){const e=[];for(let t=0;t<this.length;t++)e[t]=`[${yxe[this.getSource(t)]}${this.isCollapsed(t)?"+":"-"}] ${this.getStartLineNumber(t)}/${this.getEndLineNumber(t)}`;return e.join(", ")}toFoldRange(e){return{startLineNumber:this._startIndexes[e]&wa,endLineNumber:this._endIndexes[e]&wa,type:this._types?this._types[e]:void 0,isCollapsed:this.isCollapsed(e),source:this.getSource(e)}}static fromFoldRanges(e){const t=e.length,i=new Uint32Array(t),n=new Uint32Array(t);let o=[],r=!1;for(let l=0;l<t;l++){const c=e[l];i[l]=c.startLineNumber,n[l]=c.endLineNumber,o.push(c.type),c.type&&(r=!0)}r||(o=void 0);const a=new Ro(i,n,o);for(let l=0;l<t;l++)e[l].isCollapsed&&a.setCollapsed(l,!0),a.setSource(l,e[l].source);return a}static sanitizeAndMerge(e,t,i,n){i=i??Number.MAX_VALUE;const o=(_,b)=>Array.isArray(_)?v=>v<b?_[v]:void 0:v=>v<b?_.toFoldRange(v):void 0,r=o(e,e.length),a=o(t,t.length);let l=0,c=0,d=r(0),h=a(0);const u=[];let g,f=0;const m=[];for(;d||h;){let _;if(h&&(!d||d.startLineNumber>=h.startLineNumber))d&&d.startLineNumber===h.startLineNumber?(h.source===1?_=h:(_=d,_.isCollapsed=h.isCollapsed&&(d.endLineNumber===h.endLineNumber||!n?.startsInside(d.startLineNumber+1,d.endLineNumber+1)),_.source=0),d=r(++l)):(_=h,h.isCollapsed&&h.source===0&&(_.source=2)),h=a(++c);else{let b=c,v=h;for(;;){if(!v||v.startLineNumber>d.endLineNumber){_=d;break}if(v.source===1&&v.endLineNumber>d.endLineNumber)break;v=a(++b)}d=r(++l)}if(_){for(;g&&g.endLineNumber<_.startLineNumber;)g=u.pop();_.endLineNumber>_.startLineNumber&&_.startLineNumber>f&&_.endLineNumber<=i&&(!g||g.endLineNumber>=_.endLineNumber)&&(m.push(_),f=_.startLineNumber,g&&u.push(g),g=_)}}return m}}class wxe{constructor(e,t){this.ranges=e,this.index=t}get startLineNumber(){return this.ranges.getStartLineNumber(this.index)}get endLineNumber(){return this.ranges.getEndLineNumber(this.index)}get regionIndex(){return this.index}get parentIndex(){return this.ranges.getParentIndex(this.index)}get isCollapsed(){return this.ranges.isCollapsed(this.index)}containedBy(e){return e.startLineNumber<=this.startLineNumber&&e.endLineNumber>=this.endLineNumber}containsLine(e){return this.startLineNumber<=e&&e<=this.endLineNumber}}class Sxe{get regions(){return this._regions}get textModel(){return this._textModel}constructor(e,t){this._updateEventEmitter=new O,this.onDidChange=this._updateEventEmitter.event,this._textModel=e,this._decorationProvider=t,this._regions=new Ro(new Uint32Array(0),new Uint32Array(0)),this._editorDecorationIds=[]}toggleCollapseState(e){if(!e.length)return;e=e.sort((i,n)=>i.regionIndex-n.regionIndex);const t={};this._decorationProvider.changeDecorations(i=>{let n=0,o=-1,r=-1;const a=l=>{for(;n<l;){const c=this._regions.getEndLineNumber(n),d=this._regions.isCollapsed(n);if(c<=o){const h=this.regions.getSource(n)!==0;i.changeDecorationOptions(this._editorDecorationIds[n],this._decorationProvider.getDecorationOption(d,c<=r,h))}d&&c>r&&(r=c),n++}};for(const l of e){const c=l.regionIndex,d=this._editorDecorationIds[c];if(d&&!t[d]){t[d]=!0,a(c);const h=!this._regions.isCollapsed(c);this._regions.setCollapsed(c,h),o=Math.max(o,this._regions.getEndLineNumber(c))}}a(this._regions.length)}),this._updateEventEmitter.fire({model:this,collapseStateChanged:e})}removeManualRanges(e){const t=new Array,i=n=>{for(const o of e)if(!(o.startLineNumber>n.endLineNumber||n.startLineNumber>o.endLineNumber))return!0;return!1};for(let n=0;n<this._regions.length;n++){const o=this._regions.toFoldRange(n);(o.source===0||!i(o))&&t.push(o)}this.updatePost(Ro.fromFoldRanges(t))}update(e,t){const i=this._currentFoldedOrManualRanges(t),n=Ro.sanitizeAndMerge(e,i,this._textModel.getLineCount(),t);this.updatePost(Ro.fromFoldRanges(n))}updatePost(e){const t=[];let i=-1;for(let n=0,o=e.length;n<o;n++){const r=e.getStartLineNumber(n),a=e.getEndLineNumber(n),l=e.isCollapsed(n),c=e.getSource(n)!==0,d={startLineNumber:r,startColumn:this._textModel.getLineMaxColumn(r),endLineNumber:a,endColumn:this._textModel.getLineMaxColumn(a)+1};t.push({range:d,options:this._decorationProvider.getDecorationOption(l,a<=i,c)}),l&&a>i&&(i=a)}this._decorationProvider.changeDecorations(n=>this._editorDecorationIds=n.deltaDecorations(this._editorDecorationIds,t)),this._regions=e,this._updateEventEmitter.fire({model:this})}_currentFoldedOrManualRanges(e){const t=[];for(let i=0,n=this._regions.length;i<n;i++){let o=this.regions.isCollapsed(i);const r=this.regions.getSource(i);if(o||r!==0){const a=this._regions.toFoldRange(i),l=this._textModel.getDecorationRange(this._editorDecorationIds[i]);l&&(o&&e?.startsInside(l.startLineNumber+1,l.endLineNumber)&&(o=!1),t.push({startLineNumber:l.startLineNumber,endLineNumber:l.endLineNumber,type:a.type,isCollapsed:o,source:r}))}}return t}getMemento(){const e=this._currentFoldedOrManualRanges(),t=[],i=this._textModel.getLineCount();for(let n=0,o=e.length;n<o;n++){const r=e[n];if(r.startLineNumber>=r.endLineNumber||r.startLineNumber<1||r.endLineNumber>i)continue;const a=this._getLinesChecksum(r.startLineNumber+1,r.endLineNumber);t.push({startLineNumber:r.startLineNumber,endLineNumber:r.endLineNumber,isCollapsed:r.isCollapsed,source:r.source,checksum:a})}return t.length>0?t:void 0}applyMemento(e){if(!Array.isArray(e))return;const t=[],i=this._textModel.getLineCount();for(const o of e){if(o.startLineNumber>=o.endLineNumber||o.startLineNumber<1||o.endLineNumber>i)continue;const r=this._getLinesChecksum(o.startLineNumber+1,o.endLineNumber);(!o.checksum||r===o.checksum)&&t.push({startLineNumber:o.startLineNumber,endLineNumber:o.endLineNumber,type:void 0,isCollapsed:o.isCollapsed??!0,source:o.source??0})}const n=Ro.sanitizeAndMerge(this._regions,t,i);this.updatePost(Ro.fromFoldRanges(n))}_getLinesChecksum(e,t){return CL(this._textModel.getLineContent(e)+this._textModel.getLineContent(t))%1e6}dispose(){this._decorationProvider.removeDecorations(this._editorDecorationIds)}getAllRegionsAtLine(e,t){const i=[];if(this._regions){let n=this._regions.findRange(e),o=1;for(;n>=0;){const r=this._regions.toRegion(n);(!t||t(r,o))&&i.push(r),o++,n=r.parentIndex}}return i}getRegionAtLine(e){if(this._regions){const t=this._regions.findRange(e);if(t>=0)return this._regions.toRegion(t)}return null}getRegionsInside(e,t){const i=[],n=e?e.regionIndex+1:0,o=e?e.endLineNumber:Number.MAX_VALUE;if(t&&t.length===2){const r=[];for(let a=n,l=this._regions.length;a<l;a++){const c=this._regions.toRegion(a);if(this._regions.getStartLineNumber(a)<o){for(;r.length>0&&!c.containedBy(r[r.length-1]);)r.pop();r.push(c),t(c,r.length)&&i.push(c)}else break}}else for(let r=n,a=this._regions.length;r<a;r++){const l=this._regions.toRegion(r);if(this._regions.getStartLineNumber(r)<o)(!t||t(l))&&i.push(l);else break}return i}}function c4(s,e,t){const i=[];for(const n of t){const o=s.getRegionAtLine(n);if(o){const r=!o.isCollapsed;if(i.push(o),e>1){const a=s.getRegionsInside(o,(l,c)=>l.isCollapsed!==r&&c<e);i.push(...a)}}}s.toggleCollapseState(i)}function Bm(s,e,t=Number.MAX_VALUE,i){const n=[];if(i&&i.length>0)for(const o of i){const r=s.getRegionAtLine(o);if(r&&(r.isCollapsed!==e&&n.push(r),t>1)){const a=s.getRegionsInside(r,(l,c)=>l.isCollapsed!==e&&c<t);n.push(...a)}}else{const o=s.getRegionsInside(null,(r,a)=>r.isCollapsed!==e&&a<t);n.push(...o)}s.toggleCollapseState(n)}function SK(s,e,t,i){const n=[];for(const o of i){const r=s.getAllRegionsAtLine(o,(a,l)=>a.isCollapsed!==e&&l<=t);n.push(...r)}s.toggleCollapseState(n)}function Lxe(s,e,t){const i=[];for(const n of t){const o=s.getAllRegionsAtLine(n,r=>r.isCollapsed!==e);o.length>0&&i.push(o[0])}s.toggleCollapseState(i)}function xxe(s,e,t,i){const n=(r,a)=>a===e&&r.isCollapsed!==t&&!i.some(l=>r.containsLine(l)),o=s.getRegionsInside(null,n);s.toggleCollapseState(o)}function LK(s,e,t){const i=[];for(const r of t){const a=s.getAllRegionsAtLine(r,void 0);a.length>0&&i.push(a[0])}const n=r=>i.every(a=>!a.containedBy(r)&&!r.containedBy(a))&&r.isCollapsed!==e,o=s.getRegionsInside(null,n);s.toggleCollapseState(o)}function d4(s,e,t){const i=s.textModel,n=s.regions,o=[];for(let r=n.length-1;r>=0;r--)if(t!==n.isCollapsed(r)){const a=n.getStartLineNumber(r);e.test(i.getLineContent(a))&&o.push(n.toRegion(r))}s.toggleCollapseState(o)}function h4(s,e,t){const i=s.regions,n=[];for(let o=i.length-1;o>=0;o--)t!==i.isCollapsed(o)&&e===i.getType(o)&&n.push(i.toRegion(o));s.toggleCollapseState(n)}function kxe(s,e){let t=null;const i=e.getRegionAtLine(s);if(i!==null&&(t=i.startLineNumber,s===t)){const n=i.parentIndex;n!==-1?t=e.regions.getStartLineNumber(n):t=null}return t}function Dxe(s,e){let t=e.getRegionAtLine(s);if(t!==null&&t.startLineNumber===s){if(s!==t.startLineNumber)return t.startLineNumber;{const i=t.parentIndex;let n=0;for(i!==-1&&(n=e.regions.getStartLineNumber(t.parentIndex));t!==null;)if(t.regionIndex>0){if(t=e.regions.toRegion(t.regionIndex-1),t.startLineNumber<=n)return null;if(t.parentIndex===i)return t.startLineNumber}else return null}}else if(e.regions.length>0)for(t=e.regions.toRegion(e.regions.length-1);t!==null;){if(t.startLineNumber<s)return t.startLineNumber;t.regionIndex>0?t=e.regions.toRegion(t.regionIndex-1):t=null}return null}function Ixe(s,e){let t=e.getRegionAtLine(s);if(t!==null&&t.startLineNumber===s){const i=t.parentIndex;let n=0;if(i!==-1)n=e.regions.getEndLineNumber(t.parentIndex);else{if(e.regions.length===0)return null;n=e.regions.getEndLineNumber(e.regions.length-1)}for(;t!==null;)if(t.regionIndex<e.regions.length){if(t=e.regions.toRegion(t.regionIndex+1),t.startLineNumber>=n)return null;if(t.parentIndex===i)return t.startLineNumber}else return null}else if(e.regions.length>0)for(t=e.regions.toRegion(0);t!==null;){if(t.startLineNumber>s)return t.startLineNumber;t.regionIndex<e.regions.length?t=e.regions.toRegion(t.regionIndex+1):t=null}return null}class Txe{get onDidChange(){return this._updateEventEmitter.event}get hiddenRanges(){return this._hiddenRanges}constructor(e){this._updateEventEmitter=new O,this._hasLineChanges=!1,this._foldingModel=e,this._foldingModelListener=e.onDidChange(t=>this.updateHiddenRanges()),this._hiddenRanges=[],e.regions.length&&this.updateHiddenRanges()}notifyChangeModelContent(e){this._hiddenRanges.length&&!this._hasLineChanges&&(this._hasLineChanges=e.changes.some(t=>t.range.endLineNumber!==t.range.startLineNumber||rh(t.text)[0]!==0))}updateHiddenRanges(){let e=!1;const t=[];let i=0,n=0,o=Number.MAX_VALUE,r=-1;const a=this._foldingModel.regions;for(;i<a.length;i++){if(!a.isCollapsed(i))continue;const l=a.getStartLineNumber(i)+1,c=a.getEndLineNumber(i);o<=l&&c<=r||(!e&&n<this._hiddenRanges.length&&this._hiddenRanges[n].startLineNumber===l&&this._hiddenRanges[n].endLineNumber===c?(t.push(this._hiddenRanges[n]),n++):(e=!0,t.push(new k(l,1,c,1))),o=l,r=c)}(this._hasLineChanges||e||n<this._hiddenRanges.length)&&this.applyHiddenRanges(t)}applyHiddenRanges(e){this._hiddenRanges=e,this._hasLineChanges=!1,this._updateEventEmitter.fire(e)}hasRanges(){return this._hiddenRanges.length>0}isHidden(e){return j7(this._hiddenRanges,e)!==null}adjustSelections(e){let t=!1;const i=this._foldingModel.textModel;let n=null;const o=r=>((!n||!Exe(r,n))&&(n=j7(this._hiddenRanges,r)),n?n.startLineNumber-1:null);for(let r=0,a=e.length;r<a;r++){let l=e[r];const c=o(l.startLineNumber);c&&(l=l.setStartPosition(c,i.getLineMaxColumn(c)),t=!0);const d=o(l.endLineNumber);d&&(l=l.setEndPosition(d,i.getLineMaxColumn(d)),t=!0),e[r]=l}return t}dispose(){this.hiddenRanges.length>0&&(this._hiddenRanges=[],this._updateEventEmitter.fire(this._hiddenRanges)),this._foldingModelListener&&(this._foldingModelListener.dispose(),this._foldingModelListener=null)}}function Exe(s,e){return s>=e.startLineNumber&&s<=e.endLineNumber}function j7(s,e){const t=Jb(s,i=>e<i.startLineNumber)-1;return t>=0&&s[t].endLineNumber>=e?s[t]:null}const Nxe=5e3,Rxe="indent";class u4{constructor(e,t,i){this.editorModel=e,this.languageConfigurationService=t,this.foldingRangesLimit=i,this.id=Rxe}dispose(){}compute(e){const t=this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules,i=t&&!!t.offSide,n=t&&t.markers;return Promise.resolve(Pxe(this.editorModel,i,n,this.foldingRangesLimit))}}let Mxe=class{constructor(e){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRangesLimit=e}insertFirst(e,t,i){if(e>wa||t>wa)return;const n=this._length;this._startIndexes[n]=e,this._endIndexes[n]=t,this._length++,i<1e3&&(this._indentOccurrences[i]=(this._indentOccurrences[i]||0)+1)}toIndentRanges(e){const t=this._foldingRangesLimit.limit;if(this._length<=t){this._foldingRangesLimit.update(this._length,!1);const i=new Uint32Array(this._length),n=new Uint32Array(this._length);for(let o=this._length-1,r=0;o>=0;o--,r++)i[r]=this._startIndexes[o],n[r]=this._endIndexes[o];return new Ro(i,n)}else{this._foldingRangesLimit.update(this._length,t);let i=0,n=this._indentOccurrences.length;for(let l=0;l<this._indentOccurrences.length;l++){const c=this._indentOccurrences[l];if(c){if(c+i>t){n=l;break}i+=c}}const o=e.getOptions().tabSize,r=new Uint32Array(t),a=new Uint32Array(t);for(let l=this._length-1,c=0;l>=0;l--){const d=this._startIndexes[l],h=e.getLineContent(d),u=hx(h,o);(u<n||u===n&&i++<t)&&(r[c]=d,a[c]=this._endIndexes[l],c++)}return new Ro(r,a)}}};const Axe={limit:Nxe,update:()=>{}};function Pxe(s,e,t,i=Axe){const n=s.getOptions().tabSize,o=new Mxe(i);let r;t&&(r=new RegExp(`(${t.start.source})|(?:${t.end.source})`));const a=[],l=s.getLineCount()+1;a.push({indent:-1,endAbove:l,line:l});for(let c=s.getLineCount();c>0;c--){const d=s.getLineContent(c),h=hx(d,n);let u=a[a.length-1];if(h===-1){e&&(u.endAbove=c);continue}let g;if(r&&(g=d.match(r)))if(g[1]){let f=a.length-1;for(;f>0&&a[f].indent!==-2;)f--;if(f>0){a.length=f+1,u=a[f],o.insertFirst(c,u.line,h),u.line=c,u.indent=h,u.endAbove=c;continue}}else{a.push({indent:-2,endAbove:c,line:c});continue}if(u.indent>h){do a.pop(),u=a[a.length-1];while(u.indent>h);const f=u.endAbove-1;f-c>=1&&o.insertFirst(c,f,h)}u.indent===h?u.endAbove=c:a.push({indent:h,endAbove:c,line:c})}return o.toIndentRanges(s)}const Oxe=E("editor.foldBackground",{light:je(Nd,.3),dark:je(Nd,.3),hcDark:null,hcLight:null},p("foldBackgroundBackground","Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations."),!0);E("editor.foldPlaceholderForeground",{light:"#808080",dark:"#808080",hcDark:null,hcLight:null},p("collapsedTextColor","Color of the collapsed text after the first line of a folded range."));E("editorGutter.foldingControlForeground",r0,p("editorGutter.foldingControlForeground","Color of the folding control in the editor gutter."));const OS=Kt("folding-expanded",J.chevronDown,p("foldingExpandedIcon","Icon for expanded ranges in the editor glyph margin.")),FS=Kt("folding-collapsed",J.chevronRight,p("foldingCollapsedIcon","Icon for collapsed ranges in the editor glyph margin.")),Z7=Kt("folding-manual-collapsed",FS,p("foldingManualCollapedIcon","Icon for manually collapsed ranges in the editor glyph margin.")),K7=Kt("folding-manual-expanded",OS,p("foldingManualExpandedIcon","Icon for manually expanded ranges in the editor glyph margin.")),mI={color:_i(Oxe),position:1},tf=p("linesCollapsed","Click to expand the range."),fw=p("linesExpanded","Click to collapse the range.");class xo{static{this.COLLAPSED_VISUAL_DECORATION=We.register({description:"folding-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,linesDecorationsTooltip:tf,firstLineDecorationClassName:Ie.asClassName(FS)})}static{this.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=We.register({description:"folding-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:mI,isWholeLine:!0,linesDecorationsTooltip:tf,firstLineDecorationClassName:Ie.asClassName(FS)})}static{this.MANUALLY_COLLAPSED_VISUAL_DECORATION=We.register({description:"folding-manually-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,linesDecorationsTooltip:tf,firstLineDecorationClassName:Ie.asClassName(Z7)})}static{this.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=We.register({description:"folding-manually-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:mI,isWholeLine:!0,linesDecorationsTooltip:tf,firstLineDecorationClassName:Ie.asClassName(Z7)})}static{this.NO_CONTROLS_COLLAPSED_RANGE_DECORATION=We.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,linesDecorationsTooltip:tf})}static{this.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION=We.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:mI,isWholeLine:!0,linesDecorationsTooltip:tf})}static{this.EXPANDED_VISUAL_DECORATION=We.register({description:"folding-expanded-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+Ie.asClassName(OS),linesDecorationsTooltip:fw})}static{this.EXPANDED_AUTO_HIDE_VISUAL_DECORATION=We.register({description:"folding-expanded-auto-hide-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:Ie.asClassName(OS),linesDecorationsTooltip:fw})}static{this.MANUALLY_EXPANDED_VISUAL_DECORATION=We.register({description:"folding-manually-expanded-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+Ie.asClassName(K7),linesDecorationsTooltip:fw})}static{this.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION=We.register({description:"folding-manually-expanded-auto-hide-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:Ie.asClassName(K7),linesDecorationsTooltip:fw})}static{this.NO_CONTROLS_EXPANDED_RANGE_DECORATION=We.register({description:"folding-no-controls-range-decoration",stickiness:0,isWholeLine:!0})}static{this.HIDDEN_RANGE_DECORATION=We.register({description:"folding-hidden-range-decoration",stickiness:1})}constructor(e){this.editor=e,this.showFoldingControls="mouseover",this.showFoldingHighlights=!0}getDecorationOption(e,t,i){return t?xo.HIDDEN_RANGE_DECORATION:this.showFoldingControls==="never"?e?this.showFoldingHighlights?xo.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION:xo.NO_CONTROLS_COLLAPSED_RANGE_DECORATION:xo.NO_CONTROLS_EXPANDED_RANGE_DECORATION:e?i?this.showFoldingHighlights?xo.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:xo.MANUALLY_COLLAPSED_VISUAL_DECORATION:this.showFoldingHighlights?xo.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:xo.COLLAPSED_VISUAL_DECORATION:this.showFoldingControls==="mouseover"?i?xo.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION:xo.EXPANDED_AUTO_HIDE_VISUAL_DECORATION:i?xo.MANUALLY_EXPANDED_VISUAL_DECORATION:xo.EXPANDED_VISUAL_DECORATION}changeDecorations(e){return this.editor.changeDecorations(e)}removeDecorations(e){this.editor.removeDecorations(e)}}const Fxe={},Bxe="syntax";class g4{constructor(e,t,i,n,o){this.editorModel=e,this.providers=t,this.handleFoldingRangesChange=i,this.foldingRangesLimit=n,this.fallbackRangeProvider=o,this.id=Bxe,this.disposables=new Z,o&&this.disposables.add(o);for(const r of t)typeof r.onDidChange=="function"&&this.disposables.add(r.onDidChange(i))}compute(e){return Wxe(this.providers,this.editorModel,e).then(t=>t?Vxe(t,this.foldingRangesLimit):this.fallbackRangeProvider?.compute(e)??null)}dispose(){this.disposables.dispose()}}function Wxe(s,e,t){let i=null;const n=s.map((o,r)=>Promise.resolve(o.provideFoldingRanges(e,Fxe,t)).then(a=>{if(!t.isCancellationRequested&&Array.isArray(a)){Array.isArray(i)||(i=[]);const l=e.getLineCount();for(const c of a)c.start>0&&c.end>c.start&&c.end<=l&&i.push({start:c.start,end:c.end,rank:r,kind:c.kind})}},Li));return Promise.all(n).then(o=>i)}class Hxe{constructor(e){this._startIndexes=[],this._endIndexes=[],this._nestingLevels=[],this._nestingLevelCounts=[],this._types=[],this._length=0,this._foldingRangesLimit=e}add(e,t,i,n){if(e>wa||t>wa)return;const o=this._length;this._startIndexes[o]=e,this._endIndexes[o]=t,this._nestingLevels[o]=n,this._types[o]=i,this._length++,n<30&&(this._nestingLevelCounts[n]=(this._nestingLevelCounts[n]||0)+1)}toIndentRanges(){const e=this._foldingRangesLimit.limit;if(this._length<=e){this._foldingRangesLimit.update(this._length,!1);const t=new Uint32Array(this._length),i=new Uint32Array(this._length);for(let n=0;n<this._length;n++)t[n]=this._startIndexes[n],i[n]=this._endIndexes[n];return new Ro(t,i,this._types)}else{this._foldingRangesLimit.update(this._length,e);let t=0,i=this._nestingLevelCounts.length;for(let a=0;a<this._nestingLevelCounts.length;a++){const l=this._nestingLevelCounts[a];if(l){if(l+t>e){i=a;break}t+=l}}const n=new Uint32Array(e),o=new Uint32Array(e),r=[];for(let a=0,l=0;a<this._length;a++){const c=this._nestingLevels[a];(c<i||c===i&&t++<e)&&(n[l]=this._startIndexes[a],o[l]=this._endIndexes[a],r[l]=this._types[a],l++)}return new Ro(n,o,r)}}}function Vxe(s,e){const t=s.sort((r,a)=>{let l=r.start-a.start;return l===0&&(l=r.rank-a.rank),l}),i=new Hxe(e);let n;const o=[];for(const r of t)if(!n)n=r,i.add(r.start,r.end,r.kind&&r.kind.value,o.length);else if(r.start>n.start)if(r.end<=n.end)o.push(n),n=r,i.add(r.start,r.end,r.kind&&r.kind.value,o.length);else{if(r.start>n.end){do n=o.pop();while(n&&r.start>n.end);n&&o.push(n),n=r}i.add(r.start,r.end,r.kind&&r.kind.value,o.length)}return i.toIndentRanges()}var zxe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},u_=function(s,e){return function(t,i){e(t,i,s)}},A_;const On=new le("foldingEnabled",!1);let mh=class extends B{static{A_=this}static{this.ID="editor.contrib.folding"}static get(e){return e.getContribution(A_.ID)}static getFoldingRangeProviders(e,t){const i=e.foldingRangeProvider.ordered(t);return A_._foldingRangeSelector?.(i,t)??i}constructor(e,t,i,n,o,r){super(),this.contextKeyService=t,this.languageConfigurationService=i,this.languageFeaturesService=r,this.localToDispose=this._register(new Z),this.editor=e,this._foldingLimitReporter=new xK(e);const a=this.editor.getOptions();this._isEnabled=a.get(43),this._useFoldingProviders=a.get(44)!=="indentation",this._unfoldOnClickAfterEndOfLine=a.get(48),this._restoringViewState=!1,this._currentModelHasFoldedImports=!1,this._foldingImportsByDefault=a.get(46),this.updateDebounceInfo=o.for(r.foldingRangeProvider,"Folding",{min:200}),this.foldingModel=null,this.hiddenRangeModel=null,this.rangeProvider=null,this.foldingRegionPromise=null,this.foldingModelPromise=null,this.updateScheduler=null,this.cursorChangedScheduler=null,this.mouseDownInfo=null,this.foldingDecorationProvider=new xo(e),this.foldingDecorationProvider.showFoldingControls=a.get(111),this.foldingDecorationProvider.showFoldingHighlights=a.get(45),this.foldingEnabled=On.bindTo(this.contextKeyService),this.foldingEnabled.set(this._isEnabled),this._register(this.editor.onDidChangeModel(()=>this.onModelChanged())),this._register(this.editor.onDidChangeConfiguration(l=>{if(l.hasChanged(43)&&(this._isEnabled=this.editor.getOptions().get(43),this.foldingEnabled.set(this._isEnabled),this.onModelChanged()),l.hasChanged(47)&&this.onModelChanged(),l.hasChanged(111)||l.hasChanged(45)){const c=this.editor.getOptions();this.foldingDecorationProvider.showFoldingControls=c.get(111),this.foldingDecorationProvider.showFoldingHighlights=c.get(45),this.triggerFoldingModelChanged()}l.hasChanged(44)&&(this._useFoldingProviders=this.editor.getOptions().get(44)!=="indentation",this.onFoldingStrategyChanged()),l.hasChanged(48)&&(this._unfoldOnClickAfterEndOfLine=this.editor.getOptions().get(48)),l.hasChanged(46)&&(this._foldingImportsByDefault=this.editor.getOptions().get(46))})),this.onModelChanged()}saveViewState(){const e=this.editor.getModel();if(!e||!this._isEnabled||e.isTooLargeForTokenization())return{};if(this.foldingModel){const t=this.foldingModel.getMemento(),i=this.rangeProvider?this.rangeProvider.id:void 0;return{collapsedRegions:t,lineCount:e.getLineCount(),provider:i,foldedImports:this._currentModelHasFoldedImports}}}restoreViewState(e){const t=this.editor.getModel();if(!(!t||!this._isEnabled||t.isTooLargeForTokenization()||!this.hiddenRangeModel)&&e&&(this._currentModelHasFoldedImports=!!e.foldedImports,e.collapsedRegions&&e.collapsedRegions.length>0&&this.foldingModel)){this._restoringViewState=!0;try{this.foldingModel.applyMemento(e.collapsedRegions)}finally{this._restoringViewState=!1}}}onModelChanged(){this.localToDispose.clear();const e=this.editor.getModel();!this._isEnabled||!e||e.isTooLargeForTokenization()||(this._currentModelHasFoldedImports=!1,this.foldingModel=new Sxe(e,this.foldingDecorationProvider),this.localToDispose.add(this.foldingModel),this.hiddenRangeModel=new Txe(this.foldingModel),this.localToDispose.add(this.hiddenRangeModel),this.localToDispose.add(this.hiddenRangeModel.onDidChange(t=>this.onHiddenRangesChanges(t))),this.updateScheduler=new Cr(this.updateDebounceInfo.get(e)),this.cursorChangedScheduler=new It(()=>this.revealCursor(),200),this.localToDispose.add(this.cursorChangedScheduler),this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelContent(t=>this.onDidChangeModelContent(t))),this.localToDispose.add(this.editor.onDidChangeCursorPosition(()=>this.onCursorPositionChanged())),this.localToDispose.add(this.editor.onMouseDown(t=>this.onEditorMouseDown(t))),this.localToDispose.add(this.editor.onMouseUp(t=>this.onEditorMouseUp(t))),this.localToDispose.add({dispose:()=>{this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.updateScheduler?.cancel(),this.updateScheduler=null,this.foldingModel=null,this.foldingModelPromise=null,this.hiddenRangeModel=null,this.cursorChangedScheduler=null,this.rangeProvider?.dispose(),this.rangeProvider=null}}),this.triggerFoldingModelChanged())}onFoldingStrategyChanged(){this.rangeProvider?.dispose(),this.rangeProvider=null,this.triggerFoldingModelChanged()}getRangeProvider(e){if(this.rangeProvider)return this.rangeProvider;const t=new u4(e,this.languageConfigurationService,this._foldingLimitReporter);if(this.rangeProvider=t,this._useFoldingProviders&&this.foldingModel){const i=A_.getFoldingRangeProviders(this.languageFeaturesService,e);i.length>0&&(this.rangeProvider=new g4(e,i,()=>this.triggerFoldingModelChanged(),this._foldingLimitReporter,t))}return this.rangeProvider}getFoldingModel(){return this.foldingModelPromise}onDidChangeModelContent(e){this.hiddenRangeModel?.notifyChangeModelContent(e),this.triggerFoldingModelChanged()}triggerFoldingModelChanged(){this.updateScheduler&&(this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.foldingModelPromise=this.updateScheduler.trigger(()=>{const e=this.foldingModel;if(!e)return null;const t=new un,i=this.getRangeProvider(e.textModel),n=this.foldingRegionPromise=en(o=>i.compute(o));return n.then(o=>{if(o&&n===this.foldingRegionPromise){let r;if(this._foldingImportsByDefault&&!this._currentModelHasFoldedImports){const c=o.setCollapsedAllOfType(Eo.Imports.value,!0);c&&(r=$a.capture(this.editor),this._currentModelHasFoldedImports=c)}const a=this.editor.getSelections();e.update(o,Uxe(a)),r?.restore(this.editor);const l=this.updateDebounceInfo.update(e.textModel,t.elapsed());this.updateScheduler&&(this.updateScheduler.defaultDelay=l)}return e})}).then(void 0,e=>(Oe(e),null)))}onHiddenRangesChanges(e){if(this.hiddenRangeModel&&e.length&&!this._restoringViewState){const t=this.editor.getSelections();t&&this.hiddenRangeModel.adjustSelections(t)&&this.editor.setSelections(t)}this.editor.setHiddenAreas(e,this)}onCursorPositionChanged(){this.hiddenRangeModel&&this.hiddenRangeModel.hasRanges()&&this.cursorChangedScheduler.schedule()}revealCursor(){const e=this.getFoldingModel();e&&e.then(t=>{if(t){const i=this.editor.getSelections();if(i&&i.length>0){const n=[];for(const o of i){const r=o.selectionStartLineNumber;this.hiddenRangeModel&&this.hiddenRangeModel.isHidden(r)&&n.push(...t.getAllRegionsAtLine(r,a=>a.isCollapsed&&r>a.startLineNumber))}n.length&&(t.toggleCollapseState(n),this.reveal(i[0].getPosition()))}}}).then(void 0,Oe)}onEditorMouseDown(e){if(this.mouseDownInfo=null,!this.hiddenRangeModel||!e.target||!e.target.range||!e.event.leftButton&&!e.event.middleButton)return;const t=e.target.range;let i=!1;switch(e.target.type){case 4:{const n=e.target.detail,o=e.target.element.offsetLeft;if(n.offsetX-o<4)return;i=!0;break}case 7:{if(this._unfoldOnClickAfterEndOfLine&&this.hiddenRangeModel.hasRanges()&&!e.target.detail.isAfterLines)break;return}case 6:{if(this.hiddenRangeModel.hasRanges()){const n=this.editor.getModel();if(n&&t.startColumn===n.getLineMaxColumn(t.startLineNumber))break}return}default:return}this.mouseDownInfo={lineNumber:t.startLineNumber,iconClicked:i}}onEditorMouseUp(e){const t=this.foldingModel;if(!t||!this.mouseDownInfo||!e.target)return;const i=this.mouseDownInfo.lineNumber,n=this.mouseDownInfo.iconClicked,o=e.target.range;if(!o||o.startLineNumber!==i)return;if(n){if(e.target.type!==4)return}else{const a=this.editor.getModel();if(!a||o.startColumn!==a.getLineMaxColumn(i))return}const r=t.getRegionAtLine(i);if(r&&r.startLineNumber===i){const a=r.isCollapsed;if(n||a){const l=e.event.altKey;let c=[];if(l){const d=u=>!u.containedBy(r)&&!r.containedBy(u),h=t.getRegionsInside(null,d);for(const u of h)u.isCollapsed&&c.push(u);c.length===0&&(c=h)}else{const d=e.event.middleButton||e.event.shiftKey;if(d)for(const h of t.getRegionsInside(r))h.isCollapsed===a&&c.push(h);(a||!d||c.length===0)&&c.push(r)}t.toggleCollapseState(c),this.reveal({lineNumber:i,column:1})}}}reveal(e){this.editor.revealPositionInCenterIfOutsideViewport(e,0)}};mh=A_=zxe([u_(1,Ee),u_(2,di),u_(3,Ii),u_(4,Go),u_(5,pe)],mh);class xK{constructor(e){this.editor=e,this._onDidChange=new O,this._computed=0,this._limited=!1}get limit(){return this.editor.getOptions().get(47)}update(e,t){(e!==this._computed||t!==this._limited)&&(this._computed=e,this._limited=t,this._onDidChange.fire())}}class Kn extends ge{runEditorCommand(e,t,i){const n=e.get(di),o=mh.get(t);if(!o)return;const r=o.getFoldingModel();if(r)return this.reportTelemetry(e,t),r.then(a=>{if(a){this.invoke(o,a,t,i,n);const l=t.getSelection();l&&o.reveal(l.getStartPosition())}})}getSelectedLines(e){const t=e.getSelections();return t?t.map(i=>i.startLineNumber):[]}getLineNumbers(e,t){return e&&e.selectionLines?e.selectionLines.map(i=>i+1):this.getSelectedLines(t)}run(e,t){}}function Uxe(s){return!s||s.length===0?{startsInside:()=>!1}:{startsInside(e,t){for(const i of s){const n=i.startLineNumber;if(n>=e&&n<=t)return!0}return!1}}}function kK(s){if(!ns(s)){if(!dn(s))return!1;const e=s;if(!ns(e.levels)&&!Jd(e.levels)||!ns(e.direction)&&!zs(e.direction)||!ns(e.selectionLines)&&(!Array.isArray(e.selectionLines)||!e.selectionLines.every(Jd)))return!1}return!0}class $xe extends Kn{constructor(){super({id:"editor.unfold",label:p("unfoldAction.label","Unfold"),alias:"Unfold",precondition:On,kbOpts:{kbExpr:I.editorTextFocus,primary:3166,mac:{primary:2654},weight:100},metadata:{description:"Unfold the content in the editor",args:[{name:"Unfold editor argument",description:`Property-value pairs that can be passed through this argument:
						* 'levels': Number of levels to unfold. If not set, defaults to 1.
						* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.
						* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.
						`,constraint:kK,schema:{type:"object",properties:{levels:{type:"number",default:1},direction:{type:"string",enum:["up","down"],default:"down"},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,n){const o=n&&n.levels||1,r=this.getLineNumbers(n,i);n&&n.direction==="up"?SK(t,!1,o,r):Bm(t,!1,o,r)}}class jxe extends Kn{constructor(){super({id:"editor.unfoldRecursively",label:p("unFoldRecursivelyAction.label","Unfold Recursively"),alias:"Unfold Recursively",precondition:On,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2142),weight:100}})}invoke(e,t,i,n){Bm(t,!1,Number.MAX_VALUE,this.getSelectedLines(i))}}class Zxe extends Kn{constructor(){super({id:"editor.fold",label:p("foldAction.label","Fold"),alias:"Fold",precondition:On,kbOpts:{kbExpr:I.editorTextFocus,primary:3164,mac:{primary:2652},weight:100},metadata:{description:"Fold the content in the editor",args:[{name:"Fold editor argument",description:`Property-value pairs that can be passed through this argument:
							* 'levels': Number of levels to fold.
							* 'direction': If 'up', folds given number of levels up otherwise folds down.
							* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.
							If no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.
						`,constraint:kK,schema:{type:"object",properties:{levels:{type:"number"},direction:{type:"string",enum:["up","down"]},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,n){const o=this.getLineNumbers(n,i),r=n&&n.levels,a=n&&n.direction;typeof r!="number"&&typeof a!="string"?Lxe(t,!0,o):a==="up"?SK(t,!0,r||1,o):Bm(t,!0,r||1,o)}}class Kxe extends Kn{constructor(){super({id:"editor.toggleFold",label:p("toggleFoldAction.label","Toggle Fold"),alias:"Toggle Fold",precondition:On,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2090),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);c4(t,1,n)}}class qxe extends Kn{constructor(){super({id:"editor.foldRecursively",label:p("foldRecursivelyAction.label","Fold Recursively"),alias:"Fold Recursively",precondition:On,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2140),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);Bm(t,!0,Number.MAX_VALUE,n)}}class Gxe extends Kn{constructor(){super({id:"editor.toggleFoldRecursively",label:p("toggleFoldRecursivelyAction.label","Toggle Fold Recursively"),alias:"Toggle Fold Recursively",precondition:On,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,3114),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);c4(t,Number.MAX_VALUE,n)}}class Yxe extends Kn{constructor(){super({id:"editor.foldAllBlockComments",label:p("foldAllBlockComments.label","Fold All Block Comments"),alias:"Fold All Block Comments",precondition:On,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2138),weight:100}})}invoke(e,t,i,n,o){if(t.regions.hasTypes())h4(t,Eo.Comment.value,!0);else{const r=i.getModel();if(!r)return;const a=o.getLanguageConfiguration(r.getLanguageId()).comments;if(a&&a.blockCommentStartToken){const l=new RegExp("^\\s*"+Uo(a.blockCommentStartToken));d4(t,l,!0)}}}}class Xxe extends Kn{constructor(){super({id:"editor.foldAllMarkerRegions",label:p("foldAllMarkerRegions.label","Fold All Regions"),alias:"Fold All Regions",precondition:On,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2077),weight:100}})}invoke(e,t,i,n,o){if(t.regions.hasTypes())h4(t,Eo.Region.value,!0);else{const r=i.getModel();if(!r)return;const a=o.getLanguageConfiguration(r.getLanguageId()).foldingRules;if(a&&a.markers&&a.markers.start){const l=new RegExp(a.markers.start);d4(t,l,!0)}}}}class Qxe extends Kn{constructor(){super({id:"editor.unfoldAllMarkerRegions",label:p("unfoldAllMarkerRegions.label","Unfold All Regions"),alias:"Unfold All Regions",precondition:On,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2078),weight:100}})}invoke(e,t,i,n,o){if(t.regions.hasTypes())h4(t,Eo.Region.value,!1);else{const r=i.getModel();if(!r)return;const a=o.getLanguageConfiguration(r.getLanguageId()).foldingRules;if(a&&a.markers&&a.markers.start){const l=new RegExp(a.markers.start);d4(t,l,!1)}}}}class Jxe extends Kn{constructor(){super({id:"editor.foldAllExcept",label:p("foldAllExcept.label","Fold All Except Selected"),alias:"Fold All Except Selected",precondition:On,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2136),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);LK(t,!0,n)}}class eke extends Kn{constructor(){super({id:"editor.unfoldAllExcept",label:p("unfoldAllExcept.label","Unfold All Except Selected"),alias:"Unfold All Except Selected",precondition:On,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2134),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);LK(t,!1,n)}}class tke extends Kn{constructor(){super({id:"editor.foldAll",label:p("foldAllAction.label","Fold All"),alias:"Fold All",precondition:On,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2069),weight:100}})}invoke(e,t,i){Bm(t,!0)}}class ike extends Kn{constructor(){super({id:"editor.unfoldAll",label:p("unfoldAllAction.label","Unfold All"),alias:"Unfold All",precondition:On,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2088),weight:100}})}invoke(e,t,i){Bm(t,!1)}}class Xv extends Kn{static{this.ID_PREFIX="editor.foldLevel"}static{this.ID=e=>Xv.ID_PREFIX+e}getFoldingLevel(){return parseInt(this.id.substr(Xv.ID_PREFIX.length))}invoke(e,t,i){xxe(t,this.getFoldingLevel(),!0,this.getSelectedLines(i))}}class nke extends Kn{constructor(){super({id:"editor.gotoParentFold",label:p("gotoParentFold.label","Go to Parent Fold"),alias:"Go to Parent Fold",precondition:On,kbOpts:{kbExpr:I.editorTextFocus,weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);if(n.length>0){const o=kxe(n[0],t);o!==null&&i.setSelection({startLineNumber:o,startColumn:1,endLineNumber:o,endColumn:1})}}}class ske extends Kn{constructor(){super({id:"editor.gotoPreviousFold",label:p("gotoPreviousFold.label","Go to Previous Folding Range"),alias:"Go to Previous Folding Range",precondition:On,kbOpts:{kbExpr:I.editorTextFocus,weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);if(n.length>0){const o=Dxe(n[0],t);o!==null&&i.setSelection({startLineNumber:o,startColumn:1,endLineNumber:o,endColumn:1})}}}class oke extends Kn{constructor(){super({id:"editor.gotoNextFold",label:p("gotoNextFold.label","Go to Next Folding Range"),alias:"Go to Next Folding Range",precondition:On,kbOpts:{kbExpr:I.editorTextFocus,weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);if(n.length>0){const o=Ixe(n[0],t);o!==null&&i.setSelection({startLineNumber:o,startColumn:1,endLineNumber:o,endColumn:1})}}}class rke extends Kn{constructor(){super({id:"editor.createFoldingRangeFromSelection",label:p("createManualFoldRange.label","Create Folding Range from Selection"),alias:"Create Folding Range from Selection",precondition:On,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2135),weight:100}})}invoke(e,t,i){const n=[],o=i.getSelections();if(o){for(const r of o){let a=r.endLineNumber;r.endColumn===1&&--a,a>r.startLineNumber&&(n.push({startLineNumber:r.startLineNumber,endLineNumber:a,type:void 0,isCollapsed:!0,source:1}),i.setSelection({startLineNumber:r.startLineNumber,startColumn:1,endLineNumber:r.startLineNumber,endColumn:1}))}if(n.length>0){n.sort((a,l)=>a.startLineNumber-l.startLineNumber);const r=Ro.sanitizeAndMerge(t.regions,n,i.getModel()?.getLineCount());t.updatePost(Ro.fromFoldRanges(r))}}}}class ake extends Kn{constructor(){super({id:"editor.removeManualFoldingRanges",label:p("removeManualFoldingRanges.label","Remove Manual Folding Ranges"),alias:"Remove Manual Folding Ranges",precondition:On,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2137),weight:100}})}invoke(e,t,i){const n=i.getSelections();if(n){const o=[];for(const r of n){const{startLineNumber:a,endLineNumber:l}=r;o.push(l>=a?{startLineNumber:a,endLineNumber:l}:{endLineNumber:l,startLineNumber:a})}t.removeManualRanges(o),e.triggerFoldingModelChanged()}}}ct(mh.ID,mh,0);Q($xe);Q(jxe);Q(Zxe);Q(qxe);Q(Gxe);Q(tke);Q(ike);Q(Yxe);Q(Xxe);Q(Qxe);Q(Jxe);Q(eke);Q(Kxe);Q(nke);Q(ske);Q(oke);Q(rke);Q(ake);for(let s=1;s<=7;s++)Sie(new Xv({id:Xv.ID(s),label:p("foldLevelAction.label","Fold Level {0}",s),alias:`Fold Level ${s}`,precondition:On,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2048|21+s),weight:100}}));ot.registerCommand("_executeFoldingRangeProvider",async function(s,...e){const[t]=e;if(!(t instanceof Se))throw mr();const i=s.get(pe),n=s.get(Zt).getModel(t);if(!n)throw mr();const o=s.get(Ke);if(!o.getValue("editor.folding",{resource:t}))return[];const r=s.get(di),a=o.getValue("editor.foldingStrategy",{resource:t}),l={get limit(){return o.getValue("editor.foldingMaximumRegions",{resource:t})},update:(g,f)=>{}},c=new u4(n,r,l);let d=c;if(a!=="indentation"){const g=mh.getFoldingRangeProviders(i,n);g.length&&(d=new g4(n,g,()=>{},l,c))}const h=await d.compute(Ue.None),u=[];try{if(h)for(let g=0;g<h.length;g++){const f=h.getType(g);u.push({start:h.getStartLineNumber(g),end:h.getEndLineNumber(g),kind:f?Eo.fromValue(f):void 0})}return u}finally{d.dispose()}});class lke extends ge{constructor(){super({id:"editor.action.fontZoomIn",label:p("EditorFontZoomIn.label","Increase Editor Font Size"),alias:"Increase Editor Font Size",precondition:void 0})}run(e,t){lr.setZoomLevel(lr.getZoomLevel()+1)}}class cke extends ge{constructor(){super({id:"editor.action.fontZoomOut",label:p("EditorFontZoomOut.label","Decrease Editor Font Size"),alias:"Decrease Editor Font Size",precondition:void 0})}run(e,t){lr.setZoomLevel(lr.getZoomLevel()-1)}}class dke extends ge{constructor(){super({id:"editor.action.fontZoomReset",label:p("EditorFontZoomReset.label","Reset Editor Font Size"),alias:"Reset Editor Font Size",precondition:void 0})}run(e,t){lr.setZoomLevel(0)}}Q(lke);Q(cke);Q(dke);var DK=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Lb=function(s,e){return function(t,i){e(t,i,s)}};let BS=class{static{this.ID="editor.contrib.autoFormat"}constructor(e,t,i,n){this._editor=e,this._languageFeaturesService=t,this._workerService=i,this._accessibilitySignalService=n,this._disposables=new Z,this._sessionDisposables=new Z,this._disposables.add(t.onTypeFormattingEditProvider.onDidChange(this._update,this)),this._disposables.add(e.onDidChangeModel(()=>this._update())),this._disposables.add(e.onDidChangeModelLanguage(()=>this._update())),this._disposables.add(e.onDidChangeConfiguration(o=>{o.hasChanged(56)&&this._update()})),this._update()}dispose(){this._disposables.dispose(),this._sessionDisposables.dispose()}_update(){if(this._sessionDisposables.clear(),!this._editor.getOption(56)||!this._editor.hasModel())return;const e=this._editor.getModel(),[t]=this._languageFeaturesService.onTypeFormattingEditProvider.ordered(e);if(!t||!t.autoFormatTriggerCharacters)return;const i=new Y1;for(const n of t.autoFormatTriggerCharacters)i.add(n.charCodeAt(0));this._sessionDisposables.add(this._editor.onDidType(n=>{const o=n.charCodeAt(n.length-1);i.has(o)&&this._trigger(String.fromCharCode(o))}))}_trigger(e){if(!this._editor.hasModel()||this._editor.getSelections().length>1||!this._editor.getSelection().isEmpty())return;const t=this._editor.getModel(),i=this._editor.getPosition(),n=new li,o=this._editor.onDidChangeModelContent(r=>{if(r.isFlush){n.cancel(),o.dispose();return}for(let a=0,l=r.changes.length;a<l;a++)if(r.changes[a].range.endLineNumber<=i.lineNumber){n.cancel(),o.dispose();return}});xj(this._workerService,this._languageFeaturesService,t,i,e,t.getFormattingOptions(),n.token).then(r=>{n.token.isCancellationRequested||os(r)&&(this._accessibilitySignalService.playSignal(Lt.format,{userGesture:!1}),Zp.execute(this._editor,r,!0))}).finally(()=>{o.dispose()})}};BS=DK([Lb(1,pe),Lb(2,Xs),Lb(3,Lh)],BS);let WS=class{static{this.ID="editor.contrib.formatOnPaste"}constructor(e,t,i){this.editor=e,this._languageFeaturesService=t,this._instantiationService=i,this._callOnDispose=new Z,this._callOnModel=new Z,this._callOnDispose.add(e.onDidChangeConfiguration(()=>this._update())),this._callOnDispose.add(e.onDidChangeModel(()=>this._update())),this._callOnDispose.add(e.onDidChangeModelLanguage(()=>this._update())),this._callOnDispose.add(t.documentRangeFormattingEditProvider.onDidChange(this._update,this))}dispose(){this._callOnDispose.dispose(),this._callOnModel.dispose()}_update(){this._callOnModel.clear(),this.editor.getOption(55)&&this.editor.hasModel()&&this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())&&this._callOnModel.add(this.editor.onDidPaste(({range:e})=>this._trigger(e)))}_trigger(e){this.editor.hasModel()&&(this.editor.getSelections().length>1||this._instantiationService.invokeFunction(Lj,this.editor,e,2,Sc.None,Ue.None,!1).catch(Oe))}};WS=DK([Lb(1,pe),Lb(2,ye)],WS);class hke extends ge{constructor(){super({id:"editor.action.formatDocument",label:p("formatDocument.label","Format Document"),alias:"Format Document",precondition:q.and(I.notInCompositeEditor,I.writable,I.hasDocumentFormattingProvider),kbOpts:{kbExpr:I.editorTextFocus,primary:1572,linux:{primary:3111},weight:100},contextMenuOpts:{group:"1_modification",order:1.3}})}async run(e,t){if(t.hasModel()){const i=e.get(ye);await e.get(yh).showWhile(i.invokeFunction(_we,t,1,Sc.None,Ue.None,!0),250)}}}class uke extends ge{constructor(){super({id:"editor.action.formatSelection",label:p("formatSelection.label","Format Selection"),alias:"Format Selection",precondition:q.and(I.writable,I.hasDocumentSelectionFormattingProvider),kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2084),weight:100},contextMenuOpts:{when:I.hasNonEmptySelection,group:"1_modification",order:1.31}})}async run(e,t){if(!t.hasModel())return;const i=e.get(ye),n=t.getModel(),o=t.getSelections().map(a=>a.isEmpty()?new k(a.startLineNumber,1,a.startLineNumber,n.getLineMaxColumn(a.startLineNumber)):a);await e.get(yh).showWhile(i.invokeFunction(Lj,t,o,1,Sc.None,Ue.None,!0),250)}}ct(BS.ID,BS,2);ct(WS.ID,WS,2);Q(hke);Q(uke);ot.registerCommand("editor.action.format",async s=>{const e=s.get(ft).getFocusedCodeEditor();if(!e||!e.hasModel())return;const t=s.get(Ht);e.getSelection().isEmpty()?await t.executeCommand("editor.action.formatDocument"):await t.executeCommand("editor.action.formatSelection")});var gke=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},_I=function(s,e){return function(t,i){e(t,i,s)}};class Hf{remove(){this.parent?.children.delete(this.id)}static findId(e,t){let i;typeof e=="string"?i=`${t.id}/${e}`:(i=`${t.id}/${e.name}`,t.children.get(i)!==void 0&&(i=`${t.id}/${e.name}_${e.range.startLineNumber}_${e.range.startColumn}`));let n=i;for(let o=0;t.children.get(n)!==void 0;o++)n=`${i}_${o}`;return n}static empty(e){return e.children.size===0}}class zM extends Hf{constructor(e,t,i){super(),this.id=e,this.parent=t,this.symbol=i,this.children=new Map}}class IK extends Hf{constructor(e,t,i,n){super(),this.id=e,this.parent=t,this.label=i,this.order=n,this.children=new Map}}class uc extends Hf{static create(e,t,i){const n=new li(i),o=new uc(t.uri),r=e.ordered(t),a=r.map((c,d)=>{const h=Hf.findId(`provider_${d}`,o),u=new IK(h,o,c.displayName??"Unknown Outline Provider",d);return Promise.resolve(c.provideDocumentSymbols(t,n.token)).then(g=>{for(const f of g||[])uc._makeOutlineElement(f,u);return u},g=>(Li(g),u)).then(g=>{Hf.empty(g)?g.remove():o._groups.set(h,g)})}),l=e.onDidChange(()=>{const c=e.ordered(t);ii(c,r)||n.cancel()});return Promise.all(a).then(()=>n.token.isCancellationRequested&&!i.isCancellationRequested?uc.create(e,t,i):o._compact()).finally(()=>{n.dispose(),l.dispose(),n.dispose()})}static _makeOutlineElement(e,t){const i=Hf.findId(e,t),n=new zM(i,t,e);if(e.children)for(const o of e.children)uc._makeOutlineElement(o,n);t.children.set(n.id,n)}constructor(e){super(),this.uri=e,this.id="root",this.parent=void 0,this._groups=new Map,this.children=new Map,this.id="root",this.parent=void 0}_compact(){let e=0;for(const[t,i]of this._groups)i.children.size===0?this._groups.delete(t):e+=1;if(e!==1)this.children=this._groups;else{const t=st.first(this._groups.values());for(const[,i]of t.children)i.parent=this,this.children.set(i.id,i)}return this}getTopLevelSymbols(){const e=[];for(const t of this.children.values())t instanceof zM?e.push(t.symbol):e.push(...st.map(t.children.values(),i=>i.symbol));return e.sort((t,i)=>k.compareRangesUsingStarts(t.range,i.range))}asListOfDocumentSymbols(){const e=this.getTopLevelSymbols(),t=[];return uc._flattenDocumentSymbols(t,e,""),t.sort((i,n)=>P.compare(k.getStartPosition(i.range),k.getStartPosition(n.range))||P.compare(k.getEndPosition(n.range),k.getEndPosition(i.range)))}static _flattenDocumentSymbols(e,t,i){for(const n of t)e.push({kind:n.kind,tags:n.tags,name:n.name,detail:n.detail,containerName:n.containerName||i,range:n.range,selectionRange:n.selectionRange,children:void 0}),n.children&&uc._flattenDocumentSymbols(e,n.children,n.name)}}const iy=Je("IOutlineModelService");let UM=class{constructor(e,t,i){this._languageFeaturesService=e,this._disposables=new Z,this._cache=new Wl(10,.7),this._debounceInformation=t.for(e.documentSymbolProvider,"DocumentSymbols",{min:350}),this._disposables.add(i.onModelRemoved(n=>{this._cache.delete(n.id)}))}dispose(){this._disposables.dispose()}async getOrCreate(e,t){const i=this._languageFeaturesService.documentSymbolProvider,n=i.ordered(e);let o=this._cache.get(e.id);if(!o||o.versionId!==e.getVersionId()||!ii(o.provider,n)){const a=new li;o={versionId:e.getVersionId(),provider:n,promiseCnt:0,source:a,promise:uc.create(i,e,a.token),model:void 0},this._cache.set(e.id,o);const l=Date.now();o.promise.then(c=>{o.model=c,this._debounceInformation.update(e,Date.now()-l)}).catch(c=>{this._cache.delete(e.id)})}if(o.model)return o.model;o.promiseCnt+=1;const r=t.onCancellationRequested(()=>{--o.promiseCnt===0&&(o.source.cancel(),this._cache.delete(e.id))});try{return await o.promise}finally{r.dispose()}}};UM=gke([_I(0,pe),_I(1,Go),_I(2,Zt)],UM);nt(iy,UM,1);ot.registerCommand("_executeDocumentSymbolProvider",async function(s,...e){const[t]=e;gt(Se.isUri(t));const i=s.get(iy),o=await s.get(qs).createModelReference(t);try{return(await i.getOrCreate(o.object.textEditorModel,Ue.None)).getTopLevelSymbols()}finally{o.dispose()}});class ss extends B{static{this.inlineSuggestionVisible=new le("inlineSuggestionVisible",!1,p("inlineSuggestionVisible","Whether an inline suggestion is visible"))}static{this.inlineSuggestionHasIndentation=new le("inlineSuggestionHasIndentation",!1,p("inlineSuggestionHasIndentation","Whether the inline suggestion starts with whitespace"))}static{this.inlineSuggestionHasIndentationLessThanTabSize=new le("inlineSuggestionHasIndentationLessThanTabSize",!0,p("inlineSuggestionHasIndentationLessThanTabSize","Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab"))}static{this.suppressSuggestions=new le("inlineSuggestionSuppressSuggestions",void 0,p("suppressSuggestions","Whether suggestions should be suppressed for the current suggestion"))}constructor(e,t){super(),this.contextKeyService=e,this.model=t,this.inlineCompletionVisible=ss.inlineSuggestionVisible.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentation=ss.inlineSuggestionHasIndentation.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentationLessThanTabSize=ss.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService),this.suppressSuggestions=ss.suppressSuggestions.bindTo(this.contextKeyService),this._register(Pe(i=>{const o=this.model.read(i)?.state.read(i),r=!!o?.inlineCompletion&&o?.primaryGhostText!==void 0&&!o?.primaryGhostText.isEmpty();this.inlineCompletionVisible.set(r),o?.primaryGhostText&&o?.inlineCompletion&&this.suppressSuggestions.set(o.inlineCompletion.inlineCompletion.source.inlineCompletions.suppressSuggestions)})),this._register(Pe(i=>{const n=this.model.read(i);let o=!1,r=!0;const a=n?.primaryGhostText.read(i);if(n?.selectedSuggestItem&&a&&a.parts.length>0){const{column:l,lines:c}=a.parts[0],d=c[0],h=n.textModel.getLineIndentColumn(a.lineNumber);if(l<=h){let g=rs(d);g===-1&&(g=d.length-1),o=g>0;const f=n.textModel.getOptions().tabSize;r=$i.visibleColumnFromColumn(d,g+1,f)<f}}this.inlineCompletionSuggestsIndentation.set(o),this.inlineCompletionSuggestsIndentationLessThanTabSize.set(r)}))}}function fke(s){const e=new Z,t=e.add(J6());return e.add(Pe(i=>{t.setStyle(s.read(i))})),e}class Qv{constructor(e,t){this.lineNumber=e,this.parts=t}equals(e){return this.lineNumber===e.lineNumber&&this.parts.length===e.parts.length&&this.parts.every((t,i)=>t.equals(e.parts[i]))}renderForScreenReader(e){if(this.parts.length===0)return"";const t=this.parts[this.parts.length-1],i=e.substr(0,t.column-1);return new f2([...this.parts.map(o=>new Il(k.fromPositions(new P(1,o.column)),o.lines.join(`
`)))]).applyToString(i).substring(this.parts[0].column-1)}isEmpty(){return this.parts.every(e=>e.lines.length===0)}get lineCount(){return 1+this.parts.reduce((e,t)=>e+t.lines.length-1,0)}}class HS{constructor(e,t,i){this.column=e,this.text=t,this.preview=i,this.lines=Fl(this.text)}equals(e){return this.column===e.column&&this.lines.length===e.lines.length&&this.lines.every((t,i)=>t===e.lines[i])}}class $M{constructor(e,t,i,n=0){this.lineNumber=e,this.columnRange=t,this.text=i,this.additionalReservedLineCount=n,this.parts=[new HS(this.columnRange.endColumnExclusive,this.text,!1)],this.newLines=Fl(this.text)}renderForScreenReader(e){return this.newLines.join(`
`)}get lineCount(){return this.newLines.length}isEmpty(){return this.parts.every(e=>e.lines.length===0)}equals(e){return this.lineNumber===e.lineNumber&&this.columnRange.equals(e.columnRange)&&this.newLines.length===e.newLines.length&&this.newLines.every((t,i)=>t===e.newLines[i])&&this.additionalReservedLineCount===e.additionalReservedLineCount}}function q7(s,e){return ii(s,e,TK)}function TK(s,e){return s===e?!0:!s||!e?!1:s instanceof Qv&&e instanceof Qv||s instanceof $M&&e instanceof $M?s.equals(e):!1}const pke=[];function mke(){return pke}class EK{constructor(e,t){if(this.startColumn=e,this.endColumnExclusive=t,e>t)throw new mt(`startColumn ${e} cannot be after endColumnExclusive ${t}`)}toRange(e){return new k(e,this.startColumn,e,this.endColumnExclusive)}equals(e){return this.startColumn===e.startColumn&&this.endColumnExclusive===e.endColumnExclusive}}function NK(s,e){const t=new Z,i=s.createDecorationsCollection();return t.add(MC({debugName:()=>`Apply decorations from ${e.debugName}`},n=>{const o=e.read(n);i.set(o)})),t.add({dispose:()=>{i.clear()}}),t}function _ke(s,e){return new P(s.lineNumber+e.lineNumber-1,e.lineNumber===1?s.column+e.column-1:e.column)}function G7(s,e){return new P(s.lineNumber-e.lineNumber+1,s.lineNumber-e.lineNumber===0?s.column-e.column+1:s.column)}var bke=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},vke=function(s,e){return function(t,i){e(t,i,s)}};const Y7="ghost-text";let jM=class extends B{constructor(e,t,i){super(),this.editor=e,this.model=t,this.languageService=i,this.isDisposed=Ze(this,!1),this.currentTextModel=kt(this,this.editor.onDidChangeModel,()=>this.editor.getModel()),this.uiState=_e(this,n=>{if(this.isDisposed.read(n))return;const o=this.currentTextModel.read(n);if(o!==this.model.targetTextModel.read(n))return;const r=this.model.ghostText.read(n);if(!r)return;const a=r instanceof $M?r.columnRange:void 0,l=[],c=[];function d(m,_){if(c.length>0){const b=c[c.length-1];_&&b.decorations.push(new ms(b.content.length+1,b.content.length+1+m[0].length,_,0)),b.content+=m[0],m=m.slice(1)}for(const b of m)c.push({content:b,decorations:_?[new ms(1,b.length+1,_,0)]:[]})}const h=o.getLineContent(r.lineNumber);let u,g=0;for(const m of r.parts){let _=m.lines;u===void 0?(l.push({column:m.column,text:_[0],preview:m.preview}),_=_.slice(1)):d([h.substring(g,m.column-1)],void 0),_.length>0&&(d(_,Y7),u===void 0&&m.column<=h.length&&(u=m.column)),g=m.column-1}u!==void 0&&d([h.substring(g)],void 0);const f=u!==void 0?new EK(u,h.length+1):void 0;return{replacedRange:a,inlineTexts:l,additionalLines:c,hiddenRange:f,lineNumber:r.lineNumber,additionalReservedLineCount:this.model.minReservedLineCount.read(n),targetTextModel:o}}),this.decorations=_e(this,n=>{const o=this.uiState.read(n);if(!o)return[];const r=[];o.replacedRange&&r.push({range:o.replacedRange.toRange(o.lineNumber),options:{inlineClassName:"inline-completion-text-to-replace",description:"GhostTextReplacement"}}),o.hiddenRange&&r.push({range:o.hiddenRange.toRange(o.lineNumber),options:{inlineClassName:"ghost-text-hidden",description:"ghost-text-hidden"}});for(const a of o.inlineTexts)r.push({range:k.fromPositions(new P(o.lineNumber,a.column)),options:{description:Y7,after:{content:a.text,inlineClassName:a.preview?"ghost-text-decoration-preview":"ghost-text-decoration",cursorStops:Zr.Left},showIfCollapsed:!0}});return r}),this.additionalLinesWidget=this._register(new Cke(this.editor,this.languageService.languageIdCodec,_e(n=>{const o=this.uiState.read(n);return o?{lineNumber:o.lineNumber,additionalLines:o.additionalLines,minReservedLineCount:o.additionalReservedLineCount,targetTextModel:o.targetTextModel}:void 0}))),this._register(Ce(()=>{this.isDisposed.set(!0,void 0)})),this._register(NK(this.editor,this.decorations))}ownsViewZone(e){return this.additionalLinesWidget.viewZoneId===e}};jM=bke([vke(2,ni)],jM);class Cke extends B{get viewZoneId(){return this._viewZoneId}constructor(e,t,i){super(),this.editor=e,this.languageIdCodec=t,this.lines=i,this._viewZoneId=void 0,this.editorOptionsChanged=En("editorOptionChanged",se.filter(this.editor.onDidChangeConfiguration,n=>n.hasChanged(33)||n.hasChanged(118)||n.hasChanged(100)||n.hasChanged(95)||n.hasChanged(51)||n.hasChanged(50)||n.hasChanged(67))),this._register(Pe(n=>{const o=this.lines.read(n);this.editorOptionsChanged.read(n),o?this.updateLines(o.lineNumber,o.additionalLines,o.minReservedLineCount):this.clear()}))}dispose(){super.dispose(),this.clear()}clear(){this.editor.changeViewZones(e=>{this._viewZoneId&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0)})}updateLines(e,t,i){const n=this.editor.getModel();if(!n)return;const{tabSize:o}=n.getOptions();this.editor.changeViewZones(r=>{this._viewZoneId&&(r.removeZone(this._viewZoneId),this._viewZoneId=void 0);const a=Math.max(t.length,i);if(a>0){const l=document.createElement("div");yke(l,o,t,this.editor.getOptions(),this.languageIdCodec),this._viewZoneId=r.addZone({afterLineNumber:e,heightInLines:a,domNode:l,afterColumnAffinity:1})}})}}function yke(s,e,t,i,n){const o=i.get(33),r=i.get(118),a="none",l=i.get(95),c=i.get(51),d=i.get(50),h=i.get(67),u=new vm(1e4);u.appendString('<div class="suggest-preview-text">');for(let m=0,_=t.length;m<_;m++){const b=t[m],v=b.content;u.appendString('<div class="view-line'),u.appendString('" style="top:'),u.appendString(String(m*h)),u.appendString('px;width:1000000px;">');const C=vC(v),y=Sp(v),w=Pi.createEmpty(v,n);zC(new xh(d.isMonospace&&!o,d.canUseHalfwidthRightwardsArrow,v,!1,C,y,0,w,b.decorations,e,0,d.spaceWidth,d.middotWidth,d.wsmiddotWidth,r,a,l,c!==Ur.OFF,null),u),u.appendString("</div>")}u.appendString("</div>"),wn(s,d);const g=u.build(),f=X7?X7.createHTML(g):g;s.innerHTML=f}const X7=Gc("editorGhostText",{createHTML:s=>s});function wke(s,e){const t=new yU,i=new SU(t,c=>e.getLanguageConfiguration(c)),n=new wU(new Ske([s]),i),o=LN(n,[],void 0,!0);let r="";const a=s.getLineContent();function l(c,d){if(c.kind===2)if(l(c.openingBracket,d),d=vi(d,c.openingBracket.length),c.child&&(l(c.child,d),d=vi(d,c.child.length)),c.closingBracket)l(c.closingBracket,d),d=vi(d,c.closingBracket.length);else{const u=i.getSingleLanguageBracketTokens(c.openingBracket.languageId).findClosingTokenText(c.openingBracket.bracketIds);r+=u}else if(c.kind!==3){if(c.kind===0||c.kind===1)r+=a.substring(d,vi(d,c.length));else if(c.kind===4)for(const h of c.children)l(h,d),d=vi(d,h.length)}}return l(o,ps),r}class Ske{constructor(e){this.lines=e,this.tokenization={getLineTokens:t=>this.lines[t-1]}}getLineCount(){return this.lines.length}getLineLength(e){return this.lines[e-1].getLineContent().length}}async function RK(s,e,t,i,n=Ue.None,o){const r=e instanceof P?kke(e,t):e,a=s.all(t),l=new c2;for(const b of a)b.groupId&&l.add(b.groupId,b);function c(b){if(!b.yieldsToGroupIds)return[];const v=[];for(const C of b.yieldsToGroupIds||[]){const y=l.get(C);for(const w of y)v.push(w)}return v}const d=new Map,h=new Set;function u(b,v){if(v=[...v,b],h.has(b))return v;h.add(b);try{const C=c(b);for(const y of C){const w=u(y,v);if(w)return w}}finally{h.delete(b)}}function g(b){const v=d.get(b);if(v)return v;const C=u(b,[]);C&&Li(new Error(`Inline completions: cyclic yield-to dependency detected. Path: ${C.map(w=>w.toString?w.toString():""+w).join(" -> ")}`));const y=new pm;return d.set(b,y.p),(async()=>{if(!C){const w=c(b);for(const x of w){const L=await g(x);if(L&&L.items.length>0)return}}try{return e instanceof P?await b.provideInlineCompletions(t,e,i,n):await b.provideInlineEdits?.(t,e,i,n)}catch(w){Li(w);return}})().then(w=>y.complete(w),w=>y.error(w)),y.p}const f=await Promise.all(a.map(async b=>({provider:b,completions:await g(b)}))),m=new Map,_=[];for(const b of f){const v=b.completions;if(!v)continue;const C=new xke(v,b.provider);_.push(C);for(const y of v.items){const w=VS.from(y,C,r,t,o);m.set(w.hash(),w)}}return new Lke(Array.from(m.values()),new Set(m.keys()),_)}class Lke{constructor(e,t,i){this.completions=e,this.hashs=t,this.providerResults=i}has(e){return this.hashs.has(e.hash())}dispose(){for(const e of this.providerResults)e.removeRef()}}class xke{constructor(e,t){this.inlineCompletions=e,this.provider=t,this.refCount=1}addRef(){this.refCount++}removeRef(){this.refCount--,this.refCount===0&&this.provider.freeInlineCompletions(this.inlineCompletions)}}class VS{static from(e,t,i,n,o){let r,a,l=e.range?k.lift(e.range):i;if(typeof e.insertText=="string"){if(r=e.insertText,o&&e.completeBracketPairs){r=Q7(r,l.getStartPosition(),n,o);const c=r.length-e.insertText.length;c!==0&&(l=new k(l.startLineNumber,l.startColumn,l.endLineNumber,l.endColumn+c))}a=void 0}else if("snippet"in e.insertText){const c=e.insertText.snippet.length;if(o&&e.completeBracketPairs){e.insertText.snippet=Q7(e.insertText.snippet,l.getStartPosition(),n,o);const h=e.insertText.snippet.length-c;h!==0&&(l=new k(l.startLineNumber,l.startColumn,l.endLineNumber,l.endColumn+h))}const d=new sg().parse(e.insertText.snippet);d.children.length===1&&d.children[0]instanceof us?(r=d.children[0].value,a=void 0):(r=d.toString(),a={snippet:e.insertText.snippet,range:l})}else ML(e.insertText);return new VS(r,e.command,l,r,a,e.additionalTextEdits||mke(),e,t)}constructor(e,t,i,n,o,r,a,l){this.filterText=e,this.command=t,this.range=i,this.insertText=n,this.snippetInfo=o,this.additionalTextEdits=r,this.sourceInlineCompletion=a,this.source=l,e=e.replace(/\r\n|\r/g,`
`),n=e.replace(/\r\n|\r/g,`
`)}withRange(e){return new VS(this.filterText,this.command,e,this.insertText,this.snippetInfo,this.additionalTextEdits,this.sourceInlineCompletion,this.source)}hash(){return JSON.stringify({insertText:this.insertText,range:this.range.toString()})}toSingleTextEdit(){return new Il(this.range,this.insertText)}}function kke(s,e){const t=e.getWordAtPosition(s),i=e.getLineMaxColumn(s.lineNumber);return t?new k(s.lineNumber,t.startColumn,s.lineNumber,i):k.fromPositions(s,s.with(void 0,i))}function Q7(s,e,t,i){const o=t.getLineContent(e.lineNumber).substring(0,e.column-1)+s,a=t.tokenization.tokenizeLineWithEdit(e,o.length-(e.column-1),s)?.sliceAndInflate(e.column-1,o.length,0);return a?wke(a,i):s}function Bu(s,e,t){const i=t?s.range.intersectRanges(t):s.range;if(!i)return s;const n=e.getValueInRange(i,1),o=th(n,s.text),r=Hs.ofText(n.substring(0,o)).addToPosition(s.range.getStartPosition()),a=s.text.substring(o),l=k.fromPositions(r,s.range.getEndPosition());return new Il(l,a)}function MK(s,e){return s.text.startsWith(e.text)&&Dke(s.range,e.range)}function J7(s,e,t,i,n=0){let o=Bu(s,e);if(o.range.endLineNumber!==o.range.startLineNumber)return;const r=e.getLineContent(o.range.startLineNumber),a=Mt(r).length;if(o.range.startColumn-1<=a){const f=Mt(o.text).length,m=r.substring(o.range.startColumn-1,a),[_,b]=[o.range.getStartPosition(),o.range.getEndPosition()],v=_.column+m.length<=b.column?_.delta(0,m.length):b,C=k.fromPositions(v,b),y=o.text.startsWith(m)?o.text.substring(m.length):o.text.substring(f);o=new Il(C,y)}const c=e.getValueInRange(o.range),d=Ike(c,o.text);if(!d)return;const h=o.range.startLineNumber,u=new Array;if(t==="prefix"){const f=d.filter(m=>m.originalLength===0);if(f.length>1||f.length===1&&f[0].originalStart!==c.length)return}const g=o.text.length-n;for(const f of d){const m=o.range.startColumn+f.originalStart+f.originalLength;if(t==="subwordSmart"&&i&&i.lineNumber===o.range.startLineNumber&&m<i.column||f.originalLength>0)return;if(f.modifiedLength===0)continue;const _=f.modifiedStart+f.modifiedLength,b=Math.max(f.modifiedStart,Math.min(_,g)),v=o.text.substring(f.modifiedStart,b),C=o.text.substring(b,Math.max(f.modifiedStart,_));v.length>0&&u.push(new HS(m,v,!1)),C.length>0&&u.push(new HS(m,C,!0))}return new Qv(h,u)}function Dke(s,e){return e.getStartPosition().equals(s.getStartPosition())&&e.getEndPosition().isBeforeOrEqual(s.getEndPosition())}let pw;function Ike(s,e){if(pw?.originalValue===s&&pw?.newValue===e)return pw?.changes;{let t=t8(s,e,!0);if(t){const i=e8(t);if(i>0){const n=t8(s,e,!1);n&&e8(n)<i&&(t=n)}}return pw={originalValue:s,newValue:e,changes:t},t}}function e8(s){let e=0;for(const t of s)e+=t.originalLength;return e}function t8(s,e,t){if(s.length>5e3||e.length>5e3)return;function i(c){let d=0;for(let h=0,u=c.length;h<u;h++){const g=c.charCodeAt(h);g>d&&(d=g)}return d}const n=Math.max(i(s),i(e));function o(c){if(c<0)throw new Error("unexpected");return n+c+1}function r(c){let d=0,h=0;const u=new Int32Array(c.length);for(let g=0,f=c.length;g<f;g++)if(t&&c[g]==="("){const m=h*100+d;u[g]=o(2*m),d++}else if(t&&c[g]===")"){d=Math.max(d-1,0);const m=h*100+d;u[g]=o(2*m+1),d===0&&h++}else u[g]=c.charCodeAt(g);return u}const a=r(s),l=r(e);return new bl({getElements:()=>a},{getElements:()=>l}).ComputeDiff(!1).changes}var Tke=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},i8=function(s,e){return function(t,i){e(t,i,s)}};let ZM=class extends B{constructor(e,t,i,n,o){super(),this.textModel=e,this.versionId=t,this._debounceValue=i,this.languageFeaturesService=n,this.languageConfigurationService=o,this._updateOperation=this._register(new nn),this.inlineCompletions=gv("inlineCompletions",void 0),this.suggestWidgetInlineCompletions=gv("suggestWidgetInlineCompletions",void 0),this._register(this.textModel.onDidChangeContent(()=>{this._updateOperation.clear()}))}fetch(e,t,i){const n=new Nke(e,t,this.textModel.getVersionId()),o=t.selectedSuggestionInfo?this.suggestWidgetInlineCompletions:this.inlineCompletions;if(this._updateOperation.value?.request.satisfies(n))return this._updateOperation.value.promise;if(o.get()?.request.satisfies(n))return Promise.resolve(!0);const r=!!this._updateOperation.value;this._updateOperation.clear();const a=new li,l=(async()=>{if((r||t.triggerKind===Ea.Automatic)&&await Eke(this._debounceValue.get(this.textModel),a.token),a.token.isCancellationRequested||this._store.isDisposed||this.textModel.getVersionId()!==n.versionId)return!1;const h=new Date,u=await RK(this.languageFeaturesService.inlineCompletionsProvider,e,this.textModel,t,a.token,this.languageConfigurationService);if(a.token.isCancellationRequested||this._store.isDisposed||this.textModel.getVersionId()!==n.versionId)return!1;const g=new Date;this._debounceValue.update(this.textModel,g.getTime()-h.getTime());const f=new Mke(u,n,this.textModel,this.versionId);if(i){const m=i.toInlineCompletion(void 0);i.canBeReused(this.textModel,e)&&!u.has(m)&&f.prepend(i.inlineCompletion,m.range,!0)}return this._updateOperation.clear(),ai(m=>{o.set(f,m)}),!0})(),c=new Rke(n,a,l);return this._updateOperation.value=c,l}clear(e){this._updateOperation.clear(),this.inlineCompletions.set(void 0,e),this.suggestWidgetInlineCompletions.set(void 0,e)}clearSuggestWidgetInlineCompletions(e){this._updateOperation.value?.request.context.selectedSuggestionInfo&&this._updateOperation.clear(),this.suggestWidgetInlineCompletions.set(void 0,e)}cancelUpdate(){this._updateOperation.clear()}};ZM=Tke([i8(3,pe),i8(4,di)],ZM);function Eke(s,e){return new Promise(t=>{let i;const n=setTimeout(()=>{i&&i.dispose(),t()},s);e&&(i=e.onCancellationRequested(()=>{clearTimeout(n),i&&i.dispose(),t()}))})}class Nke{constructor(e,t,i){this.position=e,this.context=t,this.versionId=i}satisfies(e){return this.position.equals(e.position)&&aN(this.context.selectedSuggestionInfo,e.context.selectedSuggestionInfo,Ice())&&(e.context.triggerKind===Ea.Automatic||this.context.triggerKind===Ea.Explicit)&&this.versionId===e.versionId}}class Rke{constructor(e,t,i){this.request=e,this.cancellationTokenSource=t,this.promise=i}dispose(){this.cancellationTokenSource.cancel()}}class Mke{get inlineCompletions(){return this._inlineCompletions}constructor(e,t,i,n){this.inlineCompletionProviderResult=e,this.request=t,this._textModel=i,this._versionId=n,this._refCount=1,this._prependedInlineCompletionItems=[];const o=i.deltaDecorations([],e.completions.map(r=>({range:r.range,options:{description:"inline-completion-tracking-range"}})));this._inlineCompletions=e.completions.map((r,a)=>new n8(r,o[a],this._textModel,this._versionId))}clone(){return this._refCount++,this}dispose(){if(this._refCount--,this._refCount===0){setTimeout(()=>{this._textModel.isDisposed()||this._textModel.deltaDecorations(this._inlineCompletions.map(e=>e.decorationId),[])},0),this.inlineCompletionProviderResult.dispose();for(const e of this._prependedInlineCompletionItems)e.source.removeRef()}}prepend(e,t,i){i&&e.source.addRef();const n=this._textModel.deltaDecorations([],[{range:t,options:{description:"inline-completion-tracking-range"}}])[0];this._inlineCompletions.unshift(new n8(e,n,this._textModel,this._versionId)),this._prependedInlineCompletionItems.push(e)}}class n8{get forwardStable(){return this.inlineCompletion.source.inlineCompletions.enableForwardStability??!1}constructor(e,t,i,n){this.inlineCompletion=e,this.decorationId=t,this._textModel=i,this._modelVersion=n,this.semanticId=JSON.stringify([this.inlineCompletion.filterText,this.inlineCompletion.insertText,this.inlineCompletion.range.getStartPosition().toString()]),this._updatedRange=Ao({owner:this,equalsFn:k.equalsRange},o=>(this._modelVersion.read(o),this._textModel.getDecorationRange(this.decorationId)))}toInlineCompletion(e){return this.inlineCompletion.withRange(this._updatedRange.read(e)??bI)}toSingleTextEdit(e){return new Il(this._updatedRange.read(e)??bI,this.inlineCompletion.insertText)}isVisible(e,t,i){const n=Bu(this._toFilterTextReplacement(i),e),o=this._updatedRange.read(i);if(!o||!this.inlineCompletion.range.getStartPosition().equals(o.getStartPosition())||t.lineNumber!==n.range.startLineNumber)return!1;const r=e.getValueInRange(n.range,1),a=n.text,l=Math.max(0,t.column-n.range.startColumn);let c=a.substring(0,l),d=a.substring(l),h=r.substring(0,l),u=r.substring(l);const g=e.getLineIndentColumn(n.range.startLineNumber);return n.range.startColumn<=g&&(h=h.trimStart(),h.length===0&&(u=u.trimStart()),c=c.trimStart(),c.length===0&&(d=d.trimStart())),c.startsWith(h)&&!!Dz(u,d)}canBeReused(e,t){const i=this._updatedRange.read(void 0);return!!i&&i.containsPosition(t)&&this.isVisible(e,t,void 0)&&Hs.ofRange(i).isGreaterThanOrEqualTo(Hs.ofRange(this.inlineCompletion.range))}_toFilterTextReplacement(e){return new Il(this._updatedRange.read(e)??bI,this.inlineCompletion.filterText)}}const bI=new k(1,1,1,1),$e={Visible:r4,HasFocusedSuggestion:new le("suggestWidgetHasFocusedSuggestion",!1,p("suggestWidgetHasSelection","Whether any suggestion is focused")),DetailsVisible:new le("suggestWidgetDetailsVisible",!1,p("suggestWidgetDetailsVisible","Whether suggestion details are visible")),MultipleSuggestions:new le("suggestWidgetMultipleSuggestions",!1,p("suggestWidgetMultipleSuggestions","Whether there are multiple suggestions to pick from")),MakesTextEdit:new le("suggestionMakesTextEdit",!0,p("suggestionMakesTextEdit","Whether inserting the current suggestion yields in a change or has everything already been typed")),AcceptSuggestionsOnEnter:new le("acceptSuggestionOnEnter",!0,p("acceptSuggestionOnEnter","Whether suggestions are inserted when pressing Enter")),HasInsertAndReplaceRange:new le("suggestionHasInsertAndReplaceRange",!1,p("suggestionHasInsertAndReplaceRange","Whether the current suggestion has insert and replace behaviour")),InsertMode:new le("suggestionInsertMode",void 0,{type:"string",description:p("suggestionInsertMode","Whether the default behaviour is to insert or replace")}),CanResolve:new le("suggestionCanResolve",!1,p("suggestionCanResolve","Whether the current suggestion supports to resolve further details"))},Xd=new M("suggestWidgetStatusBar");class Ake{constructor(e,t,i,n){this.position=e,this.completion=t,this.container=i,this.provider=n,this.isInvalid=!1,this.score=Aa.Default,this.distance=0,this.textLabel=typeof t.label=="string"?t.label:t.label?.label,this.labelLow=this.textLabel.toLowerCase(),this.isInvalid=!this.textLabel,this.sortTextLow=t.sortText&&t.sortText.toLowerCase(),this.filterTextLow=t.filterText&&t.filterText.toLowerCase(),this.extensionId=t.extensionId,k.isIRange(t.range)?(this.editStart=new P(t.range.startLineNumber,t.range.startColumn),this.editInsertEnd=new P(t.range.endLineNumber,t.range.endColumn),this.editReplaceEnd=new P(t.range.endLineNumber,t.range.endColumn),this.isInvalid=this.isInvalid||k.spansMultipleLines(t.range)||t.range.startLineNumber!==e.lineNumber):(this.editStart=new P(t.range.insert.startLineNumber,t.range.insert.startColumn),this.editInsertEnd=new P(t.range.insert.endLineNumber,t.range.insert.endColumn),this.editReplaceEnd=new P(t.range.replace.endLineNumber,t.range.replace.endColumn),this.isInvalid=this.isInvalid||k.spansMultipleLines(t.range.insert)||k.spansMultipleLines(t.range.replace)||t.range.insert.startLineNumber!==e.lineNumber||t.range.replace.startLineNumber!==e.lineNumber||t.range.insert.startColumn!==t.range.replace.startColumn),typeof n.resolveCompletionItem!="function"&&(this._resolveCache=Promise.resolve(),this._resolveDuration=0)}get isResolved(){return this._resolveDuration!==void 0}get resolveDuration(){return this._resolveDuration!==void 0?this._resolveDuration:-1}async resolve(e){if(!this._resolveCache){const t=e.onCancellationRequested(()=>{this._resolveCache=void 0,this._resolveDuration=void 0}),i=new un(!0);this._resolveCache=Promise.resolve(this.provider.resolveCompletionItem(this.completion,e)).then(n=>{Object.assign(this.completion,n),this._resolveDuration=i.elapsed()},n=>{xr(n)&&(this._resolveCache=void 0,this._resolveDuration=void 0)}).finally(()=>{t.dispose()})}return this._resolveCache}}class ny{static{this.default=new ny}constructor(e=2,t=new Set,i=new Set,n=new Map,o=!0){this.snippetSortOrder=e,this.kindFilter=t,this.providerFilter=i,this.providerItemsToReuse=n,this.showDeprecated=o}}class Pke{constructor(e,t,i,n){this.items=e,this.needsClipboard=t,this.durations=i,this.disposable=n}}async function f4(s,e,t,i=ny.default,n={triggerKind:0},o=Ue.None){const r=new un;t=t.clone();const a=e.getWordAtPosition(t),l=a?new k(t.lineNumber,a.startColumn,t.lineNumber,a.endColumn):k.fromPositions(t),c={replace:l,insert:l.setEndPosition(t.lineNumber,t.column)},d=[],h=new Z,u=[];let g=!1;const f=(_,b,v)=>{let C=!1;if(!b)return C;for(const y of b.suggestions)if(!i.kindFilter.has(y.kind)){if(!i.showDeprecated&&y?.tags?.includes(1))continue;y.range||(y.range=c),y.sortText||(y.sortText=typeof y.label=="string"?y.label:y.label.label),!g&&y.insertTextRules&&y.insertTextRules&4&&(g=sg.guessNeedsClipboard(y.insertText)),d.push(new Ake(t,y,b,_)),C=!0}return mL(b)&&h.add(b),u.push({providerName:_._debugDisplayName??"unknown_provider",elapsedProvider:b.duration??-1,elapsedOverall:v.elapsed()}),C},m=(async()=>{})();for(const _ of s.orderedGroups(e)){let b=!1;if(await Promise.all(_.map(async v=>{if(i.providerItemsToReuse.has(v)){const C=i.providerItemsToReuse.get(v);C.forEach(y=>d.push(y)),b=b||C.length>0;return}if(!(i.providerFilter.size>0&&!i.providerFilter.has(v)))try{const C=new un,y=await v.provideCompletionItems(e,t,n,o);b=f(v,y,C)||b}catch(C){Li(C)}})),b||o.isCancellationRequested)break}return await m,o.isCancellationRequested?(h.dispose(),Promise.reject(new Xr)):new Pke(d.sort(Bke(i.snippetSortOrder)),g,{entries:u,elapsed:r.elapsed()},h)}function p4(s,e){if(s.sortTextLow&&e.sortTextLow){if(s.sortTextLow<e.sortTextLow)return-1;if(s.sortTextLow>e.sortTextLow)return 1}return s.textLabel<e.textLabel?-1:s.textLabel>e.textLabel?1:s.completion.kind-e.completion.kind}function Oke(s,e){if(s.completion.kind!==e.completion.kind){if(s.completion.kind===27)return-1;if(e.completion.kind===27)return 1}return p4(s,e)}function Fke(s,e){if(s.completion.kind!==e.completion.kind){if(s.completion.kind===27)return 1;if(e.completion.kind===27)return-1}return p4(s,e)}const tk=new Map;tk.set(0,Oke);tk.set(2,Fke);tk.set(1,p4);function Bke(s){return tk.get(s)}ot.registerCommand("_executeCompletionItemProvider",async(s,...e)=>{const[t,i,n,o]=e;gt(Se.isUri(t)),gt(P.isIPosition(i)),gt(typeof n=="string"||!n),gt(typeof o=="number"||!o);const{completionProvider:r}=s.get(pe),a=await s.get(qs).createModelReference(t);try{const l={incomplete:!1,suggestions:[]},c=[],d=a.object.textEditorModel.validatePosition(i),h=await f4(r,a.object.textEditorModel,d,void 0,{triggerCharacter:n??void 0,triggerKind:n?1:0});for(const u of h.items)c.length<(o??0)&&c.push(u.resolve(Ue.None)),l.incomplete=l.incomplete||u.container.incomplete,l.suggestions.push(u.completion);try{return await Promise.all(c),l}finally{setTimeout(()=>h.disposable.dispose(),100)}}finally{a.dispose()}});function Wke(s,e){s.getContribution("editor.contrib.suggestController")?.triggerSuggest(new Set().add(e),void 0,!0)}class Vf{static isAllOff(e){return e.other==="off"&&e.comments==="off"&&e.strings==="off"}static isAllOn(e){return e.other==="on"&&e.comments==="on"&&e.strings==="on"}static valueFor(e,t){switch(t){case 1:return e.comments;case 2:return e.strings;default:return e.other}}}function s8(s,e=An){return Jse(s,e)?s.charAt(0).toUpperCase()+s.slice(1):s}var Hke=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Vke=function(s,e){return function(t,i){e(t,i,s)}};class o8{constructor(e){this._delegates=e}resolve(e){for(const t of this._delegates){const i=t.resolve(e);if(i!==void 0)return i}}}class r8{constructor(e,t,i,n){this._model=e,this._selection=t,this._selectionIdx=i,this._overtypingCapturer=n}resolve(e){const{name:t}=e;if(t==="SELECTION"||t==="TM_SELECTED_TEXT"){let i=this._model.getValueInRange(this._selection)||void 0,n=this._selection.startLineNumber!==this._selection.endLineNumber;if(!i&&this._overtypingCapturer){const o=this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);o&&(i=o.value,n=o.multiline)}if(i&&n&&e.snippet){const o=this._model.getLineContent(this._selection.startLineNumber),r=Mt(o,0,this._selection.startColumn-1);let a=r;e.snippet.walk(c=>c===e?!1:(c instanceof us&&(a=Mt(Fl(c.value).pop())),!0));const l=th(a,r);i=i.replace(/(\r\n|\r|\n)(.*)/g,(c,d,h)=>`${d}${a.substr(l)}${h}`)}return i}else{if(t==="TM_CURRENT_LINE")return this._model.getLineContent(this._selection.positionLineNumber);if(t==="TM_CURRENT_WORD"){const i=this._model.getWordAtPosition({lineNumber:this._selection.positionLineNumber,column:this._selection.positionColumn});return i&&i.word||void 0}else{if(t==="TM_LINE_INDEX")return String(this._selection.positionLineNumber-1);if(t==="TM_LINE_NUMBER")return String(this._selection.positionLineNumber);if(t==="CURSOR_INDEX")return String(this._selectionIdx);if(t==="CURSOR_NUMBER")return String(this._selectionIdx+1)}}}}class a8{constructor(e,t){this._labelService=e,this._model=t}resolve(e){const{name:t}=e;if(t==="TM_FILENAME")return jd(this._model.uri.fsPath);if(t==="TM_FILENAME_BASE"){const i=jd(this._model.uri.fsPath),n=i.lastIndexOf(".");return n<=0?i:i.slice(0,n)}else{if(t==="TM_DIRECTORY")return m6(this._model.uri.fsPath)==="."?"":this._labelService.getUriLabel(JL(this._model.uri));if(t==="TM_FILEPATH")return this._labelService.getUriLabel(this._model.uri);if(t==="RELATIVE_FILEPATH")return this._labelService.getUriLabel(this._model.uri,{relative:!0,noPrefix:!0})}}}class l8{constructor(e,t,i,n){this._readClipboardText=e,this._selectionIdx=t,this._selectionCount=i,this._spread=n}resolve(e){if(e.name!=="CLIPBOARD")return;const t=this._readClipboardText();if(t){if(this._spread){const i=t.split(/\r\n|\n|\r/).filter(n=>!x6(n));if(i.length===this._selectionCount)return i[this._selectionIdx]}return t}}}let zS=class{constructor(e,t,i){this._model=e,this._selection=t,this._languageConfigurationService=i}resolve(e){const{name:t}=e,i=this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber,this._selection.selectionStartColumn),n=this._languageConfigurationService.getLanguageConfiguration(i).comments;if(n){if(t==="LINE_COMMENT")return n.lineCommentToken||void 0;if(t==="BLOCK_COMMENT_START")return n.blockCommentStartToken||void 0;if(t==="BLOCK_COMMENT_END")return n.blockCommentEndToken||void 0}}};zS=Hke([Vke(2,di)],zS);class Lu{constructor(){this._date=new Date}static{this.dayNames=[p("Sunday","Sunday"),p("Monday","Monday"),p("Tuesday","Tuesday"),p("Wednesday","Wednesday"),p("Thursday","Thursday"),p("Friday","Friday"),p("Saturday","Saturday")]}static{this.dayNamesShort=[p("SundayShort","Sun"),p("MondayShort","Mon"),p("TuesdayShort","Tue"),p("WednesdayShort","Wed"),p("ThursdayShort","Thu"),p("FridayShort","Fri"),p("SaturdayShort","Sat")]}static{this.monthNames=[p("January","January"),p("February","February"),p("March","March"),p("April","April"),p("May","May"),p("June","June"),p("July","July"),p("August","August"),p("September","September"),p("October","October"),p("November","November"),p("December","December")]}static{this.monthNamesShort=[p("JanuaryShort","Jan"),p("FebruaryShort","Feb"),p("MarchShort","Mar"),p("AprilShort","Apr"),p("MayShort","May"),p("JuneShort","Jun"),p("JulyShort","Jul"),p("AugustShort","Aug"),p("SeptemberShort","Sep"),p("OctoberShort","Oct"),p("NovemberShort","Nov"),p("DecemberShort","Dec")]}resolve(e){const{name:t}=e;if(t==="CURRENT_YEAR")return String(this._date.getFullYear());if(t==="CURRENT_YEAR_SHORT")return String(this._date.getFullYear()).slice(-2);if(t==="CURRENT_MONTH")return String(this._date.getMonth().valueOf()+1).padStart(2,"0");if(t==="CURRENT_DATE")return String(this._date.getDate().valueOf()).padStart(2,"0");if(t==="CURRENT_HOUR")return String(this._date.getHours().valueOf()).padStart(2,"0");if(t==="CURRENT_MINUTE")return String(this._date.getMinutes().valueOf()).padStart(2,"0");if(t==="CURRENT_SECOND")return String(this._date.getSeconds().valueOf()).padStart(2,"0");if(t==="CURRENT_DAY_NAME")return Lu.dayNames[this._date.getDay()];if(t==="CURRENT_DAY_NAME_SHORT")return Lu.dayNamesShort[this._date.getDay()];if(t==="CURRENT_MONTH_NAME")return Lu.monthNames[this._date.getMonth()];if(t==="CURRENT_MONTH_NAME_SHORT")return Lu.monthNamesShort[this._date.getMonth()];if(t==="CURRENT_SECONDS_UNIX")return String(Math.floor(this._date.getTime()/1e3));if(t==="CURRENT_TIMEZONE_OFFSET"){const i=this._date.getTimezoneOffset(),n=i>0?"-":"+",o=Math.trunc(Math.abs(i/60)),r=o<10?"0"+o:o,a=Math.abs(i)-o*60,l=a<10?"0"+a:a;return n+r+":"+l}}}class c8{constructor(e){this._workspaceService=e}resolve(e){if(!this._workspaceService)return;const t=_ce(this._workspaceService.getWorkspace());if(!pce(t)){if(e.name==="WORKSPACE_NAME")return this._resolveWorkspaceName(t);if(e.name==="WORKSPACE_FOLDER")return this._resoveWorkspacePath(t)}}_resolveWorkspaceName(e){if(eN(e))return jd(e.uri.path);let t=jd(e.configPath.path);return t.endsWith(tN)&&(t=t.substr(0,t.length-tN.length-1)),t}_resoveWorkspacePath(e){if(eN(e))return s8(e.uri.fsPath);const t=jd(e.configPath.path);let i=e.configPath.fsPath;return i.endsWith(t)&&(i=i.substr(0,i.length-t.length-1)),i?s8(i):"/"}}class d8{resolve(e){const{name:t}=e;if(t==="RANDOM")return Math.random().toString().slice(-6);if(t==="RANDOM_HEX")return Math.random().toString(16).slice(-6);if(t==="UUID")return $x()}}var zke=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Uke=function(s,e){return function(t,i){e(t,i,s)}},ga;class Fr{static{this._decor={active:We.register({description:"snippet-placeholder-1",stickiness:0,className:"snippet-placeholder"}),inactive:We.register({description:"snippet-placeholder-2",stickiness:1,className:"snippet-placeholder"}),activeFinal:We.register({description:"snippet-placeholder-3",stickiness:1,className:"finish-snippet-placeholder"}),inactiveFinal:We.register({description:"snippet-placeholder-4",stickiness:1,className:"finish-snippet-placeholder"})}}constructor(e,t,i){this._editor=e,this._snippet=t,this._snippetLineLeadingWhitespace=i,this._offset=-1,this._nestingLevel=1,this._placeholderGroups=v5(t.placeholders,ar.compareByIndex),this._placeholderGroupsIdx=-1}initialize(e){this._offset=e.newPosition}dispose(){this._placeholderDecorations&&this._editor.removeDecorations([...this._placeholderDecorations.values()]),this._placeholderGroups.length=0}_initDecorations(){if(this._offset===-1)throw new Error("Snippet not initialized!");if(this._placeholderDecorations)return;this._placeholderDecorations=new Map;const e=this._editor.getModel();this._editor.changeDecorations(t=>{for(const i of this._snippet.placeholders){const n=this._snippet.offset(i),o=this._snippet.fullLen(i),r=k.fromPositions(e.getPositionAt(this._offset+n),e.getPositionAt(this._offset+n+o)),a=i.isFinalTabstop?Fr._decor.inactiveFinal:Fr._decor.inactive,l=t.addDecoration(r,a);this._placeholderDecorations.set(i,l)}})}move(e){if(!this._editor.hasModel())return[];if(this._initDecorations(),this._placeholderGroupsIdx>=0){const n=[];for(const o of this._placeholderGroups[this._placeholderGroupsIdx])if(o.transform){const r=this._placeholderDecorations.get(o),a=this._editor.getModel().getDecorationRange(r),l=this._editor.getModel().getValueInRange(a),c=o.transform.resolve(l).split(/\r\n|\r|\n/);for(let d=1;d<c.length;d++)c[d]=this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace+c[d]);n.push(ri.replace(a,c.join(this._editor.getModel().getEOL())))}n.length>0&&this._editor.executeEdits("snippet.placeholderTransform",n)}let t=!1;e===!0&&this._placeholderGroupsIdx<this._placeholderGroups.length-1?(this._placeholderGroupsIdx+=1,t=!0):e===!1&&this._placeholderGroupsIdx>0&&(this._placeholderGroupsIdx-=1,t=!0);const i=this._editor.getModel().changeDecorations(n=>{const o=new Set,r=[];for(const a of this._placeholderGroups[this._placeholderGroupsIdx]){const l=this._placeholderDecorations.get(a),c=this._editor.getModel().getDecorationRange(l);r.push(new me(c.startLineNumber,c.startColumn,c.endLineNumber,c.endColumn)),t=t&&this._hasPlaceholderBeenCollapsed(a),n.changeDecorationOptions(l,a.isFinalTabstop?Fr._decor.activeFinal:Fr._decor.active),o.add(a);for(const d of this._snippet.enclosingPlaceholders(a)){const h=this._placeholderDecorations.get(d);n.changeDecorationOptions(h,d.isFinalTabstop?Fr._decor.activeFinal:Fr._decor.active),o.add(d)}}for(const[a,l]of this._placeholderDecorations)o.has(a)||n.changeDecorationOptions(l,a.isFinalTabstop?Fr._decor.inactiveFinal:Fr._decor.inactive);return r});return t?this.move(e):i??[]}_hasPlaceholderBeenCollapsed(e){let t=e;for(;t;){if(t instanceof ar){const i=this._placeholderDecorations.get(t);if(this._editor.getModel().getDecorationRange(i).isEmpty()&&t.toString().length>0)return!0}t=t.parent}return!1}get isAtFirstPlaceholder(){return this._placeholderGroupsIdx<=0||this._placeholderGroups.length===0}get isAtLastPlaceholder(){return this._placeholderGroupsIdx===this._placeholderGroups.length-1}get hasPlaceholder(){return this._snippet.placeholders.length>0}get isTrivialSnippet(){if(this._snippet.placeholders.length===0)return!0;if(this._snippet.placeholders.length===1){const[e]=this._snippet.placeholders;if(e.isFinalTabstop&&this._snippet.rightMostDescendant===e)return!0}return!1}computePossibleSelections(){const e=new Map;for(const t of this._placeholderGroups){let i;for(const n of t){if(n.isFinalTabstop)break;i||(i=[],e.set(n.index,i));const o=this._placeholderDecorations.get(n),r=this._editor.getModel().getDecorationRange(o);if(!r){e.delete(n.index);break}i.push(r)}}return e}get activeChoice(){if(!this._placeholderDecorations)return;const e=this._placeholderGroups[this._placeholderGroupsIdx][0];if(!e?.choice)return;const t=this._placeholderDecorations.get(e);if(!t)return;const i=this._editor.getModel().getDecorationRange(t);if(i)return{range:i,choice:e.choice}}get hasChoice(){let e=!1;return this._snippet.walk(t=>(e=t instanceof Fm,!e)),e}merge(e){const t=this._editor.getModel();this._nestingLevel*=10,this._editor.changeDecorations(i=>{for(const n of this._placeholderGroups[this._placeholderGroupsIdx]){const o=e.shift();console.assert(o._offset!==-1),console.assert(!o._placeholderDecorations);const r=o._snippet.placeholderInfo.last.index;for(const l of o._snippet.placeholderInfo.all)l.isFinalTabstop?l.index=n.index+(r+1)/this._nestingLevel:l.index=n.index+l.index/this._nestingLevel;this._snippet.replace(n,o._snippet.children);const a=this._placeholderDecorations.get(n);i.removeDecoration(a),this._placeholderDecorations.delete(n);for(const l of o._snippet.placeholders){const c=o._snippet.offset(l),d=o._snippet.fullLen(l),h=k.fromPositions(t.getPositionAt(o._offset+c),t.getPositionAt(o._offset+c+d)),u=i.addDecoration(h,Fr._decor.inactive);this._placeholderDecorations.set(l,u)}}this._placeholderGroups=v5(this._snippet.placeholders,ar.compareByIndex)})}}const h8={overwriteBefore:0,overwriteAfter:0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};let US=ga=class{static adjustWhitespace(e,t,i,n,o){const r=e.getLineContent(t.lineNumber),a=Mt(r,0,t.column-1);let l;return n.walk(c=>{if(!(c instanceof us)||c.parent instanceof Fm||o&&!o.has(c))return!0;const d=c.value.split(/\r\n|\r|\n/);if(i){const u=n.offset(c);if(u===0)d[0]=e.normalizeIndentation(d[0]);else{l=l??n.toString();const g=l.charCodeAt(u-1);(g===10||g===13)&&(d[0]=e.normalizeIndentation(a+d[0]))}for(let g=1;g<d.length;g++)d[g]=e.normalizeIndentation(a+d[g])}const h=d.join(e.getEOL());return h!==c.value&&(c.parent.replace(c,[new us(h)]),l=void 0),!0}),a}static adjustSelection(e,t,i,n){if(i!==0||n!==0){const{positionLineNumber:o,positionColumn:r}=t,a=r-i,l=r+n,c=e.validateRange({startLineNumber:o,startColumn:a,endLineNumber:o,endColumn:l});t=me.createWithDirection(c.startLineNumber,c.startColumn,c.endLineNumber,c.endColumn,t.getDirection())}return t}static createEditsAndSnippetsFromSelections(e,t,i,n,o,r,a,l,c){const d=[],h=[];if(!e.hasModel())return{edits:d,snippets:h};const u=e.getModel(),g=e.invokeWithinContext(y=>y.get(Xu)),f=e.invokeWithinContext(y=>new a8(y.get(Pp),u)),m=()=>a,_=u.getValueInRange(ga.adjustSelection(u,e.getSelection(),i,0)),b=u.getValueInRange(ga.adjustSelection(u,e.getSelection(),0,n)),v=u.getLineFirstNonWhitespaceColumn(e.getSelection().positionLineNumber),C=e.getSelections().map((y,w)=>({selection:y,idx:w})).sort((y,w)=>k.compareRangesUsingStarts(y.selection,w.selection));for(const{selection:y,idx:w}of C){let x=ga.adjustSelection(u,y,i,0),L=ga.adjustSelection(u,y,0,n);_!==u.getValueInRange(x)&&(x=y),b!==u.getValueInRange(L)&&(L=y);const D=y.setStartPosition(x.startLineNumber,x.startColumn).setEndPosition(L.endLineNumber,L.endColumn),T=new sg().parse(t,!0,o),F=D.getStartPosition(),W=ga.adjustWhitespace(u,F,r||w>0&&v!==u.getLineFirstNonWhitespaceColumn(y.positionLineNumber),T);T.resolveVariables(new o8([f,new l8(m,w,C.length,e.getOption(79)==="spread"),new r8(u,y,w,l),new zS(u,y,c),new Lu,new c8(g),new d8])),d[w]=ri.replace(D,T.toString()),d[w].identifier={major:w,minor:0},d[w]._isTracked=!0,h[w]=new Fr(e,T,W)}return{edits:d,snippets:h}}static createEditsAndSnippetsFromEdits(e,t,i,n,o,r,a){if(!e.hasModel()||t.length===0)return{edits:[],snippets:[]};const l=[],c=e.getModel(),d=new sg,h=new GC,u=new o8([e.invokeWithinContext(f=>new a8(f.get(Pp),c)),new l8(()=>o,0,e.getSelections().length,e.getOption(79)==="spread"),new r8(c,e.getSelection(),0,r),new zS(c,e.getSelection(),a),new Lu,new c8(e.invokeWithinContext(f=>f.get(Xu))),new d8]);t=t.sort((f,m)=>k.compareRangesUsingStarts(f.range,m.range));let g=0;for(let f=0;f<t.length;f++){const{range:m,template:_}=t[f];if(f>0){const w=t[f-1].range,x=k.fromPositions(w.getEndPosition(),m.getStartPosition()),L=new us(c.getValueInRange(x));h.appendChild(L),g+=L.value.length}const b=d.parseFragment(_,h);ga.adjustWhitespace(c,m.getStartPosition(),!0,h,new Set(b)),h.resolveVariables(u);const v=h.toString(),C=v.slice(g);g=v.length;const y=ri.replace(m,C);y.identifier={major:f,minor:0},y._isTracked=!0,l.push(y)}return d.ensureFinalTabstop(h,i,!0),{edits:l,snippets:[new Fr(e,h,"")]}}constructor(e,t,i=h8,n){this._editor=e,this._template=t,this._options=i,this._languageConfigurationService=n,this._templateMerges=[],this._snippets=[]}dispose(){At(this._snippets)}_logInfo(){return`template="${this._template}", merged_templates="${this._templateMerges.join(" -> ")}"`}insert(){if(!this._editor.hasModel())return;const{edits:e,snippets:t}=typeof this._template=="string"?ga.createEditsAndSnippetsFromSelections(this._editor,this._template,this._options.overwriteBefore,this._options.overwriteAfter,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService):ga.createEditsAndSnippetsFromEdits(this._editor,this._template,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService);this._snippets=t,this._editor.executeEdits("snippet",e,i=>{const n=i.filter(o=>!!o.identifier);for(let o=0;o<t.length;o++)t[o].initialize(n[o].textChange);return this._snippets[0].hasPlaceholder?this._move(!0):n.map(o=>me.fromPositions(o.range.getEndPosition()))}),this._editor.revealRange(this._editor.getSelections()[0])}merge(e,t=h8){if(!this._editor.hasModel())return;this._templateMerges.push([this._snippets[0]._nestingLevel,this._snippets[0]._placeholderGroupsIdx,e]);const{edits:i,snippets:n}=ga.createEditsAndSnippetsFromSelections(this._editor,e,t.overwriteBefore,t.overwriteAfter,!0,t.adjustWhitespace,t.clipboardText,t.overtypingCapturer,this._languageConfigurationService);this._editor.executeEdits("snippet",i,o=>{const r=o.filter(l=>!!l.identifier);for(let l=0;l<n.length;l++)n[l].initialize(r[l].textChange);const a=n[0].isTrivialSnippet;if(!a){for(const l of this._snippets)l.merge(n);console.assert(n.length===0)}return this._snippets[0].hasPlaceholder&&!a?this._move(void 0):r.map(l=>me.fromPositions(l.range.getEndPosition()))})}next(){const e=this._move(!0);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}prev(){const e=this._move(!1);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}_move(e){const t=[];for(const i of this._snippets){const n=i.move(e);t.push(...n)}return t}get isAtFirstPlaceholder(){return this._snippets[0].isAtFirstPlaceholder}get isAtLastPlaceholder(){return this._snippets[0].isAtLastPlaceholder}get hasPlaceholder(){return this._snippets[0].hasPlaceholder}get hasChoice(){return this._snippets[0].hasChoice}get activeChoice(){return this._snippets[0].activeChoice}isSelectionWithinPlaceholders(){if(!this.hasPlaceholder)return!1;const e=this._editor.getSelections();if(e.length<this._snippets.length)return!1;const t=new Map;for(const i of this._snippets){const n=i.computePossibleSelections();if(t.size===0)for(const[o,r]of n){r.sort(k.compareRangesUsingStarts);for(const a of e)if(r[0].containsRange(a)){t.set(o,[]);break}}if(t.size===0)return!1;t.forEach((o,r)=>{o.push(...n.get(r))})}e.sort(k.compareRangesUsingStarts);for(const[i,n]of t){if(n.length!==e.length){t.delete(i);continue}n.sort(k.compareRangesUsingStarts);for(let o=0;o<n.length;o++)if(!n[o].containsRange(e[o])){t.delete(i);continue}}return t.size>0}};US=ga=zke([Uke(3,di)],US);var $ke=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},mw=function(s,e){return function(t,i){e(t,i,s)}},ff;const u8={overwriteBefore:0,overwriteAfter:0,undoStopBefore:!0,undoStopAfter:!0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};let xs=class{static{ff=this}static{this.ID="snippetController2"}static get(e){return e.getContribution(ff.ID)}static{this.InSnippetMode=new le("inSnippetMode",!1,p("inSnippetMode","Whether the editor in current in snippet mode"))}static{this.HasNextTabstop=new le("hasNextTabstop",!1,p("hasNextTabstop","Whether there is a next tab stop when in snippet mode"))}static{this.HasPrevTabstop=new le("hasPrevTabstop",!1,p("hasPrevTabstop","Whether there is a previous tab stop when in snippet mode"))}constructor(e,t,i,n,o){this._editor=e,this._logService=t,this._languageFeaturesService=i,this._languageConfigurationService=o,this._snippetListener=new Z,this._modelVersionId=-1,this._inSnippet=ff.InSnippetMode.bindTo(n),this._hasNextTabstop=ff.HasNextTabstop.bindTo(n),this._hasPrevTabstop=ff.HasPrevTabstop.bindTo(n)}dispose(){this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._session?.dispose(),this._snippetListener.dispose()}insert(e,t){try{this._doInsert(e,typeof t>"u"?u8:{...u8,...t})}catch(i){this.cancel(),this._logService.error(i),this._logService.error("snippet_error"),this._logService.error("insert_template=",e),this._logService.error("existing_template=",this._session?this._session._logInfo():"<no_session>")}}_doInsert(e,t){if(this._editor.hasModel()){if(this._snippetListener.clear(),t.undoStopBefore&&this._editor.getModel().pushStackElement(),this._session&&typeof e!="string"&&this.cancel(),this._session?(gt(typeof e=="string"),this._session.merge(e,t)):(this._modelVersionId=this._editor.getModel().getAlternativeVersionId(),this._session=new US(this._editor,e,t,this._languageConfigurationService),this._session.insert()),t.undoStopAfter&&this._editor.getModel().pushStackElement(),this._session?.hasChoice){const i={_debugDisplayName:"snippetChoiceCompletions",provideCompletionItems:(c,d)=>{if(!this._session||c!==this._editor.getModel()||!P.equals(this._editor.getPosition(),d))return;const{activeChoice:h}=this._session;if(!h||h.choice.options.length===0)return;const u=c.getValueInRange(h.range),g=!!h.choice.options.find(m=>m.value===u),f=[];for(let m=0;m<h.choice.options.length;m++){const _=h.choice.options[m];f.push({kind:13,label:_.value,insertText:_.value,sortText:"a".repeat(m+1),range:h.range,filterText:g?`${u}_${_.value}`:void 0,command:{id:"jumpToNextSnippetPlaceholder",title:p("next","Go to next placeholder...")}})}return{suggestions:f}}},n=this._editor.getModel();let o,r=!1;const a=()=>{o?.dispose(),r=!1},l=()=>{r||(o=this._languageFeaturesService.completionProvider.register({language:n.getLanguageId(),pattern:n.uri.fsPath,scheme:n.uri.scheme,exclusive:!0},i),this._snippetListener.add(o),r=!0)};this._choiceCompletions={provider:i,enable:l,disable:a}}this._updateState(),this._snippetListener.add(this._editor.onDidChangeModelContent(i=>i.isFlush&&this.cancel())),this._snippetListener.add(this._editor.onDidChangeModel(()=>this.cancel())),this._snippetListener.add(this._editor.onDidChangeCursorSelection(()=>this._updateState()))}}_updateState(){if(!(!this._session||!this._editor.hasModel())){if(this._modelVersionId===this._editor.getModel().getAlternativeVersionId())return this.cancel();if(!this._session.hasPlaceholder)return this.cancel();if(this._session.isAtLastPlaceholder||!this._session.isSelectionWithinPlaceholders())return this._editor.getModel().pushStackElement(),this.cancel();this._inSnippet.set(!0),this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder),this._hasNextTabstop.set(!this._session.isAtLastPlaceholder),this._handleChoice()}}_handleChoice(){if(!this._session||!this._editor.hasModel()){this._currentChoice=void 0;return}const{activeChoice:e}=this._session;if(!e||!this._choiceCompletions){this._choiceCompletions?.disable(),this._currentChoice=void 0;return}this._currentChoice!==e.choice&&(this._currentChoice=e.choice,this._choiceCompletions.enable(),queueMicrotask(()=>{Wke(this._editor,this._choiceCompletions.provider)}))}finish(){for(;this._inSnippet.get();)this.next()}cancel(e=!1){this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._snippetListener.clear(),this._currentChoice=void 0,this._session?.dispose(),this._session=void 0,this._modelVersionId=-1,e&&this._editor.setSelections([this._editor.getSelection()])}prev(){this._session?.prev(),this._updateState()}next(){this._session?.next(),this._updateState()}isInSnippet(){return!!this._inSnippet.get()}};xs=ff=$ke([mw(1,Pn),mw(2,pe),mw(3,Ee),mw(4,di)],xs);ct(xs.ID,xs,4);const ik=Zi.bindToContribution(xs.get);ae(new ik({id:"jumpToNextSnippetPlaceholder",precondition:q.and(xs.InSnippetMode,xs.HasNextTabstop),handler:s=>s.next(),kbOpts:{weight:130,kbExpr:I.textInputFocus,primary:2}}));ae(new ik({id:"jumpToPrevSnippetPlaceholder",precondition:q.and(xs.InSnippetMode,xs.HasPrevTabstop),handler:s=>s.prev(),kbOpts:{weight:130,kbExpr:I.textInputFocus,primary:1026}}));ae(new ik({id:"leaveSnippet",precondition:xs.InSnippetMode,handler:s=>s.cancel(!0),kbOpts:{weight:130,kbExpr:I.textInputFocus,primary:9,secondary:[1033]}}));ae(new ik({id:"acceptSnippet",precondition:xs.InSnippetMode,handler:s=>s.finish()}));var jke=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},vI=function(s,e){return function(t,i){e(t,i,s)}};let KM=class extends B{get isAcceptingPartially(){return this._isAcceptingPartially}constructor(e,t,i,n,o,r,a,l,c,d,h,u){super(),this.textModel=e,this.selectedSuggestItem=t,this._textModelVersionId=i,this._positions=n,this._debounceValue=o,this._suggestPreviewEnabled=r,this._suggestPreviewMode=a,this._inlineSuggestMode=l,this._enabled=c,this._instantiationService=d,this._commandService=h,this._languageConfigurationService=u,this._source=this._register(this._instantiationService.createInstance(ZM,this.textModel,this._textModelVersionId,this._debounceValue)),this._isActive=Ze(this,!1),this._forceUpdateExplicitlySignal=km(this),this._selectedInlineCompletionId=Ze(this,void 0),this._primaryPosition=_e(this,f=>this._positions.read(f)[0]??new P(1,1)),this._isAcceptingPartially=!1,this._preserveCurrentCompletionReasons=new Set([ac.Redo,ac.Undo,ac.AcceptWord]),this._fetchInlineCompletionsPromise=Gz({owner:this,createEmptyChangeSummary:()=>({preserveCurrentCompletion:!1,inlineCompletionTriggerKind:Ea.Automatic}),handleChange:(f,m)=>(f.didChange(this._textModelVersionId)&&this._preserveCurrentCompletionReasons.has(this._getReason(f.change))?m.preserveCurrentCompletion=!0:f.didChange(this._forceUpdateExplicitlySignal)&&(m.inlineCompletionTriggerKind=Ea.Explicit),!0)},(f,m)=>{if(this._forceUpdateExplicitlySignal.read(f),!(this._enabled.read(f)&&this.selectedSuggestItem.read(f)||this._isActive.read(f))){this._source.cancelUpdate();return}this._textModelVersionId.read(f);const b=this._source.suggestWidgetInlineCompletions.get(),v=this.selectedSuggestItem.read(f);if(b&&!v){const L=this._source.inlineCompletions.get();ai(D=>{(!L||b.request.versionId>L.request.versionId)&&this._source.inlineCompletions.set(b.clone(),D),this._source.clearSuggestWidgetInlineCompletions(D)})}const C=this._primaryPosition.read(f),y={triggerKind:m.inlineCompletionTriggerKind,selectedSuggestionInfo:v?.toSelectedSuggestionInfo()},w=this.selectedInlineCompletion.get(),x=m.preserveCurrentCompletion||w?.forwardStable?w:void 0;return this._source.fetch(C,y,x)}),this._filteredInlineCompletionItems=Ao({owner:this,equalsFn:v0()},f=>{const m=this._source.inlineCompletions.read(f);if(!m)return[];const _=this._primaryPosition.read(f);return m.inlineCompletions.filter(v=>v.isVisible(this.textModel,_,f))}),this.selectedInlineCompletionIndex=_e(this,f=>{const m=this._selectedInlineCompletionId.read(f),_=this._filteredInlineCompletionItems.read(f),b=this._selectedInlineCompletionId===void 0?-1:_.findIndex(v=>v.semanticId===m);return b===-1?(this._selectedInlineCompletionId.set(void 0,void 0),0):b}),this.selectedInlineCompletion=_e(this,f=>{const m=this._filteredInlineCompletionItems.read(f),_=this.selectedInlineCompletionIndex.read(f);return m[_]}),this.activeCommands=Ao({owner:this,equalsFn:v0()},f=>this.selectedInlineCompletion.read(f)?.inlineCompletion.source.inlineCompletions.commands??[]),this.lastTriggerKind=this._source.inlineCompletions.map(this,f=>f?.request.context.triggerKind),this.inlineCompletionsCount=_e(this,f=>{if(this.lastTriggerKind.read(f)===Ea.Explicit)return this._filteredInlineCompletionItems.read(f).length}),this.state=Ao({owner:this,equalsFn:(f,m)=>!f||!m?f===m:q7(f.ghostTexts,m.ghostTexts)&&f.inlineCompletion===m.inlineCompletion&&f.suggestItem===m.suggestItem},f=>{const m=this.textModel,_=this.selectedSuggestItem.read(f);if(_){const b=Bu(_.toSingleTextEdit(),m),v=this._computeAugmentation(b,f);if(!this._suggestPreviewEnabled.read(f)&&!v)return;const y=v?.edit??b,w=v?v.edit.text.length-b.text.length:0,x=this._suggestPreviewMode.read(f),L=this._positions.read(f),D=[y,...CI(this.textModel,L,y)],T=D.map((W,H)=>J7(W,m,x,L[H],w)).filter(Sl),F=T[0]??new Qv(y.range.endLineNumber,[]);return{edits:D,primaryGhostText:F,ghostTexts:T,inlineCompletion:v?.completion,suggestItem:_}}else{if(!this._isActive.read(f))return;const b=this.selectedInlineCompletion.read(f);if(!b)return;const v=b.toSingleTextEdit(f),C=this._inlineSuggestMode.read(f),y=this._positions.read(f),w=[v,...CI(this.textModel,y,v)],x=w.map((L,D)=>J7(L,m,C,y[D],0)).filter(Sl);return x[0]?{edits:w,primaryGhostText:x[0],ghostTexts:x,inlineCompletion:b,suggestItem:void 0}:void 0}}),this.ghostTexts=Ao({owner:this,equalsFn:q7},f=>{const m=this.state.read(f);if(m)return m.ghostTexts}),this.primaryGhostText=Ao({owner:this,equalsFn:TK},f=>{const m=this.state.read(f);if(m)return m?.primaryGhostText}),this._register(Dm(this._fetchInlineCompletionsPromise));let g;this._register(Pe(f=>{const _=this.state.read(f)?.inlineCompletion;if(_?.semanticId!==g?.semanticId&&(g=_,_)){const b=_.inlineCompletion,v=b.source;v.provider.handleItemDidShow?.(v.inlineCompletions,b.sourceInlineCompletion,b.insertText)}}))}_getReason(e){return e?.isUndoing?ac.Undo:e?.isRedoing?ac.Redo:this.isAcceptingPartially?ac.AcceptWord:ac.Other}async trigger(e){this._isActive.set(!0,e),await this._fetchInlineCompletionsPromise.get()}async triggerExplicitly(e){Qu(e,t=>{this._isActive.set(!0,t),this._forceUpdateExplicitlySignal.trigger(t)}),await this._fetchInlineCompletionsPromise.get()}stop(e){Qu(e,t=>{this._isActive.set(!1,t),this._source.clear(t)})}_computeAugmentation(e,t){const i=this.textModel,n=this._source.suggestWidgetInlineCompletions.read(t),o=n?n.inlineCompletions:[this.selectedInlineCompletion.read(t)].filter(Sl);return Kne(o,a=>{let l=a.toSingleTextEdit(t);return l=Bu(l,i,k.fromPositions(l.range.getStartPosition(),e.range.getEndPosition())),MK(l,e)?{completion:a,edit:l}:void 0})}async _deltaSelectedInlineCompletionIndex(e){await this.triggerExplicitly();const t=this._filteredInlineCompletionItems.get()||[];if(t.length>0){const i=(this.selectedInlineCompletionIndex.get()+e+t.length)%t.length;this._selectedInlineCompletionId.set(t[i].semanticId,void 0)}else this._selectedInlineCompletionId.set(void 0,void 0)}async next(){await this._deltaSelectedInlineCompletionIndex(1)}async previous(){await this._deltaSelectedInlineCompletionIndex(-1)}async accept(e){if(e.getModel()!==this.textModel)throw new mt;const t=this.state.get();if(!t||t.primaryGhostText.isEmpty()||!t.inlineCompletion)return;const i=t.inlineCompletion.toInlineCompletion(void 0);if(i.command&&i.source.addRef(),e.pushUndoStop(),i.snippetInfo)e.executeEdits("inlineSuggestion.accept",[ri.replace(i.range,""),...i.additionalTextEdits]),e.setPosition(i.snippetInfo.range.getStartPosition(),"inlineCompletionAccept"),xs.get(e)?.insert(i.snippetInfo.snippet,{undoStopBefore:!1});else{const n=t.edits,o=g8(n).map(r=>me.fromPositions(r));e.executeEdits("inlineSuggestion.accept",[...n.map(r=>ri.replace(r.range,r.text)),...i.additionalTextEdits]),e.setSelections(o,"inlineCompletionAccept")}this.stop(),i.command&&(await this._commandService.executeCommand(i.command.id,...i.command.arguments||[]).then(void 0,Li),i.source.removeRef())}async acceptNextWord(e){await this._acceptNext(e,(t,i)=>{const n=this.textModel.getLanguageIdAtPosition(t.lineNumber,t.column),o=this._languageConfigurationService.getLanguageConfiguration(n),r=new RegExp(o.wordDefinition.source,o.wordDefinition.flags.replace("g","")),a=i.match(r);let l=0;a&&a.index!==void 0?a.index===0?l=a[0].length:l=a.index:l=i.length;const d=/\s+/g.exec(i);return d&&d.index!==void 0&&d.index+d[0].length<l&&(l=d.index+d[0].length),l},0)}async acceptNextLine(e){await this._acceptNext(e,(t,i)=>{const n=i.match(/\n/);return n&&n.index!==void 0?n.index+1:i.length},1)}async _acceptNext(e,t,i){if(e.getModel()!==this.textModel)throw new mt;const n=this.state.get();if(!n||n.primaryGhostText.isEmpty()||!n.inlineCompletion)return;const o=n.primaryGhostText,r=n.inlineCompletion.toInlineCompletion(void 0);if(r.snippetInfo||r.filterText!==r.insertText){await this.accept(e);return}const a=o.parts[0],l=new P(o.lineNumber,a.column),c=a.text,d=t(l,c);if(d===c.length&&o.parts.length===1){this.accept(e);return}const h=c.substring(0,d),u=this._positions.get(),g=u[0];r.source.addRef();try{this._isAcceptingPartially=!0;try{e.pushUndoStop();const f=k.fromPositions(g,l),m=e.getModel().getValueInRange(f)+h,_=new Il(f,m),b=[_,...CI(this.textModel,u,_)],v=g8(b).map(C=>me.fromPositions(C));e.executeEdits("inlineSuggestion.accept",b.map(C=>ri.replace(C.range,C.text))),e.setSelections(v,"inlineCompletionPartialAccept"),e.revealPositionInCenterIfOutsideViewport(e.getPosition(),1)}finally{this._isAcceptingPartially=!1}if(r.source.provider.handlePartialAccept){const f=k.fromPositions(r.range.getStartPosition(),Hs.ofText(h).addToPosition(l)),m=e.getModel().getValueInRange(f,1);r.source.provider.handlePartialAccept(r.source.inlineCompletions,r.sourceInlineCompletion,m.length,{kind:i})}}finally{r.source.removeRef()}}handleSuggestAccepted(e){const t=Bu(e.toSingleTextEdit(),this.textModel),i=this._computeAugmentation(t,void 0);if(!i)return;const n=i.completion.inlineCompletion;n.source.provider.handlePartialAccept?.(n.source.inlineCompletions,n.sourceInlineCompletion,t.text.length,{kind:2})}};KM=jke([vI(9,ye),vI(10,Ht),vI(11,di)],KM);var ac;(function(s){s[s.Undo=0]="Undo",s[s.Redo=1]="Redo",s[s.AcceptWord=2]="AcceptWord",s[s.Other=3]="Other"})(ac||(ac={}));function CI(s,e,t){if(e.length===1)return[];const i=e[0],n=e.slice(1),o=t.range.getStartPosition(),r=t.range.getEndPosition(),a=s.getValueInRange(k.fromPositions(i,r)),l=G7(i,o);if(l.lineNumber<1)return Oe(new mt(`positionWithinTextEdit line number should be bigger than 0.
			Invalid subtraction between ${i.toString()} and ${o.toString()}`)),[];const c=Zke(t.text,l);return n.map(d=>{const h=_ke(G7(d,o),r),u=s.getValueInRange(k.fromPositions(d,h)),g=th(a,u),f=k.fromPositions(d,d.delta(0,g));return new Il(f,c)})}function Zke(s,e){let t="";const i=Cee(s);for(let n=e.lineNumber-1;n<i.length;n++)t+=i[n].substring(n===e.lineNumber-1?e.column-1:0);return t}function g8(s){const e=w1.createSortPermutation(s,bs(o=>o.range,k.compareRangesUsingStarts)),i=new f2(e.apply(s)).getNewRanges();return e.inverse().apply(i).map(o=>o.getEndPosition())}var Kke=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},f8=function(s,e){return function(t,i){e(t,i,s)}},P_;class m4{constructor(e){this.name=e}select(e,t,i){if(i.length===0)return 0;const n=i[0].score[0];for(let o=0;o<i.length;o++){const{score:r,completion:a}=i[o];if(r[0]!==n)break;if(a.preselect)return o}return 0}}class p8 extends m4{constructor(){super("first")}memorize(e,t,i){}toJSON(){}fromJSON(){}}class qke extends m4{constructor(){super("recentlyUsed"),this._cache=new Wl(300,.66),this._seq=0}memorize(e,t,i){const n=`${e.getLanguageId()}/${i.textLabel}`;this._cache.set(n,{touch:this._seq++,type:i.completion.kind,insertText:i.completion.insertText})}select(e,t,i){if(i.length===0)return 0;const n=e.getLineContent(t.lineNumber).substr(t.column-10,t.column-1);if(/\s$/.test(n))return super.select(e,t,i);const o=i[0].score[0];let r=-1,a=-1,l=-1;for(let c=0;c<i.length&&i[c].score[0]===o;c++){const d=`${e.getLanguageId()}/${i[c].textLabel}`,h=this._cache.peek(d);if(h&&h.touch>l&&h.type===i[c].completion.kind&&h.insertText===i[c].completion.insertText&&(l=h.touch,a=c),i[c].completion.preselect&&r===-1)return r=c}return a!==-1?a:r!==-1?r:0}toJSON(){return this._cache.toJSON()}fromJSON(e){this._cache.clear();const t=0;for(const[i,n]of e)n.touch=t,n.type=typeof n.type=="number"?n.type:Ub.fromString(n.type),this._cache.set(i,n);this._seq=this._cache.size}}class Gke extends m4{constructor(){super("recentlyUsedByPrefix"),this._trie=Qf.forStrings(),this._seq=0}memorize(e,t,i){const{word:n}=e.getWordUntilPosition(t),o=`${e.getLanguageId()}/${n}`;this._trie.set(o,{type:i.completion.kind,insertText:i.completion.insertText,touch:this._seq++})}select(e,t,i){const{word:n}=e.getWordUntilPosition(t);if(!n)return super.select(e,t,i);const o=`${e.getLanguageId()}/${n}`;let r=this._trie.get(o);if(r||(r=this._trie.findSubstr(o)),r)for(let a=0;a<i.length;a++){const{kind:l,insertText:c}=i[a].completion;if(l===r.type&&c===r.insertText)return a}return super.select(e,t,i)}toJSON(){const e=[];return this._trie.forEach((t,i)=>e.push([i,t])),e.sort((t,i)=>-(t[1].touch-i[1].touch)).forEach((t,i)=>t[1].touch=i),e.slice(0,200)}fromJSON(e){if(this._trie.clear(),e.length>0){this._seq=e[0][1].touch+1;for(const[t,i]of e)i.type=typeof i.type=="number"?i.type:Ub.fromString(i.type),this._trie.set(t,i)}}}let qM=class{static{P_=this}static{this._strategyCtors=new Map([["recentlyUsedByPrefix",Gke],["recentlyUsed",qke],["first",p8]])}static{this._storagePrefix="suggest/memories"}constructor(e,t){this._storageService=e,this._configService=t,this._disposables=new Z,this._persistSoon=new It(()=>this._saveState(),500),this._disposables.add(e.onWillSaveState(i=>{i.reason===mv.SHUTDOWN&&this._saveState()}))}dispose(){this._disposables.dispose(),this._persistSoon.dispose()}memorize(e,t,i){this._withStrategy(e,t).memorize(e,t,i),this._persistSoon.schedule()}select(e,t,i){return this._withStrategy(e,t).select(e,t,i)}_withStrategy(e,t){const i=this._configService.getValue("editor.suggestSelection",{overrideIdentifier:e.getLanguageIdAtPosition(t.lineNumber,t.column),resource:e.uri});if(this._strategy?.name!==i){this._saveState();const n=P_._strategyCtors.get(i)||p8;this._strategy=new n;try{const r=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,a=this._storageService.get(`${P_._storagePrefix}/${i}`,r);a&&this._strategy.fromJSON(JSON.parse(a))}catch{}}return this._strategy}_saveState(){if(this._strategy){const t=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,i=JSON.stringify(this._strategy);this._storageService.store(`${P_._storagePrefix}/${this._strategy.name}`,i,t,1)}}};qM=P_=Kke([f8(0,oa),f8(1,Ke)],qM);const nk=Je("ISuggestMemories");nt(nk,qM,1);var Yke=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Xke=function(s,e){return function(t,i){e(t,i,s)}},GM;let $S=class{static{GM=this}static{this.AtEnd=new le("atEndOfWord",!1)}constructor(e,t){this._editor=e,this._enabled=!1,this._ckAtEnd=GM.AtEnd.bindTo(t),this._configListener=this._editor.onDidChangeConfiguration(i=>i.hasChanged(124)&&this._update()),this._update()}dispose(){this._configListener.dispose(),this._selectionListener?.dispose(),this._ckAtEnd.reset()}_update(){const e=this._editor.getOption(124)==="on";if(this._enabled!==e)if(this._enabled=e,this._enabled){const t=()=>{if(!this._editor.hasModel()){this._ckAtEnd.set(!1);return}const i=this._editor.getModel(),n=this._editor.getSelection(),o=i.getWordAtPosition(n.getStartPosition());if(!o){this._ckAtEnd.set(!1);return}this._ckAtEnd.set(o.endColumn===n.getStartPosition().column)};this._selectionListener=this._editor.onDidChangeCursorSelection(t),t()}else this._selectionListener&&(this._ckAtEnd.reset(),this._selectionListener.dispose(),this._selectionListener=void 0)}};$S=GM=Yke([Xke(1,Ee)],$S);var Qke=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Jke=function(s,e){return function(t,i){e(t,i,s)}},O_;let nm=class{static{O_=this}static{this.OtherSuggestions=new le("hasOtherSuggestions",!1)}constructor(e,t){this._editor=e,this._index=0,this._ckOtherSuggestions=O_.OtherSuggestions.bindTo(t)}dispose(){this.reset()}reset(){this._ckOtherSuggestions.reset(),this._listener?.dispose(),this._model=void 0,this._acceptNext=void 0,this._ignore=!1}set({model:e,index:t},i){if(e.items.length===0){this.reset();return}if(O_._moveIndex(!0,e,t)===t){this.reset();return}this._acceptNext=i,this._model=e,this._index=t,this._listener=this._editor.onDidChangeCursorPosition(()=>{this._ignore||this.reset()}),this._ckOtherSuggestions.set(!0)}static _moveIndex(e,t,i){let n=i;for(let o=t.items.length;o>0&&(n=(n+t.items.length+(e?1:-1))%t.items.length,!(n===i||!t.items[n].completion.additionalTextEdits));o--);return n}next(){this._move(!0)}prev(){this._move(!1)}_move(e){if(this._model)try{this._ignore=!0,this._index=O_._moveIndex(e,this._model,this._index),this._acceptNext({index:this._index,item:this._model.items[this._index],model:this._model})}finally{this._ignore=!1}}};nm=O_=Qke([Jke(1,Ee)],nm);class eDe{constructor(e,t,i,n){this._disposables=new Z,this._disposables.add(i.onDidSuggest(o=>{o.completionModel.items.length===0&&this.reset()})),this._disposables.add(i.onDidCancel(o=>{this.reset()})),this._disposables.add(t.onDidShow(()=>this._onItem(t.getFocusedItem()))),this._disposables.add(t.onDidFocus(this._onItem,this)),this._disposables.add(t.onDidHide(this.reset,this)),this._disposables.add(e.onWillType(o=>{if(this._active&&!t.isFrozen()&&i.state!==0){const r=o.charCodeAt(o.length-1);this._active.acceptCharacters.has(r)&&e.getOption(0)&&n(this._active.item)}}))}_onItem(e){if(!e||!os(e.item.completion.commitCharacters)){this.reset();return}if(this._active&&this._active.item.item===e.item)return;const t=new Y1;for(const i of e.item.completion.commitCharacters)i.length>0&&t.add(i.charCodeAt(0));this._active={acceptCharacters:t,item:e}}reset(){this._active=void 0}dispose(){this._disposables.dispose()}}class Br{async provideSelectionRanges(e,t){const i=[];for(const n of t){const o=[];i.push(o);const r=new Map;await new Promise(a=>Br._bracketsRightYield(a,0,e,n,r)),await new Promise(a=>Br._bracketsLeftYield(a,0,e,n,r,o))}return i}static{this._maxDuration=30}static{this._maxRounds=2}static _bracketsRightYield(e,t,i,n,o){const r=new Map,a=Date.now();for(;;){if(t>=Br._maxRounds){e();break}if(!n){e();break}const l=i.bracketPairs.findNextBracket(n);if(!l){e();break}if(Date.now()-a>Br._maxDuration){setTimeout(()=>Br._bracketsRightYield(e,t+1,i,n,o));break}if(l.bracketInfo.isOpeningBracket){const d=l.bracketInfo.bracketText,h=r.has(d)?r.get(d):0;r.set(d,h+1)}else{const d=l.bracketInfo.getOpeningBrackets()[0].bracketText;let h=r.has(d)?r.get(d):0;if(h-=1,r.set(d,Math.max(0,h)),h<0){let u=o.get(d);u||(u=new fs,o.set(d,u)),u.push(l.range)}}n=l.range.getEndPosition()}}static _bracketsLeftYield(e,t,i,n,o,r){const a=new Map,l=Date.now();for(;;){if(t>=Br._maxRounds&&o.size===0){e();break}if(!n){e();break}const c=i.bracketPairs.findPrevBracket(n);if(!c){e();break}if(Date.now()-l>Br._maxDuration){setTimeout(()=>Br._bracketsLeftYield(e,t+1,i,n,o,r));break}if(c.bracketInfo.isOpeningBracket){const h=c.bracketInfo.bracketText;let u=a.has(h)?a.get(h):0;if(u-=1,a.set(h,Math.max(0,u)),u<0){const g=o.get(h);if(g){const f=g.shift();g.size===0&&o.delete(h);const m=k.fromPositions(c.range.getEndPosition(),f.getStartPosition()),_=k.fromPositions(c.range.getStartPosition(),f.getEndPosition());r.push({range:m}),r.push({range:_}),Br._addBracketLeading(i,_,r)}}}else{const h=c.bracketInfo.getOpeningBrackets()[0].bracketText,u=a.has(h)?a.get(h):0;a.set(h,u+1)}n=c.range.getStartPosition()}}static _addBracketLeading(e,t,i){if(t.startLineNumber===t.endLineNumber)return;const n=t.startLineNumber,o=e.getLineFirstNonWhitespaceColumn(n);o!==0&&o!==t.startColumn&&(i.push({range:k.fromPositions(new P(n,o),t.getEndPosition())}),i.push({range:k.fromPositions(new P(n,1),t.getEndPosition())}));const r=n-1;if(r>0){const a=e.getLineFirstNonWhitespaceColumn(r);a===t.startColumn&&a!==e.getLineLastNonWhitespaceColumn(r)&&(i.push({range:k.fromPositions(new P(r,a),t.getEndPosition())}),i.push({range:k.fromPositions(new P(r,1),t.getEndPosition())}))}}}class ul{static{this.None=new class extends ul{distance(){return 0}}}static async create(e,t){if(!t.getOption(119).localityBonus||!t.hasModel())return ul.None;const i=t.getModel(),n=t.getPosition();if(!e.canComputeWordRanges(i.uri))return ul.None;const[o]=await new Br().provideSelectionRanges(i,[n]);if(o.length===0)return ul.None;const r=await e.computeWordRanges(i.uri,o[0].range);if(!r)return ul.None;const a=i.getWordUntilPosition(n);return delete r[a.word],new class extends ul{distance(l,c){if(!n.equals(t.getPosition()))return 0;if(c.kind===17)return 2<<20;const d=typeof c.label=="string"?c.label:c.label.label,h=r[d];if(jH(h))return 2<<20;const u=Bb(h,k.fromPositions(l),k.compareRangesUsingStarts),g=u>=0?h[u]:h[Math.max(0,~u-1)];let f=o.length;for(const m of o){if(!k.containsRange(m.range,g))break;f-=1}return f}}}}let m8=class{constructor(e,t){this.leadingLineContent=e,this.characterCountDelta=t}};class kd{constructor(e,t,i,n,o,r,a=W2.default,l=void 0){this.clipboardText=l,this._snippetCompareFn=kd._compareCompletionItems,this._items=e,this._column=t,this._wordDistance=n,this._options=o,this._refilterKind=1,this._lineContext=i,this._fuzzyScoreOptions=a,r==="top"?this._snippetCompareFn=kd._compareCompletionItemsSnippetsUp:r==="bottom"&&(this._snippetCompareFn=kd._compareCompletionItemsSnippetsDown)}get lineContext(){return this._lineContext}set lineContext(e){(this._lineContext.leadingLineContent!==e.leadingLineContent||this._lineContext.characterCountDelta!==e.characterCountDelta)&&(this._refilterKind=this._lineContext.characterCountDelta<e.characterCountDelta&&this._filteredItems?2:1,this._lineContext=e)}get items(){return this._ensureCachedState(),this._filteredItems}getItemsByProvider(){return this._ensureCachedState(),this._itemsByProvider}getIncompleteProvider(){this._ensureCachedState();const e=new Set;for(const[t,i]of this.getItemsByProvider())i.length>0&&i[0].container.incomplete&&e.add(t);return e}get stats(){return this._ensureCachedState(),this._stats}_ensureCachedState(){this._refilterKind!==0&&this._createCachedState()}_createCachedState(){this._itemsByProvider=new Map;const e=[],{leadingLineContent:t,characterCountDelta:i}=this._lineContext;let n="",o="";const r=this._refilterKind===1?this._items:this._filteredItems,a=[],l=!this._options.filterGraceful||r.length>2e3?Yu:Wae;for(let c=0;c<r.length;c++){const d=r[c];if(d.isInvalid)continue;const h=this._itemsByProvider.get(d.provider);h?h.push(d):this._itemsByProvider.set(d.provider,[d]);const u=d.position.column-d.editStart.column,g=u+i-(d.position.column-this._column);if(n.length!==g&&(n=g===0?"":t.slice(-g),o=n.toLowerCase()),d.word=n,g===0)d.score=Aa.Default;else{let f=0;for(;f<u;){const m=n.charCodeAt(f);if(m===32||m===9)f+=1;else break}if(f>=g)d.score=Aa.Default;else if(typeof d.completion.filterText=="string"){const m=l(n,o,f,d.completion.filterText,d.filterTextLow,0,this._fuzzyScoreOptions);if(!m)continue;JT(d.completion.filterText,d.textLabel)===0?d.score=m:(d.score=Pae(n,o,f,d.textLabel,d.labelLow,0),d.score[0]=m[0])}else{const m=l(n,o,f,d.textLabel,d.labelLow,0,this._fuzzyScoreOptions);if(!m)continue;d.score=m}}d.idx=c,d.distance=this._wordDistance.distance(d.position,d.completion),a.push(d),e.push(d.textLabel.length)}this._filteredItems=a.sort(this._snippetCompareFn),this._refilterKind=0,this._stats={pLabelLen:e.length?KI(e.length-.85,e,(c,d)=>c-d):0}}static _compareCompletionItems(e,t){return e.score[0]>t.score[0]?-1:e.score[0]<t.score[0]?1:e.distance<t.distance?-1:e.distance>t.distance?1:e.idx<t.idx?-1:e.idx>t.idx?1:0}static _compareCompletionItemsSnippetsDown(e,t){if(e.completion.kind!==t.completion.kind){if(e.completion.kind===27)return 1;if(t.completion.kind===27)return-1}return kd._compareCompletionItems(e,t)}static _compareCompletionItemsSnippetsUp(e,t){if(e.completion.kind!==t.completion.kind){if(e.completion.kind===27)return-1;if(t.completion.kind===27)return 1}return kd._compareCompletionItems(e,t)}}var tDe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},cd=function(s,e){return function(t,i){e(t,i,s)}},YM;class Uh{static shouldAutoTrigger(e){if(!e.hasModel())return!1;const t=e.getModel(),i=e.getPosition();t.tokenization.tokenizeIfCheap(i.lineNumber);const n=t.getWordAtPosition(i);return!(!n||n.endColumn!==i.column&&n.startColumn+1!==i.column||!isNaN(Number(n.word)))}constructor(e,t,i){this.leadingLineContent=e.getLineContent(t.lineNumber).substr(0,t.column-1),this.leadingWord=e.getWordUntilPosition(t),this.lineNumber=t.lineNumber,this.column=t.column,this.triggerOptions=i}}function iDe(s,e,t){if(!e.getContextKeyValue(ss.inlineSuggestionVisible.key))return!0;const i=e.getContextKeyValue(ss.suppressSuggestions.key);return i!==void 0?!i:!s.getOption(62).suppressSuggestions}function nDe(s,e,t){if(!e.getContextKeyValue("inlineSuggestionVisible"))return!0;const i=e.getContextKeyValue(ss.suppressSuggestions.key);return i!==void 0?!i:!s.getOption(62).suppressSuggestions}let jS=YM=class{constructor(e,t,i,n,o,r,a,l,c){this._editor=e,this._editorWorkerService=t,this._clipboardService=i,this._telemetryService=n,this._logService=o,this._contextKeyService=r,this._configurationService=a,this._languageFeaturesService=l,this._envService=c,this._toDispose=new Z,this._triggerCharacterListener=new Z,this._triggerQuickSuggest=new ia,this._triggerState=void 0,this._completionDisposables=new Z,this._onDidCancel=new O,this._onDidTrigger=new O,this._onDidSuggest=new O,this.onDidCancel=this._onDidCancel.event,this.onDidTrigger=this._onDidTrigger.event,this.onDidSuggest=this._onDidSuggest.event,this._telemetryGate=0,this._currentSelection=this._editor.getSelection()||new me(1,1,1,1),this._toDispose.add(this._editor.onDidChangeModel(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeModelLanguage(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeConfiguration(()=>{this._updateTriggerCharacters()})),this._toDispose.add(this._languageFeaturesService.completionProvider.onDidChange(()=>{this._updateTriggerCharacters(),this._updateActiveSuggestSession()}));let d=!1;this._toDispose.add(this._editor.onDidCompositionStart(()=>{d=!0})),this._toDispose.add(this._editor.onDidCompositionEnd(()=>{d=!1,this._onCompositionEnd()})),this._toDispose.add(this._editor.onDidChangeCursorSelection(h=>{d||this._onCursorChange(h)})),this._toDispose.add(this._editor.onDidChangeModelContent(()=>{!d&&this._triggerState!==void 0&&this._refilterCompletionItems()})),this._updateTriggerCharacters()}dispose(){At(this._triggerCharacterListener),At([this._onDidCancel,this._onDidSuggest,this._onDidTrigger,this._triggerQuickSuggest]),this._toDispose.dispose(),this._completionDisposables.dispose(),this.cancel()}_updateTriggerCharacters(){if(this._triggerCharacterListener.clear(),this._editor.getOption(92)||!this._editor.hasModel()||!this._editor.getOption(122))return;const e=new Map;for(const i of this._languageFeaturesService.completionProvider.all(this._editor.getModel()))for(const n of i.triggerCharacters||[]){let o=e.get(n);o||(o=new Set,e.set(n,o)),o.add(i)}const t=i=>{if(!nDe(this._editor,this._contextKeyService,this._configurationService)||Uh.shouldAutoTrigger(this._editor))return;if(!i){const r=this._editor.getPosition();i=this._editor.getModel().getLineContent(r.lineNumber).substr(0,r.column-1)}let n="";Uu(i.charCodeAt(i.length-1))?Qi(i.charCodeAt(i.length-2))&&(n=i.substr(i.length-2)):n=i.charAt(i.length-1);const o=e.get(n);if(o){const r=new Map;if(this._completionModel)for(const[a,l]of this._completionModel.getItemsByProvider())o.has(a)||r.set(a,l);this.trigger({auto:!0,triggerKind:1,triggerCharacter:n,retrigger:!!this._completionModel,clipboardText:this._completionModel?.clipboardText,completionOptions:{providerFilter:o,providerItemsToReuse:r}})}};this._triggerCharacterListener.add(this._editor.onDidType(t)),this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(()=>t()))}get state(){return this._triggerState?this._triggerState.auto?2:1:0}cancel(e=!1){this._triggerState!==void 0&&(this._triggerQuickSuggest.cancel(),this._requestToken?.cancel(),this._requestToken=void 0,this._triggerState=void 0,this._completionModel=void 0,this._context=void 0,this._onDidCancel.fire({retrigger:e}))}clear(){this._completionDisposables.clear()}_updateActiveSuggestSession(){this._triggerState!==void 0&&(!this._editor.hasModel()||!this._languageFeaturesService.completionProvider.has(this._editor.getModel())?this.cancel():this.trigger({auto:this._triggerState.auto,retrigger:!0}))}_onCursorChange(e){if(!this._editor.hasModel())return;const t=this._currentSelection;if(this._currentSelection=this._editor.getSelection(),!e.selection.isEmpty()||e.reason!==0&&e.reason!==3||e.source!=="keyboard"&&e.source!=="deleteLeft"){this.cancel();return}this._triggerState===void 0&&e.reason===0?(t.containsRange(this._currentSelection)||t.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition()))&&this._doTriggerQuickSuggest():this._triggerState!==void 0&&e.reason===3&&this._refilterCompletionItems()}_onCompositionEnd(){this._triggerState===void 0?this._doTriggerQuickSuggest():this._refilterCompletionItems()}_doTriggerQuickSuggest(){Vf.isAllOff(this._editor.getOption(90))||this._editor.getOption(119).snippetsPreventQuickSuggestions&&xs.get(this._editor)?.isInSnippet()||(this.cancel(),this._triggerQuickSuggest.cancelAndSet(()=>{if(this._triggerState!==void 0||!Uh.shouldAutoTrigger(this._editor)||!this._editor.hasModel()||!this._editor.hasWidgetFocus())return;const e=this._editor.getModel(),t=this._editor.getPosition(),i=this._editor.getOption(90);if(!Vf.isAllOff(i)){if(!Vf.isAllOn(i)){e.tokenization.tokenizeIfCheap(t.lineNumber);const n=e.tokenization.getLineTokens(t.lineNumber),o=n.getStandardTokenType(n.findTokenIndexAtOffset(Math.max(t.column-1-1,0)));if(Vf.valueFor(i,o)!=="on")return}iDe(this._editor,this._contextKeyService,this._configurationService)&&this._languageFeaturesService.completionProvider.has(e)&&this.trigger({auto:!0})}},this._editor.getOption(91)))}_refilterCompletionItems(){gt(this._editor.hasModel()),gt(this._triggerState!==void 0);const e=this._editor.getModel(),t=this._editor.getPosition(),i=new Uh(e,t,{...this._triggerState,refilter:!0});this._onNewContext(i)}trigger(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=new Uh(t,this._editor.getPosition(),e);this.cancel(e.retrigger),this._triggerState=e,this._onDidTrigger.fire({auto:e.auto,shy:e.shy??!1,position:this._editor.getPosition()}),this._context=i;let n={triggerKind:e.triggerKind??0};e.triggerCharacter&&(n={triggerKind:1,triggerCharacter:e.triggerCharacter}),this._requestToken=new li;const o=this._editor.getOption(113);let r=1;switch(o){case"top":r=0;break;case"bottom":r=2;break}const{itemKind:a,showDeprecated:l}=YM.createSuggestFilter(this._editor),c=new ny(r,e.completionOptions?.kindFilter??a,e.completionOptions?.providerFilter,e.completionOptions?.providerItemsToReuse,l),d=ul.create(this._editorWorkerService,this._editor),h=f4(this._languageFeaturesService.completionProvider,t,this._editor.getPosition(),c,n,this._requestToken.token);Promise.all([h,d]).then(async([u,g])=>{if(this._requestToken?.dispose(),!this._editor.hasModel())return;let f=e?.clipboardText;if(!f&&u.needsClipboard&&(f=await this._clipboardService.readText()),this._triggerState===void 0)return;const m=this._editor.getModel(),_=new Uh(m,this._editor.getPosition(),e),b={...W2.default,firstMatchCanBeWeak:!this._editor.getOption(119).matchOnWordStartOnly};if(this._completionModel=new kd(u.items,this._context.column,{leadingLineContent:_.leadingLineContent,characterCountDelta:_.column-this._context.column},g,this._editor.getOption(119),this._editor.getOption(113),b,f),this._completionDisposables.add(u.disposable),this._onNewContext(_),this._reportDurationsTelemetry(u.durations),!this._envService.isBuilt||this._envService.isExtensionDevelopment)for(const v of u.items)v.isInvalid&&this._logService.warn(`[suggest] did IGNORE invalid completion item from ${v.provider._debugDisplayName}`,v.completion)}).catch(Oe)}_reportDurationsTelemetry(e){this._telemetryGate++%230===0&&setTimeout(()=>{this._telemetryService.publicLog2("suggest.durations.json",{data:JSON.stringify(e)}),this._logService.debug("suggest.durations.json",e)})}static createSuggestFilter(e){const t=new Set;e.getOption(113)==="none"&&t.add(27);const n=e.getOption(119);return n.showMethods||t.add(0),n.showFunctions||t.add(1),n.showConstructors||t.add(2),n.showFields||t.add(3),n.showVariables||t.add(4),n.showClasses||t.add(5),n.showStructs||t.add(6),n.showInterfaces||t.add(7),n.showModules||t.add(8),n.showProperties||t.add(9),n.showEvents||t.add(10),n.showOperators||t.add(11),n.showUnits||t.add(12),n.showValues||t.add(13),n.showConstants||t.add(14),n.showEnums||t.add(15),n.showEnumMembers||t.add(16),n.showKeywords||t.add(17),n.showWords||t.add(18),n.showColors||t.add(19),n.showFiles||t.add(20),n.showReferences||t.add(21),n.showColors||t.add(22),n.showFolders||t.add(23),n.showTypeParameters||t.add(24),n.showSnippets||t.add(27),n.showUsers||t.add(25),n.showIssues||t.add(26),{itemKind:t,showDeprecated:n.showDeprecated}}_onNewContext(e){if(this._context){if(e.lineNumber!==this._context.lineNumber){this.cancel();return}if(Mt(e.leadingLineContent)!==Mt(this._context.leadingLineContent)){this.cancel();return}if(e.column<this._context.column){e.leadingWord.word?this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0}):this.cancel();return}if(this._completionModel){if(e.leadingWord.word.length!==0&&e.leadingWord.startColumn>this._context.leadingWord.startColumn){if(Uh.shouldAutoTrigger(this._editor)&&this._context){const i=this._completionModel.getItemsByProvider();this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerItemsToReuse:i}})}return}if(e.column>this._context.column&&this._completionModel.getIncompleteProvider().size>0&&e.leadingWord.word.length!==0){const t=new Map,i=new Set;for(const[n,o]of this._completionModel.getItemsByProvider())o.length>0&&o[0].container.incomplete?i.add(n):t.set(n,o);this.trigger({auto:this._context.triggerOptions.auto,triggerKind:2,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerFilter:i,providerItemsToReuse:t}})}else{const t=this._completionModel.lineContext;let i=!1;if(this._completionModel.lineContext={leadingLineContent:e.leadingLineContent,characterCountDelta:e.column-this._context.column},this._completionModel.items.length===0){const n=Uh.shouldAutoTrigger(this._editor);if(!this._context){this.cancel();return}if(n&&this._context.leadingWord.endColumn<e.leadingWord.startColumn){this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0});return}if(this._context.triggerOptions.auto){this.cancel();return}else if(this._completionModel.lineContext=t,i=this._completionModel.items.length>0,i&&e.leadingWord.word.length===0){this.cancel();return}}this._onDidSuggest.fire({completionModel:this._completionModel,triggerOptions:e.triggerOptions,isFrozen:i})}}}}};jS=YM=tDe([cd(1,Xs),cd(2,Jc),cd(3,jn),cd(4,Pn),cd(5,Ee),cd(6,Ke),cd(7,pe),cd(8,b2)],jS);class _4{static{this._maxSelectionLength=51200}constructor(e,t){this._disposables=new Z,this._lastOvertyped=[],this._locked=!1,this._disposables.add(e.onWillType(()=>{if(this._locked||!e.hasModel())return;const i=e.getSelections(),n=i.length;let o=!1;for(let a=0;a<n;a++)if(!i[a].isEmpty()){o=!0;break}if(!o){this._lastOvertyped.length!==0&&(this._lastOvertyped.length=0);return}this._lastOvertyped=[];const r=e.getModel();for(let a=0;a<n;a++){const l=i[a];if(r.getValueLengthInRange(l)>_4._maxSelectionLength)return;this._lastOvertyped[a]={value:r.getValueInRange(l),multiline:l.startLineNumber!==l.endLineNumber}}})),this._disposables.add(t.onDidTrigger(i=>{this._locked=!0})),this._disposables.add(t.onDidCancel(i=>{this._locked=!1}))}getLastOvertypedInfo(e){if(e>=0&&e<this._lastOvertyped.length)return this._lastOvertyped[e]}dispose(){this._disposables.dispose()}}var sDe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},yI=function(s,e){return function(t,i){e(t,i,s)}};let XM=class{constructor(e,t,i,n,o){this._menuId=t,this._menuService=n,this._contextKeyService=o,this._menuDisposables=new Z,this.element=X(e,te(".suggest-status-bar"));const r=a=>a instanceof uo?i.createInstance(Q2,a,{useComma:!0}):void 0;this._leftActions=new zo(this.element,{actionViewItemProvider:r}),this._rightActions=new zo(this.element,{actionViewItemProvider:r}),this._leftActions.domNode.classList.add("left"),this._rightActions.domNode.classList.add("right")}dispose(){this._menuDisposables.dispose(),this._leftActions.dispose(),this._rightActions.dispose(),this.element.remove()}show(){const e=this._menuService.createMenu(this._menuId,this._contextKeyService),t=()=>{const i=[],n=[];for(const[o,r]of e.getActions())o==="left"?i.push(...r):n.push(...r);this._leftActions.clear(),this._leftActions.push(i),this._rightActions.clear(),this._rightActions.push(n)};this._menuDisposables.add(e.onDidChange(()=>t())),this._menuDisposables.add(e)}hide(){this._menuDisposables.clear()}};XM=sDe([yI(2,ye),yI(3,qo),yI(4,Ee)],XM);var oDe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},rDe=function(s,e){return function(t,i){e(t,i,s)}};function b4(s){return!!s&&!!(s.completion.documentation||s.completion.detail&&s.completion.detail!==s.completion.label)}let QM=class{constructor(e,t){this._editor=e,this._onDidClose=new O,this.onDidClose=this._onDidClose.event,this._onDidChangeContents=new O,this.onDidChangeContents=this._onDidChangeContents.event,this._disposables=new Z,this._renderDisposeable=new Z,this._borderWidth=1,this._size=new bt(330,0),this.domNode=te(".suggest-details"),this.domNode.classList.add("no-docs"),this._markdownRenderer=t.createInstance(zc,{editor:e}),this._body=te(".body"),this._scrollbar=new DC(this._body,{alwaysConsumeMouseWheel:!0}),X(this.domNode,this._scrollbar.getDomNode()),this._disposables.add(this._scrollbar),this._header=X(this._body,te(".header")),this._close=X(this._header,te("span"+Ie.asCSSSelector(J.close))),this._close.title=p("details.close","Close"),this._type=X(this._header,te("p.type")),this._docs=X(this._body,te("p.docs")),this._configureFont(),this._disposables.add(this._editor.onDidChangeConfiguration(i=>{i.hasChanged(50)&&this._configureFont()}))}dispose(){this._disposables.dispose(),this._renderDisposeable.dispose()}_configureFont(){const e=this._editor.getOptions(),t=e.get(50),i=t.getMassagedFontFamily(),n=e.get(120)||t.fontSize,o=e.get(121)||t.lineHeight,r=t.fontWeight,a=`${n}px`,l=`${o}px`;this.domNode.style.fontSize=a,this.domNode.style.lineHeight=`${o/n}`,this.domNode.style.fontWeight=r,this.domNode.style.fontFeatureSettings=t.fontFeatureSettings,this._type.style.fontFamily=i,this._close.style.height=l,this._close.style.width=l}getLayoutInfo(){const e=this._editor.getOption(121)||this._editor.getOption(50).lineHeight,t=this._borderWidth,i=t*2;return{lineHeight:e,borderWidth:t,borderHeight:i,verticalPadding:22,horizontalPadding:14}}renderLoading(){this._type.textContent=p("loading","Loading..."),this._docs.textContent="",this.domNode.classList.remove("no-docs","no-type"),this.layout(this.size.width,this.getLayoutInfo().lineHeight*2),this._onDidChangeContents.fire(this)}renderItem(e,t){this._renderDisposeable.clear();let{detail:i,documentation:n}=e.completion;if(t){let o="";o+=`score: ${e.score[0]}
`,o+=`prefix: ${e.word??"(no prefix)"}
`,o+=`word: ${e.completion.filterText?e.completion.filterText+" (filterText)":e.textLabel}
`,o+=`distance: ${e.distance} (localityBonus-setting)
`,o+=`index: ${e.idx}, based on ${e.completion.sortText&&`sortText: "${e.completion.sortText}"`||"label"}
`,o+=`commit_chars: ${e.completion.commitCharacters?.join("")}
`,n=new zn().appendCodeblock("empty",o),i=`Provider: ${e.provider._debugDisplayName}`}if(!t&&!b4(e)){this.clearContents();return}if(this.domNode.classList.remove("no-docs","no-type"),i){const o=i.length>1e5?`${i.substr(0,1e5)}`:i;this._type.textContent=o,this._type.title=o,ro(this._type),this._type.classList.toggle("auto-wrap",!/\r?\n^\s+/gmi.test(o))}else Cn(this._type),this._type.title="",ds(this._type),this.domNode.classList.add("no-type");if(Cn(this._docs),typeof n=="string")this._docs.classList.remove("markdown-docs"),this._docs.textContent=n;else if(n){this._docs.classList.add("markdown-docs"),Cn(this._docs);const o=this._markdownRenderer.render(n);this._docs.appendChild(o.element),this._renderDisposeable.add(o),this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync(()=>{this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}))}this.domNode.style.userSelect="text",this.domNode.tabIndex=-1,this._close.onmousedown=o=>{o.preventDefault(),o.stopPropagation()},this._close.onclick=o=>{o.preventDefault(),o.stopPropagation(),this._onDidClose.fire()},this._body.scrollTop=0,this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}clearContents(){this.domNode.classList.add("no-docs"),this._type.textContent="",this._docs.textContent=""}get isEmpty(){return this.domNode.classList.contains("no-docs")}get size(){return this._size}layout(e,t){const i=new bt(e,t);bt.equals(i,this._size)||(this._size=i,Ite(this.domNode,e,t)),this._scrollbar.scanDomNode()}scrollDown(e=8){this._body.scrollTop+=e}scrollUp(e=8){this._body.scrollTop-=e}scrollTop(){this._body.scrollTop=0}scrollBottom(){this._body.scrollTop=this._body.scrollHeight}pageDown(){this.scrollDown(80)}pageUp(){this.scrollUp(80)}set borderWidth(e){this._borderWidth=e}get borderWidth(){return this._borderWidth}};QM=oDe([rDe(1,ye)],QM);class aDe{constructor(e,t){this.widget=e,this._editor=t,this.allowEditorOverflow=!0,this._disposables=new Z,this._added=!1,this._preferAlignAtTop=!0,this._resizable=new jF,this._resizable.domNode.classList.add("suggest-details-container"),this._resizable.domNode.appendChild(e.domNode),this._resizable.enableSashes(!1,!0,!0,!1);let i,n,o=0,r=0;this._disposables.add(this._resizable.onDidWillResize(()=>{i=this._topLeft,n=this._resizable.size})),this._disposables.add(this._resizable.onDidResize(a=>{if(i&&n){this.widget.layout(a.dimension.width,a.dimension.height);let l=!1;a.west&&(r=n.width-a.dimension.width,l=!0),a.north&&(o=n.height-a.dimension.height,l=!0),l&&this._applyTopLeft({top:i.top+o,left:i.left+r})}a.done&&(i=void 0,n=void 0,o=0,r=0,this._userSize=a.dimension)})),this._disposables.add(this.widget.onDidChangeContents(()=>{this._anchorBox&&this._placeAtAnchor(this._anchorBox,this._userSize??this.widget.size,this._preferAlignAtTop)}))}dispose(){this._resizable.dispose(),this._disposables.dispose(),this.hide()}getId(){return"suggest.details"}getDomNode(){return this._resizable.domNode}getPosition(){return this._topLeft?{preference:this._topLeft}:null}show(){this._added||(this._editor.addOverlayWidget(this),this._added=!0)}hide(e=!1){this._resizable.clearSashHoverState(),this._added&&(this._editor.removeOverlayWidget(this),this._added=!1,this._anchorBox=void 0,this._topLeft=void 0),e&&(this._userSize=void 0,this.widget.clearContents())}placeAtAnchor(e,t){const i=e.getBoundingClientRect();this._anchorBox=i,this._preferAlignAtTop=t,this._placeAtAnchor(this._anchorBox,this._userSize??this.widget.size,t)}_placeAtAnchor(e,t,i){const n=sh(this.getDomNode().ownerDocument.body),o=this.widget.getLayoutInfo(),r=new bt(220,2*o.lineHeight),a=e.top,l=function(){const w=n.width-(e.left+e.width+o.borderWidth+o.horizontalPadding),x=-o.borderWidth+e.left+e.width,L=new bt(w,n.height-e.top-o.borderHeight-o.verticalPadding),D=L.with(void 0,e.top+e.height-o.borderHeight-o.verticalPadding);return{top:a,left:x,fit:w-t.width,maxSizeTop:L,maxSizeBottom:D,minSize:r.with(Math.min(w,r.width))}}(),c=function(){const w=e.left-o.borderWidth-o.horizontalPadding,x=Math.max(o.horizontalPadding,e.left-t.width-o.borderWidth),L=new bt(w,n.height-e.top-o.borderHeight-o.verticalPadding),D=L.with(void 0,e.top+e.height-o.borderHeight-o.verticalPadding);return{top:a,left:x,fit:w-t.width,maxSizeTop:L,maxSizeBottom:D,minSize:r.with(Math.min(w,r.width))}}(),d=function(){const w=e.left,x=-o.borderWidth+e.top+e.height,L=new bt(e.width-o.borderHeight,n.height-e.top-e.height-o.verticalPadding);return{top:x,left:w,fit:L.height-t.height,maxSizeBottom:L,maxSizeTop:L,minSize:r.with(L.width)}}(),h=[l,c,d],u=h.find(w=>w.fit>=0)??h.sort((w,x)=>x.fit-w.fit)[0],g=e.top+e.height-o.borderHeight;let f,m=t.height;const _=Math.max(u.maxSizeTop.height,u.maxSizeBottom.height);m>_&&(m=_);let b;i?m<=u.maxSizeTop.height?(f=!0,b=u.maxSizeTop):(f=!1,b=u.maxSizeBottom):m<=u.maxSizeBottom.height?(f=!1,b=u.maxSizeBottom):(f=!0,b=u.maxSizeTop);let{top:v,left:C}=u;!f&&m>e.height&&(v=g-m);const y=this._editor.getDomNode();if(y){const w=y.getBoundingClientRect();v-=w.top,C-=w.left}this._applyTopLeft({left:C,top:v}),this._resizable.enableSashes(!f,u===l,f,u!==l),this._resizable.minSize=u.minSize,this._resizable.maxSize=b,this._resizable.layout(m,Math.min(b.width,t.width)),this.widget.layout(this._resizable.size.width,this._resizable.size.height)}_applyTopLeft(e){this._topLeft=e,this._editor.layoutOverlayWidget(this)}}var wl;(function(s){s[s.FILE=0]="FILE",s[s.FOLDER=1]="FOLDER",s[s.ROOT_FOLDER=2]="ROOT_FOLDER"})(wl||(wl={}));const lDe=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;function _w(s,e,t,i,n){if(Ie.isThemeIcon(n))return[`codicon-${n.id}`,"predefined-file-icon"];if(Se.isUri(n))return[];const o=i===wl.ROOT_FOLDER?["rootfolder-icon"]:i===wl.FOLDER?["folder-icon"]:["file-icon"];if(t){let r;if(t.scheme===Fe.data)r=ah.parseMetaData(t).get(ah.META_DATA_LABEL);else{const a=t.path.match(lDe);a?(r=bw(a[2].toLowerCase()),a[1]&&o.push(`${bw(a[1].toLowerCase())}-name-dir-icon`)):r=bw(t.authority.toLowerCase())}if(i===wl.ROOT_FOLDER)o.push(`${r}-root-name-folder-icon`);else if(i===wl.FOLDER)o.push(`${r}-name-folder-icon`);else{if(r){if(o.push(`${r}-name-file-icon`),o.push("name-file-icon"),r.length<=255){const l=r.split(".");for(let c=1;c<l.length;c++)o.push(`${l.slice(c).join(".")}-ext-file-icon`)}o.push("ext-file-icon")}const a=cDe(s,e,t);a&&o.push(`${bw(a)}-lang-file-icon`)}}return o}function cDe(s,e,t){if(!t)return null;let i=null;if(t.scheme===Fe.data){const o=ah.parseMetaData(t).get(ah.META_DATA_MIME);o&&(i=e.getLanguageIdByMimeType(o))}else{const n=s.getModel(t);n&&(i=n.getLanguageId())}return i&&i!==Cs?i:e.guessLanguageIdByFilepathOrFirstLine(t)}function bw(s){return s.replace(/[\s]/g,"/")}var dDe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},wI=function(s,e){return function(t,i){e(t,i,s)}};function AK(s){return`suggest-aria-id:${s}`}const hDe=Kt("suggest-more-info",J.chevronRight,p("suggestMoreInfoIcon","Icon for more information in the suggest widget.")),uDe=new class F_{static{this._regexRelaxed=/(#([\da-fA-F]{3}){1,2}|(rgb|hsl)a\(\s*(\d{1,3}%?\s*,\s*){3}(1|0?\.\d+)\)|(rgb|hsl)\(\s*\d{1,3}%?(\s*,\s*\d{1,3}%?){2}\s*\))/}static{this._regexStrict=new RegExp(`^${F_._regexRelaxed.source}$`,"i")}extract(e,t){if(e.textLabel.match(F_._regexStrict))return t[0]=e.textLabel,!0;if(e.completion.detail&&e.completion.detail.match(F_._regexStrict))return t[0]=e.completion.detail,!0;if(e.completion.documentation){const i=typeof e.completion.documentation=="string"?e.completion.documentation:e.completion.documentation.value,n=F_._regexRelaxed.exec(i);if(n&&(n.index===0||n.index+n[0].length===i.length))return t[0]=n[0],!0}return!1}};let JM=class{constructor(e,t,i,n){this._editor=e,this._modelService=t,this._languageService=i,this._themeService=n,this._onDidToggleDetails=new O,this.onDidToggleDetails=this._onDidToggleDetails.event,this.templateId="suggestion"}dispose(){this._onDidToggleDetails.dispose()}renderTemplate(e){const t=new Z,i=e;i.classList.add("show-file-icons");const n=X(e,te(".icon")),o=X(n,te("span.colorspan")),r=X(e,te(".contents")),a=X(r,te(".main")),l=X(a,te(".icon-label.codicon")),c=X(a,te("span.left")),d=X(a,te("span.right")),h=new Z0(c,{supportHighlights:!0,supportIcons:!0});t.add(h);const u=X(c,te("span.signature-label")),g=X(c,te("span.qualifier-label")),f=X(d,te("span.details-label")),m=X(d,te("span.readMore"+Ie.asCSSSelector(hDe)));return m.title=p("readMore","Read More"),{root:i,left:c,right:d,icon:n,colorspan:o,iconLabel:h,iconContainer:l,parametersLabel:u,qualifierLabel:g,detailsLabel:f,readMore:m,disposables:t,configureFont:()=>{const b=this._editor.getOptions(),v=b.get(50),C=v.getMassagedFontFamily(),y=v.fontFeatureSettings,w=b.get(120)||v.fontSize,x=b.get(121)||v.lineHeight,L=v.fontWeight,D=v.letterSpacing,T=`${w}px`,F=`${x}px`,W=`${D}px`;i.style.fontSize=T,i.style.fontWeight=L,i.style.letterSpacing=W,a.style.fontFamily=C,a.style.fontFeatureSettings=y,a.style.lineHeight=F,n.style.height=F,n.style.width=F,m.style.height=F,m.style.width=F}}}renderElement(e,t,i){i.configureFont();const{completion:n}=e;i.root.id=AK(t),i.colorspan.style.backgroundColor="";const o={labelEscapeNewLines:!0,matches:IC(e.score)},r=[];if(n.kind===19&&uDe.extract(e,r))i.icon.className="icon customcolor",i.iconContainer.className="icon hide",i.colorspan.style.backgroundColor=r[0];else if(n.kind===20&&this._themeService.getFileIconTheme().hasFileIcons){i.icon.className="icon hide",i.iconContainer.className="icon hide";const a=_w(this._modelService,this._languageService,Se.from({scheme:"fake",path:e.textLabel}),wl.FILE),l=_w(this._modelService,this._languageService,Se.from({scheme:"fake",path:n.detail}),wl.FILE);o.extraClasses=a.length>l.length?a:l}else n.kind===23&&this._themeService.getFileIconTheme().hasFolderIcons?(i.icon.className="icon hide",i.iconContainer.className="icon hide",o.extraClasses=[_w(this._modelService,this._languageService,Se.from({scheme:"fake",path:e.textLabel}),wl.FOLDER),_w(this._modelService,this._languageService,Se.from({scheme:"fake",path:n.detail}),wl.FOLDER)].flat()):(i.icon.className="icon hide",i.iconContainer.className="",i.iconContainer.classList.add("suggest-icon",...Ie.asClassNameArray(Ub.toIcon(n.kind))));n.tags&&n.tags.indexOf(1)>=0&&(o.extraClasses=(o.extraClasses||[]).concat(["deprecated"]),o.matches=[]),i.iconLabel.setLabel(e.textLabel,void 0,o),typeof n.label=="string"?(i.parametersLabel.textContent="",i.detailsLabel.textContent=SI(n.detail||""),i.root.classList.add("string-label")):(i.parametersLabel.textContent=SI(n.label.detail||""),i.detailsLabel.textContent=SI(n.label.description||""),i.root.classList.remove("string-label")),this._editor.getOption(119).showInlineDetails?ro(i.detailsLabel):ds(i.detailsLabel),b4(e)?(i.right.classList.add("can-expand-details"),ro(i.readMore),i.readMore.onmousedown=a=>{a.stopPropagation(),a.preventDefault()},i.readMore.onclick=a=>{a.stopPropagation(),a.preventDefault(),this._onDidToggleDetails.fire()}):(i.right.classList.remove("can-expand-details"),ds(i.readMore),i.readMore.onmousedown=null,i.readMore.onclick=null)}disposeTemplate(e){e.disposables.dispose()}};JM=dDe([wI(1,Zt),wI(2,ni),wI(3,Ki)],JM);function SI(s){return s.replace(/\r\n|\r|\n/g,"")}var gDe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},vw=function(s,e){return function(t,i){e(t,i,s)}},pf;E("editorSuggestWidget.background",Bo,p("editorSuggestWidgetBackground","Background color of the suggest widget."));E("editorSuggestWidget.border",S2,p("editorSuggestWidgetBorder","Border color of the suggest widget."));const fDe=E("editorSuggestWidget.foreground",Hl,p("editorSuggestWidgetForeground","Foreground color of the suggest widget."));E("editorSuggestWidget.selectedForeground",rv,p("editorSuggestWidgetSelectedForeground","Foreground color of the selected entry in the suggest widget."));E("editorSuggestWidget.selectedIconForeground",E2,p("editorSuggestWidgetSelectedIconForeground","Icon foreground color of the selected entry in the suggest widget."));const pDe=E("editorSuggestWidget.selectedBackground",av,p("editorSuggestWidgetSelectedBackground","Background color of the selected entry in the suggest widget."));E("editorSuggestWidget.highlightForeground",Lf,p("editorSuggestWidgetHighlightForeground","Color of the match highlights in the suggest widget."));E("editorSuggestWidget.focusHighlightForeground",Wre,p("editorSuggestWidgetFocusHighlightForeground","Color of the match highlights in the suggest widget when an item is focused."));E("editorSuggestWidgetStatus.foreground",je(fDe,.5),p("editorSuggestWidgetStatusForeground","Foreground color of the suggest widget status."));class mDe{constructor(e,t){this._service=e,this._key=`suggestWidget.size/${t.getEditorType()}/${t instanceof ta}`}restore(){const e=this._service.get(this._key,0)??"";try{const t=JSON.parse(e);if(bt.is(t))return bt.lift(t)}catch{}}store(e){this._service.store(this._key,JSON.stringify(e),0,1)}reset(){this._service.remove(this._key,0)}}let eA=class{static{pf=this}static{this.LOADING_MESSAGE=p("suggestWidget.loading","Loading...")}static{this.NO_SUGGESTIONS_MESSAGE=p("suggestWidget.noSuggestions","No suggestions.")}constructor(e,t,i,n,o){this.editor=e,this._storageService=t,this._state=0,this._isAuto=!1,this._pendingLayout=new nn,this._pendingShowDetails=new nn,this._ignoreFocusEvents=!1,this._forceRenderingAbove=!1,this._explainMode=!1,this._showTimeout=new ia,this._disposables=new Z,this._onDidSelect=new Vu,this._onDidFocus=new Vu,this._onDidHide=new O,this._onDidShow=new O,this.onDidSelect=this._onDidSelect.event,this.onDidFocus=this._onDidFocus.event,this.onDidHide=this._onDidHide.event,this.onDidShow=this._onDidShow.event,this._onDetailsKeydown=new O,this.onDetailsKeyDown=this._onDetailsKeydown.event,this.element=new jF,this.element.domNode.classList.add("editor-widget","suggest-widget"),this._contentWidget=new _De(this,e),this._persistedSize=new mDe(t,e);class r{constructor(g,f,m=!1,_=!1){this.persistedSize=g,this.currentSize=f,this.persistHeight=m,this.persistWidth=_}}let a;this._disposables.add(this.element.onDidWillResize(()=>{this._contentWidget.lockPreference(),a=new r(this._persistedSize.restore(),this.element.size)})),this._disposables.add(this.element.onDidResize(u=>{if(this._resize(u.dimension.width,u.dimension.height),a&&(a.persistHeight=a.persistHeight||!!u.north||!!u.south,a.persistWidth=a.persistWidth||!!u.east||!!u.west),!!u.done){if(a){const{itemHeight:g,defaultSize:f}=this.getLayoutInfo(),m=Math.round(g/2);let{width:_,height:b}=this.element.size;(!a.persistHeight||Math.abs(a.currentSize.height-b)<=m)&&(b=a.persistedSize?.height??f.height),(!a.persistWidth||Math.abs(a.currentSize.width-_)<=m)&&(_=a.persistedSize?.width??f.width),this._persistedSize.store(new bt(_,b))}this._contentWidget.unlockPreference(),a=void 0}})),this._messageElement=X(this.element.domNode,te(".message")),this._listElement=X(this.element.domNode,te(".tree"));const l=this._disposables.add(o.createInstance(QM,this.editor));l.onDidClose(this.toggleDetails,this,this._disposables),this._details=new aDe(l,this.editor);const c=()=>this.element.domNode.classList.toggle("no-icons",!this.editor.getOption(119).showIcons);c();const d=o.createInstance(JM,this.editor);this._disposables.add(d),this._disposables.add(d.onDidToggleDetails(()=>this.toggleDetails())),this._list=new Xo("SuggestWidget",this._listElement,{getHeight:u=>this.getLayoutInfo().itemHeight,getTemplateId:u=>"suggestion"},[d],{alwaysConsumeMouseWheel:!0,useShadows:!1,mouseSupport:!1,multipleSelectionSupport:!1,accessibilityProvider:{getRole:()=>"option",getWidgetAriaLabel:()=>p("suggest","Suggest"),getWidgetRole:()=>"listbox",getAriaLabel:u=>{let g=u.textLabel;if(typeof u.completion.label!="string"){const{detail:b,description:v}=u.completion.label;b&&v?g=p("label.full","{0} {1}, {2}",g,b,v):b?g=p("label.detail","{0} {1}",g,b):v&&(g=p("label.desc","{0}, {1}",g,v))}if(!u.isResolved||!this._isDetailsVisible())return g;const{documentation:f,detail:m}=u.completion,_=zu("{0}{1}",m||"",f?typeof f=="string"?f:f.value:"");return p("ariaCurrenttSuggestionReadDetails","{0}, docs: {1}",g,_)}}}),this._list.style(vg({listInactiveFocusBackground:pDe,listInactiveFocusOutline:Xt})),this._status=o.createInstance(XM,this.element.domNode,Xd);const h=()=>this.element.domNode.classList.toggle("with-status-bar",this.editor.getOption(119).showStatusBar);h(),this._disposables.add(n.onDidColorThemeChange(u=>this._onThemeChange(u))),this._onThemeChange(n.getColorTheme()),this._disposables.add(this._list.onMouseDown(u=>this._onListMouseDownOrTap(u))),this._disposables.add(this._list.onTap(u=>this._onListMouseDownOrTap(u))),this._disposables.add(this._list.onDidChangeSelection(u=>this._onListSelection(u))),this._disposables.add(this._list.onDidChangeFocus(u=>this._onListFocus(u))),this._disposables.add(this.editor.onDidChangeCursorSelection(()=>this._onCursorSelectionChanged())),this._disposables.add(this.editor.onDidChangeConfiguration(u=>{u.hasChanged(119)&&(h(),c()),this._completionModel&&(u.hasChanged(50)||u.hasChanged(120)||u.hasChanged(121))&&this._list.splice(0,this._list.length,this._completionModel.items)})),this._ctxSuggestWidgetVisible=$e.Visible.bindTo(i),this._ctxSuggestWidgetDetailsVisible=$e.DetailsVisible.bindTo(i),this._ctxSuggestWidgetMultipleSuggestions=$e.MultipleSuggestions.bindTo(i),this._ctxSuggestWidgetHasFocusedSuggestion=$e.HasFocusedSuggestion.bindTo(i),this._disposables.add(gi(this._details.widget.domNode,"keydown",u=>{this._onDetailsKeydown.fire(u)})),this._disposables.add(this.editor.onMouseDown(u=>this._onEditorMouseDown(u)))}dispose(){this._details.widget.dispose(),this._details.dispose(),this._list.dispose(),this._status.dispose(),this._disposables.dispose(),this._loadingTimeout?.dispose(),this._pendingLayout.dispose(),this._pendingShowDetails.dispose(),this._showTimeout.dispose(),this._contentWidget.dispose(),this.element.dispose()}_onEditorMouseDown(e){this._details.widget.domNode.contains(e.target.element)?this._details.widget.domNode.focus():this.element.domNode.contains(e.target.element)&&this.editor.focus()}_onCursorSelectionChanged(){this._state!==0&&this._contentWidget.layout()}_onListMouseDownOrTap(e){typeof e.element>"u"||typeof e.index>"u"||(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation(),this._select(e.element,e.index))}_onListSelection(e){e.elements.length&&this._select(e.elements[0],e.indexes[0])}_select(e,t){const i=this._completionModel;i&&(this._onDidSelect.fire({item:e,index:t,model:i}),this.editor.focus())}_onThemeChange(e){this._details.widget.borderWidth=Ra(e.type)?2:1}_onListFocus(e){if(this._ignoreFocusEvents)return;if(!e.elements.length){this._currentSuggestionDetails&&(this._currentSuggestionDetails.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=void 0),this.editor.setAriaOptions({activeDescendant:void 0}),this._ctxSuggestWidgetHasFocusedSuggestion.set(!1);return}if(!this._completionModel)return;this._ctxSuggestWidgetHasFocusedSuggestion.set(!0);const t=e.elements[0],i=e.indexes[0];t!==this._focusedItem&&(this._currentSuggestionDetails?.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=t,this._list.reveal(i),this._currentSuggestionDetails=en(async n=>{const o=nh(()=>{this._isDetailsVisible()&&this.showDetails(!0)},250),r=n.onCancellationRequested(()=>o.dispose());try{return await t.resolve(n)}finally{o.dispose(),r.dispose()}}),this._currentSuggestionDetails.then(()=>{i>=this._list.length||t!==this._list.element(i)||(this._ignoreFocusEvents=!0,this._list.splice(i,1,[t]),this._list.setFocus([i]),this._ignoreFocusEvents=!1,this._isDetailsVisible()?this.showDetails(!1):this.element.domNode.classList.remove("docs-side"),this.editor.setAriaOptions({activeDescendant:AK(i)}))}).catch(Oe)),this._onDidFocus.fire({item:t,index:i,model:this._completionModel})}_setState(e){if(this._state!==e)switch(this._state=e,this.element.domNode.classList.toggle("frozen",e===4),this.element.domNode.classList.remove("message"),e){case 0:ds(this._messageElement,this._listElement,this._status.element),this._details.hide(!0),this._status.hide(),this._contentWidget.hide(),this._ctxSuggestWidgetVisible.reset(),this._ctxSuggestWidgetMultipleSuggestions.reset(),this._ctxSuggestWidgetHasFocusedSuggestion.reset(),this._showTimeout.cancel(),this.element.domNode.classList.remove("visible"),this._list.splice(0,this._list.length),this._focusedItem=void 0,this._cappedHeight=void 0,this._explainMode=!1;break;case 1:this.element.domNode.classList.add("message"),this._messageElement.textContent=pf.LOADING_MESSAGE,ds(this._listElement,this._status.element),ro(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,Nl(pf.LOADING_MESSAGE);break;case 2:this.element.domNode.classList.add("message"),this._messageElement.textContent=pf.NO_SUGGESTIONS_MESSAGE,ds(this._listElement,this._status.element),ro(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,Nl(pf.NO_SUGGESTIONS_MESSAGE);break;case 3:ds(this._messageElement),ro(this._listElement,this._status.element),this._show();break;case 4:ds(this._messageElement),ro(this._listElement,this._status.element),this._show();break;case 5:ds(this._messageElement),ro(this._listElement,this._status.element),this._details.show(),this._show();break}}_show(){this._status.show(),this._contentWidget.show(),this._layout(this._persistedSize.restore()),this._ctxSuggestWidgetVisible.set(!0),this._showTimeout.cancelAndSet(()=>{this.element.domNode.classList.add("visible"),this._onDidShow.fire(this)},100)}showTriggered(e,t){this._state===0&&(this._contentWidget.setPosition(this.editor.getPosition()),this._isAuto=!!e,this._isAuto||(this._loadingTimeout=nh(()=>this._setState(1),t)))}showSuggestions(e,t,i,n,o){if(this._contentWidget.setPosition(this.editor.getPosition()),this._loadingTimeout?.dispose(),this._currentSuggestionDetails?.cancel(),this._currentSuggestionDetails=void 0,this._completionModel!==e&&(this._completionModel=e),i&&this._state!==2&&this._state!==0){this._setState(4);return}const r=this._completionModel.items.length,a=r===0;if(this._ctxSuggestWidgetMultipleSuggestions.set(r>1),a){this._setState(n?0:2),this._completionModel=void 0;return}this._focusedItem=void 0,this._onDidFocus.pause(),this._onDidSelect.pause();try{this._list.splice(0,this._list.length,this._completionModel.items),this._setState(i?4:3),this._list.reveal(t,0),this._list.setFocus(o?[]:[t])}finally{this._onDidFocus.resume(),this._onDidSelect.resume()}this._pendingLayout.value=V1(ke(this.element.domNode),()=>{this._pendingLayout.clear(),this._layout(this.element.size),this._details.widget.domNode.classList.remove("focused")})}focusSelected(){this._list.length>0&&this._list.setFocus([0])}selectNextPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageDown(),!0;case 1:return!this._isAuto;default:return this._list.focusNextPage(),!0}}selectNext(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusNext(1,!0),!0}}selectLast(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollBottom(),!0;case 1:return!this._isAuto;default:return this._list.focusLast(),!0}}selectPreviousPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageUp(),!0;case 1:return!this._isAuto;default:return this._list.focusPreviousPage(),!0}}selectPrevious(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusPrevious(1,!0),!1}}selectFirst(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollTop(),!0;case 1:return!this._isAuto;default:return this._list.focusFirst(),!0}}getFocusedItem(){if(this._state!==0&&this._state!==2&&this._state!==1&&this._completionModel&&this._list.getFocus().length>0)return{item:this._list.getFocusedElements()[0],index:this._list.getFocus()[0],model:this._completionModel}}toggleDetailsFocus(){this._state===5?(this._setState(3),this._details.widget.domNode.classList.remove("focused")):this._state===3&&this._isDetailsVisible()&&(this._setState(5),this._details.widget.domNode.classList.add("focused"))}toggleDetails(){this._isDetailsVisible()?(this._pendingShowDetails.clear(),this._ctxSuggestWidgetDetailsVisible.set(!1),this._setDetailsVisible(!1),this._details.hide(),this.element.domNode.classList.remove("shows-details")):(b4(this._list.getFocusedElements()[0])||this._explainMode)&&(this._state===3||this._state===5||this._state===4)&&(this._ctxSuggestWidgetDetailsVisible.set(!0),this._setDetailsVisible(!0),this.showDetails(!1))}showDetails(e){this._pendingShowDetails.value=V1(ke(this.element.domNode),()=>{this._pendingShowDetails.clear(),this._details.show(),e?this._details.widget.renderLoading():this._details.widget.renderItem(this._list.getFocusedElements()[0],this._explainMode),this._details.widget.isEmpty?this._details.hide():(this._positionDetails(),this.element.domNode.classList.add("shows-details")),this.editor.focus()})}toggleExplainMode(){this._list.getFocusedElements()[0]&&(this._explainMode=!this._explainMode,this._isDetailsVisible()?this.showDetails(!1):this.toggleDetails())}resetPersistedSize(){this._persistedSize.reset()}hideWidget(){this._pendingLayout.clear(),this._pendingShowDetails.clear(),this._loadingTimeout?.dispose(),this._setState(0),this._onDidHide.fire(this),this.element.clearSashHoverState();const e=this._persistedSize.restore(),t=Math.ceil(this.getLayoutInfo().itemHeight*4.3);e&&e.height<t&&this._persistedSize.store(e.with(void 0,t))}isFrozen(){return this._state===4}_afterRender(e){if(e===null){this._isDetailsVisible()&&this._details.hide();return}this._state===2||this._state===1||(this._isDetailsVisible()&&!this._details.widget.isEmpty&&this._details.show(),this._positionDetails())}_layout(e){if(!this.editor.hasModel()||!this.editor.getDomNode())return;const t=sh(this.element.domNode.ownerDocument.body),i=this.getLayoutInfo();e||(e=i.defaultSize);let n=e.height,o=e.width;if(this._status.element.style.height=`${i.itemHeight}px`,this._state===2||this._state===1)n=i.itemHeight+i.borderHeight,o=i.defaultSize.width/2,this.element.enableSashes(!1,!1,!1,!1),this.element.minSize=this.element.maxSize=new bt(o,n),this._contentWidget.setPreference(2);else{const r=t.width-i.borderHeight-2*i.horizontalPadding;o>r&&(o=r);const a=this._completionModel?this._completionModel.stats.pLabelLen*i.typicalHalfwidthCharacterWidth:o,l=i.statusBarHeight+this._list.contentHeight+i.borderHeight,c=i.itemHeight+i.statusBarHeight,d=Si(this.editor.getDomNode()),h=this.editor.getScrolledVisiblePosition(this.editor.getPosition()),u=d.top+h.top+h.height,g=Math.min(t.height-u-i.verticalPadding,l),f=d.top+h.top-i.verticalPadding,m=Math.min(f,l);let _=Math.min(Math.max(m,g)+i.borderHeight,l);n===this._cappedHeight?.capped&&(n=this._cappedHeight.wanted),n<c&&(n=c),n>_&&(n=_),n>g||this._forceRenderingAbove&&f>150?(this._contentWidget.setPreference(1),this.element.enableSashes(!0,!0,!1,!1),_=m):(this._contentWidget.setPreference(2),this.element.enableSashes(!1,!0,!0,!1),_=g),this.element.preferredSize=new bt(a,i.defaultSize.height),this.element.maxSize=new bt(r,_),this.element.minSize=new bt(220,c),this._cappedHeight=n===l?{wanted:this._cappedHeight?.wanted??e.height,capped:n}:void 0}this._resize(o,n)}_resize(e,t){const{width:i,height:n}=this.element.maxSize;e=Math.min(i,e),t=Math.min(n,t);const{statusBarHeight:o}=this.getLayoutInfo();this._list.layout(t-o,e),this._listElement.style.height=`${t-o}px`,this.element.layout(t,e),this._contentWidget.layout(),this._positionDetails()}_positionDetails(){this._isDetailsVisible()&&this._details.placeAtAnchor(this.element.domNode,this._contentWidget.getPosition()?.preference[0]===2)}getLayoutInfo(){const e=this.editor.getOption(50),t=cs(this.editor.getOption(121)||e.lineHeight,8,1e3),i=!this.editor.getOption(119).showStatusBar||this._state===2||this._state===1?0:t,n=this._details.widget.borderWidth,o=2*n;return{itemHeight:t,statusBarHeight:i,borderWidth:n,borderHeight:o,typicalHalfwidthCharacterWidth:e.typicalHalfwidthCharacterWidth,verticalPadding:22,horizontalPadding:14,defaultSize:new bt(430,i+12*t+o)}}_isDetailsVisible(){return this._storageService.getBoolean("expandSuggestionDocs",0,!1)}_setDetailsVisible(e){this._storageService.store("expandSuggestionDocs",e,0,0)}forceRenderingAbove(){this._forceRenderingAbove||(this._forceRenderingAbove=!0,this._layout(this._persistedSize.restore()))}stopForceRenderingAbove(){this._forceRenderingAbove=!1}};eA=pf=gDe([vw(1,oa),vw(2,Ee),vw(3,Ki),vw(4,ye)],eA);class _De{constructor(e,t){this._widget=e,this._editor=t,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._preferenceLocked=!1,this._added=!1,this._hidden=!1}dispose(){this._added&&(this._added=!1,this._editor.removeContentWidget(this))}getId(){return"editor.widget.suggestWidget"}getDomNode(){return this._widget.element.domNode}show(){this._hidden=!1,this._added||(this._added=!0,this._editor.addContentWidget(this))}hide(){this._hidden||(this._hidden=!0,this.layout())}layout(){this._editor.layoutContentWidget(this)}getPosition(){return this._hidden||!this._position||!this._preference?null:{position:this._position,preference:[this._preference]}}beforeRender(){const{height:e,width:t}=this._widget.element.size,{borderWidth:i,horizontalPadding:n}=this._widget.getLayoutInfo();return new bt(t+2*i+n,e+2*i)}afterRender(e){this._widget._afterRender(e)}setPreference(e){this._preferenceLocked||(this._preference=e)}lockPreference(){this._preferenceLocked=!0}unlockPreference(){this._preferenceLocked=!1}setPosition(e){this._position=e}}var bDe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},nf=function(s,e){return function(t,i){e(t,i,s)}},tA;class vDe{constructor(e,t){if(this._model=e,this._position=t,this._decorationOptions=We.register({description:"suggest-line-suffix",stickiness:1}),e.getLineMaxColumn(t.lineNumber)!==t.column){const n=e.getOffsetAt(t),o=e.getPositionAt(n+1);e.changeDecorations(r=>{this._marker&&r.removeDecoration(this._marker),this._marker=r.addDecoration(k.fromPositions(t,o),this._decorationOptions)})}}dispose(){this._marker&&!this._model.isDisposed()&&this._model.changeDecorations(e=>{e.removeDecoration(this._marker),this._marker=void 0})}delta(e){if(this._model.isDisposed()||this._position.lineNumber!==e.lineNumber)return 0;if(this._marker){const t=this._model.getDecorationRange(this._marker);return this._model.getOffsetAt(t.getStartPosition())-this._model.getOffsetAt(e)}else return this._model.getLineMaxColumn(e.lineNumber)-e.column}}let Kr=class{static{tA=this}static{this.ID="editor.contrib.suggestController"}static get(e){return e.getContribution(tA.ID)}constructor(e,t,i,n,o,r,a){this._memoryService=t,this._commandService=i,this._contextKeyService=n,this._instantiationService=o,this._logService=r,this._telemetryService=a,this._lineSuffix=new nn,this._toDispose=new Z,this._selectors=new CDe(h=>h.priority),this._onWillInsertSuggestItem=new O,this.onWillInsertSuggestItem=this._onWillInsertSuggestItem.event,this.editor=e,this.model=o.createInstance(jS,this.editor),this._selectors.register({priority:0,select:(h,u,g)=>this._memoryService.select(h,u,g)});const l=$e.InsertMode.bindTo(n);l.set(e.getOption(119).insertMode),this._toDispose.add(this.model.onDidTrigger(()=>l.set(e.getOption(119).insertMode))),this.widget=this._toDispose.add(new Uk(ke(e.getDomNode()),()=>{const h=this._instantiationService.createInstance(eA,this.editor);this._toDispose.add(h),this._toDispose.add(h.onDidSelect(_=>this._insertSuggestion(_,0),this));const u=new eDe(this.editor,h,this.model,_=>this._insertSuggestion(_,2));this._toDispose.add(u);const g=$e.MakesTextEdit.bindTo(this._contextKeyService),f=$e.HasInsertAndReplaceRange.bindTo(this._contextKeyService),m=$e.CanResolve.bindTo(this._contextKeyService);return this._toDispose.add(Ce(()=>{g.reset(),f.reset(),m.reset()})),this._toDispose.add(h.onDidFocus(({item:_})=>{const b=this.editor.getPosition(),v=_.editStart.column,C=b.column;let y=!0;this.editor.getOption(1)==="smart"&&this.model.state===2&&!_.completion.additionalTextEdits&&!(_.completion.insertTextRules&4)&&C-v===_.completion.insertText.length&&(y=this.editor.getModel().getValueInRange({startLineNumber:b.lineNumber,startColumn:v,endLineNumber:b.lineNumber,endColumn:C})!==_.completion.insertText),g.set(y),f.set(!P.equals(_.editInsertEnd,_.editReplaceEnd)),m.set(!!_.provider.resolveCompletionItem||!!_.completion.documentation||_.completion.detail!==_.completion.label)})),this._toDispose.add(h.onDetailsKeyDown(_=>{if(_.toKeyCodeChord().equals(new Bc(!0,!1,!1,!1,33))||Qe&&_.toKeyCodeChord().equals(new Bc(!1,!1,!1,!0,33))){_.stopPropagation();return}_.toKeyCodeChord().isModifierKey()||this.editor.focus()})),h})),this._overtypingCapturer=this._toDispose.add(new Uk(ke(e.getDomNode()),()=>this._toDispose.add(new _4(this.editor,this.model)))),this._alternatives=this._toDispose.add(new Uk(ke(e.getDomNode()),()=>this._toDispose.add(new nm(this.editor,this._contextKeyService)))),this._toDispose.add(o.createInstance($S,e)),this._toDispose.add(this.model.onDidTrigger(h=>{this.widget.value.showTriggered(h.auto,h.shy?250:50),this._lineSuffix.value=new vDe(this.editor.getModel(),h.position)})),this._toDispose.add(this.model.onDidSuggest(h=>{if(h.triggerOptions.shy)return;let u=-1;for(const f of this._selectors.itemsOrderedByPriorityDesc)if(u=f.select(this.editor.getModel(),this.editor.getPosition(),h.completionModel.items),u!==-1)break;if(u===-1&&(u=0),this.model.state===0)return;let g=!1;if(h.triggerOptions.auto){const f=this.editor.getOption(119);f.selectionMode==="never"||f.selectionMode==="always"?g=f.selectionMode==="never":f.selectionMode==="whenTriggerCharacter"?g=h.triggerOptions.triggerKind!==1:f.selectionMode==="whenQuickSuggestion"&&(g=h.triggerOptions.triggerKind===1&&!h.triggerOptions.refilter)}this.widget.value.showSuggestions(h.completionModel,u,h.isFrozen,h.triggerOptions.auto,g)})),this._toDispose.add(this.model.onDidCancel(h=>{h.retrigger||this.widget.value.hideWidget()})),this._toDispose.add(this.editor.onDidBlurEditorWidget(()=>{this.model.cancel(),this.model.clear()}));const c=$e.AcceptSuggestionsOnEnter.bindTo(n),d=()=>{const h=this.editor.getOption(1);c.set(h==="on"||h==="smart")};this._toDispose.add(this.editor.onDidChangeConfiguration(()=>d())),d()}dispose(){this._alternatives.dispose(),this._toDispose.dispose(),this.widget.dispose(),this.model.dispose(),this._lineSuffix.dispose(),this._onWillInsertSuggestItem.dispose()}_insertSuggestion(e,t){if(!e||!e.item){this._alternatives.value.reset(),this.model.cancel(),this.model.clear();return}if(!this.editor.hasModel())return;const i=xs.get(this.editor);if(!i)return;this._onWillInsertSuggestItem.fire({item:e.item});const n=this.editor.getModel(),o=n.getAlternativeVersionId(),{item:r}=e,a=[],l=new li;t&1||this.editor.pushUndoStop();const c=this.getOverwriteInfo(r,!!(t&8));this._memoryService.memorize(n,this.editor.getPosition(),r);const d=r.isResolved;let h=-1,u=-1;if(Array.isArray(r.completion.additionalTextEdits)){this.model.cancel();const f=$a.capture(this.editor);this.editor.executeEdits("suggestController.additionalTextEdits.sync",r.completion.additionalTextEdits.map(m=>{let _=k.lift(m.range);if(_.startLineNumber===r.position.lineNumber&&_.startColumn>r.position.column){const b=this.editor.getPosition().column-r.position.column,v=b,C=k.spansMultipleLines(_)?0:b;_=new k(_.startLineNumber,_.startColumn+v,_.endLineNumber,_.endColumn+C)}return ri.replaceMove(_,m.text)})),f.restoreRelativeVerticalPositionOfCursor(this.editor)}else if(!d){const f=new un;let m;const _=n.onDidChangeContent(y=>{if(y.isFlush){l.cancel(),_.dispose();return}for(const w of y.changes){const x=k.getEndPosition(w.range);(!m||P.isBefore(x,m))&&(m=x)}}),b=t;t|=2;let v=!1;const C=this.editor.onWillType(()=>{C.dispose(),v=!0,b&2||this.editor.pushUndoStop()});a.push(r.resolve(l.token).then(()=>{if(!r.completion.additionalTextEdits||l.token.isCancellationRequested)return;if(m&&r.completion.additionalTextEdits.some(w=>P.isBefore(m,k.getStartPosition(w.range))))return!1;v&&this.editor.pushUndoStop();const y=$a.capture(this.editor);return this.editor.executeEdits("suggestController.additionalTextEdits.async",r.completion.additionalTextEdits.map(w=>ri.replaceMove(k.lift(w.range),w.text))),y.restoreRelativeVerticalPositionOfCursor(this.editor),(v||!(b&2))&&this.editor.pushUndoStop(),!0}).then(y=>{this._logService.trace("[suggest] async resolving of edits DONE (ms, applied?)",f.elapsed(),y),u=y===!0?1:y===!1?0:-2}).finally(()=>{_.dispose(),C.dispose()}))}let{insertText:g}=r.completion;if(r.completion.insertTextRules&4||(g=sg.escape(g)),this.model.cancel(),i.insert(g,{overwriteBefore:c.overwriteBefore,overwriteAfter:c.overwriteAfter,undoStopBefore:!1,undoStopAfter:!1,adjustWhitespace:!(r.completion.insertTextRules&1),clipboardText:e.model.clipboardText,overtypingCapturer:this._overtypingCapturer.value}),t&2||this.editor.pushUndoStop(),r.completion.command)if(r.completion.command.id===sk.id)this.model.trigger({auto:!0,retrigger:!0});else{const f=new un;a.push(this._commandService.executeCommand(r.completion.command.id,...r.completion.command.arguments?[...r.completion.command.arguments]:[]).catch(m=>{r.completion.extensionId?Li(m):Oe(m)}).finally(()=>{h=f.elapsed()}))}t&4&&this._alternatives.value.set(e,f=>{for(l.cancel();n.canUndo();){o!==n.getAlternativeVersionId()&&n.undo(),this._insertSuggestion(f,3|(t&8?8:0));break}}),this._alertCompletionItem(r),Promise.all(a).finally(()=>{this._reportSuggestionAcceptedTelemetry(r,n,d,h,u,e.index,e.model.items),this.model.clear(),l.dispose()})}_reportSuggestionAcceptedTelemetry(e,t,i,n,o,r,a){if(Math.floor(Math.random()*100)===0)return;const l=new Map;for(let u=0;u<Math.min(30,a.length);u++){const g=a[u].textLabel;l.has(g)?l.get(g).push(u):l.set(g,[u])}const c=l.get(e.textLabel),h=c&&c.length>1?c[0]:-1;this._telemetryService.publicLog2("suggest.acceptedSuggestion",{extensionId:e.extensionId?.value??"unknown",providerId:e.provider._debugDisplayName??"unknown",kind:e.completion.kind,basenameHash:CL(wr(t.uri)).toString(16),languageId:t.getLanguageId(),fileExtension:Xae(t.uri),resolveInfo:e.provider.resolveCompletionItem?i?1:0:-1,resolveDuration:e.resolveDuration,commandDuration:n,additionalEditsAsync:o,index:r,firstIndex:h})}getOverwriteInfo(e,t){gt(this.editor.hasModel());let i=this.editor.getOption(119).insertMode==="replace";t&&(i=!i);const n=e.position.column-e.editStart.column,o=(i?e.editReplaceEnd.column:e.editInsertEnd.column)-e.position.column,r=this.editor.getPosition().column-e.position.column,a=this._lineSuffix.value?this._lineSuffix.value.delta(this.editor.getPosition()):0;return{overwriteBefore:n+r,overwriteAfter:o+a}}_alertCompletionItem(e){if(os(e.completion.additionalTextEdits)){const t=p("aria.alert.snippet","Accepting '{0}' made {1} additional edits",e.textLabel,e.completion.additionalTextEdits.length);Ls(t)}}triggerSuggest(e,t,i){this.editor.hasModel()&&(this.model.trigger({auto:t??!1,completionOptions:{providerFilter:e,kindFilter:i?new Set:void 0}}),this.editor.revealPosition(this.editor.getPosition(),0),this.editor.focus())}triggerSuggestAndAcceptBest(e){if(!this.editor.hasModel())return;const t=this.editor.getPosition(),i=()=>{t.equals(this.editor.getPosition())&&this._commandService.executeCommand(e.fallback)},n=o=>{if(o.completion.insertTextRules&4||o.completion.additionalTextEdits)return!0;const r=this.editor.getPosition(),a=o.editStart.column,l=r.column;return l-a!==o.completion.insertText.length?!0:this.editor.getModel().getValueInRange({startLineNumber:r.lineNumber,startColumn:a,endLineNumber:r.lineNumber,endColumn:l})!==o.completion.insertText};se.once(this.model.onDidTrigger)(o=>{const r=[];se.any(this.model.onDidTrigger,this.model.onDidCancel)(()=>{At(r),i()},void 0,r),this.model.onDidSuggest(({completionModel:a})=>{if(At(r),a.items.length===0){i();return}const l=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),a.items),c=a.items[l];if(!n(c)){i();return}this.editor.pushUndoStop(),this._insertSuggestion({index:l,item:c,model:a},7)},void 0,r)}),this.model.trigger({auto:!1,shy:!0}),this.editor.revealPosition(t,0),this.editor.focus()}acceptSelectedSuggestion(e,t){const i=this.widget.value.getFocusedItem();let n=0;e&&(n|=4),t&&(n|=8),this._insertSuggestion(i,n)}acceptNextSuggestion(){this._alternatives.value.next()}acceptPrevSuggestion(){this._alternatives.value.prev()}cancelSuggestWidget(){this.model.cancel(),this.model.clear(),this.widget.value.hideWidget()}focusSuggestion(){this.widget.value.focusSelected()}selectNextSuggestion(){this.widget.value.selectNext()}selectNextPageSuggestion(){this.widget.value.selectNextPage()}selectLastSuggestion(){this.widget.value.selectLast()}selectPrevSuggestion(){this.widget.value.selectPrevious()}selectPrevPageSuggestion(){this.widget.value.selectPreviousPage()}selectFirstSuggestion(){this.widget.value.selectFirst()}toggleSuggestionDetails(){this.widget.value.toggleDetails()}toggleExplainMode(){this.widget.value.toggleExplainMode()}toggleSuggestionFocus(){this.widget.value.toggleDetailsFocus()}resetWidgetSize(){this.widget.value.resetPersistedSize()}forceRenderingAbove(){this.widget.value.forceRenderingAbove()}stopForceRenderingAbove(){this.widget.isInitialized&&this.widget.value.stopForceRenderingAbove()}registerSelector(e){return this._selectors.register(e)}};Kr=tA=bDe([nf(1,nk),nf(2,Ht),nf(3,Ee),nf(4,ye),nf(5,Pn),nf(6,jn)],Kr);class CDe{constructor(e){this.prioritySelector=e,this._items=new Array}register(e){if(this._items.indexOf(e)!==-1)throw new Error("Value is already registered");return this._items.push(e),this._items.sort((t,i)=>this.prioritySelector(i)-this.prioritySelector(t)),{dispose:()=>{const t=this._items.indexOf(e);t>=0&&this._items.splice(t,1)}}}get itemsOrderedByPriorityDesc(){return this._items}}class sk extends ge{static{this.id="editor.action.triggerSuggest"}constructor(){super({id:sk.id,label:p("suggest.trigger.label","Trigger Suggest"),alias:"Trigger Suggest",precondition:q.and(I.writable,I.hasCompletionItemProvider,$e.Visible.toNegated()),kbOpts:{kbExpr:I.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[521,2087]},weight:100}})}run(e,t,i){const n=Kr.get(t);if(!n)return;let o;i&&typeof i=="object"&&i.auto===!0&&(o=!0),n.triggerSuggest(void 0,o,void 0)}}ct(Kr.ID,Kr,2);Q(sk);const Ko=190,Ts=Zi.bindToContribution(Kr.get);ae(new Ts({id:"acceptSelectedSuggestion",precondition:q.and($e.Visible,$e.HasFocusedSuggestion),handler(s){s.acceptSelectedSuggestion(!0,!1)},kbOpts:[{primary:2,kbExpr:q.and($e.Visible,I.textInputFocus),weight:Ko},{primary:3,kbExpr:q.and($e.Visible,I.textInputFocus,$e.AcceptSuggestionsOnEnter,$e.MakesTextEdit),weight:Ko}],menuOpts:[{menuId:Xd,title:p("accept.insert","Insert"),group:"left",order:1,when:$e.HasInsertAndReplaceRange.toNegated()},{menuId:Xd,title:p("accept.insert","Insert"),group:"left",order:1,when:q.and($e.HasInsertAndReplaceRange,$e.InsertMode.isEqualTo("insert"))},{menuId:Xd,title:p("accept.replace","Replace"),group:"left",order:1,when:q.and($e.HasInsertAndReplaceRange,$e.InsertMode.isEqualTo("replace"))}]}));ae(new Ts({id:"acceptAlternativeSelectedSuggestion",precondition:q.and($e.Visible,I.textInputFocus,$e.HasFocusedSuggestion),kbOpts:{weight:Ko,kbExpr:I.textInputFocus,primary:1027,secondary:[1026]},handler(s){s.acceptSelectedSuggestion(!1,!0)},menuOpts:[{menuId:Xd,group:"left",order:2,when:q.and($e.HasInsertAndReplaceRange,$e.InsertMode.isEqualTo("insert")),title:p("accept.replace","Replace")},{menuId:Xd,group:"left",order:2,when:q.and($e.HasInsertAndReplaceRange,$e.InsertMode.isEqualTo("replace")),title:p("accept.insert","Insert")}]}));ot.registerCommandAlias("acceptSelectedSuggestionOnEnter","acceptSelectedSuggestion");ae(new Ts({id:"hideSuggestWidget",precondition:$e.Visible,handler:s=>s.cancelSuggestWidget(),kbOpts:{weight:Ko,kbExpr:I.textInputFocus,primary:9,secondary:[1033]}}));ae(new Ts({id:"selectNextSuggestion",precondition:q.and($e.Visible,q.or($e.MultipleSuggestions,$e.HasFocusedSuggestion.negate())),handler:s=>s.selectNextSuggestion(),kbOpts:{weight:Ko,kbExpr:I.textInputFocus,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}}));ae(new Ts({id:"selectNextPageSuggestion",precondition:q.and($e.Visible,q.or($e.MultipleSuggestions,$e.HasFocusedSuggestion.negate())),handler:s=>s.selectNextPageSuggestion(),kbOpts:{weight:Ko,kbExpr:I.textInputFocus,primary:12,secondary:[2060]}}));ae(new Ts({id:"selectLastSuggestion",precondition:q.and($e.Visible,q.or($e.MultipleSuggestions,$e.HasFocusedSuggestion.negate())),handler:s=>s.selectLastSuggestion()}));ae(new Ts({id:"selectPrevSuggestion",precondition:q.and($e.Visible,q.or($e.MultipleSuggestions,$e.HasFocusedSuggestion.negate())),handler:s=>s.selectPrevSuggestion(),kbOpts:{weight:Ko,kbExpr:I.textInputFocus,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}}));ae(new Ts({id:"selectPrevPageSuggestion",precondition:q.and($e.Visible,q.or($e.MultipleSuggestions,$e.HasFocusedSuggestion.negate())),handler:s=>s.selectPrevPageSuggestion(),kbOpts:{weight:Ko,kbExpr:I.textInputFocus,primary:11,secondary:[2059]}}));ae(new Ts({id:"selectFirstSuggestion",precondition:q.and($e.Visible,q.or($e.MultipleSuggestions,$e.HasFocusedSuggestion.negate())),handler:s=>s.selectFirstSuggestion()}));ae(new Ts({id:"focusSuggestion",precondition:q.and($e.Visible,$e.HasFocusedSuggestion.negate()),handler:s=>s.focusSuggestion(),kbOpts:{weight:Ko,kbExpr:I.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}}}));ae(new Ts({id:"focusAndAcceptSuggestion",precondition:q.and($e.Visible,$e.HasFocusedSuggestion.negate()),handler:s=>{s.focusSuggestion(),s.acceptSelectedSuggestion(!0,!1)}}));ae(new Ts({id:"toggleSuggestionDetails",precondition:q.and($e.Visible,$e.HasFocusedSuggestion),handler:s=>s.toggleSuggestionDetails(),kbOpts:{weight:Ko,kbExpr:I.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}},menuOpts:[{menuId:Xd,group:"right",order:1,when:q.and($e.DetailsVisible,$e.CanResolve),title:p("detail.more","Show Less")},{menuId:Xd,group:"right",order:1,when:q.and($e.DetailsVisible.toNegated(),$e.CanResolve),title:p("detail.less","Show More")}]}));ae(new Ts({id:"toggleExplainMode",precondition:$e.Visible,handler:s=>s.toggleExplainMode(),kbOpts:{weight:100,primary:2138}}));ae(new Ts({id:"toggleSuggestionFocus",precondition:$e.Visible,handler:s=>s.toggleSuggestionFocus(),kbOpts:{weight:Ko,kbExpr:I.textInputFocus,primary:2570,mac:{primary:778}}}));ae(new Ts({id:"insertBestCompletion",precondition:q.and(I.textInputFocus,q.equals("config.editor.tabCompletion","on"),$S.AtEnd,$e.Visible.toNegated(),nm.OtherSuggestions.toNegated(),xs.InSnippetMode.toNegated()),handler:(s,e)=>{s.triggerSuggestAndAcceptBest(dn(e)?{fallback:"tab",...e}:{fallback:"tab"})},kbOpts:{weight:Ko,primary:2}}));ae(new Ts({id:"insertNextSuggestion",precondition:q.and(I.textInputFocus,q.equals("config.editor.tabCompletion","on"),nm.OtherSuggestions,$e.Visible.toNegated(),xs.InSnippetMode.toNegated()),handler:s=>s.acceptNextSuggestion(),kbOpts:{weight:Ko,kbExpr:I.textInputFocus,primary:2}}));ae(new Ts({id:"insertPrevSuggestion",precondition:q.and(I.textInputFocus,q.equals("config.editor.tabCompletion","on"),nm.OtherSuggestions,$e.Visible.toNegated(),xs.InSnippetMode.toNegated()),handler:s=>s.acceptPrevSuggestion(),kbOpts:{weight:Ko,kbExpr:I.textInputFocus,primary:1026}}));Q(class extends ge{constructor(){super({id:"editor.action.resetSuggestSize",label:p("suggest.reset.label","Reset Suggest Widget Size"),alias:"Reset Suggest Widget Size",precondition:void 0})}run(s,e){Kr.get(e)?.resetWidgetSize()}});class yDe extends B{get selectedItem(){return this._currentSuggestItemInfo}constructor(e,t,i){super(),this.editor=e,this.suggestControllerPreselector=t,this.onWillAccept=i,this.isSuggestWidgetVisible=!1,this.isShiftKeyPressed=!1,this._isActive=!1,this._currentSuggestItemInfo=void 0,this._onDidSelectedItemChange=this._register(new O),this.onDidSelectedItemChange=this._onDidSelectedItemChange.event,this._register(e.onKeyDown(o=>{o.shiftKey&&!this.isShiftKeyPressed&&(this.isShiftKeyPressed=!0,this.update(this._isActive))})),this._register(e.onKeyUp(o=>{o.shiftKey&&this.isShiftKeyPressed&&(this.isShiftKeyPressed=!1,this.update(this._isActive))}));const n=Kr.get(this.editor);if(n){this._register(n.registerSelector({priority:100,select:(a,l,c)=>{const d=this.editor.getModel();if(!d)return-1;const h=this.suggestControllerPreselector(),u=h?Bu(h,d):void 0;if(!u)return-1;const g=P.lift(l),f=c.map((_,b)=>{const v=xb.fromSuggestion(n,d,g,_,this.isShiftKeyPressed),C=Bu(v.toSingleTextEdit(),d),y=MK(u,C);return{index:b,valid:y,prefixLength:C.text.length,suggestItem:_}}).filter(_=>_&&_.valid&&_.prefixLength>0),m=g2(f,bs(_=>_.prefixLength,qr));return m?m.index:-1}}));let o=!1;const r=()=>{o||(o=!0,this._register(n.widget.value.onDidShow(()=>{this.isSuggestWidgetVisible=!0,this.update(!0)})),this._register(n.widget.value.onDidHide(()=>{this.isSuggestWidgetVisible=!1,this.update(!1)})),this._register(n.widget.value.onDidFocus(()=>{this.isSuggestWidgetVisible=!0,this.update(!0)})))};this._register(se.once(n.model.onDidTrigger)(a=>{r()})),this._register(n.onWillInsertSuggestItem(a=>{const l=this.editor.getPosition(),c=this.editor.getModel();if(!l||!c)return;const d=xb.fromSuggestion(n,c,l,a.item,this.isShiftKeyPressed);this.onWillAccept(d)}))}this.update(this._isActive)}update(e){const t=this.getSuggestItemInfo();(this._isActive!==e||!wDe(this._currentSuggestItemInfo,t))&&(this._isActive=e,this._currentSuggestItemInfo=t,this._onDidSelectedItemChange.fire())}getSuggestItemInfo(){const e=Kr.get(this.editor);if(!e||!this.isSuggestWidgetVisible)return;const t=e.widget.value.getFocusedItem(),i=this.editor.getPosition(),n=this.editor.getModel();if(!(!t||!i||!n))return xb.fromSuggestion(e,n,i,t.item,this.isShiftKeyPressed)}stopForceRenderingAbove(){Kr.get(this.editor)?.stopForceRenderingAbove()}forceRenderingAbove(){Kr.get(this.editor)?.forceRenderingAbove()}}class xb{static fromSuggestion(e,t,i,n,o){let{insertText:r}=n.completion,a=!1;if(n.completion.insertTextRules&4){const c=new sg().parse(r);c.children.length<100&&US.adjustWhitespace(t,i,!0,c),r=c.toString(),a=!0}const l=e.getOverwriteInfo(n,o);return new xb(k.fromPositions(i.delta(0,-l.overwriteBefore),i.delta(0,Math.max(l.overwriteAfter,0))),r,n.completion.kind,a)}constructor(e,t,i,n){this.range=e,this.insertText=t,this.completionItemKind=i,this.isSnippetText=n}equals(e){return this.range.equalsRange(e.range)&&this.insertText===e.insertText&&this.completionItemKind===e.completionItemKind&&this.isSnippetText===e.isSnippetText}toSelectedSuggestionInfo(){return new w6(this.range,this.insertText,this.completionItemKind,this.isSnippetText)}toSingleTextEdit(){return new Il(this.range,this.insertText)}}function wDe(s,e){return s===e?!0:!s||!e?!1:s.equals(e)}var SDe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Ql=function(s,e){return function(t,i){e(t,i,s)}},iA;let Lr=class extends B{static{iA=this}static{this.ID="editor.contrib.inlineCompletionsController"}static get(e){return e.getContribution(iA.ID)}constructor(e,t,i,n,o,r,a,l,c,d){super(),this.editor=e,this._instantiationService=t,this._contextKeyService=i,this._configurationService=n,this._commandService=o,this._debounceService=r,this._languageFeaturesService=a,this._accessibilitySignalService=l,this._keybindingService=c,this._accessibilityService=d,this._editorObs=ao(this.editor),this._positions=_e(this,u=>this._editorObs.selections.read(u)?.map(g=>g.getEndPosition())??[new P(1,1)]),this._suggestWidgetAdaptor=this._register(new yDe(this.editor,()=>(this._editorObs.forceUpdate(),this.model.get()?.selectedInlineCompletion.get()?.toSingleTextEdit(void 0)),u=>this._editorObs.forceUpdate(g=>{this.model.get()?.handleSuggestAccepted(u)}))),this._suggestWidgetSelectedItem=kt(this,u=>this._suggestWidgetAdaptor.onDidSelectedItemChange(()=>{this._editorObs.forceUpdate(g=>u(void 0))}),()=>this._suggestWidgetAdaptor.selectedItem),this._enabledInConfig=kt(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(62).enabled),this._isScreenReaderEnabled=kt(this,this._accessibilityService.onDidChangeScreenReaderOptimized,()=>this._accessibilityService.isScreenReaderOptimized()),this._editorDictationInProgress=kt(this,this._contextKeyService.onDidChangeContext,()=>this._contextKeyService.getContext(this.editor.getDomNode()).getValue("editorDictation.inProgress")===!0),this._enabled=_e(this,u=>this._enabledInConfig.read(u)&&(!this._isScreenReaderEnabled.read(u)||!this._editorDictationInProgress.read(u))),this._debounceValue=this._debounceService.for(this._languageFeaturesService.inlineCompletionsProvider,"InlineCompletionsDebounce",{min:50,max:50}),this.model=Jn(this,u=>{if(this._editorObs.isReadonly.read(u))return;const g=this._editorObs.model.read(u);return g?this._instantiationService.createInstance(KM,g,this._suggestWidgetSelectedItem,this._editorObs.versionId,this._positions,this._debounceValue,kt(this.editor.onDidChangeConfiguration,()=>this.editor.getOption(119).preview),kt(this.editor.onDidChangeConfiguration,()=>this.editor.getOption(119).previewMode),kt(this.editor.onDidChangeConfiguration,()=>this.editor.getOption(62).mode),this._enabled):void 0}).recomputeInitiallyAndOnChange(this._store),this._ghostTexts=_e(this,u=>this.model.read(u)?.ghostTexts.read(u)??[]),this._stablizedGhostTexts=LDe(this._ghostTexts,this._store),this._ghostTextWidgets=jce(this,this._stablizedGhostTexts,(u,g)=>g.add(this._instantiationService.createInstance(jM,this.editor,{ghostText:u,minReservedLineCount:fr(0),targetTextModel:this.model.map(f=>f?.textModel)}))).recomputeInitiallyAndOnChange(this._store),this._playAccessibilitySignal=km(this),this._fontFamily=kt(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(62).fontFamily),this._register(new ss(this._contextKeyService,this.model)),this._register(HR(this._editorObs.onDidType,(u,g)=>{this._enabled.get()&&this.model.get()?.trigger()})),this._register(this._commandService.onDidExecuteCommand(u=>{new Set([dp.Tab.id,dp.DeleteLeft.id,dp.DeleteRight.id,OZ,"acceptSelectedSuggestion"]).has(u.commandId)&&e.hasTextFocus()&&this._enabled.get()&&this._editorObs.forceUpdate(f=>{this.model.get()?.trigger(f)})})),this._register(HR(this._editorObs.selections,(u,g)=>{g.some(f=>f.reason===3||f.source==="api")&&this.model.get()?.stop()})),this._register(this.editor.onDidBlurEditorWidget(()=>{this._contextKeyService.getContextKeyValue("accessibleViewIsShown")||this._configurationService.getValue("editor.inlineSuggest.keepOnBlur")||e.getOption(62).keepOnBlur||Xp.dropDownVisible||ai(u=>{this.model.get()?.stop(u)})})),this._register(Pe(u=>{const g=this.model.read(u)?.state.read(u);g?.suggestItem?g.primaryGhostText.lineCount>=2&&this._suggestWidgetAdaptor.forceRenderingAbove():this._suggestWidgetAdaptor.stopForceRenderingAbove()})),this._register(Ce(()=>{this._suggestWidgetAdaptor.stopForceRenderingAbove()}));const h=PC(this,(u,g)=>{const m=this.model.read(u)?.state.read(u);return this._suggestWidgetSelectedItem.get()?g:m?.inlineCompletion?.semanticId});this._register(bCe(_e(u=>(this._playAccessibilitySignal.read(u),h.read(u),{})),async(u,g,f)=>{const m=this.model.get(),_=m?.state.get();if(!_||!m)return;const b=m.textModel.getLineContent(_.primaryGhostText.lineNumber);await Wc(50,XI(f)),await Xz(this._suggestWidgetSelectedItem,ns,()=>!1,XI(f)),await this._accessibilitySignalService.playSignal(Lt.inlineSuggestion),this.editor.getOption(8)&&this._provideScreenReaderUpdate(_.primaryGhostText.renderForScreenReader(b))})),this._register(new fM(this.editor,this.model,this._instantiationService)),this._register(fke(_e(u=>{const g=this._fontFamily.read(u);return g===""||g==="default"?"":`
.monaco-editor .ghost-text-decoration,
.monaco-editor .ghost-text-decoration-preview,
.monaco-editor .ghost-text {
	font-family: ${g};
}`}))),this._register(this._configurationService.onDidChangeConfiguration(u=>{u.affectsConfiguration("accessibility.verbosity.inlineCompletions")&&this.editor.updateOptions({inlineCompletionsAccessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.inlineCompletions")})})),this.editor.updateOptions({inlineCompletionsAccessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.inlineCompletions")})}playAccessibilitySignal(e){this._playAccessibilitySignal.trigger(e)}_provideScreenReaderUpdate(e){const t=this._contextKeyService.getContextKeyValue("accessibleViewIsShown"),i=this._keybindingService.lookupKeybinding("editor.action.accessibleView");let n;!t&&i&&this.editor.getOption(150)&&(n=p("showAccessibleViewHint","Inspect this in the accessible view ({0})",i.getAriaLabel())),Ls(n?e+", "+n:e)}shouldShowHoverAt(e){const t=this.model.get()?.primaryGhostText.get();return t?t.parts.some(i=>e.containsPosition(new P(t.lineNumber,i.column))):!1}shouldShowHoverAtViewZone(e){return this._ghostTextWidgets.get()[0]?.ownsViewZone(e)??!1}};Lr=iA=SDe([Ql(1,ye),Ql(2,Ee),Ql(3,Ke),Ql(4,Ht),Ql(5,Go),Ql(6,pe),Ql(7,Lh),Ql(8,yt),Ql(9,vo)],Lr);function LDe(s,e){const t=Ze("result",[]),i=[];return e.add(Pe(n=>{const o=s.read(n);ai(r=>{if(o.length!==i.length){i.length=o.length;for(let a=0;a<i.length;a++)i[a]||(i[a]=Ze("item",o[a]));t.set([...i],r)}i.forEach((a,l)=>a.set(o[l],r))})})),t}class v4 extends ge{static{this.ID=BZ}constructor(){super({id:v4.ID,label:p("action.inlineSuggest.showNext","Show Next Inline Suggestion"),alias:"Show Next Inline Suggestion",precondition:q.and(I.writable,ss.inlineSuggestionVisible),kbOpts:{weight:100,primary:606}})}async run(e,t){Lr.get(t)?.model.get()?.next()}}class C4 extends ge{static{this.ID=FZ}constructor(){super({id:C4.ID,label:p("action.inlineSuggest.showPrevious","Show Previous Inline Suggestion"),alias:"Show Previous Inline Suggestion",precondition:q.and(I.writable,ss.inlineSuggestionVisible),kbOpts:{weight:100,primary:604}})}async run(e,t){Lr.get(t)?.model.get()?.previous()}}class xDe extends ge{constructor(){super({id:"editor.action.inlineSuggest.trigger",label:p("action.inlineSuggest.trigger","Trigger Inline Suggestion"),alias:"Trigger Inline Suggestion",precondition:I.writable})}async run(e,t){const i=Lr.get(t);await qz(async n=>{await i?.model.get()?.triggerExplicitly(n),i?.playAccessibilitySignal(n)})}}class kDe extends ge{constructor(){super({id:"editor.action.inlineSuggest.acceptNextWord",label:p("action.inlineSuggest.acceptNextWord","Accept Next Word Of Inline Suggestion"),alias:"Accept Next Word Of Inline Suggestion",precondition:q.and(I.writable,ss.inlineSuggestionVisible),kbOpts:{weight:101,primary:2065,kbExpr:q.and(I.writable,ss.inlineSuggestionVisible)},menuOpts:[{menuId:M.InlineSuggestionToolbar,title:p("acceptWord","Accept Word"),group:"primary",order:2}]})}async run(e,t){const i=Lr.get(t);await i?.model.get()?.acceptNextWord(i.editor)}}class DDe extends ge{constructor(){super({id:"editor.action.inlineSuggest.acceptNextLine",label:p("action.inlineSuggest.acceptNextLine","Accept Next Line Of Inline Suggestion"),alias:"Accept Next Line Of Inline Suggestion",precondition:q.and(I.writable,ss.inlineSuggestionVisible),kbOpts:{weight:101},menuOpts:[{menuId:M.InlineSuggestionToolbar,title:p("acceptLine","Accept Line"),group:"secondary",order:2}]})}async run(e,t){const i=Lr.get(t);await i?.model.get()?.acceptNextLine(i.editor)}}class IDe extends ge{constructor(){super({id:OZ,label:p("action.inlineSuggest.accept","Accept Inline Suggestion"),alias:"Accept Inline Suggestion",precondition:ss.inlineSuggestionVisible,menuOpts:[{menuId:M.InlineSuggestionToolbar,title:p("accept","Accept"),group:"primary",order:1}],kbOpts:{primary:2,weight:200,kbExpr:q.and(ss.inlineSuggestionVisible,I.tabMovesFocus.toNegated(),ss.inlineSuggestionHasIndentationLessThanTabSize,$e.Visible.toNegated(),I.hoverFocused.toNegated())}})}async run(e,t){const i=Lr.get(t);i&&(i.model.get()?.accept(i.editor),i.editor.focus())}}class y4 extends ge{static{this.ID="editor.action.inlineSuggest.hide"}constructor(){super({id:y4.ID,label:p("action.inlineSuggest.hide","Hide Inline Suggestion"),alias:"Hide Inline Suggestion",precondition:ss.inlineSuggestionVisible,kbOpts:{weight:100,primary:9}})}async run(e,t){const i=Lr.get(t);ai(n=>{i?.model.get()?.stop(n)})}}class w4 extends ks{static{this.ID="editor.action.inlineSuggest.toggleAlwaysShowToolbar"}constructor(){super({id:w4.ID,title:p("action.inlineSuggest.alwaysShowToolbar","Always Show Toolbar"),f1:!1,precondition:void 0,menu:[{id:M.InlineSuggestionToolbar,group:"secondary",order:10}],toggled:q.equals("config.editor.inlineSuggest.showToolbar","always")})}async run(e,t){const i=e.get(Ke),o=i.getValue("editor.inlineSuggest.showToolbar")==="always"?"onHover":"always";i.updateValue("editor.inlineSuggest.showToolbar",o)}}var TDe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},g_=function(s,e){return function(t,i){e(t,i,s)}};class EDe{constructor(e,t,i){this.owner=e,this.range=t,this.controller=i}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let nA=class{constructor(e,t,i,n,o,r){this._editor=e,this._languageService=t,this._openerService=i,this.accessibilityService=n,this._instantiationService=o,this._telemetryService=r,this.hoverOrdinal=4}suggestHoverAnchor(e){const t=Lr.get(this._editor);if(!t)return null;const i=e.target;if(i.type===8){const n=i.detail;if(t.shouldShowHoverAtViewZone(n.viewZoneId))return new o1(1e3,this,k.fromPositions(this._editor.getModel().validatePosition(n.positionBefore||n.position)),e.event.posx,e.event.posy,!1)}return i.type===7&&t.shouldShowHoverAt(i.range)?new o1(1e3,this,i.range,e.event.posx,e.event.posy,!1):i.type===6&&i.detail.mightBeForeignElement&&t.shouldShowHoverAt(i.range)?new o1(1e3,this,i.range,e.event.posx,e.event.posy,!1):null}computeSync(e,t){if(this._editor.getOption(62).showToolbar!=="onHover")return[];const i=Lr.get(this._editor);return i&&i.shouldShowHoverAt(e.range)?[new EDe(this,e.range,i)]:[]}renderHoverParts(e,t){const i=new Z,n=t[0];this._telemetryService.publicLog2("inlineCompletionHover.shown"),this.accessibilityService.isScreenReaderOptimized()&&!this._editor.getOption(8)&&i.add(this.renderScreenReaderText(e,n));const o=n.controller.model.get(),r=this._instantiationService.createInstance(Xp,this._editor,!1,fr(null),o.selectedInlineCompletionIndex,o.inlineCompletionsCount,o.activeCommands),a=r.getDomNode();e.fragment.appendChild(a),o.triggerExplicitly(),i.add(r);const l={hoverPart:n,hoverElement:a,dispose(){i.dispose()}};return new lg([l])}renderScreenReaderText(e,t){const i=new Z,n=te,o=n("div.hover-row.markdown-hover"),r=X(o,n("div.hover-contents",{"aria-live":"assertive"})),a=i.add(new zc({editor:this._editor},this._languageService,this._openerService)),l=c=>{i.add(a.onDidRenderAsync(()=>{r.className="hover-contents code-hover-contents",e.onContentsChanged()}));const d=p("inlineSuggestionFollows","Suggestion:"),h=i.add(a.render(new zn().appendText(d).appendCodeblock("text",c)));r.replaceChildren(h.element)};return i.add(Pe(c=>{const d=t.controller.model.read(c)?.primaryGhostText.read(c);if(d){const h=this._editor.getModel().getLineContent(d.lineNumber);l(d.renderForScreenReader(h))}else yn(r)})),e.fragment.appendChild(o),i}};nA=TDe([g_(1,ni),g_(2,Ys),g_(3,vo),g_(4,ye),g_(5,jn)],nA);class NDe{}const ok=new class{constructor(){this._implementations=[]}register(e){return this._implementations.push(e),{dispose:()=>{const t=this._implementations.indexOf(e);t!==-1&&this._implementations.splice(t,1)}}}getImplementations(){return this._implementations}};ct(Lr.ID,Lr,3);Q(xDe);Q(v4);Q(C4);Q(kDe);Q(DDe);Q(IDe);Q(y4);Bt(w4);Dg.register(nA);ok.register(new NDe);var RDe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},LI=function(s,e){return function(t,i){e(t,i,s)}},B_;let Jv=class{static{B_=this}static{this.ID="editor.contrib.gotodefinitionatposition"}static{this.MAX_SOURCE_PREVIEW_LINES=8}constructor(e,t,i,n){this.textModelResolverService=t,this.languageService=i,this.languageFeaturesService=n,this.toUnhook=new Z,this.toUnhookForKeyboard=new Z,this.currentWordAtPosition=null,this.previousPromise=null,this.editor=e,this.linkDecorations=this.editor.createDecorationsCollection();const o=new Gx(e);this.toUnhook.add(o),this.toUnhook.add(o.onMouseMoveOrRelevantKeyDown(([r,a])=>{this.startFindDefinitionFromMouse(r,a??void 0)})),this.toUnhook.add(o.onExecute(r=>{this.isEnabled(r)&&this.gotoDefinition(r.target.position,r.hasSideBySideModifier).catch(a=>{Oe(a)}).finally(()=>{this.removeLinkDecorations()})})),this.toUnhook.add(o.onCancel(()=>{this.removeLinkDecorations(),this.currentWordAtPosition=null}))}static get(e){return e.getContribution(B_.ID)}async startFindDefinitionFromCursor(e){await this.startFindDefinition(e),this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(()=>{this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear()})),this.toUnhookForKeyboard.add(this.editor.onKeyDown(t=>{t&&(this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear())}))}startFindDefinitionFromMouse(e,t){if(e.target.type===9&&this.linkDecorations.length>0)return;if(!this.editor.hasModel()||!this.isEnabled(e,t)){this.currentWordAtPosition=null,this.removeLinkDecorations();return}const i=e.target.position;this.startFindDefinition(i)}async startFindDefinition(e){this.toUnhookForKeyboard.clear();const t=e?this.editor.getModel()?.getWordAtPosition(e):null;if(!t){this.currentWordAtPosition=null,this.removeLinkDecorations();return}if(this.currentWordAtPosition&&this.currentWordAtPosition.startColumn===t.startColumn&&this.currentWordAtPosition.endColumn===t.endColumn&&this.currentWordAtPosition.word===t.word)return;this.currentWordAtPosition=t;const i=new yj(this.editor,15);this.previousPromise&&(this.previousPromise.cancel(),this.previousPromise=null),this.previousPromise=en(r=>this.findDefinition(e,r));let n;try{n=await this.previousPromise}catch(r){Oe(r);return}if(!n||!n.length||!i.validate(this.editor)){this.removeLinkDecorations();return}const o=n[0].originSelectionRange?k.lift(n[0].originSelectionRange):new k(e.lineNumber,t.startColumn,e.lineNumber,t.endColumn);if(n.length>1){let r=o;for(const{originSelectionRange:a}of n)a&&(r=k.plusRange(r,a));this.addDecoration(r,new zn().appendText(p("multipleResults","Click to show {0} definitions.",n.length)))}else{const r=n[0];if(!r.uri)return;this.textModelResolverService.createModelReference(r.uri).then(a=>{if(!a.object||!a.object.textEditorModel){a.dispose();return}const{object:{textEditorModel:l}}=a,{startLineNumber:c}=r.range;if(c<1||c>l.getLineCount()){a.dispose();return}const d=this.getPreviewValue(l,c,r),h=this.languageService.guessLanguageIdByFilepathOrFirstLine(l.uri);this.addDecoration(o,d?new zn().appendCodeblock(h||"",d):void 0),a.dispose()})}}getPreviewValue(e,t,i){let n=i.range;return n.endLineNumber-n.startLineNumber>=B_.MAX_SOURCE_PREVIEW_LINES&&(n=this.getPreviewRangeBasedOnIndentation(e,t)),this.stripIndentationFromPreviewRange(e,t,n)}stripIndentationFromPreviewRange(e,t,i){let o=e.getLineFirstNonWhitespaceColumn(t);for(let a=t+1;a<i.endLineNumber;a++){const l=e.getLineFirstNonWhitespaceColumn(a);o=Math.min(o,l)}return e.getValueInRange(i).replace(new RegExp(`^\\s{${o-1}}`,"gm"),"").trim()}getPreviewRangeBasedOnIndentation(e,t){const i=e.getLineFirstNonWhitespaceColumn(t),n=Math.min(e.getLineCount(),t+B_.MAX_SOURCE_PREVIEW_LINES);let o=t+1;for(;o<n;o++){const r=e.getLineFirstNonWhitespaceColumn(o);if(i===r)break}return new k(t,1,o+1,1)}addDecoration(e,t){const i={range:e,options:{description:"goto-definition-link",inlineClassName:"goto-definition-link",hoverMessage:t}};this.linkDecorations.set([i])}removeLinkDecorations(){this.linkDecorations.clear()}isEnabled(e,t){return this.editor.hasModel()&&e.isLeftClick&&e.isNoneOrSingleMouseDown&&e.target.type===6&&!(e.target.detail.injectedText?.options instanceof dh)&&(e.hasTriggerModifier||(t?t.keyCodeIsTriggerKey:!1))&&this.languageFeaturesService.definitionProvider.has(this.editor.getModel())}findDefinition(e,t){const i=this.editor.getModel();return i?JC(this.languageFeaturesService.definitionProvider,i,e,!1,t):Promise.resolve(null)}gotoDefinition(e,t){return this.editor.setPosition(e),this.editor.invokeWithinContext(i=>{const n=!t&&this.editor.getOption(89)&&!this.isInPeekEditor(i);return new ty({openToSide:t,openInPeek:n,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0}).run(i)})}isInPeekEditor(e){const t=e.get(Ee);return Zs.inPeekEditor.getValue(t)}dispose(){this.toUnhook.dispose(),this.toUnhookForKeyboard.dispose()}};Jv=B_=RDe([LI(1,qs),LI(2,ni),LI(3,pe)],Jv);ct(Jv.ID,Jv,2);var PK=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},ZS=function(s,e){return function(t,i){e(t,i,s)}};class _8{constructor(e,t,i){this.marker=e,this.index=t,this.total=i}}let sA=class{constructor(e,t,i){this._markerService=t,this._configService=i,this._onDidChange=new O,this.onDidChange=this._onDidChange.event,this._dispoables=new Z,this._markers=[],this._nextIdx=-1,Se.isUri(e)?this._resourceFilter=a=>a.toString()===e.toString():e&&(this._resourceFilter=e);const n=this._configService.getValue("problems.sortOrder"),o=(a,l)=>{let c=Zb(a.resource.toString(),l.resource.toString());return c===0&&(n==="position"?c=k.compareRangesUsingStarts(a,l)||bi.compare(a.severity,l.severity):c=bi.compare(a.severity,l.severity)||k.compareRangesUsingStarts(a,l)),c},r=()=>{this._markers=this._markerService.read({resource:Se.isUri(e)?e:void 0,severities:bi.Error|bi.Warning|bi.Info}),typeof e=="function"&&(this._markers=this._markers.filter(a=>this._resourceFilter(a.resource))),this._markers.sort(o)};r(),this._dispoables.add(t.onMarkerChanged(a=>{(!this._resourceFilter||a.some(l=>this._resourceFilter(l)))&&(r(),this._nextIdx=-1,this._onDidChange.fire())}))}dispose(){this._dispoables.dispose(),this._onDidChange.dispose()}matches(e){return!this._resourceFilter&&!e?!0:!this._resourceFilter||!e?!1:this._resourceFilter(e)}get selected(){const e=this._markers[this._nextIdx];return e&&new _8(e,this._nextIdx+1,this._markers.length)}_initIdx(e,t,i){let n=!1,o=this._markers.findIndex(r=>r.resource.toString()===e.uri.toString());o<0&&(o=Bb(this._markers,{resource:e.uri},(r,a)=>Zb(r.resource.toString(),a.resource.toString())),o<0&&(o=~o));for(let r=o;r<this._markers.length;r++){let a=k.lift(this._markers[r]);if(a.isEmpty()){const l=e.getWordAtPosition(a.getStartPosition());l&&(a=new k(a.startLineNumber,l.startColumn,a.startLineNumber,l.endColumn))}if(t&&(a.containsPosition(t)||t.isBeforeOrEqual(a.getStartPosition()))){this._nextIdx=r,n=!0;break}if(this._markers[r].resource.toString()!==e.uri.toString())break}n||(this._nextIdx=i?0:this._markers.length-1),this._nextIdx<0&&(this._nextIdx=this._markers.length-1)}resetIndex(){this._nextIdx=-1}move(e,t,i){if(this._markers.length===0)return!1;const n=this._nextIdx;return this._nextIdx===-1?this._initIdx(t,i,e):e?this._nextIdx=(this._nextIdx+1)%this._markers.length:e||(this._nextIdx=(this._nextIdx-1+this._markers.length)%this._markers.length),n!==this._nextIdx}find(e,t){let i=this._markers.findIndex(n=>n.resource.toString()===e.toString());if(!(i<0)){for(;i<this._markers.length;i++)if(k.containsPosition(this._markers[i],t))return new _8(this._markers[i],i+1,this._markers.length)}}};sA=PK([ZS(1,zl),ZS(2,Ke)],sA);const OK=Je("IMarkerNavigationService");let oA=class{constructor(e,t){this._markerService=e,this._configService=t,this._provider=new fs}getMarkerList(e){for(const t of this._provider){const i=t.getMarkerList(e);if(i)return i}return new sA(e,this._markerService,this._configService)}};oA=PK([ZS(0,zl),ZS(1,Ke)],oA);nt(OK,oA,1);var rA;(function(s){function e(t){switch(t){case Di.Ignore:return"severity-ignore "+Ie.asClassName(J.info);case Di.Info:return Ie.asClassName(J.info);case Di.Warning:return Ie.asClassName(J.warning);case Di.Error:return Ie.asClassName(J.error);default:return""}}s.className=e})(rA||(rA={}));var MDe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},sf=function(s,e){return function(t,i){e(t,i,s)}},aA;class ADe{constructor(e,t,i,n,o){this._openerService=n,this._labelService=o,this._lines=0,this._longestLineLength=0,this._relatedDiagnostics=new WeakMap,this._disposables=new Z,this._editor=t;const r=document.createElement("div");r.className="descriptioncontainer",this._messageBlock=document.createElement("div"),this._messageBlock.classList.add("message"),this._messageBlock.setAttribute("aria-live","assertive"),this._messageBlock.setAttribute("role","alert"),r.appendChild(this._messageBlock),this._relatedBlock=document.createElement("div"),r.appendChild(this._relatedBlock),this._disposables.add(gi(this._relatedBlock,"click",a=>{a.preventDefault();const l=this._relatedDiagnostics.get(a.target);l&&i(l)})),this._scrollable=new Cz(r,{horizontal:1,vertical:1,useShadows:!1,horizontalScrollbarSize:6,verticalScrollbarSize:6}),e.appendChild(this._scrollable.getDomNode()),this._disposables.add(this._scrollable.onScroll(a=>{r.style.left=`-${a.scrollLeft}px`,r.style.top=`-${a.scrollTop}px`})),this._disposables.add(this._scrollable)}dispose(){At(this._disposables)}update(e){const{source:t,message:i,relatedInformation:n,code:o}=e;let r=(t?.length||0)+2;o&&(typeof o=="string"?r+=o.length:r+=o.value.length);const a=Fl(i);this._lines=a.length,this._longestLineLength=0;for(const u of a)this._longestLineLength=Math.max(u.length+r,this._longestLineLength);Cn(this._messageBlock),this._messageBlock.setAttribute("aria-label",this.getAriaLabel(e)),this._editor.applyFontInfo(this._messageBlock);let l=this._messageBlock;for(const u of a)l=document.createElement("div"),l.innerText=u,u===""&&(l.style.height=this._messageBlock.style.lineHeight),this._messageBlock.appendChild(l);if(t||o){const u=document.createElement("span");if(u.classList.add("details"),l.appendChild(u),t){const g=document.createElement("span");g.innerText=t,g.classList.add("source"),u.appendChild(g)}if(o)if(typeof o=="string"){const g=document.createElement("span");g.innerText=`(${o})`,g.classList.add("code"),u.appendChild(g)}else{this._codeLink=te("a.code-link"),this._codeLink.setAttribute("href",`${o.target.toString()}`),this._codeLink.onclick=f=>{this._openerService.open(o.target,{allowCommands:!0}),f.preventDefault(),f.stopPropagation()};const g=X(this._codeLink,te("span"));g.innerText=o.value,u.appendChild(this._codeLink)}}if(Cn(this._relatedBlock),this._editor.applyFontInfo(this._relatedBlock),os(n)){const u=this._relatedBlock.appendChild(document.createElement("div"));u.style.paddingTop=`${Math.floor(this._editor.getOption(67)*.66)}px`,this._lines+=1;for(const g of n){const f=document.createElement("div"),m=document.createElement("a");m.classList.add("filename"),m.innerText=`${this._labelService.getUriBasenameLabel(g.resource)}(${g.startLineNumber}, ${g.startColumn}): `,m.title=this._labelService.getUriLabel(g.resource),this._relatedDiagnostics.set(m,g);const _=document.createElement("span");_.innerText=g.message,f.appendChild(m),f.appendChild(_),this._lines+=1,u.appendChild(f)}}const c=this._editor.getOption(50),d=Math.ceil(c.typicalFullwidthCharacterWidth*this._longestLineLength*.75),h=c.lineHeight*this._lines;this._scrollable.setScrollDimensions({scrollWidth:d,scrollHeight:h})}layout(e,t){this._scrollable.getDomNode().style.height=`${e}px`,this._scrollable.getDomNode().style.width=`${t}px`,this._scrollable.setScrollDimensions({width:t,height:e})}getHeightInLines(){return Math.min(17,this._lines)}getAriaLabel(e){let t="";switch(e.severity){case bi.Error:t=p("Error","Error");break;case bi.Warning:t=p("Warning","Warning");break;case bi.Info:t=p("Info","Info");break;case bi.Hint:t=p("Hint","Hint");break}let i=p("marker aria","{0} at {1}. ",t,e.startLineNumber+":"+e.startColumn);const n=this._editor.getModel();return n&&e.startLineNumber<=n.getLineCount()&&e.startLineNumber>=1&&(i=`${n.getLineContent(e.startLineNumber)}, ${i}`),i}}let eC=class extends RS{static{aA=this}static{this.TitleMenu=new M("gotoErrorTitleMenu")}constructor(e,t,i,n,o,r,a){super(e,{showArrow:!0,showFrame:!0,isAccessible:!0,frameWidth:1},o),this._themeService=t,this._openerService=i,this._menuService=n,this._contextKeyService=r,this._labelService=a,this._callOnDispose=new Z,this._onDidSelectRelatedInformation=new O,this.onDidSelectRelatedInformation=this._onDidSelectRelatedInformation.event,this._severity=bi.Warning,this._backgroundColor=G.white,this._applyTheme(t.getColorTheme()),this._callOnDispose.add(t.onDidColorThemeChange(this._applyTheme.bind(this))),this.create()}_applyTheme(e){this._backgroundColor=e.getColor(BDe);let t=lA,i=PDe;this._severity===bi.Warning?(t=c1,i=ODe):this._severity===bi.Info&&(t=cA,i=FDe);const n=e.getColor(t),o=e.getColor(i);this.style({arrowColor:n,frameColor:n,headerBackgroundColor:o,primaryHeadingColor:e.getColor(qZ),secondaryHeadingColor:e.getColor(GZ)})}_applyStyles(){this._parentContainer&&(this._parentContainer.style.backgroundColor=this._backgroundColor?this._backgroundColor.toString():""),super._applyStyles()}dispose(){this._callOnDispose.dispose(),super.dispose()}_fillHead(e){super._fillHead(e),this._disposables.add(this._actionbarWidget.actionRunner.onWillRun(n=>this.editor.focus()));const t=[],i=this._menuService.getMenuActions(aA.TitleMenu,this._contextKeyService);cx(i,t),this._actionbarWidget.push(t,{label:!1,icon:!0,index:0})}_fillTitleIcon(e){this._icon=X(e,te(""))}_fillBody(e){this._parentContainer=e,e.classList.add("marker-widget"),this._parentContainer.tabIndex=0,this._parentContainer.setAttribute("role","tooltip"),this._container=document.createElement("div"),e.appendChild(this._container),this._message=new ADe(this._container,this.editor,t=>this._onDidSelectRelatedInformation.fire(t),this._openerService,this._labelService),this._disposables.add(this._message)}show(){throw new Error("call showAtMarker")}showAtMarker(e,t,i){this._container.classList.remove("stale"),this._message.update(e),this._severity=e.severity,this._applyTheme(this._themeService.getColorTheme());const n=k.lift(e),o=this.editor.getPosition(),r=o&&n.containsPosition(o)?o:n.getStartPosition();super.show(r,this.computeRequiredHeight());const a=this.editor.getModel();if(a){const l=i>1?p("problems","{0} of {1} problems",t,i):p("change","{0} of {1} problem",t,i);this.setTitle(wr(a.uri),l)}this._icon.className=`codicon ${rA.className(bi.toSeverity(this._severity))}`,this.editor.revealPositionNearTop(r,0),this.editor.focus()}updateMarker(e){this._container.classList.remove("stale"),this._message.update(e)}showStale(){this._container.classList.add("stale"),this._relayout()}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._heightInPixel=e,this._message.layout(e,t),this._container.style.height=`${e}px`}_onWidth(e){this._message.layout(this._heightInPixel,e)}_relayout(){super._relayout(this.computeRequiredHeight())}computeRequiredHeight(){return 3+this._message.getHeightInLines()}};eC=aA=MDe([sf(1,Ki),sf(2,Ys),sf(3,qo),sf(4,ye),sf(5,Ee),sf(6,Pp)],eC);const b8=iv($L,xoe),v8=iv(Vc,nv),C8=iv(El,sv),lA=E("editorMarkerNavigationError.background",{dark:b8,light:b8,hcDark:lt,hcLight:lt},p("editorMarkerNavigationError","Editor marker navigation widget error color.")),PDe=E("editorMarkerNavigationError.headerBackground",{dark:je(lA,.1),light:je(lA,.1),hcDark:null,hcLight:null},p("editorMarkerNavigationErrorHeaderBackground","Editor marker navigation widget error heading background.")),c1=E("editorMarkerNavigationWarning.background",{dark:v8,light:v8,hcDark:lt,hcLight:lt},p("editorMarkerNavigationWarning","Editor marker navigation widget warning color.")),ODe=E("editorMarkerNavigationWarning.headerBackground",{dark:je(c1,.1),light:je(c1,.1),hcDark:"#0C141F",hcLight:je(c1,.2)},p("editorMarkerNavigationWarningBackground","Editor marker navigation widget warning heading background.")),cA=E("editorMarkerNavigationInfo.background",{dark:C8,light:C8,hcDark:lt,hcLight:lt},p("editorMarkerNavigationInfo","Editor marker navigation widget info color.")),FDe=E("editorMarkerNavigationInfo.headerBackground",{dark:je(cA,.1),light:je(cA,.1),hcDark:null,hcLight:null},p("editorMarkerNavigationInfoHeaderBackground","Editor marker navigation widget info heading background.")),BDe=E("editorMarkerNavigation.background",ea,p("editorMarkerNavigationBackground","Editor marker navigation widget background."));var WDe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Cw=function(s,e){return function(t,i){e(t,i,s)}},W_;let hg=class{static{W_=this}static{this.ID="editor.contrib.markerController"}static get(e){return e.getContribution(W_.ID)}constructor(e,t,i,n,o){this._markerNavigationService=t,this._contextKeyService=i,this._editorService=n,this._instantiationService=o,this._sessionDispoables=new Z,this._editor=e,this._widgetVisible=FK.bindTo(this._contextKeyService)}dispose(){this._cleanUp(),this._sessionDispoables.dispose()}_cleanUp(){this._widgetVisible.reset(),this._sessionDispoables.clear(),this._widget=void 0,this._model=void 0}_getOrCreateModel(e){if(this._model&&this._model.matches(e))return this._model;let t=!1;return this._model&&(t=!0,this._cleanUp()),this._model=this._markerNavigationService.getMarkerList(e),t&&this._model.move(!0,this._editor.getModel(),this._editor.getPosition()),this._widget=this._instantiationService.createInstance(eC,this._editor),this._widget.onDidClose(()=>this.close(),this,this._sessionDispoables),this._widgetVisible.set(!0),this._sessionDispoables.add(this._model),this._sessionDispoables.add(this._widget),this._sessionDispoables.add(this._editor.onDidChangeCursorPosition(i=>{(!this._model?.selected||!k.containsPosition(this._model?.selected.marker,i.position))&&this._model?.resetIndex()})),this._sessionDispoables.add(this._model.onDidChange(()=>{if(!this._widget||!this._widget.position||!this._model)return;const i=this._model.find(this._editor.getModel().uri,this._widget.position);i?this._widget.updateMarker(i.marker):this._widget.showStale()})),this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation(i=>{this._editorService.openCodeEditor({resource:i.resource,options:{pinned:!0,revealIfOpened:!0,selection:k.lift(i).collapseToStart()}},this._editor),this.close(!1)})),this._sessionDispoables.add(this._editor.onDidChangeModel(()=>this._cleanUp())),this._model}close(e=!0){this._cleanUp(),e&&this._editor.focus()}showAtMarker(e){if(this._editor.hasModel()){const t=this._getOrCreateModel(this._editor.getModel().uri);t.resetIndex(),t.move(!0,this._editor.getModel(),new P(e.startLineNumber,e.startColumn)),t.selected&&this._widget.showAtMarker(t.selected.marker,t.selected.index,t.selected.total)}}async nagivate(e,t){if(this._editor.hasModel()){const i=this._getOrCreateModel(t?void 0:this._editor.getModel().uri);if(i.move(e,this._editor.getModel(),this._editor.getPosition()),!i.selected)return;if(i.selected.marker.resource.toString()!==this._editor.getModel().uri.toString()){this._cleanUp();const n=await this._editorService.openCodeEditor({resource:i.selected.marker.resource,options:{pinned:!1,revealIfOpened:!0,selectionRevealType:2,selection:i.selected.marker}},this._editor);n&&(W_.get(n)?.close(),W_.get(n)?.nagivate(e,t))}else this._widget.showAtMarker(i.selected.marker,i.selected.index,i.selected.total)}}};hg=W_=WDe([Cw(1,OK),Cw(2,Ee),Cw(3,ft),Cw(4,ye)],hg);class rk extends ge{constructor(e,t,i){super(i),this._next=e,this._multiFile=t}async run(e,t){t.hasModel()&&hg.get(t)?.nagivate(this._next,this._multiFile)}}class pp extends rk{static{this.ID="editor.action.marker.next"}static{this.LABEL=p("markerAction.next.label","Go to Next Problem (Error, Warning, Info)")}constructor(){super(!0,!1,{id:pp.ID,label:pp.LABEL,alias:"Go to Next Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:I.focus,primary:578,weight:100},menuOpts:{menuId:eC.TitleMenu,title:pp.LABEL,icon:Kt("marker-navigation-next",J.arrowDown,p("nextMarkerIcon","Icon for goto next marker.")),group:"navigation",order:1}})}}class kb extends rk{static{this.ID="editor.action.marker.prev"}static{this.LABEL=p("markerAction.previous.label","Go to Previous Problem (Error, Warning, Info)")}constructor(){super(!1,!1,{id:kb.ID,label:kb.LABEL,alias:"Go to Previous Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:I.focus,primary:1602,weight:100},menuOpts:{menuId:eC.TitleMenu,title:kb.LABEL,icon:Kt("marker-navigation-previous",J.arrowUp,p("previousMarkerIcon","Icon for goto previous marker.")),group:"navigation",order:2}})}}class HDe extends rk{constructor(){super(!0,!0,{id:"editor.action.marker.nextInFiles",label:p("markerAction.nextInFiles.label","Go to Next Problem in Files (Error, Warning, Info)"),alias:"Go to Next Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:I.focus,primary:66,weight:100},menuOpts:{menuId:M.MenubarGoMenu,title:p({key:"miGotoNextProblem",comment:["&& denotes a mnemonic"]},"Next &&Problem"),group:"6_problem_nav",order:1}})}}class VDe extends rk{constructor(){super(!1,!0,{id:"editor.action.marker.prevInFiles",label:p("markerAction.previousInFiles.label","Go to Previous Problem in Files (Error, Warning, Info)"),alias:"Go to Previous Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:I.focus,primary:1090,weight:100},menuOpts:{menuId:M.MenubarGoMenu,title:p({key:"miGotoPreviousProblem",comment:["&& denotes a mnemonic"]},"Previous &&Problem"),group:"6_problem_nav",order:2}})}}ct(hg.ID,hg,4);Q(pp);Q(kb);Q(HDe);Q(VDe);const FK=new le("markersNavigationVisible",!1),zDe=Zi.bindToContribution(hg.get);ae(new zDe({id:"closeMarkersNavigation",precondition:FK,handler:s=>s.close(),kbOpts:{weight:150,kbExpr:I.focus,primary:9,secondary:[1033]}}));var _a;(function(s){s.NoAutoFocus="noAutoFocus",s.FocusIfVisible="focusIfVisible",s.AutoFocusImmediately="autoFocusImmediately"})(_a||(_a={}));class UDe extends ge{constructor(){super({id:PZ,label:p({key:"showOrFocusHover",comment:["Label for action that will trigger the showing/focusing of a hover in the editor.","If the hover is not visible, it will show the hover.","This allows for users to show the hover without using the mouse."]},"Show or Focus Hover"),metadata:{description:Re("showOrFocusHoverDescription","Show or focus the editor hover which shows documentation, references, and other content for a symbol at the current cursor position."),args:[{name:"args",schema:{type:"object",properties:{focus:{description:"Controls if and when the hover should take focus upon being triggered by this action.",enum:[_a.NoAutoFocus,_a.FocusIfVisible,_a.AutoFocusImmediately],enumDescriptions:[p("showOrFocusHover.focus.noAutoFocus","The hover will not automatically take focus."),p("showOrFocusHover.focus.focusIfVisible","The hover will take focus only if it is already visible."),p("showOrFocusHover.focus.autoFocusImmediately","The hover will automatically take focus when it appears.")],default:_a.FocusIfVisible}}}}]},alias:"Show or Focus Hover",precondition:void 0,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2087),weight:100}})}run(e,t,i){if(!t.hasModel())return;const n=as.get(t);if(!n)return;const o=i?.focus;let r=_a.FocusIfVisible;Object.values(_a).includes(o)?r=o:typeof o=="boolean"&&o&&(r=_a.AutoFocusImmediately);const a=c=>{const d=t.getPosition(),h=new k(d.lineNumber,d.column,d.lineNumber,d.column);n.showContentHover(h,1,1,c)},l=t.getOption(2)===2;n.isHoverVisible?r!==_a.NoAutoFocus?n.focus():a(l):a(l||r===_a.AutoFocusImmediately)}}class $De extends ge{constructor(){super({id:rSe,label:p({key:"showDefinitionPreviewHover",comment:["Label for action that will trigger the showing of definition preview hover in the editor.","This allows for users to show the definition preview hover without using the mouse."]},"Show Definition Preview Hover"),alias:"Show Definition Preview Hover",precondition:void 0,metadata:{description:Re("showDefinitionPreviewHoverDescription","Show the definition preview hover in the editor.")}})}run(e,t){const i=as.get(t);if(!i)return;const n=t.getPosition();if(!n)return;const o=new k(n.lineNumber,n.column,n.lineNumber,n.column),r=Jv.get(t);if(!r)return;r.startFindDefinitionFromCursor(n).then(()=>{i.showContentHover(o,1,1,!0)})}}class jDe extends ge{constructor(){super({id:aSe,label:p({key:"scrollUpHover",comment:["Action that allows to scroll up in the hover widget with the up arrow when the hover widget is focused."]},"Scroll Up Hover"),alias:"Scroll Up Hover",precondition:I.hoverFocused,kbOpts:{kbExpr:I.hoverFocused,primary:16,weight:100},metadata:{description:Re("scrollUpHoverDescription","Scroll up the editor hover.")}})}run(e,t){const i=as.get(t);i&&i.scrollUp()}}class ZDe extends ge{constructor(){super({id:lSe,label:p({key:"scrollDownHover",comment:["Action that allows to scroll down in the hover widget with the up arrow when the hover widget is focused."]},"Scroll Down Hover"),alias:"Scroll Down Hover",precondition:I.hoverFocused,kbOpts:{kbExpr:I.hoverFocused,primary:18,weight:100},metadata:{description:Re("scrollDownHoverDescription","Scroll down the editor hover.")}})}run(e,t){const i=as.get(t);i&&i.scrollDown()}}class KDe extends ge{constructor(){super({id:cSe,label:p({key:"scrollLeftHover",comment:["Action that allows to scroll left in the hover widget with the left arrow when the hover widget is focused."]},"Scroll Left Hover"),alias:"Scroll Left Hover",precondition:I.hoverFocused,kbOpts:{kbExpr:I.hoverFocused,primary:15,weight:100},metadata:{description:Re("scrollLeftHoverDescription","Scroll left the editor hover.")}})}run(e,t){const i=as.get(t);i&&i.scrollLeft()}}class qDe extends ge{constructor(){super({id:dSe,label:p({key:"scrollRightHover",comment:["Action that allows to scroll right in the hover widget with the right arrow when the hover widget is focused."]},"Scroll Right Hover"),alias:"Scroll Right Hover",precondition:I.hoverFocused,kbOpts:{kbExpr:I.hoverFocused,primary:17,weight:100},metadata:{description:Re("scrollRightHoverDescription","Scroll right the editor hover.")}})}run(e,t){const i=as.get(t);i&&i.scrollRight()}}class GDe extends ge{constructor(){super({id:hSe,label:p({key:"pageUpHover",comment:["Action that allows to page up in the hover widget with the page up command when the hover widget is focused."]},"Page Up Hover"),alias:"Page Up Hover",precondition:I.hoverFocused,kbOpts:{kbExpr:I.hoverFocused,primary:11,secondary:[528],weight:100},metadata:{description:Re("pageUpHoverDescription","Page up the editor hover.")}})}run(e,t){const i=as.get(t);i&&i.pageUp()}}class YDe extends ge{constructor(){super({id:uSe,label:p({key:"pageDownHover",comment:["Action that allows to page down in the hover widget with the page down command when the hover widget is focused."]},"Page Down Hover"),alias:"Page Down Hover",precondition:I.hoverFocused,kbOpts:{kbExpr:I.hoverFocused,primary:12,secondary:[530],weight:100},metadata:{description:Re("pageDownHoverDescription","Page down the editor hover.")}})}run(e,t){const i=as.get(t);i&&i.pageDown()}}class XDe extends ge{constructor(){super({id:gSe,label:p({key:"goToTopHover",comment:["Action that allows to go to the top of the hover widget with the home command when the hover widget is focused."]},"Go To Top Hover"),alias:"Go To Bottom Hover",precondition:I.hoverFocused,kbOpts:{kbExpr:I.hoverFocused,primary:14,secondary:[2064],weight:100},metadata:{description:Re("goToTopHoverDescription","Go to the top of the editor hover.")}})}run(e,t){const i=as.get(t);i&&i.goToTop()}}class QDe extends ge{constructor(){super({id:fSe,label:p({key:"goToBottomHover",comment:["Action that allows to go to the bottom in the hover widget with the end command when the hover widget is focused."]},"Go To Bottom Hover"),alias:"Go To Bottom Hover",precondition:I.hoverFocused,kbOpts:{kbExpr:I.hoverFocused,primary:13,secondary:[2066],weight:100},metadata:{description:Re("goToBottomHoverDescription","Go to the bottom of the editor hover.")}})}run(e,t){const i=as.get(t);i&&i.goToBottom()}}class JDe extends ge{constructor(){super({id:Zx,label:pSe,alias:"Increase Hover Verbosity Level",precondition:I.hoverVisible})}run(e,t,i){const n=as.get(t);if(!n)return;const o=i?.index!==void 0?i.index:n.focusedHoverPartIndex();n.updateHoverVerbosityLevel(oo.Increase,o,i?.focus)}}class eIe extends ge{constructor(){super({id:Kx,label:mSe,alias:"Decrease Hover Verbosity Level",precondition:I.hoverVisible})}run(e,t,i){const n=as.get(t);if(!n)return;const o=i?.index!==void 0?i.index:n.focusedHoverPartIndex();as.get(t)?.updateHoverVerbosityLevel(oo.Decrease,o,i?.focus)}}var tIe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},xI=function(s,e){return function(t,i){e(t,i,s)}};const Mr=te;class iIe{constructor(e,t,i){this.owner=e,this.range=t,this.marker=i}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}const y8={type:1,filter:{include:Yt.QuickFix},triggerAction:_o.QuickFixHover};let dA=class{constructor(e,t,i,n){this._editor=e,this._markerDecorationsService=t,this._openerService=i,this._languageFeaturesService=n,this.hoverOrdinal=1,this.recentMarkerCodeActionsInfo=void 0}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1&&!e.supportsMarkerHover)return[];const i=this._editor.getModel(),n=e.range.startLineNumber,o=i.getLineMaxColumn(n),r=[];for(const a of t){const l=a.range.startLineNumber===n?a.range.startColumn:1,c=a.range.endLineNumber===n?a.range.endColumn:o,d=this._markerDecorationsService.getMarker(i.uri,a);if(!d)continue;const h=new k(e.range.startLineNumber,l,e.range.startLineNumber,c);r.push(new iIe(this,h,d))}return r}renderHoverParts(e,t){if(!t.length)return new lg([]);const i=new Z,n=[];t.forEach(r=>{const a=this._renderMarkerHover(r);e.fragment.appendChild(a.hoverElement),n.push(a)});const o=t.length===1?t[0]:t.sort((r,a)=>bi.compare(r.marker.severity,a.marker.severity))[0];return this.renderMarkerStatusbar(e,o,i),new lg(n)}_renderMarkerHover(e){const t=new Z,i=Mr("div.hover-row"),n=X(i,Mr("div.marker.hover-contents")),{source:o,message:r,code:a,relatedInformation:l}=e.marker;this._editor.applyFontInfo(n);const c=X(n,Mr("span"));if(c.style.whiteSpace="pre-wrap",c.innerText=r,o||a)if(a&&typeof a!="string"){const h=Mr("span");if(o){const m=X(h,Mr("span"));m.innerText=o}const u=X(h,Mr("a.code-link"));u.setAttribute("href",a.target.toString()),t.add(U(u,"click",m=>{this._openerService.open(a.target,{allowCommands:!0}),m.preventDefault(),m.stopPropagation()}));const g=X(u,Mr("span"));g.innerText=a.value;const f=X(n,h);f.style.opacity="0.6",f.style.paddingLeft="6px"}else{const h=X(n,Mr("span"));h.style.opacity="0.6",h.style.paddingLeft="6px",h.innerText=o&&a?`${o}(${a})`:o||`(${a})`}if(os(l))for(const{message:h,resource:u,startLineNumber:g,startColumn:f}of l){const m=X(n,Mr("div"));m.style.marginTop="8px";const _=X(m,Mr("a"));_.innerText=`${wr(u)}(${g}, ${f}): `,_.style.cursor="pointer",t.add(U(_,"click",v=>{if(v.stopPropagation(),v.preventDefault(),this._openerService){const C={selection:{startLineNumber:g,startColumn:f}};this._openerService.open(u,{fromUserGesture:!0,editorOptions:C}).catch(Oe)}}));const b=X(m,Mr("span"));b.innerText=h,this._editor.applyFontInfo(b)}return{hoverPart:e,hoverElement:i,dispose:()=>t.dispose()}}renderMarkerStatusbar(e,t,i){if(t.marker.severity===bi.Error||t.marker.severity===bi.Warning||t.marker.severity===bi.Info){const n=hg.get(this._editor);n&&e.statusBar.addAction({label:p("view problem","View Problem"),commandId:pp.ID,run:()=>{e.hide(),n.showAtMarker(t.marker),this._editor.focus()}})}if(!this._editor.getOption(92)){const n=e.statusBar.append(Mr("div"));this.recentMarkerCodeActionsInfo&&(T0.makeKey(this.recentMarkerCodeActionsInfo.marker)===T0.makeKey(t.marker)?this.recentMarkerCodeActionsInfo.hasCodeActions||(n.textContent=p("noQuickFixes","No quick fixes available")):this.recentMarkerCodeActionsInfo=void 0);const o=this.recentMarkerCodeActionsInfo&&!this.recentMarkerCodeActionsInfo.hasCodeActions?B.None:nh(()=>n.textContent=p("checkingForQuickFixes","Checking for quick fixes..."),200,i);n.textContent||(n.textContent="");const r=this.getCodeActions(t.marker);i.add(Ce(()=>r.cancel())),r.then(a=>{if(o.dispose(),this.recentMarkerCodeActionsInfo={marker:t.marker,hasCodeActions:a.validActions.length>0},!this.recentMarkerCodeActionsInfo.hasCodeActions){a.dispose(),n.textContent=p("noQuickFixes","No quick fixes available");return}n.style.display="none";let l=!1;i.add(Ce(()=>{l||a.dispose()})),e.statusBar.addAction({label:p("quick fixes","Quick Fix..."),commandId:VF,run:c=>{l=!0;const d=Gp.get(this._editor),h=Si(c);e.hide(),d?.showCodeActions(y8,a,{x:h.left,y:h.top,width:h.width,height:h.height})}})},Oe)}}getCodeActions(e){return en(t=>Ff(this._languageFeaturesService.codeActionProvider,this._editor.getModel(),new k(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),y8,Sc.None,t))}};dA=tIe([xI(1,iO),xI(2,Ys),xI(3,pe)],dA);class nIe{get lineNumber(){return this._lineNumber}set lineNumber(e){this._lineNumber=e}get lane(){return this._laneOrLine}set lane(e){this._laneOrLine=e}constructor(e){this._editor=e,this._lineNumber=-1,this._laneOrLine=Jr.Center}computeSync(){const e=o=>({value:o}),t=this._editor.getLineDecorations(this._lineNumber),i=[],n=this._laneOrLine==="lineNo";if(!t)return i;for(const o of t){const r=o.options.glyphMargin?.position??Jr.Center;if(!n&&r!==this._laneOrLine)continue;const a=n?o.options.lineNumberHoverMessage:o.options.glyphMarginHoverMessage;!a||Mp(a)||i.push(...xP(a).map(e))}return i}}var sIe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},w8=function(s,e){return function(t,i){e(t,i,s)}},hA;const S8=te;let uA=class extends B{static{hA=this}static{this.ID="editor.contrib.modesGlyphHoverWidget"}constructor(e,t,i){super(),this._renderDisposeables=this._register(new Z),this._editor=e,this._isVisible=!1,this._messages=[],this._hover=this._register(new R2),this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this._markdownRenderer=this._register(new zc({editor:this._editor},t,i)),this._computer=new nIe(this._editor),this._hoverOperation=this._register(new WZ(this._editor,this._computer)),this._register(this._hoverOperation.onResult(n=>{this._withResult(n.value)})),this._register(this._editor.onDidChangeModelDecorations(()=>this._onModelDecorationsChanged())),this._register(this._editor.onDidChangeConfiguration(n=>{n.hasChanged(50)&&this._updateFont()})),this._register(gi(this._hover.containerDomNode,"mouseleave",n=>{this._onMouseLeave(n)})),this._editor.addOverlayWidget(this)}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return hA.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){return null}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach(t=>this._editor.applyFontInfo(t))}_onModelDecorationsChanged(){this._isVisible&&(this._hoverOperation.cancel(),this._hoverOperation.start(0))}showsOrWillShow(e){const t=e.target;return t.type===2&&t.detail.glyphMarginLane?(this._startShowingAt(t.position.lineNumber,t.detail.glyphMarginLane),!0):t.type===3?(this._startShowingAt(t.position.lineNumber,"lineNo"),!0):!1}_startShowingAt(e,t){this._computer.lineNumber===e&&this._computer.lane===t||(this._hoverOperation.cancel(),this.hide(),this._computer.lineNumber=e,this._computer.lane=t,this._hoverOperation.start(0))}hide(){this._computer.lineNumber=-1,this._hoverOperation.cancel(),this._isVisible&&(this._isVisible=!1,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible))}_withResult(e){this._messages=e,this._messages.length>0?this._renderMessages(this._computer.lineNumber,this._messages):this.hide()}_renderMessages(e,t){this._renderDisposeables.clear();const i=document.createDocumentFragment();for(const n of t){const o=S8("div.hover-row.markdown-hover"),r=X(o,S8("div.hover-contents")),a=this._renderDisposeables.add(this._markdownRenderer.render(n.value));r.appendChild(a.element),i.appendChild(o)}this._updateContents(i),this._showAt(e)}_updateContents(e){this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(e),this._updateFont()}_showAt(e){this._isVisible||(this._isVisible=!0,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible));const t=this._editor.getLayoutInfo(),i=this._editor.getTopForLineNumber(e),n=this._editor.getScrollTop(),o=this._editor.getOption(67),r=this._hover.containerDomNode.clientHeight,a=i-n-(r-o)/2,l=t.glyphMarginLeft+t.glyphMarginWidth+(this._computer.lane==="lineNo"?t.lineNumbersWidth:0);this._hover.containerDomNode.style.left=`${l}px`,this._hover.containerDomNode.style.top=`${Math.max(Math.round(a),0)}px`}_onMouseLeave(e){const t=this._editor.getDomNode();(!t||!qx(t,e.x,e.y))&&this.hide()}};uA=hA=sIe([w8(1,ni),w8(2,Ys)],uA);var oIe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},rIe=function(s,e){return function(t,i){e(t,i,s)}};let KS=class extends B{static{this.ID="editor.contrib.marginHover"}constructor(e,t){super(),this._editor=e,this._instantiationService=t,this.shouldKeepOpenOnEditorMouseMoveOrLeave=!1,this._listenersStore=new Z,this._hoverState={mouseDown:!1},this._reactToEditorMouseMoveRunner=this._register(new It(()=>this._reactToEditorMouseMove(this._mouseMoveEvent),0)),this._hookListeners(),this._register(this._editor.onDidChangeConfiguration(i=>{i.hasChanged(60)&&(this._unhookListeners(),this._hookListeners())}))}_hookListeners(){const e=this._editor.getOption(60);this._hoverSettings={enabled:e.enabled,sticky:e.sticky,hidingDelay:e.hidingDelay},e.enabled?(this._listenersStore.add(this._editor.onMouseDown(t=>this._onEditorMouseDown(t))),this._listenersStore.add(this._editor.onMouseUp(()=>this._onEditorMouseUp())),this._listenersStore.add(this._editor.onMouseMove(t=>this._onEditorMouseMove(t))),this._listenersStore.add(this._editor.onKeyDown(t=>this._onKeyDown(t)))):(this._listenersStore.add(this._editor.onMouseMove(t=>this._onEditorMouseMove(t))),this._listenersStore.add(this._editor.onKeyDown(t=>this._onKeyDown(t)))),this._listenersStore.add(this._editor.onMouseLeave(t=>this._onEditorMouseLeave(t))),this._listenersStore.add(this._editor.onDidChangeModel(()=>{this._cancelScheduler(),this._hideWidgets()})),this._listenersStore.add(this._editor.onDidChangeModelContent(()=>this._cancelScheduler())),this._listenersStore.add(this._editor.onDidScrollChange(t=>this._onEditorScrollChanged(t)))}_unhookListeners(){this._listenersStore.clear()}_cancelScheduler(){this._mouseMoveEvent=void 0,this._reactToEditorMouseMoveRunner.cancel()}_onEditorScrollChanged(e){(e.scrollTopChanged||e.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(e){this._hoverState.mouseDown=!0,!this._isMouseOnMarginHoverWidget(e)&&this._hideWidgets()}_isMouseOnMarginHoverWidget(e){const t=this._glyphWidget?.getDomNode();return t?qx(t,e.event.posx,e.event.posy):!1}_onEditorMouseUp(){this._hoverState.mouseDown=!1}_onEditorMouseLeave(e){this.shouldKeepOpenOnEditorMouseMoveOrLeave||(this._cancelScheduler(),this._isMouseOnMarginHoverWidget(e))||this._hideWidgets()}_shouldNotRecomputeCurrentHoverWidget(e){const t=this._hoverSettings.sticky,i=this._isMouseOnMarginHoverWidget(e);return t&&i}_onEditorMouseMove(e){if(this.shouldKeepOpenOnEditorMouseMoveOrLeave)return;if(this._mouseMoveEvent=e,this._shouldNotRecomputeCurrentHoverWidget(e)){this._reactToEditorMouseMoveRunner.cancel();return}this._reactToEditorMouseMove(e)}_reactToEditorMouseMove(e){!e||this._tryShowHoverWidget(e)||this._hideWidgets()}_tryShowHoverWidget(e){return this._getOrCreateGlyphWidget().showsOrWillShow(e)}_onKeyDown(e){this._editor.hasModel()&&(e.keyCode===5||e.keyCode===6||e.keyCode===57||e.keyCode===4||this._hideWidgets())}_hideWidgets(){this._glyphWidget?.hide()}_getOrCreateGlyphWidget(){return this._glyphWidget||(this._glyphWidget=this._instantiationService.createInstance(uA,this._editor)),this._glyphWidget}dispose(){super.dispose(),this._unhookListeners(),this._listenersStore.dispose(),this._glyphWidget?.dispose()}};KS=oIe([rIe(1,ye)],KS);class aIe{}class lIe{}class cIe{}ct(as.ID,as,2);ct(KS.ID,KS,2);Q(UDe);Q($De);Q(jDe);Q(ZDe);Q(KDe);Q(qDe);Q(GDe);Q(YDe);Q(XDe);Q(QDe);Q(JDe);Q(eIe);Dg.register(qv);Dg.register(dA);kr((s,e)=>{const t=s.getColor(az);t&&(e.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${t.transparent(.5)}; }`))});ok.register(new aIe);ok.register(new lIe);ok.register(new cIe);function to(s,e){let t=0;for(let i=0;i<s.length;i++)s.charAt(i)==="	"?t+=e:t++;return t}function Db(s,e,t){s=s<0?0:s;let i="";if(!t){const n=Math.floor(s/e);s=s%e;for(let o=0;o<n;o++)i+="	"}for(let n=0;n<s;n++)i+=" ";return i}function BK(s,e,t,i){if(s.getLineCount()===1&&s.getLineMaxColumn(1)===1)return[];const n=e.getLanguageConfiguration(s.getLanguageId()).indentRulesSupport;if(!n)return[];const o=new qO(s,n,e);for(i=Math.min(i,s.getLineCount());t<=i&&o.shouldIgnore(t);)t++;if(t>i-1)return[];const{tabSize:r,indentSize:a,insertSpaces:l}=s.getOptions(),c=(m,_)=>(_=_||1,Sr.shiftIndent(m,m.length+_,r,a,l)),d=(m,_)=>(_=_||1,Sr.unshiftIndent(m,m.length+_,r,a,l)),h=[],u=s.getLineContent(t);let g=Mt(u),f=g;o.shouldIncrease(t)?(f=c(f),g=c(g)):o.shouldIndentNextLine(t)&&(f=c(f)),t++;for(let m=t;m<=i;m++){if(dIe(s,m))continue;const _=s.getLineContent(m),b=Mt(_),v=f;o.shouldDecrease(m,v)&&(f=d(f),g=d(g)),b!==f&&h.push(ri.replaceMove(new me(m,1,m,b.length+1),nO(f,a,l))),!o.shouldIgnore(m)&&(o.shouldIncrease(m,v)?(g=c(g),f=g):o.shouldIndentNextLine(m,v)?f=c(f):f=g)}return h}function dIe(s,e){return s.tokenization.isCheapToTokenize(e)?s.tokenization.getLineTokens(e).getStandardTokenType(0)===2:!1}var hIe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},uIe=function(s,e){return function(t,i){e(t,i,s)}};class S4 extends ge{static{this.ID="editor.action.indentationToSpaces"}constructor(){super({id:S4.ID,label:p("indentationToSpaces","Convert Indentation to Spaces"),alias:"Convert Indentation to Spaces",precondition:I.writable,metadata:{description:Re("indentationToSpacesDescription","Convert the tab indentation to spaces.")}})}run(e,t){const i=t.getModel();if(!i)return;const n=i.getOptions(),o=t.getSelection();if(!o)return;const r=new _Ie(o,n.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[r]),t.pushUndoStop(),i.updateOptions({insertSpaces:!0})}}class L4 extends ge{static{this.ID="editor.action.indentationToTabs"}constructor(){super({id:L4.ID,label:p("indentationToTabs","Convert Indentation to Tabs"),alias:"Convert Indentation to Tabs",precondition:I.writable,metadata:{description:Re("indentationToTabsDescription","Convert the spaces indentation to tabs.")}})}run(e,t){const i=t.getModel();if(!i)return;const n=i.getOptions(),o=t.getSelection();if(!o)return;const r=new bIe(o,n.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[r]),t.pushUndoStop(),i.updateOptions({insertSpaces:!1})}}class x4 extends ge{constructor(e,t,i){super(i),this.insertSpaces=e,this.displaySizeOnly=t}run(e,t){const i=e.get(Dr),n=e.get(Zt),o=t.getModel();if(!o)return;const r=n.getCreationOptions(o.getLanguageId(),o.uri,o.isForSimpleWidget),a=o.getOptions(),l=[1,2,3,4,5,6,7,8].map(d=>({id:d.toString(),label:d.toString(),description:d===r.tabSize&&d===a.tabSize?p("configuredTabSize","Configured Tab Size"):d===r.tabSize?p("defaultTabSize","Default Tab Size"):d===a.tabSize?p("currentTabSize","Current Tab Size"):void 0})),c=Math.min(o.getOptions().tabSize-1,7);setTimeout(()=>{i.pick(l,{placeHolder:p({key:"selectTabWidth",comment:["Tab corresponds to the tab key"]},"Select Tab Size for Current File"),activeItem:l[c]}).then(d=>{if(d&&o&&!o.isDisposed()){const h=parseInt(d.label,10);this.displaySizeOnly?o.updateOptions({tabSize:h}):o.updateOptions({tabSize:h,indentSize:h,insertSpaces:this.insertSpaces})}})},50)}}class k4 extends x4{static{this.ID="editor.action.indentUsingTabs"}constructor(){super(!1,!1,{id:k4.ID,label:p("indentUsingTabs","Indent Using Tabs"),alias:"Indent Using Tabs",precondition:void 0,metadata:{description:Re("indentUsingTabsDescription","Use indentation with tabs.")}})}}class D4 extends x4{static{this.ID="editor.action.indentUsingSpaces"}constructor(){super(!0,!1,{id:D4.ID,label:p("indentUsingSpaces","Indent Using Spaces"),alias:"Indent Using Spaces",precondition:void 0,metadata:{description:Re("indentUsingSpacesDescription","Use indentation with spaces.")}})}}class I4 extends x4{static{this.ID="editor.action.changeTabDisplaySize"}constructor(){super(!0,!0,{id:I4.ID,label:p("changeTabDisplaySize","Change Tab Display Size"),alias:"Change Tab Display Size",precondition:void 0,metadata:{description:Re("changeTabDisplaySizeDescription","Change the space size equivalent of the tab.")}})}}class T4 extends ge{static{this.ID="editor.action.detectIndentation"}constructor(){super({id:T4.ID,label:p("detectIndentation","Detect Indentation from Content"),alias:"Detect Indentation from Content",precondition:void 0,metadata:{description:Re("detectIndentationDescription","Detect the indentation from content.")}})}run(e,t){const i=e.get(Zt),n=t.getModel();if(!n)return;const o=i.getCreationOptions(n.getLanguageId(),n.uri,n.isForSimpleWidget);n.detectIndentation(o.insertSpaces,o.tabSize)}}class gIe extends ge{constructor(){super({id:"editor.action.reindentlines",label:p("editor.reindentlines","Reindent Lines"),alias:"Reindent Lines",precondition:I.writable,metadata:{description:Re("editor.reindentlinesDescription","Reindent the lines of the editor.")}})}run(e,t){const i=e.get(di),n=t.getModel();if(!n)return;const o=BK(n,i,1,n.getLineCount());o.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,o),t.pushUndoStop())}}class fIe extends ge{constructor(){super({id:"editor.action.reindentselectedlines",label:p("editor.reindentselectedlines","Reindent Selected Lines"),alias:"Reindent Selected Lines",precondition:I.writable,metadata:{description:Re("editor.reindentselectedlinesDescription","Reindent the selected lines of the editor.")}})}run(e,t){const i=e.get(di),n=t.getModel();if(!n)return;const o=t.getSelections();if(o===null)return;const r=[];for(const a of o){let l=a.startLineNumber,c=a.endLineNumber;if(l!==c&&a.endColumn===1&&c--,l===1){if(l===c)continue}else l--;const d=BK(n,i,l,c);r.push(...d)}r.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,r),t.pushUndoStop())}}class pIe{constructor(e,t){this._initialSelection=t,this._edits=[],this._selectionId=null;for(const i of e)i.range&&typeof i.text=="string"&&this._edits.push(i)}getEditOperations(e,t){for(const n of this._edits)t.addEditOperation(k.lift(n.range),n.text);let i=!1;Array.isArray(this._edits)&&this._edits.length===1&&this._initialSelection.isEmpty()&&(this._edits[0].range.startColumn===this._initialSelection.endColumn&&this._edits[0].range.startLineNumber===this._initialSelection.endLineNumber?(i=!0,this._selectionId=t.trackSelection(this._initialSelection,!0)):this._edits[0].range.endColumn===this._initialSelection.startColumn&&this._edits[0].range.endLineNumber===this._initialSelection.startLineNumber&&(i=!0,this._selectionId=t.trackSelection(this._initialSelection,!1))),i||(this._selectionId=t.trackSelection(this._initialSelection))}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}let qS=class{static{this.ID="editor.contrib.autoIndentOnPaste"}constructor(e,t){this.editor=e,this._languageConfigurationService=t,this.callOnDispose=new Z,this.callOnModel=new Z,this.callOnDispose.add(e.onDidChangeConfiguration(()=>this.update())),this.callOnDispose.add(e.onDidChangeModel(()=>this.update())),this.callOnDispose.add(e.onDidChangeModelLanguage(()=>this.update()))}update(){this.callOnModel.clear(),!(this.editor.getOption(12)<4||this.editor.getOption(55))&&this.editor.hasModel()&&this.callOnModel.add(this.editor.onDidPaste(({range:e})=>{this.trigger(e)}))}trigger(e){const t=this.editor.getSelections();if(t===null||t.length>1)return;const i=this.editor.getModel();if(!i||this.rangeContainsOnlyWhitespaceCharacters(i,e)||mIe(i,e)||!i.tokenization.isCheapToTokenize(e.getStartPosition().lineNumber))return;const o=this.editor.getOption(12),{tabSize:r,indentSize:a,insertSpaces:l}=i.getOptions(),c=[],d={shiftIndent:f=>Sr.shiftIndent(f,f.length+1,r,a,l),unshiftIndent:f=>Sr.unshiftIndent(f,f.length+1,r,a,l)};let h=e.startLineNumber;for(;h<=e.endLineNumber;){if(this.shouldIgnoreLine(i,h)){h++;continue}break}if(h>e.endLineNumber)return;let u=i.getLineContent(h);if(!/\S/.test(u.substring(0,e.startColumn-1))){const f=ub(o,i,i.getLanguageId(),h,d,this._languageConfigurationService);if(f!==null){const m=Mt(u),_=to(f,r),b=to(m,r);if(_!==b){const v=Db(_,r,l);c.push({range:new k(h,1,h,m.length+1),text:v}),u=v+u.substring(m.length)}else{const v=Z$(i,h,this._languageConfigurationService);if(v===0||v===8)return}}}const g=h;for(;h<e.endLineNumber;){if(!/\S/.test(i.getLineContent(h+1))){h++;continue}break}if(h!==e.endLineNumber){const m=ub(o,{tokenization:{getLineTokens:_=>i.tokenization.getLineTokens(_),getLanguageId:()=>i.getLanguageId(),getLanguageIdAtPosition:(_,b)=>i.getLanguageIdAtPosition(_,b)},getLineContent:_=>_===g?u:i.getLineContent(_)},i.getLanguageId(),h+1,d,this._languageConfigurationService);if(m!==null){const _=to(m,r),b=to(Mt(i.getLineContent(h+1)),r);if(_!==b){const v=_-b;for(let C=h+1;C<=e.endLineNumber;C++){const y=i.getLineContent(C),w=Mt(y),L=to(w,r)+v,D=Db(L,r,l);D!==w&&c.push({range:new k(C,1,C,w.length+1),text:D})}}}}if(c.length>0){this.editor.pushUndoStop();const f=new pIe(c,this.editor.getSelection());this.editor.executeCommand("autoIndentOnPaste",f),this.editor.pushUndoStop()}}rangeContainsOnlyWhitespaceCharacters(e,t){const i=o=>o.trim().length===0;let n=!0;if(t.startLineNumber===t.endLineNumber){const r=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);n=i(r)}else for(let o=t.startLineNumber;o<=t.endLineNumber;o++){const r=e.getLineContent(o);if(o===t.startLineNumber){const a=r.substring(t.startColumn-1);n=i(a)}else if(o===t.endLineNumber){const a=r.substring(0,t.endColumn-1);n=i(a)}else n=e.getLineFirstNonWhitespaceColumn(o)===0;if(!n)break}return n}shouldIgnoreLine(e,t){e.tokenization.forceTokenization(t);const i=e.getLineFirstNonWhitespaceColumn(t);if(i===0)return!0;const n=e.tokenization.getLineTokens(t);if(n.getCount()>0){const o=n.findTokenIndexAtOffset(i);if(o>=0&&n.getStandardTokenType(o)===1)return!0}return!1}dispose(){this.callOnDispose.dispose(),this.callOnModel.dispose()}};qS=hIe([uIe(1,di)],qS);function mIe(s,e){const t=i=>Rle(s,i)===2;return t(e.getStartPosition())||t(e.getEndPosition())}function WK(s,e,t,i){if(s.getLineCount()===1&&s.getLineMaxColumn(1)===1)return;let n="";for(let r=0;r<t;r++)n+=" ";const o=new RegExp(n,"gi");for(let r=1,a=s.getLineCount();r<=a;r++){let l=s.getLineFirstNonWhitespaceColumn(r);if(l===0&&(l=s.getLineMaxColumn(r)),l===1)continue;const c=new k(r,1,r,l),d=s.getValueInRange(c),h=i?d.replace(/\t/ig,n):d.replace(o,"	");e.addEditOperation(c,h)}}class _Ie{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),WK(e,t,this.tabSize,!0)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}class bIe{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),WK(e,t,this.tabSize,!1)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}ct(qS.ID,qS,2);Q(S4);Q(L4);Q(k4);Q(D4);Q(I4);Q(T4);Q(gIe);Q(fIe);ct(Yv.ID,Yv,1);Dg.register(PS);class vIe{constructor(e,t,i){this._editRange=e,this._originalSelection=t,this._text=i}getEditOperations(e,t){t.addTrackedEditOperation(this._editRange,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return this._originalSelection.isEmpty()?new me(n.endLineNumber,Math.min(this._originalSelection.positionColumn,n.endColumn),n.endLineNumber,Math.min(this._originalSelection.positionColumn,n.endColumn)):new me(n.endLineNumber,n.endColumn-this._text.length,n.endLineNumber,n.endColumn)}}var CIe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},yIe=function(s,e){return function(t,i){e(t,i,s)}},d1;let sm=class{static{d1=this}static{this.ID="editor.contrib.inPlaceReplaceController"}static get(e){return e.getContribution(d1.ID)}static{this.DECORATION=We.register({description:"in-place-replace",className:"valueSetReplacement"})}constructor(e,t){this.editor=e,this.editorWorkerService=t,this.decorations=this.editor.createDecorationsCollection()}dispose(){}run(e,t){this.currentRequest?.cancel();const i=this.editor.getSelection(),n=this.editor.getModel();if(!n||!i)return;let o=i;if(o.startLineNumber!==o.endLineNumber)return;const r=new yj(this.editor,5),a=n.uri;return this.editorWorkerService.canNavigateValueSet(a)?(this.currentRequest=en(l=>this.editorWorkerService.navigateValueSet(a,o,t)),this.currentRequest.then(l=>{if(!l||!l.range||!l.value||!r.validate(this.editor))return;const c=k.lift(l.range);let d=l.range;const h=l.value.length-(o.endColumn-o.startColumn);d={startLineNumber:d.startLineNumber,startColumn:d.startColumn,endLineNumber:d.endLineNumber,endColumn:d.startColumn+l.value.length},h>1&&(o=new me(o.startLineNumber,o.startColumn,o.endLineNumber,o.endColumn+h-1));const u=new vIe(c,o,l.value);this.editor.pushUndoStop(),this.editor.executeCommand(e,u),this.editor.pushUndoStop(),this.decorations.set([{range:d,options:d1.DECORATION}]),this.decorationRemover?.cancel(),this.decorationRemover=Wc(350),this.decorationRemover.then(()=>this.decorations.clear()).catch(Oe)}).catch(Oe)):Promise.resolve(void 0)}};sm=d1=CIe([yIe(1,Xs)],sm);class wIe extends ge{constructor(){super({id:"editor.action.inPlaceReplace.up",label:p("InPlaceReplaceAction.previous.label","Replace with Previous Value"),alias:"Replace with Previous Value",precondition:I.writable,kbOpts:{kbExpr:I.editorTextFocus,primary:3159,weight:100}})}run(e,t){const i=sm.get(t);return i?i.run(this.id,!1):Promise.resolve(void 0)}}class SIe extends ge{constructor(){super({id:"editor.action.inPlaceReplace.down",label:p("InPlaceReplaceAction.next.label","Replace with Next Value"),alias:"Replace with Next Value",precondition:I.writable,kbOpts:{kbExpr:I.editorTextFocus,primary:3161,weight:100}})}run(e,t){const i=sm.get(t);return i?i.run(this.id,!0):Promise.resolve(void 0)}}ct(sm.ID,sm,4);Q(wIe);Q(SIe);class LIe extends ge{constructor(){super({id:"expandLineSelection",label:p("expandLineSelection","Expand Line Selection"),alias:"Expand Line Selection",precondition:void 0,kbOpts:{weight:0,kbExpr:I.textInputFocus,primary:2090}})}run(e,t,i){if(i=i||{},!t.hasModel())return;const n=t._getViewModel();n.model.pushStackElement(),n.setCursorStates(i.source,3,mn.expandLineSelection(n,n.getCursorStates())),n.revealAllCursors(i.source,!0)}}Q(LIe);class xIe{constructor(e,t,i){this._selection=e,this._cursors=t,this._selectionId=null,this._trimInRegexesAndStrings=i}getEditOperations(e,t){const i=kIe(e,this._cursors,this._trimInRegexesAndStrings);for(let n=0,o=i.length;n<o;n++){const r=i[n];t.addEditOperation(r.range,r.text)}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}function kIe(s,e,t){e.sort((a,l)=>a.lineNumber===l.lineNumber?a.column-l.column:a.lineNumber-l.lineNumber);for(let a=e.length-2;a>=0;a--)e[a].lineNumber===e[a+1].lineNumber&&e.splice(a,1);const i=[];let n=0,o=0;const r=e.length;for(let a=1,l=s.getLineCount();a<=l;a++){const c=s.getLineContent(a),d=c.length+1;let h=0;if(o<r&&e[o].lineNumber===a&&(h=e[o].column,o++,h===d)||c.length===0)continue;const u=Na(c);let g=0;if(u===-1)g=1;else if(u!==c.length-1)g=u+2;else continue;if(!t){if(!s.tokenization.hasAccurateTokensForLine(a))continue;const f=s.tokenization.getLineTokens(a),m=f.getStandardTokenType(f.findTokenIndexAtOffset(g));if(m===2||m===3)continue}g=Math.max(h,g),i[n++]=ri.delete(new k(a,g,a,d))}return i}class HK{constructor(e,t,i){this._selection=e,this._isCopyingDown=t,this._noop=i||!1,this._selectionDirection=0,this._selectionId=null,this._startLineNumberDelta=0,this._endLineNumberDelta=0}getEditOperations(e,t){let i=this._selection;this._startLineNumberDelta=0,this._endLineNumberDelta=0,i.startLineNumber<i.endLineNumber&&i.endColumn===1&&(this._endLineNumberDelta=1,i=i.setEndPosition(i.endLineNumber-1,e.getLineMaxColumn(i.endLineNumber-1)));const n=[];for(let r=i.startLineNumber;r<=i.endLineNumber;r++)n.push(e.getLineContent(r));const o=n.join(`
`);o===""&&this._isCopyingDown&&(this._startLineNumberDelta++,this._endLineNumberDelta++),this._noop?t.addEditOperation(new k(i.endLineNumber,e.getLineMaxColumn(i.endLineNumber),i.endLineNumber+1,1),i.endLineNumber===e.getLineCount()?"":`
`):this._isCopyingDown?t.addEditOperation(new k(i.startLineNumber,1,i.startLineNumber,1),o+`
`):t.addEditOperation(new k(i.endLineNumber,e.getLineMaxColumn(i.endLineNumber),i.endLineNumber,e.getLineMaxColumn(i.endLineNumber)),`
`+o),this._selectionId=t.trackSelection(i),this._selectionDirection=this._selection.getDirection()}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);if(this._startLineNumberDelta!==0||this._endLineNumberDelta!==0){let n=i.startLineNumber,o=i.startColumn,r=i.endLineNumber,a=i.endColumn;this._startLineNumberDelta!==0&&(n=n+this._startLineNumberDelta,o=1),this._endLineNumberDelta!==0&&(r=r+this._endLineNumberDelta,a=1),i=me.createWithDirection(n,o,r,a,this._selectionDirection)}return i}}var DIe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},IIe=function(s,e){return function(t,i){e(t,i,s)}};let gA=class{constructor(e,t,i,n){this._languageConfigurationService=n,this._selection=e,this._isMovingDown=t,this._autoIndent=i,this._selectionId=null,this._moveEndLineSelectionShrink=!1}getEditOperations(e,t){const i=()=>e.getLanguageId(),n=(h,u)=>e.getLanguageIdAtPosition(h,u),o=e.getLineCount();if(this._isMovingDown&&this._selection.endLineNumber===o){this._selectionId=t.trackSelection(this._selection);return}if(!this._isMovingDown&&this._selection.startLineNumber===1){this._selectionId=t.trackSelection(this._selection);return}this._moveEndPositionDown=!1;let r=this._selection;r.startLineNumber<r.endLineNumber&&r.endColumn===1&&(this._moveEndPositionDown=!0,r=r.setEndPosition(r.endLineNumber-1,e.getLineMaxColumn(r.endLineNumber-1)));const{tabSize:a,indentSize:l,insertSpaces:c}=e.getOptions(),d=this.buildIndentConverter(a,l,c);if(r.startLineNumber===r.endLineNumber&&e.getLineMaxColumn(r.startLineNumber)===1){const h=r.startLineNumber,u=this._isMovingDown?h+1:h-1;e.getLineMaxColumn(u)===1?t.addEditOperation(new k(1,1,1,1),null):(t.addEditOperation(new k(h,1,h,1),e.getLineContent(u)),t.addEditOperation(new k(u,1,u,e.getLineMaxColumn(u)),null)),r=new me(u,1,u,1)}else{let h,u;if(this._isMovingDown){h=r.endLineNumber+1,u=e.getLineContent(h),t.addEditOperation(new k(h-1,e.getLineMaxColumn(h-1),h,e.getLineMaxColumn(h)),null);let g=u;if(this.shouldAutoIndent(e,r)){const f=this.matchEnterRule(e,d,a,h,r.startLineNumber-1);if(f!==null){const _=Mt(e.getLineContent(h)),b=f+to(_,a);g=Db(b,a,c)+this.trimStart(u)}else{const _={tokenization:{getLineTokens:v=>v===r.startLineNumber?e.tokenization.getLineTokens(h):e.tokenization.getLineTokens(v),getLanguageId:i,getLanguageIdAtPosition:n},getLineContent:v=>v===r.startLineNumber?e.getLineContent(h):e.getLineContent(v)},b=ub(this._autoIndent,_,e.getLanguageIdAtPosition(h,1),r.startLineNumber,d,this._languageConfigurationService);if(b!==null){const v=Mt(e.getLineContent(h)),C=to(b,a),y=to(v,a);C!==y&&(g=Db(C,a,c)+this.trimStart(u))}}t.addEditOperation(new k(r.startLineNumber,1,r.startLineNumber,1),g+`
`);const m=this.matchEnterRuleMovingDown(e,d,a,r.startLineNumber,h,g);if(m!==null)m!==0&&this.getIndentEditsOfMovingBlock(e,t,r,a,c,m);else{const _={tokenization:{getLineTokens:v=>v===r.startLineNumber?e.tokenization.getLineTokens(h):v>=r.startLineNumber+1&&v<=r.endLineNumber+1?e.tokenization.getLineTokens(v-1):e.tokenization.getLineTokens(v),getLanguageId:i,getLanguageIdAtPosition:n},getLineContent:v=>v===r.startLineNumber?g:v>=r.startLineNumber+1&&v<=r.endLineNumber+1?e.getLineContent(v-1):e.getLineContent(v)},b=ub(this._autoIndent,_,e.getLanguageIdAtPosition(h,1),r.startLineNumber+1,d,this._languageConfigurationService);if(b!==null){const v=Mt(e.getLineContent(r.startLineNumber)),C=to(b,a),y=to(v,a);if(C!==y){const w=C-y;this.getIndentEditsOfMovingBlock(e,t,r,a,c,w)}}}}else t.addEditOperation(new k(r.startLineNumber,1,r.startLineNumber,1),g+`
`)}else if(h=r.startLineNumber-1,u=e.getLineContent(h),t.addEditOperation(new k(h,1,h+1,1),null),t.addEditOperation(new k(r.endLineNumber,e.getLineMaxColumn(r.endLineNumber),r.endLineNumber,e.getLineMaxColumn(r.endLineNumber)),`
`+u),this.shouldAutoIndent(e,r)){const g={tokenization:{getLineTokens:m=>m===h?e.tokenization.getLineTokens(r.startLineNumber):e.tokenization.getLineTokens(m),getLanguageId:i,getLanguageIdAtPosition:n},getLineContent:m=>m===h?e.getLineContent(r.startLineNumber):e.getLineContent(m)},f=this.matchEnterRule(e,d,a,r.startLineNumber,r.startLineNumber-2);if(f!==null)f!==0&&this.getIndentEditsOfMovingBlock(e,t,r,a,c,f);else{const m=ub(this._autoIndent,g,e.getLanguageIdAtPosition(r.startLineNumber,1),h,d,this._languageConfigurationService);if(m!==null){const _=Mt(e.getLineContent(r.startLineNumber)),b=to(m,a),v=to(_,a);if(b!==v){const C=b-v;this.getIndentEditsOfMovingBlock(e,t,r,a,c,C)}}}}}this._selectionId=t.trackSelection(r)}buildIndentConverter(e,t,i){return{shiftIndent:n=>Sr.shiftIndent(n,n.length+1,e,t,i),unshiftIndent:n=>Sr.unshiftIndent(n,n.length+1,e,t,i)}}parseEnterResult(e,t,i,n,o){if(o){let r=o.indentation;o.indentAction===Wi.None||o.indentAction===Wi.Indent?r=o.indentation+o.appendText:o.indentAction===Wi.IndentOutdent?r=o.indentation:o.indentAction===Wi.Outdent&&(r=t.unshiftIndent(o.indentation)+o.appendText);const a=e.getLineContent(n);if(this.trimStart(a).indexOf(this.trimStart(r))>=0){const l=Mt(e.getLineContent(n));let c=Mt(r);const d=Z$(e,n,this._languageConfigurationService);d!==null&&d&2&&(c=t.unshiftIndent(c));const h=to(c,i),u=to(l,i);return h-u}}return null}matchEnterRuleMovingDown(e,t,i,n,o,r){if(Na(r)>=0){const a=e.getLineMaxColumn(o),l=cp(this._autoIndent,e,new k(o,a,o,a),this._languageConfigurationService);return this.parseEnterResult(e,t,i,n,l)}else{let a=n-1;for(;a>=1;){const d=e.getLineContent(a);if(Na(d)>=0)break;a--}if(a<1||n>e.getLineCount())return null;const l=e.getLineMaxColumn(a),c=cp(this._autoIndent,e,new k(a,l,a,l),this._languageConfigurationService);return this.parseEnterResult(e,t,i,n,c)}}matchEnterRule(e,t,i,n,o,r){let a=o;for(;a>=1;){let d;if(a===o&&r!==void 0?d=r:d=e.getLineContent(a),Na(d)>=0)break;a--}if(a<1||n>e.getLineCount())return null;const l=e.getLineMaxColumn(a),c=cp(this._autoIndent,e,new k(a,l,a,l),this._languageConfigurationService);return this.parseEnterResult(e,t,i,n,c)}trimStart(e){return e.replace(/^\s+/,"")}shouldAutoIndent(e,t){if(this._autoIndent<4||!e.tokenization.isCheapToTokenize(t.startLineNumber))return!1;const i=e.getLanguageIdAtPosition(t.startLineNumber,1),n=e.getLanguageIdAtPosition(t.endLineNumber,1);return!(i!==n||this._languageConfigurationService.getLanguageConfiguration(i).indentRulesSupport===null)}getIndentEditsOfMovingBlock(e,t,i,n,o,r){for(let a=i.startLineNumber;a<=i.endLineNumber;a++){const l=e.getLineContent(a),c=Mt(l),h=to(c,n)+r,u=Db(h,n,o);u!==c&&(t.addEditOperation(new k(a,1,a,c.length+1),u),a===i.endLineNumber&&i.endColumn<=c.length+1&&u===""&&(this._moveEndLineSelectionShrink=!0))}}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(i=i.setEndPosition(i.endLineNumber+1,1)),this._moveEndLineSelectionShrink&&i.startLineNumber<i.endLineNumber&&(i=i.setEndPosition(i.endLineNumber,2)),i}};gA=DIe([IIe(3,di)],gA);class Wu{static{this._COLLATOR=null}static getCollator(){return Wu._COLLATOR||(Wu._COLLATOR=new Intl.Collator),Wu._COLLATOR}constructor(e,t){this.selection=e,this.descending=t,this.selectionId=null}getEditOperations(e,t){const i=TIe(e,this.selection,this.descending);i&&t.addEditOperation(i.range,i.text),this.selectionId=t.trackSelection(this.selection)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}static canRun(e,t,i){if(e===null)return!1;const n=VK(e,t,i);if(!n)return!1;for(let o=0,r=n.before.length;o<r;o++)if(n.before[o]!==n.after[o])return!0;return!1}}function VK(s,e,t){const i=e.startLineNumber;let n=e.endLineNumber;if(e.endColumn===1&&n--,i>=n)return null;const o=[];for(let a=i;a<=n;a++)o.push(s.getLineContent(a));let r=o.slice(0);return r.sort(Wu.getCollator().compare),t===!0&&(r=r.reverse()),{startLineNumber:i,endLineNumber:n,before:o,after:r}}function TIe(s,e,t){const i=VK(s,e,t);return i?ri.replace(new k(i.startLineNumber,1,i.endLineNumber,s.getLineMaxColumn(i.endLineNumber)),i.after.join(`
`)):null}class zK extends ge{constructor(e,t){super(t),this.down=e}run(e,t){if(!t.hasModel())return;const i=t.getSelections().map((r,a)=>({selection:r,index:a,ignore:!1}));i.sort((r,a)=>k.compareRangesUsingStarts(r.selection,a.selection));let n=i[0];for(let r=1;r<i.length;r++){const a=i[r];n.selection.endLineNumber===a.selection.startLineNumber&&(n.index<a.index?a.ignore=!0:(n.ignore=!0,n=a))}const o=[];for(const r of i)o.push(new HK(r.selection,this.down,r.ignore));t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}class EIe extends zK{constructor(){super(!1,{id:"editor.action.copyLinesUpAction",label:p("lines.copyUp","Copy Line Up"),alias:"Copy Line Up",precondition:I.writable,kbOpts:{kbExpr:I.editorTextFocus,primary:1552,linux:{primary:3600},weight:100},menuOpts:{menuId:M.MenubarSelectionMenu,group:"2_line",title:p({key:"miCopyLinesUp",comment:["&& denotes a mnemonic"]},"&&Copy Line Up"),order:1}})}}class NIe extends zK{constructor(){super(!0,{id:"editor.action.copyLinesDownAction",label:p("lines.copyDown","Copy Line Down"),alias:"Copy Line Down",precondition:I.writable,kbOpts:{kbExpr:I.editorTextFocus,primary:1554,linux:{primary:3602},weight:100},menuOpts:{menuId:M.MenubarSelectionMenu,group:"2_line",title:p({key:"miCopyLinesDown",comment:["&& denotes a mnemonic"]},"Co&&py Line Down"),order:2}})}}class RIe extends ge{constructor(){super({id:"editor.action.duplicateSelection",label:p("duplicateSelection","Duplicate Selection"),alias:"Duplicate Selection",precondition:I.writable,menuOpts:{menuId:M.MenubarSelectionMenu,group:"2_line",title:p({key:"miDuplicateSelection",comment:["&& denotes a mnemonic"]},"&&Duplicate Selection"),order:5}})}run(e,t,i){if(!t.hasModel())return;const n=[],o=t.getSelections(),r=t.getModel();for(const a of o)if(a.isEmpty())n.push(new HK(a,!0));else{const l=new me(a.endLineNumber,a.endColumn,a.endLineNumber,a.endColumn);n.push(new g_e(l,r.getValueInRange(a)))}t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}class UK extends ge{constructor(e,t){super(t),this.down=e}run(e,t){const i=e.get(di),n=[],o=t.getSelections()||[],r=t.getOption(12);for(const a of o)n.push(new gA(a,this.down,r,i));t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}class MIe extends UK{constructor(){super(!1,{id:"editor.action.moveLinesUpAction",label:p("lines.moveUp","Move Line Up"),alias:"Move Line Up",precondition:I.writable,kbOpts:{kbExpr:I.editorTextFocus,primary:528,linux:{primary:528},weight:100},menuOpts:{menuId:M.MenubarSelectionMenu,group:"2_line",title:p({key:"miMoveLinesUp",comment:["&& denotes a mnemonic"]},"Mo&&ve Line Up"),order:3}})}}class AIe extends UK{constructor(){super(!0,{id:"editor.action.moveLinesDownAction",label:p("lines.moveDown","Move Line Down"),alias:"Move Line Down",precondition:I.writable,kbOpts:{kbExpr:I.editorTextFocus,primary:530,linux:{primary:530},weight:100},menuOpts:{menuId:M.MenubarSelectionMenu,group:"2_line",title:p({key:"miMoveLinesDown",comment:["&& denotes a mnemonic"]},"Move &&Line Down"),order:4}})}}class $K extends ge{constructor(e,t){super(t),this.descending=e}run(e,t){if(!t.hasModel())return;const i=t.getModel();let n=t.getSelections();n.length===1&&n[0].isEmpty()&&(n=[new me(1,1,i.getLineCount(),i.getLineMaxColumn(i.getLineCount()))]);for(const r of n)if(!Wu.canRun(t.getModel(),r,this.descending))return;const o=[];for(let r=0,a=n.length;r<a;r++)o[r]=new Wu(n[r],this.descending);t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}class PIe extends $K{constructor(){super(!1,{id:"editor.action.sortLinesAscending",label:p("lines.sortAscending","Sort Lines Ascending"),alias:"Sort Lines Ascending",precondition:I.writable})}}class OIe extends $K{constructor(){super(!0,{id:"editor.action.sortLinesDescending",label:p("lines.sortDescending","Sort Lines Descending"),alias:"Sort Lines Descending",precondition:I.writable})}}class FIe extends ge{constructor(){super({id:"editor.action.removeDuplicateLines",label:p("lines.deleteDuplicates","Delete Duplicate Lines"),alias:"Delete Duplicate Lines",precondition:I.writable})}run(e,t){if(!t.hasModel())return;const i=t.getModel();if(i.getLineCount()===1&&i.getLineMaxColumn(1)===1)return;const n=[],o=[];let r=0,a=!0,l=t.getSelections();l.length===1&&l[0].isEmpty()&&(l=[new me(1,1,i.getLineCount(),i.getLineMaxColumn(i.getLineCount()))],a=!1);for(const c of l){const d=new Set,h=[];for(let m=c.startLineNumber;m<=c.endLineNumber;m++){const _=i.getLineContent(m);d.has(_)||(h.push(_),d.add(_))}const u=new me(c.startLineNumber,1,c.endLineNumber,i.getLineMaxColumn(c.endLineNumber)),g=c.startLineNumber-r,f=new me(g,1,g+h.length-1,h[h.length-1].length);n.push(ri.replace(u,h.join(`
`))),o.push(f),r+=c.endLineNumber-c.startLineNumber+1-h.length}t.pushUndoStop(),t.executeEdits(this.id,n,a?o:void 0),t.pushUndoStop()}}class E4 extends ge{static{this.ID="editor.action.trimTrailingWhitespace"}constructor(){super({id:E4.ID,label:p("lines.trimTrailingWhitespace","Trim Trailing Whitespace"),alias:"Trim Trailing Whitespace",precondition:I.writable,kbOpts:{kbExpr:I.editorTextFocus,primary:Hi(2089,2102),weight:100}})}run(e,t,i){let n=[];i.reason==="auto-save"&&(n=(t.getSelections()||[]).map(d=>new P(d.positionLineNumber,d.positionColumn)));const o=t.getSelection();if(o===null)return;const r=e.get(Ke),a=t.getModel(),l=r.getValue("files.trimTrailingWhitespaceInRegexAndStrings",{overrideIdentifier:a?.getLanguageId(),resource:a?.uri}),c=new xIe(o,n,l);t.pushUndoStop(),t.executeCommands(this.id,[c]),t.pushUndoStop()}}class BIe extends ge{constructor(){super({id:"editor.action.deleteLines",label:p("lines.delete","Delete Line"),alias:"Delete Line",precondition:I.writable,kbOpts:{kbExpr:I.textInputFocus,primary:3113,weight:100}})}run(e,t){if(!t.hasModel())return;const i=this._getLinesToRemove(t),n=t.getModel();if(n.getLineCount()===1&&n.getLineMaxColumn(1)===1)return;let o=0;const r=[],a=[];for(let l=0,c=i.length;l<c;l++){const d=i[l];let h=d.startLineNumber,u=d.endLineNumber,g=1,f=n.getLineMaxColumn(u);u<n.getLineCount()?(u+=1,f=1):h>1&&(h-=1,g=n.getLineMaxColumn(h)),r.push(ri.replace(new me(h,g,u,f),"")),a.push(new me(h-o,d.positionColumn,h-o,d.positionColumn)),o+=d.endLineNumber-d.startLineNumber+1}t.pushUndoStop(),t.executeEdits(this.id,r,a),t.pushUndoStop()}_getLinesToRemove(e){const t=e.getSelections().map(o=>{let r=o.endLineNumber;return o.startLineNumber<o.endLineNumber&&o.endColumn===1&&(r-=1),{startLineNumber:o.startLineNumber,selectionStartColumn:o.selectionStartColumn,endLineNumber:r,positionColumn:o.positionColumn}});t.sort((o,r)=>o.startLineNumber===r.startLineNumber?o.endLineNumber-r.endLineNumber:o.startLineNumber-r.startLineNumber);const i=[];let n=t[0];for(let o=1;o<t.length;o++)n.endLineNumber+1>=t[o].startLineNumber?n.endLineNumber=t[o].endLineNumber:(i.push(n),n=t[o]);return i.push(n),i}}class WIe extends ge{constructor(){super({id:"editor.action.indentLines",label:p("lines.indent","Indent Line"),alias:"Indent Line",precondition:I.writable,kbOpts:{kbExpr:I.editorTextFocus,primary:2142,weight:100}})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,xd.indent(i.cursorConfig,t.getModel(),t.getSelections())),t.pushUndoStop())}}class HIe extends ge{constructor(){super({id:"editor.action.outdentLines",label:p("lines.outdent","Outdent Line"),alias:"Outdent Line",precondition:I.writable,kbOpts:{kbExpr:I.editorTextFocus,primary:2140,weight:100}})}run(e,t){dp.Outdent.runEditorCommand(e,t,null)}}class VIe extends ge{constructor(){super({id:"editor.action.insertLineBefore",label:p("lines.insertBefore","Insert Line Above"),alias:"Insert Line Above",precondition:I.writable,kbOpts:{kbExpr:I.editorTextFocus,primary:3075,weight:100}})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,Tx.lineInsertBefore(i.cursorConfig,t.getModel(),t.getSelections())))}}class zIe extends ge{constructor(){super({id:"editor.action.insertLineAfter",label:p("lines.insertAfter","Insert Line Below"),alias:"Insert Line Below",precondition:I.writable,kbOpts:{kbExpr:I.editorTextFocus,primary:2051,weight:100}})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,Tx.lineInsertAfter(i.cursorConfig,t.getModel(),t.getSelections())))}}class jK extends ge{run(e,t){if(!t.hasModel())return;const i=t.getSelection(),n=this._getRangesToDelete(t),o=[];for(let l=0,c=n.length-1;l<c;l++){const d=n[l],h=n[l+1];k.intersectRanges(d,h)===null?o.push(d):n[l+1]=k.plusRange(d,h)}o.push(n[n.length-1]);const r=this._getEndCursorState(i,o),a=o.map(l=>ri.replace(l,""));t.pushUndoStop(),t.executeEdits(this.id,a,r),t.pushUndoStop()}}class UIe extends jK{constructor(){super({id:"deleteAllLeft",label:p("lines.deleteAllLeft","Delete All Left"),alias:"Delete All Left",precondition:I.writable,kbOpts:{kbExpr:I.textInputFocus,primary:0,mac:{primary:2049},weight:100}})}_getEndCursorState(e,t){let i=null;const n=[];let o=0;return t.forEach(r=>{let a;if(r.endColumn===1&&o>0){const l=r.startLineNumber-o;a=new me(l,r.startColumn,l,r.startColumn)}else a=new me(r.startLineNumber,r.startColumn,r.startLineNumber,r.startColumn);o+=r.endLineNumber-r.startLineNumber,r.intersectRanges(e)?i=a:n.push(a)}),i&&n.unshift(i),n}_getRangesToDelete(e){const t=e.getSelections();if(t===null)return[];let i=t;const n=e.getModel();return n===null?[]:(i.sort(k.compareRangesUsingStarts),i=i.map(o=>{if(o.isEmpty())if(o.startColumn===1){const r=Math.max(1,o.startLineNumber-1),a=o.startLineNumber===1?1:n.getLineLength(r)+1;return new k(r,a,o.startLineNumber,1)}else return new k(o.startLineNumber,1,o.startLineNumber,o.startColumn);else return new k(o.startLineNumber,1,o.endLineNumber,o.endColumn)}),i)}}class $Ie extends jK{constructor(){super({id:"deleteAllRight",label:p("lines.deleteAllRight","Delete All Right"),alias:"Delete All Right",precondition:I.writable,kbOpts:{kbExpr:I.textInputFocus,primary:0,mac:{primary:297,secondary:[2068]},weight:100}})}_getEndCursorState(e,t){let i=null;const n=[];for(let o=0,r=t.length,a=0;o<r;o++){const l=t[o],c=new me(l.startLineNumber-a,l.startColumn,l.startLineNumber-a,l.startColumn);l.intersectRanges(e)?i=c:n.push(c)}return i&&n.unshift(i),n}_getRangesToDelete(e){const t=e.getModel();if(t===null)return[];const i=e.getSelections();if(i===null)return[];const n=i.map(o=>{if(o.isEmpty()){const r=t.getLineMaxColumn(o.startLineNumber);return o.startColumn===r?new k(o.startLineNumber,o.startColumn,o.startLineNumber+1,1):new k(o.startLineNumber,o.startColumn,o.startLineNumber,r)}return o});return n.sort(k.compareRangesUsingStarts),n}}class jIe extends ge{constructor(){super({id:"editor.action.joinLines",label:p("lines.joinLines","Join Lines"),alias:"Join Lines",precondition:I.writable,kbOpts:{kbExpr:I.editorTextFocus,primary:0,mac:{primary:296},weight:100}})}run(e,t){const i=t.getSelections();if(i===null)return;let n=t.getSelection();if(n===null)return;i.sort(k.compareRangesUsingStarts);const o=[],r=i.reduce((u,g)=>u.isEmpty()?u.endLineNumber===g.startLineNumber?(n.equalsSelection(u)&&(n=g),g):g.startLineNumber>u.endLineNumber+1?(o.push(u),g):new me(u.startLineNumber,u.startColumn,g.endLineNumber,g.endColumn):g.startLineNumber>u.endLineNumber?(o.push(u),g):new me(u.startLineNumber,u.startColumn,g.endLineNumber,g.endColumn));o.push(r);const a=t.getModel();if(a===null)return;const l=[],c=[];let d=n,h=0;for(let u=0,g=o.length;u<g;u++){const f=o[u],m=f.startLineNumber,_=1;let b=0,v,C;const y=a.getLineLength(f.endLineNumber)-f.endColumn;if(f.isEmpty()||f.startLineNumber===f.endLineNumber){const L=f.getStartPosition();L.lineNumber<a.getLineCount()?(v=m+1,C=a.getLineMaxColumn(v)):(v=L.lineNumber,C=a.getLineMaxColumn(L.lineNumber))}else v=f.endLineNumber,C=a.getLineMaxColumn(v);let w=a.getLineContent(m);for(let L=m+1;L<=v;L++){const D=a.getLineContent(L),T=a.getLineFirstNonWhitespaceColumn(L);if(T>=1){let F=!0;w===""&&(F=!1),F&&(w.charAt(w.length-1)===" "||w.charAt(w.length-1)==="	")&&(F=!1,w=w.replace(/[\s\uFEFF\xA0]+$/g," "));const W=D.substr(T-1);w+=(F?" ":"")+W,F?b=W.length+1:b=W.length}else b=0}const x=new k(m,_,v,C);if(!x.isEmpty()){let L;f.isEmpty()?(l.push(ri.replace(x,w)),L=new me(x.startLineNumber-h,w.length-b+1,m-h,w.length-b+1)):f.startLineNumber===f.endLineNumber?(l.push(ri.replace(x,w)),L=new me(f.startLineNumber-h,f.startColumn,f.endLineNumber-h,f.endColumn)):(l.push(ri.replace(x,w)),L=new me(f.startLineNumber-h,f.startColumn,f.startLineNumber-h,w.length-y)),k.intersectRanges(x,n)!==null?d=L:c.push(L)}h+=x.endLineNumber-x.startLineNumber}c.unshift(d),t.pushUndoStop(),t.executeEdits(this.id,l,c),t.pushUndoStop()}}class ZIe extends ge{constructor(){super({id:"editor.action.transpose",label:p("editor.transpose","Transpose Characters around the Cursor"),alias:"Transpose Characters around the Cursor",precondition:I.writable})}run(e,t){const i=t.getSelections();if(i===null)return;const n=t.getModel();if(n===null)return;const o=[];for(let r=0,a=i.length;r<a;r++){const l=i[r];if(!l.isEmpty())continue;const c=l.getStartPosition(),d=n.getLineMaxColumn(c.lineNumber);if(c.column>=d){if(c.lineNumber===n.getLineCount())continue;const h=new k(c.lineNumber,Math.max(1,c.column-1),c.lineNumber+1,1),u=n.getValueInRange(h).split("").reverse().join("");o.push(new Nn(new me(c.lineNumber,Math.max(1,c.column-1),c.lineNumber+1,1),u))}else{const h=new k(c.lineNumber,Math.max(1,c.column-1),c.lineNumber,c.column+1),u=n.getValueInRange(h).split("").reverse().join("");o.push(new KO(h,u,new me(c.lineNumber,c.column+1,c.lineNumber,c.column+1)))}}t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}class Eg extends ge{run(e,t){const i=t.getSelections();if(i===null)return;const n=t.getModel();if(n===null)return;const o=t.getOption(132),r=[];for(const a of i)if(a.isEmpty()){const l=a.getStartPosition(),c=t.getConfiguredWordAtPosition(l);if(!c)continue;const d=new k(l.lineNumber,c.startColumn,l.lineNumber,c.endColumn),h=n.getValueInRange(d);r.push(ri.replace(d,this._modifyText(h,o)))}else{const l=n.getValueInRange(a);r.push(ri.replace(a,this._modifyText(l,o)))}t.pushUndoStop(),t.executeEdits(this.id,r),t.pushUndoStop()}}class KIe extends Eg{constructor(){super({id:"editor.action.transformToUppercase",label:p("editor.transformToUppercase","Transform to Uppercase"),alias:"Transform to Uppercase",precondition:I.writable})}_modifyText(e,t){return e.toLocaleUpperCase()}}class qIe extends Eg{constructor(){super({id:"editor.action.transformToLowercase",label:p("editor.transformToLowercase","Transform to Lowercase"),alias:"Transform to Lowercase",precondition:I.writable})}_modifyText(e,t){return e.toLocaleLowerCase()}}class Ac{constructor(e,t){this._pattern=e,this._flags=t,this._actual=null,this._evaluated=!1}get(){if(!this._evaluated){this._evaluated=!0;try{this._actual=new RegExp(this._pattern,this._flags)}catch{}}return this._actual}isSupported(){return this.get()!==null}}class GS extends Eg{static{this.titleBoundary=new Ac("(^|[^\\p{L}\\p{N}']|((^|\\P{L})'))\\p{L}","gmu")}constructor(){super({id:"editor.action.transformToTitlecase",label:p("editor.transformToTitlecase","Transform to Title Case"),alias:"Transform to Title Case",precondition:I.writable})}_modifyText(e,t){const i=GS.titleBoundary.get();return i?e.toLocaleLowerCase().replace(i,n=>n.toLocaleUpperCase()):e}}class mp extends Eg{static{this.caseBoundary=new Ac("(\\p{Ll})(\\p{Lu})","gmu")}static{this.singleLetters=new Ac("(\\p{Lu}|\\p{N})(\\p{Lu})(\\p{Ll})","gmu")}constructor(){super({id:"editor.action.transformToSnakecase",label:p("editor.transformToSnakecase","Transform to Snake Case"),alias:"Transform to Snake Case",precondition:I.writable})}_modifyText(e,t){const i=mp.caseBoundary.get(),n=mp.singleLetters.get();return!i||!n?e:e.replace(i,"$1_$2").replace(n,"$1_$2$3").toLocaleLowerCase()}}class YS extends Eg{static{this.wordBoundary=new Ac("[_\\s-]","gm")}constructor(){super({id:"editor.action.transformToCamelcase",label:p("editor.transformToCamelcase","Transform to Camel Case"),alias:"Transform to Camel Case",precondition:I.writable})}_modifyText(e,t){const i=YS.wordBoundary.get();if(!i)return e;const n=e.split(i);return n.shift()+n.map(r=>r.substring(0,1).toLocaleUpperCase()+r.substring(1)).join("")}}class tC extends Eg{static{this.wordBoundary=new Ac("[_\\s-]","gm")}static{this.wordBoundaryToMaintain=new Ac("(?<=\\.)","gm")}constructor(){super({id:"editor.action.transformToPascalcase",label:p("editor.transformToPascalcase","Transform to Pascal Case"),alias:"Transform to Pascal Case",precondition:I.writable})}_modifyText(e,t){const i=tC.wordBoundary.get(),n=tC.wordBoundaryToMaintain.get();return!i||!n?e:e.split(n).map(a=>a.split(i)).flat().map(a=>a.substring(0,1).toLocaleUpperCase()+a.substring(1)).join("")}}class _p extends Eg{static isSupported(){return[this.caseBoundary,this.singleLetters,this.underscoreBoundary].every(t=>t.isSupported())}static{this.caseBoundary=new Ac("(\\p{Ll})(\\p{Lu})","gmu")}static{this.singleLetters=new Ac("(\\p{Lu}|\\p{N})(\\p{Lu}\\p{Ll})","gmu")}static{this.underscoreBoundary=new Ac("(\\S)(_)(\\S)","gm")}constructor(){super({id:"editor.action.transformToKebabcase",label:p("editor.transformToKebabcase","Transform to Kebab Case"),alias:"Transform to Kebab Case",precondition:I.writable})}_modifyText(e,t){const i=_p.caseBoundary.get(),n=_p.singleLetters.get(),o=_p.underscoreBoundary.get();return!i||!n||!o?e:e.replace(o,"$1-$3").replace(i,"$1-$2").replace(n,"$1-$2").toLocaleLowerCase()}}Q(EIe);Q(NIe);Q(RIe);Q(MIe);Q(AIe);Q(PIe);Q(OIe);Q(FIe);Q(E4);Q(BIe);Q(WIe);Q(HIe);Q(VIe);Q(zIe);Q(UIe);Q($Ie);Q(jIe);Q(ZIe);Q(KIe);Q(qIe);mp.caseBoundary.isSupported()&&mp.singleLetters.isSupported()&&Q(mp);YS.wordBoundary.isSupported()&&Q(YS);tC.wordBoundary.isSupported()&&Q(tC);GS.titleBoundary.isSupported()&&Q(GS);_p.isSupported()&&Q(_p);var GIe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},yw=function(s,e){return function(t,i){e(t,i,s)}},h1;const ZK=new le("LinkedEditingInputVisible",!1),YIe="linked-editing-decoration";let om=class extends B{static{h1=this}static{this.ID="editor.contrib.linkedEditing"}static{this.DECORATION=We.register({description:"linked-editing",stickiness:0,className:YIe})}static get(e){return e.getContribution(h1.ID)}constructor(e,t,i,n,o){super(),this.languageConfigurationService=n,this._syncRangesToken=0,this._localToDispose=this._register(new Z),this._editor=e,this._providers=i.linkedEditingRangeProvider,this._enabled=!1,this._visibleContextKey=ZK.bindTo(t),this._debounceInformation=o.for(this._providers,"Linked Editing",{max:200}),this._currentDecorations=this._editor.createDecorationsCollection(),this._languageWordPattern=null,this._currentWordPattern=null,this._ignoreChangeEvent=!1,this._localToDispose=this._register(new Z),this._rangeUpdateTriggerPromise=null,this._rangeSyncTriggerPromise=null,this._currentRequestCts=null,this._currentRequestPosition=null,this._currentRequestModelVersion=null,this._register(this._editor.onDidChangeModel(()=>this.reinitialize(!0))),this._register(this._editor.onDidChangeConfiguration(r=>{(r.hasChanged(70)||r.hasChanged(94))&&this.reinitialize(!1)})),this._register(this._providers.onDidChange(()=>this.reinitialize(!1))),this._register(this._editor.onDidChangeModelLanguage(()=>this.reinitialize(!0))),this.reinitialize(!0)}reinitialize(e){const t=this._editor.getModel(),i=t!==null&&(this._editor.getOption(70)||this._editor.getOption(94))&&this._providers.has(t);if(i===this._enabled&&!e||(this._enabled=i,this.clearRanges(),this._localToDispose.clear(),!i||t===null))return;this._localToDispose.add(se.runAndSubscribe(t.onDidChangeLanguageConfiguration,()=>{this._languageWordPattern=this.languageConfigurationService.getLanguageConfiguration(t.getLanguageId()).getWordDefinition()}));const n=new Cr(this._debounceInformation.get(t)),o=()=>{this._rangeUpdateTriggerPromise=n.trigger(()=>this.updateRanges(),this._debounceDuration??this._debounceInformation.get(t))},r=new Cr(0),a=l=>{this._rangeSyncTriggerPromise=r.trigger(()=>this._syncRanges(l))};this._localToDispose.add(this._editor.onDidChangeCursorPosition(()=>{o()})),this._localToDispose.add(this._editor.onDidChangeModelContent(l=>{if(!this._ignoreChangeEvent&&this._currentDecorations.length>0){const c=this._currentDecorations.getRange(0);if(c&&l.changes.every(d=>c.intersectRanges(d.range))){a(this._syncRangesToken);return}}o()})),this._localToDispose.add({dispose:()=>{n.dispose(),r.dispose()}}),this.updateRanges()}_syncRanges(e){if(!this._editor.hasModel()||e!==this._syncRangesToken||this._currentDecorations.length===0)return;const t=this._editor.getModel(),i=this._currentDecorations.getRange(0);if(!i||i.startLineNumber!==i.endLineNumber)return this.clearRanges();const n=t.getValueInRange(i);if(this._currentWordPattern){const r=n.match(this._currentWordPattern);if((r?r[0].length:0)!==n.length)return this.clearRanges()}const o=[];for(let r=1,a=this._currentDecorations.length;r<a;r++){const l=this._currentDecorations.getRange(r);if(l)if(l.startLineNumber!==l.endLineNumber)o.push({range:l,text:n});else{let c=t.getValueInRange(l),d=n,h=l.startColumn,u=l.endColumn;const g=th(c,d);h+=g,c=c.substr(g),d=d.substr(g);const f=O1(c,d);u-=f,c=c.substr(0,c.length-f),d=d.substr(0,d.length-f),(h!==u||d.length!==0)&&o.push({range:new k(l.startLineNumber,h,l.endLineNumber,u),text:d})}}if(o.length!==0)try{this._editor.popUndoStop(),this._ignoreChangeEvent=!0;const r=this._editor._getViewModel().getPrevEditOperationType();this._editor.executeEdits("linkedEditing",o),this._editor._getViewModel().setPrevEditOperationType(r)}finally{this._ignoreChangeEvent=!1}}dispose(){this.clearRanges(),super.dispose()}clearRanges(){this._visibleContextKey.set(!1),this._currentDecorations.clear(),this._currentRequestCts&&(this._currentRequestCts.cancel(),this._currentRequestCts=null,this._currentRequestPosition=null)}async updateRanges(e=!1){if(!this._editor.hasModel()){this.clearRanges();return}const t=this._editor.getPosition();if(!this._enabled&&!e||this._editor.getSelections().length>1){this.clearRanges();return}const i=this._editor.getModel(),n=i.getVersionId();if(this._currentRequestPosition&&this._currentRequestModelVersion===n){if(t.equals(this._currentRequestPosition))return;if(this._currentDecorations.length>0){const r=this._currentDecorations.getRange(0);if(r&&r.containsPosition(t))return}}this.clearRanges(),this._currentRequestPosition=t,this._currentRequestModelVersion=n;const o=this._currentRequestCts=new li;try{const r=new un(!1),a=await KK(this._providers,i,t,o.token);if(this._debounceInformation.update(i,r.elapsed()),o!==this._currentRequestCts||(this._currentRequestCts=null,n!==i.getVersionId()))return;let l=[];a?.ranges&&(l=a.ranges),this._currentWordPattern=a?.wordPattern||this._languageWordPattern;let c=!1;for(let h=0,u=l.length;h<u;h++)if(k.containsPosition(l[h],t)){if(c=!0,h!==0){const g=l[h];l.splice(h,1),l.unshift(g)}break}if(!c){this.clearRanges();return}const d=l.map(h=>({range:h,options:h1.DECORATION}));this._visibleContextKey.set(!0),this._currentDecorations.set(d),this._syncRangesToken++}catch(r){xr(r)||Oe(r),(this._currentRequestCts===o||!this._currentRequestCts)&&this.clearRanges()}}};om=h1=GIe([yw(1,Ee),yw(2,pe),yw(3,di),yw(4,Go)],om);class XIe extends ge{constructor(){super({id:"editor.action.linkedEditing",label:p("linkedEditing.label","Start Linked Editing"),alias:"Start Linked Editing",precondition:q.and(I.writable,I.hasRenameProvider),kbOpts:{kbExpr:I.editorTextFocus,primary:3132,weight:100}})}runCommand(e,t){const i=e.get(ft),[n,o]=Array.isArray(t)&&t||[void 0,void 0];return Se.isUri(n)&&P.isIPosition(o)?i.openCodeEditor({resource:n},i.getActiveCodeEditor()).then(r=>{r&&(r.setPosition(o),r.invokeWithinContext(a=>(this.reportTelemetry(a,r),this.run(a,r))))},Oe):super.runCommand(e,t)}run(e,t){const i=om.get(t);return i?Promise.resolve(i.updateRanges(!0)):Promise.resolve()}}const QIe=Zi.bindToContribution(om.get);ae(new QIe({id:"cancelLinkedEditingInput",precondition:ZK,handler:s=>s.clearRanges(),kbOpts:{kbExpr:I.editorTextFocus,weight:199,primary:9,secondary:[1033]}}));function KK(s,e,t,i){const n=s.ordered(e);return KP(n.map(o=>async()=>{try{return await o.provideLinkedEditingRanges(e,t,i)}catch(r){Li(r);return}}),o=>!!o&&os(o?.ranges))}E("editor.linkedEditingBackground",{dark:G.fromHex("#f00").transparent(.3),light:G.fromHex("#f00").transparent(.3),hcDark:G.fromHex("#f00").transparent(.3),hcLight:G.white},p("editorLinkedEditingBackground","Background color when the editor auto renames on type."));Gs("_executeLinkedEditingProvider",(s,e,t)=>{const{linkedEditingRangeProvider:i}=s.get(pe);return KK(i,e,t,Ue.None)});ct(om.ID,om,1);Q(XIe);let JIe=class{constructor(e,t){this._link=e,this._provider=t}toJSON(){return{range:this.range,url:this.url,tooltip:this.tooltip}}get range(){return this._link.range}get url(){return this._link.url}get tooltip(){return this._link.tooltip}async resolve(e){return this._link.url?this._link.url:typeof this._provider.resolveLink=="function"?Promise.resolve(this._provider.resolveLink(this._link,e)).then(t=>(this._link=t||this._link,this._link.url?this.resolve(e):Promise.reject(new Error("missing")))):Promise.reject(new Error("missing"))}};class XS{constructor(e){this._disposables=new Z;let t=[];for(const[i,n]of e){const o=i.links.map(r=>new JIe(r,n));t=XS._union(t,o),mL(i)&&this._disposables.add(i)}this.links=t}dispose(){this._disposables.dispose(),this.links.length=0}static _union(e,t){const i=[];let n,o,r,a;for(n=0,r=0,o=e.length,a=t.length;n<o&&r<a;){const l=e[n],c=t[r];if(k.areIntersectingOrTouching(l.range,c.range)){n++;continue}k.compareRangesUsingStarts(l.range,c.range)<0?(i.push(l),n++):(i.push(c),r++)}for(;n<o;n++)i.push(e[n]);for(;r<a;r++)i.push(t[r]);return i}}function qK(s,e,t){const i=[],n=s.ordered(e).reverse().map((o,r)=>Promise.resolve(o.provideLinks(e,t)).then(a=>{a&&(i[r]=[a,o])},Li));return Promise.all(n).then(()=>{const o=new XS(Yr(i));return t.isCancellationRequested?(o.dispose(),new XS([])):o})}ot.registerCommand("_executeLinkProvider",async(s,...e)=>{let[t,i]=e;gt(t instanceof Se),typeof i!="number"&&(i=0);const{linkProvider:n}=s.get(pe),o=s.get(Zt).getModel(t);if(!o)return[];const r=await qK(n,o,Ue.None);if(!r)return[];for(let l=0;l<Math.min(i,r.links.length);l++)await r.links[l].resolve(Ue.None);const a=r.links.slice(0);return r.dispose(),a});var eTe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},ww=function(s,e){return function(t,i){e(t,i,s)}},fA;let iC=class extends B{static{fA=this}static{this.ID="editor.linkDetector"}static get(e){return e.getContribution(fA.ID)}constructor(e,t,i,n,o){super(),this.editor=e,this.openerService=t,this.notificationService=i,this.languageFeaturesService=n,this.providers=this.languageFeaturesService.linkProvider,this.debounceInformation=o.for(this.providers,"Links",{min:1e3,max:4e3}),this.computeLinks=this._register(new It(()=>this.computeLinksNow(),1e3)),this.computePromise=null,this.activeLinksList=null,this.currentOccurrences={},this.activeLinkDecorationId=null;const r=this._register(new Gx(e));this._register(r.onMouseMoveOrRelevantKeyDown(([a,l])=>{this._onEditorMouseMove(a,l)})),this._register(r.onExecute(a=>{this.onEditorMouseUp(a)})),this._register(r.onCancel(a=>{this.cleanUpActiveLinkDecoration()})),this._register(e.onDidChangeConfiguration(a=>{a.hasChanged(71)&&(this.updateDecorations([]),this.stop(),this.computeLinks.schedule(0))})),this._register(e.onDidChangeModelContent(a=>{this.editor.hasModel()&&this.computeLinks.schedule(this.debounceInformation.get(this.editor.getModel()))})),this._register(e.onDidChangeModel(a=>{this.currentOccurrences={},this.activeLinkDecorationId=null,this.stop(),this.computeLinks.schedule(0)})),this._register(e.onDidChangeModelLanguage(a=>{this.stop(),this.computeLinks.schedule(0)})),this._register(this.providers.onDidChange(a=>{this.stop(),this.computeLinks.schedule(0)})),this.computeLinks.schedule(0)}async computeLinksNow(){if(!this.editor.hasModel()||!this.editor.getOption(71))return;const e=this.editor.getModel();if(!e.isTooLargeForSyncing()&&this.providers.has(e)){this.activeLinksList&&(this.activeLinksList.dispose(),this.activeLinksList=null),this.computePromise=en(t=>qK(this.providers,e,t));try{const t=new un(!1);if(this.activeLinksList=await this.computePromise,this.debounceInformation.update(e,t.elapsed()),e.isDisposed())return;this.updateDecorations(this.activeLinksList.links)}catch(t){Oe(t)}finally{this.computePromise=null}}}updateDecorations(e){const t=this.editor.getOption(78)==="altKey",i=[],n=Object.keys(this.currentOccurrences);for(const r of n){const a=this.currentOccurrences[r];i.push(a.decorationId)}const o=[];if(e)for(const r of e)o.push(bp.decoration(r,t));this.editor.changeDecorations(r=>{const a=r.deltaDecorations(i,o);this.currentOccurrences={},this.activeLinkDecorationId=null;for(let l=0,c=a.length;l<c;l++){const d=new bp(e[l],a[l]);this.currentOccurrences[d.decorationId]=d}})}_onEditorMouseMove(e,t){const i=this.editor.getOption(78)==="altKey";if(this.isEnabled(e,t)){this.cleanUpActiveLinkDecoration();const n=this.getLinkOccurrence(e.target.position);n&&this.editor.changeDecorations(o=>{n.activate(o,i),this.activeLinkDecorationId=n.decorationId})}else this.cleanUpActiveLinkDecoration()}cleanUpActiveLinkDecoration(){const e=this.editor.getOption(78)==="altKey";if(this.activeLinkDecorationId){const t=this.currentOccurrences[this.activeLinkDecorationId];t&&this.editor.changeDecorations(i=>{t.deactivate(i,e)}),this.activeLinkDecorationId=null}}onEditorMouseUp(e){if(!this.isEnabled(e))return;const t=this.getLinkOccurrence(e.target.position);t&&this.openLinkOccurrence(t,e.hasSideBySideModifier,!0)}openLinkOccurrence(e,t,i=!1){if(!this.openerService)return;const{link:n}=e;n.resolve(Ue.None).then(o=>{if(typeof o=="string"&&this.editor.hasModel()){const r=this.editor.getModel().uri;if(r.scheme===Fe.file&&o.startsWith(`${Fe.file}:`)){const a=Se.parse(o);if(a.scheme===Fe.file){const l=al(a);let c=null;l.startsWith("/./")||l.startsWith("\\.\\")?c=`.${l.substr(1)}`:(l.startsWith("//./")||l.startsWith("\\\\.\\"))&&(c=`.${l.substr(2)}`),c&&(o=Qae(r,c))}}}return this.openerService.open(o,{openToSide:t,fromUserGesture:i,allowContributedOpeners:!0,allowCommands:!0,fromWorkspace:!0})},o=>{const r=o instanceof Error?o.message:o;r==="invalid"?this.notificationService.warn(p("invalid.url","Failed to open this link because it is not well-formed: {0}",n.url.toString())):r==="missing"?this.notificationService.warn(p("missing.url","Failed to open this link because its target is missing.")):Oe(o)})}getLinkOccurrence(e){if(!this.editor.hasModel()||!e)return null;const t=this.editor.getModel().getDecorationsInRange({startLineNumber:e.lineNumber,startColumn:e.column,endLineNumber:e.lineNumber,endColumn:e.column},0,!0);for(const i of t){const n=this.currentOccurrences[i.id];if(n)return n}return null}isEnabled(e,t){return!!(e.target.type===6&&(e.hasTriggerModifier||t&&t.keyCodeIsTriggerKey))}stop(){this.computeLinks.cancel(),this.activeLinksList&&(this.activeLinksList?.dispose(),this.activeLinksList=null),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}dispose(){super.dispose(),this.stop()}};iC=fA=eTe([ww(1,Ys),ww(2,Ii),ww(3,pe),ww(4,Go)],iC);const L8={general:We.register({description:"detected-link",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link"}),active:We.register({description:"detected-link-active",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link-active"})};class bp{static decoration(e,t){return{range:e.range,options:bp._getOptions(e,t,!1)}}static _getOptions(e,t,i){const n={...i?L8.active:L8.general};return n.hoverMessage=tTe(e,t),n}constructor(e,t){this.link=e,this.decorationId=t}activate(e,t){e.changeDecorationOptions(this.decorationId,bp._getOptions(this.link,t,!0))}deactivate(e,t){e.changeDecorationOptions(this.decorationId,bp._getOptions(this.link,t,!1))}}function tTe(s,e){const t=s.url&&/^command:/i.test(s.url.toString()),i=s.tooltip?s.tooltip:t?p("links.navigate.executeCmd","Execute command"):p("links.navigate.follow","Follow link"),n=e?Qe?p("links.navigate.kb.meta.mac","cmd + click"):p("links.navigate.kb.meta","ctrl + click"):Qe?p("links.navigate.kb.alt.mac","option + click"):p("links.navigate.kb.alt","alt + click");if(s.url){let o="";if(/^command:/i.test(s.url.toString())){const a=s.url.toString().match(/^command:([^?#]+)/);if(a){const l=a[1];o=p("tooltip.explanation","Execute command {0}",l)}}return new zn("",!0).appendLink(s.url.toString(!0).replace(/ /g,"%20"),i,o).appendMarkdown(` (${n})`)}else return new zn().appendText(`${i} (${n})`)}class iTe extends ge{constructor(){super({id:"editor.action.openLink",label:p("label","Open Link"),alias:"Open Link",precondition:void 0})}run(e,t){const i=iC.get(t);if(!i||!t.hasModel())return;const n=t.getSelections();for(const o of n){const r=i.getLinkOccurrence(o.getEndPosition());r&&i.openLinkOccurrence(r,!1)}}}ct(iC.ID,iC,1);Q(iTe);class x8 extends B{static{this.ID="editor.contrib.longLinesHelper"}constructor(e){super(),this._editor=e,this._register(this._editor.onMouseDown(t=>{const i=this._editor.getOption(118);i>=0&&t.target.type===6&&t.target.position.column>=i&&this._editor.updateOptions({stopRenderingLineAfter:-1})}))}}ct(x8.ID,x8,2);const nTe=E("editor.wordHighlightBackground",{dark:"#575757B8",light:"#57575740",hcDark:null,hcLight:null},p("wordHighlight","Background color of a symbol during read-access, like reading a variable. The color must not be opaque so as not to hide underlying decorations."),!0);E("editor.wordHighlightStrongBackground",{dark:"#004972B8",light:"#0e639c40",hcDark:null,hcLight:null},p("wordHighlightStrong","Background color of a symbol during write-access, like writing to a variable. The color must not be opaque so as not to hide underlying decorations."),!0);E("editor.wordHighlightTextBackground",nTe,p("wordHighlightText","Background color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations."),!0);const sTe=E("editor.wordHighlightBorder",{light:null,dark:null,hcDark:Xt,hcLight:Xt},p("wordHighlightBorder","Border color of a symbol during read-access, like reading a variable."));E("editor.wordHighlightStrongBorder",{light:null,dark:null,hcDark:Xt,hcLight:Xt},p("wordHighlightStrongBorder","Border color of a symbol during write-access, like writing to a variable."));E("editor.wordHighlightTextBorder",sTe,p("wordHighlightTextBorder","Border color of a textual occurrence for a symbol."));const oTe=E("editorOverviewRuler.wordHighlightForeground","#A0A0A0CC",p("overviewRulerWordHighlightForeground","Overview ruler marker color for symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),rTe=E("editorOverviewRuler.wordHighlightStrongForeground","#C0A0C0CC",p("overviewRulerWordHighlightStrongForeground","Overview ruler marker color for write-access symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),aTe=E("editorOverviewRuler.wordHighlightTextForeground",dz,p("overviewRulerWordHighlightTextForeground","Overview ruler marker color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations."),!0),lTe=We.register({description:"word-highlight-strong",stickiness:1,className:"wordHighlightStrong",overviewRuler:{color:_i(rTe),position:Ho.Center},minimap:{color:_i(jL),position:1}}),cTe=We.register({description:"word-highlight-text",stickiness:1,className:"wordHighlightText",overviewRuler:{color:_i(aTe),position:Ho.Center},minimap:{color:_i(jL),position:1}}),dTe=We.register({description:"selection-highlight-overview",stickiness:1,className:"selectionHighlight",overviewRuler:{color:_i(dz),position:Ho.Center},minimap:{color:_i(jL),position:1}}),hTe=We.register({description:"selection-highlight",stickiness:1,className:"selectionHighlight"}),uTe=We.register({description:"word-highlight",stickiness:1,className:"wordHighlight",overviewRuler:{color:_i(oTe),position:Ho.Center},minimap:{color:_i(jL),position:1}});function gTe(s){return s===wp.Write?lTe:s===wp.Text?cTe:uTe}function fTe(s){return s?hTe:dTe}kr((s,e)=>{const t=s.getColor(L2);t&&e.addRule(`.monaco-editor .selectionHighlight { background-color: ${t.transparent(.5)}; }`)});var pTe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},mTe=function(s,e){return function(t,i){e(t,i,s)}},pA;function kh(s,e){const t=e.filter(i=>!s.find(n=>n.equals(i)));if(t.length>=1){const i=t.map(o=>`line ${o.viewState.position.lineNumber} column ${o.viewState.position.column}`).join(", "),n=t.length===1?p("cursorAdded","Cursor added: {0}",i):p("cursorsAdded","Cursors added: {0}",i);Nl(n)}}class _Te extends ge{constructor(){super({id:"editor.action.insertCursorAbove",label:p("mutlicursor.insertAbove","Add Cursor Above"),alias:"Add Cursor Above",precondition:void 0,kbOpts:{kbExpr:I.editorTextFocus,primary:2576,linux:{primary:1552,secondary:[3088]},weight:100},menuOpts:{menuId:M.MenubarSelectionMenu,group:"3_multi",title:p({key:"miInsertCursorAbove",comment:["&& denotes a mnemonic"]},"&&Add Cursor Above"),order:2}})}run(e,t,i){if(!t.hasModel())return;let n=!0;i&&i.logicalLine===!1&&(n=!1);const o=t._getViewModel();if(o.cursorConfig.readOnly)return;o.model.pushStackElement();const r=o.getCursorStates();o.setCursorStates(i.source,3,mn.addCursorUp(o,r,n)),o.revealTopMostCursor(i.source),kh(r,o.getCursorStates())}}class bTe extends ge{constructor(){super({id:"editor.action.insertCursorBelow",label:p("mutlicursor.insertBelow","Add Cursor Below"),alias:"Add Cursor Below",precondition:void 0,kbOpts:{kbExpr:I.editorTextFocus,primary:2578,linux:{primary:1554,secondary:[3090]},weight:100},menuOpts:{menuId:M.MenubarSelectionMenu,group:"3_multi",title:p({key:"miInsertCursorBelow",comment:["&& denotes a mnemonic"]},"A&&dd Cursor Below"),order:3}})}run(e,t,i){if(!t.hasModel())return;let n=!0;i&&i.logicalLine===!1&&(n=!1);const o=t._getViewModel();if(o.cursorConfig.readOnly)return;o.model.pushStackElement();const r=o.getCursorStates();o.setCursorStates(i.source,3,mn.addCursorDown(o,r,n)),o.revealBottomMostCursor(i.source),kh(r,o.getCursorStates())}}class vTe extends ge{constructor(){super({id:"editor.action.insertCursorAtEndOfEachLineSelected",label:p("mutlicursor.insertAtEndOfEachLineSelected","Add Cursors to Line Ends"),alias:"Add Cursors to Line Ends",precondition:void 0,kbOpts:{kbExpr:I.editorTextFocus,primary:1575,weight:100},menuOpts:{menuId:M.MenubarSelectionMenu,group:"3_multi",title:p({key:"miInsertCursorAtEndOfEachLineSelected",comment:["&& denotes a mnemonic"]},"Add C&&ursors to Line Ends"),order:4}})}getCursorsForSelection(e,t,i){if(!e.isEmpty()){for(let n=e.startLineNumber;n<e.endLineNumber;n++){const o=t.getLineMaxColumn(n);i.push(new me(n,o,n,o))}e.endColumn>1&&i.push(new me(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn))}}run(e,t){if(!t.hasModel())return;const i=t.getModel(),n=t.getSelections(),o=t._getViewModel(),r=o.getCursorStates(),a=[];n.forEach(l=>this.getCursorsForSelection(l,i,a)),a.length>0&&t.setSelections(a),kh(r,o.getCursorStates())}}class CTe extends ge{constructor(){super({id:"editor.action.addCursorsToBottom",label:p("mutlicursor.addCursorsToBottom","Add Cursors To Bottom"),alias:"Add Cursors To Bottom",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getSelections(),n=t.getModel().getLineCount(),o=[];for(let l=i[0].startLineNumber;l<=n;l++)o.push(new me(l,i[0].startColumn,l,i[0].endColumn));const r=t._getViewModel(),a=r.getCursorStates();o.length>0&&t.setSelections(o),kh(a,r.getCursorStates())}}class yTe extends ge{constructor(){super({id:"editor.action.addCursorsToTop",label:p("mutlicursor.addCursorsToTop","Add Cursors To Top"),alias:"Add Cursors To Top",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getSelections(),n=[];for(let a=i[0].startLineNumber;a>=1;a--)n.push(new me(a,i[0].startColumn,a,i[0].endColumn));const o=t._getViewModel(),r=o.getCursorStates();n.length>0&&t.setSelections(n),kh(r,o.getCursorStates())}}class Sw{constructor(e,t,i){this.selections=e,this.revealRange=t,this.revealScrollType=i}}class nC{static create(e,t){if(!e.hasModel())return null;const i=t.getState();if(!e.hasTextFocus()&&i.isRevealed&&i.searchString.length>0)return new nC(e,t,!1,i.searchString,i.wholeWord,i.matchCase,null);let n=!1,o,r;const a=e.getSelections();a.length===1&&a[0].isEmpty()?(n=!0,o=!0,r=!0):(o=i.wholeWord,r=i.matchCase);const l=e.getSelection();let c,d=null;if(l.isEmpty()){const h=e.getConfiguredWordAtPosition(l.getStartPosition());if(!h)return null;c=h.word,d=new me(l.startLineNumber,h.startColumn,l.startLineNumber,h.endColumn)}else c=e.getModel().getValueInRange(l).replace(/\r\n/g,`
`);return new nC(e,t,n,c,o,r,d)}constructor(e,t,i,n,o,r,a){this._editor=e,this.findController=t,this.isDisconnectedFromFindController=i,this.searchText=n,this.wholeWord=o,this.matchCase=r,this.currentMatch=a}addSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new Sw(t.concat(e),e,0)}moveSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new Sw(t.slice(0,t.length-1).concat(e),e,0)}_getNextMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const n=this.currentMatch;return this.currentMatch=null,n}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findNextMatch(this.searchText,t.getEndPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(132):null,!1);return i?new me(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}addSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new Sw(t.concat(e),e,0)}moveSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new Sw(t.slice(0,t.length-1).concat(e),e,0)}_getPreviousMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const n=this.currentMatch;return this.currentMatch=null,n}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findPreviousMatch(this.searchText,t.getStartPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(132):null,!1);return i?new me(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}selectAll(e){if(!this._editor.hasModel())return[];this.findController.highlightFindOptions();const t=this._editor.getModel();return e?t.findMatches(this.searchText,e,!1,this.matchCase,this.wholeWord?this._editor.getOption(132):null,!1,1073741824):t.findMatches(this.searchText,!0,!1,this.matchCase,this.wholeWord?this._editor.getOption(132):null,!1,1073741824)}}class rm extends B{static{this.ID="editor.contrib.multiCursorController"}static get(e){return e.getContribution(rm.ID)}constructor(e){super(),this._sessionDispose=this._register(new Z),this._editor=e,this._ignoreSelectionChange=!1,this._session=null}dispose(){this._endSession(),super.dispose()}_beginSessionIfNeeded(e){if(!this._session){const t=nC.create(this._editor,e);if(!t)return;this._session=t;const i={searchString:this._session.searchText};this._session.isDisconnectedFromFindController&&(i.wholeWordOverride=1,i.matchCaseOverride=1,i.isRegexOverride=2),e.getState().change(i,!1),this._sessionDispose.add(this._editor.onDidChangeCursorSelection(n=>{this._ignoreSelectionChange||this._endSession()})),this._sessionDispose.add(this._editor.onDidBlurEditorText(()=>{this._endSession()})),this._sessionDispose.add(e.getState().onFindReplaceStateChange(n=>{(n.matchCase||n.wholeWord)&&this._endSession()}))}}_endSession(){if(this._sessionDispose.clear(),this._session&&this._session.isDisconnectedFromFindController){const e={wholeWordOverride:0,matchCaseOverride:0,isRegexOverride:0};this._session.findController.getState().change(e,!1)}this._session=null}_setSelections(e){this._ignoreSelectionChange=!0,this._editor.setSelections(e),this._ignoreSelectionChange=!1}_expandEmptyToWord(e,t){if(!t.isEmpty())return t;const i=this._editor.getConfiguredWordAtPosition(t.getStartPosition());return i?new me(t.startLineNumber,i.startColumn,t.startLineNumber,i.endColumn):t}_applySessionResult(e){e&&(this._setSelections(e.selections),e.revealRange&&this._editor.revealRangeInCenterIfOutsideViewport(e.revealRange,e.revealScrollType))}getSession(e){return this._session}addSelectionToNextFindMatch(e){if(this._editor.hasModel()){if(!this._session){const t=this._editor.getSelections();if(t.length>1){const n=e.getState().matchCase;if(!GK(this._editor.getModel(),t,n)){const r=this._editor.getModel(),a=[];for(let l=0,c=t.length;l<c;l++)a[l]=this._expandEmptyToWord(r,t[l]);this._editor.setSelections(a);return}}}this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToNextFindMatch())}}addSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToPreviousFindMatch())}moveSelectionToNextFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToNextFindMatch())}moveSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToPreviousFindMatch())}selectAll(e){if(!this._editor.hasModel())return;let t=null;const i=e.getState();if(i.isRevealed&&i.searchString.length>0&&i.isRegex){const n=this._editor.getModel();i.searchScope?t=n.findMatches(i.searchString,i.searchScope,i.isRegex,i.matchCase,i.wholeWord?this._editor.getOption(132):null,!1,1073741824):t=n.findMatches(i.searchString,!0,i.isRegex,i.matchCase,i.wholeWord?this._editor.getOption(132):null,!1,1073741824)}else{if(this._beginSessionIfNeeded(e),!this._session)return;t=this._session.selectAll(i.searchScope)}if(t.length>0){const n=this._editor.getSelection();for(let o=0,r=t.length;o<r;o++){const a=t[o];if(a.range.intersectRanges(n)){t[o]=t[0],t[0]=a;break}}this._setSelections(t.map(o=>new me(o.range.startLineNumber,o.range.startColumn,o.range.endLineNumber,o.range.endColumn)))}}}class Wm extends ge{run(e,t){const i=rm.get(t);if(!i)return;const n=t._getViewModel();if(n){const o=n.getCursorStates(),r=Ks.get(t);if(r)this._run(i,r);else{const a=e.get(ye).createInstance(Ks,t);this._run(i,a),a.dispose()}kh(o,n.getCursorStates())}}}class wTe extends Wm{constructor(){super({id:"editor.action.addSelectionToNextFindMatch",label:p("addSelectionToNextFindMatch","Add Selection To Next Find Match"),alias:"Add Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:I.focus,primary:2082,weight:100},menuOpts:{menuId:M.MenubarSelectionMenu,group:"3_multi",title:p({key:"miAddSelectionToNextFindMatch",comment:["&& denotes a mnemonic"]},"Add &&Next Occurrence"),order:5}})}_run(e,t){e.addSelectionToNextFindMatch(t)}}class STe extends Wm{constructor(){super({id:"editor.action.addSelectionToPreviousFindMatch",label:p("addSelectionToPreviousFindMatch","Add Selection To Previous Find Match"),alias:"Add Selection To Previous Find Match",precondition:void 0,menuOpts:{menuId:M.MenubarSelectionMenu,group:"3_multi",title:p({key:"miAddSelectionToPreviousFindMatch",comment:["&& denotes a mnemonic"]},"Add P&&revious Occurrence"),order:6}})}_run(e,t){e.addSelectionToPreviousFindMatch(t)}}class LTe extends Wm{constructor(){super({id:"editor.action.moveSelectionToNextFindMatch",label:p("moveSelectionToNextFindMatch","Move Last Selection To Next Find Match"),alias:"Move Last Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:I.focus,primary:Hi(2089,2082),weight:100}})}_run(e,t){e.moveSelectionToNextFindMatch(t)}}class xTe extends Wm{constructor(){super({id:"editor.action.moveSelectionToPreviousFindMatch",label:p("moveSelectionToPreviousFindMatch","Move Last Selection To Previous Find Match"),alias:"Move Last Selection To Previous Find Match",precondition:void 0})}_run(e,t){e.moveSelectionToPreviousFindMatch(t)}}class kTe extends Wm{constructor(){super({id:"editor.action.selectHighlights",label:p("selectAllOccurrencesOfFindMatch","Select All Occurrences of Find Match"),alias:"Select All Occurrences of Find Match",precondition:void 0,kbOpts:{kbExpr:I.focus,primary:3114,weight:100},menuOpts:{menuId:M.MenubarSelectionMenu,group:"3_multi",title:p({key:"miSelectHighlights",comment:["&& denotes a mnemonic"]},"Select All &&Occurrences"),order:7}})}_run(e,t){e.selectAll(t)}}class DTe extends Wm{constructor(){super({id:"editor.action.changeAll",label:p("changeAll.label","Change All Occurrences"),alias:"Change All Occurrences",precondition:q.and(I.writable,I.editorTextFocus),kbOpts:{kbExpr:I.editorTextFocus,primary:2108,weight:100},contextMenuOpts:{group:"1_modification",order:1.2}})}_run(e,t){e.selectAll(t)}}class ITe{constructor(e,t,i,n,o){this._model=e,this._searchText=t,this._matchCase=i,this._wordSeparators=n,this._modelVersionId=this._model.getVersionId(),this._cachedFindMatches=null,o&&this._model===o._model&&this._searchText===o._searchText&&this._matchCase===o._matchCase&&this._wordSeparators===o._wordSeparators&&this._modelVersionId===o._modelVersionId&&(this._cachedFindMatches=o._cachedFindMatches)}findMatches(){return this._cachedFindMatches===null&&(this._cachedFindMatches=this._model.findMatches(this._searchText,!0,!1,this._matchCase,this._wordSeparators,!1).map(e=>e.range),this._cachedFindMatches.sort(k.compareRangesUsingStarts)),this._cachedFindMatches}}let QS=class extends B{static{pA=this}static{this.ID="editor.contrib.selectionHighlighter"}constructor(e,t){super(),this._languageFeaturesService=t,this.editor=e,this._isEnabled=e.getOption(109),this._decorations=e.createDecorationsCollection(),this.updateSoon=this._register(new It(()=>this._update(),300)),this.state=null,this._register(e.onDidChangeConfiguration(n=>{this._isEnabled=e.getOption(109)})),this._register(e.onDidChangeCursorSelection(n=>{this._isEnabled&&(n.selection.isEmpty()?n.reason===3?(this.state&&this._setState(null),this.updateSoon.schedule()):this._setState(null):this._update())})),this._register(e.onDidChangeModel(n=>{this._setState(null)})),this._register(e.onDidChangeModelContent(n=>{this._isEnabled&&this.updateSoon.schedule()}));const i=Ks.get(e);i&&this._register(i.getState().onFindReplaceStateChange(n=>{this._update()})),this.updateSoon.schedule()}_update(){this._setState(pA._createState(this.state,this._isEnabled,this.editor))}static _createState(e,t,i){if(!t||!i.hasModel())return null;const n=i.getSelection();if(n.startLineNumber!==n.endLineNumber)return null;const o=rm.get(i);if(!o)return null;const r=Ks.get(i);if(!r)return null;let a=o.getSession(r);if(!a){const d=i.getSelections();if(d.length>1){const u=r.getState().matchCase;if(!GK(i.getModel(),d,u))return null}a=nC.create(i,r)}if(!a||a.currentMatch||/^[ \t]+$/.test(a.searchText)||a.searchText.length>200)return null;const l=r.getState(),c=l.matchCase;if(l.isRevealed){let d=l.searchString;c||(d=d.toLowerCase());let h=a.searchText;if(c||(h=h.toLowerCase()),d===h&&a.matchCase===l.matchCase&&a.wholeWord===l.wholeWord&&!l.isRegex)return null}return new ITe(i.getModel(),a.searchText,a.matchCase,a.wholeWord?i.getOption(132):null,e)}_setState(e){if(this.state=e,!this.state){this._decorations.clear();return}if(!this.editor.hasModel())return;const t=this.editor.getModel();if(t.isTooLargeForTokenization())return;const i=this.state.findMatches(),n=this.editor.getSelections();n.sort(k.compareRangesUsingStarts);const o=[];for(let c=0,d=0,h=i.length,u=n.length;c<h;){const g=i[c];if(d>=u)o.push(g),c++;else{const f=k.compareRangesUsingStarts(g,n[d]);f<0?((n[d].isEmpty()||!k.areIntersecting(g,n[d]))&&o.push(g),c++):(f>0||c++,d++)}}const r=this.editor.getOption(81)!=="off",a=this._languageFeaturesService.documentHighlightProvider.has(t)&&r,l=o.map(c=>({range:c,options:fTe(a)}));this._decorations.set(l)}dispose(){this._setState(null),super.dispose()}};QS=pA=pTe([mTe(1,pe)],QS);function GK(s,e,t){const i=k8(s,e[0],!t);for(let n=1,o=e.length;n<o;n++){const r=e[n];if(r.isEmpty())return!1;const a=k8(s,r,!t);if(i!==a)return!1}return!0}function k8(s,e,t){const i=s.getValueInRange(e);return t?i.toLowerCase():i}class TTe extends ge{constructor(){super({id:"editor.action.focusNextCursor",label:p("mutlicursor.focusNextCursor","Focus Next Cursor"),metadata:{description:p("mutlicursor.focusNextCursor.description","Focuses the next cursor"),args:[]},alias:"Focus Next Cursor",precondition:void 0})}run(e,t,i){if(!t.hasModel())return;const n=t._getViewModel();if(n.cursorConfig.readOnly)return;n.model.pushStackElement();const o=Array.from(n.getCursorStates()),r=o.shift();r&&(o.push(r),n.setCursorStates(i.source,3,o),n.revealPrimaryCursor(i.source,!0),kh(o,n.getCursorStates()))}}class ETe extends ge{constructor(){super({id:"editor.action.focusPreviousCursor",label:p("mutlicursor.focusPreviousCursor","Focus Previous Cursor"),metadata:{description:p("mutlicursor.focusPreviousCursor.description","Focuses the previous cursor"),args:[]},alias:"Focus Previous Cursor",precondition:void 0})}run(e,t,i){if(!t.hasModel())return;const n=t._getViewModel();if(n.cursorConfig.readOnly)return;n.model.pushStackElement();const o=Array.from(n.getCursorStates()),r=o.pop();r&&(o.unshift(r),n.setCursorStates(i.source,3,o),n.revealPrimaryCursor(i.source,!0),kh(o,n.getCursorStates()))}}ct(rm.ID,rm,4);ct(QS.ID,QS,1);Q(_Te);Q(bTe);Q(vTe);Q(wTe);Q(STe);Q(LTe);Q(xTe);Q(kTe);Q(DTe);Q(CTe);Q(yTe);Q(TTe);Q(ETe);const NTe="editor.action.inlineEdit.accept",RTe="editor.action.inlineEdit.reject",MTe="editor.action.inlineEdit.jumpTo",ATe="editor.action.inlineEdit.jumpBack";var PTe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},OTe=function(s,e){return function(t,i){e(t,i,s)}};const kI="inline-edit";let mA=class extends B{constructor(e,t,i){super(),this.editor=e,this.model=t,this.languageService=i,this.isDisposed=Ze(this,!1),this.currentTextModel=kt(this,this.editor.onDidChangeModel,()=>this.editor.getModel()),this.uiState=_e(this,n=>{if(this.isDisposed.read(n))return;const o=this.currentTextModel.read(n);if(o!==this.model.targetTextModel.read(n))return;const r=this.model.ghostText.read(n);if(!r)return;let a=this.model.range?.read(n);a&&a.startLineNumber===a.endLineNumber&&a.startColumn===a.endColumn&&(a=void 0);const l=(a?a.startLineNumber===a.endLineNumber:!0)&&r.parts.length===1&&r.parts[0].lines.length===1,c=r.parts.length===1&&r.parts[0].lines.every(v=>v.length===0),d=[],h=[];function u(v,C){if(h.length>0){const y=h[h.length-1];C&&y.decorations.push(new ms(y.content.length+1,y.content.length+1+v[0].length,C,0)),y.content+=v[0],v=v.slice(1)}for(const y of v)h.push({content:y,decorations:C?[new ms(1,y.length+1,C,0)]:[]})}const g=o.getLineContent(r.lineNumber);let f,m=0;if(!c&&(l||!a)){for(const v of r.parts){let C=v.lines;a&&!l&&(u(C,kI),C=[]),f===void 0?(d.push({column:v.column,text:C[0],preview:v.preview}),C=C.slice(1)):u([g.substring(m,v.column-1)],void 0),C.length>0&&(u(C,kI),f===void 0&&v.column<=g.length&&(f=v.column)),m=v.column-1}f!==void 0&&u([g.substring(m)],void 0)}const _=f!==void 0?new EK(f,g.length+1):void 0,b=l||!a?r.lineNumber:a.endLineNumber-1;return{inlineTexts:d,additionalLines:h,hiddenRange:_,lineNumber:b,additionalReservedLineCount:this.model.minReservedLineCount.read(n),targetTextModel:o,range:a,isSingleLine:l,isPureRemove:c}}),this.decorations=_e(this,n=>{const o=this.uiState.read(n);if(!o)return[];const r=[];if(o.hiddenRange&&r.push({range:o.hiddenRange.toRange(o.lineNumber),options:{inlineClassName:"inline-edit-hidden",description:"inline-edit-hidden"}}),o.range){const a=[];if(o.isSingleLine)a.push(o.range);else if(!o.isPureRemove){const l=o.range.endLineNumber-o.range.startLineNumber;for(let c=0;c<l;c++){const d=o.range.startLineNumber+c,h=o.targetTextModel.getLineFirstNonWhitespaceColumn(d),u=o.targetTextModel.getLineLastNonWhitespaceColumn(d),g=new k(d,h,d,u);a.push(g)}}for(const l of a)r.push({range:l,options:jp})}if(o.range&&!o.isSingleLine&&o.isPureRemove){const a=new k(o.range.startLineNumber,1,o.range.endLineNumber-1,1);r.push({range:a,options:Ov})}for(const a of o.inlineTexts)r.push({range:k.fromPositions(new P(o.lineNumber,a.column)),options:{description:kI,after:{content:a.text,inlineClassName:a.preview?"inline-edit-decoration-preview":"inline-edit-decoration",cursorStops:Zr.Left},showIfCollapsed:!0}});return r}),this._register(Ce(()=>{this.isDisposed.set(!0,void 0)})),this._register(NK(this.editor,this.decorations))}};mA=PTe([OTe(2,ni)],mA);var N4=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},ml=function(s,e){return function(t,i){e(t,i,s)}},u1;let _A=class extends B{constructor(e,t,i){super(),this.editor=e,this.model=t,this.instantiationService=i,this.alwaysShowToolbar=kt(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(63).showToolbar==="always"),this.sessionPosition=void 0,this.position=_e(this,n=>{const o=this.model.read(n)?.model.ghostText.read(n);if(!this.alwaysShowToolbar.read(n)||!o||o.parts.length===0)return this.sessionPosition=void 0,null;const r=o.parts[0].column;this.sessionPosition&&this.sessionPosition.lineNumber!==o.lineNumber&&(this.sessionPosition=void 0);const a=new P(o.lineNumber,Math.min(r,this.sessionPosition?.column??Number.MAX_SAFE_INTEGER));return this.sessionPosition=a,a}),this._register(Us((n,o)=>{if(!this.model.read(n)||!this.alwaysShowToolbar.read(n))return;const a=o.add(this.instantiationService.createInstance(bA,this.editor,!0,this.position));e.addContentWidget(a),o.add(Ce(()=>e.removeContentWidget(a)))}))}};_A=N4([ml(2,ye)],_A);let bA=class extends B{static{u1=this}static{this._dropDownVisible=!1}static{this.id=0}constructor(e,t,i,n,o,r){super(),this.editor=e,this.withBorder=t,this._position=i,this._contextKeyService=o,this._menuService=r,this.id=`InlineEditHintsContentWidget${u1.id++}`,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this.nodes=Ye("div.inlineEditHints",{className:this.withBorder?".withBorder":""},[Ye("div@toolBar")]),this.inlineCompletionsActionsMenus=this._register(this._menuService.createMenu(M.InlineEditActions,this._contextKeyService)),this.toolBar=this._register(n.createInstance(vA,this.nodes.toolBar,this.editor,M.InlineEditToolbar,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:a=>a.startsWith("primary")},actionViewItemProvider:(a,l)=>{if(a instanceof uo)return n.createInstance(FTe,a,void 0)},telemetrySource:"InlineEditToolbar"})),this._register(this.toolBar.onDidChangeDropdownVisibility(a=>{u1._dropDownVisible=a})),this._register(Pe(a=>{this._position.read(a),this.editor.layoutContentWidget(this)})),this._register(Pe(a=>{const l=[];for(const[c,d]of this.inlineCompletionsActionsMenus.getActions())for(const h of d)h instanceof uo&&l.push(h);l.length>0&&l.unshift(new ji),this.toolBar.setAdditionalSecondaryActions(l)}))}getId(){return this.id}getDomNode(){return this.nodes.root}getPosition(){return{position:this._position.get(),preference:[1,2],positionAffinity:3}}};bA=u1=N4([ml(3,ye),ml(4,Ee),ml(5,qo)],bA);class FTe extends lh{updateLabel(){const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){const t=Ye("div.keybinding").root;this._register(new Em(t,lo,{disableTitle:!0,..._$})).set(e),this.label.textContent=this._action.label,this.label.appendChild(t),this.label.classList.add("inlineEditStatusBarItemLabel")}}updateTooltip(){}}let vA=class extends Bv{constructor(e,t,i,n,o,r,a,l,c,d){super(e,{resetMenu:i,...n},o,r,a,l,c,d),this.editor=t,this.menuId=i,this.options2=n,this.menuService=o,this.contextKeyService=r,this.menu=this._store.add(this.menuService.createMenu(this.menuId,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.additionalActions=[],this.prependedPrimaryActions=[],this._store.add(this.menu.onDidChange(()=>this.updateToolbar())),this._store.add(this.editor.onDidChangeCursorPosition(()=>this.updateToolbar())),this.updateToolbar()}updateToolbar(){const e=[],t=[];cx(this.menu,this.options2?.menuOptions,{primary:e,secondary:t},this.options2?.toolbarOptions?.primaryGroup,this.options2?.toolbarOptions?.shouldInlineSubmenu,this.options2?.toolbarOptions?.useSeparatorsInPrimaryActions),t.push(...this.additionalActions),e.unshift(...this.prependedPrimaryActions),this.setActions(e,t)}setAdditionalSecondaryActions(e){ii(this.additionalActions,e,(t,i)=>t===i)||(this.additionalActions=e,this.updateToolbar())}};vA=N4([ml(4,qo),ml(5,Ee),ml(6,bo),ml(7,yt),ml(8,Ht),ml(9,jn)],vA);var YK=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},g1=function(s,e){return function(t,i){e(t,i,s)}},H_,CA;function*BTe(s,e,t=1){e===void 0&&([e,s]=[s,0]);for(let i=s;i<e;i+=t)yield i}function DI(s){const e=s[0].match(/^\s*/)?.[0]??"",t=e.length;return{text:s.map(i=>i.replace(new RegExp("^"+e),"")),shift:t}}let yA=class extends B{static{H_=this}static{this._modelId=0}static _createUniqueUri(){return Se.from({scheme:"inline-edit-widget",path:new Date().toString()+String(H_._modelId++)})}constructor(e,t,i,n,o){super(),this._editor=e,this._model=t,this._instantiationService=i,this._diffProviderFactoryService=n,this._modelService=o,this._position=_e(this,r=>{const a=this._model.read(r);if(!a||a.text.length===0||a.range.startLineNumber===a.range.endLineNumber&&!(a.range.startColumn===a.range.endColumn&&a.range.startColumn===1))return null;const l=this._editor.getModel();if(!l)return null;const c=Array.from(BTe(a.range.startLineNumber,a.range.endLineNumber+1)),d=c.map(m=>l.getLineLastNonWhitespaceColumn(m)),h=Math.max(...d),u=c[d.indexOf(h)],g=new P(u,h);return{top:a.range.startLineNumber,left:g}}),this._text=_e(this,r=>{const a=this._model.read(r);if(!a)return{text:"",shift:0};const l=DI(a.text.split(`
`));return{text:l.text.join(`
`),shift:l.shift}}),this._originalModel=Jn(()=>this._modelService.createModel("",null,H_._createUniqueUri())).keepObserved(this._store),this._modifiedModel=Jn(()=>this._modelService.createModel("",null,H_._createUniqueUri())).keepObserved(this._store),this._diff=_e(this,r=>this._diffPromise.read(r)?.promiseResult.read(r)?.data),this._diffPromise=_e(this,r=>{const a=this._model.read(r);if(!a)return;const l=this._editor.getModel();if(!l)return;const c=DI(l.getValueInRange(a.range).split(`
`)).text.join(`
`),d=DI(a.text.split(`
`)).text.join(`
`);this._originalModel.get().setValue(c),this._modifiedModel.get().setValue(d);const h=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:"advanced"});return rx.fromFn(async()=>{const u=await h.computeDiff(this._originalModel.get(),this._modifiedModel.get(),{computeMoves:!1,ignoreTrimWhitespace:!1,maxComputationTimeMs:1e3},Ue.None);if(!u.identical)return u.changes})}),this._register(Us((r,a)=>{if(!this._model.read(r)||this._position.get()===null)return;const c=a.add(this._instantiationService.createInstance(wA,this._editor,this._position,this._text.map(d=>d.text),this._text.map(d=>d.shift),this._diff));e.addOverlayWidget(c),a.add(Ce(()=>e.removeOverlayWidget(c)))}))}};yA=H_=YK([g1(2,ye),g1(3,$C),g1(4,Zt)],yA);let wA=class extends B{static{CA=this}static{this.id=0}constructor(e,t,i,n,o,r){super(),this._editor=e,this._position=t,this._text=i,this._shift=n,this._diff=o,this._instantiationService=r,this.id=`InlineEditSideBySideContentWidget${CA.id++}`,this.allowEditorOverflow=!1,this._nodes=te("div.inlineEditSideBySide",void 0),this._scrollChanged=En("editor.onDidScrollChange",this._editor.onDidScrollChange),this._previewEditor=this._register(this._instantiationService.createInstance(ta,this._nodes,{glyphMargin:!1,lineNumbers:"off",minimap:{enabled:!1},guides:{indentation:!1,bracketPairs:!1,bracketPairsHorizontal:!1,highlightActiveIndentation:!1},folding:!1,selectOnLineNumbers:!1,selectionHighlight:!1,columnSelection:!1,overviewRulerBorder:!1,overviewRulerLanes:0,lineDecorationsWidth:0,lineNumbersMinChars:0,scrollbar:{vertical:"hidden",horizontal:"hidden",alwaysConsumeMouseWheel:!1,handleMouseWheel:!1},readOnly:!0,wordWrap:"off",wordWrapOverride1:"off",wordWrapOverride2:"off",wrappingIndent:"none",wrappingStrategy:void 0},{contributions:[],isSimpleWidget:!0},this._editor)),this._previewEditorObs=ao(this._previewEditor),this._editorObs=ao(this._editor),this._previewTextModel=this._register(this._instantiationService.createInstance(Da,"",this._editor.getModel()?.getLanguageId()??Cs,Da.DEFAULT_CREATION_OPTIONS,null)),this._setText=_e(a=>{const l=this._text.read(a);l&&this._previewTextModel.setValue(l)}).recomputeInitiallyAndOnChange(this._store),this._decorations=_e(this,a=>{this._setText.read(a);const l=this._position.read(a);if(!l)return{org:[],mod:[]};const c=this._diff.read(a);if(!c)return{org:[],mod:[]};const d=[],h=[];if(c.length===1&&c[0].innerChanges[0].modifiedRange.equalsRange(this._previewTextModel.getFullModelRange()))return{org:[],mod:[]};const u=this._shift.get(),g=f=>new k(f.startLineNumber+l.top-1,f.startColumn+u,f.endLineNumber+l.top-1,f.endColumn+u);for(const f of c)if(f.original.isEmpty||d.push({range:g(f.original.toInclusiveRange()),options:Ov}),f.modified.isEmpty||h.push({range:f.modified.toInclusiveRange(),options:pS}),f.modified.isEmpty||f.original.isEmpty)f.original.isEmpty||d.push({range:g(f.original.toInclusiveRange()),options:bF}),f.modified.isEmpty||h.push({range:f.modified.toInclusiveRange(),options:mF});else for(const m of f.innerChanges||[])f.original.contains(m.originalRange.startLineNumber)&&d.push({range:g(m.originalRange),options:m.originalRange.isEmpty()?vF:jp}),f.modified.contains(m.modifiedRange.startLineNumber)&&h.push({range:m.modifiedRange,options:m.modifiedRange.isEmpty()?_F:mS});return{org:d,mod:h}}),this._originalDecorations=_e(this,a=>this._decorations.read(a).org),this._modifiedDecorations=_e(this,a=>this._decorations.read(a).mod),this._previewEditor.setModel(this._previewTextModel),this._register(this._editorObs.setDecorations(this._originalDecorations)),this._register(this._previewEditorObs.setDecorations(this._modifiedDecorations)),this._register(Pe(a=>{const l=this._previewEditorObs.contentWidth.read(a),c=this._text.read(a).split(`
`).length-1,d=this._editor.getOption(67)*c;l<=0||this._previewEditor.layout({height:d,width:l})})),this._register(Pe(a=>{this._position.read(a),this._editor.layoutOverlayWidget(this)})),this._register(Pe(a=>{this._scrollChanged.read(a),this._position.read(a)&&this._editor.layoutOverlayWidget(this)}))}getId(){return this.id}getDomNode(){return this._nodes}getPosition(){const e=this._position.get();if(!e)return null;const t=this._editor.getLayoutInfo(),i=this._editor.getScrolledVisiblePosition(new P(e.top,1));if(!i)return null;const n=i.top-1,o=this._editor.getOffsetForColumn(e.left.lineNumber,e.left.column);return{preference:{left:t.contentLeft+o+10,top:n}}}};wA=CA=YK([g1(5,ye)],wA);var WTe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},$h=function(s,e){return function(t,i){e(t,i,s)}},V_;let _s=class extends B{static{V_=this}static{this.ID="editor.contrib.inlineEditController"}static{this.inlineEditVisibleKey="inlineEditVisible"}static{this.inlineEditVisibleContext=new le(this.inlineEditVisibleKey,!1)}static{this.cursorAtInlineEditKey="cursorAtInlineEdit"}static{this.cursorAtInlineEditContext=new le(this.cursorAtInlineEditKey,!1)}static get(e){return e.getContribution(V_.ID)}constructor(e,t,i,n,o,r,a,l){super(),this.editor=e,this.instantiationService=t,this.contextKeyService=i,this.languageFeaturesService=n,this._commandService=o,this._configurationService=r,this._diffProviderFactoryService=a,this._modelService=l,this._isVisibleContext=V_.inlineEditVisibleContext.bindTo(this.contextKeyService),this._isCursorAtInlineEditContext=V_.cursorAtInlineEditContext.bindTo(this.contextKeyService),this._currentEdit=Ze(this,void 0),this._currentWidget=Jn(this._currentEdit,f=>{const m=this._currentEdit.read(f);if(!m)return;const _=m.range.endLineNumber,b=m.range.endColumn,v=m.text.endsWith(`
`)&&!(m.range.startLineNumber===m.range.endLineNumber&&m.range.startColumn===m.range.endColumn)?m.text.slice(0,-1):m.text,C=new Qv(_,[new HS(b,v,!1)]),y=m.range.startLineNumber===m.range.endLineNumber&&C.parts.length===1&&C.parts[0].lines.length===1,w=m.text==="";return!y&&!w?void 0:this.instantiationService.createInstance(mA,this.editor,{ghostText:fr(C),minReservedLineCount:fr(0),targetTextModel:fr(this.editor.getModel()??void 0),range:fr(m.range)})}),this._isAccepting=Ze(this,!1),this._enabled=kt(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(63).enabled),this._fontFamily=kt(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(63).fontFamily);const c=En("InlineEditController.modelContentChangedSignal",e.onDidChangeModelContent);this._register(Pe(f=>{this._enabled.read(f)&&(c.read(f),!this._isAccepting.read(f)&&this.getInlineEdit(e,!0))}));const d=kt(this,e.onDidChangeCursorPosition,()=>e.getPosition());this._register(Pe(f=>{if(!this._enabled.read(f))return;const m=d.read(f);m&&this.checkCursorPosition(m)})),this._register(Pe(f=>{const m=this._currentEdit.read(f);if(this._isCursorAtInlineEditContext.set(!1),!m){this._isVisibleContext.set(!1);return}this._isVisibleContext.set(!0);const _=e.getPosition();_&&this.checkCursorPosition(_)}));const h=En("InlineEditController.editorBlurSignal",e.onDidBlurEditorWidget);this._register(Pe(async f=>{this._enabled.read(f)&&(h.read(f),!(this._configurationService.getValue("editor.experimentalInlineEdit.keepOnBlur")||e.getOption(63).keepOnBlur)&&(this._currentRequestCts?.dispose(!0),this._currentRequestCts=void 0,await this.clear(!1)))}));const u=En("InlineEditController.editorFocusSignal",e.onDidFocusEditorText);this._register(Pe(f=>{this._enabled.read(f)&&(u.read(f),this.getInlineEdit(e,!0))}));const g=this._register(J6());this._register(Pe(f=>{const m=this._fontFamily.read(f);g.setStyle(m===""||m==="default"?"":`
.monaco-editor .inline-edit-decoration,
.monaco-editor .inline-edit-decoration-preview,
.monaco-editor .inline-edit {
	font-family: ${m};
}`)})),this._register(new _A(this.editor,this._currentWidget,this.instantiationService)),this._register(new yA(this.editor,this._currentEdit,this.instantiationService,this._diffProviderFactoryService,this._modelService))}checkCursorPosition(e){if(!this._currentEdit){this._isCursorAtInlineEditContext.set(!1);return}const t=this._currentEdit.get();if(!t){this._isCursorAtInlineEditContext.set(!1);return}this._isCursorAtInlineEditContext.set(k.containsPosition(t.range,e))}validateInlineEdit(e,t){if(t.text.includes(`
`)&&t.range.startLineNumber!==t.range.endLineNumber&&t.range.startColumn!==t.range.endColumn){if(t.range.startColumn!==1)return!1;const n=t.range.endLineNumber,o=t.range.endColumn,r=e.getModel()?.getLineLength(n)??0;if(o!==r+1)return!1}return!0}async fetchInlineEdit(e,t){this._currentRequestCts&&this._currentRequestCts.dispose(!0);const i=e.getModel();if(!i)return;const n=i.getVersionId(),o=this.languageFeaturesService.inlineEditProvider.all(i);if(o.length===0)return;const r=o[0];this._currentRequestCts=new li;const a=this._currentRequestCts.token,l=t?P1.Automatic:P1.Invoke;if(t&&await HTe(50,a),a.isCancellationRequested||i.isDisposed()||i.getVersionId()!==n)return;const d=await r.provideInlineEdit(i,{triggerKind:l},a);if(d&&!(a.isCancellationRequested||i.isDisposed()||i.getVersionId()!==n)&&this.validateInlineEdit(e,d))return d}async getInlineEdit(e,t){this._isCursorAtInlineEditContext.set(!1),await this.clear();const i=await this.fetchInlineEdit(e,t);i&&this._currentEdit.set(i,void 0)}async trigger(){await this.getInlineEdit(this.editor,!1)}async jumpBack(){this._jumpBackPosition&&(this.editor.setPosition(this._jumpBackPosition),this.editor.revealPositionInCenterIfOutsideViewport(this._jumpBackPosition))}async accept(){this._isAccepting.set(!0,void 0);const e=this._currentEdit.get();if(!e)return;let t=e.text;e.text.startsWith(`
`)&&(t=e.text.substring(1)),this.editor.pushUndoStop(),this.editor.executeEdits("acceptCurrent",[ri.replace(k.lift(e.range),t)]),e.accepted&&await this._commandService.executeCommand(e.accepted.id,...e.accepted.arguments||[]).then(void 0,Li),this.freeEdit(e),ai(i=>{this._currentEdit.set(void 0,i),this._isAccepting.set(!1,i)})}jumpToCurrent(){this._jumpBackPosition=this.editor.getSelection()?.getStartPosition();const e=this._currentEdit.get();if(!e)return;const t=P.lift({lineNumber:e.range.startLineNumber,column:e.range.startColumn});this.editor.setPosition(t),this.editor.revealPositionInCenterIfOutsideViewport(t)}async clear(e=!0){const t=this._currentEdit.get();t&&t?.rejected&&e&&await this._commandService.executeCommand(t.rejected.id,...t.rejected.arguments||[]).then(void 0,Li),t&&this.freeEdit(t),this._currentEdit.set(void 0,void 0)}freeEdit(e){const t=this.editor.getModel();if(!t)return;const i=this.languageFeaturesService.inlineEditProvider.all(t);i.length!==0&&i[0].freeInlineEdit(e)}};_s=V_=WTe([$h(1,ye),$h(2,Ee),$h(3,pe),$h(4,Ht),$h(5,Ke),$h(6,$C),$h(7,Zt)],_s);function HTe(s,e){return new Promise(t=>{let i;const n=setTimeout(()=>{i&&i.dispose(),t()},s);e&&(i=e.onCancellationRequested(()=>{clearTimeout(n),i&&i.dispose(),t()}))})}let VTe=class extends ge{constructor(){super({id:NTe,label:"Accept Inline Edit",alias:"Accept Inline Edit",precondition:q.and(I.writable,_s.inlineEditVisibleContext),kbOpts:[{weight:101,primary:2,kbExpr:q.and(I.writable,_s.inlineEditVisibleContext,_s.cursorAtInlineEditContext)}],menuOpts:[{menuId:M.InlineEditToolbar,title:"Accept",group:"primary",order:1}]})}async run(e,t){await _s.get(t)?.accept()}};class zTe extends ge{constructor(){const e=q.and(I.writable,q.not(_s.inlineEditVisibleKey));super({id:"editor.action.inlineEdit.trigger",label:"Trigger Inline Edit",alias:"Trigger Inline Edit",precondition:e,kbOpts:{weight:101,primary:2646,kbExpr:e}})}async run(e,t){_s.get(t)?.trigger()}}class UTe extends ge{constructor(){const e=q.and(I.writable,_s.inlineEditVisibleContext,q.not(_s.cursorAtInlineEditKey));super({id:MTe,label:"Jump to Inline Edit",alias:"Jump to Inline Edit",precondition:e,kbOpts:{weight:101,primary:2646,kbExpr:e},menuOpts:[{menuId:M.InlineEditToolbar,title:"Jump To Edit",group:"primary",order:3,when:e}]})}async run(e,t){_s.get(t)?.jumpToCurrent()}}class $Te extends ge{constructor(){const e=q.and(I.writable,_s.cursorAtInlineEditContext);super({id:ATe,label:"Jump Back from Inline Edit",alias:"Jump Back from Inline Edit",precondition:e,kbOpts:{weight:110,primary:2646,kbExpr:e},menuOpts:[{menuId:M.InlineEditToolbar,title:"Jump Back",group:"primary",order:3,when:e}]})}async run(e,t){_s.get(t)?.jumpBack()}}class jTe extends ge{constructor(){const e=q.and(I.writable,_s.inlineEditVisibleContext);super({id:RTe,label:"Reject Inline Edit",alias:"Reject Inline Edit",precondition:e,kbOpts:{weight:100,primary:9,kbExpr:e},menuOpts:[{menuId:M.InlineEditToolbar,title:"Reject",group:"secondary",order:2}]})}async run(e,t){await _s.get(t)?.clear()}}Q(VTe);Q(jTe);Q(UTe);Q($Te);Q(zTe);ct(_s.ID,_s,3);const ZTe="editor.action.inlineEdits.accept",KTe="editor.action.inlineEdits.showPrevious",qTe="editor.action.inlineEdits.showNext",am=new le("inlineEditsVisible",!1,p("inlineEditsVisible","Whether an inline edit is visible")),GTe=new le("inlineEditsIsPinned",!1,p("isPinned","Whether an inline edit is visible"));class SA extends B{static{this.ID="editor.contrib.placeholderText"}constructor(e){super(),this._editor=e,this._editorObs=ao(this._editor),this._placeholderText=this._editorObs.getOption(88),this._state=Ao({owner:this,equalsFn:C0},t=>{const i=this._placeholderText.read(t);if(i&&this._editorObs.valueIsEmpty.read(t))return{placeholder:i}}),this._shouldViewBeAlive=YTe(this,t=>this._state.read(t)?.placeholder!==void 0),this._view=wh((t,i)=>{if(!this._shouldViewBeAlive.read(t))return;const n=Ye("div.editorPlaceholder");i.add(Pe(o=>{const r=this._state.read(o),a=r?.placeholder!==void 0;n.root.style.display=a?"block":"none",n.root.innerText=r?.placeholder??""})),i.add(Pe(o=>{const r=this._editorObs.layoutInfo.read(o);n.root.style.left=`${r.contentLeft}px`,n.root.style.width=r.contentWidth-r.verticalScrollbarWidth+"px",n.root.style.top=`${this._editor.getTopForLineNumber(0)}px`})),i.add(Pe(o=>{n.root.style.fontFamily=this._editorObs.getOption(49).read(o),n.root.style.fontSize=this._editorObs.getOption(52).read(o)+"px",n.root.style.lineHeight=this._editorObs.getOption(67).read(o)+"px"})),i.add(this._editorObs.createOverlayWidget({allowEditorOverflow:!1,minContentWidthInPx:fr(0),position:fr(null),domNode:n.root}))}),this._view.recomputeInitiallyAndOnChange(this._store)}}function YTe(s,e){return PC(s,(t,i)=>i===!0?!0:e(t))}var XTe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},QTe=function(s,e){return function(t,i){e(t,i,s)}};class JTe{constructor(e,t,i){this.range=e,this.newLines=t,this.changes=i}}let LA=class extends B{constructor(e,t,i,n){super(),this._editor=e,this._edit=t,this._userPrompt=i,this._instantiationService=n,this._editorObs=ao(this._editor),this._elements=Ye("div.inline-edits-widget",{style:{position:"absolute",overflow:"visible",top:"0px",left:"0px"}},[Ye("div@editorContainer",{style:{position:"absolute",top:"0px",left:"0px",width:"500px",height:"500px"}},[Ye("div.toolbar@toolbar",{style:{position:"absolute",top:"-25px",left:"0px"}}),Ye("div.promptEditor@promptEditor",{style:{position:"absolute",top:"-25px",left:"80px",width:"300px",height:"22px"}}),Ye("div.preview@editor",{style:{position:"absolute",top:"0px",left:"0px"}})]),Wg("svg",{style:{overflow:"visible",pointerEvents:"none"}},[Wg("defs",[Wg("linearGradient",{id:"Gradient2",x1:"0",y1:"0",x2:"1",y2:"0"},[Wg("stop",{offset:"0%",class:"gradient-stop"}),Wg("stop",{offset:"100%",class:"gradient-stop"})])]),Wg("path@path",{d:"",fill:"url(#Gradient2)"})])]),this._previewTextModel=this._register(this._instantiationService.createInstance(Da,"",Cs,Da.DEFAULT_CREATION_OPTIONS,null)),this._setText=_e(r=>{const a=this._edit.read(r);a&&this._previewTextModel.setValue(a.newLines.join(`
`))}).recomputeInitiallyAndOnChange(this._store),this._promptTextModel=this._register(this._instantiationService.createInstance(Da,"",Cs,Da.DEFAULT_CREATION_OPTIONS,null)),this._promptEditor=this._register(this._instantiationService.createInstance(ta,this._elements.promptEditor,{glyphMargin:!1,lineNumbers:"off",minimap:{enabled:!1},guides:{indentation:!1,bracketPairs:!1,bracketPairsHorizontal:!1,highlightActiveIndentation:!1},folding:!1,selectOnLineNumbers:!1,selectionHighlight:!1,columnSelection:!1,overviewRulerBorder:!1,overviewRulerLanes:0,lineDecorationsWidth:0,lineNumbersMinChars:0,placeholder:"Describe the change you want...",fontFamily:ej},{contributions:Iu.getSomeEditorContributions([Kr.ID,SA.ID,Jp.ID]),isSimpleWidget:!0},this._editor)),this._previewEditor=this._register(this._instantiationService.createInstance(ta,this._elements.editor,{glyphMargin:!1,lineNumbers:"off",minimap:{enabled:!1},guides:{indentation:!1,bracketPairs:!1,bracketPairsHorizontal:!1,highlightActiveIndentation:!1},folding:!1,selectOnLineNumbers:!1,selectionHighlight:!1,columnSelection:!1,overviewRulerBorder:!1,overviewRulerLanes:0,lineDecorationsWidth:0,lineNumbersMinChars:0},{contributions:[]},this._editor)),this._previewEditorObs=ao(this._previewEditor),this._decorations=_e(this,r=>{this._setText.read(r);const a=this._edit.read(r)?.changes;if(!a)return[];const l=[],c=[];if(a.length===1&&a[0].innerChanges[0].modifiedRange.equalsRange(this._previewTextModel.getFullModelRange()))return[];for(const d of a)if(d.original.isEmpty||l.push({range:d.original.toInclusiveRange(),options:Ov}),d.modified.isEmpty||c.push({range:d.modified.toInclusiveRange(),options:pS}),d.modified.isEmpty||d.original.isEmpty)d.original.isEmpty||l.push({range:d.original.toInclusiveRange(),options:bF}),d.modified.isEmpty||c.push({range:d.modified.toInclusiveRange(),options:mF});else for(const h of d.innerChanges||[])d.original.contains(h.originalRange.startLineNumber)&&l.push({range:h.originalRange,options:h.originalRange.isEmpty()?vF:jp}),d.modified.contains(h.modifiedRange.startLineNumber)&&c.push({range:h.modifiedRange,options:h.modifiedRange.isEmpty()?_F:mS});return c}),this._layout1=_e(this,r=>{const a=this._editor.getModel(),l=this._edit.read(r);if(!l)return null;const c=l.range;let d=0;for(let g=c.startLineNumber;g<c.endLineNumberExclusive;g++){const f=a.getLineMaxColumn(g),m=this._editor.getOffsetForColumn(g,f);d=Math.max(d,m)}return{left:this._editor.getLayoutInfo().contentLeft+d}}),this._layout=_e(this,r=>{const a=this._edit.read(r);if(!a)return null;const l=a.range,c=this._editorObs.scrollLeft.read(r),d=this._layout1.read(r).left+20-c,h=this._editor.getTopForLineNumber(l.startLineNumber)-this._editorObs.scrollTop.read(r),u=this._editor.getTopForLineNumber(l.endLineNumberExclusive)-this._editorObs.scrollTop.read(r),g=new zf(d,h),f=new zf(d,u),m=u-h,_=50,b=this._editor.getOption(67)*a.newLines.length,v=m-b,C=new zf(d+_,h+v/2),y=new zf(d+_,u-v/2);return{topCode:g,bottomCode:f,codeHeight:m,topEdit:C,bottomEdit:y,editHeight:b}});const o=_e(this,r=>this._edit.read(r)!==void 0||this._userPrompt.read(r)!==void 0);this._register(Uc(this._elements.root,{display:_e(this,r=>o.read(r)?"block":"none")})),this._register(Pf(this._editor.getDomNode(),this._elements.root)),this._register(ao(e).createOverlayWidget({domNode:this._elements.root,position:fr(null),allowEditorOverflow:!1,minContentWidthInPx:_e(r=>{const a=this._layout1.read(r)?.left;if(a===void 0)return 0;const l=this._previewEditorObs.contentWidth.read(r);return a+l})})),this._previewEditor.setModel(this._previewTextModel),this._register(this._previewEditorObs.setDecorations(this._decorations)),this._register(Pe(r=>{const a=this._layout.read(r);if(!a)return;const{topCode:l,bottomCode:c,topEdit:d,bottomEdit:h,editHeight:u}=a,g=10,f=0,m=40,_=new tEe().moveTo(l).lineTo(l.deltaX(g)).curveTo(l.deltaX(g+m),d.deltaX(-m-f),d.deltaX(-f)).lineTo(d).lineTo(h).lineTo(h.deltaX(-f)).curveTo(h.deltaX(-m-f),c.deltaX(g+m),c.deltaX(g)).lineTo(c).build();this._elements.path.setAttribute("d",_),this._elements.editorContainer.style.top=`${d.y}px`,this._elements.editorContainer.style.left=`${d.x}px`,this._elements.editorContainer.style.height=`${u}px`;const b=this._previewEditorObs.contentWidth.read(r);this._previewEditor.layout({height:u,width:b})})),this._promptEditor.setModel(this._promptTextModel),this._promptEditor.layout(),this._register(iEe(eEe(this._userPrompt,r=>r??"",r=>r),ao(this._promptEditor).value)),this._register(Pe(r=>{const a=ao(this._promptEditor).isFocused.read(r);this._elements.root.classList.toggle("focused",a)}))}};LA=XTe([QTe(3,ye)],LA);function eEe(s,e,t){return RC(void 0,i=>e(s.read(i)),(i,n)=>s.set(t(i),n))}class zf{constructor(e,t){this.x=e,this.y=t}deltaX(e){return new zf(this.x+e,this.y)}}class tEe{constructor(){this._data=""}moveTo(e){return this._data+=`M ${e.x} ${e.y} `,this}lineTo(e){return this._data+=`L ${e.x} ${e.y} `,this}curveTo(e,t,i){return this._data+=`C ${e.x} ${e.y} ${t.x} ${t.y} ${i.x} ${i.y} `,this}build(){return this._data}}function iEe(s,e){const t=new Z;return t.add(Pe(i=>{const n=s.read(i);e.set(n,void 0)})),t.add(Pe(i=>{const n=e.read(i);s.set(n,void 0)})),t}var nEe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},II=function(s,e){return function(t,i){e(t,i,s)}},z_;let xA=class extends B{static{z_=this}static{this._modelId=0}static _createUniqueUri(){return Se.from({scheme:"inline-edits",path:new Date().toString()+String(z_._modelId++)})}constructor(e,t,i,n,o,r,a){super(),this.textModel=e,this._textModelVersionId=t,this._selection=i,this._debounceValue=n,this.languageFeaturesService=o,this._diffProviderFactoryService=r,this._modelService=a,this._forceUpdateExplicitlySignal=km(this),this._selectedInlineCompletionId=Ze(this,void 0),this._isActive=Ze(this,!1),this._originalModel=Jn(()=>this._modelService.createModel("",null,z_._createUniqueUri())).keepObserved(this._store),this._modifiedModel=Jn(()=>this._modelService.createModel("",null,z_._createUniqueUri())).keepObserved(this._store),this._pinnedRange=new oEe(this.textModel,this._textModelVersionId),this.isPinned=this._pinnedRange.range.map(l=>!!l),this.userPrompt=Ze(this,void 0),this.inlineEdit=_e(this,l=>this._inlineEdit.read(l)?.promiseResult.read(l)?.data),this._inlineEdit=_e(this,l=>{const c=this.selectedInlineEdit.read(l);if(!c)return;const d=c.inlineCompletion.range;if(c.inlineCompletion.insertText.trim()==="")return;let h=c.inlineCompletion.insertText.split(/\r\n|\r|\n/);function u(_){const b=_[0].match(/^\s*/)?.[0]??"";return _.map(v=>v.replace(new RegExp("^"+b),""))}h=u(h);let f=this.textModel.getValueInRange(d).split(/\r\n|\r|\n/);f=u(f),this._originalModel.get().setValue(f.join(`
`)),this._modifiedModel.get().setValue(h.join(`
`));const m=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:"advanced"});return rx.fromFn(async()=>{const _=await m.computeDiff(this._originalModel.get(),this._modifiedModel.get(),{computeMoves:!1,ignoreTrimWhitespace:!1,maxComputationTimeMs:1e3},Ue.None);if(!_.identical)return new JTe(He.fromRangeInclusive(d),u(h),_.changes)})}),this._fetchStore=this._register(new Z),this._inlineEditsFetchResult=gv(this,void 0),this._inlineEdits=Ao({owner:this,equalsFn:C0},l=>this._inlineEditsFetchResult.read(l)?.completions.map(c=>new sEe(c))??[]),this._fetchInlineEditsPromise=Gz({owner:this,createEmptyChangeSummary:()=>({inlineCompletionTriggerKind:Ea.Automatic}),handleChange:(l,c)=>(l.didChange(this._forceUpdateExplicitlySignal)&&(c.inlineCompletionTriggerKind=Ea.Explicit),!0)},async(l,c)=>{this._fetchStore.clear(),this._forceUpdateExplicitlySignal.read(l),this._textModelVersionId.read(l);function d(m,_){return _(m)}const h=this._pinnedRange.range.read(l)??d(this._selection.read(l),m=>m.isEmpty()?void 0:m);if(!h){this._inlineEditsFetchResult.set(void 0,void 0),this.userPrompt.set(void 0,void 0);return}const u={triggerKind:c.inlineCompletionTriggerKind,selectedSuggestionInfo:void 0,userPrompt:this.userPrompt.read(l)},g=XI(this._fetchStore);await Wc(200,g);const f=await RK(this.languageFeaturesService.inlineCompletionsProvider,h,this.textModel,u,g);g.isCancellationRequested||this._inlineEditsFetchResult.set(f,void 0)}),this._filteredInlineEditItems=Ao({owner:this,equalsFn:v0()},l=>this._inlineEdits.read(l)),this.selectedInlineCompletionIndex=_e(this,l=>{const c=this._selectedInlineCompletionId.read(l),d=this._filteredInlineEditItems.read(l),h=this._selectedInlineCompletionId===void 0?-1:d.findIndex(u=>u.semanticId===c);return h===-1?(this._selectedInlineCompletionId.set(void 0,void 0),0):h}),this.selectedInlineEdit=_e(this,l=>{const c=this._filteredInlineEditItems.read(l),d=this.selectedInlineCompletionIndex.read(l);return c[d]}),this._register(Dm(this._fetchInlineEditsPromise))}async triggerExplicitly(e){Qu(e,t=>{this._isActive.set(!0,t),this._forceUpdateExplicitlySignal.trigger(t)}),await this._fetchInlineEditsPromise.get()}stop(e){Qu(e,t=>{this.userPrompt.set(void 0,t),this._isActive.set(!1,t),this._inlineEditsFetchResult.set(void 0,t),this._pinnedRange.setRange(void 0,t)})}async _deltaSelectedInlineCompletionIndex(e){await this.triggerExplicitly();const t=this._filteredInlineEditItems.get()||[];if(t.length>0){const i=(this.selectedInlineCompletionIndex.get()+e+t.length)%t.length;this._selectedInlineCompletionId.set(t[i].semanticId,void 0)}else this._selectedInlineCompletionId.set(void 0,void 0)}async next(){await this._deltaSelectedInlineCompletionIndex(1)}async previous(){await this._deltaSelectedInlineCompletionIndex(-1)}async accept(e){if(e.getModel()!==this.textModel)throw new mt;const t=this.selectedInlineEdit.get();t&&(e.pushUndoStop(),e.executeEdits("inlineSuggestion.accept",[t.inlineCompletion.toSingleTextEdit().toSingleEditOperation()]),this.stop())}};xA=z_=nEe([II(4,pe),II(5,$C),II(6,Zt)],xA);class sEe{constructor(e){this.inlineCompletion=e,this.semanticId=this.inlineCompletion.hash()}}class oEe extends B{constructor(e,t){super(),this._textModel=e,this._versionId=t,this._decorations=Ze(this,[]),this.range=_e(this,i=>{this._versionId.read(i);const n=this._decorations.read(i)[0];return n?this._textModel.getDecorationRange(n)??null:null}),this._register(Ce(()=>{this._textModel.deltaDecorations(this._decorations.get(),[])}))}setRange(e,t){this._decorations.set(this._textModel.deltaDecorations(this._decorations.get(),e?[{range:e,options:{description:"trackedRange"}}]:[]),t)}}var rEe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},f_=function(s,e){return function(t,i){e(t,i,s)}},kA;let Zc=class extends B{static{kA=this}static{this.ID="editor.contrib.inlineEditsController"}static get(e){return e.getContribution(kA.ID)}constructor(e,t,i,n,o,r){super(),this.editor=e,this._instantiationService=t,this._contextKeyService=i,this._debounceService=n,this._languageFeaturesService=o,this._configurationService=r,this._enabled=LCe("editor.inlineEdits.enabled",!1,this._configurationService),this._editorObs=ao(this.editor),this._selection=_e(this,a=>this._editorObs.cursorSelection.read(a)??new me(1,1,1,1)),this._debounceValue=this._debounceService.for(this._languageFeaturesService.inlineCompletionsProvider,"InlineEditsDebounce",{min:50,max:50}),this.model=Jn(this,a=>{if(!this._enabled.read(a)||this._editorObs.isReadonly.read(a))return;const l=this._editorObs.model.read(a);return l?this._instantiationService.createInstance(so(xA,a),l,this._editorObs.versionId,this._selection,this._debounceValue):void 0}),this._hadInlineEdit=PC(this,(a,l)=>l||this.model.read(a)?.inlineEdit.read(a)!==void 0),this._widget=Jn(this,a=>{if(this._hadInlineEdit.read(a))return this._instantiationService.createInstance(so(LA,a),this.editor,this.model.map((l,c)=>l?.inlineEdit.read(c)),aEe(l=>this.model.read(l)?.userPrompt??Ze("empty","")))}),this._register(fa(am,this._contextKeyService,a=>!!this.model.read(a)?.inlineEdit.read(a))),this._register(fa(GTe,this._contextKeyService,a=>!!this.model.read(a)?.isPinned.read(a))),this.model.recomputeInitiallyAndOnChange(this._store),this._widget.recomputeInitiallyAndOnChange(this._store)}};Zc=kA=rEe([f_(1,ye),f_(2,Ee),f_(3,Go),f_(4,pe),f_(5,Ke)],Zc);function aEe(s){return RC(void 0,e=>s(e).read(e),(e,t)=>{s(void 0).set(e,t)})}function sy(s){return{label:s.value,alias:s.original}}class R4 extends ge{static{this.ID=qTe}constructor(){super({id:R4.ID,...sy(Re("action.inlineEdits.showNext","Show Next Inline Edit")),precondition:q.and(I.writable,am),kbOpts:{weight:100,primary:606}})}async run(e,t){Zc.get(t)?.model.get()?.next()}}class M4 extends ge{static{this.ID=KTe}constructor(){super({id:M4.ID,...sy(Re("action.inlineEdits.showPrevious","Show Previous Inline Edit")),precondition:q.and(I.writable,am),kbOpts:{weight:100,primary:604}})}async run(e,t){Zc.get(t)?.model.get()?.previous()}}class lEe extends ge{constructor(){super({id:"editor.action.inlineEdits.trigger",...sy(Re("action.inlineEdits.trigger","Trigger Inline Edit")),precondition:I.writable})}async run(e,t){const i=Zc.get(t);await qz(async n=>{await i?.model.get()?.triggerExplicitly(n)})}}class cEe extends ge{constructor(){super({id:ZTe,...sy(Re("action.inlineEdits.accept","Accept Inline Edit")),precondition:am,menuOpts:{menuId:M.InlineEditsActions,title:p("inlineEditsActions","Accept Inline Edit"),group:"primary",order:1,icon:J.check},kbOpts:{primary:2058,weight:2e4,kbExpr:am}})}async run(e,t){t instanceof ta&&(t=t.getParentEditor());const i=Zc.get(t);i&&(i.model.get()?.accept(i.editor),i.editor.focus())}}class A4 extends ge{static{this.ID="editor.action.inlineEdits.hide"}constructor(){super({id:A4.ID,...sy(Re("action.inlineEdits.hide","Hide Inline Edit")),precondition:am,kbOpts:{weight:100,primary:9}})}async run(e,t){const i=Zc.get(t);ai(n=>{i?.model.get()?.stop(n)})}}ct(Zc.ID,Zc,3);Q(lEe);Q(R4);Q(M4);Q(cEe);Q(A4);const ug={Visible:new le("parameterHintsVisible",!1),MultipleSignatures:new le("parameterHintsMultipleSignatures",!1)};async function XK(s,e,t,i,n){const o=s.ordered(e);for(const r of o)try{const a=await r.provideSignatureHelp(e,t,n,i);if(a)return a}catch(a){Li(a)}}ot.registerCommand("_executeSignatureHelpProvider",async(s,...e)=>{const[t,i,n]=e;gt(Se.isUri(t)),gt(P.isIPosition(i)),gt(typeof n=="string"||!n);const o=s.get(pe),r=await s.get(qs).createModelReference(t);try{const a=await XK(o.signatureHelpProvider,r.object.textEditorModel,P.lift(i),{triggerKind:Ll.Invoke,isRetrigger:!1,triggerCharacter:n},Ue.None);return a?(setTimeout(()=>a.dispose(),0),a.value):void 0}finally{r.dispose()}});var _d;(function(s){s.Default={type:0};class e{constructor(n,o){this.request=n,this.previouslyActiveHints=o,this.type=2}}s.Pending=e;class t{constructor(n){this.hints=n,this.type=1}}s.Active=t})(_d||(_d={}));class P4 extends B{static{this.DEFAULT_DELAY=120}constructor(e,t,i=P4.DEFAULT_DELAY){super(),this._onChangedHints=this._register(new O),this.onChangedHints=this._onChangedHints.event,this.triggerOnType=!1,this._state=_d.Default,this._pendingTriggers=[],this._lastSignatureHelpResult=this._register(new nn),this.triggerChars=new Y1,this.retriggerChars=new Y1,this.triggerId=0,this.editor=e,this.providers=t,this.throttledDelayer=new Cr(i),this._register(this.editor.onDidBlurEditorWidget(()=>this.cancel())),this._register(this.editor.onDidChangeConfiguration(()=>this.onEditorConfigurationChange())),this._register(this.editor.onDidChangeModel(n=>this.onModelChanged())),this._register(this.editor.onDidChangeModelLanguage(n=>this.onModelChanged())),this._register(this.editor.onDidChangeCursorSelection(n=>this.onCursorChange(n))),this._register(this.editor.onDidChangeModelContent(n=>this.onModelContentChange())),this._register(this.providers.onDidChange(this.onModelChanged,this)),this._register(this.editor.onDidType(n=>this.onDidType(n))),this.onEditorConfigurationChange(),this.onModelChanged()}get state(){return this._state}set state(e){this._state.type===2&&this._state.request.cancel(),this._state=e}cancel(e=!1){this.state=_d.Default,this.throttledDelayer.cancel(),e||this._onChangedHints.fire(void 0)}trigger(e,t){const i=this.editor.getModel();if(!i||!this.providers.has(i))return;const n=++this.triggerId;this._pendingTriggers.push(e),this.throttledDelayer.trigger(()=>this.doTrigger(n),t).catch(Oe)}next(){if(this.state.type!==1)return;const e=this.state.hints.signatures.length,t=this.state.hints.activeSignature,i=t%e===e-1,n=this.editor.getOption(86).cycle;if((e<2||i)&&!n){this.cancel();return}this.updateActiveSignature(i&&n?0:t+1)}previous(){if(this.state.type!==1)return;const e=this.state.hints.signatures.length,t=this.state.hints.activeSignature,i=t===0,n=this.editor.getOption(86).cycle;if((e<2||i)&&!n){this.cancel();return}this.updateActiveSignature(i&&n?e-1:t-1)}updateActiveSignature(e){this.state.type===1&&(this.state=new _d.Active({...this.state.hints,activeSignature:e}),this._onChangedHints.fire(this.state.hints))}async doTrigger(e){const t=this.state.type===1||this.state.type===2,i=this.getLastActiveHints();if(this.cancel(!0),this._pendingTriggers.length===0)return!1;const n=this._pendingTriggers.reduce(dEe);this._pendingTriggers=[];const o={triggerKind:n.triggerKind,triggerCharacter:n.triggerCharacter,isRetrigger:t,activeSignatureHelp:i};if(!this.editor.hasModel())return!1;const r=this.editor.getModel(),a=this.editor.getPosition();this.state=new _d.Pending(en(l=>XK(this.providers,r,a,o,l)),i);try{const l=await this.state.request;return e!==this.triggerId?(l?.dispose(),!1):!l||!l.value.signatures||l.value.signatures.length===0?(l?.dispose(),this._lastSignatureHelpResult.clear(),this.cancel(),!1):(this.state=new _d.Active(l.value),this._lastSignatureHelpResult.value=l,this._onChangedHints.fire(this.state.hints),!0)}catch(l){return e===this.triggerId&&(this.state=_d.Default),Oe(l),!1}}getLastActiveHints(){switch(this.state.type){case 1:return this.state.hints;case 2:return this.state.previouslyActiveHints;default:return}}get isTriggered(){return this.state.type===1||this.state.type===2||this.throttledDelayer.isTriggered()}onModelChanged(){this.cancel(),this.triggerChars.clear(),this.retriggerChars.clear();const e=this.editor.getModel();if(e)for(const t of this.providers.ordered(e)){for(const i of t.signatureHelpTriggerCharacters||[])if(i.length){const n=i.charCodeAt(0);this.triggerChars.add(n),this.retriggerChars.add(n)}for(const i of t.signatureHelpRetriggerCharacters||[])i.length&&this.retriggerChars.add(i.charCodeAt(0))}}onDidType(e){if(!this.triggerOnType)return;const t=e.length-1,i=e.charCodeAt(t);(this.triggerChars.has(i)||this.isTriggered&&this.retriggerChars.has(i))&&this.trigger({triggerKind:Ll.TriggerCharacter,triggerCharacter:e.charAt(t)})}onCursorChange(e){e.source==="mouse"?this.cancel():this.isTriggered&&this.trigger({triggerKind:Ll.ContentChange})}onModelContentChange(){this.isTriggered&&this.trigger({triggerKind:Ll.ContentChange})}onEditorConfigurationChange(){this.triggerOnType=this.editor.getOption(86).enabled,this.triggerOnType||this.cancel()}dispose(){this.cancel(!0),super.dispose()}}function dEe(s,e){switch(e.triggerKind){case Ll.Invoke:return e;case Ll.ContentChange:return s;case Ll.TriggerCharacter:default:return e}}var hEe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Lw=function(s,e){return function(t,i){e(t,i,s)}},DA;const So=te,uEe=Kt("parameter-hints-next",J.chevronDown,p("parameterHintsNextIcon","Icon for show next parameter hint.")),gEe=Kt("parameter-hints-previous",J.chevronUp,p("parameterHintsPreviousIcon","Icon for show previous parameter hint."));let IA=class extends B{static{DA=this}static{this.ID="editor.widget.parameterHintsWidget"}constructor(e,t,i,n,o,r){super(),this.editor=e,this.model=t,this.telemetryService=r,this.renderDisposeables=this._register(new Z),this.visible=!1,this.announcedLabel=null,this.allowEditorOverflow=!0,this.markdownRenderer=this._register(new zc({editor:e},o,n)),this.keyVisible=ug.Visible.bindTo(i),this.keyMultipleSignatures=ug.MultipleSignatures.bindTo(i)}createParameterHintDOMNodes(){const e=So(".editor-widget.parameter-hints-widget"),t=X(e,So(".phwrapper"));t.tabIndex=-1;const i=X(t,So(".controls")),n=X(i,So(".button"+Ie.asCSSSelector(gEe))),o=X(i,So(".overloads")),r=X(i,So(".button"+Ie.asCSSSelector(uEe)));this._register(U(n,"click",u=>{it.stop(u),this.previous()})),this._register(U(r,"click",u=>{it.stop(u),this.next()}));const a=So(".body"),l=new DC(a,{alwaysConsumeMouseWheel:!0});this._register(l),t.appendChild(l.getDomNode());const c=X(a,So(".signature")),d=X(a,So(".docs"));e.style.userSelect="text",this.domNodes={element:e,signature:c,overloads:o,docs:d,scrollbar:l},this.editor.addContentWidget(this),this.hide(),this._register(this.editor.onDidChangeCursorSelection(u=>{this.visible&&this.editor.layoutContentWidget(this)}));const h=()=>{if(!this.domNodes)return;const u=this.editor.getOption(50),g=this.domNodes.element;g.style.fontSize=`${u.fontSize}px`,g.style.lineHeight=`${u.lineHeight/u.fontSize}`,g.style.setProperty("--vscode-parameterHintsWidget-editorFontFamily",u.fontFamily),g.style.setProperty("--vscode-parameterHintsWidget-editorFontFamilyDefault",vs.fontFamily)};h(),this._register(se.chain(this.editor.onDidChangeConfiguration.bind(this.editor),u=>u.filter(g=>g.hasChanged(50)))(h)),this._register(this.editor.onDidLayoutChange(u=>this.updateMaxHeight())),this.updateMaxHeight()}show(){this.visible||(this.domNodes||this.createParameterHintDOMNodes(),this.keyVisible.set(!0),this.visible=!0,setTimeout(()=>{this.domNodes?.element.classList.add("visible")},100),this.editor.layoutContentWidget(this))}hide(){this.renderDisposeables.clear(),this.visible&&(this.keyVisible.reset(),this.visible=!1,this.announcedLabel=null,this.domNodes?.element.classList.remove("visible"),this.editor.layoutContentWidget(this))}getPosition(){return this.visible?{position:this.editor.getPosition(),preference:[1,2]}:null}render(e){if(this.renderDisposeables.clear(),!this.domNodes)return;const t=e.signatures.length>1;this.domNodes.element.classList.toggle("multiple",t),this.keyMultipleSignatures.set(t),this.domNodes.signature.innerText="",this.domNodes.docs.innerText="";const i=e.signatures[e.activeSignature];if(!i)return;const n=X(this.domNodes.signature,So(".code")),o=i.parameters.length>0,r=i.activeParameter??e.activeParameter;if(o)this.renderParameters(n,i,r);else{const c=X(n,So("span"));c.textContent=i.label}const a=i.parameters[r];if(a?.documentation){const c=So("span.documentation");if(typeof a.documentation=="string")c.textContent=a.documentation;else{const d=this.renderMarkdownDocs(a.documentation);c.appendChild(d.element)}X(this.domNodes.docs,So("p",{},c))}if(i.documentation!==void 0)if(typeof i.documentation=="string")X(this.domNodes.docs,So("p",{},i.documentation));else{const c=this.renderMarkdownDocs(i.documentation);X(this.domNodes.docs,c.element)}const l=this.hasDocs(i,a);if(this.domNodes.signature.classList.toggle("has-docs",l),this.domNodes.docs.classList.toggle("empty",!l),this.domNodes.overloads.textContent=String(e.activeSignature+1).padStart(e.signatures.length.toString().length,"0")+"/"+e.signatures.length,a){let c="";const d=i.parameters[r];Array.isArray(d.label)?c=i.label.substring(d.label[0],d.label[1]):c=d.label,d.documentation&&(c+=typeof d.documentation=="string"?`, ${d.documentation}`:`, ${d.documentation.value}`),i.documentation&&(c+=typeof i.documentation=="string"?`, ${i.documentation}`:`, ${i.documentation.value}`),this.announcedLabel!==c&&(Ls(p("hint","{0}, hint",c)),this.announcedLabel=c)}this.editor.layoutContentWidget(this),this.domNodes.scrollbar.scanDomNode()}renderMarkdownDocs(e){const t=new un,i=this.renderDisposeables.add(this.markdownRenderer.render(e,{asyncRenderCallback:()=>{this.domNodes?.scrollbar.scanDomNode()}}));i.element.classList.add("markdown-docs");const n=t.elapsed();return n>300&&this.telemetryService.publicLog2("parameterHints.parseMarkdown",{renderDuration:n}),i}hasDocs(e,t){return!!(t&&typeof t.documentation=="string"&&Id(t.documentation).length>0||t&&typeof t.documentation=="object"&&Id(t.documentation).value.length>0||e.documentation&&typeof e.documentation=="string"&&Id(e.documentation).length>0||e.documentation&&typeof e.documentation=="object"&&Id(e.documentation.value).length>0)}renderParameters(e,t,i){const[n,o]=this.getParameterLabelOffsets(t,i),r=document.createElement("span");r.textContent=t.label.substring(0,n);const a=document.createElement("span");a.textContent=t.label.substring(n,o),a.className="parameter active";const l=document.createElement("span");l.textContent=t.label.substring(o),X(e,r,a,l)}getParameterLabelOffsets(e,t){const i=e.parameters[t];if(i){if(Array.isArray(i.label))return i.label;if(i.label.length){const n=new RegExp(`(\\W|^)${Uo(i.label)}(?=\\W|$)`,"g");n.test(e.label);const o=n.lastIndex-i.label.length;return o>=0?[o,n.lastIndex]:[0,0]}else return[0,0]}else return[0,0]}next(){this.editor.focus(),this.model.next()}previous(){this.editor.focus(),this.model.previous()}getDomNode(){return this.domNodes||this.createParameterHintDOMNodes(),this.domNodes.element}getId(){return DA.ID}updateMaxHeight(){if(!this.domNodes)return;const t=`${Math.max(this.editor.getLayoutInfo().height/4,250)}px`;this.domNodes.element.style.maxHeight=t;const i=this.domNodes.element.getElementsByClassName("phwrapper");i.length&&(i[0].style.maxHeight=t)}};IA=DA=hEe([Lw(2,Ee),Lw(3,Ys),Lw(4,ni),Lw(5,jn)],IA);E("editorHoverWidget.highlightForeground",Lf,p("editorHoverWidgetHighlightForeground","Foreground color of the active item in the parameter hint."));var fEe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},D8=function(s,e){return function(t,i){e(t,i,s)}},TA;let lm=class extends B{static{TA=this}static{this.ID="editor.controller.parameterHints"}static get(e){return e.getContribution(TA.ID)}constructor(e,t,i){super(),this.editor=e,this.model=this._register(new P4(e,i.signatureHelpProvider)),this._register(this.model.onChangedHints(n=>{n?(this.widget.value.show(),this.widget.value.render(n)):this.widget.rawValue?.hide()})),this.widget=new Fa(()=>this._register(t.createInstance(IA,this.editor,this.model)))}cancel(){this.model.cancel()}previous(){this.widget.rawValue?.previous()}next(){this.widget.rawValue?.next()}trigger(e){this.model.trigger(e,0)}};lm=TA=fEe([D8(1,ye),D8(2,pe)],lm);class pEe extends ge{constructor(){super({id:"editor.action.triggerParameterHints",label:p("parameterHints.trigger.label","Trigger Parameter Hints"),alias:"Trigger Parameter Hints",precondition:I.hasSignatureHelpProvider,kbOpts:{kbExpr:I.editorTextFocus,primary:3082,weight:100}})}run(e,t){lm.get(t)?.trigger({triggerKind:Ll.Invoke})}}ct(lm.ID,lm,2);Q(pEe);const O4=175,F4=Zi.bindToContribution(lm.get);ae(new F4({id:"closeParameterHints",precondition:ug.Visible,handler:s=>s.cancel(),kbOpts:{weight:O4,kbExpr:I.focus,primary:9,secondary:[1033]}}));ae(new F4({id:"showPrevParameterHint",precondition:q.and(ug.Visible,ug.MultipleSignatures),handler:s=>s.previous(),kbOpts:{weight:O4,kbExpr:I.focus,primary:16,secondary:[528],mac:{primary:16,secondary:[528,302]}}}));ae(new F4({id:"showNextParameterHint",precondition:q.and(ug.Visible,ug.MultipleSignatures),handler:s=>s.next(),kbOpts:{weight:O4,kbExpr:I.focus,primary:18,secondary:[530],mac:{primary:18,secondary:[530,300]}}}));var mEe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},_Ee=function(s,e){return function(t,i){e(t,i,s)}};class bEe{constructor(e){this.instantiationService=e}init(...e){}}function vEe(s,e){return class extends e{constructor(){super(...arguments),this._autorun=void 0}init(...i){this._autorun=Us((n,o)=>{const r=so(s(),n);o.add(this.instantiationService.createInstance(r,...i))})}dispose(){this._autorun?.dispose()}}}function CEe(s){return Ox()?vEe(s,EA):s()}let EA=class extends bEe{constructor(e,t){super(t),this.init(e)}};EA=mEe([_Ee(1,ye)],EA);ct(SA.ID,CEe(()=>SA),0);E("editor.placeholder.foreground",hhe,p("placeholderForeground","Foreground color of the placeholder text in the editor."));var yEe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},xw=function(s,e){return function(t,i){e(t,i,s)}};const Hm=new le("renameInputVisible",!1,p("renameInputVisible","Whether the rename input widget is visible"));new le("renameInputFocused",!1,p("renameInputFocused","Whether the rename input widget is focused"));let NA=class{constructor(e,t,i,n,o,r){this._editor=e,this._acceptKeybindings=t,this._themeService=i,this._keybindingService=n,this._logService=r,this.allowEditorOverflow=!0,this._disposables=new Z,this._visibleContextKey=Hm.bindTo(o),this._isEditingRenameCandidate=!1,this._nRenameSuggestionsInvocations=0,this._hadAutomaticRenameSuggestionsInvocation=!1,this._candidates=new Set,this._beforeFirstInputFieldEditSW=new un,this._inputWithButton=new wEe,this._disposables.add(this._inputWithButton),this._editor.addContentWidget(this),this._disposables.add(this._editor.onDidChangeConfiguration(a=>{a.hasChanged(50)&&this._updateFont()})),this._disposables.add(i.onDidColorThemeChange(this._updateStyles,this))}dispose(){this._disposables.dispose(),this._editor.removeContentWidget(this)}getId(){return"__renameInputWidget"}getDomNode(){return this._domNode||(this._domNode=document.createElement("div"),this._domNode.className="monaco-editor rename-box",this._domNode.appendChild(this._inputWithButton.domNode),this._renameCandidateListView=this._disposables.add(new B4(this._domNode,{fontInfo:this._editor.getOption(50),onFocusChange:e=>{this._inputWithButton.input.value=e,this._isEditingRenameCandidate=!1},onSelectionChange:()=>{this._isEditingRenameCandidate=!1,this.acceptInput(!1)}})),this._disposables.add(this._inputWithButton.onDidInputChange(()=>{this._renameCandidateListView?.focusedCandidate!==void 0&&(this._isEditingRenameCandidate=!0),this._timeBeforeFirstInputFieldEdit??=this._beforeFirstInputFieldEditSW.elapsed(),this._renameCandidateProvidersCts?.token.isCancellationRequested===!1&&this._renameCandidateProvidersCts.cancel(),this._renameCandidateListView?.clearFocus()})),this._label=document.createElement("div"),this._label.className="rename-label",this._domNode.appendChild(this._label),this._updateFont(),this._updateStyles(this._themeService.getColorTheme())),this._domNode}_updateStyles(e){if(!this._domNode)return;const t=e.getColor(ym),i=e.getColor(lz);this._domNode.style.backgroundColor=String(e.getColor(Bo)??""),this._domNode.style.boxShadow=t?` 0 0 8px 2px ${t}`:"",this._domNode.style.border=i?`1px solid ${i}`:"",this._domNode.style.color=String(e.getColor(hz)??"");const n=e.getColor(uz);this._inputWithButton.domNode.style.backgroundColor=String(e.getColor(FE)??""),this._inputWithButton.input.style.backgroundColor=String(e.getColor(FE)??""),this._inputWithButton.domNode.style.borderWidth=n?"1px":"0px",this._inputWithButton.domNode.style.borderStyle=n?"solid":"none",this._inputWithButton.domNode.style.borderColor=n?.toString()??"none"}_updateFont(){if(this._domNode===void 0)return;gt(this._label!==void 0,"RenameWidget#_updateFont: _label must not be undefined given _domNode is defined"),this._editor.applyFontInfo(this._inputWithButton.input);const e=this._editor.getOption(50);this._label.style.fontSize=`${this._computeLabelFontSize(e.fontSize)}px`}_computeLabelFontSize(e){return e*.8}getPosition(){if(!this._visible||!this._editor.hasModel()||!this._editor.getDomNode())return null;const e=sh(this.getDomNode().ownerDocument.body),t=Si(this._editor.getDomNode()),i=this._getTopForPosition();this._nPxAvailableAbove=i+t.top,this._nPxAvailableBelow=e.height-this._nPxAvailableAbove;const n=this._editor.getOption(67),{totalHeight:o}=cm.getLayoutInfo({lineHeight:n}),r=this._nPxAvailableBelow>o*6?[2,1]:[1,2];return{position:this._position,preference:r}}beforeRender(){const[e,t]=this._acceptKeybindings;return this._label.innerText=p({key:"label",comment:['placeholders are keybindings, e.g "F2 to Rename, Shift+F2 to Preview"']},"{0} to Rename, {1} to Preview",this._keybindingService.lookupKeybinding(e)?.getLabel(),this._keybindingService.lookupKeybinding(t)?.getLabel()),this._domNode.style.minWidth="200px",null}afterRender(e){if(e===null){this.cancelInput(!0,"afterRender (because position is null)");return}if(!this._editor.hasModel()||!this._editor.getDomNode())return;gt(this._renameCandidateListView),gt(this._nPxAvailableAbove!==void 0),gt(this._nPxAvailableBelow!==void 0);const t=Cc(this._inputWithButton.domNode),i=Cc(this._label);let n;e===2?n=this._nPxAvailableBelow:n=this._nPxAvailableAbove,this._renameCandidateListView.layout({height:n-i-t,width:io(this._inputWithButton.domNode)})}acceptInput(e){this._trace("invoking acceptInput"),this._currentAcceptInput?.(e)}cancelInput(e,t){this._currentCancelInput?.(e)}focusNextRenameSuggestion(){this._renameCandidateListView?.focusNext()||(this._inputWithButton.input.value=this._currentName)}focusPreviousRenameSuggestion(){this._renameCandidateListView?.focusPrevious()||(this._inputWithButton.input.value=this._currentName)}getInput(e,t,i,n,o){const{start:r,end:a}=this._getSelection(e,t);this._renameCts=o;const l=new Z;this._nRenameSuggestionsInvocations=0,this._hadAutomaticRenameSuggestionsInvocation=!1,n===void 0?this._inputWithButton.button.style.display="none":(this._inputWithButton.button.style.display="flex",this._requestRenameCandidatesOnce=n,this._requestRenameCandidates(t,!1),l.add(U(this._inputWithButton.button,"click",()=>this._requestRenameCandidates(t,!0))),l.add(U(this._inputWithButton.button,ee.KEY_DOWN,d=>{const h=new Ft(d);(h.equals(3)||h.equals(10))&&(h.stopPropagation(),h.preventDefault(),this._requestRenameCandidates(t,!0))}))),this._isEditingRenameCandidate=!1,this._domNode.classList.toggle("preview",i),this._position=new P(e.startLineNumber,e.startColumn),this._currentName=t,this._inputWithButton.input.value=t,this._inputWithButton.input.setAttribute("selectionStart",r.toString()),this._inputWithButton.input.setAttribute("selectionEnd",a.toString()),this._inputWithButton.input.size=Math.max((e.endColumn-e.startColumn)*1.1,20),this._beforeFirstInputFieldEditSW.reset(),l.add(Ce(()=>{this._renameCts=void 0,o.dispose(!0)})),l.add(Ce(()=>{this._renameCandidateProvidersCts!==void 0&&(this._renameCandidateProvidersCts.dispose(!0),this._renameCandidateProvidersCts=void 0)})),l.add(Ce(()=>this._candidates.clear()));const c=new pm;return c.p.finally(()=>{l.dispose(),this._hide()}),this._currentCancelInput=d=>(this._trace("invoking _currentCancelInput"),this._currentAcceptInput=void 0,this._currentCancelInput=void 0,this._renameCandidateListView?.clearCandidates(),c.complete(d),!0),this._currentAcceptInput=d=>{this._trace("invoking _currentAcceptInput"),gt(this._renameCandidateListView!==void 0);const h=this._renameCandidateListView.nCandidates;let u,g;const f=this._renameCandidateListView.focusedCandidate;if(f!==void 0?(this._trace("using new name from renameSuggestion"),u=f,g={k:"renameSuggestion"}):(this._trace("using new name from inputField"),u=this._inputWithButton.input.value,g=this._isEditingRenameCandidate?{k:"userEditedRenameSuggestion"}:{k:"inputField"}),u===t||u.trim().length===0){this.cancelInput(!0,"_currentAcceptInput (because newName === value || newName.trim().length === 0)");return}this._currentAcceptInput=void 0,this._currentCancelInput=void 0,this._renameCandidateListView.clearCandidates(),c.complete({newName:u,wantsPreview:i&&d,stats:{source:g,nRenameSuggestions:h,timeBeforeFirstInputFieldEdit:this._timeBeforeFirstInputFieldEdit,nRenameSuggestionsInvocations:this._nRenameSuggestionsInvocations,hadAutomaticRenameSuggestionsInvocation:this._hadAutomaticRenameSuggestionsInvocation}})},l.add(o.token.onCancellationRequested(()=>this.cancelInput(!0,"cts.token.onCancellationRequested"))),l.add(this._editor.onDidBlurEditorWidget(()=>this.cancelInput(!this._domNode?.ownerDocument.hasFocus(),"editor.onDidBlurEditorWidget"))),this._show(),c.p}_requestRenameCandidates(e,t){if(this._requestRenameCandidatesOnce!==void 0&&(this._renameCandidateProvidersCts!==void 0&&this._renameCandidateProvidersCts.dispose(!0),gt(this._renameCts),this._inputWithButton.buttonState!=="stop")){this._renameCandidateProvidersCts=new li;const i=t?jb.Invoke:jb.Automatic,n=this._requestRenameCandidatesOnce(i,this._renameCandidateProvidersCts.token);if(n.length===0){this._inputWithButton.setSparkleButton();return}t||(this._hadAutomaticRenameSuggestionsInvocation=!0),this._nRenameSuggestionsInvocations+=1,this._inputWithButton.setStopButton(),this._updateRenameCandidates(n,e,this._renameCts.token)}}_getSelection(e,t){gt(this._editor.hasModel());const i=this._editor.getSelection();let n=0,o=t.length;return!k.isEmpty(i)&&!k.spansMultipleLines(i)&&k.containsRange(e,i)&&(n=Math.max(0,i.startColumn-e.startColumn),o=Math.min(e.endColumn,i.endColumn)-e.startColumn),{start:n,end:o}}_show(){this._trace("invoking _show"),this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber,0),this._visible=!0,this._visibleContextKey.set(!0),this._editor.layoutContentWidget(this),setTimeout(()=>{this._inputWithButton.input.focus(),this._inputWithButton.input.setSelectionRange(parseInt(this._inputWithButton.input.getAttribute("selectionStart")),parseInt(this._inputWithButton.input.getAttribute("selectionEnd")))},100)}async _updateRenameCandidates(e,t,i){const n=(...c)=>this._trace("_updateRenameCandidates",...c);n("start");const o=await yC(Promise.allSettled(e),i);if(this._inputWithButton.setSparkleButton(),o===void 0){n("returning early - received updateRenameCandidates results - undefined");return}const r=o.flatMap(c=>c.status==="fulfilled"&&Sl(c.value)?c.value:[]);n(`received updateRenameCandidates results - total (unfiltered) ${r.length} candidates.`);const a=Pc(r,c=>c.newSymbolName);n(`distinct candidates - ${a.length} candidates.`);const l=a.filter(({newSymbolName:c})=>c.trim().length>0&&c!==this._inputWithButton.input.value&&c!==t&&!this._candidates.has(c));if(n(`valid distinct candidates - ${r.length} candidates.`),l.forEach(c=>this._candidates.add(c.newSymbolName)),l.length<1){n("returning early - no valid distinct candidates");return}n("setting candidates"),this._renameCandidateListView.setCandidates(l),n("asking editor to re-layout"),this._editor.layoutContentWidget(this)}_hide(){this._trace("invoked _hide"),this._visible=!1,this._visibleContextKey.reset(),this._editor.layoutContentWidget(this)}_getTopForPosition(){const e=this._editor.getVisibleRanges();let t;return e.length>0?t=e[0].startLineNumber:(this._logService.warn("RenameWidget#_getTopForPosition: this should not happen - visibleRanges is empty"),t=Math.max(1,this._position.lineNumber-5)),this._editor.getTopForLineNumber(this._position.lineNumber)-this._editor.getTopForLineNumber(t)}_trace(...e){this._logService.trace("RenameWidget",...e)}};NA=yEe([xw(2,Ki),xw(3,yt),xw(4,Ee),xw(5,Pn)],NA);class B4{constructor(e,t){this._disposables=new Z,this._availableHeight=0,this._minimumWidth=0,this._lineHeight=t.fontInfo.lineHeight,this._typicalHalfwidthCharacterWidth=t.fontInfo.typicalHalfwidthCharacterWidth,this._listContainer=document.createElement("div"),this._listContainer.className="rename-box rename-candidate-list-container",e.appendChild(this._listContainer),this._listWidget=B4._createListWidget(this._listContainer,this._candidateViewHeight,t.fontInfo),this._listWidget.onDidChangeFocus(i=>{i.elements.length===1&&t.onFocusChange(i.elements[0].newSymbolName)},this._disposables),this._listWidget.onDidChangeSelection(i=>{i.elements.length===1&&t.onSelectionChange()},this._disposables),this._disposables.add(this._listWidget.onDidBlur(i=>{this._listWidget.setFocus([])})),this._listWidget.style(vg({listInactiveFocusForeground:rv,listInactiveFocusBackground:av}))}dispose(){this._listWidget.dispose(),this._disposables.dispose()}layout({height:e,width:t}){this._availableHeight=e,this._minimumWidth=t}setCandidates(e){this._listWidget.splice(0,0,e);const t=this._pickListHeight(this._listWidget.length),i=this._pickListWidth(e);this._listWidget.layout(t,i),this._listContainer.style.height=`${t}px`,this._listContainer.style.width=`${i}px`,Nl(p("renameSuggestionsReceivedAria","Received {0} rename suggestions",e.length))}clearCandidates(){this._listContainer.style.height="0px",this._listContainer.style.width="0px",this._listWidget.splice(0,this._listWidget.length,[])}get nCandidates(){return this._listWidget.length}get focusedCandidate(){if(this._listWidget.length===0)return;const e=this._listWidget.getSelectedElements()[0];if(e!==void 0)return e.newSymbolName;const t=this._listWidget.getFocusedElements()[0];if(t!==void 0)return t.newSymbolName}focusNext(){if(this._listWidget.length===0)return!1;const e=this._listWidget.getFocus();if(e.length===0)return this._listWidget.focusFirst(),this._listWidget.reveal(0),!0;if(e[0]===this._listWidget.length-1)return this._listWidget.setFocus([]),this._listWidget.reveal(0),!1;{this._listWidget.focusNext();const t=this._listWidget.getFocus()[0];return this._listWidget.reveal(t),!0}}focusPrevious(){if(this._listWidget.length===0)return!1;const e=this._listWidget.getFocus();if(e.length===0){this._listWidget.focusLast();const t=this._listWidget.getFocus()[0];return this._listWidget.reveal(t),!0}else{if(e[0]===0)return this._listWidget.setFocus([]),!1;{this._listWidget.focusPrevious();const t=this._listWidget.getFocus()[0];return this._listWidget.reveal(t),!0}}}clearFocus(){this._listWidget.setFocus([])}get _candidateViewHeight(){const{totalHeight:e}=cm.getLayoutInfo({lineHeight:this._lineHeight});return e}_pickListHeight(e){const t=this._candidateViewHeight*e;return Math.min(t,this._availableHeight,this._candidateViewHeight*7)}_pickListWidth(e){const t=Math.ceil(Math.max(...e.map(n=>n.newSymbolName.length))*this._typicalHalfwidthCharacterWidth);return Math.max(this._minimumWidth,25+t+10)}static _createListWidget(e,t,i){const n=new class{getTemplateId(r){return"candidate"}getHeight(r){return t}},o=new class{constructor(){this.templateId="candidate"}renderTemplate(r){return new cm(r,i)}renderElement(r,a,l){l.populate(r)}disposeTemplate(r){r.dispose()}};return new Xo("NewSymbolNameCandidates",e,n,[o],{keyboardSupport:!1,mouseSupport:!0,multipleSelectionSupport:!1})}}class wEe{constructor(){this._onDidInputChange=new O,this.onDidInputChange=this._onDidInputChange.event,this._disposables=new Z}get domNode(){return this._domNode||(this._domNode=document.createElement("div"),this._domNode.className="rename-input-with-button",this._domNode.style.display="flex",this._domNode.style.flexDirection="row",this._domNode.style.alignItems="center",this._inputNode=document.createElement("input"),this._inputNode.className="rename-input",this._inputNode.type="text",this._inputNode.style.border="none",this._inputNode.setAttribute("aria-label",p("renameAriaLabel","Rename input. Type new name and press Enter to commit.")),this._domNode.appendChild(this._inputNode),this._buttonNode=document.createElement("div"),this._buttonNode.className="rename-suggestions-button",this._buttonNode.setAttribute("tabindex","0"),this._buttonGenHoverText=p("generateRenameSuggestionsButton","Generate new name suggestions"),this._buttonCancelHoverText=p("cancelRenameSuggestionsButton","Cancel"),this._buttonHover=Ka().setupManagedHover(Ds("element"),this._buttonNode,this._buttonGenHoverText),this._disposables.add(this._buttonHover),this._domNode.appendChild(this._buttonNode),this._disposables.add(U(this.input,ee.INPUT,()=>this._onDidInputChange.fire())),this._disposables.add(U(this.input,ee.KEY_DOWN,e=>{const t=new Ft(e);(t.keyCode===15||t.keyCode===17)&&this._onDidInputChange.fire()})),this._disposables.add(U(this.input,ee.CLICK,()=>this._onDidInputChange.fire())),this._disposables.add(U(this.input,ee.FOCUS,()=>{this.domNode.style.outlineWidth="1px",this.domNode.style.outlineStyle="solid",this.domNode.style.outlineOffset="-1px",this.domNode.style.outlineColor="var(--vscode-focusBorder)"})),this._disposables.add(U(this.input,ee.BLUR,()=>{this.domNode.style.outline="none"}))),this._domNode}get input(){return gt(this._inputNode),this._inputNode}get button(){return gt(this._buttonNode),this._buttonNode}get buttonState(){return this._buttonState}setSparkleButton(){this._buttonState="sparkle",this._sparkleIcon??=Gu(J.sparkle),Cn(this.button),this.button.appendChild(this._sparkleIcon),this.button.setAttribute("aria-label","Generating new name suggestions"),this._buttonHover?.update(this._buttonGenHoverText),this.input.focus()}setStopButton(){this._buttonState="stop",this._stopIcon??=Gu(J.primitiveSquare),Cn(this.button),this.button.appendChild(this._stopIcon),this.button.setAttribute("aria-label","Cancel generating new name suggestions"),this._buttonHover?.update(this._buttonCancelHoverText),this.input.focus()}dispose(){this._disposables.dispose()}}class cm{static{this._PADDING=2}constructor(e,t){this._domNode=document.createElement("div"),this._domNode.className="rename-box rename-candidate",this._domNode.style.display="flex",this._domNode.style.columnGap="5px",this._domNode.style.alignItems="center",this._domNode.style.height=`${t.lineHeight}px`,this._domNode.style.padding=`${cm._PADDING}px`;const i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.width=i.style.height=`${t.lineHeight*.8}px`,this._domNode.appendChild(i),this._icon=Gu(J.sparkle),this._icon.style.display="none",i.appendChild(this._icon),this._label=document.createElement("div"),wn(this._label,t),this._domNode.appendChild(this._label),e.appendChild(this._domNode)}populate(e){this._updateIcon(e),this._updateLabel(e)}_updateIcon(e){const t=!!e.tags?.includes(sT.AIGenerated);this._icon.style.display=t?"inherit":"none"}_updateLabel(e){this._label.innerText=e.newSymbolName}static getLayoutInfo({lineHeight:e}){return{totalHeight:e+cm._PADDING*2}}dispose(){}}var SEe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},dd=function(s,e){return function(t,i){e(t,i,s)}},RA;class W4{constructor(e,t,i){this.model=e,this.position=t,this._providerRenameIdx=0,this._providers=i.ordered(e)}hasProvider(){return this._providers.length>0}async resolveRenameLocation(e){const t=[];for(this._providerRenameIdx=0;this._providerRenameIdx<this._providers.length;this._providerRenameIdx++){const n=this._providers[this._providerRenameIdx];if(!n.resolveRenameLocation)break;const o=await n.resolveRenameLocation(this.model,this.position,e);if(o){if(o.rejectReason){t.push(o.rejectReason);continue}return o}}this._providerRenameIdx=0;const i=this.model.getWordAtPosition(this.position);return i?{range:new k(this.position.lineNumber,i.startColumn,this.position.lineNumber,i.endColumn),text:i.word,rejectReason:t.length>0?t.join(`
`):void 0}:{range:k.fromPositions(this.position),text:"",rejectReason:t.length>0?t.join(`
`):void 0}}async provideRenameEdits(e,t){return this._provideRenameEdits(e,this._providerRenameIdx,[],t)}async _provideRenameEdits(e,t,i,n){const o=this._providers[t];if(!o)return{edits:[],rejectReason:i.join(`
`)};const r=await o.provideRenameEdits(this.model,this.position,e,n);if(r){if(r.rejectReason)return this._provideRenameEdits(e,t+1,i.concat(r.rejectReason),n)}else return this._provideRenameEdits(e,t+1,i.concat(p("no result","No result.")),n);return r}}async function LEe(s,e,t,i){const n=new W4(e,t,s),o=await n.resolveRenameLocation(Ue.None);return o?.rejectReason?{edits:[],rejectReason:o.rejectReason}:n.provideRenameEdits(i,Ue.None)}let _h=class{static{RA=this}static{this.ID="editor.contrib.renameController"}static get(e){return e.getContribution(RA.ID)}constructor(e,t,i,n,o,r,a,l,c){this.editor=e,this._instaService=t,this._notificationService=i,this._bulkEditService=n,this._progressService=o,this._logService=r,this._configService=a,this._languageFeaturesService=l,this._telemetryService=c,this._disposableStore=new Z,this._cts=new li,this._renameWidget=this._disposableStore.add(this._instaService.createInstance(NA,this.editor,["acceptRenameInput","acceptRenameInputWithPreview"]))}dispose(){this._disposableStore.dispose(),this._cts.dispose(!0)}async run(){const e=this._logService.trace.bind(this._logService,"[rename]");if(this._cts.dispose(!0),this._cts=new li,!this.editor.hasModel()){e("editor has no model");return}const t=this.editor.getPosition(),i=new W4(this.editor.getModel(),t,this._languageFeaturesService.renameProvider);if(!i.hasProvider()){e("skeleton has no provider");return}const n=new gh(this.editor,5,void 0,this._cts.token);let o;try{e("resolving rename location");const f=i.resolveRenameLocation(n.token);this._progressService.showWhile(f,250),o=await f,e("resolved rename location")}catch(f){f instanceof Xr?e("resolve rename location cancelled",JSON.stringify(f,null,"	")):(e("resolve rename location failed",f instanceof Error?f:JSON.stringify(f,null,"	")),(typeof f=="string"||Pa(f))&&go.get(this.editor)?.showMessage(f||p("resolveRenameLocationFailed","An unknown error occurred while resolving rename location"),t));return}finally{n.dispose()}if(!o){e("returning early - no loc");return}if(o.rejectReason){e(`returning early - rejected with reason: ${o.rejectReason}`,o.rejectReason),go.get(this.editor)?.showMessage(o.rejectReason,t);return}if(n.token.isCancellationRequested){e("returning early - cts1 cancelled");return}const r=new gh(this.editor,5,o.range,this._cts.token),a=this.editor.getModel(),l=this._languageFeaturesService.newSymbolNamesProvider.all(a),c=await Promise.all(l.map(async f=>[f,await f.supportsAutomaticNewSymbolNamesTriggerKind??!1])),d=(f,m)=>{let _=c.slice();return f===jb.Automatic&&(_=_.filter(([b,v])=>v)),_.map(([b])=>b.provideNewSymbolNames(a,o.range,f,m))};e("creating rename input field and awaiting its result");const h=this._bulkEditService.hasPreviewHandler()&&this._configService.getValue(this.editor.getModel().uri,"editor.rename.enablePreview"),u=await this._renameWidget.getInput(o.range,o.text,h,l.length>0?d:void 0,r);if(e("received response from rename input field"),l.length>0&&this._reportTelemetry(l.length,a.getLanguageId(),u),typeof u=="boolean"){e(`returning early - rename input field response - ${u}`),u&&this.editor.focus(),r.dispose();return}this.editor.focus(),e("requesting rename edits");const g=yC(i.provideRenameEdits(u.newName,r.token),r.token).then(async f=>{if(!f){e("returning early - no rename edits result");return}if(!this.editor.hasModel()){e("returning early - no model after rename edits are provided");return}if(f.rejectReason){e(`returning early - rejected with reason: ${f.rejectReason}`),this._notificationService.info(f.rejectReason);return}this.editor.setSelection(k.fromPositions(this.editor.getSelection().getPosition())),e("applying edits"),this._bulkEditService.apply(f,{editor:this.editor,showPreview:u.wantsPreview,label:p("label","Renaming '{0}' to '{1}'",o?.text,u.newName),code:"undoredo.rename",quotableLabel:p("quotableLabel","Renaming {0} to {1}",o?.text,u.newName),respectAutoSaveConfig:!0}).then(m=>{e("edits applied"),m.ariaSummary&&Ls(p("aria","Successfully renamed '{0}' to '{1}'. Summary: {2}",o.text,u.newName,m.ariaSummary))}).catch(m=>{e(`error when applying edits ${JSON.stringify(m,null,"	")}`),this._notificationService.error(p("rename.failedApply","Rename failed to apply edits")),this._logService.error(m)})},f=>{e("error when providing rename edits",JSON.stringify(f,null,"	")),this._notificationService.error(p("rename.failed","Rename failed to compute edits")),this._logService.error(f)}).finally(()=>{r.dispose()});return e("returning rename operation"),this._progressService.showWhile(g,250),g}acceptRenameInput(e){this._renameWidget.acceptInput(e)}cancelRenameInput(){this._renameWidget.cancelInput(!0,"cancelRenameInput command")}focusNextRenameSuggestion(){this._renameWidget.focusNextRenameSuggestion()}focusPreviousRenameSuggestion(){this._renameWidget.focusPreviousRenameSuggestion()}_reportTelemetry(e,t,i){const n=typeof i=="boolean"?{kind:"cancelled",languageId:t,nRenameSuggestionProviders:e}:{kind:"accepted",languageId:t,nRenameSuggestionProviders:e,source:i.stats.source.k,nRenameSuggestions:i.stats.nRenameSuggestions,timeBeforeFirstInputFieldEdit:i.stats.timeBeforeFirstInputFieldEdit,wantsPreview:i.wantsPreview,nRenameSuggestionsInvocations:i.stats.nRenameSuggestionsInvocations,hadAutomaticRenameSuggestionsInvocation:i.stats.hadAutomaticRenameSuggestionsInvocation};this._telemetryService.publicLog2("renameInvokedEvent",n)}};_h=RA=SEe([dd(1,ye),dd(2,Ii),dd(3,EC),dd(4,yh),dd(5,Pn),dd(6,WL),dd(7,pe),dd(8,jn)],_h);class xEe extends ge{constructor(){super({id:"editor.action.rename",label:p("rename.label","Rename Symbol"),alias:"Rename Symbol",precondition:q.and(I.writable,I.hasRenameProvider),kbOpts:{kbExpr:I.editorTextFocus,primary:60,weight:100},contextMenuOpts:{group:"1_modification",order:1.1}})}runCommand(e,t){const i=e.get(ft),[n,o]=Array.isArray(t)&&t||[void 0,void 0];return Se.isUri(n)&&P.isIPosition(o)?i.openCodeEditor({resource:n},i.getActiveCodeEditor()).then(r=>{r&&(r.setPosition(o),r.invokeWithinContext(a=>(this.reportTelemetry(a,r),this.run(a,r))))},Oe):super.runCommand(e,t)}run(e,t){const i=e.get(Pn),n=_h.get(t);return n?(i.trace("[RenameAction] got controller, running..."),n.run()):(i.trace("[RenameAction] returning early - controller missing"),Promise.resolve())}}ct(_h.ID,_h,4);Q(xEe);const H4=Zi.bindToContribution(_h.get);ae(new H4({id:"acceptRenameInput",precondition:Hm,handler:s=>s.acceptRenameInput(!1),kbOpts:{weight:199,kbExpr:q.and(I.focus,q.not("isComposing")),primary:3}}));ae(new H4({id:"acceptRenameInputWithPreview",precondition:q.and(Hm,q.has("config.editor.rename.enablePreview")),handler:s=>s.acceptRenameInput(!0),kbOpts:{weight:199,kbExpr:q.and(I.focus,q.not("isComposing")),primary:2051}}));ae(new H4({id:"cancelRenameInput",precondition:Hm,handler:s=>s.cancelRenameInput(),kbOpts:{weight:199,kbExpr:I.focus,primary:9,secondary:[1033]}}));Bt(class extends ks{constructor(){super({id:"focusNextRenameSuggestion",title:{...Re("focusNextRenameSuggestion","Focus Next Rename Suggestion")},precondition:Hm,keybinding:[{primary:18,weight:199}]})}run(e){const t=e.get(ft).getFocusedCodeEditor();if(!t)return;const i=_h.get(t);i&&i.focusNextRenameSuggestion()}});Bt(class extends ks{constructor(){super({id:"focusPreviousRenameSuggestion",title:{...Re("focusPreviousRenameSuggestion","Focus Previous Rename Suggestion")},precondition:Hm,keybinding:[{primary:16,weight:199}]})}run(e){const t=e.get(ft).getFocusedCodeEditor();if(!t)return;const i=_h.get(t);i&&i.focusPreviousRenameSuggestion()}});Gs("_executeDocumentRenameProvider",function(s,e,t,...i){const[n]=i;gt(typeof n=="string");const{renameProvider:o}=s.get(pe);return LEe(o,e,t,n)});Gs("_executePrepareRename",async function(s,e,t){const{renameProvider:i}=s.get(pe),o=await new W4(e,t,i).resolveRenameLocation(Ue.None);if(o?.rejectReason)throw new Error(o.rejectReason);return o});ci.as(na.Configuration).registerConfiguration({id:"editor",properties:{"editor.rename.enablePreview":{scope:5,description:p("enablePreview","Enable/disable the ability to preview changes before renaming"),default:!0,type:"boolean"}}});var kEe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},I8=function(s,e){return function(t,i){e(t,i,s)}};let JS=class extends B{static{this.ID="editor.sectionHeaderDetector"}constructor(e,t,i){super(),this.editor=e,this.languageConfigurationService=t,this.editorWorkerService=i,this.decorations=this.editor.createDecorationsCollection(),this.options=this.createOptions(e.getOption(73)),this.computePromise=null,this.currentOccurrences={},this._register(e.onDidChangeModel(n=>{this.currentOccurrences={},this.options=this.createOptions(e.getOption(73)),this.stop(),this.computeSectionHeaders.schedule(0)})),this._register(e.onDidChangeModelLanguage(n=>{this.currentOccurrences={},this.options=this.createOptions(e.getOption(73)),this.stop(),this.computeSectionHeaders.schedule(0)})),this._register(t.onDidChange(n=>{const o=this.editor.getModel()?.getLanguageId();o&&n.affects(o)&&(this.currentOccurrences={},this.options=this.createOptions(e.getOption(73)),this.stop(),this.computeSectionHeaders.schedule(0))})),this._register(e.onDidChangeConfiguration(n=>{this.options&&!n.hasChanged(73)||(this.options=this.createOptions(e.getOption(73)),this.updateDecorations([]),this.stop(),this.computeSectionHeaders.schedule(0))})),this._register(this.editor.onDidChangeModelContent(n=>{this.computeSectionHeaders.schedule()})),this._register(e.onDidChangeModelTokens(n=>{this.computeSectionHeaders.isScheduled()||this.computeSectionHeaders.schedule(1e3)})),this.computeSectionHeaders=this._register(new It(()=>{this.findSectionHeaders()},250)),this.computeSectionHeaders.schedule(0)}createOptions(e){if(!e||!this.editor.hasModel())return;const t=this.editor.getModel().getLanguageId();if(!t)return;const i=this.languageConfigurationService.getLanguageConfiguration(t).comments,n=this.languageConfigurationService.getLanguageConfiguration(t).foldingRules;if(!(!i&&!n?.markers))return{foldingRules:n,findMarkSectionHeaders:e.showMarkSectionHeaders,findRegionSectionHeaders:e.showRegionSectionHeaders}}findSectionHeaders(){if(!this.editor.hasModel()||!this.options?.findMarkSectionHeaders&&!this.options?.findRegionSectionHeaders)return;const e=this.editor.getModel();if(e.isDisposed()||e.isTooLargeForSyncing())return;const t=e.getVersionId();this.editorWorkerService.findSectionHeaders(e.uri,this.options).then(i=>{e.isDisposed()||e.getVersionId()!==t||this.updateDecorations(i)})}updateDecorations(e){const t=this.editor.getModel();t&&(e=e.filter(o=>{if(!o.shouldBeInComments)return!0;const r=t.validateRange(o.range),a=t.tokenization.getLineTokens(r.startLineNumber),l=a.findTokenIndexAtOffset(r.startColumn-1),c=a.getStandardTokenType(l);return a.getLanguageId(l)===t.getLanguageId()&&c===1}));const i=Object.values(this.currentOccurrences).map(o=>o.decorationId),n=e.map(o=>DEe(o));this.editor.changeDecorations(o=>{const r=o.deltaDecorations(i,n);this.currentOccurrences={};for(let a=0,l=r.length;a<l;a++){const c={sectionHeader:e[a],decorationId:r[a]};this.currentOccurrences[c.decorationId]=c}})}stop(){this.computeSectionHeaders.cancel(),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}dispose(){super.dispose(),this.stop(),this.decorations.clear()}};JS=kEe([I8(1,di),I8(2,Xs)],JS);function DEe(s){return{range:s.range,options:We.createDynamic({description:"section-header",stickiness:3,collapseOnReplaceEdit:!0,minimap:{color:void 0,position:1,sectionHeaderStyle:s.hasSeparatorLine?2:1,sectionHeaderText:s.text}})}}ct(JS.ID,JS,1);function IEe(s){for(let e=0,t=s.length;e<t;e+=4){const i=s[e+0],n=s[e+1],o=s[e+2],r=s[e+3];s[e+0]=r,s[e+1]=o,s[e+2]=n,s[e+3]=i}}function TEe(s){const e=new Uint8Array(s.buffer,s.byteOffset,s.length*4);return n6()||IEe(e),PL.wrap(e)}function QK(s){const e=new Uint32Array(EEe(s));let t=0;if(e[t++]=s.id,s.type==="full")e[t++]=1,e[t++]=s.data.length,e.set(s.data,t),t+=s.data.length;else{e[t++]=2,e[t++]=s.deltas.length;for(const i of s.deltas)e[t++]=i.start,e[t++]=i.deleteCount,i.data?(e[t++]=i.data.length,e.set(i.data,t),t+=i.data.length):e[t++]=0}return TEe(e)}function EEe(s){let e=0;if(e+=2,s.type==="full")e+=1+s.data.length;else{e+=1,e+=3*s.deltas.length;for(const t of s.deltas)t.data&&(e+=t.data.length)}return e}function ak(s){return s&&!!s.data}function JK(s){return s&&Array.isArray(s.edits)}class NEe{constructor(e,t,i){this.provider=e,this.tokens=t,this.error=i}}function eq(s,e){return s.has(e)}function REe(s,e){const t=s.orderedGroups(e);return t.length>0?t[0]:[]}async function tq(s,e,t,i,n){const o=REe(s,e),r=await Promise.all(o.map(async a=>{let l,c=null;try{l=await a.provideDocumentSemanticTokens(e,a===t?i:null,n)}catch(d){c=d,l=null}return(!l||!ak(l)&&!JK(l))&&(l=null),new NEe(a,l,c)}));for(const a of r){if(a.error)throw a.error;if(a.tokens)return a}return r.length>0?r[0]:null}function MEe(s,e){const t=s.orderedGroups(e);return t.length>0?t[0]:null}class AEe{constructor(e,t){this.provider=e,this.tokens=t}}function PEe(s,e){return s.has(e)}function iq(s,e){const t=s.orderedGroups(e);return t.length>0?t[0]:[]}async function V4(s,e,t,i){const n=iq(s,e),o=await Promise.all(n.map(async r=>{let a;try{a=await r.provideDocumentRangeSemanticTokens(e,t,i)}catch(l){Li(l),a=null}return(!a||!ak(a))&&(a=null),new AEe(r,a)}));for(const r of o)if(r.tokens)return r;return o.length>0?o[0]:null}ot.registerCommand("_provideDocumentSemanticTokensLegend",async(s,...e)=>{const[t]=e;gt(t instanceof Se);const i=s.get(Zt).getModel(t);if(!i)return;const{documentSemanticTokensProvider:n}=s.get(pe),o=MEe(n,i);return o?o[0].getLegend():s.get(Ht).executeCommand("_provideDocumentRangeSemanticTokensLegend",t)});ot.registerCommand("_provideDocumentSemanticTokens",async(s,...e)=>{const[t]=e;gt(t instanceof Se);const i=s.get(Zt).getModel(t);if(!i)return;const{documentSemanticTokensProvider:n}=s.get(pe);if(!eq(n,i))return s.get(Ht).executeCommand("_provideDocumentRangeSemanticTokens",t,i.getFullModelRange());const o=await tq(n,i,null,null,Ue.None);if(!o)return;const{provider:r,tokens:a}=o;if(!a||!ak(a))return;const l=QK({id:0,type:"full",data:a.data});return a.resultId&&r.releaseDocumentSemanticTokens(a.resultId),l});ot.registerCommand("_provideDocumentRangeSemanticTokensLegend",async(s,...e)=>{const[t,i]=e;gt(t instanceof Se);const n=s.get(Zt).getModel(t);if(!n)return;const{documentRangeSemanticTokensProvider:o}=s.get(pe),r=iq(o,n);if(r.length===0)return;if(r.length===1)return r[0].getLegend();if(!i||!k.isIRange(i))return console.warn("provideDocumentRangeSemanticTokensLegend might be out-of-sync with provideDocumentRangeSemanticTokens unless a range argument is passed in"),r[0].getLegend();const a=await V4(o,n,k.lift(i),Ue.None);if(a)return a.provider.getLegend()});ot.registerCommand("_provideDocumentRangeSemanticTokens",async(s,...e)=>{const[t,i]=e;gt(t instanceof Se),gt(k.isIRange(i));const n=s.get(Zt).getModel(t);if(!n)return;const{documentRangeSemanticTokensProvider:o}=s.get(pe),r=await V4(o,n,k.lift(i),Ue.None);if(!(!r||!r.tokens))return QK({id:0,type:"full",data:r.tokens.data})});const z4="editor.semanticHighlighting";function f1(s,e,t){const i=t.getValue(z4,{overrideIdentifier:s.getLanguageId(),resource:s.uri})?.enabled;return typeof i=="boolean"?i:e.getColorTheme().semanticHighlighting}var nq=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},_l=function(s,e){return function(t,i){e(t,i,s)}},fd;let MA=class extends B{constructor(e,t,i,n,o,r){super(),this._watchers=Object.create(null);const a=d=>{this._watchers[d.uri.toString()]=new AA(d,e,i,o,r)},l=(d,h)=>{h.dispose(),delete this._watchers[d.uri.toString()]},c=()=>{for(const d of t.getModels()){const h=this._watchers[d.uri.toString()];f1(d,i,n)?h||a(d):h&&l(d,h)}};t.getModels().forEach(d=>{f1(d,i,n)&&a(d)}),this._register(t.onModelAdded(d=>{f1(d,i,n)&&a(d)})),this._register(t.onModelRemoved(d=>{const h=this._watchers[d.uri.toString()];h&&l(d,h)})),this._register(n.onDidChangeConfiguration(d=>{d.affectsConfiguration(z4)&&c()})),this._register(i.onDidColorThemeChange(c))}dispose(){for(const e of Object.values(this._watchers))e.dispose();super.dispose()}};MA=nq([_l(0,VL),_l(1,Zt),_l(2,Ki),_l(3,Ke),_l(4,Go),_l(5,pe)],MA);let AA=class extends B{static{fd=this}static{this.REQUEST_MIN_DELAY=300}static{this.REQUEST_MAX_DELAY=2e3}constructor(e,t,i,n,o){super(),this._semanticTokensStylingService=t,this._isDisposed=!1,this._model=e,this._provider=o.documentSemanticTokensProvider,this._debounceInformation=n.for(this._provider,"DocumentSemanticTokens",{min:fd.REQUEST_MIN_DELAY,max:fd.REQUEST_MAX_DELAY}),this._fetchDocumentSemanticTokens=this._register(new It(()=>this._fetchDocumentSemanticTokensNow(),fd.REQUEST_MIN_DELAY)),this._currentDocumentResponse=null,this._currentDocumentRequestCancellationTokenSource=null,this._documentProvidersChangeListeners=[],this._providersChangedDuringRequest=!1,this._register(this._model.onDidChangeContent(()=>{this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._register(this._model.onDidChangeAttached(()=>{this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._register(this._model.onDidChangeLanguage(()=>{this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule(0)}));const r=()=>{At(this._documentProvidersChangeListeners),this._documentProvidersChangeListeners=[];for(const a of this._provider.all(e))typeof a.onDidChange=="function"&&this._documentProvidersChangeListeners.push(a.onDidChange(()=>{if(this._currentDocumentRequestCancellationTokenSource){this._providersChangedDuringRequest=!0;return}this._fetchDocumentSemanticTokens.schedule(0)}))};r(),this._register(this._provider.onDidChange(()=>{r(),this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._register(i.onDidColorThemeChange(a=>{this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._fetchDocumentSemanticTokens.schedule(0)}dispose(){this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),At(this._documentProvidersChangeListeners),this._documentProvidersChangeListeners=[],this._setDocumentSemanticTokens(null,null,null,[]),this._isDisposed=!0,super.dispose()}_fetchDocumentSemanticTokensNow(){if(this._currentDocumentRequestCancellationTokenSource)return;if(!eq(this._provider,this._model)){this._currentDocumentResponse&&this._model.tokenization.setSemanticTokens(null,!1);return}if(!this._model.isAttachedToEditor())return;const e=new li,t=this._currentDocumentResponse?this._currentDocumentResponse.provider:null,i=this._currentDocumentResponse&&this._currentDocumentResponse.resultId||null,n=tq(this._provider,this._model,t,i,e.token);this._currentDocumentRequestCancellationTokenSource=e,this._providersChangedDuringRequest=!1;const o=[],r=this._model.onDidChangeContent(l=>{o.push(l)}),a=new un(!1);n.then(l=>{if(this._debounceInformation.update(this._model,a.elapsed()),this._currentDocumentRequestCancellationTokenSource=null,r.dispose(),!l)this._setDocumentSemanticTokens(null,null,null,o);else{const{provider:c,tokens:d}=l,h=this._semanticTokensStylingService.getStyling(c);this._setDocumentSemanticTokens(c,d||null,h,o)}},l=>{l&&(xr(l)||typeof l.message=="string"&&l.message.indexOf("busy")!==-1)||Oe(l),this._currentDocumentRequestCancellationTokenSource=null,r.dispose(),(o.length>0||this._providersChangedDuringRequest)&&(this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model)))})}static _copy(e,t,i,n,o){o=Math.min(o,i.length-n,e.length-t);for(let r=0;r<o;r++)i[n+r]=e[t+r]}_setDocumentSemanticTokens(e,t,i,n){const o=this._currentDocumentResponse,r=()=>{(n.length>0||this._providersChangedDuringRequest)&&!this._fetchDocumentSemanticTokens.isScheduled()&&this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))};if(this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._isDisposed){e&&t&&e.releaseDocumentSemanticTokens(t.resultId);return}if(!e||!i){this._model.tokenization.setSemanticTokens(null,!1);return}if(!t){this._model.tokenization.setSemanticTokens(null,!0),r();return}if(JK(t)){if(!o){this._model.tokenization.setSemanticTokens(null,!0);return}if(t.edits.length===0)t={resultId:t.resultId,data:o.data};else{let a=0;for(const u of t.edits)a+=(u.data?u.data.length:0)-u.deleteCount;const l=o.data,c=new Uint32Array(l.length+a);let d=l.length,h=c.length;for(let u=t.edits.length-1;u>=0;u--){const g=t.edits[u];if(g.start>l.length){i.warnInvalidEditStart(o.resultId,t.resultId,u,g.start,l.length),this._model.tokenization.setSemanticTokens(null,!0);return}const f=d-(g.start+g.deleteCount);f>0&&(fd._copy(l,d-f,c,h-f,f),h-=f),g.data&&(fd._copy(g.data,0,c,h-g.data.length,g.data.length),h-=g.data.length),d=g.start}d>0&&fd._copy(l,0,c,0,d),t={resultId:t.resultId,data:c}}}if(ak(t)){this._currentDocumentResponse=new OEe(e,t.resultId,t.data);const a=KV(t,i,this._model.getLanguageId());if(n.length>0)for(const l of n)for(const c of a)for(const d of l.changes)c.applyEdit(d.range,d.text);this._model.tokenization.setSemanticTokens(a,!0)}else this._model.tokenization.setSemanticTokens(null,!0);r()}};AA=fd=nq([_l(1,VL),_l(2,Ki),_l(3,Go),_l(4,pe)],AA);class OEe{constructor(e,t,i){this.provider=e,this.resultId=t,this.data=i}dispose(){this.provider.releaseDocumentSemanticTokens(this.resultId)}}Rm(MA);var FEe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},p_=function(s,e){return function(t,i){e(t,i,s)}};let eL=class extends B{static{this.ID="editor.contrib.viewportSemanticTokens"}constructor(e,t,i,n,o,r){super(),this._semanticTokensStylingService=t,this._themeService=i,this._configurationService=n,this._editor=e,this._provider=r.documentRangeSemanticTokensProvider,this._debounceInformation=o.for(this._provider,"DocumentRangeSemanticTokens",{min:100,max:500}),this._tokenizeViewport=this._register(new It(()=>this._tokenizeViewportNow(),100)),this._outstandingRequests=[];const a=()=>{this._editor.hasModel()&&this._tokenizeViewport.schedule(this._debounceInformation.get(this._editor.getModel()))};this._register(this._editor.onDidScrollChange(()=>{a()})),this._register(this._editor.onDidChangeModel(()=>{this._cancelAll(),a()})),this._register(this._editor.onDidChangeModelContent(l=>{this._cancelAll(),a()})),this._register(this._provider.onDidChange(()=>{this._cancelAll(),a()})),this._register(this._configurationService.onDidChangeConfiguration(l=>{l.affectsConfiguration(z4)&&(this._cancelAll(),a())})),this._register(this._themeService.onDidColorThemeChange(()=>{this._cancelAll(),a()})),a()}_cancelAll(){for(const e of this._outstandingRequests)e.cancel();this._outstandingRequests=[]}_removeOutstandingRequest(e){for(let t=0,i=this._outstandingRequests.length;t<i;t++)if(this._outstandingRequests[t]===e){this._outstandingRequests.splice(t,1);return}}_tokenizeViewportNow(){if(!this._editor.hasModel())return;const e=this._editor.getModel();if(e.tokenization.hasCompleteSemanticTokens())return;if(!f1(e,this._themeService,this._configurationService)){e.tokenization.hasSomeSemanticTokens()&&e.tokenization.setSemanticTokens(null,!1);return}if(!PEe(this._provider,e)){e.tokenization.hasSomeSemanticTokens()&&e.tokenization.setSemanticTokens(null,!1);return}const t=this._editor.getVisibleRangesPlusViewportAboveBelow();this._outstandingRequests=this._outstandingRequests.concat(t.map(i=>this._requestRange(e,i)))}_requestRange(e,t){const i=e.getVersionId(),n=en(r=>Promise.resolve(V4(this._provider,e,t,r))),o=new un(!1);return n.then(r=>{if(this._debounceInformation.update(e,o.elapsed()),!r||!r.tokens||e.isDisposed()||e.getVersionId()!==i)return;const{provider:a,tokens:l}=r,c=this._semanticTokensStylingService.getStyling(a);e.tokenization.setPartialSemanticTokens(t,KV(l,c,e.getLanguageId()))}).then(()=>this._removeOutstandingRequest(n),()=>this._removeOutstandingRequest(n)),n}};eL=FEe([p_(1,VL),p_(2,Ki),p_(3,Ke),p_(4,Go),p_(5,pe)],eL);ct(eL.ID,eL,1);class BEe{constructor(e=!0){this.selectSubwords=e}provideSelectionRanges(e,t){const i=[];for(const n of t){const o=[];i.push(o),this.selectSubwords&&this._addInWordRanges(o,e,n),this._addWordRanges(o,e,n),this._addWhitespaceLine(o,e,n),o.push({range:e.getFullModelRange()})}return i}_addInWordRanges(e,t,i){const n=t.getWordAtPosition(i);if(!n)return;const{word:o,startColumn:r}=n,a=i.column-r;let l=a,c=a,d=0;for(;l>=0;l--){const h=o.charCodeAt(l);if(l!==a&&(h===95||h===45))break;if(Td(h)&&gl(d))break;d=h}for(l+=1;c<o.length;c++){const h=o.charCodeAt(c);if(gl(h)&&Td(d))break;if(h===95||h===45)break;d=h}l<c&&e.push({range:new k(i.lineNumber,r+l,i.lineNumber,r+c)})}_addWordRanges(e,t,i){const n=t.getWordAtPosition(i);n&&e.push({range:new k(i.lineNumber,n.startColumn,i.lineNumber,n.endColumn)})}_addWhitespaceLine(e,t,i){t.getLineLength(i.lineNumber)>0&&t.getLineFirstNonWhitespaceColumn(i.lineNumber)===0&&t.getLineLastNonWhitespaceColumn(i.lineNumber)===0&&e.push({range:new k(i.lineNumber,1,i.lineNumber,t.getLineMaxColumn(i.lineNumber))})}}var WEe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},HEe=function(s,e){return function(t,i){e(t,i,s)}},PA;class U4{constructor(e,t){this.index=e,this.ranges=t}mov(e){const t=this.index+(e?1:-1);if(t<0||t>=this.ranges.length)return this;const i=new U4(t,this.ranges);return i.ranges[t].equalsRange(this.ranges[this.index])?i.mov(e):i}}let sC=class{static{PA=this}static{this.ID="editor.contrib.smartSelectController"}static get(e){return e.getContribution(PA.ID)}constructor(e,t){this._editor=e,this._languageFeaturesService=t,this._ignoreSelection=!1}dispose(){this._selectionListener?.dispose()}async run(e){if(!this._editor.hasModel())return;const t=this._editor.getSelections(),i=this._editor.getModel();if(this._state||await oq(this._languageFeaturesService.selectionRangeProvider,i,t.map(o=>o.getPosition()),this._editor.getOption(114),Ue.None).then(o=>{if(!(!os(o)||o.length!==t.length)&&!(!this._editor.hasModel()||!ii(this._editor.getSelections(),t,(r,a)=>r.equalsSelection(a)))){for(let r=0;r<o.length;r++)o[r]=o[r].filter(a=>a.containsPosition(t[r].getStartPosition())&&a.containsPosition(t[r].getEndPosition())),o[r].unshift(t[r]);this._state=o.map(r=>new U4(0,r)),this._selectionListener?.dispose(),this._selectionListener=this._editor.onDidChangeCursorPosition(()=>{this._ignoreSelection||(this._selectionListener?.dispose(),this._state=void 0)})}}),!this._state)return;this._state=this._state.map(o=>o.mov(e));const n=this._state.map(o=>me.fromPositions(o.ranges[o.index].getStartPosition(),o.ranges[o.index].getEndPosition()));this._ignoreSelection=!0;try{this._editor.setSelections(n)}finally{this._ignoreSelection=!1}}};sC=PA=WEe([HEe(1,pe)],sC);class sq extends ge{constructor(e,t){super(t),this._forward=e}async run(e,t){const i=sC.get(t);i&&await i.run(this._forward)}}class VEe extends sq{constructor(){super(!0,{id:"editor.action.smartSelect.expand",label:p("smartSelect.expand","Expand Selection"),alias:"Expand Selection",precondition:void 0,kbOpts:{kbExpr:I.editorTextFocus,primary:1553,mac:{primary:3345,secondary:[1297]},weight:100},menuOpts:{menuId:M.MenubarSelectionMenu,group:"1_basic",title:p({key:"miSmartSelectGrow",comment:["&& denotes a mnemonic"]},"&&Expand Selection"),order:2}})}}ot.registerCommandAlias("editor.action.smartSelect.grow","editor.action.smartSelect.expand");class zEe extends sq{constructor(){super(!1,{id:"editor.action.smartSelect.shrink",label:p("smartSelect.shrink","Shrink Selection"),alias:"Shrink Selection",precondition:void 0,kbOpts:{kbExpr:I.editorTextFocus,primary:1551,mac:{primary:3343,secondary:[1295]},weight:100},menuOpts:{menuId:M.MenubarSelectionMenu,group:"1_basic",title:p({key:"miSmartSelectShrink",comment:["&& denotes a mnemonic"]},"&&Shrink Selection"),order:3}})}}ct(sC.ID,sC,4);Q(VEe);Q(zEe);async function oq(s,e,t,i,n){const o=s.all(e).concat(new BEe(i.selectSubwords));o.length===1&&o.unshift(new Br);const r=[],a=[];for(const l of o)r.push(Promise.resolve(l.provideSelectionRanges(e,t,n)).then(c=>{if(os(c)&&c.length===t.length)for(let d=0;d<t.length;d++){a[d]||(a[d]=[]);for(const h of c[d])k.isIRange(h.range)&&k.containsPosition(h.range,t[d])&&a[d].push(k.lift(h.range))}},Li));return await Promise.all(r),a.map(l=>{if(l.length===0)return[];l.sort((u,g)=>P.isBefore(u.getStartPosition(),g.getStartPosition())?1:P.isBefore(g.getStartPosition(),u.getStartPosition())||P.isBefore(u.getEndPosition(),g.getEndPosition())?-1:P.isBefore(g.getEndPosition(),u.getEndPosition())?1:0);const c=[];let d;for(const u of l)(!d||k.containsRange(u,d)&&!k.equalsRange(u,d))&&(c.push(u),d=u);if(!i.selectLeadingAndTrailingWhitespace)return c;const h=[c[0]];for(let u=1;u<c.length;u++){const g=c[u-1],f=c[u];if(f.startLineNumber!==g.startLineNumber||f.endLineNumber!==g.endLineNumber){const m=new k(g.startLineNumber,e.getLineFirstNonWhitespaceColumn(g.startLineNumber),g.endLineNumber,e.getLineLastNonWhitespaceColumn(g.endLineNumber));m.containsRange(g)&&!m.equalsRange(g)&&f.containsRange(m)&&!f.equalsRange(m)&&h.push(m);const _=new k(g.startLineNumber,1,g.endLineNumber,e.getLineMaxColumn(g.endLineNumber));_.containsRange(g)&&!_.equalsRange(m)&&f.containsRange(_)&&!f.equalsRange(_)&&h.push(_)}h.push(f)}return h})}ot.registerCommand("_executeSelectionRangeProvider",async function(s,...e){const[t,i]=e;gt(Se.isUri(t));const n=s.get(pe).selectionRangeProvider,o=await s.get(qs).createModelReference(t);try{return oq(n,o.object.textEditorModel,i,{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},Ue.None)}finally{o.dispose()}});const UEe=Object.freeze({View:Re("view","View"),Help:Re("help","Help"),Test:Re("test","Test"),File:Re("file","File"),Preferences:Re("preferences","Preferences"),Developer:Re({key:"developer",comment:["A developer on Code itself or someone diagnosing issues in Code"]},"Developer")});class Ib{constructor(e,t,i,n=null){this.startLineNumbers=e,this.endLineNumbers=t,this.lastLineRelativePosition=i,this.showEndForLine=n}equals(e){return!!e&&this.lastLineRelativePosition===e.lastLineRelativePosition&&this.showEndForLine===e.showEndForLine&&ii(this.startLineNumbers,e.startLineNumbers)&&ii(this.endLineNumbers,e.endLineNumbers)}static get Empty(){return new Ib([],[],0)}}const T8=Gc("stickyScrollViewLayer",{createHTML:s=>s}),TI="data-sticky-line-index",E8="data-sticky-is-line",$Ee="data-sticky-is-line-number",N8="data-sticky-is-folding-icon";class jEe extends B{constructor(e){super(),this._editor=e,this._foldingIconStore=new Z,this._rootDomNode=document.createElement("div"),this._lineNumbersDomNode=document.createElement("div"),this._linesDomNodeScrollable=document.createElement("div"),this._linesDomNode=document.createElement("div"),this._lineHeight=this._editor.getOption(67),this._renderedStickyLines=[],this._lineNumbers=[],this._lastLineRelativePosition=0,this._minContentWidthInPx=0,this._isOnGlyphMargin=!1,this._lineNumbersDomNode.className="sticky-widget-line-numbers",this._lineNumbersDomNode.setAttribute("role","none"),this._linesDomNode.className="sticky-widget-lines",this._linesDomNode.setAttribute("role","list"),this._linesDomNodeScrollable.className="sticky-widget-lines-scrollable",this._linesDomNodeScrollable.appendChild(this._linesDomNode),this._rootDomNode.className="sticky-widget",this._rootDomNode.classList.toggle("peek",e instanceof ta),this._rootDomNode.appendChild(this._lineNumbersDomNode),this._rootDomNode.appendChild(this._linesDomNodeScrollable);const t=()=>{this._linesDomNode.style.left=this._editor.getOption(116).scrollWithEditor?`-${this._editor.getScrollLeft()}px`:"0px"};this._register(this._editor.onDidChangeConfiguration(i=>{i.hasChanged(116)&&t(),i.hasChanged(67)&&(this._lineHeight=this._editor.getOption(67))})),this._register(this._editor.onDidScrollChange(i=>{i.scrollLeftChanged&&t(),i.scrollWidthChanged&&this._updateWidgetWidth()})),this._register(this._editor.onDidChangeModel(()=>{t(),this._updateWidgetWidth()})),this._register(this._foldingIconStore),t(),this._register(this._editor.onDidLayoutChange(i=>{this._updateWidgetWidth()})),this._updateWidgetWidth()}get lineNumbers(){return this._lineNumbers}get lineNumberCount(){return this._lineNumbers.length}getRenderedStickyLine(e){return this._renderedStickyLines.find(t=>t.lineNumber===e)}getCurrentLines(){return this._lineNumbers}setState(e,t,i){if(i===void 0&&(!this._previousState&&!e||this._previousState&&this._previousState.equals(e)))return;const n=this._isWidgetHeightZero(e),o=n?void 0:e,r=n?0:this._findLineToRebuildWidgetFrom(e,i);this._renderRootNode(o,t,r),this._previousState=e}_isWidgetHeightZero(e){if(!e)return!0;const t=e.startLineNumbers.length*this._lineHeight+e.lastLineRelativePosition;if(t>0){this._lastLineRelativePosition=e.lastLineRelativePosition;const i=[...e.startLineNumbers];e.showEndForLine!==null&&(i[e.showEndForLine]=e.endLineNumbers[e.showEndForLine]),this._lineNumbers=i}else this._lastLineRelativePosition=0,this._lineNumbers=[];return t===0}_findLineToRebuildWidgetFrom(e,t){if(!e||!this._previousState)return 0;if(t!==void 0)return t;const i=this._previousState,n=e.startLineNumbers.findIndex(o=>!i.startLineNumbers.includes(o));return n===-1?0:n}_updateWidgetWidth(){const e=this._editor.getLayoutInfo(),t=e.contentLeft;this._lineNumbersDomNode.style.width=`${t}px`,this._linesDomNodeScrollable.style.setProperty("--vscode-editorStickyScroll-scrollableWidth",`${this._editor.getScrollWidth()-e.verticalScrollbarWidth}px`),this._rootDomNode.style.width=`${e.width-e.verticalScrollbarWidth}px`}_clearStickyLinesFromLine(e){this._foldingIconStore.clear();for(let t=e;t<this._renderedStickyLines.length;t++){const i=this._renderedStickyLines[t];i.lineNumberDomNode.remove(),i.lineDomNode.remove()}this._renderedStickyLines=this._renderedStickyLines.slice(0,e),this._rootDomNode.style.display="none"}_useFoldingOpacityTransition(e){this._lineNumbersDomNode.style.setProperty("--vscode-editorStickyScroll-foldingOpacityTransition",`opacity ${e?.5:0}s`)}_setFoldingIconsVisibility(e){for(const t of this._renderedStickyLines){const i=t.foldingIcon;i&&i.setVisible(e?!0:i.isCollapsed)}}async _renderRootNode(e,t,i){if(this._clearStickyLinesFromLine(i),!e)return;for(const a of this._renderedStickyLines)this._updateTopAndZIndexOfStickyLine(a);const n=this._editor.getLayoutInfo(),o=this._lineNumbers.slice(i);for(const[a,l]of o.entries()){const c=this._renderChildNode(a+i,l,t,n);c&&(this._linesDomNode.appendChild(c.lineDomNode),this._lineNumbersDomNode.appendChild(c.lineNumberDomNode),this._renderedStickyLines.push(c))}t&&(this._setFoldingHoverListeners(),this._useFoldingOpacityTransition(!this._isOnGlyphMargin));const r=this._lineNumbers.length*this._lineHeight+this._lastLineRelativePosition;this._rootDomNode.style.display="block",this._lineNumbersDomNode.style.height=`${r}px`,this._linesDomNodeScrollable.style.height=`${r}px`,this._rootDomNode.style.height=`${r}px`,this._rootDomNode.style.marginLeft="0px",this._minContentWidthInPx=Math.max(...this._renderedStickyLines.map(a=>a.scrollWidth))+n.verticalScrollbarWidth,this._editor.layoutOverlayWidget(this)}_setFoldingHoverListeners(){this._editor.getOption(111)==="mouseover"&&(this._foldingIconStore.add(U(this._lineNumbersDomNode,ee.MOUSE_ENTER,()=>{this._isOnGlyphMargin=!0,this._setFoldingIconsVisibility(!0)})),this._foldingIconStore.add(U(this._lineNumbersDomNode,ee.MOUSE_LEAVE,()=>{this._isOnGlyphMargin=!1,this._useFoldingOpacityTransition(!0),this._setFoldingIconsVisibility(!1)})))}_renderChildNode(e,t,i,n){const o=this._editor._getViewModel();if(!o)return;const r=o.coordinatesConverter.convertModelPositionToViewPosition(new P(t,1)).lineNumber,a=o.getViewLineRenderingData(r),l=this._editor.getOption(68);let c;try{c=ms.filter(a.inlineDecorations,r,a.minColumn,a.maxColumn)}catch{c=[]}const d=new xh(!0,!0,a.content,a.continuesWithWrappedLine,a.isBasicASCII,a.containsRTL,0,a.tokens,c,a.tabSize,a.startVisibleColumn,1,1,1,500,"none",!0,!0,null),h=new vm(2e3),u=zC(d,h);let g;T8?g=T8.createHTML(h.build()):g=h.build();const f=document.createElement("span");f.setAttribute(TI,String(e)),f.setAttribute(E8,""),f.setAttribute("role","listitem"),f.tabIndex=0,f.className="sticky-line-content",f.classList.add(`stickyLine${t}`),f.style.lineHeight=`${this._lineHeight}px`,f.innerHTML=g;const m=document.createElement("span");m.setAttribute(TI,String(e)),m.setAttribute($Ee,""),m.className="sticky-line-number",m.style.lineHeight=`${this._lineHeight}px`;const _=n.contentLeft;m.style.width=`${_}px`;const b=document.createElement("span");l.renderType===1||l.renderType===3&&t%10===0?b.innerText=t.toString():l.renderType===2&&(b.innerText=Math.abs(t-this._editor.getPosition().lineNumber).toString()),b.className="sticky-line-number-inner",b.style.lineHeight=`${this._lineHeight}px`,b.style.width=`${n.lineNumbersWidth}px`,b.style.paddingLeft=`${n.lineNumbersLeft}px`,m.appendChild(b);const v=this._renderFoldingIconForLine(i,t);v&&m.appendChild(v.domNode),this._editor.applyFontInfo(f),this._editor.applyFontInfo(b),m.style.lineHeight=`${this._lineHeight}px`,f.style.lineHeight=`${this._lineHeight}px`,m.style.height=`${this._lineHeight}px`,f.style.height=`${this._lineHeight}px`;const C=new ZEe(e,t,f,m,v,u.characterMapping,f.scrollWidth);return this._updateTopAndZIndexOfStickyLine(C)}_updateTopAndZIndexOfStickyLine(e){const t=e.index,i=e.lineDomNode,n=e.lineNumberDomNode,o=t===this._lineNumbers.length-1,r="0",a="1";i.style.zIndex=o?r:a,n.style.zIndex=o?r:a;const l=`${t*this._lineHeight+this._lastLineRelativePosition+(e.foldingIcon?.isCollapsed?1:0)}px`,c=`${t*this._lineHeight}px`;return i.style.top=o?l:c,n.style.top=o?l:c,e}_renderFoldingIconForLine(e,t){const i=this._editor.getOption(111);if(!e||i==="never")return;const n=e.regions,o=n.findRange(t),r=n.getStartLineNumber(o);if(!(t===r))return;const l=n.isCollapsed(o),c=new KEe(l,r,n.getEndLineNumber(o),this._lineHeight);return c.setVisible(this._isOnGlyphMargin?!0:l||i==="always"),c.domNode.setAttribute(N8,""),c}getId(){return"editor.contrib.stickyScrollWidget"}getDomNode(){return this._rootDomNode}getPosition(){return{preference:2,stackOridinal:10}}getMinContentWidthInPx(){return this._minContentWidthInPx}focusLineWithIndex(e){0<=e&&e<this._renderedStickyLines.length&&this._renderedStickyLines[e].lineDomNode.focus()}getEditorPositionFromNode(e){if(!e||e.children.length>0)return null;const t=this._getRenderedStickyLineFromChildDomNode(e);if(!t)return null;const i=$O(t.characterMapping,e,0);return new P(t.lineNumber,i)}getLineNumberFromChildDomNode(e){return this._getRenderedStickyLineFromChildDomNode(e)?.lineNumber??null}_getRenderedStickyLineFromChildDomNode(e){const t=this.getLineIndexFromChildDomNode(e);return t===null||t<0||t>=this._renderedStickyLines.length?null:this._renderedStickyLines[t]}getLineIndexFromChildDomNode(e){const t=this._getAttributeValue(e,TI);return t?parseInt(t,10):null}isInStickyLine(e){return this._getAttributeValue(e,E8)!==void 0}isInFoldingIconDomNode(e){return this._getAttributeValue(e,N8)!==void 0}_getAttributeValue(e,t){for(;e&&e!==this._rootDomNode;){const i=e.getAttribute(t);if(i!==null)return i;e=e.parentElement}}}class ZEe{constructor(e,t,i,n,o,r,a){this.index=e,this.lineNumber=t,this.lineDomNode=i,this.lineNumberDomNode=n,this.foldingIcon=o,this.characterMapping=r,this.scrollWidth=a}}class KEe{constructor(e,t,i,n){this.isCollapsed=e,this.foldingStartLine=t,this.foldingEndLine=i,this.dimension=n,this.domNode=document.createElement("div"),this.domNode.style.width=`${n}px`,this.domNode.style.height=`${n}px`,this.domNode.className=Ie.asClassName(e?FS:OS)}setVisible(e){this.domNode.style.cursor=e?"pointer":"default",this.domNode.style.opacity=e?"1":"0"}}class Tb{constructor(e,t){this.startLineNumber=e,this.endLineNumber=t}}class tL{constructor(e,t,i){this.range=e,this.children=t,this.parent=i}}class rq{constructor(e,t,i,n){this.uri=e,this.version=t,this.element=i,this.outlineProviderId=n}}var lk=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},oC=function(s,e){return function(t,i){e(t,i,s)}},Eb;(function(s){s.OUTLINE_MODEL="outlineModel",s.FOLDING_PROVIDER_MODEL="foldingProviderModel",s.INDENTATION_MODEL="indentationModel"})(Eb||(Eb={}));var zd;(function(s){s[s.VALID=0]="VALID",s[s.INVALID=1]="INVALID",s[s.CANCELED=2]="CANCELED"})(zd||(zd={}));let OA=class extends B{constructor(e,t,i,n){switch(super(),this._editor=e,this._modelProviders=[],this._modelPromise=null,this._updateScheduler=this._register(new Cr(300)),this._updateOperation=this._register(new Z),this._editor.getOption(116).defaultModel){case Eb.OUTLINE_MODEL:this._modelProviders.push(new FA(this._editor,n));case Eb.FOLDING_PROVIDER_MODEL:this._modelProviders.push(new WA(this._editor,t,n));case Eb.INDENTATION_MODEL:this._modelProviders.push(new BA(this._editor,i));break}}dispose(){this._modelProviders.forEach(e=>e.dispose()),this._updateOperation.clear(),this._cancelModelPromise(),super.dispose()}_cancelModelPromise(){this._modelPromise&&(this._modelPromise.cancel(),this._modelPromise=null)}async update(e){return this._updateOperation.clear(),this._updateOperation.add({dispose:()=>{this._cancelModelPromise(),this._updateScheduler.cancel()}}),this._cancelModelPromise(),await this._updateScheduler.trigger(async()=>{for(const t of this._modelProviders){const{statusPromise:i,modelPromise:n}=t.computeStickyModel(e);this._modelPromise=n;const o=await i;if(this._modelPromise!==n)return null;switch(o){case zd.CANCELED:return this._updateOperation.clear(),null;case zd.VALID:return t.stickyModel}}return null}).catch(t=>(Oe(t),null))}};OA=lk([oC(2,ye),oC(3,pe)],OA);class aq extends B{constructor(e){super(),this._editor=e,this._stickyModel=null}get stickyModel(){return this._stickyModel}_invalid(){return this._stickyModel=null,zd.INVALID}computeStickyModel(e){if(e.isCancellationRequested||!this.isProviderValid())return{statusPromise:this._invalid(),modelPromise:null};const t=en(i=>this.createModelFromProvider(i));return{statusPromise:t.then(i=>this.isModelValid(i)?e.isCancellationRequested?zd.CANCELED:(this._stickyModel=this.createStickyModel(e,i),zd.VALID):this._invalid()).then(void 0,i=>(Oe(i),zd.CANCELED)),modelPromise:t}}isModelValid(e){return!0}isProviderValid(){return!0}}let FA=class extends aq{constructor(e,t){super(e),this._languageFeaturesService=t}createModelFromProvider(e){return uc.create(this._languageFeaturesService.documentSymbolProvider,this._editor.getModel(),e)}createStickyModel(e,t){const{stickyOutlineElement:i,providerID:n}=this._stickyModelFromOutlineModel(t,this._stickyModel?.outlineProviderId),o=this._editor.getModel();return new rq(o.uri,o.getVersionId(),i,n)}isModelValid(e){return e&&e.children.size>0}_stickyModelFromOutlineModel(e,t){let i;if(st.first(e.children.values())instanceof IK){const a=st.find(e.children.values(),l=>l.id===t);if(a)i=a.children;else{let l="",c=-1,d;for(const[h,u]of e.children.entries()){const g=this._findSumOfRangesOfGroup(u);g>c&&(d=u,c=g,l=u.id)}t=l,i=d.children}}else i=e.children;const n=[],o=Array.from(i.values()).sort((a,l)=>{const c=new Tb(a.symbol.range.startLineNumber,a.symbol.range.endLineNumber),d=new Tb(l.symbol.range.startLineNumber,l.symbol.range.endLineNumber);return this._comparator(c,d)});for(const a of o)n.push(this._stickyModelFromOutlineElement(a,a.symbol.selectionRange.startLineNumber));return{stickyOutlineElement:new tL(void 0,n,void 0),providerID:t}}_stickyModelFromOutlineElement(e,t){const i=[];for(const o of e.children.values())if(o.symbol.selectionRange.startLineNumber!==o.symbol.range.endLineNumber)if(o.symbol.selectionRange.startLineNumber!==t)i.push(this._stickyModelFromOutlineElement(o,o.symbol.selectionRange.startLineNumber));else for(const r of o.children.values())i.push(this._stickyModelFromOutlineElement(r,o.symbol.selectionRange.startLineNumber));i.sort((o,r)=>this._comparator(o.range,r.range));const n=new Tb(e.symbol.selectionRange.startLineNumber,e.symbol.range.endLineNumber);return new tL(n,i,void 0)}_comparator(e,t){return e.startLineNumber!==t.startLineNumber?e.startLineNumber-t.startLineNumber:t.endLineNumber-e.endLineNumber}_findSumOfRangesOfGroup(e){let t=0;for(const i of e.children.values())t+=this._findSumOfRangesOfGroup(i);return e instanceof zM?t+e.symbol.range.endLineNumber-e.symbol.selectionRange.startLineNumber:t}};FA=lk([oC(1,pe)],FA);class lq extends aq{constructor(e){super(e),this._foldingLimitReporter=new xK(e)}createStickyModel(e,t){const i=this._fromFoldingRegions(t),n=this._editor.getModel();return new rq(n.uri,n.getVersionId(),i,void 0)}isModelValid(e){return e!==null}_fromFoldingRegions(e){const t=e.length,i=[],n=new tL(void 0,[],void 0);for(let o=0;o<t;o++){const r=e.getParentIndex(o);let a;r!==-1?a=i[r]:a=n;const l=new tL(new Tb(e.getStartLineNumber(o),e.getEndLineNumber(o)+1),[],a);a.children.push(l),i.push(l)}return n}}let BA=class extends lq{constructor(e,t){super(e),this._languageConfigurationService=t,this.provider=this._register(new u4(e.getModel(),this._languageConfigurationService,this._foldingLimitReporter))}async createModelFromProvider(e){return this.provider.compute(e)}};BA=lk([oC(1,di)],BA);let WA=class extends lq{constructor(e,t,i){super(e),this._languageFeaturesService=i;const n=mh.getFoldingRangeProviders(this._languageFeaturesService,e.getModel());n.length>0&&(this.provider=this._register(new g4(e.getModel(),n,t,this._foldingLimitReporter,void 0)))}isProviderValid(){return this.provider!==void 0}async createModelFromProvider(e){return this.provider?.compute(e)??null}};WA=lk([oC(2,pe)],WA);var qEe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},R8=function(s,e){return function(t,i){e(t,i,s)}};class GEe{constructor(e,t,i){this.startLineNumber=e,this.endLineNumber=t,this.nestingDepth=i}}let HA=class extends B{constructor(e,t,i){super(),this._languageFeaturesService=t,this._languageConfigurationService=i,this._onDidChangeStickyScroll=this._register(new O),this.onDidChangeStickyScroll=this._onDidChangeStickyScroll.event,this._model=null,this._cts=null,this._stickyModelProvider=null,this._editor=e,this._sessionStore=this._register(new Z),this._updateSoon=this._register(new It(()=>this.update(),50)),this._register(this._editor.onDidChangeConfiguration(n=>{n.hasChanged(116)&&this.readConfiguration()})),this.readConfiguration()}readConfiguration(){this._sessionStore.clear(),this._editor.getOption(116).enabled&&(this._sessionStore.add(this._editor.onDidChangeModel(()=>{this._model=null,this.updateStickyModelProvider(),this._onDidChangeStickyScroll.fire(),this.update()})),this._sessionStore.add(this._editor.onDidChangeHiddenAreas(()=>this.update())),this._sessionStore.add(this._editor.onDidChangeModelContent(()=>this._updateSoon.schedule())),this._sessionStore.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(()=>this.update())),this._sessionStore.add(Ce(()=>{this._stickyModelProvider?.dispose(),this._stickyModelProvider=null})),this.updateStickyModelProvider(),this.update())}getVersionId(){return this._model?.version}updateStickyModelProvider(){this._stickyModelProvider?.dispose(),this._stickyModelProvider=null;const e=this._editor;e.hasModel()&&(this._stickyModelProvider=new OA(e,()=>this._updateSoon.schedule(),this._languageConfigurationService,this._languageFeaturesService))}async update(){this._cts?.dispose(!0),this._cts=new li,await this.updateStickyModel(this._cts.token),this._onDidChangeStickyScroll.fire()}async updateStickyModel(e){if(!this._editor.hasModel()||!this._stickyModelProvider||this._editor.getModel().isTooLargeForTokenization()){this._model=null;return}const t=await this._stickyModelProvider.update(e);e.isCancellationRequested||(this._model=t)}updateIndex(e){return e===-1?e=0:e<0&&(e=-e-2),e}getCandidateStickyLinesIntersectingFromStickyModel(e,t,i,n,o){if(t.children.length===0)return;let r=o;const a=[];for(let d=0;d<t.children.length;d++){const h=t.children[d];h.range&&a.push(h.range.startLineNumber)}const l=this.updateIndex(Bb(a,e.startLineNumber,(d,h)=>d-h)),c=this.updateIndex(Bb(a,e.startLineNumber+n,(d,h)=>d-h));for(let d=l;d<=c;d++){const h=t.children[d];if(!h)return;if(h.range){const u=h.range.startLineNumber,g=h.range.endLineNumber;e.startLineNumber<=g+1&&u-1<=e.endLineNumber&&u!==r&&(r=u,i.push(new GEe(u,g-1,n+1)),this.getCandidateStickyLinesIntersectingFromStickyModel(e,h,i,n+1,u))}else this.getCandidateStickyLinesIntersectingFromStickyModel(e,h,i,n,o)}}getCandidateStickyLinesIntersecting(e){if(!this._model?.element)return[];let t=[];this.getCandidateStickyLinesIntersectingFromStickyModel(e,this._model.element,t,0,-1);const i=this._editor._getViewModel()?.getHiddenAreas();if(i)for(const n of i)t=t.filter(o=>!(o.startLineNumber>=n.startLineNumber&&o.endLineNumber<=n.endLineNumber+1));return t}};HA=qEe([R8(1,pe),R8(2,di)],HA);var YEe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},of=function(s,e){return function(t,i){e(t,i,s)}},VA;let Kc=class extends B{static{VA=this}static{this.ID="store.contrib.stickyScrollController"}constructor(e,t,i,n,o,r,a){super(),this._editor=e,this._contextMenuService=t,this._languageFeaturesService=i,this._instaService=n,this._contextKeyService=a,this._sessionStore=new Z,this._maxStickyLines=Number.MAX_SAFE_INTEGER,this._candidateDefinitionsLength=-1,this._focusedStickyElementIndex=-1,this._enabled=!1,this._focused=!1,this._positionRevealed=!1,this._onMouseDown=!1,this._endLineNumbers=[],this._stickyScrollWidget=new jEe(this._editor),this._stickyLineCandidateProvider=new HA(this._editor,i,o),this._register(this._stickyScrollWidget),this._register(this._stickyLineCandidateProvider),this._widgetState=Ib.Empty,this._onDidResize(),this._readConfiguration();const l=this._stickyScrollWidget.getDomNode();this._register(this._editor.onDidChangeConfiguration(d=>{this._readConfigurationChange(d)})),this._register(U(l,ee.CONTEXT_MENU,async d=>{this._onContextMenu(ke(l),d)})),this._stickyScrollFocusedContextKey=I.stickyScrollFocused.bindTo(this._contextKeyService),this._stickyScrollVisibleContextKey=I.stickyScrollVisible.bindTo(this._contextKeyService);const c=this._register(Wa(l));this._register(c.onDidBlur(d=>{this._positionRevealed===!1&&l.clientHeight===0?(this._focusedStickyElementIndex=-1,this.focus()):this._disposeFocusStickyScrollStore()})),this._register(c.onDidFocus(d=>{this.focus()})),this._registerMouseListeners(),this._register(U(l,ee.MOUSE_DOWN,d=>{this._onMouseDown=!0}))}static get(e){return e.getContribution(VA.ID)}_disposeFocusStickyScrollStore(){this._stickyScrollFocusedContextKey.set(!1),this._focusDisposableStore?.dispose(),this._focused=!1,this._positionRevealed=!1,this._onMouseDown=!1}focus(){if(this._onMouseDown){this._onMouseDown=!1,this._editor.focus();return}this._stickyScrollFocusedContextKey.get()!==!0&&(this._focused=!0,this._focusDisposableStore=new Z,this._stickyScrollFocusedContextKey.set(!0),this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumbers.length-1,this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex))}focusNext(){this._focusedStickyElementIndex<this._stickyScrollWidget.lineNumberCount-1&&this._focusNav(!0)}focusPrevious(){this._focusedStickyElementIndex>0&&this._focusNav(!1)}selectEditor(){this._editor.focus()}_focusNav(e){this._focusedStickyElementIndex=e?this._focusedStickyElementIndex+1:this._focusedStickyElementIndex-1,this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex)}goToFocused(){const e=this._stickyScrollWidget.lineNumbers;this._disposeFocusStickyScrollStore(),this._revealPosition({lineNumber:e[this._focusedStickyElementIndex],column:1})}_revealPosition(e){this._reveaInEditor(e,()=>this._editor.revealPosition(e))}_revealLineInCenterIfOutsideViewport(e){this._reveaInEditor(e,()=>this._editor.revealLineInCenterIfOutsideViewport(e.lineNumber,0))}_reveaInEditor(e,t){this._focused&&this._disposeFocusStickyScrollStore(),this._positionRevealed=!0,t(),this._editor.setSelection(k.fromPositions(e)),this._editor.focus()}_registerMouseListeners(){const e=this._register(new Z),t=this._register(new Gx(this._editor,{extractLineNumberFromMouseEvent:o=>{const r=this._stickyScrollWidget.getEditorPositionFromNode(o.target.element);return r?r.lineNumber:0}})),i=o=>{if(!this._editor.hasModel()||o.target.type!==12||o.target.detail!==this._stickyScrollWidget.getId())return null;const r=o.target.element;if(!r||r.innerText!==r.innerHTML)return null;const a=this._stickyScrollWidget.getEditorPositionFromNode(r);return a?{range:new k(a.lineNumber,a.column,a.lineNumber,a.column+r.innerText.length),textElement:r}:null},n=this._stickyScrollWidget.getDomNode();this._register(gi(n,ee.CLICK,o=>{if(o.ctrlKey||o.altKey||o.metaKey||!o.leftButton)return;if(o.shiftKey){const c=this._stickyScrollWidget.getLineIndexFromChildDomNode(o.target);if(c===null)return;const d=new P(this._endLineNumbers[c],1);this._revealLineInCenterIfOutsideViewport(d);return}if(this._stickyScrollWidget.isInFoldingIconDomNode(o.target)){const c=this._stickyScrollWidget.getLineNumberFromChildDomNode(o.target);this._toggleFoldingRegionForLine(c);return}if(!this._stickyScrollWidget.isInStickyLine(o.target))return;let l=this._stickyScrollWidget.getEditorPositionFromNode(o.target);if(!l){const c=this._stickyScrollWidget.getLineNumberFromChildDomNode(o.target);if(c===null)return;l=new P(c,1)}this._revealPosition(l)})),this._register(gi(n,ee.MOUSE_MOVE,o=>{if(o.shiftKey){const r=this._stickyScrollWidget.getLineIndexFromChildDomNode(o.target);if(r===null||this._showEndForLine!==null&&this._showEndForLine===r)return;this._showEndForLine=r,this._renderStickyScroll();return}this._showEndForLine!==void 0&&(this._showEndForLine=void 0,this._renderStickyScroll())})),this._register(U(n,ee.MOUSE_LEAVE,o=>{this._showEndForLine!==void 0&&(this._showEndForLine=void 0,this._renderStickyScroll())})),this._register(t.onMouseMoveOrRelevantKeyDown(([o,r])=>{const a=i(o);if(!a||!o.hasTriggerModifier||!this._editor.hasModel()){e.clear();return}const{range:l,textElement:c}=a;if(!l.equalsRange(this._stickyRangeProjectedOnEditor))this._stickyRangeProjectedOnEditor=l,e.clear();else if(c.style.textDecoration==="underline")return;const d=new li;e.add(Ce(()=>d.dispose(!0)));let h;JC(this._languageFeaturesService.definitionProvider,this._editor.getModel(),new P(l.startLineNumber,l.startColumn+1),!1,d.token).then(u=>{if(!d.token.isCancellationRequested)if(u.length!==0){this._candidateDefinitionsLength=u.length;const g=c;h!==g?(e.clear(),h=g,h.style.textDecoration="underline",e.add(Ce(()=>{h.style.textDecoration="none"}))):h||(h=g,h.style.textDecoration="underline",e.add(Ce(()=>{h.style.textDecoration="none"})))}else e.clear()})})),this._register(t.onCancel(()=>{e.clear()})),this._register(t.onExecute(async o=>{if(o.target.type!==12||o.target.detail!==this._stickyScrollWidget.getId())return;const r=this._stickyScrollWidget.getEditorPositionFromNode(o.target.element);r&&(!this._editor.hasModel()||!this._stickyRangeProjectedOnEditor||(this._candidateDefinitionsLength>1&&(this._focused&&this._disposeFocusStickyScrollStore(),this._revealPosition({lineNumber:r.lineNumber,column:1})),this._instaService.invokeFunction(aK,o,this._editor,{uri:this._editor.getModel().uri,range:this._stickyRangeProjectedOnEditor})))}))}_onContextMenu(e,t){const i=new jr(e,t);this._contextMenuService.showContextMenu({menuId:M.StickyScrollContext,getAnchor:()=>i})}_toggleFoldingRegionForLine(e){if(!this._foldingModel||e===null)return;const t=this._stickyScrollWidget.getRenderedStickyLine(e),i=t?.foldingIcon;if(!i)return;c4(this._foldingModel,Number.MAX_VALUE,[e]),i.isCollapsed=!i.isCollapsed;const n=(i.isCollapsed?this._editor.getTopForLineNumber(i.foldingEndLine):this._editor.getTopForLineNumber(i.foldingStartLine))-this._editor.getOption(67)*t.index+1;this._editor.setScrollTop(n),this._renderStickyScroll(e)}_readConfiguration(){const e=this._editor.getOption(116);if(e.enabled===!1){this._editor.removeOverlayWidget(this._stickyScrollWidget),this._sessionStore.clear(),this._enabled=!1;return}else e.enabled&&!this._enabled&&(this._editor.addOverlayWidget(this._stickyScrollWidget),this._sessionStore.add(this._editor.onDidScrollChange(i=>{i.scrollTopChanged&&(this._showEndForLine=void 0,this._renderStickyScroll())})),this._sessionStore.add(this._editor.onDidLayoutChange(()=>this._onDidResize())),this._sessionStore.add(this._editor.onDidChangeModelTokens(i=>this._onTokensChange(i))),this._sessionStore.add(this._stickyLineCandidateProvider.onDidChangeStickyScroll(()=>{this._showEndForLine=void 0,this._renderStickyScroll()})),this._enabled=!0);this._editor.getOption(68).renderType===2&&this._sessionStore.add(this._editor.onDidChangeCursorPosition(()=>{this._showEndForLine=void 0,this._renderStickyScroll(0)}))}_readConfigurationChange(e){(e.hasChanged(116)||e.hasChanged(73)||e.hasChanged(67)||e.hasChanged(111)||e.hasChanged(68))&&this._readConfiguration(),e.hasChanged(68)&&this._renderStickyScroll(0)}_needsUpdate(e){const t=this._stickyScrollWidget.getCurrentLines();for(const i of t)for(const n of e.ranges)if(i>=n.fromLineNumber&&i<=n.toLineNumber)return!0;return!1}_onTokensChange(e){this._needsUpdate(e)&&this._renderStickyScroll(0)}_onDidResize(){const t=this._editor.getLayoutInfo().height/this._editor.getOption(67);this._maxStickyLines=Math.round(t*.25)}async _renderStickyScroll(e){const t=this._editor.getModel();if(!t||t.isTooLargeForTokenization()){this._resetState();return}const i=this._updateAndGetMinRebuildFromLine(e),n=this._stickyLineCandidateProvider.getVersionId();if(n===void 0||n===t.getVersionId())if(!this._focused)await this._updateState(i);else if(this._focusedStickyElementIndex===-1)await this._updateState(i),this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumberCount-1,this._focusedStickyElementIndex!==-1&&this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);else{const r=this._stickyScrollWidget.lineNumbers[this._focusedStickyElementIndex];await this._updateState(i),this._stickyScrollWidget.lineNumberCount===0?this._focusedStickyElementIndex=-1:(this._stickyScrollWidget.lineNumbers.includes(r)||(this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumberCount-1),this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex))}}_updateAndGetMinRebuildFromLine(e){if(e!==void 0){const t=this._minRebuildFromLine!==void 0?this._minRebuildFromLine:1/0;this._minRebuildFromLine=Math.min(e,t)}return this._minRebuildFromLine}async _updateState(e){this._minRebuildFromLine=void 0,this._foldingModel=await mh.get(this._editor)?.getFoldingModel()??void 0,this._widgetState=this.findScrollWidgetState();const t=this._widgetState.startLineNumbers.length>0;this._stickyScrollVisibleContextKey.set(t),this._stickyScrollWidget.setState(this._widgetState,this._foldingModel,e)}async _resetState(){this._minRebuildFromLine=void 0,this._foldingModel=void 0,this._widgetState=Ib.Empty,this._stickyScrollVisibleContextKey.set(!1),this._stickyScrollWidget.setState(void 0,void 0)}findScrollWidgetState(){const e=this._editor.getOption(67),t=Math.min(this._maxStickyLines,this._editor.getOption(116).maxLineCount),i=this._editor.getScrollTop();let n=0;const o=[],r=[],a=this._editor.getVisibleRanges();if(a.length!==0){const l=new Tb(a[0].startLineNumber,a[a.length-1].endLineNumber),c=this._stickyLineCandidateProvider.getCandidateStickyLinesIntersecting(l);for(const d of c){const h=d.startLineNumber,u=d.endLineNumber,g=d.nestingDepth;if(u-h>0){const f=(g-1)*e,m=g*e,_=this._editor.getBottomForLineNumber(h)-i,b=this._editor.getTopForLineNumber(u)-i,v=this._editor.getBottomForLineNumber(u)-i;if(f>b&&f<=v){o.push(h),r.push(u+1),n=v-m;break}else m>_&&m<=v&&(o.push(h),r.push(u+1));if(o.length===t)break}}}return this._endLineNumbers=r,new Ib(o,r,n,this._showEndForLine)}dispose(){super.dispose(),this._sessionStore.dispose()}};Kc=VA=YEe([of(1,bo),of(2,pe),of(3,ye),of(4,di),of(5,Go),of(6,Ee)],Kc);class XEe extends ks{constructor(){super({id:"editor.action.toggleStickyScroll",title:{...Re("toggleEditorStickyScroll","Toggle Editor Sticky Scroll"),mnemonicTitle:p({key:"mitoggleStickyScroll",comment:["&& denotes a mnemonic"]},"&&Toggle Editor Sticky Scroll")},metadata:{description:Re("toggleEditorStickyScroll.description","Toggle/enable the editor sticky scroll which shows the nested scopes at the top of the viewport")},category:UEe.View,toggled:{condition:q.equals("config.editor.stickyScroll.enabled",!0),title:p("stickyScroll","Sticky Scroll"),mnemonicTitle:p({key:"miStickyScroll",comment:["&& denotes a mnemonic"]},"&&Sticky Scroll")},menu:[{id:M.CommandPalette},{id:M.MenubarAppearanceMenu,group:"4_editor",order:3},{id:M.StickyScrollContext}]})}async run(e){const t=e.get(Ke),i=!t.getValue("editor.stickyScroll.enabled");return t.updateValue("editor.stickyScroll.enabled",i)}}const ck=100;class QEe extends Za{constructor(){super({id:"editor.action.focusStickyScroll",title:{...Re("focusStickyScroll","Focus on the editor sticky scroll"),mnemonicTitle:p({key:"mifocusStickyScroll",comment:["&& denotes a mnemonic"]},"&&Focus Sticky Scroll")},precondition:q.and(q.has("config.editor.stickyScroll.enabled"),I.stickyScrollVisible),menu:[{id:M.CommandPalette}]})}runEditorCommand(e,t){Kc.get(t)?.focus()}}class JEe extends Za{constructor(){super({id:"editor.action.selectNextStickyScrollLine",title:Re("selectNextStickyScrollLine.title","Select the next editor sticky scroll line"),precondition:I.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:ck,primary:18}})}runEditorCommand(e,t){Kc.get(t)?.focusNext()}}class eNe extends Za{constructor(){super({id:"editor.action.selectPreviousStickyScrollLine",title:Re("selectPreviousStickyScrollLine.title","Select the previous sticky scroll line"),precondition:I.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:ck,primary:16}})}runEditorCommand(e,t){Kc.get(t)?.focusPrevious()}}class tNe extends Za{constructor(){super({id:"editor.action.goToFocusedStickyScrollLine",title:Re("goToFocusedStickyScrollLine.title","Go to the focused sticky scroll line"),precondition:I.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:ck,primary:3}})}runEditorCommand(e,t){Kc.get(t)?.goToFocused()}}class iNe extends Za{constructor(){super({id:"editor.action.selectEditor",title:Re("selectEditor.title","Select Editor"),precondition:I.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:ck,primary:9}})}runEditorCommand(e,t){Kc.get(t)?.selectEditor()}}ct(Kc.ID,Kc,1);Bt(XEe);Bt(QEe);Bt(eNe);Bt(JEe);Bt(tNe);Bt(iNe);var cq=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},U_=function(s,e){return function(t,i){e(t,i,s)}};class nNe{constructor(e,t,i,n,o,r){this.range=e,this.insertText=t,this.filterText=i,this.additionalTextEdits=n,this.command=o,this.completion=r}}let zA=class extends xJ{constructor(e,t,i,n,o,r){super(o.disposable),this.model=e,this.line=t,this.word=i,this.completionModel=n,this._suggestMemoryService=r}canBeReused(e,t,i){return this.model===e&&this.line===t&&this.word.word.length>0&&this.word.startColumn===i.startColumn&&this.word.endColumn<i.endColumn&&this.completionModel.getIncompleteProvider().size===0}get items(){const e=[],{items:t}=this.completionModel,i=this._suggestMemoryService.select(this.model,{lineNumber:this.line,column:this.word.endColumn+this.completionModel.lineContext.characterCountDelta},t),n=st.slice(t,i),o=st.slice(t,0,i);let r=5;for(const a of st.concat(n,o)){if(a.score===Aa.Default)continue;const l=new k(a.editStart.lineNumber,a.editStart.column,a.editInsertEnd.lineNumber,a.editInsertEnd.column+this.completionModel.lineContext.characterCountDelta),c=a.completion.insertTextRules&&a.completion.insertTextRules&4?{snippet:a.completion.insertText}:a.completion.insertText;e.push(new nNe(l,c,a.filterTextLow??a.labelLow,a.completion.additionalTextEdits,a.completion.command,a)),r-->=0&&a.resolve(Ue.None)}return e}};zA=cq([U_(5,nk)],zA);let UA=class extends B{constructor(e,t,i,n){super(),this._languageFeatureService=e,this._clipboardService=t,this._suggestMemoryService=i,this._editorService=n,this._store.add(e.inlineCompletionsProvider.register("*",this))}async provideInlineCompletions(e,t,i,n){if(i.selectedSuggestionInfo)return;let o;for(const g of this._editorService.listCodeEditors())if(g.getModel()===e){o=g;break}if(!o)return;const r=o.getOption(90);if(Vf.isAllOff(r))return;e.tokenization.tokenizeIfCheap(t.lineNumber);const a=e.tokenization.getLineTokens(t.lineNumber),l=a.getStandardTokenType(a.findTokenIndexAtOffset(Math.max(t.column-1-1,0)));if(Vf.valueFor(r,l)!=="inline")return;let c=e.getWordAtPosition(t),d;if(c?.word||(d=this._getTriggerCharacterInfo(e,t)),!c?.word&&!d||(c||(c=e.getWordUntilPosition(t)),c.endColumn!==t.column))return;let h;const u=e.getValueInRange(new k(t.lineNumber,1,t.lineNumber,t.column));if(!d&&this._lastResult?.canBeReused(e,t.lineNumber,c)){const g=new m8(u,t.column-this._lastResult.word.endColumn);this._lastResult.completionModel.lineContext=g,this._lastResult.acquire(),h=this._lastResult}else{const g=await f4(this._languageFeatureService.completionProvider,e,t,new ny(void 0,jS.createSuggestFilter(o).itemKind,d?.providers),d&&{triggerKind:1,triggerCharacter:d.ch},n);let f;g.needsClipboard&&(f=await this._clipboardService.readText());const m=new kd(g.items,t.column,new m8(u,0),ul.None,o.getOption(119),o.getOption(113),{boostFullMatch:!1,firstMatchCanBeWeak:!1},f);h=new zA(e,t.lineNumber,c,m,g,this._suggestMemoryService)}return this._lastResult=h,h}handleItemDidShow(e,t){t.completion.resolve(Ue.None)}freeInlineCompletions(e){e.release()}_getTriggerCharacterInfo(e,t){const i=e.getValueInRange(k.fromPositions({lineNumber:t.lineNumber,column:t.column-1},t)),n=new Set;for(const o of this._languageFeatureService.completionProvider.all(e))o.triggerCharacters?.includes(i)&&n.add(o);if(n.size!==0)return{providers:n,ch:i}}};UA=cq([U_(0,pe),U_(1,Jc),U_(2,nk),U_(3,ft)],UA);Rm(UA);class sNe extends ge{constructor(){super({id:"editor.action.forceRetokenize",label:p("forceRetokenize","Developer: Force Retokenize"),alias:"Developer: Force Retokenize",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getModel();i.tokenization.resetTokenization();const n=new un;i.tokenization.forceTokenization(i.getLineCount()),n.stop(),console.log(`tokenization took ${n.elapsed()}`)}}Q(sNe);class $4 extends ks{static{this.ID="editor.action.toggleTabFocusMode"}constructor(){super({id:$4.ID,title:Re({key:"toggle.tabMovesFocus",comment:["Turn on/off use of tab key for moving focus around VS Code"]},"Toggle Tab Key Moves Focus"),precondition:void 0,keybinding:{primary:2091,mac:{primary:1323},weight:100},metadata:{description:Re("tabMovesFocusDescriptions","Determines whether the tab key moves focus around the workbench or inserts the tab character in the current editor. This is also called tab trapping, tab navigation, or tab focus mode.")},f1:!0})}run(){const t=!Up.getTabFocusMode();Up.setTabFocusMode(t),Ls(t?p("toggle.tabMovesFocus.on","Pressing Tab will now move focus to the next focusable element"):p("toggle.tabMovesFocus.off","Pressing Tab will now insert the tab character"))}}Bt($4);var oNe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},M8=function(s,e){return function(t,i){e(t,i,s)}};let $A=class extends B{get enabled(){return this._enabled}set enabled(e){e?(this.el.setAttribute("aria-disabled","false"),this.el.tabIndex=0,this.el.style.pointerEvents="auto",this.el.style.opacity="1",this.el.style.cursor="pointer",this._enabled=!1):(this.el.setAttribute("aria-disabled","true"),this.el.tabIndex=-1,this.el.style.pointerEvents="none",this.el.style.opacity="0.4",this.el.style.cursor="default",this._enabled=!0),this._enabled=e}constructor(e,t,i={},n,o){super(),this._link=t,this._hoverService=n,this._enabled=!0,this.el=X(e,te("a.monaco-link",{tabIndex:t.tabIndex??0,href:t.href},t.label)),this.hoverDelegate=i.hoverDelegate??Ds("mouse"),this.setTooltip(t.title),this.el.setAttribute("role","button");const r=this._register(new tt(this.el,"click")),a=this._register(new tt(this.el,"keypress")),l=se.chain(a.event,h=>h.map(u=>new Ft(u)).filter(u=>u.keyCode===3)),c=this._register(new tt(this.el,Wt.Tap)).event;this._register(ti.addTarget(this.el));const d=se.any(r.event,l,c);this._register(d(h=>{this.enabled&&(it.stop(h,!0),i?.opener?i.opener(this._link.href):o.open(this._link.href,{allowCommands:!0}))})),this.enabled=!0}setTooltip(e){this.hoverDelegate.showNativeHover?this.el.title=e??"":!this.hover&&e?this.hover=this._register(this._hoverService.setupManagedHover(this.hoverDelegate,this.el,e)):this.hover&&this.hover.update(e)}};$A=oNe([M8(3,Vl),M8(4,Ys)],$A);var dq=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},hq=function(s,e){return function(t,i){e(t,i,s)}};const rNe=26;let jA=class extends B{constructor(e,t){super(),this._editor=e,this.instantiationService=t,this.banner=this._register(this.instantiationService.createInstance(ZA))}hide(){this._editor.setBanner(null,0),this.banner.clear()}show(e){this.banner.show({...e,onClose:()=>{this.hide(),e.onClose?.()}}),this._editor.setBanner(this.banner.element,rNe)}};jA=dq([hq(1,ye)],jA);let ZA=class extends B{constructor(e){super(),this.instantiationService=e,this.markdownRenderer=this.instantiationService.createInstance(zc,{}),this.element=te("div.editor-banner"),this.element.tabIndex=0}getAriaLabel(e){if(e.ariaLabel)return e.ariaLabel;if(typeof e.message=="string")return e.message}getBannerMessage(e){if(typeof e=="string"){const t=te("span");return t.innerText=e,t}return this.markdownRenderer.render(e).element}clear(){Cn(this.element)}show(e){Cn(this.element);const t=this.getAriaLabel(e);t&&this.element.setAttribute("aria-label",t);const i=X(this.element,te("div.icon-container"));i.setAttribute("aria-hidden","true"),e.icon&&i.appendChild(te(`div${Ie.asCSSSelector(e.icon)}`));const n=X(this.element,te("div.message-container"));if(n.setAttribute("aria-hidden","true"),n.appendChild(this.getBannerMessage(e.message)),this.messageActionsContainer=X(this.element,te("div.message-actions-container")),e.actions)for(const r of e.actions)this._register(this.instantiationService.createInstance($A,this.messageActionsContainer,{...r,tabIndex:-1},{}));const o=X(this.element,te("div.action-container"));this.actionBar=this._register(new zo(o)),this.actionBar.push(this._register(new ho("banner.close","Close Banner",Ie.asClassName(k$),!0,()=>{typeof e.onClose=="function"&&e.onClose()})),{icon:!0,label:!1}),this.actionBar.setFocusable(!1)}};ZA=dq([hq(0,ye)],ZA);var j4=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},vp=function(s,e){return function(t,i){e(t,i,s)}};const aNe=Kt("extensions-warning-message",J.warning,p("warningIcon","Icon shown with a warning message in the extensions editor."));let rC=class extends B{static{this.ID="editor.contrib.unicodeHighlighter"}constructor(e,t,i,n){super(),this._editor=e,this._editorWorkerService=t,this._workspaceTrustService=i,this._highlighter=null,this._bannerClosed=!1,this._updateState=o=>{if(o&&o.hasMore){if(this._bannerClosed)return;const r=Math.max(o.ambiguousCharacterCount,o.nonBasicAsciiCharacterCount,o.invisibleCharacterCount);let a;if(o.nonBasicAsciiCharacterCount>=r)a={message:p("unicodeHighlighting.thisDocumentHasManyNonBasicAsciiUnicodeCharacters","This document contains many non-basic ASCII unicode characters"),command:new ry};else if(o.ambiguousCharacterCount>=r)a={message:p("unicodeHighlighting.thisDocumentHasManyAmbiguousUnicodeCharacters","This document contains many ambiguous unicode characters"),command:new Ng};else if(o.invisibleCharacterCount>=r)a={message:p("unicodeHighlighting.thisDocumentHasManyInvisibleUnicodeCharacters","This document contains many invisible unicode characters"),command:new oy};else throw new Error("Unreachable");this._bannerController.show({id:"unicodeHighlightBanner",message:a.message,icon:aNe,actions:[{label:a.command.shortLabel,href:`command:${a.command.id}`}],onClose:()=>{this._bannerClosed=!0}})}else this._bannerController.hide()},this._bannerController=this._register(n.createInstance(jA,e)),this._register(this._editor.onDidChangeModel(()=>{this._bannerClosed=!1,this._updateHighlighter()})),this._options=e.getOption(126),this._register(i.onDidChangeTrust(o=>{this._updateHighlighter()})),this._register(e.onDidChangeConfiguration(o=>{o.hasChanged(126)&&(this._options=e.getOption(126),this._updateHighlighter())})),this._updateHighlighter()}dispose(){this._highlighter&&(this._highlighter.dispose(),this._highlighter=null),super.dispose()}_updateHighlighter(){if(this._updateState(null),this._highlighter&&(this._highlighter.dispose(),this._highlighter=null),!this._editor.hasModel())return;const e=lNe(this._workspaceTrustService.isWorkspaceTrusted(),this._options);if([e.nonBasicASCII,e.ambiguousCharacters,e.invisibleCharacters].every(i=>i===!1))return;const t={nonBasicASCII:e.nonBasicASCII,ambiguousCharacters:e.ambiguousCharacters,invisibleCharacters:e.invisibleCharacters,includeComments:e.includeComments,includeStrings:e.includeStrings,allowedCodePoints:Object.keys(e.allowedCharacters).map(i=>i.codePointAt(0)),allowedLocales:Object.keys(e.allowedLocales).map(i=>i==="_os"?new Intl.NumberFormat().resolvedOptions().locale:i==="_vscode"?SQ:i)};this._editorWorkerService.canComputeUnicodeHighlights(this._editor.getModel().uri)?this._highlighter=new KA(this._editor,t,this._updateState,this._editorWorkerService):this._highlighter=new cNe(this._editor,t,this._updateState)}getDecorationInfo(e){return this._highlighter?this._highlighter.getDecorationInfo(e):null}};rC=j4([vp(1,Xs),vp(2,zz),vp(3,ye)],rC);function lNe(s,e){return{nonBasicASCII:e.nonBasicASCII===ko?!s:e.nonBasicASCII,ambiguousCharacters:e.ambiguousCharacters,invisibleCharacters:e.invisibleCharacters,includeComments:e.includeComments===ko?!s:e.includeComments,includeStrings:e.includeStrings===ko?!s:e.includeStrings,allowedCharacters:e.allowedCharacters,allowedLocales:e.allowedLocales}}let KA=class extends B{constructor(e,t,i,n){super(),this._editor=e,this._options=t,this._updateState=i,this._editorWorkerService=n,this._model=this._editor.getModel(),this._decorations=this._editor.createDecorationsCollection(),this._updateSoon=this._register(new It(()=>this._update(),250)),this._register(this._editor.onDidChangeModelContent(()=>{this._updateSoon.schedule()})),this._updateSoon.schedule()}dispose(){this._decorations.clear(),super.dispose()}_update(){if(this._model.isDisposed())return;if(!this._model.mightContainNonBasicASCII()){this._decorations.clear();return}const e=this._model.getVersionId();this._editorWorkerService.computedUnicodeHighlights(this._model.uri,this._options).then(t=>{if(this._model.isDisposed()||this._model.getVersionId()!==e)return;this._updateState(t);const i=[];if(!t.hasMore)for(const n of t.ranges)i.push({range:n,options:dk.instance.getDecorationFromOptions(this._options)});this._decorations.set(i)})}getDecorationInfo(e){if(!this._decorations.has(e))return null;const t=this._editor.getModel();if(!lF(t,e))return null;const i=t.getValueInRange(e.range);return{reason:gq(i,this._options),inComment:cF(t,e),inString:dF(t,e)}}};KA=j4([vp(3,Xs)],KA);class cNe extends B{constructor(e,t,i){super(),this._editor=e,this._options=t,this._updateState=i,this._model=this._editor.getModel(),this._decorations=this._editor.createDecorationsCollection(),this._updateSoon=this._register(new It(()=>this._update(),250)),this._register(this._editor.onDidLayoutChange(()=>{this._updateSoon.schedule()})),this._register(this._editor.onDidScrollChange(()=>{this._updateSoon.schedule()})),this._register(this._editor.onDidChangeHiddenAreas(()=>{this._updateSoon.schedule()})),this._register(this._editor.onDidChangeModelContent(()=>{this._updateSoon.schedule()})),this._updateSoon.schedule()}dispose(){this._decorations.clear(),super.dispose()}_update(){if(this._model.isDisposed())return;if(!this._model.mightContainNonBasicASCII()){this._decorations.clear();return}const e=this._editor.getVisibleRanges(),t=[],i={ranges:[],ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0,hasMore:!1};for(const n of e){const o=h2.computeUnicodeHighlights(this._model,this._options,n);for(const r of o.ranges)i.ranges.push(r);i.ambiguousCharacterCount+=i.ambiguousCharacterCount,i.invisibleCharacterCount+=i.invisibleCharacterCount,i.nonBasicAsciiCharacterCount+=i.nonBasicAsciiCharacterCount,i.hasMore=i.hasMore||o.hasMore}if(!i.hasMore)for(const n of i.ranges)t.push({range:n,options:dk.instance.getDecorationFromOptions(this._options)});this._updateState(i),this._decorations.set(t)}getDecorationInfo(e){if(!this._decorations.has(e))return null;const t=this._editor.getModel(),i=t.getValueInRange(e.range);return lF(t,e)?{reason:gq(i,this._options),inComment:cF(t,e),inString:dF(t,e)}:null}}const uq=p("unicodeHighlight.configureUnicodeHighlightOptions","Configure Unicode Highlight Options");let qA=class{constructor(e,t,i){this._editor=e,this._languageService=t,this._openerService=i,this.hoverOrdinal=5}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1)return[];const i=this._editor.getModel(),n=this._editor.getContribution(rC.ID);if(!n)return[];const o=[],r=new Set;let a=300;for(const l of t){const c=n.getDecorationInfo(l);if(!c)continue;const h=i.getValueInRange(l.range).codePointAt(0),u=EI(h);let g;switch(c.reason.kind){case 0:{vC(c.reason.confusableWith)?g=p("unicodeHighlight.characterIsAmbiguousASCII","The character {0} could be confused with the ASCII character {1}, which is more common in source code.",u,EI(c.reason.confusableWith.codePointAt(0))):g=p("unicodeHighlight.characterIsAmbiguous","The character {0} could be confused with the character {1}, which is more common in source code.",u,EI(c.reason.confusableWith.codePointAt(0)));break}case 1:g=p("unicodeHighlight.characterIsInvisible","The character {0} is invisible.",u);break;case 2:g=p("unicodeHighlight.characterIsNonBasicAscii","The character {0} is not a basic ASCII character.",u);break}if(r.has(g))continue;r.add(g);const f={codePoint:h,reason:c.reason,inComment:c.inComment,inString:c.inString},m=p("unicodeHighlight.adjustSettings","Adjust settings"),_=`command:${hk.ID}?${encodeURIComponent(JSON.stringify(f))}`,b=new zn("",!0).appendMarkdown(g).appendText(" ").appendLink(_,m,uq);o.push(new $r(this,l.range,[b],!1,a++))}return o}renderHoverParts(e,t){return FSe(e,t,this._editor,this._languageService,this._openerService)}};qA=j4([vp(1,ni),vp(2,Ys)],qA);function GA(s){return`U+${s.toString(16).padStart(4,"0")}`}function EI(s){let e=`\`${GA(s)}\``;return Tc.isInvisibleCharacter(s)||(e+=` "${`${dNe(s)}`}"`),e}function dNe(s){return s===96?"`` ` ``":"`"+String.fromCodePoint(s)+"`"}function gq(s,e){return h2.computeUnicodeHighlightReason(s,e)}class dk{constructor(){this.map=new Map}static{this.instance=new dk}getDecorationFromOptions(e){return this.getDecoration(!e.includeComments,!e.includeStrings)}getDecoration(e,t){const i=`${e}${t}`;let n=this.map.get(i);return n||(n=We.createDynamic({description:"unicode-highlight",stickiness:1,className:"unicode-highlight",showIfCollapsed:!0,overviewRuler:null,minimap:null,hideInCommentTokens:e,hideInStringTokens:t}),this.map.set(i,n)),n}}class hNe extends ge{constructor(){super({id:Ng.ID,label:p("action.unicodeHighlight.disableHighlightingInComments","Disable highlighting of characters in comments"),alias:"Disable highlighting of characters in comments",precondition:void 0}),this.shortLabel=p("unicodeHighlight.disableHighlightingInComments.shortLabel","Disable Highlight In Comments")}async run(e,t,i){const n=e?.get(Ke);n&&this.runAction(n)}async runAction(e){await e.updateValue(Os.includeComments,!1,2)}}class uNe extends ge{constructor(){super({id:Ng.ID,label:p("action.unicodeHighlight.disableHighlightingInStrings","Disable highlighting of characters in strings"),alias:"Disable highlighting of characters in strings",precondition:void 0}),this.shortLabel=p("unicodeHighlight.disableHighlightingInStrings.shortLabel","Disable Highlight In Strings")}async run(e,t,i){const n=e?.get(Ke);n&&this.runAction(n)}async runAction(e){await e.updateValue(Os.includeStrings,!1,2)}}class Ng extends ge{static{this.ID="editor.action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters"}constructor(){super({id:Ng.ID,label:p("action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters","Disable highlighting of ambiguous characters"),alias:"Disable highlighting of ambiguous characters",precondition:void 0}),this.shortLabel=p("unicodeHighlight.disableHighlightingOfAmbiguousCharacters.shortLabel","Disable Ambiguous Highlight")}async run(e,t,i){const n=e?.get(Ke);n&&this.runAction(n)}async runAction(e){await e.updateValue(Os.ambiguousCharacters,!1,2)}}class oy extends ge{static{this.ID="editor.action.unicodeHighlight.disableHighlightingOfInvisibleCharacters"}constructor(){super({id:oy.ID,label:p("action.unicodeHighlight.disableHighlightingOfInvisibleCharacters","Disable highlighting of invisible characters"),alias:"Disable highlighting of invisible characters",precondition:void 0}),this.shortLabel=p("unicodeHighlight.disableHighlightingOfInvisibleCharacters.shortLabel","Disable Invisible Highlight")}async run(e,t,i){const n=e?.get(Ke);n&&this.runAction(n)}async runAction(e){await e.updateValue(Os.invisibleCharacters,!1,2)}}class ry extends ge{static{this.ID="editor.action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters"}constructor(){super({id:ry.ID,label:p("action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters","Disable highlighting of non basic ASCII characters"),alias:"Disable highlighting of non basic ASCII characters",precondition:void 0}),this.shortLabel=p("unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters.shortLabel","Disable Non ASCII Highlight")}async run(e,t,i){const n=e?.get(Ke);n&&this.runAction(n)}async runAction(e){await e.updateValue(Os.nonBasicASCII,!1,2)}}class hk extends ge{static{this.ID="editor.action.unicodeHighlight.showExcludeOptions"}constructor(){super({id:hk.ID,label:p("action.unicodeHighlight.showExcludeOptions","Show Exclude Options"),alias:"Show Exclude Options",precondition:void 0})}async run(e,t,i){const{codePoint:n,reason:o,inString:r,inComment:a}=i,l=String.fromCodePoint(n),c=e.get(Dr),d=e.get(Ke);function h(f){return Tc.isInvisibleCharacter(f)?p("unicodeHighlight.excludeInvisibleCharFromBeingHighlighted","Exclude {0} (invisible character) from being highlighted",GA(f)):p("unicodeHighlight.excludeCharFromBeingHighlighted","Exclude {0} from being highlighted",`${GA(f)} "${l}"`)}const u=[];if(o.kind===0)for(const f of o.notAmbiguousInLocales)u.push({label:p("unicodeHighlight.allowCommonCharactersInLanguage",'Allow unicode characters that are more common in the language "{0}".',f),run:async()=>{fNe(d,[f])}});if(u.push({label:h(n),run:()=>gNe(d,[n])}),a){const f=new hNe;u.push({label:f.label,run:async()=>f.runAction(d)})}else if(r){const f=new uNe;u.push({label:f.label,run:async()=>f.runAction(d)})}if(o.kind===0){const f=new Ng;u.push({label:f.label,run:async()=>f.runAction(d)})}else if(o.kind===1){const f=new oy;u.push({label:f.label,run:async()=>f.runAction(d)})}else if(o.kind===2){const f=new ry;u.push({label:f.label,run:async()=>f.runAction(d)})}else pNe(o);const g=await c.pick(u,{title:uq});g&&await g.run()}}async function gNe(s,e){const t=s.getValue(Os.allowedCharacters);let i;typeof t=="object"&&t?i=t:i={};for(const n of e)i[String.fromCodePoint(n)]=!0;await s.updateValue(Os.allowedCharacters,i,2)}async function fNe(s,e){const t=s.inspect(Os.allowedLocales).user?.value;let i;typeof t=="object"&&t?i=Object.assign({},t):i={};for(const n of e)i[n]=!0;await s.updateValue(Os.allowedLocales,i,2)}function pNe(s){throw new Error(`Unexpected value: ${s}`)}Q(Ng);Q(oy);Q(ry);Q(hk);ct(rC.ID,rC,1);Dg.register(qA);var mNe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},A8=function(s,e){return function(t,i){e(t,i,s)}};const fq="ignoreUnusualLineTerminators";function _Ne(s,e,t){s.setModelProperty(e.uri,fq,t)}function bNe(s,e){return s.getModelProperty(e.uri,fq)}let iL=class extends B{static{this.ID="editor.contrib.unusualLineTerminatorsDetector"}constructor(e,t,i){super(),this._editor=e,this._dialogService=t,this._codeEditorService=i,this._isPresentingDialog=!1,this._config=this._editor.getOption(127),this._register(this._editor.onDidChangeConfiguration(n=>{n.hasChanged(127)&&(this._config=this._editor.getOption(127),this._checkForUnusualLineTerminators())})),this._register(this._editor.onDidChangeModel(()=>{this._checkForUnusualLineTerminators()})),this._register(this._editor.onDidChangeModelContent(n=>{n.isUndoing||this._checkForUnusualLineTerminators()})),this._checkForUnusualLineTerminators()}async _checkForUnusualLineTerminators(){if(this._config==="off"||!this._editor.hasModel())return;const e=this._editor.getModel();if(!e.mightContainUnusualLineTerminators()||bNe(this._codeEditorService,e)===!0||this._editor.getOption(92))return;if(this._config==="auto"){e.removeUnusualLineTerminators(this._editor.getSelections());return}if(this._isPresentingDialog)return;let i;try{this._isPresentingDialog=!0,i=await this._dialogService.confirm({title:p("unusualLineTerminators.title","Unusual Line Terminators"),message:p("unusualLineTerminators.message","Detected unusual line terminators"),detail:p("unusualLineTerminators.detail","The file '{0}' contains one or more unusual line terminator characters, like Line Separator (LS) or Paragraph Separator (PS).\n\nIt is recommended to remove them from the file. This can be configured via `editor.unusualLineTerminators`.",wr(e.uri)),primaryButton:p({key:"unusualLineTerminators.fix",comment:["&& denotes a mnemonic"]},"&&Remove Unusual Line Terminators"),cancelButton:p("unusualLineTerminators.ignore","Ignore")})}finally{this._isPresentingDialog=!1}if(!i.confirmed){_Ne(this._codeEditorService,e,!0);return}e.removeUnusualLineTerminators(this._editor.getSelections())}};iL=mNe([A8(1,xC),A8(2,ft)],iL);ct(iL.ID,iL,1);var vNe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},CNe=function(s,e){return function(t,i){e(t,i,s)}};class P8{constructor(){this.selector={language:"*"}}provideDocumentHighlights(e,t,i){const n=[],o=e.getWordAtPosition({lineNumber:t.lineNumber,column:t.column});return o?e.isDisposed()?void 0:e.findMatches(o.word,!0,!1,!0,k1,!1).map(a=>({range:a.range,kind:wp.Text})):Promise.resolve(n)}provideMultiDocumentHighlights(e,t,i,n){const o=new Ui,r=e.getWordAtPosition({lineNumber:t.lineNumber,column:t.column});if(!r)return Promise.resolve(o);for(const a of[e,...i]){if(a.isDisposed())continue;const c=a.findMatches(r.word,!0,!1,!0,k1,!1).map(d=>({range:d.range,kind:wp.Text}));c&&o.set(a.uri,c)}return o}}let YA=class extends B{constructor(e){super(),this._register(e.documentHighlightProvider.register("*",new P8)),this._register(e.multiDocumentHighlightProvider.register("*",new P8))}};YA=vNe([CNe(0,pe)],YA);var pq=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},p1=function(s,e){return function(t,i){e(t,i,s)}},xi,XA;const Z4=new le("hasWordHighlights",!1);function mq(s,e,t,i){const n=s.ordered(e);return KP(n.map(o=>()=>Promise.resolve(o.provideDocumentHighlights(e,t,i)).then(void 0,Li)),o=>o!=null).then(o=>{if(o){const r=new Ui;return r.set(e.uri,o),r}return new Ui})}function yNe(s,e,t,i,n,o){const r=s.ordered(e);return KP(r.map(a=>()=>{const l=o.filter(c=>IV(c)).filter(c=>C2(a.selector,c.uri,c.getLanguageId(),!0,void 0,void 0)>0);return Promise.resolve(a.provideMultiDocumentHighlights(e,t,l,n)).then(void 0,Li)}),a=>a!=null)}class _q{constructor(e,t,i){this._model=e,this._selection=t,this._wordSeparators=i,this._wordRange=this._getCurrentWordRange(e,t),this._result=null}get result(){return this._result||(this._result=en(e=>this._compute(this._model,this._selection,this._wordSeparators,e))),this._result}_getCurrentWordRange(e,t){const i=e.getWordAtPosition(t.getPosition());return i?new k(t.startLineNumber,i.startColumn,t.startLineNumber,i.endColumn):null}isValid(e,t,i){const n=t.startLineNumber,o=t.startColumn,r=t.endColumn,a=this._getCurrentWordRange(e,t);let l=!!(this._wordRange&&this._wordRange.equalsRange(a));for(let c=0,d=i.length;!l&&c<d;c++){const h=i.getRange(c);h&&h.startLineNumber===n&&h.startColumn<=o&&h.endColumn>=r&&(l=!0)}return l}cancel(){this.result.cancel()}}class wNe extends _q{constructor(e,t,i,n){super(e,t,i),this._providers=n}_compute(e,t,i,n){return mq(this._providers,e,t.getPosition(),n).then(o=>o||new Ui)}}class SNe extends _q{constructor(e,t,i,n,o){super(e,t,i),this._providers=n,this._otherModels=o}_compute(e,t,i,n){return yNe(this._providers,e,t.getPosition(),i,n,this._otherModels).then(o=>o||new Ui)}}function LNe(s,e,t,i,n){return new wNe(e,t,n,s)}function xNe(s,e,t,i,n,o){return new SNe(e,t,n,s,o)}Gs("_executeDocumentHighlights",async(s,e,t)=>{const i=s.get(pe);return(await mq(i.documentHighlightProvider,e,t,Ue.None))?.get(e.uri)});let QA=class{static{xi=this}static{this.storedDecorationIDs=new Ui}static{this.query=null}constructor(e,t,i,n,o){this.toUnhook=new Z,this.workerRequestTokenId=0,this.workerRequestCompleted=!1,this.workerRequestValue=new Ui,this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1,this.runDelayer=this.toUnhook.add(new Cr(50)),this.editor=e,this.providers=t,this.multiDocumentProviders=i,this.codeEditorService=o,this._hasWordHighlights=Z4.bindTo(n),this._ignorePositionChangeEvent=!1,this.occurrencesHighlight=this.editor.getOption(81),this.model=this.editor.getModel(),this.toUnhook.add(e.onDidChangeCursorPosition(r=>{this._ignorePositionChangeEvent||this.occurrencesHighlight!=="off"&&this.runDelayer.trigger(()=>{this._onPositionChanged(r)})})),this.toUnhook.add(e.onDidFocusEditorText(r=>{this.occurrencesHighlight!=="off"&&(this.workerRequest||this.runDelayer.trigger(()=>{this._run()}))})),this.toUnhook.add(e.onDidChangeModelContent(r=>{bL(this.model.uri,"output")||this._stopAll()})),this.toUnhook.add(e.onDidChangeModel(r=>{!r.newModelUrl&&r.oldModelUrl?this._stopSingular():xi.query&&this._run()})),this.toUnhook.add(e.onDidChangeConfiguration(r=>{const a=this.editor.getOption(81);if(this.occurrencesHighlight!==a)switch(this.occurrencesHighlight=a,a){case"off":this._stopAll();break;case"singleFile":this._stopAll(xi.query?.modelInfo?.model);break;case"multiFile":xi.query&&this._run(!0);break;default:console.warn("Unknown occurrencesHighlight setting value:",a);break}})),this.decorations=this.editor.createDecorationsCollection(),this.workerRequestTokenId=0,this.workerRequest=null,this.workerRequestCompleted=!1,this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1,xi.query&&this._run()}hasDecorations(){return this.decorations.length>0}restore(){this.occurrencesHighlight!=="off"&&(this.runDelayer.cancel(),this._run())}_getSortedHighlights(){return this.decorations.getRanges().sort(k.compareRangesUsingStarts)}moveNext(){const e=this._getSortedHighlights(),i=(e.findIndex(o=>o.containsPosition(this.editor.getPosition()))+1)%e.length,n=e[i];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(n.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(n);const o=this._getWord();if(o){const r=this.editor.getModel().getLineContent(n.startLineNumber);Ls(`${r}, ${i+1} of ${e.length} for '${o.word}'`)}}finally{this._ignorePositionChangeEvent=!1}}moveBack(){const e=this._getSortedHighlights(),i=(e.findIndex(o=>o.containsPosition(this.editor.getPosition()))-1+e.length)%e.length,n=e[i];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(n.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(n);const o=this._getWord();if(o){const r=this.editor.getModel().getLineContent(n.startLineNumber);Ls(`${r}, ${i+1} of ${e.length} for '${o.word}'`)}}finally{this._ignorePositionChangeEvent=!1}}_removeSingleDecorations(){if(!this.editor.hasModel())return;const e=xi.storedDecorationIDs.get(this.editor.getModel().uri);e&&(this.editor.removeDecorations(e),xi.storedDecorationIDs.delete(this.editor.getModel().uri),this.decorations.length>0&&(this.decorations.clear(),this._hasWordHighlights.set(!1)))}_removeAllDecorations(e){const t=this.codeEditorService.listCodeEditors(),i=[];for(const n of t){if(!n.hasModel()||dv(n.getModel().uri,e?.uri))continue;const o=xi.storedDecorationIDs.get(n.getModel().uri);if(!o)continue;n.removeDecorations(o),i.push(n.getModel().uri);const r=bh.get(n);r?.wordHighlighter&&r.wordHighlighter.decorations.length>0&&(r.wordHighlighter.decorations.clear(),r.wordHighlighter.workerRequest=null,r.wordHighlighter._hasWordHighlights.set(!1))}for(const n of i)xi.storedDecorationIDs.delete(n)}_stopSingular(){this._removeSingleDecorations(),this.editor.hasTextFocus()&&(this.editor.getModel()?.uri.scheme!==Fe.vscodeNotebookCell&&xi.query?.modelInfo?.model.uri.scheme!==Fe.vscodeNotebookCell?(xi.query=null,this._run()):xi.query?.modelInfo&&(xi.query.modelInfo=null)),this.renderDecorationsTimer!==-1&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1),this.workerRequest!==null&&(this.workerRequest.cancel(),this.workerRequest=null),this.workerRequestCompleted||(this.workerRequestTokenId++,this.workerRequestCompleted=!0)}_stopAll(e){this._removeAllDecorations(e),this.renderDecorationsTimer!==-1&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1),this.workerRequest!==null&&(this.workerRequest.cancel(),this.workerRequest=null),this.workerRequestCompleted||(this.workerRequestTokenId++,this.workerRequestCompleted=!0)}_onPositionChanged(e){if(this.occurrencesHighlight==="off"){this._stopAll();return}if(e.reason!==3&&this.editor.getModel()?.uri.scheme!==Fe.vscodeNotebookCell){this._stopAll();return}this._run()}_getWord(){const e=this.editor.getSelection(),t=e.startLineNumber,i=e.startColumn;return this.model.isDisposed()?null:this.model.getWordAtPosition({lineNumber:t,column:i})}getOtherModelsToHighlight(e){if(!e)return[];if(e.uri.scheme===Fe.vscodeNotebookCell){const o=[],r=this.codeEditorService.listCodeEditors();for(const a of r){const l=a.getModel();l&&l!==e&&l.uri.scheme===Fe.vscodeNotebookCell&&o.push(l)}return o}const i=[],n=this.codeEditorService.listCodeEditors();for(const o of n){if(!TF(o))continue;const r=o.getModel();r&&e===r.modified&&i.push(r.modified)}if(i.length)return i;if(this.occurrencesHighlight==="singleFile")return[];for(const o of n){const r=o.getModel();r&&r!==e&&i.push(r)}return i}_run(e){let t;if(this.editor.hasTextFocus()){const n=this.editor.getSelection();if(!n||n.startLineNumber!==n.endLineNumber){xi.query=null,this._stopAll();return}const o=n.startColumn,r=n.endColumn,a=this._getWord();if(!a||a.startColumn>o||a.endColumn<r){xi.query=null,this._stopAll();return}t=this.workerRequest&&this.workerRequest.isValid(this.model,n,this.decorations),xi.query={modelInfo:{model:this.model,selection:n},word:a}}else if(!xi.query){this._stopAll();return}if(this.lastCursorPositionChangeTime=new Date().getTime(),t)this.workerRequestCompleted&&this.renderDecorationsTimer!==-1&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1,this._beginRenderDecorations());else if(dv(this.editor.getModel().uri,xi.query.modelInfo?.model.uri)){if(!e){const r=this.decorations.getRanges();for(const a of r)if(a.containsPosition(this.editor.getPosition()))return}this._stopAll(e?this.model:void 0);const n=++this.workerRequestTokenId;this.workerRequestCompleted=!1;const o=this.getOtherModelsToHighlight(this.editor.getModel());if(!xi.query||!xi.query.modelInfo||xi.query.modelInfo.model.isDisposed())return;this.workerRequest=this.computeWithModel(xi.query.modelInfo.model,xi.query.modelInfo.selection,xi.query.word,o),this.workerRequest?.result.then(r=>{n===this.workerRequestTokenId&&(this.workerRequestCompleted=!0,this.workerRequestValue=r||[],this._beginRenderDecorations())},Oe)}}computeWithModel(e,t,i,n){return n.length?xNe(this.multiDocumentProviders,e,t,i,this.editor.getOption(132),n):LNe(this.providers,e,t,i,this.editor.getOption(132))}_beginRenderDecorations(){const e=new Date().getTime(),t=this.lastCursorPositionChangeTime+250;e>=t?(this.renderDecorationsTimer=-1,this.renderDecorations()):this.renderDecorationsTimer=setTimeout(()=>{this.renderDecorations()},t-e)}renderDecorations(){this.renderDecorationsTimer=-1;const e=this.codeEditorService.listCodeEditors();for(const t of e){const i=bh.get(t);if(!i)continue;const n=[],o=t.getModel()?.uri;if(o&&this.workerRequestValue.has(o)){const r=xi.storedDecorationIDs.get(o),a=this.workerRequestValue.get(o);if(a)for(const c of a)c.range&&n.push({range:c.range,options:gTe(c.kind)});let l=[];t.changeDecorations(c=>{l=c.deltaDecorations(r??[],n)}),xi.storedDecorationIDs=xi.storedDecorationIDs.set(o,l),n.length>0&&(i.wordHighlighter?.decorations.set(n),i.wordHighlighter?._hasWordHighlights.set(!0))}}}dispose(){this._stopSingular(),this.toUnhook.dispose()}};QA=xi=pq([p1(4,ft)],QA);let bh=class extends B{static{XA=this}static{this.ID="editor.contrib.wordHighlighter"}static get(e){return e.getContribution(XA.ID)}constructor(e,t,i,n){super(),this._wordHighlighter=null;const o=()=>{e.hasModel()&&!e.getModel().isTooLargeForTokenization()&&(this._wordHighlighter=new QA(e,i.documentHighlightProvider,i.multiDocumentHighlightProvider,t,n))};this._register(e.onDidChangeModel(r=>{this._wordHighlighter&&(this._wordHighlighter.dispose(),this._wordHighlighter=null),o()})),o()}get wordHighlighter(){return this._wordHighlighter}saveViewState(){return!!(this._wordHighlighter&&this._wordHighlighter.hasDecorations())}moveNext(){this._wordHighlighter?.moveNext()}moveBack(){this._wordHighlighter?.moveBack()}restoreViewState(e){this._wordHighlighter&&e&&this._wordHighlighter.restore()}dispose(){this._wordHighlighter&&(this._wordHighlighter.dispose(),this._wordHighlighter=null),super.dispose()}};bh=XA=pq([p1(1,Ee),p1(2,pe),p1(3,ft)],bh);class bq extends ge{constructor(e,t){super(t),this._isNext=e}run(e,t){const i=bh.get(t);i&&(this._isNext?i.moveNext():i.moveBack())}}class kNe extends bq{constructor(){super(!0,{id:"editor.action.wordHighlight.next",label:p("wordHighlight.next.label","Go to Next Symbol Highlight"),alias:"Go to Next Symbol Highlight",precondition:Z4,kbOpts:{kbExpr:I.editorTextFocus,primary:65,weight:100}})}}class DNe extends bq{constructor(){super(!1,{id:"editor.action.wordHighlight.prev",label:p("wordHighlight.previous.label","Go to Previous Symbol Highlight"),alias:"Go to Previous Symbol Highlight",precondition:Z4,kbOpts:{kbExpr:I.editorTextFocus,primary:1089,weight:100}})}}class INe extends ge{constructor(){super({id:"editor.action.wordHighlight.trigger",label:p("wordHighlight.trigger.label","Trigger Symbol Highlight"),alias:"Trigger Symbol Highlight",precondition:void 0,kbOpts:{kbExpr:I.editorTextFocus,primary:0,weight:100}})}run(e,t,i){const n=bh.get(t);n&&n.restoreViewState(!0)}}ct(bh.ID,bh,0);Q(kNe);Q(DNe);Q(INe);Rm(YA);class uk extends Zi{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode,this._wordNavigationType=e.wordNavigationType}runEditorCommand(e,t,i){if(!t.hasModel())return;const n=yr(t.getOption(132),t.getOption(131)),o=t.getModel(),r=t.getSelections(),a=r.length>1,l=r.map(c=>{const d=new P(c.positionLineNumber,c.positionColumn),h=this._move(n,o,d,this._wordNavigationType,a);return this._moveTo(c,h,this._inSelectionMode)});if(o.pushStackElement(),t._getViewModel().setCursorStates("moveWordCommand",3,l.map(c=>ut.fromModelSelection(c))),l.length===1){const c=new P(l[0].positionLineNumber,l[0].positionColumn);t.revealPosition(c,0)}}_moveTo(e,t,i){return i?new me(e.selectionStartLineNumber,e.selectionStartColumn,t.lineNumber,t.column):new me(t.lineNumber,t.column,t.lineNumber,t.column)}}class Dh extends uk{_move(e,t,i,n,o){return vt.moveWordLeft(e,t,i,n,o)}}class Ih extends uk{_move(e,t,i,n,o){return vt.moveWordRight(e,t,i,n)}}class TNe extends Dh{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartLeft",precondition:void 0})}}class ENe extends Dh{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndLeft",precondition:void 0})}}class NNe extends Dh{constructor(){super({inSelectionMode:!1,wordNavigationType:1,id:"cursorWordLeft",precondition:void 0,kbOpts:{kbExpr:q.and(I.textInputFocus,q.and(TC,fx)?.negate()),primary:2063,mac:{primary:527},weight:100}})}}class RNe extends Dh{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartLeftSelect",precondition:void 0})}}class MNe extends Dh{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndLeftSelect",precondition:void 0})}}class ANe extends Dh{constructor(){super({inSelectionMode:!0,wordNavigationType:1,id:"cursorWordLeftSelect",precondition:void 0,kbOpts:{kbExpr:q.and(I.textInputFocus,q.and(TC,fx)?.negate()),primary:3087,mac:{primary:1551},weight:100}})}}class PNe extends Dh{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityLeft",precondition:void 0})}_move(e,t,i,n,o){return super._move(yr(ja.wordSeparators.defaultValue,e.intlSegmenterLocales),t,i,n,o)}}class ONe extends Dh{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityLeftSelect",precondition:void 0})}_move(e,t,i,n,o){return super._move(yr(ja.wordSeparators.defaultValue,e.intlSegmenterLocales),t,i,n,o)}}class FNe extends Ih{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartRight",precondition:void 0})}}class BNe extends Ih{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndRight",precondition:void 0,kbOpts:{kbExpr:q.and(I.textInputFocus,q.and(TC,fx)?.negate()),primary:2065,mac:{primary:529},weight:100}})}}class WNe extends Ih{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordRight",precondition:void 0})}}class HNe extends Ih{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartRightSelect",precondition:void 0})}}class VNe extends Ih{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndRightSelect",precondition:void 0,kbOpts:{kbExpr:q.and(I.textInputFocus,q.and(TC,fx)?.negate()),primary:3089,mac:{primary:1553},weight:100}})}}class zNe extends Ih{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordRightSelect",precondition:void 0})}}class UNe extends Ih{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityRight",precondition:void 0})}_move(e,t,i,n,o){return super._move(yr(ja.wordSeparators.defaultValue,e.intlSegmenterLocales),t,i,n,o)}}class $Ne extends Ih{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityRightSelect",precondition:void 0})}_move(e,t,i,n,o){return super._move(yr(ja.wordSeparators.defaultValue,e.intlSegmenterLocales),t,i,n,o)}}class gk extends Zi{constructor(e){super(e),this._whitespaceHeuristics=e.whitespaceHeuristics,this._wordNavigationType=e.wordNavigationType}runEditorCommand(e,t,i){const n=e.get(di);if(!t.hasModel())return;const o=yr(t.getOption(132),t.getOption(131)),r=t.getModel(),a=t.getSelections(),l=t.getOption(6),c=t.getOption(11),d=n.getLanguageConfiguration(r.getLanguageId()).getAutoClosingPairs(),h=t._getViewModel(),u=a.map(g=>{const f=this._delete({wordSeparators:o,model:r,selection:g,whitespaceHeuristics:this._whitespaceHeuristics,autoClosingDelete:t.getOption(9),autoClosingBrackets:l,autoClosingQuotes:c,autoClosingPairs:d,autoClosedCharacters:h.getCursorAutoClosedCharacters()},this._wordNavigationType);return new Nn(f,"")});t.pushUndoStop(),t.executeCommands(this.id,u),t.pushUndoStop()}}class K4 extends gk{_delete(e,t){const i=vt.deleteWordLeft(e,t);return i||new k(1,1,1,1)}}class q4 extends gk{_delete(e,t){const i=vt.deleteWordRight(e,t);if(i)return i;const n=e.model.getLineCount(),o=e.model.getLineMaxColumn(n);return new k(n,o,n,o)}}class jNe extends K4{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartLeft",precondition:I.writable})}}class ZNe extends K4{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndLeft",precondition:I.writable})}}class KNe extends K4{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordLeft",precondition:I.writable,kbOpts:{kbExpr:I.textInputFocus,primary:2049,mac:{primary:513},weight:100}})}}class qNe extends q4{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartRight",precondition:I.writable})}}class GNe extends q4{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndRight",precondition:I.writable})}}class YNe extends q4{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordRight",precondition:I.writable,kbOpts:{kbExpr:I.textInputFocus,primary:2068,mac:{primary:532},weight:100}})}}class XNe extends ge{constructor(){super({id:"deleteInsideWord",precondition:I.writable,label:p("deleteInsideWord","Delete Word"),alias:"Delete Word"})}run(e,t,i){if(!t.hasModel())return;const n=yr(t.getOption(132),t.getOption(131)),o=t.getModel(),a=t.getSelections().map(l=>{const c=vt.deleteInsideWord(n,o,l);return new Nn(c,"")});t.pushUndoStop(),t.executeCommands(this.id,a),t.pushUndoStop()}}ae(new TNe);ae(new ENe);ae(new NNe);ae(new RNe);ae(new MNe);ae(new ANe);ae(new FNe);ae(new BNe);ae(new WNe);ae(new HNe);ae(new VNe);ae(new zNe);ae(new PNe);ae(new ONe);ae(new UNe);ae(new $Ne);ae(new jNe);ae(new ZNe);ae(new KNe);ae(new qNe);ae(new GNe);ae(new YNe);Q(XNe);class QNe extends gk{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordPartLeft",precondition:I.writable,kbOpts:{kbExpr:I.textInputFocus,primary:0,mac:{primary:769},weight:100}})}_delete(e,t){const i=Ix.deleteWordPartLeft(e);return i||new k(1,1,1,1)}}class JNe extends gk{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordPartRight",precondition:I.writable,kbOpts:{kbExpr:I.textInputFocus,primary:0,mac:{primary:788},weight:100}})}_delete(e,t){const i=Ix.deleteWordPartRight(e);if(i)return i;const n=e.model.getLineCount(),o=e.model.getLineMaxColumn(n);return new k(n,o,n,o)}}class vq extends uk{_move(e,t,i,n,o){return Ix.moveWordPartLeft(e,t,i,o)}}class eRe extends vq{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordPartLeft",precondition:void 0,kbOpts:{kbExpr:I.textInputFocus,primary:0,mac:{primary:783},weight:100}})}}ot.registerCommandAlias("cursorWordPartStartLeft","cursorWordPartLeft");class tRe extends vq{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordPartLeftSelect",precondition:void 0,kbOpts:{kbExpr:I.textInputFocus,primary:0,mac:{primary:1807},weight:100}})}}ot.registerCommandAlias("cursorWordPartStartLeftSelect","cursorWordPartLeftSelect");class Cq extends uk{_move(e,t,i,n,o){return Ix.moveWordPartRight(e,t,i)}}class iRe extends Cq{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordPartRight",precondition:void 0,kbOpts:{kbExpr:I.textInputFocus,primary:0,mac:{primary:785},weight:100}})}}class nRe extends Cq{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordPartRightSelect",precondition:void 0,kbOpts:{kbExpr:I.textInputFocus,primary:0,mac:{primary:1809},weight:100}})}}ae(new QNe);ae(new JNe);ae(new eRe);ae(new tRe);ae(new iRe);ae(new nRe);class O8 extends B{static{this.ID="editor.contrib.readOnlyMessageController"}constructor(e){super(),this.editor=e,this._register(this.editor.onDidAttemptReadOnlyEdit(()=>this._onDidAttemptReadOnlyEdit()))}_onDidAttemptReadOnlyEdit(){const e=go.get(this.editor);if(e&&this.editor.hasModel()){let t=this.editor.getOptions().get(93);t||(this.editor.isSimpleWidget?t=new zn(p("editor.simple.readonly","Cannot edit in read-only input")):t=new zn(p("editor.readonly","Cannot edit in read-only editor"))),e.showMessage(t,this.editor.getPosition())}}}ct(O8.ID,O8,2);var sRe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},F8=function(s,e){return function(t,i){e(t,i,s)}};let JA=class extends B{constructor(e,t,i){super(),this._textModel=e,this._languageFeaturesService=t,this._outlineModelService=i,this._currentModel=Ze(this,void 0);const n=En("documentSymbolProvider.onDidChange",this._languageFeaturesService.documentSymbolProvider.onDidChange),o=En("_textModel.onDidChangeContent",se.debounce(r=>this._textModel.onDidChangeContent(r),()=>{},100));this._register(Us(async(r,a)=>{n.read(r),o.read(r);const l=a.add(new zve),c=await this._outlineModelService.getOrCreate(this._textModel,l.token);a.isDisposed||this._currentModel.set(c,void 0)}))}getBreadcrumbItems(e,t){const i=this._currentModel.read(t);if(!i)return[];const n=i.asListOfDocumentSymbols().filter(o=>e.contains(o.range.startLineNumber)&&!e.contains(o.range.endLineNumber));return n.sort(KH(bs(o=>o.range.endLineNumber-o.range.startLineNumber,qr))),n.map(o=>({name:o.name,kind:o.kind,startLineNumber:o.range.startLineNumber}))}};JA=sRe([F8(1,pe),F8(2,iy)],JA);bS.setBreadcrumbsSourceFactory((s,e)=>e.createInstance(JA,s));class B8 extends B{static{this.ID="editor.contrib.iPadShowKeyboard"}constructor(e){super(),this.editor=e,this.widget=null,Oa&&(this._register(e.onDidChangeConfiguration(()=>this.update())),this.update())}update(){const e=!this.editor.getOption(92);!this.widget&&e?this.widget=new G4(this.editor):this.widget&&!e&&(this.widget.dispose(),this.widget=null)}dispose(){super.dispose(),this.widget&&(this.widget.dispose(),this.widget=null)}}class G4 extends B{static{this.ID="editor.contrib.ShowKeyboardWidget"}constructor(e){super(),this.editor=e,this._domNode=document.createElement("textarea"),this._domNode.className="iPadShowKeyboard",this._register(U(this._domNode,"touchstart",t=>{this.editor.focus()})),this._register(U(this._domNode,"focus",t=>{this.editor.focus()})),this.editor.addOverlayWidget(this)}dispose(){this.editor.removeOverlayWidget(this),super.dispose()}getId(){return G4.ID}getDomNode(){return this._domNode}getPosition(){return{preference:1}}}ct(B8.ID,B8,3);var oRe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},W8=function(s,e){return function(t,i){e(t,i,s)}},eP;let aC=class extends B{static{eP=this}static{this.ID="editor.contrib.inspectTokens"}static get(e){return e.getContribution(eP.ID)}constructor(e,t,i){super(),this._editor=e,this._languageService=i,this._widget=null,this._register(this._editor.onDidChangeModel(n=>this.stop())),this._register(this._editor.onDidChangeModelLanguage(n=>this.stop())),this._register(mi.onDidChange(n=>this.stop())),this._register(this._editor.onKeyUp(n=>n.keyCode===9&&this.stop()))}dispose(){this.stop(),super.dispose()}launch(){this._widget||this._editor.hasModel()&&(this._widget=new Y4(this._editor,this._languageService))}stop(){this._widget&&(this._widget.dispose(),this._widget=null)}};aC=eP=oRe([W8(1,Qo),W8(2,ni)],aC);class rRe extends ge{constructor(){super({id:"editor.action.inspectTokens",label:iN.inspectTokensAction,alias:"Developer: Inspect Tokens",precondition:void 0})}run(e,t){aC.get(t)?.launch()}}function aRe(s){let e="";for(let t=0,i=s.length;t<i;t++){const n=s.charCodeAt(t);switch(n){case 9:e+="";break;case 32:e+="";break;default:e+=String.fromCharCode(n)}}return e}function lRe(s,e){const t=mi.get(e);if(t)return t;const i=s.encodeLanguageId(e);return{getInitialState:()=>Ap,tokenize:(n,o,r)=>$2(e,r),tokenizeEncoded:(n,o,r)=>ix(i,r)}}class Y4 extends B{static{this._ID="editor.contrib.inspectTokensWidget"}constructor(e,t){super(),this.allowEditorOverflow=!0,this._editor=e,this._languageService=t,this._model=this._editor.getModel(),this._domNode=document.createElement("div"),this._domNode.className="tokens-inspect-widget",this._tokenizationSupport=lRe(this._languageService.languageIdCodec,this._model.getLanguageId()),this._compute(this._editor.getPosition()),this._register(this._editor.onDidChangeCursorPosition(i=>this._compute(this._editor.getPosition()))),this._editor.addContentWidget(this)}dispose(){this._editor.removeContentWidget(this),super.dispose()}getId(){return Y4._ID}_compute(e){const t=this._getTokensAtLine(e.lineNumber);let i=0;for(let l=t.tokens1.length-1;l>=0;l--){const c=t.tokens1[l];if(e.column-1>=c.offset){i=l;break}}let n=0;for(let l=t.tokens2.length>>>1;l>=0;l--)if(e.column-1>=t.tokens2[l<<1]){n=l;break}const o=this._model.getLineContent(e.lineNumber);let r="";if(i<t.tokens1.length){const l=t.tokens1[i].offset,c=i+1<t.tokens1.length?t.tokens1[i+1].offset:o.length;r=o.substring(l,c)}yn(this._domNode,te("h2.tm-token",void 0,aRe(r),te("span.tm-token-length",void 0,`${r.length} ${r.length===1?"char":"chars"}`))),X(this._domNode,te("hr.tokens-inspect-separator",{style:"clear:both"}));const a=(n<<1)+1<t.tokens2.length?this._decodeMetadata(t.tokens2[(n<<1)+1]):null;X(this._domNode,te("table.tm-metadata-table",void 0,te("tbody",void 0,te("tr",void 0,te("td.tm-metadata-key",void 0,"language"),te("td.tm-metadata-value",void 0,`${a?a.languageId:"-?-"}`)),te("tr",void 0,te("td.tm-metadata-key",void 0,"token type"),te("td.tm-metadata-value",void 0,`${a?this._tokenTypeToString(a.tokenType):"-?-"}`)),te("tr",void 0,te("td.tm-metadata-key",void 0,"font style"),te("td.tm-metadata-value",void 0,`${a?this._fontStyleToString(a.fontStyle):"-?-"}`)),te("tr",void 0,te("td.tm-metadata-key",void 0,"foreground"),te("td.tm-metadata-value",void 0,`${a?G.Format.CSS.formatHex(a.foreground):"-?-"}`)),te("tr",void 0,te("td.tm-metadata-key",void 0,"background"),te("td.tm-metadata-value",void 0,`${a?G.Format.CSS.formatHex(a.background):"-?-"}`))))),X(this._domNode,te("hr.tokens-inspect-separator")),i<t.tokens1.length&&X(this._domNode,te("span.tm-token-type",void 0,t.tokens1[i].type)),this._editor.layoutContentWidget(this)}_decodeMetadata(e){const t=mi.getColorMap(),i=Bs.getLanguageId(e),n=Bs.getTokenType(e),o=Bs.getFontStyle(e),r=Bs.getForeground(e),a=Bs.getBackground(e);return{languageId:this._languageService.languageIdCodec.decodeLanguageId(i),tokenType:n,fontStyle:o,foreground:t[r],background:t[a]}}_tokenTypeToString(e){switch(e){case 0:return"Other";case 1:return"Comment";case 2:return"String";case 3:return"RegEx";default:return"??"}}_fontStyleToString(e){let t="";return e&1&&(t+="italic "),e&2&&(t+="bold "),e&4&&(t+="underline "),e&8&&(t+="strikethrough "),t.length===0&&(t="---"),t}_getTokensAtLine(e){const t=this._getStateBeforeLine(e),i=this._tokenizationSupport.tokenize(this._model.getLineContent(e),!0,t),n=this._tokenizationSupport.tokenizeEncoded(this._model.getLineContent(e),!0,t);return{startState:t,tokens1:i.tokens,tokens2:n.tokens,endState:i.endState}}_getStateBeforeLine(e){let t=this._tokenizationSupport.getInitialState();for(let i=1;i<e;i++)t=this._tokenizationSupport.tokenize(this._model.getLineContent(i),!0,t).endState;return t}getDomNode(){return this._domNode}getPosition(){return{position:this._editor.getPosition(),preference:[2,1]}}}ct(aC.ID,aC,4);Q(rRe);var cRe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},H8=function(s,e){return function(t,i){e(t,i,s)}},$_;let tP=class{static{$_=this}static{this.PREFIX="?"}constructor(e,t){this.quickInputService=e,this.keybindingService=t,this.registry=ci.as(Cg.Quickaccess)}provide(e){const t=new Z;return t.add(e.onDidAccept(()=>{const[i]=e.selectedItems;i&&this.quickInputService.quickAccess.show(i.prefix,{preserveValue:!0})})),t.add(e.onDidChangeValue(i=>{const n=this.registry.getQuickAccessProvider(i.substr($_.PREFIX.length));n&&n.prefix&&n.prefix!==$_.PREFIX&&this.quickInputService.quickAccess.show(n.prefix,{preserveValue:!0})})),e.items=this.getQuickAccessProviders().filter(i=>i.prefix!==$_.PREFIX),t}getQuickAccessProviders(){return this.registry.getQuickAccessProviders().sort((t,i)=>t.prefix.localeCompare(i.prefix)).flatMap(t=>this.createPicks(t))}createPicks(e){return e.helpEntries.map(t=>{const i=t.prefix||e.prefix,n=i||"";return{prefix:i,label:n,keybinding:t.commandId?this.keybindingService.lookupKeybinding(t.commandId):void 0,ariaLabel:p("helpPickAriaLabel","{0}, {1}",n,t.description),description:t.description}})}};tP=$_=cRe([H8(0,Dr),H8(1,yt)],tP);ci.as(Cg.Quickaccess).registerQuickAccessProvider({ctor:tP,prefix:"",helpEntries:[{description:nN.helpQuickAccessActionLabel}]});class yq{constructor(e){this.options=e,this.rangeHighlightDecorationId=void 0}provide(e,t,i){const n=new Z;e.canAcceptInBackground=!!this.options?.canAcceptInBackground,e.matchOnLabel=e.matchOnDescription=e.matchOnDetail=e.sortByLabel=!1;const o=n.add(new nn);return o.value=this.doProvide(e,t,i),n.add(this.onDidActiveTextEditorControlChange(()=>{o.value=void 0,o.value=this.doProvide(e,t)})),n}doProvide(e,t,i){const n=new Z,o=this.activeTextEditorControl;if(o&&this.canProvideWithTextEditor(o)){const r={editor:o},a=wj(o);if(a){let l=o.saveViewState()??void 0;n.add(a.onDidChangeCursorPosition(()=>{l=o.saveViewState()??void 0})),r.restoreViewState=()=>{l&&o===this.activeTextEditorControl&&o.restoreViewState(l)},n.add(eh(t.onCancellationRequested)(()=>r.restoreViewState?.()))}n.add(Ce(()=>this.clearDecorations(o))),n.add(this.provideWithTextEditor(r,e,t,i))}else n.add(this.provideWithoutTextEditor(e,t));return n}canProvideWithTextEditor(e){return!0}gotoLocation({editor:e},t){e.setSelection(t.range,"code.jump"),e.revealRangeInCenter(t.range,0),t.preserveFocus||e.focus();const i=e.getModel();i&&"getLineContent"in i&&Nl(`${i.getLineContent(t.range.startLineNumber)}`)}getModel(e){return TF(e)?e.getModel()?.modified:e.getModel()}addDecorations(e,t){e.changeDecorations(i=>{const n=[];this.rangeHighlightDecorationId&&(n.push(this.rangeHighlightDecorationId.overviewRulerDecorationId),n.push(this.rangeHighlightDecorationId.rangeHighlightId),this.rangeHighlightDecorationId=void 0);const o=[{range:t,options:{description:"quick-access-range-highlight",className:"rangeHighlight",isWholeLine:!0}},{range:t,options:{description:"quick-access-range-highlight-overview",overviewRuler:{color:_i(gU),position:Ho.Full}}}],[r,a]=i.deltaDecorations(n,o);this.rangeHighlightDecorationId={rangeHighlightId:r,overviewRulerDecorationId:a}})}clearDecorations(e){const t=this.rangeHighlightDecorationId;t&&(e.changeDecorations(i=>{i.deltaDecorations([t.overviewRulerDecorationId,t.rangeHighlightId],[])}),this.rangeHighlightDecorationId=void 0)}}class X4 extends yq{static{this.PREFIX=":"}constructor(){super({canAcceptInBackground:!0})}provideWithoutTextEditor(e){const t=p("cannotRunGotoLine","Open a text editor first to go to a line.");return e.items=[{label:t}],e.ariaLabel=t,B.None}provideWithTextEditor(e,t,i){const n=e.editor,o=new Z;o.add(t.onDidAccept(l=>{const[c]=t.selectedItems;if(c){if(!this.isValidLineNumber(n,c.lineNumber))return;this.gotoLocation(e,{range:this.toRange(c.lineNumber,c.column),keyMods:t.keyMods,preserveFocus:l.inBackground}),l.inBackground||t.hide()}}));const r=()=>{const l=this.parsePosition(n,t.value.trim().substr(X4.PREFIX.length)),c=this.getPickLabel(n,l.lineNumber,l.column);if(t.items=[{lineNumber:l.lineNumber,column:l.column,label:c}],t.ariaLabel=c,!this.isValidLineNumber(n,l.lineNumber)){this.clearDecorations(n);return}const d=this.toRange(l.lineNumber,l.column);n.revealRangeInCenter(d,0),this.addDecorations(n,d)};r(),o.add(t.onDidChangeValue(()=>r()));const a=wj(n);return a&&a.getOptions().get(68).renderType===2&&(a.updateOptions({lineNumbers:"on"}),o.add(Ce(()=>a.updateOptions({lineNumbers:"relative"})))),o}toRange(e=1,t=1){return{startLineNumber:e,startColumn:t,endLineNumber:e,endColumn:t}}parsePosition(e,t){const i=t.split(/,|:|#/).map(o=>parseInt(o,10)).filter(o=>!isNaN(o)),n=this.lineCount(e)+1;return{lineNumber:i[0]>0?i[0]:n+i[0],column:i[1]}}getPickLabel(e,t,i){if(this.isValidLineNumber(e,t))return this.isValidColumn(e,t,i)?p("gotoLineColumnLabel","Go to line {0} and character {1}.",t,i):p("gotoLineLabel","Go to line {0}.",t);const n=e.getPosition()||{lineNumber:1,column:1},o=this.lineCount(e);return o>1?p("gotoLineLabelEmptyWithLimit","Current Line: {0}, Character: {1}. Type a line number between 1 and {2} to navigate to.",n.lineNumber,n.column,o):p("gotoLineLabelEmpty","Current Line: {0}, Character: {1}. Type a line number to navigate to.",n.lineNumber,n.column)}isValidLineNumber(e,t){return!t||typeof t!="number"?!1:t>0&&t<=this.lineCount(e)}isValidColumn(e,t,i){if(!i||typeof i!="number")return!1;const n=this.getModel(e);if(!n)return!1;const o={lineNumber:t,column:i};return n.validatePosition(o).equals(o)}lineCount(e){return this.getModel(e)?.getLineCount()??0}}var dRe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},hRe=function(s,e){return function(t,i){e(t,i,s)}};let lC=class extends X4{constructor(e){super(),this.editorService=e,this.onDidActiveTextEditorControlChange=se.None}get activeTextEditorControl(){return this.editorService.getFocusedCodeEditor()??void 0}};lC=dRe([hRe(0,ft)],lC);let wq=class Sq extends ge{static{this.ID="editor.action.gotoLine"}constructor(){super({id:Sq.ID,label:m0.gotoLineActionLabel,alias:"Go to Line/Column...",precondition:void 0,kbOpts:{kbExpr:I.focus,primary:2085,mac:{primary:293},weight:100}})}run(e){e.get(Dr).quickAccess.show(lC.PREFIX)}};Q(wq);ci.as(Cg.Quickaccess).registerQuickAccessProvider({ctor:lC,prefix:lC.PREFIX,helpEntries:[{description:m0.gotoLineActionLabel,commandId:wq.ID}]});const Lq=[void 0,[]];function NI(s,e,t=0,i=0){const n=e;return n.values&&n.values.length>1?uRe(s,n.values,t,i):xq(s,e,t,i)}function uRe(s,e,t,i){let n=0;const o=[];for(const r of e){const[a,l]=xq(s,r,t,i);if(typeof a!="number")return Lq;n+=a,o.push(...l)}return[n,gRe(o)]}function xq(s,e,t,i){const n=Yu(e.original,e.originalLowercase,t,s,s.toLowerCase(),i,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return n?[n[0],IC(n)]:Lq}function gRe(s){const e=s.sort((n,o)=>n.start-o.start),t=[];let i;for(const n of e)!i||!fRe(i,n)?(i=n,t.push(n)):(i.start=Math.min(i.start,n.start),i.end=Math.max(i.end,n.end));return t}function fRe(s,e){return!(s.end<e.start||e.end<s.start)}function V8(s){return s.startsWith('"')&&s.endsWith('"')}const kq=" ";function iP(s){typeof s!="string"&&(s="");const e=s.toLowerCase(),{pathNormalized:t,normalized:i,normalizedLowercase:n}=z8(s),o=t.indexOf(Ta)>=0,r=V8(s);let a;const l=s.split(kq);if(l.length>1)for(const c of l){const d=V8(c),{pathNormalized:h,normalized:u,normalizedLowercase:g}=z8(c);u&&(a||(a=[]),a.push({original:c,originalLowercase:c.toLowerCase(),pathNormalized:h,normalized:u,normalizedLowercase:g,expectContiguousMatch:d}))}return{original:s,originalLowercase:e,pathNormalized:t,normalized:i,normalizedLowercase:n,values:a,containsPathSeparator:o,expectContiguousMatch:r}}function z8(s){let e;An?e=s.replace(/\//g,Ta):e=s.replace(/\\/g,Ta);const t=bee(e).replace(/\s|"/g,"");return{pathNormalized:e,normalized:t,normalizedLowercase:t.toLowerCase()}}function U8(s){return Array.isArray(s)?iP(s.map(e=>e.original).join(kq)):iP(s.original)}var pRe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},$8=function(s,e){return function(t,i){e(t,i,s)}},m1;let Hu=class extends yq{static{m1=this}static{this.PREFIX="@"}static{this.SCOPE_PREFIX=":"}static{this.PREFIX_BY_CATEGORY=`${this.PREFIX}${this.SCOPE_PREFIX}`}constructor(e,t,i=Object.create(null)){super(i),this._languageFeaturesService=e,this._outlineModelService=t,this.options=i,this.options.canAcceptInBackground=!0}provideWithoutTextEditor(e){return this.provideLabelPick(e,p("cannotRunGotoSymbolWithoutEditor","To go to a symbol, first open a text editor with symbol information.")),B.None}provideWithTextEditor(e,t,i,n){const o=e.editor,r=this.getModel(o);return r?this._languageFeaturesService.documentSymbolProvider.has(r)?this.doProvideWithEditorSymbols(e,r,t,i,n):this.doProvideWithoutEditorSymbols(e,r,t,i):B.None}doProvideWithoutEditorSymbols(e,t,i,n){const o=new Z;return this.provideLabelPick(i,p("cannotRunGotoSymbolWithoutSymbolProvider","The active text editor does not provide symbol information.")),(async()=>!await this.waitForLanguageSymbolRegistry(t,o)||n.isCancellationRequested||o.add(this.doProvideWithEditorSymbols(e,t,i,n)))(),o}provideLabelPick(e,t){e.items=[{label:t,index:0,kind:14}],e.ariaLabel=t}async waitForLanguageSymbolRegistry(e,t){if(this._languageFeaturesService.documentSymbolProvider.has(e))return!0;const i=new pm,n=t.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(()=>{this._languageFeaturesService.documentSymbolProvider.has(e)&&(n.dispose(),i.complete(!0))}));return t.add(Ce(()=>i.complete(!1))),i.p}doProvideWithEditorSymbols(e,t,i,n,o){const r=e.editor,a=new Z;a.add(i.onDidAccept(h=>{const[u]=i.selectedItems;u&&u.range&&(this.gotoLocation(e,{range:u.range.selection,keyMods:i.keyMods,preserveFocus:h.inBackground}),o?.handleAccept?.(u),h.inBackground||i.hide())})),a.add(i.onDidTriggerItemButton(({item:h})=>{h&&h.range&&(this.gotoLocation(e,{range:h.range.selection,keyMods:i.keyMods,forceSideBySide:!0}),i.hide())}));const l=this.getDocumentSymbols(t,n);let c;const d=async h=>{c?.dispose(!0),i.busy=!1,c=new li(n),i.busy=!0;try{const u=iP(i.value.substr(m1.PREFIX.length).trim()),g=await this.doGetSymbolPicks(l,u,void 0,c.token,t);if(n.isCancellationRequested)return;if(g.length>0){if(i.items=g,h&&u.original.length===0){const f=Xb(g,m=>!!(m.type!=="separator"&&m.range&&k.containsPosition(m.range.decoration,h)));f&&(i.activeItems=[f])}}else u.original.length>0?this.provideLabelPick(i,p("noMatchingSymbolResults","No matching editor symbols")):this.provideLabelPick(i,p("noSymbolResults","No editor symbols"))}finally{n.isCancellationRequested||(i.busy=!1)}};return a.add(i.onDidChangeValue(()=>d(void 0))),d(r.getSelection()?.getPosition()),a.add(i.onDidChangeActive(()=>{const[h]=i.activeItems;h&&h.range&&(r.revealRangeInCenter(h.range.selection,0),this.addDecorations(r,h.range.decoration))})),a}async doGetSymbolPicks(e,t,i,n,o){const r=await e;if(n.isCancellationRequested)return[];const a=t.original.indexOf(m1.SCOPE_PREFIX)===0,l=a?1:0;let c,d;t.values&&t.values.length>1?(c=U8(t.values[0]),d=U8(t.values.slice(1))):c=t;let h;const u=this.options?.openSideBySideDirection?.();u&&(h=[{iconClass:u==="right"?Ie.asClassName(J.splitHorizontal):Ie.asClassName(J.splitVertical),tooltip:u==="right"?p("openToSide","Open to the Side"):p("openToBottom","Open to the Bottom")}]);const g=[];for(let _=0;_<r.length;_++){const b=r[_],v=mee(b.name),C=`$(${M1.toIcon(b.kind).id}) ${v}`,y=C.length-v.length;let w=b.containerName;i?.extraContainerLabel&&(w?w=`${i.extraContainerLabel}  ${w}`:w=i.extraContainerLabel);let x,L,D,T;if(t.original.length>l){let W=!1;if(c!==t&&([x,L]=NI(C,{...t,values:void 0},l,y),typeof x=="number"&&(W=!0)),typeof x!="number"&&([x,L]=NI(C,c,l,y),typeof x!="number"))continue;if(!W&&d){if(w&&d.original.length>0&&([D,T]=NI(w,d)),typeof D!="number")continue;typeof x=="number"&&(x+=D)}}const F=b.tags&&b.tags.indexOf(1)>=0;g.push({index:_,kind:b.kind,score:x,label:C,ariaLabel:cee(b.name,b.kind),description:w,highlights:F?void 0:{label:L,description:T},range:{selection:k.collapseToStart(b.selectionRange),decoration:b.range},uri:o.uri,symbolName:v,strikethrough:F,buttons:h})}const f=g.sort((_,b)=>a?this.compareByKindAndScore(_,b):this.compareByScore(_,b));let m=[];if(a){let C=function(){b&&typeof _=="number"&&v>0&&(b.label=zu(MI[_]||RI,v))},_,b,v=0;for(const y of f)_!==y.kind?(C(),_=y.kind,v=1,b={type:"separator"},m.push(b)):v++,m.push(y);C()}else f.length>0&&(m=[{label:p("symbols","symbols ({0})",g.length),type:"separator"},...f]);return m}compareByScore(e,t){if(typeof e.score!="number"&&typeof t.score=="number")return 1;if(typeof e.score=="number"&&typeof t.score!="number")return-1;if(typeof e.score=="number"&&typeof t.score=="number"){if(e.score>t.score)return-1;if(e.score<t.score)return 1}return e.index<t.index?-1:e.index>t.index?1:0}compareByKindAndScore(e,t){const i=MI[e.kind]||RI,n=MI[t.kind]||RI,o=i.localeCompare(n);return o===0?this.compareByScore(e,t):o}async getDocumentSymbols(e,t){const i=await this._outlineModelService.getOrCreate(e,t);return t.isCancellationRequested?[]:i.asListOfDocumentSymbols()}};Hu=m1=pRe([$8(0,pe),$8(1,iy)],Hu);const RI=p("property","properties ({0})"),MI={5:p("method","methods ({0})"),11:p("function","functions ({0})"),8:p("_constructor","constructors ({0})"),12:p("variable","variables ({0})"),4:p("class","classes ({0})"),22:p("struct","structs ({0})"),23:p("event","events ({0})"),24:p("operator","operators ({0})"),10:p("interface","interfaces ({0})"),2:p("namespace","namespaces ({0})"),3:p("package","packages ({0})"),25:p("typeParameter","type parameters ({0})"),1:p("modules","modules ({0})"),6:p("property","properties ({0})"),9:p("enum","enumerations ({0})"),21:p("enumMember","enumeration members ({0})"),14:p("string","strings ({0})"),0:p("file","files ({0})"),17:p("array","arrays ({0})"),15:p("number","numbers ({0})"),16:p("boolean","booleans ({0})"),18:p("object","objects ({0})"),19:p("key","keys ({0})"),7:p("field","fields ({0})"),13:p("constant","constants ({0})")};var mRe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},AI=function(s,e){return function(t,i){e(t,i,s)}};let nP=class extends Hu{constructor(e,t,i){super(t,i),this.editorService=e,this.onDidActiveTextEditorControlChange=se.None}get activeTextEditorControl(){return this.editorService.getFocusedCodeEditor()??void 0}};nP=mRe([AI(0,ft),AI(1,pe),AI(2,iy)],nP);class fk extends ge{static{this.ID="editor.action.quickOutline"}constructor(){super({id:fk.ID,label:uv.quickOutlineActionLabel,alias:"Go to Symbol...",precondition:I.hasDocumentSymbolProvider,kbOpts:{kbExpr:I.focus,primary:3117,weight:100},contextMenuOpts:{group:"navigation",order:3}})}run(e){e.get(Dr).quickAccess.show(Hu.PREFIX,{itemActivation:Ca.NONE})}}Q(fk);ci.as(Cg.Quickaccess).registerQuickAccessProvider({ctor:nP,prefix:Hu.PREFIX,helpEntries:[{description:uv.quickOutlineActionLabel,prefix:Hu.PREFIX,commandId:fk.ID},{description:uv.quickOutlineByCategoryActionLabel,prefix:Hu.PREFIX_BY_CATEGORY}]});function _Re(s){const e=new Map;for(const t of s)e.set(t,(e.get(t)??0)+1);return e}class Nb{constructor(){this.chunkCount=0,this.chunkOccurrences=new Map,this.documents=new Map}calculateScores(e,t){const i=this.computeEmbedding(e),n=new Map,o=[];for(const[r,a]of this.documents){if(t.isCancellationRequested)return[];for(const l of a.chunks){const c=this.computeSimilarityScore(l,i,n);c>0&&o.push({key:r,score:c})}}return o}static termFrequencies(e){return _Re(Nb.splitTerms(e))}static*splitTerms(e){const t=i=>i.toLowerCase();for(const[i]of e.matchAll(/\b\p{Letter}[\p{Letter}\d]{2,}\b/gu)){yield t(i);const n=i.replace(/([a-z])([A-Z])/g,"$1 $2").split(/\s+/g);if(n.length>1)for(const o of n)o.length>2&&/\p{Letter}{3,}/gu.test(o)&&(yield t(o))}}updateDocuments(e){for(const{key:t}of e)this.deleteDocument(t);for(const t of e){const i=[];for(const n of t.textChunks){const o=Nb.termFrequencies(n);for(const r of o.keys())this.chunkOccurrences.set(r,(this.chunkOccurrences.get(r)??0)+1);i.push({text:n,tf:o})}this.chunkCount+=i.length,this.documents.set(t.key,{chunks:i})}return this}deleteDocument(e){const t=this.documents.get(e);if(t){this.documents.delete(e),this.chunkCount-=t.chunks.length;for(const i of t.chunks)for(const n of i.tf.keys()){const o=this.chunkOccurrences.get(n);if(typeof o=="number"){const r=o-1;r<=0?this.chunkOccurrences.delete(n):this.chunkOccurrences.set(n,r)}}}}computeSimilarityScore(e,t,i){let n=0;for(const[o,r]of Object.entries(t)){const a=e.tf.get(o);if(!a)continue;let l=i.get(o);typeof l!="number"&&(l=this.computeIdf(o),i.set(o,l));const c=a*l;n+=c*r}return n}computeEmbedding(e){const t=Nb.termFrequencies(e);return this.computeTfidf(t)}computeIdf(e){const t=this.chunkOccurrences.get(e)??0;return t>0?Math.log((this.chunkCount+1)/t):0}computeTfidf(e){const t=Object.create(null);for(const[i,n]of e){const o=this.computeIdf(i);o>0&&(t[i]=n*o)}return t}}function bRe(s){const e=s.slice(0);e.sort((i,n)=>n.score-i.score);const t=e[0]?.score??0;if(t>0)for(const i of e)i.score/=t;return e}var Uf;(function(s){s[s.NO_ACTION=0]="NO_ACTION",s[s.CLOSE_PICKER=1]="CLOSE_PICKER",s[s.REFRESH_PICKER=2]="REFRESH_PICKER",s[s.REMOVE_ITEM=3]="REMOVE_ITEM"})(Uf||(Uf={}));function PI(s){const e=s;return Array.isArray(e.items)}function j8(s){const e=s;return!!e.picks&&e.additionalPicks instanceof Promise}class vRe extends B{constructor(e,t){super(),this.prefix=e,this.options=t}provide(e,t,i){const n=new Z;e.canAcceptInBackground=!!this.options?.canAcceptInBackground,e.matchOnLabel=e.matchOnDescription=e.matchOnDetail=e.sortByLabel=!1;let o;const r=n.add(new nn),a=async()=>{const c=r.value=new Z;o?.dispose(!0),e.busy=!1,o=new li(t);const d=o.token;let h=e.value.substring(this.prefix.length);this.options?.shouldSkipTrimPickFilter||(h=h.trim());const u=this._getPicks(h,c,d,i),g=(m,_)=>{let b,v;if(PI(m)?(b=m.items,v=m.active):b=m,b.length===0){if(_)return!1;(h.length>0||e.hideInput)&&this.options?.noResultsPick&&(Hb(this.options.noResultsPick)?b=[this.options.noResultsPick(h)]:b=[this.options.noResultsPick])}return e.items=b,v&&(e.activeItems=[v]),!0},f=async m=>{let _=!1,b=!1;await Promise.all([(async()=>{typeof m.mergeDelay=="number"&&(await Wc(m.mergeDelay),d.isCancellationRequested)||b||(_=g(m.picks,!0))})(),(async()=>{e.busy=!0;try{const v=await m.additionalPicks;if(d.isCancellationRequested)return;let C,y;PI(m.picks)?(C=m.picks.items,y=m.picks.active):C=m.picks;let w,x;if(PI(v)?(w=v.items,x=v.active):w=v,w.length>0||!_){let L;if(!y&&!x){const D=e.activeItems[0];D&&C.indexOf(D)!==-1&&(L=D)}g({items:[...C,...w],active:y||x||L})}}finally{d.isCancellationRequested||(e.busy=!1),b=!0}})()])};if(u!==null)if(j8(u))await f(u);else if(!(u instanceof Promise))g(u);else{e.busy=!0;try{const m=await u;if(d.isCancellationRequested)return;j8(m)?await f(m):g(m)}finally{d.isCancellationRequested||(e.busy=!1)}}};n.add(e.onDidChangeValue(()=>a())),a(),n.add(e.onDidAccept(c=>{if(i?.handleAccept){c.inBackground||e.hide(),i.handleAccept?.(e.activeItems[0]);return}const[d]=e.selectedItems;typeof d?.accept=="function"&&(c.inBackground||e.hide(),d.accept(e.keyMods,c))}));const l=async(c,d)=>{if(typeof d.trigger!="function")return;const h=d.buttons?.indexOf(c)??-1;if(h>=0){const u=d.trigger(h,e.keyMods),g=typeof u=="number"?u:await u;if(t.isCancellationRequested)return;switch(g){case Uf.NO_ACTION:break;case Uf.CLOSE_PICKER:e.hide();break;case Uf.REFRESH_PICKER:a();break;case Uf.REMOVE_ITEM:{const f=e.items.indexOf(d);if(f!==-1){const m=e.items.slice(),_=m.splice(f,1),b=e.activeItems.filter(C=>C!==_[0]),v=e.keepScrollPosition;e.keepScrollPosition=!0,e.items=m,b&&(e.activeItems=b),e.keepScrollPosition=v}break}}}};return n.add(e.onDidTriggerItemButton(({button:c,item:d})=>l(c,d))),n.add(e.onDidTriggerSeparatorButton(({button:c,separator:d})=>l(c,d))),n}}var Dq=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Dd=function(s,e){return function(t,i){e(t,i,s)}},eu,Vi;let sP=class extends vRe{static{eu=this}static{this.PREFIX=">"}static{this.TFIDF_THRESHOLD=.5}static{this.TFIDF_MAX_RESULTS=5}static{this.WORD_FILTER=A2(cv,Nae,kz)}constructor(e,t,i,n,o,r){super(eu.PREFIX,e),this.instantiationService=t,this.keybindingService=i,this.commandService=n,this.telemetryService=o,this.dialogService=r,this.commandsHistory=this._register(this.instantiationService.createInstance(oP)),this.options=e}async _getPicks(e,t,i,n){const o=await this.getCommandPicks(i);if(i.isCancellationRequested)return[];const r=eh(()=>{const g=new Nb;g.updateDocuments(o.map(m=>({key:m.commandId,textChunks:[this.getTfIdfChunk(m)]})));const f=g.calculateScores(e,i);return bRe(f).filter(m=>m.score>eu.TFIDF_THRESHOLD).slice(0,eu.TFIDF_MAX_RESULTS)}),a=[];for(const g of o){const f=eu.WORD_FILTER(e,g.label)??void 0,m=g.commandAlias?eu.WORD_FILTER(e,g.commandAlias)??void 0:void 0;if(f||m)g.highlights={label:f,detail:this.options.showAlias?m:void 0},a.push(g);else if(e===g.commandId)a.push(g);else if(e.length>=3){const _=r();if(i.isCancellationRequested)return[];const b=_.find(v=>v.key===g.commandId);b&&(g.tfIdfScore=b.score,a.push(g))}}const l=new Map;for(const g of a){const f=l.get(g.label);f?(g.description=g.commandId,f.description=f.commandId):l.set(g.label,g)}a.sort((g,f)=>{if(g.tfIdfScore&&f.tfIdfScore)return g.tfIdfScore===f.tfIdfScore?g.label.localeCompare(f.label):f.tfIdfScore-g.tfIdfScore;if(g.tfIdfScore)return 1;if(f.tfIdfScore)return-1;const m=this.commandsHistory.peek(g.commandId),_=this.commandsHistory.peek(f.commandId);if(m&&_)return m>_?-1:1;if(m)return-1;if(_)return 1;if(this.options.suggestedCommandIds){const b=this.options.suggestedCommandIds.has(g.commandId),v=this.options.suggestedCommandIds.has(f.commandId);if(b&&v)return 0;if(b)return-1;if(v)return 1}return g.label.localeCompare(f.label)});const c=[];let d=!1,h=!0,u=!!this.options.suggestedCommandIds;for(let g=0;g<a.length;g++){const f=a[g];g===0&&this.commandsHistory.peek(f.commandId)&&(c.push({type:"separator",label:p("recentlyUsed","recently used")}),d=!0),h&&f.tfIdfScore!==void 0&&(c.push({type:"separator",label:p("suggested","similar commands")}),h=!1),u&&f.tfIdfScore===void 0&&!this.commandsHistory.peek(f.commandId)&&this.options.suggestedCommandIds?.has(f.commandId)&&(c.push({type:"separator",label:p("commonlyUsed","commonly used")}),d=!0,u=!1),d&&f.tfIdfScore===void 0&&!this.commandsHistory.peek(f.commandId)&&!this.options.suggestedCommandIds?.has(f.commandId)&&(c.push({type:"separator",label:p("morecCommands","other commands")}),d=!1),c.push(this.toCommandPick(f,n))}return this.hasAdditionalCommandPicks(e,i)?{picks:c,additionalPicks:(async()=>{const g=await this.getAdditionalCommandPicks(o,a,e,i);if(i.isCancellationRequested)return[];const f=g.map(m=>this.toCommandPick(m,n));return h&&f[0]?.type!=="separator"&&f.unshift({type:"separator",label:p("suggested","similar commands")}),f})()}:c}toCommandPick(e,t){if(e.type==="separator")return e;const i=this.keybindingService.lookupKeybinding(e.commandId),n=i?p("commandPickAriaLabelWithKeybinding","{0}, {1}",e.label,i.getAriaLabel()):e.label;return{...e,ariaLabel:n,detail:this.options.showAlias&&e.commandAlias!==e.label?e.commandAlias:void 0,keybinding:i,accept:async()=>{this.commandsHistory.push(e.commandId),this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.commandId,from:t?.from??"quick open"});try{e.args?.length?await this.commandService.executeCommand(e.commandId,...e.args):await this.commandService.executeCommand(e.commandId)}catch(o){xr(o)||this.dialogService.error(p("canNotRun","Command '{0}' resulted in an error",e.label),kS(o))}}}}getTfIdfChunk({label:e,commandAlias:t,commandDescription:i}){let n=e;return t&&t!==e&&(n+=` - ${t}`),i&&i.value!==e&&(n+=` - ${i.value===i.original?i.value:`${i.value} (${i.original})`}`),n}};sP=eu=Dq([Dd(1,ye),Dd(2,yt),Dd(3,Ht),Dd(4,jn),Dd(5,xC)],sP);let oP=class extends B{static{Vi=this}static{this.DEFAULT_COMMANDS_HISTORY_LENGTH=50}static{this.PREF_KEY_CACHE="commandPalette.mru.cache"}static{this.PREF_KEY_COUNTER="commandPalette.mru.counter"}static{this.counter=1}static{this.hasChanges=!1}constructor(e,t,i){super(),this.storageService=e,this.configurationService=t,this.logService=i,this.configuredCommandsHistoryLength=0,this.updateConfiguration(),this.load(),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>this.updateConfiguration(e))),this._register(this.storageService.onWillSaveState(e=>{e.reason===mv.SHUTDOWN&&this.saveState()}))}updateConfiguration(e){e&&!e.affectsConfiguration("workbench.commandPalette.history")||(this.configuredCommandsHistoryLength=Vi.getConfiguredCommandHistoryLength(this.configurationService),Vi.cache&&Vi.cache.limit!==this.configuredCommandsHistoryLength&&(Vi.cache.limit=this.configuredCommandsHistoryLength,Vi.hasChanges=!0))}load(){const e=this.storageService.get(Vi.PREF_KEY_CACHE,0);let t;if(e)try{t=JSON.parse(e)}catch(n){this.logService.error(`[CommandsHistory] invalid data: ${n}`)}const i=Vi.cache=new Wl(this.configuredCommandsHistoryLength,1);if(t){let n;t.usesLRU?n=t.entries:n=t.entries.sort((o,r)=>o.value-r.value),n.forEach(o=>i.set(o.key,o.value))}Vi.counter=this.storageService.getNumber(Vi.PREF_KEY_COUNTER,0,Vi.counter)}push(e){Vi.cache&&(Vi.cache.set(e,Vi.counter++),Vi.hasChanges=!0)}peek(e){return Vi.cache?.peek(e)}saveState(){if(!Vi.cache||!Vi.hasChanges)return;const e={usesLRU:!0,entries:[]};Vi.cache.forEach((t,i)=>e.entries.push({key:i,value:t})),this.storageService.store(Vi.PREF_KEY_CACHE,JSON.stringify(e),0,0),this.storageService.store(Vi.PREF_KEY_COUNTER,Vi.counter,0,0),Vi.hasChanges=!1}static getConfiguredCommandHistoryLength(e){const i=e.getValue().workbench?.commandPalette?.history;return typeof i=="number"?i:Vi.DEFAULT_COMMANDS_HISTORY_LENGTH}};oP=Vi=Dq([Dd(0,oa),Dd(1,Ke),Dd(2,Pn)],oP);class CRe extends sP{constructor(e,t,i,n,o,r){super(e,t,i,n,o,r)}getCodeEditorCommandPicks(){const e=this.activeTextEditorControl;if(!e)return[];const t=[];for(const i of e.getSupportedActions()){let n;i.metadata?.description&&(Tde(i.metadata.description)?n=i.metadata.description:n={original:i.metadata.description,value:i.metadata.description}),t.push({commandId:i.id,commandAlias:i.alias,commandDescription:n,label:V2(i.label)||i.id})}return t}}var yRe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},rf=function(s,e){return function(t,i){e(t,i,s)}};let cC=class extends CRe{get activeTextEditorControl(){return this.codeEditorService.getFocusedCodeEditor()??void 0}constructor(e,t,i,n,o,r){super({showAlias:!1},e,i,n,o,r),this.codeEditorService=t}async getCommandPicks(){return this.getCodeEditorCommandPicks()}hasAdditionalCommandPicks(){return!1}async getAdditionalCommandPicks(){return[]}};cC=yRe([rf(0,ye),rf(1,ft),rf(2,yt),rf(3,Ht),rf(4,jn),rf(5,xC)],cC);class pk extends ge{static{this.ID="editor.action.quickCommand"}constructor(){super({id:pk.ID,label:_0.quickCommandActionLabel,alias:"Command Palette",precondition:void 0,kbOpts:{kbExpr:I.focus,primary:59,weight:100},contextMenuOpts:{group:"z_commands",order:1}})}run(e){e.get(Dr).quickAccess.show(cC.PREFIX)}}Q(pk);ci.as(Cg.Quickaccess).registerQuickAccessProvider({ctor:cC,prefix:cC.PREFIX,helpEntries:[{description:_0.quickCommandHelp,commandId:pk.ID}]});var wRe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},af=function(s,e){return function(t,i){e(t,i,s)}};let rP=class extends cg{constructor(e,t,i,n,o,r,a){super(!0,e,t,i,n,o,r,a)}};rP=wRe([af(1,Ee),af(2,ft),af(3,Ii),af(4,ye),af(5,oa),af(6,Ke)],rP);ct(cg.ID,rP,4);class SRe extends ge{constructor(){super({id:"editor.action.toggleHighContrast",label:oN.toggleHighContrast,alias:"Toggle High Contrast Theme",precondition:void 0}),this._originalThemeName=null}run(e,t){const i=e.get(Qo),n=i.getColorTheme();Ra(n.type)?(i.setTheme(this._originalThemeName||(Dp(n.type)?op:_c)),this._originalThemeName=null):(i.setTheme(Dp(n.type)?Ru:Mu),this._originalThemeName=n.themeName)}}Q(SRe);var Iq={exports:{}},Tq={exports:{}},LRe=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")},xRe=LRe,kRe=Array.prototype.concat,DRe=Array.prototype.slice,Z8=Tq.exports=function(e){for(var t=[],i=0,n=e.length;i<n;i++){var o=e[i];xRe(o)?t=kRe.call(t,DRe.call(o)):t.push(o)}return t};Z8.wrap=function(s){return function(){return s(Z8(arguments))}};var IRe=Tq.exports,Rb=sG,ay=IRe,Eq=Object.hasOwnProperty,Nq=Object.create(null);for(var OI in Rb)Eq.call(Rb,OI)&&(Nq[Rb[OI]]=OI);var pr=Iq.exports={to:{},get:{}};pr.get=function(s){var e=s.substring(0,3).toLowerCase(),t,i;switch(e){case"hsl":t=pr.get.hsl(s),i="hsl";break;case"hwb":t=pr.get.hwb(s),i="hwb";break;default:t=pr.get.rgb(s),i="rgb";break}return t?{model:i,value:t}:null};pr.get.rgb=function(s){if(!s)return null;var e=/^#([a-f0-9]{3,4})$/i,t=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,i=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,n=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,o=/^(\w+)$/,r=[0,0,0,1],a,l,c;if(a=s.match(t)){for(c=a[2],a=a[1],l=0;l<3;l++){var d=l*2;r[l]=parseInt(a.slice(d,d+2),16)}c&&(r[3]=parseInt(c,16)/255)}else if(a=s.match(e)){for(a=a[1],c=a[3],l=0;l<3;l++)r[l]=parseInt(a[l]+a[l],16);c&&(r[3]=parseInt(c+c,16)/255)}else if(a=s.match(i)){for(l=0;l<3;l++)r[l]=parseInt(a[l+1],0);a[4]&&(a[5]?r[3]=parseFloat(a[4])*.01:r[3]=parseFloat(a[4]))}else if(a=s.match(n)){for(l=0;l<3;l++)r[l]=Math.round(parseFloat(a[l+1])*2.55);a[4]&&(a[5]?r[3]=parseFloat(a[4])*.01:r[3]=parseFloat(a[4]))}else return(a=s.match(o))?a[1]==="transparent"?[0,0,0,0]:Eq.call(Rb,a[1])?(r=Rb[a[1]],r[3]=1,r):null:null;for(l=0;l<3;l++)r[l]=Qd(r[l],0,255);return r[3]=Qd(r[3],0,1),r};pr.get.hsl=function(s){if(!s)return null;var e=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,t=s.match(e);if(t){var i=parseFloat(t[4]),n=(parseFloat(t[1])%360+360)%360,o=Qd(parseFloat(t[2]),0,100),r=Qd(parseFloat(t[3]),0,100),a=Qd(isNaN(i)?1:i,0,1);return[n,o,r,a]}return null};pr.get.hwb=function(s){if(!s)return null;var e=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,t=s.match(e);if(t){var i=parseFloat(t[4]),n=(parseFloat(t[1])%360+360)%360,o=Qd(parseFloat(t[2]),0,100),r=Qd(parseFloat(t[3]),0,100),a=Qd(isNaN(i)?1:i,0,1);return[n,o,r,a]}return null};pr.to.hex=function(){var s=ay(arguments);return"#"+kw(s[0])+kw(s[1])+kw(s[2])+(s[3]<1?kw(Math.round(s[3]*255)):"")};pr.to.rgb=function(){var s=ay(arguments);return s.length<4||s[3]===1?"rgb("+Math.round(s[0])+", "+Math.round(s[1])+", "+Math.round(s[2])+")":"rgba("+Math.round(s[0])+", "+Math.round(s[1])+", "+Math.round(s[2])+", "+s[3]+")"};pr.to.rgb.percent=function(){var s=ay(arguments),e=Math.round(s[0]/255*100),t=Math.round(s[1]/255*100),i=Math.round(s[2]/255*100);return s.length<4||s[3]===1?"rgb("+e+"%, "+t+"%, "+i+"%)":"rgba("+e+"%, "+t+"%, "+i+"%, "+s[3]+")"};pr.to.hsl=function(){var s=ay(arguments);return s.length<4||s[3]===1?"hsl("+s[0]+", "+s[1]+"%, "+s[2]+"%)":"hsla("+s[0]+", "+s[1]+"%, "+s[2]+"%, "+s[3]+")"};pr.to.hwb=function(){var s=ay(arguments),e="";return s.length>=4&&s[3]!==1&&(e=", "+s[3]),"hwb("+s[0]+", "+s[1]+"%, "+s[2]+"%"+e+")"};pr.to.keyword=function(s){return Nq[s.slice(0,3)]};function Qd(s,e,t){return Math.min(Math.max(e,s),t)}function kw(s){var e=Math.round(s).toString(16).toUpperCase();return e.length<2?"0"+e:e}var TRe=Iq.exports;const mf=TRe,ur=oG,Rq=["keyword","gray","hex"],aP={};for(const s of Object.keys(ur))aP[[...ur[s].labels].sort().join("")]=s;const nL={};function es(s,e){if(!(this instanceof es))return new es(s,e);if(e&&e in Rq&&(e=null),e&&!(e in ur))throw new Error("Unknown model: "+e);let t,i;if(s==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(s instanceof es)this.model=s.model,this.color=[...s.color],this.valpha=s.valpha;else if(typeof s=="string"){const n=mf.get(s);if(n===null)throw new Error("Unable to parse color from string: "+s);this.model=n.model,i=ur[this.model].channels,this.color=n.value.slice(0,i),this.valpha=typeof n.value[i]=="number"?n.value[i]:1}else if(s.length>0){this.model=e||"rgb",i=ur[this.model].channels;const n=Array.prototype.slice.call(s,0,i);this.color=lP(n,i),this.valpha=typeof s[i]=="number"?s[i]:1}else if(typeof s=="number")this.model="rgb",this.color=[s>>16&255,s>>8&255,s&255],this.valpha=1;else{this.valpha=1;const n=Object.keys(s);"alpha"in s&&(n.splice(n.indexOf("alpha"),1),this.valpha=typeof s.alpha=="number"?s.alpha:0);const o=n.sort().join("");if(!(o in aP))throw new Error("Unable to parse color from object: "+JSON.stringify(s));this.model=aP[o];const{labels:r}=ur[this.model],a=[];for(t=0;t<r.length;t++)a.push(s[r[t]]);this.color=lP(a)}if(nL[this.model])for(i=ur[this.model].channels,t=0;t<i;t++){const n=nL[this.model][t];n&&(this.color[t]=n(this.color[t]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}es.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(s){let e=this.model in mf.to?this:this.rgb();e=e.round(typeof s=="number"?s:1);const t=e.valpha===1?e.color:[...e.color,this.valpha];return mf.to[e.model](t)},percentString(s){const e=this.rgb().round(typeof s=="number"?s:1),t=e.valpha===1?e.color:[...e.color,this.valpha];return mf.to.rgb.percent(t)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){const s={},{channels:e}=ur[this.model],{labels:t}=ur[this.model];for(let i=0;i<e;i++)s[t[i]]=this.color[i];return this.valpha!==1&&(s.alpha=this.valpha),s},unitArray(){const s=this.rgb().color;return s[0]/=255,s[1]/=255,s[2]/=255,this.valpha!==1&&s.push(this.valpha),s},unitObject(){const s=this.rgb().object();return s.r/=255,s.g/=255,s.b/=255,this.valpha!==1&&(s.alpha=this.valpha),s},round(s){return s=Math.max(s||0,0),new es([...this.color.map(NRe(s)),this.valpha],this.model)},alpha(s){return s!==void 0?new es([...this.color,Math.max(0,Math.min(1,s))],this.model):this.valpha},red:on("rgb",0,Bn(255)),green:on("rgb",1,Bn(255)),blue:on("rgb",2,Bn(255)),hue:on(["hsl","hsv","hsl","hwb","hcg"],0,s=>(s%360+360)%360),saturationl:on("hsl",1,Bn(100)),lightness:on("hsl",2,Bn(100)),saturationv:on("hsv",1,Bn(100)),value:on("hsv",2,Bn(100)),chroma:on("hcg",1,Bn(100)),gray:on("hcg",2,Bn(100)),white:on("hwb",1,Bn(100)),wblack:on("hwb",2,Bn(100)),cyan:on("cmyk",0,Bn(100)),magenta:on("cmyk",1,Bn(100)),yellow:on("cmyk",2,Bn(100)),black:on("cmyk",3,Bn(100)),x:on("xyz",0,Bn(95.047)),y:on("xyz",1,Bn(100)),z:on("xyz",2,Bn(108.833)),l:on("lab",0,Bn(100)),a:on("lab",1),b:on("lab",2),keyword(s){return s!==void 0?new es(s):ur[this.model].keyword(this.color)},hex(s){return s!==void 0?new es(s):mf.to.hex(this.rgb().round().color)},hexa(s){if(s!==void 0)return new es(s);const e=this.rgb().round().color;let t=Math.round(this.valpha*255).toString(16).toUpperCase();return t.length===1&&(t="0"+t),mf.to.hex(e)+t},rgbNumber(){const s=this.rgb().color;return(s[0]&255)<<16|(s[1]&255)<<8|s[2]&255},luminosity(){const s=this.rgb().color,e=[];for(const[t,i]of s.entries()){const n=i/255;e[t]=n<=.04045?n/12.92:((n+.055)/1.055)**2.4}return .2126*e[0]+.7152*e[1]+.0722*e[2]},contrast(s){const e=this.luminosity(),t=s.luminosity();return e>t?(e+.05)/(t+.05):(t+.05)/(e+.05)},level(s){const e=this.contrast(s);return e>=7?"AAA":e>=4.5?"AA":""},isDark(){const s=this.rgb().color;return(s[0]*2126+s[1]*7152+s[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){const s=this.rgb();for(let e=0;e<3;e++)s.color[e]=255-s.color[e];return s},lighten(s){const e=this.hsl();return e.color[2]+=e.color[2]*s,e},darken(s){const e=this.hsl();return e.color[2]-=e.color[2]*s,e},saturate(s){const e=this.hsl();return e.color[1]+=e.color[1]*s,e},desaturate(s){const e=this.hsl();return e.color[1]-=e.color[1]*s,e},whiten(s){const e=this.hwb();return e.color[1]+=e.color[1]*s,e},blacken(s){const e=this.hwb();return e.color[2]+=e.color[2]*s,e},grayscale(){const s=this.rgb().color,e=s[0]*.3+s[1]*.59+s[2]*.11;return es.rgb(e,e,e)},fade(s){return this.alpha(this.valpha-this.valpha*s)},opaquer(s){return this.alpha(this.valpha+this.valpha*s)},rotate(s){const e=this.hsl();let t=e.color[0];return t=(t+s)%360,t=t<0?360+t:t,e.color[0]=t,e},mix(s,e){if(!s||!s.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof s);const t=s.rgb(),i=this.rgb(),n=e===void 0?.5:e,o=2*n-1,r=t.alpha()-i.alpha(),a=((o*r===-1?o:(o+r)/(1+o*r))+1)/2,l=1-a;return es.rgb(a*t.red()+l*i.red(),a*t.green()+l*i.green(),a*t.blue()+l*i.blue(),t.alpha()*n+i.alpha()*(1-n))}};for(const s of Object.keys(ur)){if(Rq.includes(s))continue;const{channels:e}=ur[s];es.prototype[s]=function(...t){return this.model===s?new es(this):t.length>0?new es(t,s):new es([...RRe(ur[this.model][s].raw(this.color)),this.valpha],s)},es[s]=function(...t){let i=t[0];return typeof i=="number"&&(i=lP(t,e)),new es(i,s)}}function ERe(s,e){return Number(s.toFixed(e))}function NRe(s){return function(e){return ERe(e,s)}}function on(s,e,t){s=Array.isArray(s)?s:[s];for(const i of s)(nL[i]||(nL[i]=[]))[e]=t;return s=s[0],function(i){let n;return i!==void 0?(t&&(i=t(i)),n=this[s](),n.color[e]=i,n):(n=this[s]().color[e],t&&(n=t(n)),n)}}function Bn(s){return function(e){return Math.max(0,Math.min(s,e))}}function RRe(s){return Array.isArray(s)?s:[s]}function lP(s,e){for(let t=0;t<e;t++)typeof s[t]!="number"&&(s[t]=0);return s}var MRe=es;const K8=nG(MRe);var ARe=typeof global=="object"&&global&&global.Object===Object&&global,PRe=typeof self=="object"&&self&&self.Object===Object&&self,Rg=ARe||PRe||Function("return this")(),sL=Rg.Symbol,Mq=Object.prototype,ORe=Mq.hasOwnProperty,FRe=Mq.toString,m_=sL?sL.toStringTag:void 0;function BRe(s){var e=ORe.call(s,m_),t=s[m_];try{s[m_]=void 0;var i=!0}catch{}var n=FRe.call(s);return i&&(e?s[m_]=t:delete s[m_]),n}var WRe=Object.prototype,HRe=WRe.toString;function VRe(s){return HRe.call(s)}var zRe="[object Null]",URe="[object Undefined]",q8=sL?sL.toStringTag:void 0;function Aq(s){return s==null?s===void 0?URe:zRe:q8&&q8 in Object(s)?BRe(s):VRe(s)}function Pq(s){return s!=null&&typeof s=="object"}var $Re="[object Symbol]";function jRe(s){return typeof s=="symbol"||Pq(s)&&Aq(s)==$Re}var ZRe=Array.isArray,KRe=/\s/;function qRe(s){for(var e=s.length;e--&&KRe.test(s.charAt(e)););return e}var GRe=/^\s+/;function YRe(s){return s&&s.slice(0,qRe(s)+1).replace(GRe,"")}function dm(s){var e=typeof s;return s!=null&&(e=="object"||e=="function")}var G8=NaN,XRe=/^[-+]0x[0-9a-f]+$/i,QRe=/^0b[01]+$/i,JRe=/^0o[0-7]+$/i,eMe=parseInt;function tMe(s){if(typeof s=="number")return s;if(jRe(s))return G8;if(dm(s)){var e=typeof s.valueOf=="function"?s.valueOf():s;s=dm(e)?e+"":e}if(typeof s!="string")return s===0?s:+s;s=YRe(s);var t=QRe.test(s);return t||JRe.test(s)?eMe(s.slice(2),t?2:8):XRe.test(s)?G8:+s}var Y8=1/0,iMe=17976931348623157e292;function nMe(s){if(!s)return s===0?s:0;if(s=tMe(s),s===Y8||s===-Y8){var e=s<0?-1:1;return e*iMe}return s===s?s:0}function X8(s){var e=nMe(s),t=e%1;return e===e?t?e-t:e:0}function Oq(s){return s}var sMe="[object AsyncFunction]",oMe="[object Function]",rMe="[object GeneratorFunction]",aMe="[object Proxy]";function lMe(s){if(!dm(s))return!1;var e=Aq(s);return e==oMe||e==rMe||e==sMe||e==aMe}var FI=Rg["__core-js_shared__"],Q8=function(){var s=/[^.]+$/.exec(FI&&FI.keys&&FI.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}();function cMe(s){return!!Q8&&Q8 in s}var dMe=Function.prototype,hMe=dMe.toString;function uMe(s){if(s!=null){try{return hMe.call(s)}catch{}try{return s+""}catch{}}return""}var gMe=/[\\^$.*+?()[\]{}|]/g,fMe=/^\[object .+?Constructor\]$/,pMe=Function.prototype,mMe=Object.prototype,_Me=pMe.toString,bMe=mMe.hasOwnProperty,vMe=RegExp("^"+_Me.call(bMe).replace(gMe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function CMe(s){if(!dm(s)||cMe(s))return!1;var e=lMe(s)?vMe:fMe;return e.test(uMe(s))}function yMe(s,e){return s?.[e]}function Fq(s,e){var t=yMe(s,e);return CMe(t)?t:void 0}var J8=Fq(Rg,"WeakMap"),oL=J8&&new J8,Bq=oL?function(s,e){return oL.set(s,e),s}:Oq,eH=Object.create,Q4=function(){function s(){}return function(e){if(!dm(e))return{};if(eH)return eH(e);s.prototype=e;var t=new s;return s.prototype=void 0,t}}();function dC(s){return function(){var e=arguments;switch(e.length){case 0:return new s;case 1:return new s(e[0]);case 2:return new s(e[0],e[1]);case 3:return new s(e[0],e[1],e[2]);case 4:return new s(e[0],e[1],e[2],e[3]);case 5:return new s(e[0],e[1],e[2],e[3],e[4]);case 6:return new s(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new s(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var t=Q4(s.prototype),i=s.apply(t,e);return dm(i)?i:t}}var wMe=1;function SMe(s,e,t){var i=e&wMe,n=dC(s);function o(){var r=this&&this!==Rg&&this instanceof o?n:s;return r.apply(i?t:this,arguments)}return o}function Wq(s,e,t){switch(t.length){case 0:return s.call(e);case 1:return s.call(e,t[0]);case 2:return s.call(e,t[0],t[1]);case 3:return s.call(e,t[0],t[1],t[2])}return s.apply(e,t)}var LMe=Math.max;function Hq(s,e,t,i){for(var n=-1,o=s.length,r=t.length,a=-1,l=e.length,c=LMe(o-r,0),d=Array(l+c),h=!i;++a<l;)d[a]=e[a];for(;++n<r;)(h||n<o)&&(d[t[n]]=s[n]);for(;c--;)d[a++]=s[n++];return d}var xMe=Math.max;function Vq(s,e,t,i){for(var n=-1,o=s.length,r=-1,a=t.length,l=-1,c=e.length,d=xMe(o-a,0),h=Array(d+c),u=!i;++n<d;)h[n]=s[n];for(var g=n;++l<c;)h[g+l]=e[l];for(;++r<a;)(u||n<o)&&(h[g+t[r]]=s[n++]);return h}function kMe(s,e){for(var t=s.length,i=0;t--;)s[t]===e&&++i;return i}function J4(){}var DMe=4294967295;function hm(s){this.__wrapped__=s,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=DMe,this.__views__=[]}hm.prototype=Q4(J4.prototype);hm.prototype.constructor=hm;function IMe(){}var zq=oL?function(s){return oL.get(s)}:IMe,tH={},TMe=Object.prototype,EMe=TMe.hasOwnProperty;function NMe(s){for(var e=s.name+"",t=tH[e],i=EMe.call(tH,e)?t.length:0;i--;){var n=t[i],o=n.func;if(o==null||o==s)return n.name}return e}function um(s,e){this.__wrapped__=s,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}um.prototype=Q4(J4.prototype);um.prototype.constructor=um;function Uq(s,e){var t=-1,i=s.length;for(e||(e=Array(i));++t<i;)e[t]=s[t];return e}function RMe(s){if(s instanceof hm)return s.clone();var e=new um(s.__wrapped__,s.__chain__);return e.__actions__=Uq(s.__actions__),e.__index__=s.__index__,e.__values__=s.__values__,e}var MMe=Object.prototype,AMe=MMe.hasOwnProperty;function rL(s){if(Pq(s)&&!ZRe(s)&&!(s instanceof hm)){if(s instanceof um)return s;if(AMe.call(s,"__wrapped__"))return RMe(s)}return new um(s)}rL.prototype=J4.prototype;rL.prototype.constructor=rL;function PMe(s){var e=NMe(s),t=rL[e];if(typeof t!="function"||!(e in hm.prototype))return!1;if(s===t)return!0;var i=zq(t);return!!i&&s===i[0]}var OMe=800,FMe=16,BMe=Date.now;function $q(s){var e=0,t=0;return function(){var i=BMe(),n=FMe-(i-t);if(t=i,n>0){if(++e>=OMe)return arguments[0]}else e=0;return s.apply(void 0,arguments)}}var jq=$q(Bq),WMe=/\{\n\/\* \[wrapped with (.+)\] \*/,HMe=/,? & /;function VMe(s){var e=s.match(WMe);return e?e[1].split(HMe):[]}var zMe=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function UMe(s,e){var t=e.length;if(!t)return s;var i=t-1;return e[i]=(t>1?"& ":"")+e[i],e=e.join(t>2?", ":" "),s.replace(zMe,`{
/* [wrapped with `+e+`] */
`)}function $Me(s){return function(){return s}}var iH=function(){try{var s=Fq(Object,"defineProperty");return s({},"",{}),s}catch{}}(),jMe=iH?function(s,e){return iH(s,"toString",{configurable:!0,enumerable:!1,value:$Me(e),writable:!0})}:Oq,ZMe=$q(jMe);function KMe(s,e){for(var t=-1,i=s==null?0:s.length;++t<i&&e(s[t],t,s)!==!1;);return s}function qMe(s,e,t,i){for(var n=s.length,o=t+-1;++o<n;)if(e(s[o],o,s))return o;return-1}function GMe(s){return s!==s}function YMe(s,e,t){for(var i=t-1,n=s.length;++i<n;)if(s[i]===e)return i;return-1}function XMe(s,e,t){return e===e?YMe(s,e,t):qMe(s,GMe,t)}function QMe(s,e){var t=s==null?0:s.length;return!!t&&XMe(s,e,0)>-1}var JMe=1,eAe=2,tAe=8,iAe=16,nAe=32,sAe=64,oAe=128,rAe=256,aAe=512,lAe=[["ary",oAe],["bind",JMe],["bindKey",eAe],["curry",tAe],["curryRight",iAe],["flip",aAe],["partial",nAe],["partialRight",sAe],["rearg",rAe]];function cAe(s,e){return KMe(lAe,function(t){var i="_."+t[0];e&t[1]&&!QMe(s,i)&&s.push(i)}),s.sort()}function Zq(s,e,t){var i=e+"";return ZMe(s,UMe(i,cAe(VMe(i),t)))}var dAe=1,hAe=2,uAe=4,gAe=8,nH=32,sH=64;function Kq(s,e,t,i,n,o,r,a,l,c){var d=e&gAe,h=d?r:void 0,u=d?void 0:r,g=d?o:void 0,f=d?void 0:o;e|=d?nH:sH,e&=~(d?sH:nH),e&uAe||(e&=~(dAe|hAe));var m=[s,e,n,g,h,f,u,a,l,c],_=t.apply(void 0,m);return PMe(s)&&jq(_,m),_.placeholder=i,Zq(_,s,e)}function qq(s){var e=s;return e.placeholder}var fAe=9007199254740991,pAe=/^(?:0|[1-9]\d*)$/;function mAe(s,e){var t=typeof s;return e=e??fAe,!!e&&(t=="number"||t!="symbol"&&pAe.test(s))&&s>-1&&s%1==0&&s<e}var _Ae=Math.min;function bAe(s,e){for(var t=s.length,i=_Ae(e.length,t),n=Uq(s);i--;){var o=e[i];s[i]=mAe(o,t)?n[o]:void 0}return s}var oH="__lodash_placeholder__";function aL(s,e){for(var t=-1,i=s.length,n=0,o=[];++t<i;){var r=s[t];(r===e||r===oH)&&(s[t]=oH,o[n++]=t)}return o}var vAe=1,CAe=2,yAe=8,wAe=16,SAe=128,LAe=512;function e5(s,e,t,i,n,o,r,a,l,c){var d=e&SAe,h=e&vAe,u=e&CAe,g=e&(yAe|wAe),f=e&LAe,m=u?void 0:dC(s);function _(){for(var b=arguments.length,v=Array(b),C=b;C--;)v[C]=arguments[C];if(g)var y=qq(_),w=kMe(v,y);if(i&&(v=Hq(v,i,n,g)),o&&(v=Vq(v,o,r,g)),b-=w,g&&b<c){var x=aL(v,y);return Kq(s,e,e5,_.placeholder,t,v,x,a,l,c-b)}var L=h?t:this,D=u?L[s]:s;return b=v.length,a?v=bAe(v,a):f&&b>1&&v.reverse(),d&&l<b&&(v.length=l),this&&this!==Rg&&this instanceof _&&(D=m||dC(D)),D.apply(L,v)}return _}function xAe(s,e,t){var i=dC(s);function n(){for(var o=arguments.length,r=Array(o),a=o,l=qq(n);a--;)r[a]=arguments[a];var c=o<3&&r[0]!==l&&r[o-1]!==l?[]:aL(r,l);if(o-=c.length,o<t)return Kq(s,e,e5,n.placeholder,void 0,r,c,void 0,void 0,t-o);var d=this&&this!==Rg&&this instanceof n?i:s;return Wq(d,this,r)}return n}var kAe=1;function DAe(s,e,t,i){var n=e&kAe,o=dC(s);function r(){for(var a=-1,l=arguments.length,c=-1,d=i.length,h=Array(d+l),u=this&&this!==Rg&&this instanceof r?o:s;++c<d;)h[c]=i[c];for(;l--;)h[c++]=arguments[++a];return Wq(u,n?t:this,h)}return r}var rH="__lodash_placeholder__",BI=1,IAe=2,TAe=4,aH=8,__=128,lH=256,EAe=Math.min;function NAe(s,e){var t=s[1],i=e[1],n=t|i,o=n<(BI|IAe|__),r=i==__&&t==aH||i==__&&t==lH&&s[7].length<=e[8]||i==(__|lH)&&e[7].length<=e[8]&&t==aH;if(!(o||r))return s;i&BI&&(s[2]=e[2],n|=t&BI?0:TAe);var a=e[3];if(a){var l=s[3];s[3]=l?Hq(l,a,e[4]):a,s[4]=l?aL(s[3],rH):e[4]}return a=e[5],a&&(l=s[5],s[5]=l?Vq(l,a,e[6]):a,s[6]=l?aL(s[5],rH):e[6]),a=e[7],a&&(s[7]=a),i&__&&(s[8]=s[8]==null?e[8]:EAe(s[8],e[8])),s[9]==null&&(s[9]=e[9]),s[0]=e[0],s[1]=n,s}var RAe="Expected a function",cH=1,MAe=2,WI=8,HI=16,VI=32,dH=64,hH=Math.max;function AAe(s,e,t,i,n,o,r,a){var l=e&MAe;if(!l&&typeof s!="function")throw new TypeError(RAe);var c=i?i.length:0;if(c||(e&=~(VI|dH),i=n=void 0),r=r===void 0?r:hH(X8(r),0),a=a===void 0?a:X8(a),c-=n?n.length:0,e&dH){var d=i,h=n;i=n=void 0}var u=l?void 0:zq(s),g=[s,e,t,i,n,d,h,o,r,a];if(u&&NAe(g,u),s=g[0],e=g[1],t=g[2],i=g[3],n=g[4],a=g[9]=g[9]===void 0?l?0:s.length:hH(g[9]-c,0),!a&&e&(WI|HI)&&(e&=~(WI|HI)),!e||e==cH)var f=SMe(s,e,t);else e==WI||e==HI?f=xAe(s,e,a):(e==VI||e==(cH|VI))&&!n.length?f=DAe(s,e,t,i):f=e5.apply(void 0,g);var m=u?Bq:jq;return Zq(m(f,g),s,e)}var PAe=8;function lL(s,e,t){e=t?void 0:e;var i=AAe(s,PAe,void 0,void 0,void 0,void 0,void 0,e);return i.placeholder=lL.placeholder,i}lL.placeholder={};function OAe(s){const e=s[0],t=s[1],i=s[2];let n,o,r;return n=e*1+t*0+i*1.13983,o=e*1+t*-.39465+i*-.5806,r=e*1+t*2.02311+i*0,n=Math.min(Math.max(0,n),1),o=Math.min(Math.max(0,o),1),r=Math.min(Math.max(0,r),1),[n*255,o*255,r*255]}function FAe(s){const e=s[0]/255,t=s[1]/255,i=s[2]/255,n=e*.299+t*.587+i*.114,o=e*-.14713+t*-.28886+i*.436,r=e*.615+t*-.51499+i*-.10001;return[n,o,r]}const BAe={scheme:"threezerotwofour",author:"jan t. sott (http://github.com/idleberg)",base00:"#090300",base01:"#3a3432",base02:"#4a4543",base03:"#5c5855",base04:"#807d7c",base05:"#a5a2a2",base06:"#d6d5d4",base07:"#f7f7f7",base08:"#db2d20",base09:"#e8bbd0",base0A:"#fded02",base0B:"#01a252",base0C:"#b5e4f4",base0D:"#01a0e4",base0E:"#a16a94",base0F:"#cdab53"},WAe={scheme:"apathy",author:"jannik siebert (https://github.com/janniks)",base00:"#031A16",base01:"#0B342D",base02:"#184E45",base03:"#2B685E",base04:"#5F9C92",base05:"#81B5AC",base06:"#A7CEC8",base07:"#D2E7E4",base08:"#3E9688",base09:"#3E7996",base0A:"#3E4C96",base0B:"#883E96",base0C:"#963E4C",base0D:"#96883E",base0E:"#4C963E",base0F:"#3E965B"},HAe={scheme:"ashes",author:"jannik siebert (https://github.com/janniks)",base00:"#1C2023",base01:"#393F45",base02:"#565E65",base03:"#747C84",base04:"#ADB3BA",base05:"#C7CCD1",base06:"#DFE2E5",base07:"#F3F4F5",base08:"#C7AE95",base09:"#C7C795",base0A:"#AEC795",base0B:"#95C7AE",base0C:"#95AEC7",base0D:"#AE95C7",base0E:"#C795AE",base0F:"#C79595"},VAe={scheme:"atelier dune",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/dune)",base00:"#20201d",base01:"#292824",base02:"#6e6b5e",base03:"#7d7a68",base04:"#999580",base05:"#a6a28c",base06:"#e8e4cf",base07:"#fefbec",base08:"#d73737",base09:"#b65611",base0A:"#cfb017",base0B:"#60ac39",base0C:"#1fad83",base0D:"#6684e1",base0E:"#b854d4",base0F:"#d43552"},zAe={scheme:"atelier forest",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/forest)",base00:"#1b1918",base01:"#2c2421",base02:"#68615e",base03:"#766e6b",base04:"#9c9491",base05:"#a8a19f",base06:"#e6e2e0",base07:"#f1efee",base08:"#f22c40",base09:"#df5320",base0A:"#d5911a",base0B:"#5ab738",base0C:"#00ad9c",base0D:"#407ee7",base0E:"#6666ea",base0F:"#c33ff3"},UAe={scheme:"atelier heath",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/heath)",base00:"#1b181b",base01:"#292329",base02:"#695d69",base03:"#776977",base04:"#9e8f9e",base05:"#ab9bab",base06:"#d8cad8",base07:"#f7f3f7",base08:"#ca402b",base09:"#a65926",base0A:"#bb8a35",base0B:"#379a37",base0C:"#159393",base0D:"#516aec",base0E:"#7b59c0",base0F:"#cc33cc"},$Ae={scheme:"atelier lakeside",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/lakeside/)",base00:"#161b1d",base01:"#1f292e",base02:"#516d7b",base03:"#5a7b8c",base04:"#7195a8",base05:"#7ea2b4",base06:"#c1e4f6",base07:"#ebf8ff",base08:"#d22d72",base09:"#935c25",base0A:"#8a8a0f",base0B:"#568c3b",base0C:"#2d8f6f",base0D:"#257fad",base0E:"#5d5db1",base0F:"#b72dd2"},jAe={scheme:"atelier seaside",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/seaside/)",base00:"#131513",base01:"#242924",base02:"#5e6e5e",base03:"#687d68",base04:"#809980",base05:"#8ca68c",base06:"#cfe8cf",base07:"#f0fff0",base08:"#e6193c",base09:"#87711d",base0A:"#c3c322",base0B:"#29a329",base0C:"#1999b3",base0D:"#3d62f5",base0E:"#ad2bee",base0F:"#e619c3"},ZAe={scheme:"bespin",author:"jan t. sott",base00:"#28211c",base01:"#36312e",base02:"#5e5d5c",base03:"#666666",base04:"#797977",base05:"#8a8986",base06:"#9d9b97",base07:"#baae9e",base08:"#cf6a4c",base09:"#cf7d34",base0A:"#f9ee98",base0B:"#54be0d",base0C:"#afc4db",base0D:"#5ea6ea",base0E:"#9b859d",base0F:"#937121"},KAe={scheme:"brewer",author:"timothe poisot (http://github.com/tpoisot)",base00:"#0c0d0e",base01:"#2e2f30",base02:"#515253",base03:"#737475",base04:"#959697",base05:"#b7b8b9",base06:"#dadbdc",base07:"#fcfdfe",base08:"#e31a1c",base09:"#e6550d",base0A:"#dca060",base0B:"#31a354",base0C:"#80b1d3",base0D:"#3182bd",base0E:"#756bb1",base0F:"#b15928"},qAe={scheme:"bright",author:"chris kempson (http://chriskempson.com)",base00:"#000000",base01:"#303030",base02:"#505050",base03:"#b0b0b0",base04:"#d0d0d0",base05:"#e0e0e0",base06:"#f5f5f5",base07:"#ffffff",base08:"#fb0120",base09:"#fc6d24",base0A:"#fda331",base0B:"#a1c659",base0C:"#76c7b7",base0D:"#6fb3d2",base0E:"#d381c3",base0F:"#be643c"},GAe={scheme:"chalk",author:"chris kempson (http://chriskempson.com)",base00:"#151515",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#b0b0b0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#f5f5f5",base08:"#fb9fb1",base09:"#eda987",base0A:"#ddb26f",base0B:"#acc267",base0C:"#12cfc0",base0D:"#6fc2ef",base0E:"#e1a3ee",base0F:"#deaf8f"},YAe={scheme:"codeschool",author:"brettof86",base00:"#232c31",base01:"#1c3657",base02:"#2a343a",base03:"#3f4944",base04:"#84898c",base05:"#9ea7a6",base06:"#a7cfa3",base07:"#b5d8f6",base08:"#2a5491",base09:"#43820d",base0A:"#a03b1e",base0B:"#237986",base0C:"#b02f30",base0D:"#484d79",base0E:"#c59820",base0F:"#c98344"},XAe={scheme:"colors",author:"mrmrs (http://clrs.cc)",base00:"#111111",base01:"#333333",base02:"#555555",base03:"#777777",base04:"#999999",base05:"#bbbbbb",base06:"#dddddd",base07:"#ffffff",base08:"#ff4136",base09:"#ff851b",base0A:"#ffdc00",base0B:"#2ecc40",base0C:"#7fdbff",base0D:"#0074d9",base0E:"#b10dc9",base0F:"#85144b"},QAe={scheme:"default",author:"chris kempson (http://chriskempson.com)",base00:"#181818",base01:"#282828",base02:"#383838",base03:"#585858",base04:"#b8b8b8",base05:"#d8d8d8",base06:"#e8e8e8",base07:"#f8f8f8",base08:"#ab4642",base09:"#dc9656",base0A:"#f7ca88",base0B:"#a1b56c",base0C:"#86c1b9",base0D:"#7cafc2",base0E:"#ba8baf",base0F:"#a16946"},JAe={scheme:"eighties",author:"chris kempson (http://chriskempson.com)",base00:"#2d2d2d",base01:"#393939",base02:"#515151",base03:"#747369",base04:"#a09f93",base05:"#d3d0c8",base06:"#e8e6df",base07:"#f2f0ec",base08:"#f2777a",base09:"#f99157",base0A:"#ffcc66",base0B:"#99cc99",base0C:"#66cccc",base0D:"#6699cc",base0E:"#cc99cc",base0F:"#d27b53"},ePe={scheme:"embers",author:"jannik siebert (https://github.com/janniks)",base00:"#16130F",base01:"#2C2620",base02:"#433B32",base03:"#5A5047",base04:"#8A8075",base05:"#A39A90",base06:"#BEB6AE",base07:"#DBD6D1",base08:"#826D57",base09:"#828257",base0A:"#6D8257",base0B:"#57826D",base0C:"#576D82",base0D:"#6D5782",base0E:"#82576D",base0F:"#825757"},tPe={scheme:"flat",author:"chris kempson (http://chriskempson.com)",base00:"#2C3E50",base01:"#34495E",base02:"#7F8C8D",base03:"#95A5A6",base04:"#BDC3C7",base05:"#e0e0e0",base06:"#f5f5f5",base07:"#ECF0F1",base08:"#E74C3C",base09:"#E67E22",base0A:"#F1C40F",base0B:"#2ECC71",base0C:"#1ABC9C",base0D:"#3498DB",base0E:"#9B59B6",base0F:"#be643c"},iPe={scheme:"google",author:"seth wright (http://sethawright.com)",base00:"#1d1f21",base01:"#282a2e",base02:"#373b41",base03:"#969896",base04:"#b4b7b4",base05:"#c5c8c6",base06:"#e0e0e0",base07:"#ffffff",base08:"#CC342B",base09:"#F96A38",base0A:"#FBA922",base0B:"#198844",base0C:"#3971ED",base0D:"#3971ED",base0E:"#A36AC7",base0F:"#3971ED"},nPe={scheme:"grayscale",author:"alexandre gavioli (https://github.com/alexx2/)",base00:"#101010",base01:"#252525",base02:"#464646",base03:"#525252",base04:"#ababab",base05:"#b9b9b9",base06:"#e3e3e3",base07:"#f7f7f7",base08:"#7c7c7c",base09:"#999999",base0A:"#a0a0a0",base0B:"#8e8e8e",base0C:"#868686",base0D:"#686868",base0E:"#747474",base0F:"#5e5e5e"},sPe={scheme:"green screen",author:"chris kempson (http://chriskempson.com)",base00:"#001100",base01:"#003300",base02:"#005500",base03:"#007700",base04:"#009900",base05:"#00bb00",base06:"#00dd00",base07:"#00ff00",base08:"#007700",base09:"#009900",base0A:"#007700",base0B:"#00bb00",base0C:"#005500",base0D:"#009900",base0E:"#00bb00",base0F:"#005500"},oPe={scheme:"harmonic16",author:"jannik siebert (https://github.com/janniks)",base00:"#0b1c2c",base01:"#223b54",base02:"#405c79",base03:"#627e99",base04:"#aabcce",base05:"#cbd6e2",base06:"#e5ebf1",base07:"#f7f9fb",base08:"#bf8b56",base09:"#bfbf56",base0A:"#8bbf56",base0B:"#56bf8b",base0C:"#568bbf",base0D:"#8b56bf",base0E:"#bf568b",base0F:"#bf5656"},rPe={scheme:"hopscotch",author:"jan t. sott",base00:"#322931",base01:"#433b42",base02:"#5c545b",base03:"#797379",base04:"#989498",base05:"#b9b5b8",base06:"#d5d3d5",base07:"#ffffff",base08:"#dd464c",base09:"#fd8b19",base0A:"#fdcc59",base0B:"#8fc13e",base0C:"#149b93",base0D:"#1290bf",base0E:"#c85e7c",base0F:"#b33508"},aPe={scheme:"isotope",author:"jan t. sott",base00:"#000000",base01:"#404040",base02:"#606060",base03:"#808080",base04:"#c0c0c0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#ffffff",base08:"#ff0000",base09:"#ff9900",base0A:"#ff0099",base0B:"#33ff00",base0C:"#00ffff",base0D:"#0066ff",base0E:"#cc00ff",base0F:"#3300ff"},lPe={scheme:"marrakesh",author:"alexandre gavioli (http://github.com/alexx2/)",base00:"#201602",base01:"#302e00",base02:"#5f5b17",base03:"#6c6823",base04:"#86813b",base05:"#948e48",base06:"#ccc37a",base07:"#faf0a5",base08:"#c35359",base09:"#b36144",base0A:"#a88339",base0B:"#18974e",base0C:"#75a738",base0D:"#477ca1",base0E:"#8868b3",base0F:"#b3588e"},cPe={scheme:"mocha",author:"chris kempson (http://chriskempson.com)",base00:"#3B3228",base01:"#534636",base02:"#645240",base03:"#7e705a",base04:"#b8afad",base05:"#d0c8c6",base06:"#e9e1dd",base07:"#f5eeeb",base08:"#cb6077",base09:"#d28b71",base0A:"#f4bc87",base0B:"#beb55b",base0C:"#7bbda4",base0D:"#8ab3b5",base0E:"#a89bb9",base0F:"#bb9584"},dPe={scheme:"monokai",author:"wimer hazenberg (http://www.monokai.nl)",base00:"#272822",base01:"#383830",base02:"#49483e",base03:"#75715e",base04:"#a59f85",base05:"#f8f8f2",base06:"#f5f4f1",base07:"#f9f8f5",base08:"#f92672",base09:"#fd971f",base0A:"#f4bf75",base0B:"#a6e22e",base0C:"#a1efe4",base0D:"#66d9ef",base0E:"#ae81ff",base0F:"#cc6633"},hPe={scheme:"nicinabox",author:"nicinabox (http://github.com/nicinabox)",base00:"#2A2F3A",base01:"#3C444F",base02:"#4F5A65",base03:"#BEBEBE",base04:"#b0b0b0",base05:"#d0d0d0",base06:"#FFFFFF",base07:"#f5f5f5",base08:"#fb9fb1",base09:"#FC6D24",base0A:"#ddb26f",base0B:"#A1C659",base0C:"#12cfc0",base0D:"#6FB3D2",base0E:"#D381C3",base0F:"#deaf8f"},uPe={scheme:"ocean",author:"chris kempson (http://chriskempson.com)",base00:"#2b303b",base01:"#343d46",base02:"#4f5b66",base03:"#65737e",base04:"#a7adba",base05:"#c0c5ce",base06:"#dfe1e8",base07:"#eff1f5",base08:"#bf616a",base09:"#d08770",base0A:"#ebcb8b",base0B:"#a3be8c",base0C:"#96b5b4",base0D:"#8fa1b3",base0E:"#b48ead",base0F:"#ab7967"},gPe={scheme:"paraiso",author:"jan t. sott",base00:"#2f1e2e",base01:"#41323f",base02:"#4f424c",base03:"#776e71",base04:"#8d8687",base05:"#a39e9b",base06:"#b9b6b0",base07:"#e7e9db",base08:"#ef6155",base09:"#f99b15",base0A:"#fec418",base0B:"#48b685",base0C:"#5bc4bf",base0D:"#06b6ef",base0E:"#815ba4",base0F:"#e96ba8"},fPe={scheme:"pop",author:"chris kempson (http://chriskempson.com)",base00:"#000000",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#b0b0b0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#ffffff",base08:"#eb008a",base09:"#f29333",base0A:"#f8ca12",base0B:"#37b349",base0C:"#00aabb",base0D:"#0e5a94",base0E:"#b31e8d",base0F:"#7a2d00"},pPe={scheme:"railscasts",author:"ryan bates (http://railscasts.com)",base00:"#2b2b2b",base01:"#272935",base02:"#3a4055",base03:"#5a647e",base04:"#d4cfc9",base05:"#e6e1dc",base06:"#f4f1ed",base07:"#f9f7f3",base08:"#da4939",base09:"#cc7833",base0A:"#ffc66d",base0B:"#a5c261",base0C:"#519f50",base0D:"#6d9cbe",base0E:"#b6b3eb",base0F:"#bc9458"},mPe={scheme:"shapeshifter",author:"tyler benziger (http://tybenz.com)",base00:"#000000",base01:"#040404",base02:"#102015",base03:"#343434",base04:"#555555",base05:"#ababab",base06:"#e0e0e0",base07:"#f9f9f9",base08:"#e92f2f",base09:"#e09448",base0A:"#dddd13",base0B:"#0ed839",base0C:"#23edda",base0D:"#3b48e3",base0E:"#f996e2",base0F:"#69542d"},_Pe={scheme:"solarized",author:"ethan schoonover (http://ethanschoonover.com/solarized)",base00:"#002b36",base01:"#073642",base02:"#586e75",base03:"#657b83",base04:"#839496",base05:"#93a1a1",base06:"#eee8d5",base07:"#fdf6e3",base08:"#dc322f",base09:"#cb4b16",base0A:"#b58900",base0B:"#859900",base0C:"#2aa198",base0D:"#268bd2",base0E:"#6c71c4",base0F:"#d33682"},bPe={scheme:"summerfruit",author:"christopher corley (http://cscorley.github.io/)",base00:"#151515",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#B0B0B0",base05:"#D0D0D0",base06:"#E0E0E0",base07:"#FFFFFF",base08:"#FF0086",base09:"#FD8900",base0A:"#ABA800",base0B:"#00C918",base0C:"#1faaaa",base0D:"#3777E6",base0E:"#AD00A1",base0F:"#cc6633"},vPe={scheme:"tomorrow",author:"chris kempson (http://chriskempson.com)",base00:"#1d1f21",base01:"#282a2e",base02:"#373b41",base03:"#969896",base04:"#b4b7b4",base05:"#c5c8c6",base06:"#e0e0e0",base07:"#ffffff",base08:"#cc6666",base09:"#de935f",base0A:"#f0c674",base0B:"#b5bd68",base0C:"#8abeb7",base0D:"#81a2be",base0E:"#b294bb",base0F:"#a3685a"},CPe={scheme:"london tube",author:"jan t. sott",base00:"#231f20",base01:"#1c3f95",base02:"#5a5758",base03:"#737171",base04:"#959ca1",base05:"#d9d8d8",base06:"#e7e7e8",base07:"#ffffff",base08:"#ee2e24",base09:"#f386a1",base0A:"#ffd204",base0B:"#00853e",base0C:"#85cebc",base0D:"#009ddc",base0E:"#98005d",base0F:"#b06110"},yPe={scheme:"twilight",author:"david hart (http://hart-dev.com)",base00:"#1e1e1e",base01:"#323537",base02:"#464b50",base03:"#5f5a60",base04:"#838184",base05:"#a7a7a7",base06:"#c3c3c3",base07:"#ffffff",base08:"#cf6a4c",base09:"#cda869",base0A:"#f9ee98",base0B:"#8f9d6a",base0C:"#afc4db",base0D:"#7587a6",base0E:"#9b859d",base0F:"#9b703f"},Gq={threezerotwofour:BAe,apathy:WAe,ashes:HAe,atelierDune:VAe,atelierForest:zAe,atelierHeath:UAe,atelierLakeside:$Ae,atelierSeaside:jAe,bespin:ZAe,brewer:KAe,bright:qAe,chalk:GAe,codeschool:YAe,colors:XAe,default:QAe,eighties:JAe,embers:ePe,flat:tPe,google:iPe,grayscale:nPe,greenscreen:sPe,harmonic:oPe,hopscotch:rPe,isotope:aPe,marrakesh:lPe,mocha:cPe,monokai:dPe,nicinabox:hPe,ocean:uPe,paraiso:gPe,pop:fPe,railscasts:pPe,shapeshifter:mPe,solarized:_Pe,summerfruit:bPe,tomorrow:vPe,tube:CPe,twilight:yPe},Yq=Gq.default,uH=Object.keys(Yq),wPe=s=>s<.25?1:s<.5?.9-s:1.1-s,SPe=s=>{const e=K8(s),[t,i,n]=FAe(e.array()),o=[wPe(t),i,n],r=OAe(o);return K8.rgb(r).hex()},lf=s=>e=>({className:[e.className,s.className].filter(Boolean).join(" "),style:{...e.style||{},...s.style||{}}}),LPe=(s,e)=>{if(s===void 0)return e;if(e===void 0)return s;const t=typeof s,i=typeof e;switch(t){case"string":switch(i){case"string":return[e,s].filter(Boolean).join(" ");case"object":return lf({className:s,style:e});case"function":return(n,...o)=>lf({className:s})(e(n,...o))}break;case"object":switch(i){case"string":return lf({className:e,style:s});case"object":return{...e,...s};case"function":return(n,...o)=>lf({style:s})(e(n,...o))}break;case"function":switch(i){case"string":return(n,...o)=>s(lf(n)({className:e}),...o);case"object":return(n,...o)=>s(lf(n)({style:e}),...o);case"function":return(n,...o)=>s(e(n,...o),...o)}}},xPe=(s,e)=>{const t=Object.keys(e);for(const i in s)t.indexOf(i)===-1&&t.push(i);return t.reduce((i,n)=>(i[n]=LPe(s[n],e[n]),i),{})},kPe=(s,e,...t)=>{if(e===null)return s;Array.isArray(e)||(e=[e]);const n=e.map(o=>s[o]).filter(Boolean).reduce((o,r)=>(typeof r=="string"?o.className=[o.className,r].filter(Boolean).join(" "):typeof r=="object"?o.style={...o.style,...r}:typeof r=="function"&&(o={...o,...r(o,...t)}),o),{className:"",style:{}});return n.className||delete n.className,Object.keys(n.style).length===0&&delete n.style,n},cP=s=>Object.keys(s).reduce((e,t)=>(e[t]=/^base/.test(t)?SPe(s[t]):t==="scheme"?s[t]+":inverted":s[t],e),{}),DPe=lL((s,e={},t={},...i)=>{const{defaultBase16:n=Yq,base16Themes:o=null}=e,r=IPe(t,o);r&&(t={...r,...t});const a=uH.reduce((h,u)=>(h[u]=t[u]||n[u],h),{}),l=Object.keys(t).reduce((h,u)=>(uH.indexOf(u)===-1&&(h[u]=t[u]),h),{}),c=s(a),d=xPe(l,c);return lL(kPe,2)(d,...i)},3),Xq=s=>!!s.extend,IPe=(s,e)=>{if(s&&Xq(s)&&s.extend&&(s=s.extend),typeof s=="string"){const[t,i]=s.split(":");e?s=e[t]:s=Gq[t],i==="inverted"&&(s=cP(s))}return s&&Object.prototype.hasOwnProperty.call(s,"base00")?s:void 0},TPe=s=>typeof s=="string"?`${s}:inverted`:s&&Xq(s)&&s.extend?typeof s.extend=="string"?{...s,extend:`${s.extend}:inverted`}:{...s,extend:cP(s.extend)}:s&&cP(s);function EPe(s){const e=Object.prototype.toString.call(s).slice(8,-1);return e==="Object"&&typeof s[Symbol.iterator]=="function"?"Iterable":e==="Custom"&&s.constructor!==Object&&s instanceof Object?"Object":e}function Qq({styling:s,arrowStyle:e="single",expanded:t,nodeType:i,onClick:n}){return ze.createElement("div",{...s("arrowContainer",e),onClick:n},ze.createElement("div",{...s(["arrow","arrowSign"],i,t,e)},"",e==="double"&&ze.createElement("div",{...s(["arrowSign","arrowSignInner"])},"")))}function NPe(s,e){return s==="Object"?Object.keys(e).length:s==="Array"?e.length:1/0}function RPe(s){return typeof s.set=="function"}function MPe(s,e,t,i=0,n=1/0){let o;if(s==="Object"){let r=Object.getOwnPropertyNames(e);t&&r.sort(t===!0?void 0:t),r=r.slice(i,n+1),o={entries:r.map(a=>({key:a,value:e[a]}))}}else if(s==="Array")o={entries:e.slice(i,n+1).map((r,a)=>({key:a+i,value:r}))};else{let r=0;const a=[];let l=!0;const c=RPe(e);for(const d of e){if(r>n){l=!1;break}i<=r&&(c&&Array.isArray(d)?typeof d[0]=="string"||typeof d[0]=="number"?a.push({key:d[0],value:d[1]}):a.push({key:`[entry ${r}]`,value:{"[key]":d[0],"[value]":d[1]}}):a.push({key:r,value:d})),r++}o={hasMore:!l,entries:a}}return o}function zI(s,e,t){const i=[];for(;e-s>t*t;)t=t*t;for(let n=s;n<=e;n+=t)i.push({from:n,to:Math.min(e,n+t-1)});return i}function APe(s,e,t,i,n=0,o=1/0){const r=MPe.bind(null,s,e,t);if(!i)return r().entries;const a=o<1/0,l=Math.min(o-n,NPe(s,e));if(s!=="Iterable"){if(l<=i||i<7)return r(n,o).entries}else if(l<=i&&!a)return r(n,o).entries;let c;if(s==="Iterable"){const{hasMore:d,entries:h}=r(n,n+i-1);c=d?[...h,...zI(n+i,n+2*i-1,i)]:h}else c=a?zI(n,o,i):[...r(0,i-5).entries,...zI(i-4,l-5,i),...r(l-4,l-1).entries];return c}function PPe(s){const{styling:e,from:t,to:i,renderChildNodes:n,nodeType:o}=s,[r,a]=ce.useState(!1),l=ce.useCallback(()=>{a(!r)},[r]);return r?ze.createElement("div",{...e("itemRange",r)},n(s,t,i)):ze.createElement("div",{...e("itemRange",r),onClick:l},ze.createElement(Qq,{nodeType:o,styling:e,expanded:!1,onClick:l,arrowStyle:"double"}),`${t} ... ${i}`)}function OPe(s){return s.to!==void 0}function Jq(s,e,t){const{nodeType:i,data:n,collectionLimit:o,circularCache:r,keyPath:a,postprocessValue:l,sortObjectKeys:c}=s,d=[];return APe(i,n,c,o,e,t).forEach(h=>{if(OPe(h))d.push(ze.createElement(PPe,{...s,key:`ItemRange--${h.from}-${h.to}`,from:h.from,to:h.to,renderChildNodes:Jq}));else{const{key:u,value:g}=h,f=r.indexOf(g)!==-1;d.push(ze.createElement(eG,{...s,postprocessValue:l,collectionLimit:o,key:`Node--${u}`,keyPath:[u,...a],value:l(g),circularCache:[...r,g],isCircular:f,hideRoot:!1}))}}),d}function t5(s){const{circularCache:e=[],collectionLimit:t,createItemString:i,data:n,expandable:o,getItemString:r,hideRoot:a,isCircular:l,keyPath:c,labelRenderer:d,level:h=0,nodeType:u,nodeTypeIndicator:g,shouldExpandNodeInitially:f,styling:m}=s,[_,b]=ce.useState(l?!1:f(c,n,h)),v=ce.useCallback(()=>{o&&b(!_)},[o,_]),C=_||a&&h===0?Jq({...s,circularCache:e,level:h+1}):null,y=ze.createElement("span",{...m("nestedNodeItemType",_)},g),w=r(u,n,y,i(n,t),c),x=[c,u,_,o];return a?ze.createElement("li",{...m("rootNode",...x)},ze.createElement("ul",{...m("rootNodeChildren",...x)},C)):ze.createElement("li",{...m("nestedNode",...x)},o&&ze.createElement(Qq,{styling:m,nodeType:u,expanded:_,onClick:v}),ze.createElement("label",{...m(["label","nestedNodeLabel"],...x),onClick:v},d(...x)),ze.createElement("span",{...m("nestedNodeItemString",...x),onClick:v},w),ze.createElement("ul",{...m("nestedNodeChildren",...x)},C))}function FPe(s){const e=Object.getOwnPropertyNames(s).length;return`${e} ${e!==1?"keys":"key"}`}function BPe({data:s,...e}){return ze.createElement(t5,{...e,data:s,nodeType:"Object",nodeTypeIndicator:e.nodeType==="Error"?"Error()":"{}",createItemString:FPe,expandable:Object.getOwnPropertyNames(s).length>0})}function WPe(s){return`${s.length} ${s.length!==1?"items":"item"}`}function HPe({data:s,...e}){return ze.createElement(t5,{...e,data:s,nodeType:"Array",nodeTypeIndicator:"[]",createItemString:WPe,expandable:s.length>0})}function VPe(s,e){let t=0,i=!1;if(Number.isSafeInteger(s.size))t=s.size;else for(const n of s){if(e&&t+1>e){i=!0;break}t+=1}return`${i?">":""}${t} ${t!==1?"entries":"entry"}`}function zPe(s){return ze.createElement(t5,{...s,nodeType:"Iterable",nodeTypeIndicator:"()",createItemString:VPe,expandable:!0})}function Jl({nodeType:s,styling:e,labelRenderer:t,keyPath:i,valueRenderer:n,value:o,valueGetter:r=a=>a}){return ze.createElement("li",{...e("value",s,i)},ze.createElement("label",{...e(["label","valueLabel"],s,i)},t(i,s,!1,!1)),ze.createElement("span",{...e("valueText",s,i)},n(r(o),o,...i)))}function eG({getItemString:s,keyPath:e,labelRenderer:t,styling:i,value:n,valueRenderer:o,isCustomNode:r,...a}){const l=r(n)?"Custom":EPe(n),c={getItemString:s,key:e[0],keyPath:e,labelRenderer:t,nodeType:l,styling:i,value:n,valueRenderer:o},d={...a,...c,data:n,isCustomNode:r};switch(l){case"Object":case"Error":case"WeakMap":case"WeakSet":return ze.createElement(BPe,{...d});case"Array":return ze.createElement(HPe,{...d});case"Iterable":case"Map":case"Set":return ze.createElement(zPe,{...d});case"String":return ze.createElement(Jl,{...c,valueGetter:h=>`"${h}"`});case"Number":return ze.createElement(Jl,{...c});case"Boolean":return ze.createElement(Jl,{...c,valueGetter:h=>h?"true":"false"});case"Date":return ze.createElement(Jl,{...c,valueGetter:h=>h.toISOString()});case"Null":return ze.createElement(Jl,{...c,valueGetter:()=>"null"});case"Undefined":return ze.createElement(Jl,{...c,valueGetter:()=>"undefined"});case"Function":case"Symbol":return ze.createElement(Jl,{...c,valueGetter:h=>h.toString()});case"Custom":return ze.createElement(Jl,{...c});default:return ze.createElement(Jl,{...c,valueGetter:()=>`<${l}>`})}}const UPe={scheme:"solarized",author:"ethan schoonover (http://ethanschoonover.com/solarized)",base00:"#002b36",base01:"#073642",base02:"#586e75",base03:"#657b83",base04:"#839496",base05:"#93a1a1",base06:"#eee8d5",base07:"#fdf6e3",base08:"#dc322f",base09:"#cb4b16",base0A:"#b58900",base0B:"#859900",base0C:"#2aa198",base0D:"#268bd2",base0E:"#6c71c4",base0F:"#d33682"},$Pe=s=>({BACKGROUND_COLOR:s.base00,TEXT_COLOR:s.base07,STRING_COLOR:s.base0B,DATE_COLOR:s.base0B,NUMBER_COLOR:s.base09,BOOLEAN_COLOR:s.base09,NULL_COLOR:s.base08,UNDEFINED_COLOR:s.base08,FUNCTION_COLOR:s.base08,SYMBOL_COLOR:s.base08,LABEL_COLOR:s.base0D,ARROW_COLOR:s.base0D,ITEM_STRING_COLOR:s.base0B,ITEM_STRING_EXPANDED_COLOR:s.base03}),jPe=s=>({String:s.STRING_COLOR,Date:s.DATE_COLOR,Number:s.NUMBER_COLOR,Boolean:s.BOOLEAN_COLOR,Null:s.NULL_COLOR,Undefined:s.UNDEFINED_COLOR,Function:s.FUNCTION_COLOR,Symbol:s.SYMBOL_COLOR}),ZPe=s=>{const e=$Pe(s);return{tree:{border:0,padding:0,marginTop:"0.5em",marginBottom:"0.5em",marginLeft:"0.125em",marginRight:0,listStyle:"none",MozUserSelect:"none",WebkitUserSelect:"none",backgroundColor:e.BACKGROUND_COLOR},value:({style:t},i,n)=>({style:{...t,paddingTop:"0.25em",paddingRight:0,marginLeft:"0.875em",WebkitUserSelect:"text",MozUserSelect:"text",wordWrap:"break-word",paddingLeft:n.length>1?"2.125em":"1.25em",textIndent:"-0.5em",wordBreak:"break-all"}}),label:{display:"inline-block",color:e.LABEL_COLOR},valueLabel:{margin:"0 0.5em 0 0"},valueText:({style:t},i)=>({style:{...t,color:jPe(e)[i]}}),itemRange:(t,i)=>({style:{paddingTop:i?0:"0.25em",cursor:"pointer",color:e.LABEL_COLOR}}),arrow:({style:t},i,n)=>({style:{...t,marginLeft:0,transition:"150ms",WebkitTransition:"150ms",MozTransition:"150ms",WebkitTransform:n?"rotateZ(90deg)":"rotateZ(0deg)",MozTransform:n?"rotateZ(90deg)":"rotateZ(0deg)",transform:n?"rotateZ(90deg)":"rotateZ(0deg)",transformOrigin:"45% 50%",WebkitTransformOrigin:"45% 50%",MozTransformOrigin:"45% 50%",position:"relative",lineHeight:"1.1em",fontSize:"0.75em"}}),arrowContainer:({style:t},i)=>({style:{...t,display:"inline-block",paddingRight:"0.5em",paddingLeft:i==="double"?"1em":0,cursor:"pointer"}}),arrowSign:{color:e.ARROW_COLOR},arrowSignInner:{position:"absolute",top:0,left:"-0.4em"},nestedNode:({style:t},i,n,o,r)=>({style:{...t,position:"relative",paddingTop:"0.25em",marginLeft:i.length>1?"0.875em":0,paddingLeft:r?0:"1.125em"}}),rootNode:{padding:0,margin:0},nestedNodeLabel:({style:t},i,n,o,r)=>({style:{...t,margin:0,padding:0,WebkitUserSelect:r?"inherit":"text",MozUserSelect:r?"inherit":"text",cursor:r?"pointer":"default"}}),nestedNodeItemString:({style:t},i,n,o)=>({style:{...t,paddingLeft:"0.5em",cursor:"default",color:o?e.ITEM_STRING_EXPANDED_COLOR:e.ITEM_STRING_COLOR}}),nestedNodeItemType:{marginLeft:"0.3em",marginRight:"0.3em"},nestedNodeChildren:({style:t},i,n)=>({style:{...t,padding:0,margin:0,listStyle:"none",display:n?"block":"none"}}),rootNodeChildren:{padding:0,margin:0,listStyle:"none"}}},KPe=DPe(ZPe,{defaultBase16:UPe}),gH=s=>s,qPe=(s,e,t)=>t===0,GPe=(s,e,t,i)=>ze.createElement("span",null,t," ",i),YPe=([s])=>ze.createElement("span",null,s,":"),XPe=()=>!1;function QPe({data:s,theme:e,invertTheme:t,keyPath:i=["root"],labelRenderer:n=YPe,valueRenderer:o=gH,shouldExpandNodeInitially:r=qPe,hideRoot:a=!1,getItemString:l=GPe,postprocessValue:c=gH,isCustomNode:d=XPe,collectionLimit:h=50,sortObjectKeys:u=!1}){const g=ce.useMemo(()=>KPe(t?TPe(e):e),[e,t]);return ze.createElement("ul",{...g("tree")},ze.createElement(eG,{keyPath:a?[]:i,value:c(s),isCustomNode:d,styling:g,labelRenderer:n,valueRenderer:o,shouldExpandNodeInitially:r,hideRoot:a,getItemString:l,postprocessValue:c,collectionLimit:h,sortObjectKeys:u}))}const JPe={dark:{string:"#CE9178",number:"#B5CEA8",constants:"#569CD6",type:"#3DC9B0"},light:{string:"#A31515",number:"#098658",constants:"#0000FF",type:"#008080"}},tG=({lines:s,msSinceRun:e})=>{const{token:t}=fP.useToken(),i=JPe[t.mode??"light"];return St.jsxs("div",{className:"grl-function__debugger__log",children:[St.jsx("div",{className:"grl-function__debugger__log__values",children:s.map((n,o)=>{const r=JSON.parse(n);return St.jsx(QPe,{data:r,shouldExpandNodeInitially:()=>!1,labelRenderer:(a,l)=>{const c=[],d=a?.[0];if(d!=="root"&&c.push(St.jsxs(St.Fragment,{children:[St.jsx("span",{style:{color:i.constants},children:d}),": "]})),a.length>=1){let h=[...a];h.pop(),h=h.reverse(),c.push(e2e(i)(t2e(r,h),l))}return St.jsx(St.Fragment,{children:c})},valueRenderer:dP(i),theme:{base00:t.colorBgElevated,base03:t.colorTextBase,base0B:t.colorTextBase,base0D:t.colorTextBase}},o)})}),St.jsx("div",{className:"grl-function__debugger__log__time",children:St.jsxs(LG,{title:"Time since start of execution of script.",children:[e," ms"]})})]})},e2e=s=>(e,t)=>{if(t==="Object"){const n=Object.entries(e),o=n.reduce((r,[a,l],c)=>[...r,St.jsxs("span",{children:[a,": ",dP(s)(fH(l),l),c!==n.length-1&&St.jsx(St.Fragment,{children:", "})]},a)],[]);return St.jsxs(St.Fragment,{children:[" {",o,"}"]})}else if(t==="Array"){const i=e,n=i.reduce((o,r,a)=>[...o,St.jsxs("span",{children:[dP(s)(fH(r),r),a!==i.length-1&&St.jsx(St.Fragment,{children:", "})]},a)],[]);return St.jsxs(St.Fragment,{children:[i.length>2?`(${i.length})`:""," [",n,"]"]})}else return null},fH=s=>{switch(!0){case Array.isArray(s):return`Array(${s.length})`;case typeof s=="object":return"{...}";default:return JSON.stringify(s)}},dP=s=>(e,t)=>typeof t=="string"?St.jsx("span",{style:{color:s.string},children:e}):typeof t=="boolean"?St.jsx("span",{style:{color:s.constants},children:e}):typeof t=="number"?St.jsx("span",{style:{color:s.number},children:e}):e,t2e=(s,e)=>e.reduce((t,i)=>t&&t[i]?t[i]:null,s);tG.__docgenInfo={description:"",methods:[],displayName:"FunctionDebuggerLog",props:{lines:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},msSinceRun:{required:!0,tsType:{name:"number"},description:""}}};const iG=({trace:s})=>{const{token:e}=fP.useToken(),[t,i]=ce.useState(!1),n=s?.traceData?.log||[];return St.jsx("div",{className:"grl-function__debugger",children:St.jsxs("div",{className:"grl-function__debugger__panel",children:[St.jsxs("div",{className:"function-debugger__panel-header",onClick:()=>i(!t),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1.25rem",position:"sticky",top:0,background:e.colorBgLayout,zIndex:3,borderBottom:t?`1px solid ${e.colorBorder}`:"none",cursor:"pointer"},children:[St.jsx(n5.Text,{style:{fontWeight:"bold"},children:"Console"}),St.jsx("div",{children:St.jsx(RY,{style:{transform:t?void 0:"rotate(-180deg)",transformOrigin:"50%"}})})]}),t&&St.jsxs(St.Fragment,{children:[n.length===0&&St.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:St.jsx(n5.Text,{type:"secondary",children:"Use console.log and run simulation to debug your code."})}),n.map((o,r)=>St.jsx(tG,{lines:o.lines,msSinceRun:o.msSinceRun},r))]})]})})};iG.__docgenInfo={description:"",methods:[],displayName:"FunctionDebugger",props:{trace:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  input: Input | null;
  output: Output | null;
  name: string;
  id: string;
  performance: string | null;
  traceData: Trace;
}`,signature:{properties:[{key:"input",value:{name:"union",raw:"Input | null",elements:[{name:"unknown"},{name:"null"}],required:!0}},{key:"output",value:{name:"union",raw:"Output | null",elements:[{name:"unknown"},{name:"null"}],required:!0}},{key:"name",value:{name:"string",required:!0}},{key:"id",value:{name:"string",required:!0}},{key:"performance",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!0}},{key:"traceData",value:{name:"signature",type:"object",raw:`{
  log?: TraceFunctionLog[];
}`,signature:{properties:[{key:"log",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  lines: string[];
  msSinceRun: number;
}`,signature:{properties:[{key:"lines",value:{name:"Array",elements:[{name:"string"}],raw:"string[]",required:!0}},{key:"msSinceRun",value:{name:"number",required:!0}}]}}],raw:"TraceFunctionLog[]",required:!1}}]},required:!0}}]}},description:""}}};const i2e=s=>{const e=s.toJson();return hP(e)},hP=s=>xG(s).with("String",()=>"string").with("Bool",()=>"boolean").with("Number",()=>"number").with("Null",()=>"null").with("Any",()=>"any").with({Object:Ck.select()},e=>`{${Object.entries(e).map(([i,n])=>[i,hP(n)].join(":")).join(",")}}`).with({Array:Ck.select()},e=>`${hP(e)}[]`).with({Constant:Ck.select()},e=>{try{return JSON.stringify(e)}catch{return"any"}}).exhaustive(),n2e=`declare namespace Big {
    type BigSource = number | string | Big;

    /**
     * GT = 1, EQ = 0, LT = -1
     */
    type Comparison = -1 | 0 | 1;

    /**
     * RoundDown = 0, RoundHalfUp = 1, RoundHalfEven = 2, RoundUp = 3
     */
    type RoundingMode = 0 | 1 | 2 | 3;

    interface BigConstructor {
        /**
         * Returns a new instance of a Big number object
         *
         * String values may be in exponential, as well as normal (non-exponential) notation.
         * There is no limit to the number of digits of a string value (other than that of Javascript's maximum array size), but the largest recommended exponent magnitude is 1e+6.
         * Infinity, NaN and hexadecimal literal strings, e.g. '0xff', are not valid.
         * String values in octal literal form will be interpreted as decimals, e.g. '011' is 11, not 9.
         *
         * @throws \`NaN\` on an invalid value.
         */
        new(value: BigSource): Big;

        /**
         * Returns a new instance of a Big number object
         *
         * String values may be in exponential, as well as normal (non-exponential) notation.
         * There is no limit to the number of digits of a string value (other than that of Javascript's maximum array size), but the largest recommended exponent magnitude is 1e+6.
         * Infinity, NaN and hexadecimal literal strings, e.g. '0xff', are not valid.
         * String values in octal literal form will be interpreted as decimals, e.g. '011' is 11, not 9.
         *
         * @throws \`NaN\` on an invalid value.
         */
        (value: BigSource): Big;

        /**
         * Create an additional Big number constructor
         *
         * Values created with the returned constructor will have a separate set of configuration values.
         * This can be used to create Big objects with different DP and RM values.
         * Big numbers created by different constructors can be used together in operations, and it is the DP and RM setting of the Big number that an operation is called upon that will apply.
         * In the interest of memory efficiency, all Big number constructors share the same prototype object,
         * so while the DP and RM (and any other own properties) of a constructor are isolated and untouchable by another, its prototype methods are not.
         */
        (): BigConstructor;

        /**
         * The maximum number of decimal places of the results of operations involving division.
         * It is relevant only to the div and sqrt methods, and the pow method when the exponent is negative.
         *
         * 0 to 1e+6 inclusive
         * Default value: 20
         */
        DP: number;
        /**
         * The rounding mode used in the above operations and by round, toExponential, toFixed and toPrecision.
         * Default value: 1
         */
        RM: number;
        /**
         * The negative exponent value at and below which toString returns exponential notation.
         *
         * -1e+6 to 0 inclusive
         * Default value: -7
         */
        NE: number;
        /**
         * The positive exponent value at and above which toString returns exponential notation.
         *
         * 0 to 1e+6 inclusive
         * Default value: 21
         */
        PE: number;
        /**
         * When set to true, an error will be thrown if a primitive number is passed to the Big constructor,
         * or if valueOf is called, or if toNumber is called on a Big which cannot be converted to a primitive number without a loss of precision.
         *
         * true|false
         * Default value: false
         */
        strict: boolean;

        /** Readonly rounding modes */

        /**
         * Rounds towards zero.
         * I.e. truncate, no rounding.
         */
        readonly roundDown: 0;
        /**
         * Rounds towards nearest neighbour.
         * If equidistant, rounds away from zero.
         */
        readonly roundHalfUp: 1;
        /**
         * Rounds towards nearest neighbour.
         * If equidistant, rounds towards even neighbour.
         */
        readonly roundHalfEven: 2;
        /**
         * Rounds away from zero.
         */
        readonly roundUp: 3;

        readonly Big: BigConstructor;
    }

    interface Big {
        /** Returns a Big number whose value is the absolute value, i.e. the magnitude, of this Big number. */
        abs(): Big;
        /**
         * Returns a Big number whose value is the value of this Big number plus n - alias for .plus().
         *
         * @throws \`NaN\` if n is invalid.
         */
        add(n: BigSource): Big;
        /**
         * Compare the values.
         *
         * @throws \`NaN\` if n is invalid.
         */
        cmp(n: BigSource): Comparison;
        /**
         * Returns a Big number whose value is the value of this Big number divided by n.
         *
         * If the result has more fraction digits than is specified by Big.DP, it will be rounded to Big.DP decimal places using rounding mode Big.RM.
         *
         * @throws \`NaN\` if n is invalid.
         * @throws \`Infinity\` on division by zero.
         * @throws \`NaN\` on division of zero by zero.
         */
        div(n: BigSource): Big;
        /**
         * Returns true if the value of this Big equals the value of n, otherwise returns false.
         *
         * @throws \`NaN\` if n is invalid.
         */
        eq(n: BigSource): boolean;
        /**
         * Returns true if the value of this Big is greater than the value of n, otherwise returns false.
         *
         * @throws \`NaN\` if n is invalid.
         */
        gt(n: BigSource): boolean;
        /**
         * Returns true if the value of this Big is greater than or equal to the value of n, otherwise returns false.
         *
         * @throws \`NaN\` if n is invalid.
         */
        gte(n: BigSource): boolean;
        /**
         * Returns true if the value of this Big is less than the value of n, otherwise returns false.
         *
         * @throws \`NaN\` if n is invalid.
         */
        lt(n: BigSource): boolean;
        /**
         * Returns true if the value of this Big is less than or equal to the value of n, otherwise returns false.
         *
         * @throws \`NaN\` if n is invalid.
         */
        lte(n: BigSource): boolean;
        /**
         * Returns a Big number whose value is the value of this Big number minus n.
         *
         * @throws \`NaN\` if n is invalid.
         */
        minus(n: BigSource): Big;
        /**
         * Returns a Big number whose value is the value of this Big number modulo n, i.e. the integer remainder of dividing this Big number by n.
         *
         * The result will have the same sign as this Big number, and it will match that of Javascript's % operator (within the limits of its precision) and BigDecimal's remainder method.
         *
         * @throws \`NaN\` if n is negative or otherwise invalid.
         */
        mod(n: BigSource): Big;
        /**
         * Returns a Big number whose value is the value of this Big number times n - alias for .times().
         *
         * @throws \`NaN\` if n is invalid.
         */
        mul(n: BigSource): Big;
        /**
         * Return a new Big whose value is the value of this Big negated.
         */
        neg(): Big;
        /**
         * Returns a Big number whose value is the value of this Big number plus n.
         *
         * @throws \`NaN\` if n is invalid.
         */
        plus(n: BigSource): Big;
        /**
         * Returns a Big number whose value is the value of this Big number raised to the power exp.
         *
         * If exp is negative and the result has more fraction digits than is specified by Big.DP, it will be rounded to Big.DP decimal places using rounding mode Big.RM.
         *
         * @param exp The power to raise the number to, -1e+6 to 1e+6 inclusive
         * @throws \`!pow!\` if exp is invalid.
         *
         * Note: High value exponents may cause this method to be slow to return.
         */
        pow(exp: number): Big;
        /**
         * Return a new Big whose value is the value of this Big rounded to a maximum precision of sd
         * significant digits using rounding mode rm, or Big.RM if rm is not specified.
         *
         * @param sd Significant digits: integer, 1 to MAX_DP inclusive.
         * @param rm Rounding mode: 0 (down), 1 (half-up), 2 (half-even) or 3 (up).
         * @throws \`!prec!\` if sd is invalid.
         * @throws \`!Big.RM!\` if rm is invalid.
         */
        prec(sd: number, rm?: RoundingMode): Big;
        /**
         * Returns a Big number whose value is the value of this Big number rounded using rounding mode rm to a maximum of dp decimal places.
         *
         * @param dp Decimal places, 0 to 1e+6 inclusive
         * @param rm Rounding mode: 0 (down), 1 (half-up), 2 (half-even) or 3 (up).
         * @throws \`!round!\` if dp is invalid.
         * @throws \`!Big.RM!\` if rm is invalid.
         */
        round(dp?: number, rm?: RoundingMode): Big;
        /**
         * Returns a Big number whose value is the square root of this Big number.
         *
         * If the result has more fraction digits than is specified by Big.DP, it will be rounded to Big.DP decimal places using rounding mode Big.RM.
         *
         * @throws \`NaN\` if this Big number is negative.
         */
        sqrt(): Big;
        /**
         * Returns a Big number whose value is the value of this Big number minus n - alias for .minus().
         *
         * @throws \`NaN\` if n is invalid.
         */
        sub(n: BigSource): Big;
        /**
         * Returns a Big number whose value is the value of this Big number times n.
         *
         * @throws \`NaN\` if n is invalid.
         */
        times(n: BigSource): Big;
        /**
         * Returns a string representing the value of this Big number in exponential notation to a fixed number of decimal places dp.
         *
         * If the value of this Big number in exponential notation has more digits to the right of the decimal point than is specified by dp,
         * the return value will be rounded to dp decimal places using rounding mode Big.RM.
         *
         * If the value of this Big number in exponential notation has fewer digits to the right of the decimal point than is specified by dp, the return value will be appended with zeros accordingly.
         *
         * If dp is omitted, or is null or undefined, the number of digits after the decimal point defaults to the minimum number of digits necessary to represent the value exactly.
         *
         * @param dp Decimal places, 0 to 1e+6 inclusive
         * @param rm Rounding mode: 0 (down), 1 (half-up), 2 (half-even) or 3 (up).
         * @throws \`!toFix!\` if dp is invalid.
         */
        toExponential(dp?: number, rm?: RoundingMode): string;
        /**
         * Returns a string representing the value of this Big number in normal notation to a fixed number of decimal places dp.
         *
         * If the value of this Big number in normal notation has more digits to the right of the decimal point than is specified by dp,
         * the return value will be rounded to dp decimal places using rounding mode Big.RM.
         *
         * If the value of this Big number in normal notation has fewer fraction digits then is specified by dp, the return value will be appended with zeros accordingly.
         *
         * Unlike Number.prototype.toFixed, which returns exponential notation if a number is greater or equal to 1021, this method will always return normal notation.
         *
         * If dp is omitted, or is null or undefined, then the return value is simply the value in normal notation.
         * This is also unlike Number.prototype.toFixed, which returns the value to zero decimal places.
         *
         * @param dp Decimal places, 0 to 1e+6 inclusive
         * @param rm Rounding mode: 0 (down), 1 (half-up), 2 (half-even) or 3 (up).
         * @throws \`!toFix!\` if dp is invalid.
         */
        toFixed(dp?: number, rm?: RoundingMode): string;
        /**
         * Returns a string representing the value of this Big number to the specified number of significant digits sd.
         *
         * If the value of this Big number has more digits than is specified by sd, the return value will be rounded to sd significant digits using rounding mode Big.RM.
         *
         * If the value of this Big number has fewer digits than is specified by sd, the return value will be appended with zeros accordingly.
         *
         * If sd is less than the number of digits necessary to represent the integer part of the value in normal notation, then exponential notation is used.
         *
         * If sd is omitted, or is null or undefined, then the return value is the same as .toString().
         *
         * @param sd Significant digits, 1 to 1e+6 inclusive
         * @param rm Rounding mode: 0 (down), 1 (half-up), 2 (half-even) or 3 (up).
         * @throws \`!toPre!\` if sd is invalid.
         */
        toPrecision(sd?: number, rm?: RoundingMode): string;
        /**
         * Returns a string representing the value of this Big number.
         *
         * If this Big number has a positive exponent that is equal to or greater than 21, or a negative exponent equal to or less than -7, then exponential notation is returned.
         *
         * The point at which toString returns exponential rather than normal notation can be adjusted by changing
         * the value of Big.E_POS and Big.E_NEG. By default, Big numbers correspond to Javascript's number type in this regard.
         */
        toString(): string;
        /**
         * Returns a primitive number representing the value of this Big number.
         *
         * If Big.strict is true an error will be thrown if toNumber is called on a Big number which cannot be converted to a primitive number without a loss of precision.
         *
         * @since 6.0
         */
        toNumber(): number;
        /**
         * Returns a string representing the value of this Big number.
         *
         * If this Big number has a positive exponent that is equal to or greater than 21, or a negative exponent equal to or less than -7, then exponential notation is returned.
         *
         * The point at which toString returns exponential rather than normal notation can be adjusted by changing
         * the value of Big.E_POS and Big.E_NEG. By default, Big numbers correspond to Javascript's number type in this regard.
         */
        valueOf(): string;
        /**
         * Returns a string representing the value of this Big number.
         *
         * If this Big number has a positive exponent that is equal to or greater than 21, or a negative exponent equal to or less than -7, then exponential notation is returned.
         *
         * The point at which toString returns exponential rather than normal notation can be adjusted by changing
         * the value of Big.E_POS and Big.E_NEG. By default, Big numbers correspond to Javascript's number type in this regard.
         */
        toJSON(): string;
        /**
         * Returns an array of single digits
         */
        c: number[];
        /**
         * Returns the exponent, Integer, -1e+6 to 1e+6 inclusive
         */
        e: number;
        /**
         * Returns the sign, -1 or 1
         */
        s: number;
    }
}

// We want the exported symbol 'Big' to represent two things:
// - The Big interface, when used in a type context.
// - The BigConstructor instance, when used in a value context.
declare const Big: Big.BigConstructor;
type Big = Big.Big;

// The export is the same as type/value combo symbol 'Big'.
export = Big;
export as namespace Big;
`,s2e=`/// <reference path="./locale/index.d.ts" />

export = dayjs;

declare function dayjs (date?: dayjs.ConfigType): dayjs.Dayjs

declare function dayjs (date?: dayjs.ConfigType, format?: dayjs.OptionType, strict?: boolean): dayjs.Dayjs

declare function dayjs (date?: dayjs.ConfigType, format?: dayjs.OptionType, locale?: string, strict?: boolean): dayjs.Dayjs

declare namespace dayjs {
  interface ConfigTypeMap {
    default: string | number | Date | Dayjs | null | undefined
  }

  export type ConfigType = ConfigTypeMap[keyof ConfigTypeMap]

  export interface FormatObject { locale?: string, format?: string, utc?: boolean }

  export type OptionType = FormatObject | string | string[]

  export type UnitTypeShort = 'd' | 'D' | 'M' | 'y' | 'h' | 'm' | 's' | 'ms'

  export type UnitTypeLong = 'millisecond' | 'second' | 'minute' | 'hour' | 'day' | 'month' | 'year' | 'date'

  export type UnitTypeLongPlural = 'milliseconds' | 'seconds' | 'minutes' | 'hours' | 'days' | 'months' | 'years' | 'dates'
  
  export type UnitType = UnitTypeLong | UnitTypeLongPlural | UnitTypeShort;

  export type OpUnitType = UnitType | "week" | "weeks" | 'w';
  export type QUnitType = UnitType | "quarter" | "quarters" | 'Q';
  export type ManipulateType = Exclude<OpUnitType, 'date' | 'dates'>;
  class Dayjs {
    constructor (config?: ConfigType)
    /**
     * All Day.js objects are immutable. Still, \`dayjs#clone\` can create a clone of the current object if you need one.
     * \`\`\`
     * dayjs().clone()// => Dayjs
     * dayjs(dayjs('2019-01-25')) // passing a Dayjs object to a constructor will also clone it
     * \`\`\`
     * Docs: https://day.js.org/docs/en/parse/dayjs-clone
     */
    clone(): Dayjs
    /**
     * This returns a \`boolean\` indicating whether the Day.js object contains a valid date or not.
     * \`\`\`
     * dayjs().isValid()// => boolean
     * \`\`\`
     * Docs: https://day.js.org/docs/en/parse/is-valid
     */
    isValid(): boolean
    /**
     * Get the year.
     * \`\`\`
     * dayjs().year()// => 2020
     * \`\`\`
     * Docs: https://day.js.org/docs/en/get-set/year
     */
    year(): number
    /**
     * Set the year.
     * \`\`\`
     * dayjs().year(2000)// => Dayjs
     * \`\`\`
     * Docs: https://day.js.org/docs/en/get-set/year
     */
    year(value: number): Dayjs
    /**
     * Get the month.
     *
     * Months are zero indexed, so January is month 0.
     * \`\`\`
     * dayjs().month()// => 0-11
     * \`\`\`
     * Docs: https://day.js.org/docs/en/get-set/month
     */
    month(): number
    /**
     * Set the month.
     *
     * Months are zero indexed, so January is month 0.
     *
     * Accepts numbers from 0 to 11. If the range is exceeded, it will bubble up to the next year.
     * \`\`\`
     * dayjs().month(0)// => Dayjs
     * \`\`\`
     * Docs: https://day.js.org/docs/en/get-set/month
     */
    month(value: number): Dayjs
    /**
     * Get the date of the month.
     * \`\`\`
     * dayjs().date()// => 1-31
     * \`\`\`
     * Docs: https://day.js.org/docs/en/get-set/date
     */
    date(): number
    /**
     * Set the date of the month.
     *
     * Accepts numbers from 1 to 31. If the range is exceeded, it will bubble up to the next months.
     * \`\`\`
     * dayjs().date(1)// => Dayjs
     * \`\`\`
     * Docs: https://day.js.org/docs/en/get-set/date
     */
    date(value: number): Dayjs
    /**
     * Get the day of the week.
     *
     * Returns numbers from 0 (Sunday) to 6 (Saturday).
     * \`\`\`
     * dayjs().day()// 0-6
     * \`\`\`
     * Docs: https://day.js.org/docs/en/get-set/day
     */
    day(): 0 | 1 | 2 | 3 | 4 | 5 | 6
    /**
     * Set the day of the week.
     *
     * Accepts numbers from 0 (Sunday) to 6 (Saturday). If the range is exceeded, it will bubble up to next weeks.
     * \`\`\`
     * dayjs().day(0)// => Dayjs
     * \`\`\`
     * Docs: https://day.js.org/docs/en/get-set/day
     */
    day(value: number): Dayjs
    /**
     * Get the hour.
     * \`\`\`
     * dayjs().hour()// => 0-23
     * \`\`\`
     * Docs: https://day.js.org/docs/en/get-set/hour
     */
    hour(): number
    /**
     * Set the hour.
     *
     * Accepts numbers from 0 to 23. If the range is exceeded, it will bubble up to the next day.
     * \`\`\`
     * dayjs().hour(12)// => Dayjs
     * \`\`\`
     * Docs: https://day.js.org/docs/en/get-set/hour
     */
    hour(value: number): Dayjs
    /**
     * Get the minutes.
     * \`\`\`
     * dayjs().minute()// => 0-59
     * \`\`\`
     * Docs: https://day.js.org/docs/en/get-set/minute
     */
    minute(): number
    /**
     * Set the minutes.
     *
     * Accepts numbers from 0 to 59. If the range is exceeded, it will bubble up to the next hour.
     * \`\`\`
     * dayjs().minute(59)// => Dayjs
     * \`\`\`
     * Docs: https://day.js.org/docs/en/get-set/minute
     */
    minute(value: number): Dayjs
    /**
     * Get the seconds.
     * \`\`\`
     * dayjs().second()// => 0-59
     * \`\`\`
     * Docs: https://day.js.org/docs/en/get-set/second
     */
    second(): number
    /**
     * Set the seconds.
     *
     * Accepts numbers from 0 to 59. If the range is exceeded, it will bubble up to the next minutes.
     * \`\`\`
     * dayjs().second(1)// Dayjs
     * \`\`\`
     */
    second(value: number): Dayjs
    /**
     * Get the milliseconds.
     * \`\`\`
     * dayjs().millisecond()// => 0-999
     * \`\`\`
     * Docs: https://day.js.org/docs/en/get-set/millisecond
     */
    millisecond(): number
    /**
     * Set the milliseconds.
     *
     * Accepts numbers from 0 to 999. If the range is exceeded, it will bubble up to the next seconds.
     * \`\`\`
     * dayjs().millisecond(1)// => Dayjs
     * \`\`\`
     * Docs: https://day.js.org/docs/en/get-set/millisecond
     */
    millisecond(value: number): Dayjs
    /**
     * Generic setter, accepting unit as first argument, and value as second, returns a new instance with the applied changes.
     *
     * In general:
     * \`\`\`
     * dayjs().set(unit, value) === dayjs()[unit](value)
     * \`\`\`
     * Units are case insensitive, and support plural and short forms.
     * \`\`\`
     * dayjs().set('date', 1)
     * dayjs().set('month', 3) // April
     * dayjs().set('second', 30)
     * \`\`\`
     * Docs: https://day.js.org/docs/en/get-set/set
     */
    set(unit: UnitType, value: number): Dayjs
    /**
     * String getter, returns the corresponding information getting from Day.js object.
     *
     * In general:
     * \`\`\`
     * dayjs().get(unit) === dayjs()[unit]()
     * \`\`\`
     * Units are case insensitive, and support plural and short forms.
     * \`\`\`
     * dayjs().get('year')
     * dayjs().get('month') // start 0
     * dayjs().get('date')
     * \`\`\`
     * Docs: https://day.js.org/docs/en/get-set/get
     */
    get(unit: UnitType): number
    /**
     * Returns a cloned Day.js object with a specified amount of time added.
     * \`\`\`
     * dayjs().add(7, 'day')// => Dayjs
     * \`\`\`
     * Units are case insensitive, and support plural and short forms.
     *
     * Docs: https://day.js.org/docs/en/manipulate/add
     */
    add(value: number, unit?: ManipulateType): Dayjs
    /**
     * Returns a cloned Day.js object with a specified amount of time subtracted.
     * \`\`\`
     * dayjs().subtract(7, 'year')// => Dayjs
     * \`\`\`
     * Units are case insensitive, and support plural and short forms.
     *
     * Docs: https://day.js.org/docs/en/manipulate/subtract
     */
    subtract(value: number, unit?: ManipulateType): Dayjs
    /**
     * Returns a cloned Day.js object and set it to the start of a unit of time.
     * \`\`\`
     * dayjs().startOf('year')// => Dayjs
     * \`\`\`
     * Units are case insensitive, and support plural and short forms.
     *
     * Docs: https://day.js.org/docs/en/manipulate/start-of
     */
    startOf(unit: OpUnitType): Dayjs
    /**
     * Returns a cloned Day.js object and set it to the end of a unit of time.
     * \`\`\`
     * dayjs().endOf('month')// => Dayjs
     * \`\`\`
     * Units are case insensitive, and support plural and short forms.
     *
     * Docs: https://day.js.org/docs/en/manipulate/end-of
     */
    endOf(unit: OpUnitType): Dayjs
    /**
     * Get the formatted date according to the string of tokens passed in.
     *
     * To escape characters, wrap them in square brackets (e.g. [MM]).
     * \`\`\`
     * dayjs().format()// => current date in ISO8601, without fraction seconds e.g. '2020-04-02T08:02:17-05:00'
     * dayjs('2019-01-25').format('[YYYYescape] YYYY-MM-DDTHH:mm:ssZ[Z]')// 'YYYYescape 2019-01-25T00:00:00-02:00Z'
     * dayjs('2019-01-25').format('DD/MM/YYYY') // '25/01/2019'
     * \`\`\`
     * Docs: https://day.js.org/docs/en/display/format
     */
    format(template?: string): string
    /**
     * This indicates the difference between two date-time in the specified unit.
     *
     * To get the difference in milliseconds, use \`dayjs#diff\`
     * \`\`\`
     * const date1 = dayjs('2019-01-25')
     * const date2 = dayjs('2018-06-05')
     * date1.diff(date2) // 20214000000 default milliseconds
     * date1.diff() // milliseconds to current time
     * \`\`\`
     *
     * To get the difference in another unit of measurement, pass that measurement as the second argument.
     * \`\`\`
     * const date1 = dayjs('2019-01-25')
     * date1.diff('2018-06-05', 'month') // 7
     * \`\`\`
     * Units are case insensitive, and support plural and short forms.
     *
     * Docs: https://day.js.org/docs/en/display/difference
     */
    diff(date?: ConfigType, unit?: QUnitType | OpUnitType, float?: boolean): number
    /**
     * This returns the number of **milliseconds** since the Unix Epoch of the Day.js object.
     * \`\`\`
     * dayjs('2019-01-25').valueOf() // 1548381600000
     * +dayjs(1548381600000) // 1548381600000
     * \`\`\`
     * To get a Unix timestamp (the number of seconds since the epoch) from a Day.js object, you should use Unix Timestamp \`dayjs#unix()\`.
     *
     * Docs: https://day.js.org/docs/en/display/unix-timestamp-milliseconds
     */
    valueOf(): number
    /**
     * This returns the Unix timestamp (the number of **seconds** since the Unix Epoch) of the Day.js object.
     * \`\`\`
     * dayjs('2019-01-25').unix() // 1548381600
     * \`\`\`
     * This value is floored to the nearest second, and does not include a milliseconds component.
     *
     * Docs: https://day.js.org/docs/en/display/unix-timestamp
     */
    unix(): number
    /**
     * Get the number of days in the current month.
     * \`\`\`
     * dayjs('2019-01-25').daysInMonth() // 31
     * \`\`\`
     * Docs: https://day.js.org/docs/en/display/days-in-month
     */
    daysInMonth(): number
    /**
     * To get a copy of the native \`Date\` object parsed from the Day.js object use \`dayjs#toDate\`.
     * \`\`\`
     * dayjs('2019-01-25').toDate()// => Date
     * \`\`\`
     */
    toDate(): Date
    /**
     * To serialize as an ISO 8601 string.
     * \`\`\`
     * dayjs('2019-01-25').toJSON() // '2019-01-25T02:00:00.000Z'
     * \`\`\`
     * Docs: https://day.js.org/docs/en/display/as-json
     */
    toJSON(): string
    /**
     * To format as an ISO 8601 string.
     * \`\`\`
     * dayjs('2019-01-25').toISOString() // '2019-01-25T02:00:00.000Z'
     * \`\`\`
     * Docs: https://day.js.org/docs/en/display/as-iso-string
     */
    toISOString(): string
    /**
     * Returns a string representation of the date.
     * \`\`\`
     * dayjs('2019-01-25').toString() // 'Fri, 25 Jan 2019 02:00:00 GMT'
     * \`\`\`
     * Docs: https://day.js.org/docs/en/display/as-string
     */
    toString(): string
    /**
     * Get the UTC offset in minutes.
     * \`\`\`
     * dayjs().utcOffset()
     * \`\`\`
     * Docs: https://day.js.org/docs/en/manipulate/utc-offset
     */
    utcOffset(): number
    /**
     * This indicates whether the Day.js object is before the other supplied date-time.
     * \`\`\`
     * dayjs().isBefore(dayjs('2011-01-01')) // default milliseconds
     * \`\`\`
     * If you want to limit the granularity to a unit other than milliseconds, pass it as the second parameter.
     * \`\`\`
     * dayjs().isBefore('2011-01-01', 'year')// => boolean
     * \`\`\`
     * Units are case insensitive, and support plural and short forms.
     *
     * Docs: https://day.js.org/docs/en/query/is-before
     */
    isBefore(date?: ConfigType, unit?: OpUnitType): boolean
    /**
     * This indicates whether the Day.js object is the same as the other supplied date-time.
     * \`\`\`
     * dayjs().isSame(dayjs('2011-01-01')) // default milliseconds
     * \`\`\`
     * If you want to limit the granularity to a unit other than milliseconds, pass it as the second parameter.
     * \`\`\`
     * dayjs().isSame('2011-01-01', 'year')// => boolean
     * \`\`\`
     * Docs: https://day.js.org/docs/en/query/is-same
     */
    isSame(date?: ConfigType, unit?: OpUnitType): boolean
    /**
     * This indicates whether the Day.js object is after the other supplied date-time.
     * \`\`\`
     * dayjs().isAfter(dayjs('2011-01-01')) // default milliseconds
     * \`\`\`
     * If you want to limit the granularity to a unit other than milliseconds, pass it as the second parameter.
     * \`\`\`
     * dayjs().isAfter('2011-01-01', 'year')// => boolean
     * \`\`\`
     * Units are case insensitive, and support plural and short forms.
     *
     * Docs: https://day.js.org/docs/en/query/is-after
     */
    isAfter(date?: ConfigType, unit?: OpUnitType): boolean

    locale(): string

    locale(preset: string | ILocale, object?: Partial<ILocale>): Dayjs
  }

  export type PluginFunc<T = unknown> = (option: T, c: typeof Dayjs, d: typeof dayjs) => void

  export function extend<T = unknown>(plugin: PluginFunc<T>, option?: T): Dayjs

  export function locale(preset?: string | ILocale, object?: Partial<ILocale>, isLocal?: boolean): string

  export function isDayjs(d: any): d is Dayjs

  export function unix(t: number): Dayjs

  const Ls : { [key: string] :  ILocale }
}
`,o2e=`import zen from 'zen';

/** @type {Handler} **/
export const handler = async (input) => {
  return input;
};
`,r2e=`declare namespace console {
  function log(...args: any[]): void;
  async function sleep(durationMs: number): Promise<void>;
}

interface Config {
  readonly maxDepth: number;
  readonly iteration: number;
  readonly trace: boolean;
}

declare const config: Config;
`,a2e=`declare class HttpResponse {
  readonly data: any;
  readonly headers: Record<string, string>;
  readonly status: number;
}

interface HttpConfig {
  headers?: Record<string, string>;
  params?: Record<string, string>;
  data?: any;
}

class Http {
  head(url: string, config?: HttpConfig): Promise<HttpResponse>;

  get(url: string, config?: HttpConfig): Promise<HttpResponse>;

  delete(url: string, config?: HttpConfig): Promise<HttpResponse>;

  post(url: string, data: any, config?: HttpConfig): Promise<HttpResponse>;

  patch(url: string, data: any, config?: HttpConfig): Promise<HttpResponse>;

  put(url: string, data: any, config?: HttpConfig): Promise<HttpResponse>;
}

export interface HttpStatic extends Http {}

declare const http: HttpStatic;
export default http;
`,l2e=`interface EvaluateOptions {
  trace?: boolean;
}

interface EvaluateResponse {
  performance: string;
  result: any;
  trace?: any;
}

interface ZenModule {
  /**
   * Evaluates ZEN expression
   * @param expression
   * @param context Must contain '$' key
   */
  evaluateExpression(expression: string, context: any): any;

  /**
   * Evaluates ZEN unary expression
   * @param expression
   * @param context Must contain '$' key
   */
  evaluateUnaryExpression(expression: string, context: any): boolean;

  /**
   * Evaluates ZEN unary expression
   * @param key File key to be evaluated through DecisionLoader
   * @param context
   * @param opts
   */
  evaluate(key: string, context: any, opts?: EvaluateOptions): Promise<EvaluateResponse>;
}

declare const zenModule: ZenModule;

export default zenModule;
`,c2e=`declare type Primitive = string | number | symbol | bigint | boolean | null | undefined;
declare type Scalars = Primitive | Primitive[];

declare namespace util {
  type AssertEqual<T, U> = (<V>() => V extends T ? 1 : 2) extends <V>() => V extends U ? 1 : 2 ? true : false;
  export type isAny<T> = 0 extends 1 & T ? true : false;
  export const assertEqual: <A, B>(val: AssertEqual<A, B>) => AssertEqual<A, B>;
  export function assertIs<T>(_arg: T): void;
  export function assertNever(_x: never): never;
  export type Omit<T, K extends keyof T> = Pick<T, Exclude<keyof T, K>>;
  export type OmitKeys<T, K extends string> = Pick<T, Exclude<keyof T, K>>;
  export type MakePartial<T, K extends keyof T> = Omit<T, K> & Partial<Pick<T, K>>;
  export type Exactly<T, X> = T & Record<Exclude<keyof X, keyof T>, never>;
  export const arrayToEnum: <T extends string, U extends [T, ...T[]]>(items: U) => { [k in U[number]]: k };
  export const getValidEnumValues: (obj: any) => any[];
  export const objectValues: (obj: any) => any[];
  export const objectKeys: ObjectConstructor['keys'];
  export const find: <T>(arr: T[], checker: (arg: T) => any) => T | undefined;
  export type identity<T> = objectUtil.identity<T>;
  export type flatten<T> = objectUtil.flatten<T>;
  export type noUndefined<T> = T extends undefined ? never : T;
  export const isInteger: NumberConstructor['isInteger'];
  export function joinValues<T extends any[]>(array: T, separator?: string): string;
  export const jsonStringifyReplacer: (_: string, value: any) => any;
  export {};
}
declare namespace objectUtil {
  export type MergeShapes<U, V> = {
    [k in Exclude<keyof U, keyof V>]: U[k];
  } & V;
  type optionalKeys<T extends object> = {
    [k in keyof T]: undefined extends T[k] ? k : never;
  }[keyof T];
  type requiredKeys<T extends object> = {
    [k in keyof T]: undefined extends T[k] ? never : k;
  }[keyof T];
  export type addQuestionMarks<T extends object, _O = any> = {
    [K in requiredKeys<T>]: T[K];
  } & {
    [K in optionalKeys<T>]?: T[K];
  } & {
    [k in keyof T]?: unknown;
  };
  export type identity<T> = T;
  export type flatten<T> = identity<{
    [k in keyof T]: T[k];
  }>;
  export type noNeverKeys<T> = {
    [k in keyof T]: [T[k]] extends [never] ? never : k;
  }[keyof T];
  export type noNever<T> = identity<{
    [k in noNeverKeys<T>]: k extends keyof T ? T[k] : never;
  }>;
  export const mergeShapes: <U, T>(first: U, second: T) => T & U;
  export type extendShape<A extends object, B extends object> = {
    [K in keyof A as K extends keyof B ? never : K]: A[K];
  } & {
    [K in keyof B]: B[K];
  };
  export {};
}
declare const ZodParsedType: {
  function: 'function';
  number: 'number';
  string: 'string';
  nan: 'nan';
  integer: 'integer';
  float: 'float';
  boolean: 'boolean';
  date: 'date';
  bigint: 'bigint';
  symbol: 'symbol';
  undefined: 'undefined';
  null: 'null';
  array: 'array';
  object: 'object';
  unknown: 'unknown';
  promise: 'promise';
  void: 'void';
  never: 'never';
  map: 'map';
  set: 'set';
};
declare type ZodParsedType = keyof typeof ZodParsedType;
declare const getParsedType: (data: any) => ZodParsedType;

declare type allKeys<T> = T extends any ? keyof T : never;
declare type inferFlattenedErrors<T extends ZodType<any, any, any>, U = string> = typeToFlattenedError<TypeOf<T>, U>;
declare type typeToFlattenedError<T, U = string> = {
  formErrors: U[];
  fieldErrors: {
    [P in allKeys<T>]?: U[];
  };
};
declare const ZodIssueCode: {
  invalid_type: 'invalid_type';
  invalid_literal: 'invalid_literal';
  custom: 'custom';
  invalid_union: 'invalid_union';
  invalid_union_discriminator: 'invalid_union_discriminator';
  invalid_enum_value: 'invalid_enum_value';
  unrecognized_keys: 'unrecognized_keys';
  invalid_arguments: 'invalid_arguments';
  invalid_return_type: 'invalid_return_type';
  invalid_date: 'invalid_date';
  invalid_string: 'invalid_string';
  too_small: 'too_small';
  too_big: 'too_big';
  invalid_intersection_types: 'invalid_intersection_types';
  not_multiple_of: 'not_multiple_of';
  not_finite: 'not_finite';
};
declare type ZodIssueCode = keyof typeof ZodIssueCode;
declare type ZodIssueBase = {
  path: (string | number)[];
  message?: string;
};
interface ZodInvalidTypeIssue extends ZodIssueBase {
  code: typeof ZodIssueCode.invalid_type;
  expected: ZodParsedType;
  received: ZodParsedType;
}
interface ZodInvalidLiteralIssue extends ZodIssueBase {
  code: typeof ZodIssueCode.invalid_literal;
  expected: unknown;
  received: unknown;
}
interface ZodUnrecognizedKeysIssue extends ZodIssueBase {
  code: typeof ZodIssueCode.unrecognized_keys;
  keys: string[];
}
interface ZodInvalidUnionIssue extends ZodIssueBase {
  code: typeof ZodIssueCode.invalid_union;
  unionErrors: ZodError[];
}
interface ZodInvalidUnionDiscriminatorIssue extends ZodIssueBase {
  code: typeof ZodIssueCode.invalid_union_discriminator;
  options: Primitive[];
}
interface ZodInvalidEnumValueIssue extends ZodIssueBase {
  received: string | number;
  code: typeof ZodIssueCode.invalid_enum_value;
  options: (string | number)[];
}
interface ZodInvalidArgumentsIssue extends ZodIssueBase {
  code: typeof ZodIssueCode.invalid_arguments;
  argumentsError: ZodError;
}
interface ZodInvalidReturnTypeIssue extends ZodIssueBase {
  code: typeof ZodIssueCode.invalid_return_type;
  returnTypeError: ZodError;
}
interface ZodInvalidDateIssue extends ZodIssueBase {
  code: typeof ZodIssueCode.invalid_date;
}
declare type StringValidation =
  | 'email'
  | 'url'
  | 'emoji'
  | 'uuid'
  | 'nanoid'
  | 'regex'
  | 'cuid'
  | 'cuid2'
  | 'ulid'
  | 'datetime'
  | 'date'
  | 'time'
  | 'duration'
  | 'ip'
  | 'base64'
  | {
      includes: string;
      position?: number;
    }
  | {
      startsWith: string;
    }
  | {
      endsWith: string;
    };
interface ZodInvalidStringIssue extends ZodIssueBase {
  code: typeof ZodIssueCode.invalid_string;
  validation: StringValidation;
}
interface ZodTooSmallIssue extends ZodIssueBase {
  code: typeof ZodIssueCode.too_small;
  minimum: number | bigint;
  inclusive: boolean;
  exact?: boolean;
  type: 'array' | 'string' | 'number' | 'set' | 'date' | 'bigint';
}
interface ZodTooBigIssue extends ZodIssueBase {
  code: typeof ZodIssueCode.too_big;
  maximum: number | bigint;
  inclusive: boolean;
  exact?: boolean;
  type: 'array' | 'string' | 'number' | 'set' | 'date' | 'bigint';
}
interface ZodInvalidIntersectionTypesIssue extends ZodIssueBase {
  code: typeof ZodIssueCode.invalid_intersection_types;
}
interface ZodNotMultipleOfIssue extends ZodIssueBase {
  code: typeof ZodIssueCode.not_multiple_of;
  multipleOf: number | bigint;
}
interface ZodNotFiniteIssue extends ZodIssueBase {
  code: typeof ZodIssueCode.not_finite;
}
interface ZodCustomIssue extends ZodIssueBase {
  code: typeof ZodIssueCode.custom;
  params?: {
    [k: string]: any;
  };
}
declare type DenormalizedError = {
  [k: string]: DenormalizedError | string[];
};
declare type ZodIssueOptionalMessage =
  | ZodInvalidTypeIssue
  | ZodInvalidLiteralIssue
  | ZodUnrecognizedKeysIssue
  | ZodInvalidUnionIssue
  | ZodInvalidUnionDiscriminatorIssue
  | ZodInvalidEnumValueIssue
  | ZodInvalidArgumentsIssue
  | ZodInvalidReturnTypeIssue
  | ZodInvalidDateIssue
  | ZodInvalidStringIssue
  | ZodTooSmallIssue
  | ZodTooBigIssue
  | ZodInvalidIntersectionTypesIssue
  | ZodNotMultipleOfIssue
  | ZodNotFiniteIssue
  | ZodCustomIssue;
declare type ZodIssue = ZodIssueOptionalMessage & {
  fatal?: boolean;
  message: string;
};
declare const quotelessJson: (obj: any) => string;
declare type recursiveZodFormattedError<T> = T extends [any, ...any[]]
  ? {
      [K in keyof T]?: ZodFormattedError<T[K]>;
    }
  : T extends any[]
    ? {
        [k: number]: ZodFormattedError<T[number]>;
      }
    : T extends object
      ? {
          [K in keyof T]?: ZodFormattedError<T[K]>;
        }
      : unknown;
declare type ZodFormattedError<T, U = string> = {
  _errors: U[];
} & recursiveZodFormattedError<NonNullable<T>>;
declare type inferFormattedError<T extends ZodType<any, any, any>, U = string> = ZodFormattedError<TypeOf<T>, U>;
declare class ZodError<T = any> extends Error {
  issues: ZodIssue[];
  get errors(): ZodIssue[];
  constructor(issues: ZodIssue[]);
  format(): ZodFormattedError<T>;
  format<U>(mapper: (issue: ZodIssue) => U): ZodFormattedError<T, U>;
  static create: (issues: ZodIssue[]) => ZodError<any>;
  static assert(value: unknown): asserts value is ZodError;
  toString(): string;
  get message(): string;
  get isEmpty(): boolean;
  addIssue: (sub: ZodIssue) => void;
  addIssues: (subs?: ZodIssue[]) => void;
  flatten(): typeToFlattenedError<T>;
  flatten<U>(mapper?: (issue: ZodIssue) => U): typeToFlattenedError<T, U>;
  get formErrors(): typeToFlattenedError<T, string>;
}
declare type stripPath<T extends object> = T extends any ? util.OmitKeys<T, 'path'> : never;
declare type IssueData = stripPath<ZodIssueOptionalMessage> & {
  path?: (string | number)[];
  fatal?: boolean;
};
declare type ErrorMapCtx = {
  defaultError: string;
  data: any;
};
declare type ZodErrorMap = (
  issue: ZodIssueOptionalMessage,
  _ctx: ErrorMapCtx,
) => {
  message: string;
};

declare const errorMap: ZodErrorMap;
//# sourceMappingURL=en.d.ts.map

declare function setErrorMap(map: ZodErrorMap): void;
declare function getErrorMap(): ZodErrorMap;

declare const makeIssue: (params: {
  data: any;
  path: (string | number)[];
  errorMaps: ZodErrorMap[];
  issueData: IssueData;
}) => ZodIssue;
declare type ParseParams = {
  path: (string | number)[];
  errorMap: ZodErrorMap;
  async: boolean;
};
declare type ParsePathComponent = string | number;
declare type ParsePath = ParsePathComponent[];
declare const EMPTY_PATH: ParsePath;
interface ParseContext {
  readonly common: {
    readonly issues: ZodIssue[];
    readonly contextualErrorMap?: ZodErrorMap;
    readonly async: boolean;
  };
  readonly path: ParsePath;
  readonly schemaErrorMap?: ZodErrorMap;
  readonly parent: ParseContext | null;
  readonly data: any;
  readonly parsedType: ZodParsedType;
}
declare type ParseInput = {
  data: any;
  path: (string | number)[];
  parent: ParseContext;
};
declare function addIssueToContext(ctx: ParseContext, issueData: IssueData): void;
declare type ObjectPair = {
  key: SyncParseReturnType<any>;
  value: SyncParseReturnType<any>;
};
declare class ParseStatus {
  value: 'aborted' | 'dirty' | 'valid';
  dirty(): void;
  abort(): void;
  static mergeArray(status: ParseStatus, results: SyncParseReturnType<any>[]): SyncParseReturnType;
  static mergeObjectAsync(
    status: ParseStatus,
    pairs: {
      key: ParseReturnType<any>;
      value: ParseReturnType<any>;
    }[],
  ): Promise<SyncParseReturnType<any>>;
  static mergeObjectSync(
    status: ParseStatus,
    pairs: {
      key: SyncParseReturnType<any>;
      value: SyncParseReturnType<any>;
      alwaysSet?: boolean;
    }[],
  ): SyncParseReturnType;
}
interface ParseResult {
  status: 'aborted' | 'dirty' | 'valid';
  data: any;
}
declare type INVALID = {
  status: 'aborted';
};
declare const INVALID: INVALID;
declare type DIRTY<T> = {
  status: 'dirty';
  value: T;
};
declare const DIRTY: <T>(value: T) => DIRTY<T>;
declare type OK<T> = {
  status: 'valid';
  value: T;
};
declare const OK: <T>(value: T) => OK<T>;
declare type SyncParseReturnType<T = any> = OK<T> | DIRTY<T> | INVALID;
declare type AsyncParseReturnType<T> = Promise<SyncParseReturnType<T>>;
declare type ParseReturnType<T> = SyncParseReturnType<T> | AsyncParseReturnType<T>;
declare const isAborted: (x: ParseReturnType<any>) => x is INVALID;
declare const isDirty: <T>(x: ParseReturnType<T>) => x is OK<T> | DIRTY<T>;
declare const isValid: <T>(x: ParseReturnType<T>) => x is OK<T>;
declare const isAsync: <T>(x: ParseReturnType<T>) => x is AsyncParseReturnType<T>;

declare namespace enumUtil {
  type UnionToIntersectionFn<T> = (T extends unknown ? (k: () => T) => void : never) extends (
    k: infer Intersection,
  ) => void
    ? Intersection
    : never;
  type GetUnionLast<T> = UnionToIntersectionFn<T> extends () => infer Last ? Last : never;
  type UnionToTuple<T, Tuple extends unknown[] = []> = [T] extends [never]
    ? Tuple
    : UnionToTuple<Exclude<T, GetUnionLast<T>>, [GetUnionLast<T>, ...Tuple]>;
  type CastToStringTuple<T> = T extends [string, ...string[]] ? T : never;
  export type UnionToTupleString<T> = CastToStringTuple<UnionToTuple<T>>;
  export {};
}

declare namespace errorUtil {
  type ErrMessage =
    | string
    | {
        message?: string;
      };
  const errToObj: (message?: ErrMessage | undefined) => {
    message?: string | undefined;
  };
  const toString: (message?: ErrMessage | undefined) => string | undefined;
}

declare namespace partialUtil {
  type DeepPartial<T extends ZodTypeAny> =
    T extends ZodObject<ZodRawShape>
      ? ZodObject<
          {
            [k in keyof T['shape']]: ZodOptional<DeepPartial<T['shape'][k]>>;
          },
          T['_def']['unknownKeys'],
          T['_def']['catchall']
        >
      : T extends ZodArray<infer Type, infer Card>
        ? ZodArray<DeepPartial<Type>, Card>
        : T extends ZodOptional<infer Type>
          ? ZodOptional<DeepPartial<Type>>
          : T extends ZodNullable<infer Type>
            ? ZodNullable<DeepPartial<Type>>
            : T extends ZodTuple<infer Items>
              ? {
                  [k in keyof Items]: Items[k] extends ZodTypeAny ? DeepPartial<Items[k]> : never;
                } extends infer PI
                ? PI extends ZodTupleItems
                  ? ZodTuple<PI>
                  : never
                : never
              : T;
}

interface RefinementCtx {
  addIssue: (arg: IssueData) => void;
  path: (string | number)[];
}
declare type ZodRawShape = {
  [k: string]: ZodTypeAny;
};
declare type ZodTypeAny = ZodType<any, any, any>;
declare type TypeOf<T extends ZodType<any, any, any>> = T['_output'];
declare type input<T extends ZodType<any, any, any>> = T['_input'];
declare type output<T extends ZodType<any, any, any>> = T['_output'];

declare type CustomErrorParams = Partial<util.Omit<ZodCustomIssue, 'code'>>;
interface ZodTypeDef {
  errorMap?: ZodErrorMap;
  description?: string;
}
declare type RawCreateParams =
  | {
      errorMap?: ZodErrorMap;
      invalid_type_error?: string;
      required_error?: string;
      message?: string;
      description?: string;
    }
  | undefined;
declare type ProcessedCreateParams = {
  errorMap?: ZodErrorMap;
  description?: string;
};
declare type SafeParseSuccess<Output> = {
  success: true;
  data: Output;
  error?: never;
};
declare type SafeParseError<Input> = {
  success: false;
  error: ZodError<Input>;
  data?: never;
};
declare type SafeParseReturnType<Input, Output> = SafeParseSuccess<Output> | SafeParseError<Input>;
declare abstract class ZodType<Output = any, Def extends ZodTypeDef = ZodTypeDef, Input = Output> {
  readonly _type: Output;
  readonly _output: Output;
  readonly _input: Input;
  readonly _def: Def;
  get description(): string | undefined;
  abstract _parse(input: ParseInput): ParseReturnType<Output>;
  _getType(input: ParseInput): string;
  _getOrReturnCtx(input: ParseInput, ctx?: ParseContext | undefined): ParseContext;
  _processInputParams(input: ParseInput): {
    status: ParseStatus;
    ctx: ParseContext;
  };
  _parseSync(input: ParseInput): SyncParseReturnType<Output>;
  _parseAsync(input: ParseInput): AsyncParseReturnType<Output>;
  parse(data: unknown, params?: Partial<ParseParams>): Output;
  safeParse(data: unknown, params?: Partial<ParseParams>): SafeParseReturnType<Input, Output>;
  parseAsync(data: unknown, params?: Partial<ParseParams>): Promise<Output>;
  safeParseAsync(data: unknown, params?: Partial<ParseParams>): Promise<SafeParseReturnType<Input, Output>>;
  /** Alias of safeParseAsync */
  spa: (data: unknown, params?: Partial<ParseParams> | undefined) => Promise<SafeParseReturnType<Input, Output>>;
  refine<RefinedOutput extends Output>(
    check: (arg: Output) => arg is RefinedOutput,
    message?: string | CustomErrorParams | ((arg: Output) => CustomErrorParams),
  ): ZodEffects<this, RefinedOutput, Input>;
  refine(
    check: (arg: Output) => unknown | Promise<unknown>,
    message?: string | CustomErrorParams | ((arg: Output) => CustomErrorParams),
  ): ZodEffects<this, Output, Input>;
  refinement<RefinedOutput extends Output>(
    check: (arg: Output) => arg is RefinedOutput,
    refinementData: IssueData | ((arg: Output, ctx: RefinementCtx) => IssueData),
  ): ZodEffects<this, RefinedOutput, Input>;
  refinement(
    check: (arg: Output) => boolean,
    refinementData: IssueData | ((arg: Output, ctx: RefinementCtx) => IssueData),
  ): ZodEffects<this, Output, Input>;
  _refinement(refinement: RefinementEffect<Output>['refinement']): ZodEffects<this, Output, Input>;
  superRefine<RefinedOutput extends Output>(
    refinement: (arg: Output, ctx: RefinementCtx) => arg is RefinedOutput,
  ): ZodEffects<this, RefinedOutput, Input>;
  superRefine(refinement: (arg: Output, ctx: RefinementCtx) => void): ZodEffects<this, Output, Input>;
  superRefine(refinement: (arg: Output, ctx: RefinementCtx) => Promise<void>): ZodEffects<this, Output, Input>;
  constructor(def: Def);
  optional(): ZodOptional<this>;
  nullable(): ZodNullable<this>;
  nullish(): ZodOptional<ZodNullable<this>>;
  array(): ZodArray<this>;
  promise(): ZodPromise<this>;
  or<T extends ZodTypeAny>(option: T): ZodUnion<[this, T]>;
  and<T extends ZodTypeAny>(incoming: T): ZodIntersection<this, T>;
  transform<NewOut>(transform: (arg: Output, ctx: RefinementCtx) => NewOut | Promise<NewOut>): ZodEffects<this, NewOut>;
  default(def: util.noUndefined<Input>): ZodDefault<this>;
  default(def: () => util.noUndefined<Input>): ZodDefault<this>;
  brand<B extends string | number | symbol>(brand?: B): ZodBranded<this, B>;
  catch(def: Output): ZodCatch<this>;
  catch(def: (ctx: { error: ZodError; input: Input }) => Output): ZodCatch<this>;
  describe(description: string): this;
  pipe<T extends ZodTypeAny>(target: T): ZodPipeline<this, T>;
  readonly(): ZodReadonly<this>;
  isOptional(): boolean;
  isNullable(): boolean;
}
declare type IpVersion = 'v4' | 'v6';
declare type ZodStringCheck =
  | {
      kind: 'min';
      value: number;
      message?: string;
    }
  | {
      kind: 'max';
      value: number;
      message?: string;
    }
  | {
      kind: 'length';
      value: number;
      message?: string;
    }
  | {
      kind: 'email';
      message?: string;
    }
  | {
      kind: 'url';
      message?: string;
    }
  | {
      kind: 'emoji';
      message?: string;
    }
  | {
      kind: 'uuid';
      message?: string;
    }
  | {
      kind: 'nanoid';
      message?: string;
    }
  | {
      kind: 'cuid';
      message?: string;
    }
  | {
      kind: 'includes';
      value: string;
      position?: number;
      message?: string;
    }
  | {
      kind: 'cuid2';
      message?: string;
    }
  | {
      kind: 'ulid';
      message?: string;
    }
  | {
      kind: 'startsWith';
      value: string;
      message?: string;
    }
  | {
      kind: 'endsWith';
      value: string;
      message?: string;
    }
  | {
      kind: 'regex';
      regex: RegExp;
      message?: string;
    }
  | {
      kind: 'trim';
      message?: string;
    }
  | {
      kind: 'toLowerCase';
      message?: string;
    }
  | {
      kind: 'toUpperCase';
      message?: string;
    }
  | {
      kind: 'datetime';
      offset: boolean;
      local: boolean;
      precision: number | null;
      message?: string;
    }
  | {
      kind: 'date';
      message?: string;
    }
  | {
      kind: 'time';
      precision: number | null;
      message?: string;
    }
  | {
      kind: 'duration';
      message?: string;
    }
  | {
      kind: 'ip';
      version?: IpVersion;
      message?: string;
    }
  | {
      kind: 'base64';
      message?: string;
    };
interface ZodStringDef extends ZodTypeDef {
  checks: ZodStringCheck[];
  typeName: ZodFirstPartyTypeKind.ZodString;
  coerce: boolean;
}
declare function datetimeRegex(args: { precision?: number | null; offset?: boolean; local?: boolean }): RegExp;
declare class ZodString extends ZodType<string, ZodStringDef, string> {
  _parse(input: ParseInput): ParseReturnType<string>;
  protected _regex(
    regex: RegExp,
    validation: StringValidation,
    message?: errorUtil.ErrMessage,
  ): ZodEffects<this, string, string>;
  _addCheck(check: ZodStringCheck): ZodString;
  email(message?: errorUtil.ErrMessage): ZodString;
  url(message?: errorUtil.ErrMessage): ZodString;
  emoji(message?: errorUtil.ErrMessage): ZodString;
  uuid(message?: errorUtil.ErrMessage): ZodString;
  nanoid(message?: errorUtil.ErrMessage): ZodString;
  cuid(message?: errorUtil.ErrMessage): ZodString;
  cuid2(message?: errorUtil.ErrMessage): ZodString;
  ulid(message?: errorUtil.ErrMessage): ZodString;
  base64(message?: errorUtil.ErrMessage): ZodString;
  ip(
    options?:
      | string
      | {
          version?: 'v4' | 'v6';
          message?: string;
        },
  ): ZodString;
  datetime(
    options?:
      | string
      | {
          message?: string | undefined;
          precision?: number | null;
          offset?: boolean;
          local?: boolean;
        },
  ): ZodString;
  date(message?: string): ZodString;
  time(
    options?:
      | string
      | {
          message?: string | undefined;
          precision?: number | null;
        },
  ): ZodString;
  duration(message?: errorUtil.ErrMessage): ZodString;
  regex(regex: RegExp, message?: errorUtil.ErrMessage): ZodString;
  includes(
    value: string,
    options?: {
      message?: string;
      position?: number;
    },
  ): ZodString;
  startsWith(value: string, message?: errorUtil.ErrMessage): ZodString;
  endsWith(value: string, message?: errorUtil.ErrMessage): ZodString;
  min(minLength: number, message?: errorUtil.ErrMessage): ZodString;
  max(maxLength: number, message?: errorUtil.ErrMessage): ZodString;
  length(len: number, message?: errorUtil.ErrMessage): ZodString;
  /**
   * @deprecated Use z.string().min(1) instead.
   * @see {@link ZodString.min}
   */
  nonempty(message?: errorUtil.ErrMessage): ZodString;
  trim(): ZodString;
  toLowerCase(): ZodString;
  toUpperCase(): ZodString;
  get isDatetime(): boolean;
  get isDate(): boolean;
  get isTime(): boolean;
  get isDuration(): boolean;
  get isEmail(): boolean;
  get isURL(): boolean;
  get isEmoji(): boolean;
  get isUUID(): boolean;
  get isNANOID(): boolean;
  get isCUID(): boolean;
  get isCUID2(): boolean;
  get isULID(): boolean;
  get isIP(): boolean;
  get isBase64(): boolean;
  get minLength(): number | null;
  get maxLength(): number | null;
  static create: (
    params?:
      | ({
          errorMap?: ZodErrorMap | undefined;
          invalid_type_error?: string | undefined;
          required_error?: string | undefined;
          message?: string | undefined;
          description?: string | undefined;
        } & {
          coerce?: true | undefined;
        })
      | undefined,
  ) => ZodString;
}
declare type ZodNumberCheck =
  | {
      kind: 'min';
      value: number;
      inclusive: boolean;
      message?: string;
    }
  | {
      kind: 'max';
      value: number;
      inclusive: boolean;
      message?: string;
    }
  | {
      kind: 'int';
      message?: string;
    }
  | {
      kind: 'multipleOf';
      value: number;
      message?: string;
    }
  | {
      kind: 'finite';
      message?: string;
    };
interface ZodNumberDef extends ZodTypeDef {
  checks: ZodNumberCheck[];
  typeName: ZodFirstPartyTypeKind.ZodNumber;
  coerce: boolean;
}
declare class ZodNumber extends ZodType<number, ZodNumberDef, number> {
  _parse(input: ParseInput): ParseReturnType<number>;
  static create: (
    params?:
      | ({
          errorMap?: ZodErrorMap | undefined;
          invalid_type_error?: string | undefined;
          required_error?: string | undefined;
          message?: string | undefined;
          description?: string | undefined;
        } & {
          coerce?: boolean | undefined;
        })
      | undefined,
  ) => ZodNumber;
  gte(value: number, message?: errorUtil.ErrMessage): ZodNumber;
  min: (value: number, message?: errorUtil.ErrMessage | undefined) => ZodNumber;
  gt(value: number, message?: errorUtil.ErrMessage): ZodNumber;
  lte(value: number, message?: errorUtil.ErrMessage): ZodNumber;
  max: (value: number, message?: errorUtil.ErrMessage | undefined) => ZodNumber;
  lt(value: number, message?: errorUtil.ErrMessage): ZodNumber;
  protected setLimit(kind: 'min' | 'max', value: number, inclusive: boolean, message?: string): ZodNumber;
  _addCheck(check: ZodNumberCheck): ZodNumber;
  int(message?: errorUtil.ErrMessage): ZodNumber;
  positive(message?: errorUtil.ErrMessage): ZodNumber;
  negative(message?: errorUtil.ErrMessage): ZodNumber;
  nonpositive(message?: errorUtil.ErrMessage): ZodNumber;
  nonnegative(message?: errorUtil.ErrMessage): ZodNumber;
  multipleOf(value: number, message?: errorUtil.ErrMessage): ZodNumber;
  step: (value: number, message?: errorUtil.ErrMessage | undefined) => ZodNumber;
  finite(message?: errorUtil.ErrMessage): ZodNumber;
  safe(message?: errorUtil.ErrMessage): ZodNumber;
  get minValue(): number | null;
  get maxValue(): number | null;
  get isInt(): boolean;
  get isFinite(): boolean;
}
declare type ZodBigIntCheck =
  | {
      kind: 'min';
      value: bigint;
      inclusive: boolean;
      message?: string;
    }
  | {
      kind: 'max';
      value: bigint;
      inclusive: boolean;
      message?: string;
    }
  | {
      kind: 'multipleOf';
      value: bigint;
      message?: string;
    };
interface ZodBigIntDef extends ZodTypeDef {
  checks: ZodBigIntCheck[];
  typeName: ZodFirstPartyTypeKind.ZodBigInt;
  coerce: boolean;
}
declare class ZodBigInt extends ZodType<bigint, ZodBigIntDef, bigint> {
  _parse(input: ParseInput): ParseReturnType<bigint>;
  static create: (
    params?:
      | ({
          errorMap?: ZodErrorMap | undefined;
          invalid_type_error?: string | undefined;
          required_error?: string | undefined;
          message?: string | undefined;
          description?: string | undefined;
        } & {
          coerce?: boolean | undefined;
        })
      | undefined,
  ) => ZodBigInt;
  gte(value: bigint, message?: errorUtil.ErrMessage): ZodBigInt;
  min: (value: bigint, message?: errorUtil.ErrMessage | undefined) => ZodBigInt;
  gt(value: bigint, message?: errorUtil.ErrMessage): ZodBigInt;
  lte(value: bigint, message?: errorUtil.ErrMessage): ZodBigInt;
  max: (value: bigint, message?: errorUtil.ErrMessage | undefined) => ZodBigInt;
  lt(value: bigint, message?: errorUtil.ErrMessage): ZodBigInt;
  protected setLimit(kind: 'min' | 'max', value: bigint, inclusive: boolean, message?: string): ZodBigInt;
  _addCheck(check: ZodBigIntCheck): ZodBigInt;
  positive(message?: errorUtil.ErrMessage): ZodBigInt;
  negative(message?: errorUtil.ErrMessage): ZodBigInt;
  nonpositive(message?: errorUtil.ErrMessage): ZodBigInt;
  nonnegative(message?: errorUtil.ErrMessage): ZodBigInt;
  multipleOf(value: bigint, message?: errorUtil.ErrMessage): ZodBigInt;
  get minValue(): bigint | null;
  get maxValue(): bigint | null;
}
interface ZodBooleanDef extends ZodTypeDef {
  typeName: ZodFirstPartyTypeKind.ZodBoolean;
  coerce: boolean;
}
declare class ZodBoolean extends ZodType<boolean, ZodBooleanDef, boolean> {
  _parse(input: ParseInput): ParseReturnType<boolean>;
  static create: (
    params?:
      | ({
          errorMap?: ZodErrorMap | undefined;
          invalid_type_error?: string | undefined;
          required_error?: string | undefined;
          message?: string | undefined;
          description?: string | undefined;
        } & {
          coerce?: boolean | undefined;
        })
      | undefined,
  ) => ZodBoolean;
}
declare type ZodDateCheck =
  | {
      kind: 'min';
      value: number;
      message?: string;
    }
  | {
      kind: 'max';
      value: number;
      message?: string;
    };
interface ZodDateDef extends ZodTypeDef {
  checks: ZodDateCheck[];
  coerce: boolean;
  typeName: ZodFirstPartyTypeKind.ZodDate;
}
declare class ZodDate extends ZodType<Date, ZodDateDef, Date> {
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  _addCheck(check: ZodDateCheck): ZodDate;
  min(minDate: Date, message?: errorUtil.ErrMessage): ZodDate;
  max(maxDate: Date, message?: errorUtil.ErrMessage): ZodDate;
  get minDate(): Date | null;
  get maxDate(): Date | null;
  static create: (
    params?:
      | ({
          errorMap?: ZodErrorMap | undefined;
          invalid_type_error?: string | undefined;
          required_error?: string | undefined;
          message?: string | undefined;
          description?: string | undefined;
        } & {
          coerce?: boolean | undefined;
        })
      | undefined,
  ) => ZodDate;
}
interface ZodSymbolDef extends ZodTypeDef {
  typeName: ZodFirstPartyTypeKind.ZodSymbol;
}
declare class ZodSymbol extends ZodType<symbol, ZodSymbolDef, symbol> {
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  static create: (params?: RawCreateParams) => ZodSymbol;
}
interface ZodUndefinedDef extends ZodTypeDef {
  typeName: ZodFirstPartyTypeKind.ZodUndefined;
}
declare class ZodUndefined extends ZodType<undefined, ZodUndefinedDef, undefined> {
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  params?: RawCreateParams;
  static create: (params?: RawCreateParams) => ZodUndefined;
}
interface ZodNullDef extends ZodTypeDef {
  typeName: ZodFirstPartyTypeKind.ZodNull;
}
declare class ZodNull extends ZodType<null, ZodNullDef, null> {
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  static create: (params?: RawCreateParams) => ZodNull;
}
interface ZodAnyDef extends ZodTypeDef {
  typeName: ZodFirstPartyTypeKind.ZodAny;
}
declare class ZodAny extends ZodType<any, ZodAnyDef, any> {
  _any: true;
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  static create: (params?: RawCreateParams) => ZodAny;
}
interface ZodUnknownDef extends ZodTypeDef {
  typeName: ZodFirstPartyTypeKind.ZodUnknown;
}
declare class ZodUnknown extends ZodType<unknown, ZodUnknownDef, unknown> {
  _unknown: true;
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  static create: (params?: RawCreateParams) => ZodUnknown;
}
interface ZodNeverDef extends ZodTypeDef {
  typeName: ZodFirstPartyTypeKind.ZodNever;
}
declare class ZodNever extends ZodType<never, ZodNeverDef, never> {
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  static create: (params?: RawCreateParams) => ZodNever;
}
interface ZodVoidDef extends ZodTypeDef {
  typeName: ZodFirstPartyTypeKind.ZodVoid;
}
declare class ZodVoid extends ZodType<void, ZodVoidDef, void> {
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  static create: (params?: RawCreateParams) => ZodVoid;
}
interface ZodArrayDef<T extends ZodTypeAny = ZodTypeAny> extends ZodTypeDef {
  type: T;
  typeName: ZodFirstPartyTypeKind.ZodArray;
  exactLength: {
    value: number;
    message?: string;
  } | null;
  minLength: {
    value: number;
    message?: string;
  } | null;
  maxLength: {
    value: number;
    message?: string;
  } | null;
}
declare type ArrayCardinality = 'many' | 'atleastone';
declare type arrayOutputType<
  T extends ZodTypeAny,
  Cardinality extends ArrayCardinality = 'many',
> = Cardinality extends 'atleastone' ? [T['_output'], ...T['_output'][]] : T['_output'][];
declare class ZodArray<T extends ZodTypeAny, Cardinality extends ArrayCardinality = 'many'> extends ZodType<
  arrayOutputType<T, Cardinality>,
  ZodArrayDef<T>,
  Cardinality extends 'atleastone' ? [T['_input'], ...T['_input'][]] : T['_input'][]
> {
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  get element(): T;
  min(minLength: number, message?: errorUtil.ErrMessage): this;
  max(maxLength: number, message?: errorUtil.ErrMessage): this;
  length(len: number, message?: errorUtil.ErrMessage): this;
  nonempty(message?: errorUtil.ErrMessage): ZodArray<T, 'atleastone'>;
  static create: <T_1 extends ZodTypeAny>(schema: T_1, params?: RawCreateParams) => ZodArray<T_1, 'many'>;
}
declare type ZodNonEmptyArray<T extends ZodTypeAny> = ZodArray<T, 'atleastone'>;
declare type UnknownKeysParam = 'passthrough' | 'strict' | 'strip';
interface ZodObjectDef<
  T extends ZodRawShape = ZodRawShape,
  UnknownKeys extends UnknownKeysParam = UnknownKeysParam,
  Catchall extends ZodTypeAny = ZodTypeAny,
> extends ZodTypeDef {
  typeName: ZodFirstPartyTypeKind.ZodObject;
  shape: () => T;
  catchall: Catchall;
  unknownKeys: UnknownKeys;
}
declare type mergeTypes<A, B> = {
  [k in keyof A | keyof B]: k extends keyof B ? B[k] : k extends keyof A ? A[k] : never;
};
declare type objectOutputType<
  Shape extends ZodRawShape,
  Catchall extends ZodTypeAny,
  UnknownKeys extends UnknownKeysParam = UnknownKeysParam,
> = objectUtil.flatten<objectUtil.addQuestionMarks<baseObjectOutputType<Shape>>> &
  CatchallOutput<Catchall> &
  PassthroughType<UnknownKeys>;
declare type baseObjectOutputType<Shape extends ZodRawShape> = {
  [k in keyof Shape]: Shape[k]['_output'];
};
declare type objectInputType<
  Shape extends ZodRawShape,
  Catchall extends ZodTypeAny,
  UnknownKeys extends UnknownKeysParam = UnknownKeysParam,
> = objectUtil.flatten<baseObjectInputType<Shape>> & CatchallInput<Catchall> & PassthroughType<UnknownKeys>;
declare type baseObjectInputType<Shape extends ZodRawShape> = objectUtil.addQuestionMarks<{
  [k in keyof Shape]: Shape[k]['_input'];
}>;
declare type CatchallOutput<T extends ZodType> = ZodType extends T
  ? unknown
  : {
      [k: string]: T['_output'];
    };
declare type CatchallInput<T extends ZodType> = ZodType extends T
  ? unknown
  : {
      [k: string]: T['_input'];
    };
declare type PassthroughType<T extends UnknownKeysParam> = T extends 'passthrough'
  ? {
      [k: string]: unknown;
    }
  : unknown;
declare type deoptional<T extends ZodTypeAny> =
  T extends ZodOptional<infer U> ? deoptional<U> : T extends ZodNullable<infer U> ? ZodNullable<deoptional<U>> : T;
declare type SomeZodObject = ZodObject<ZodRawShape, UnknownKeysParam, ZodTypeAny>;
declare type noUnrecognized<Obj extends object, Shape extends object> = {
  [k in keyof Obj]: k extends keyof Shape ? Obj[k] : never;
};
declare class ZodObject<
  T extends ZodRawShape,
  UnknownKeys extends UnknownKeysParam = UnknownKeysParam,
  Catchall extends ZodTypeAny = ZodTypeAny,
  Output = objectOutputType<T, Catchall, UnknownKeys>,
  Input = objectInputType<T, Catchall, UnknownKeys>,
> extends ZodType<Output, ZodObjectDef<T, UnknownKeys, Catchall>, Input> {
  private _cached;
  _getCached(): {
    shape: T;
    keys: string[];
  };
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  get shape(): T;
  strict(message?: errorUtil.ErrMessage): ZodObject<T, 'strict', Catchall>;
  strip(): ZodObject<T, 'strip', Catchall>;
  passthrough(): ZodObject<T, 'passthrough', Catchall>;
  /**
   * @deprecated In most cases, this is no longer needed - unknown properties are now silently stripped.
   * If you want to pass through unknown properties, use \`.passthrough()\` instead.
   */
  nonstrict: () => ZodObject<T, 'passthrough', Catchall>;
  extend<Augmentation extends ZodRawShape>(
    augmentation: Augmentation,
  ): ZodObject<objectUtil.extendShape<T, Augmentation>, UnknownKeys, Catchall>;
  /**
   * @deprecated Use \`.extend\` instead
   *  */
  augment: <Augmentation extends ZodRawShape>(
    augmentation: Augmentation,
  ) => ZodObject<
    objectUtil.extendShape<T, Augmentation>,
    UnknownKeys,
    Catchall,
    objectOutputType<objectUtil.extendShape<T, Augmentation>, Catchall, UnknownKeys>,
    objectInputType<objectUtil.extendShape<T, Augmentation>, Catchall, UnknownKeys>
  >;
  /**
   * Prior to zod@1.0.12 there was a bug in the
   * inferred type of merged objects. Please
   * upgrade if you are experiencing issues.
   */
  merge<Incoming extends AnyZodObject, Augmentation extends Incoming['shape']>(
    merging: Incoming,
  ): ZodObject<objectUtil.extendShape<T, Augmentation>, Incoming['_def']['unknownKeys'], Incoming['_def']['catchall']>;
  setKey<Key extends string, Schema extends ZodTypeAny>(
    key: Key,
    schema: Schema,
  ): ZodObject<
    T & {
      [k in Key]: Schema;
    },
    UnknownKeys,
    Catchall
  >;
  catchall<Index extends ZodTypeAny>(index: Index): ZodObject<T, UnknownKeys, Index>;
  pick<
    Mask extends util.Exactly<
      {
        [k in keyof T]?: true;
      },
      Mask
    >,
  >(mask: Mask): ZodObject<Pick<T, Extract<keyof T, keyof Mask>>, UnknownKeys, Catchall>;
  omit<
    Mask extends util.Exactly<
      {
        [k in keyof T]?: true;
      },
      Mask
    >,
  >(mask: Mask): ZodObject<Omit<T, keyof Mask>, UnknownKeys, Catchall>;
  /**
   * @deprecated
   */
  deepPartial(): partialUtil.DeepPartial<this>;
  partial(): ZodObject<
    {
      [k in keyof T]: ZodOptional<T[k]>;
    },
    UnknownKeys,
    Catchall
  >;
  partial<
    Mask extends util.Exactly<
      {
        [k in keyof T]?: true;
      },
      Mask
    >,
  >(
    mask: Mask,
  ): ZodObject<
    objectUtil.noNever<{
      [k in keyof T]: k extends keyof Mask ? ZodOptional<T[k]> : T[k];
    }>,
    UnknownKeys,
    Catchall
  >;
  required(): ZodObject<
    {
      [k in keyof T]: deoptional<T[k]>;
    },
    UnknownKeys,
    Catchall
  >;
  required<
    Mask extends util.Exactly<
      {
        [k in keyof T]?: true;
      },
      Mask
    >,
  >(
    mask: Mask,
  ): ZodObject<
    objectUtil.noNever<{
      [k in keyof T]: k extends keyof Mask ? deoptional<T[k]> : T[k];
    }>,
    UnknownKeys,
    Catchall
  >;
  keyof(): ZodEnum<enumUtil.UnionToTupleString<keyof T>>;
  static create: <T_1 extends ZodRawShape>(
    shape: T_1,
    params?: RawCreateParams,
  ) => ZodObject<
    T_1,
    'strip',
    ZodTypeAny,
    {
      [k in keyof objectUtil.addQuestionMarks<baseObjectOutputType<T_1>, any>]: objectUtil.addQuestionMarks<
        baseObjectOutputType<T_1>,
        any
      >[k];
    },
    { [k_1 in keyof baseObjectInputType<T_1>]: baseObjectInputType<T_1>[k_1] }
  >;
  static strictCreate: <T_1 extends ZodRawShape>(
    shape: T_1,
    params?: RawCreateParams,
  ) => ZodObject<
    T_1,
    'strict',
    ZodTypeAny,
    {
      [k in keyof objectUtil.addQuestionMarks<baseObjectOutputType<T_1>, any>]: objectUtil.addQuestionMarks<
        baseObjectOutputType<T_1>,
        any
      >[k];
    },
    { [k_1 in keyof baseObjectInputType<T_1>]: baseObjectInputType<T_1>[k_1] }
  >;
  static lazycreate: <T_1 extends ZodRawShape>(
    shape: () => T_1,
    params?: RawCreateParams,
  ) => ZodObject<
    T_1,
    'strip',
    ZodTypeAny,
    {
      [k in keyof objectUtil.addQuestionMarks<baseObjectOutputType<T_1>, any>]: objectUtil.addQuestionMarks<
        baseObjectOutputType<T_1>,
        any
      >[k];
    },
    { [k_1 in keyof baseObjectInputType<T_1>]: baseObjectInputType<T_1>[k_1] }
  >;
}
declare type AnyZodObject = ZodObject<any, any, any>;
declare type ZodUnionOptions = Readonly<[ZodTypeAny, ...ZodTypeAny[]]>;
interface ZodUnionDef<T extends ZodUnionOptions = Readonly<[ZodTypeAny, ZodTypeAny, ...ZodTypeAny[]]>>
  extends ZodTypeDef {
  options: T;
  typeName: ZodFirstPartyTypeKind.ZodUnion;
}
declare class ZodUnion<T extends ZodUnionOptions> extends ZodType<
  T[number]['_output'],
  ZodUnionDef<T>,
  T[number]['_input']
> {
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  get options(): T;
  static create: <T_1 extends readonly [ZodTypeAny, ZodTypeAny, ...ZodTypeAny[]]>(
    types: T_1,
    params?: RawCreateParams,
  ) => ZodUnion<T_1>;
}
declare type ZodDiscriminatedUnionOption<Discriminator extends string> = ZodObject<
  {
    [key in Discriminator]: ZodTypeAny;
  } & ZodRawShape,
  UnknownKeysParam,
  ZodTypeAny
>;
interface ZodDiscriminatedUnionDef<
  Discriminator extends string,
  Options extends ZodDiscriminatedUnionOption<string>[] = ZodDiscriminatedUnionOption<string>[],
> extends ZodTypeDef {
  discriminator: Discriminator;
  options: Options;
  optionsMap: Map<Primitive, ZodDiscriminatedUnionOption<any>>;
  typeName: ZodFirstPartyTypeKind.ZodDiscriminatedUnion;
}
declare class ZodDiscriminatedUnion<
  Discriminator extends string,
  Options extends ZodDiscriminatedUnionOption<Discriminator>[],
> extends ZodType<output<Options[number]>, ZodDiscriminatedUnionDef<Discriminator, Options>, input<Options[number]>> {
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  get discriminator(): Discriminator;
  get options(): Options;
  get optionsMap(): Map<Primitive, ZodDiscriminatedUnionOption<any>>;
  /**
   * The constructor of the discriminated union schema. Its behaviour is very similar to that of the normal z.union() constructor.
   * However, it only allows a union of objects, all of which need to share a discriminator property. This property must
   * have a different value for each object in the union.
   * @param discriminator the name of the discriminator property
   * @param types an array of object schemas
   * @param params
   */
  static create<
    Discriminator extends string,
    Types extends [ZodDiscriminatedUnionOption<Discriminator>, ...ZodDiscriminatedUnionOption<Discriminator>[]],
  >(
    discriminator: Discriminator,
    options: Types,
    params?: RawCreateParams,
  ): ZodDiscriminatedUnion<Discriminator, Types>;
}
interface ZodIntersectionDef<T extends ZodTypeAny = ZodTypeAny, U extends ZodTypeAny = ZodTypeAny> extends ZodTypeDef {
  left: T;
  right: U;
  typeName: ZodFirstPartyTypeKind.ZodIntersection;
}
declare class ZodIntersection<T extends ZodTypeAny, U extends ZodTypeAny> extends ZodType<
  T['_output'] & U['_output'],
  ZodIntersectionDef<T, U>,
  T['_input'] & U['_input']
> {
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  static create: <T_1 extends ZodTypeAny, U_1 extends ZodTypeAny>(
    left: T_1,
    right: U_1,
    params?: RawCreateParams,
  ) => ZodIntersection<T_1, U_1>;
}
declare type ZodTupleItems = [ZodTypeAny, ...ZodTypeAny[]];
declare type AssertArray<T> = T extends any[] ? T : never;
declare type OutputTypeOfTuple<T extends ZodTupleItems | []> = AssertArray<{
  [k in keyof T]: T[k] extends ZodType<any, any, any> ? T[k]['_output'] : never;
}>;
declare type OutputTypeOfTupleWithRest<
  T extends ZodTupleItems | [],
  Rest extends ZodTypeAny | null = null,
> = Rest extends ZodTypeAny ? [...OutputTypeOfTuple<T>, ...Rest['_output'][]] : OutputTypeOfTuple<T>;
declare type InputTypeOfTuple<T extends ZodTupleItems | []> = AssertArray<{
  [k in keyof T]: T[k] extends ZodType<any, any, any> ? T[k]['_input'] : never;
}>;
declare type InputTypeOfTupleWithRest<
  T extends ZodTupleItems | [],
  Rest extends ZodTypeAny | null = null,
> = Rest extends ZodTypeAny ? [...InputTypeOfTuple<T>, ...Rest['_input'][]] : InputTypeOfTuple<T>;
interface ZodTupleDef<T extends ZodTupleItems | [] = ZodTupleItems, Rest extends ZodTypeAny | null = null>
  extends ZodTypeDef {
  items: T;
  rest: Rest;
  typeName: ZodFirstPartyTypeKind.ZodTuple;
}
declare type AnyZodTuple = ZodTuple<[ZodTypeAny, ...ZodTypeAny[]] | [], ZodTypeAny | null>;
declare class ZodTuple<
  T extends [ZodTypeAny, ...ZodTypeAny[]] | [] = [ZodTypeAny, ...ZodTypeAny[]],
  Rest extends ZodTypeAny | null = null,
> extends ZodType<OutputTypeOfTupleWithRest<T, Rest>, ZodTupleDef<T, Rest>, InputTypeOfTupleWithRest<T, Rest>> {
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  get items(): T;
  rest<Rest extends ZodTypeAny>(rest: Rest): ZodTuple<T, Rest>;
  static create: <T_1 extends [] | [ZodTypeAny, ...ZodTypeAny[]]>(
    schemas: T_1,
    params?: RawCreateParams,
  ) => ZodTuple<T_1, null>;
}
interface ZodRecordDef<Key extends KeySchema = ZodString, Value extends ZodTypeAny = ZodTypeAny> extends ZodTypeDef {
  valueType: Value;
  keyType: Key;
  typeName: ZodFirstPartyTypeKind.ZodRecord;
}
declare type KeySchema = ZodType<string | number | symbol, any, any>;
declare type RecordType<K extends string | number | symbol, V> = [string] extends [K]
  ? Record<K, V>
  : [number] extends [K]
    ? Record<K, V>
    : [symbol] extends [K]
      ? Record<K, V>
      : [BRAND<string | number | symbol>] extends [K]
        ? Record<K, V>
        : Partial<Record<K, V>>;
declare class ZodRecord<Key extends KeySchema = ZodString, Value extends ZodTypeAny = ZodTypeAny> extends ZodType<
  RecordType<Key['_output'], Value['_output']>,
  ZodRecordDef<Key, Value>,
  RecordType<Key['_input'], Value['_input']>
> {
  get keySchema(): Key;
  get valueSchema(): Value;
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  get element(): Value;
  static create<Value extends ZodTypeAny>(valueType: Value, params?: RawCreateParams): ZodRecord<ZodString, Value>;
  static create<Keys extends KeySchema, Value extends ZodTypeAny>(
    keySchema: Keys,
    valueType: Value,
    params?: RawCreateParams,
  ): ZodRecord<Keys, Value>;
}
interface ZodMapDef<Key extends ZodTypeAny = ZodTypeAny, Value extends ZodTypeAny = ZodTypeAny> extends ZodTypeDef {
  valueType: Value;
  keyType: Key;
  typeName: ZodFirstPartyTypeKind.ZodMap;
}
declare class ZodMap<Key extends ZodTypeAny = ZodTypeAny, Value extends ZodTypeAny = ZodTypeAny> extends ZodType<
  Map<Key['_output'], Value['_output']>,
  ZodMapDef<Key, Value>,
  Map<Key['_input'], Value['_input']>
> {
  get keySchema(): Key;
  get valueSchema(): Value;
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  static create: <Key_1 extends ZodTypeAny = ZodTypeAny, Value_1 extends ZodTypeAny = ZodTypeAny>(
    keyType: Key_1,
    valueType: Value_1,
    params?: RawCreateParams,
  ) => ZodMap<Key_1, Value_1>;
}
interface ZodSetDef<Value extends ZodTypeAny = ZodTypeAny> extends ZodTypeDef {
  valueType: Value;
  typeName: ZodFirstPartyTypeKind.ZodSet;
  minSize: {
    value: number;
    message?: string;
  } | null;
  maxSize: {
    value: number;
    message?: string;
  } | null;
}
declare class ZodSet<Value extends ZodTypeAny = ZodTypeAny> extends ZodType<
  Set<Value['_output']>,
  ZodSetDef<Value>,
  Set<Value['_input']>
> {
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  min(minSize: number, message?: errorUtil.ErrMessage): this;
  max(maxSize: number, message?: errorUtil.ErrMessage): this;
  size(size: number, message?: errorUtil.ErrMessage): this;
  nonempty(message?: errorUtil.ErrMessage): ZodSet<Value>;
  static create: <Value_1 extends ZodTypeAny = ZodTypeAny>(
    valueType: Value_1,
    params?: RawCreateParams,
  ) => ZodSet<Value_1>;
}
interface ZodFunctionDef<Args extends ZodTuple<any, any> = ZodTuple<any, any>, Returns extends ZodTypeAny = ZodTypeAny>
  extends ZodTypeDef {
  args: Args;
  returns: Returns;
  typeName: ZodFirstPartyTypeKind.ZodFunction;
}
declare type OuterTypeOfFunction<Args extends ZodTuple<any, any>, Returns extends ZodTypeAny> =
  Args['_input'] extends Array<any> ? (...args: Args['_input']) => Returns['_output'] : never;
declare type InnerTypeOfFunction<Args extends ZodTuple<any, any>, Returns extends ZodTypeAny> =
  Args['_output'] extends Array<any> ? (...args: Args['_output']) => Returns['_input'] : never;
declare class ZodFunction<Args extends ZodTuple<any, any>, Returns extends ZodTypeAny> extends ZodType<
  OuterTypeOfFunction<Args, Returns>,
  ZodFunctionDef<Args, Returns>,
  InnerTypeOfFunction<Args, Returns>
> {
  _parse(input: ParseInput): ParseReturnType<any>;
  parameters(): Args;
  returnType(): Returns;
  args<Items extends Parameters<(typeof ZodTuple)['create']>[0]>(
    ...items: Items
  ): ZodFunction<ZodTuple<Items, ZodUnknown>, Returns>;
  returns<NewReturnType extends ZodType<any, any, any>>(returnType: NewReturnType): ZodFunction<Args, NewReturnType>;
  implement<F extends InnerTypeOfFunction<Args, Returns>>(
    func: F,
  ): ReturnType<F> extends Returns['_output']
    ? (...args: Args['_input']) => ReturnType<F>
    : OuterTypeOfFunction<Args, Returns>;
  strictImplement(func: InnerTypeOfFunction<Args, Returns>): InnerTypeOfFunction<Args, Returns>;
  validate: <F extends InnerTypeOfFunction<Args, Returns>>(
    func: F,
  ) => ReturnType<F> extends Returns['_output']
    ? (...args: Args['_input']) => ReturnType<F>
    : OuterTypeOfFunction<Args, Returns>;
  static create(): ZodFunction<ZodTuple<[], ZodUnknown>, ZodUnknown>;
  static create<T extends AnyZodTuple = ZodTuple<[], ZodUnknown>>(args: T): ZodFunction<T, ZodUnknown>;
  static create<T extends AnyZodTuple, U extends ZodTypeAny>(args: T, returns: U): ZodFunction<T, U>;
  static create<T extends AnyZodTuple = ZodTuple<[], ZodUnknown>, U extends ZodTypeAny = ZodUnknown>(
    args: T,
    returns: U,
    params?: RawCreateParams,
  ): ZodFunction<T, U>;
}
interface ZodLazyDef<T extends ZodTypeAny = ZodTypeAny> extends ZodTypeDef {
  getter: () => T;
  typeName: ZodFirstPartyTypeKind.ZodLazy;
}
declare class ZodLazy<T extends ZodTypeAny> extends ZodType<output<T>, ZodLazyDef<T>, input<T>> {
  get schema(): T;
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  static create: <T_1 extends ZodTypeAny>(getter: () => T_1, params?: RawCreateParams) => ZodLazy<T_1>;
}
interface ZodLiteralDef<T = any> extends ZodTypeDef {
  value: T;
  typeName: ZodFirstPartyTypeKind.ZodLiteral;
}
declare class ZodLiteral<T> extends ZodType<T, ZodLiteralDef<T>, T> {
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  get value(): T;
  static create: <T_1 extends Primitive>(value: T_1, params?: RawCreateParams) => ZodLiteral<T_1>;
}
declare type ArrayKeys = keyof any[];
declare type Indices<T> = Exclude<keyof T, ArrayKeys>;
declare type EnumValues<T extends string = string> = readonly [T, ...T[]];
declare type Values<T extends EnumValues> = {
  [k in T[number]]: k;
};
interface ZodEnumDef<T extends EnumValues = EnumValues> extends ZodTypeDef {
  values: T;
  typeName: ZodFirstPartyTypeKind.ZodEnum;
}
declare type Writeable<T> = {
  -readonly [P in keyof T]: T[P];
};
declare type FilterEnum<Values, ToExclude> = Values extends []
  ? []
  : Values extends [infer Head, ...infer Rest]
    ? Head extends ToExclude
      ? FilterEnum<Rest, ToExclude>
      : [Head, ...FilterEnum<Rest, ToExclude>]
    : never;
declare type typecast<A, T> = A extends T ? A : never;
declare function createZodEnum<U extends string, T extends Readonly<[U, ...U[]]>>(
  values: T,
  params?: RawCreateParams,
): ZodEnum<Writeable<T>>;
declare function createZodEnum<U extends string, T extends [U, ...U[]]>(
  values: T,
  params?: RawCreateParams,
): ZodEnum<T>;
declare class ZodEnum<T extends [string, ...string[]]> extends ZodType<T[number], ZodEnumDef<T>, T[number]> {
  #private;
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  get options(): T;
  get enum(): Values<T>;
  get Values(): Values<T>;
  get Enum(): Values<T>;
  extract<ToExtract extends readonly [T[number], ...T[number][]]>(
    values: ToExtract,
    newDef?: RawCreateParams,
  ): ZodEnum<Writeable<ToExtract>>;
  exclude<ToExclude extends readonly [T[number], ...T[number][]]>(
    values: ToExclude,
    newDef?: RawCreateParams,
  ): ZodEnum<typecast<Writeable<FilterEnum<T, ToExclude[number]>>, [string, ...string[]]>>;
  static create: typeof createZodEnum;
}
interface ZodNativeEnumDef<T extends EnumLike = EnumLike> extends ZodTypeDef {
  values: T;
  typeName: ZodFirstPartyTypeKind.ZodNativeEnum;
}
declare type EnumLike = {
  [k: string]: string | number;
  [nu: number]: string;
};
declare class ZodNativeEnum<T extends EnumLike> extends ZodType<T[keyof T], ZodNativeEnumDef<T>, T[keyof T]> {
  #private;
  _parse(input: ParseInput): ParseReturnType<T[keyof T]>;
  get enum(): T;
  static create: <T_1 extends EnumLike>(values: T_1, params?: RawCreateParams) => ZodNativeEnum<T_1>;
}
interface ZodPromiseDef<T extends ZodTypeAny = ZodTypeAny> extends ZodTypeDef {
  type: T;
  typeName: ZodFirstPartyTypeKind.ZodPromise;
}
declare class ZodPromise<T extends ZodTypeAny> extends ZodType<
  Promise<T['_output']>,
  ZodPromiseDef<T>,
  Promise<T['_input']>
> {
  unwrap(): T;
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  static create: <T_1 extends ZodTypeAny>(schema: T_1, params?: RawCreateParams) => ZodPromise<T_1>;
}
declare type Refinement<T> = (arg: T, ctx: RefinementCtx) => any;
declare type SuperRefinement<T> = (arg: T, ctx: RefinementCtx) => void | Promise<void>;
declare type RefinementEffect<T> = {
  type: 'refinement';
  refinement: (arg: T, ctx: RefinementCtx) => any;
};
declare type TransformEffect<T> = {
  type: 'transform';
  transform: (arg: T, ctx: RefinementCtx) => any;
};
declare type PreprocessEffect<T> = {
  type: 'preprocess';
  transform: (arg: T, ctx: RefinementCtx) => any;
};
declare type Effect<T> = RefinementEffect<T> | TransformEffect<T> | PreprocessEffect<T>;
interface ZodEffectsDef<T extends ZodTypeAny = ZodTypeAny> extends ZodTypeDef {
  schema: T;
  typeName: ZodFirstPartyTypeKind.ZodEffects;
  effect: Effect<any>;
}
declare class ZodEffects<T extends ZodTypeAny, Output = output<T>, Input = input<T>> extends ZodType<
  Output,
  ZodEffectsDef<T>,
  Input
> {
  innerType(): T;
  sourceType(): T;
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  static create: <I extends ZodTypeAny>(
    schema: I,
    effect: Effect<I['_output']>,
    params?: RawCreateParams,
  ) => ZodEffects<I, I['_output'], input<I>>;
  static createWithPreprocess: <I extends ZodTypeAny>(
    preprocess: (arg: unknown, ctx: RefinementCtx) => unknown,
    schema: I,
    params?: RawCreateParams,
  ) => ZodEffects<I, I['_output'], unknown>;
}

interface ZodOptionalDef<T extends ZodTypeAny = ZodTypeAny> extends ZodTypeDef {
  innerType: T;
  typeName: ZodFirstPartyTypeKind.ZodOptional;
}
declare type ZodOptionalType<T extends ZodTypeAny> = ZodOptional<T>;
declare class ZodOptional<T extends ZodTypeAny> extends ZodType<
  T['_output'] | undefined,
  ZodOptionalDef<T>,
  T['_input'] | undefined
> {
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  unwrap(): T;
  static create: <T_1 extends ZodTypeAny>(type: T_1, params?: RawCreateParams) => ZodOptional<T_1>;
}
interface ZodNullableDef<T extends ZodTypeAny = ZodTypeAny> extends ZodTypeDef {
  innerType: T;
  typeName: ZodFirstPartyTypeKind.ZodNullable;
}
declare type ZodNullableType<T extends ZodTypeAny> = ZodNullable<T>;
declare class ZodNullable<T extends ZodTypeAny> extends ZodType<
  T['_output'] | null,
  ZodNullableDef<T>,
  T['_input'] | null
> {
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  unwrap(): T;
  static create: <T_1 extends ZodTypeAny>(type: T_1, params?: RawCreateParams) => ZodNullable<T_1>;
}
interface ZodDefaultDef<T extends ZodTypeAny = ZodTypeAny> extends ZodTypeDef {
  innerType: T;
  defaultValue: () => util.noUndefined<T['_input']>;
  typeName: ZodFirstPartyTypeKind.ZodDefault;
}
declare class ZodDefault<T extends ZodTypeAny> extends ZodType<
  util.noUndefined<T['_output']>,
  ZodDefaultDef<T>,
  T['_input'] | undefined
> {
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  removeDefault(): T;
  static create: <T_1 extends ZodTypeAny>(
    type: T_1,
    params: {
      errorMap?: ZodErrorMap | undefined;
      invalid_type_error?: string | undefined;
      required_error?: string | undefined;
      message?: string | undefined;
      description?: string | undefined;
    } & {
      default: T_1['_input'] | (() => util.noUndefined<T_1['_input']>);
    },
  ) => ZodDefault<T_1>;
}
interface ZodCatchDef<T extends ZodTypeAny = ZodTypeAny> extends ZodTypeDef {
  innerType: T;
  catchValue: (ctx: { error: ZodError; input: unknown }) => T['_input'];
  typeName: ZodFirstPartyTypeKind.ZodCatch;
}
declare class ZodCatch<T extends ZodTypeAny> extends ZodType<T['_output'], ZodCatchDef<T>, unknown> {
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  removeCatch(): T;
  static create: <T_1 extends ZodTypeAny>(
    type: T_1,
    params: {
      errorMap?: ZodErrorMap | undefined;
      invalid_type_error?: string | undefined;
      required_error?: string | undefined;
      message?: string | undefined;
      description?: string | undefined;
    } & {
      catch: T_1['_output'] | (() => T_1['_output']);
    },
  ) => ZodCatch<T_1>;
}
interface ZodNaNDef extends ZodTypeDef {
  typeName: ZodFirstPartyTypeKind.ZodNaN;
}
declare class ZodNaN extends ZodType<number, ZodNaNDef, number> {
  _parse(input: ParseInput): ParseReturnType<any>;
  static create: (params?: RawCreateParams) => ZodNaN;
}
interface ZodBrandedDef<T extends ZodTypeAny> extends ZodTypeDef {
  type: T;
  typeName: ZodFirstPartyTypeKind.ZodBranded;
}
declare const BRAND: unique symbol;
declare type BRAND<T extends string | number | symbol> = {
  [BRAND]: {
    [k in T]: true;
  };
};
declare class ZodBranded<T extends ZodTypeAny, B extends string | number | symbol> extends ZodType<
  T['_output'] & BRAND<B>,
  ZodBrandedDef<T>,
  T['_input']
> {
  _parse(input: ParseInput): ParseReturnType<any>;
  unwrap(): T;
}
interface ZodPipelineDef<A extends ZodTypeAny, B extends ZodTypeAny> extends ZodTypeDef {
  in: A;
  out: B;
  typeName: ZodFirstPartyTypeKind.ZodPipeline;
}
declare class ZodPipeline<A extends ZodTypeAny, B extends ZodTypeAny> extends ZodType<
  B['_output'],
  ZodPipelineDef<A, B>,
  A['_input']
> {
  _parse(input: ParseInput): ParseReturnType<any>;
  static create<A extends ZodTypeAny, B extends ZodTypeAny>(a: A, b: B): ZodPipeline<A, B>;
}
declare type BuiltIn =
  | (((...args: any[]) => any) | (new (...args: any[]) => any))
  | {
      readonly [Symbol.toStringTag]: string;
    }
  | Date
  | Error
  | Generator
  | Promise<unknown>
  | RegExp;
declare type MakeReadonly<T> =
  T extends Map<infer K, infer V>
    ? ReadonlyMap<K, V>
    : T extends Set<infer V>
      ? ReadonlySet<V>
      : T extends [infer Head, ...infer Tail]
        ? readonly [Head, ...Tail]
        : T extends Array<infer V>
          ? ReadonlyArray<V>
          : T extends BuiltIn
            ? T
            : Readonly<T>;
interface ZodReadonlyDef<T extends ZodTypeAny = ZodTypeAny> extends ZodTypeDef {
  innerType: T;
  typeName: ZodFirstPartyTypeKind.ZodReadonly;
}
declare class ZodReadonly<T extends ZodTypeAny> extends ZodType<
  MakeReadonly<T['_output']>,
  ZodReadonlyDef<T>,
  MakeReadonly<T['_input']>
> {
  _parse(input: ParseInput): ParseReturnType<this['_output']>;
  static create: <T_1 extends ZodTypeAny>(type: T_1, params?: RawCreateParams) => ZodReadonly<T_1>;
  unwrap(): T;
}
declare type CustomParams = CustomErrorParams & {
  fatal?: boolean;
};
declare function custom<T>(
  check?: (data: any) => any,
  params?: string | CustomParams | ((input: any) => CustomParams),
  /**
   * @deprecated
   *
   * Pass \`fatal\` into the params object instead:
   *
   * \`\`\`ts
   * z.string().custom((val) => val.length > 5, { fatal: false })
   * \`\`\`
   *
   */
  fatal?: boolean,
): ZodType<T, ZodTypeDef, T>;

declare const late: {
  object: <T extends ZodRawShape>(
    shape: () => T,
    params?: RawCreateParams,
  ) => ZodObject<
    T,
    'strip',
    ZodTypeAny,
    {
      [k in keyof objectUtil.addQuestionMarks<baseObjectOutputType<T>, any>]: objectUtil.addQuestionMarks<
        baseObjectOutputType<T>,
        any
      >[k];
    },
    { [k_1 in keyof baseObjectInputType<T>]: baseObjectInputType<T>[k_1] }
  >;
};
declare enum ZodFirstPartyTypeKind {
  ZodString = 'ZodString',
  ZodNumber = 'ZodNumber',
  ZodNaN = 'ZodNaN',
  ZodBigInt = 'ZodBigInt',
  ZodBoolean = 'ZodBoolean',
  ZodDate = 'ZodDate',
  ZodSymbol = 'ZodSymbol',
  ZodUndefined = 'ZodUndefined',
  ZodNull = 'ZodNull',
  ZodAny = 'ZodAny',
  ZodUnknown = 'ZodUnknown',
  ZodNever = 'ZodNever',
  ZodVoid = 'ZodVoid',
  ZodArray = 'ZodArray',
  ZodObject = 'ZodObject',
  ZodUnion = 'ZodUnion',
  ZodDiscriminatedUnion = 'ZodDiscriminatedUnion',
  ZodIntersection = 'ZodIntersection',
  ZodTuple = 'ZodTuple',
  ZodRecord = 'ZodRecord',
  ZodMap = 'ZodMap',
  ZodSet = 'ZodSet',
  ZodFunction = 'ZodFunction',
  ZodLazy = 'ZodLazy',
  ZodLiteral = 'ZodLiteral',
  ZodEnum = 'ZodEnum',
  ZodEffects = 'ZodEffects',
  ZodNativeEnum = 'ZodNativeEnum',
  ZodOptional = 'ZodOptional',
  ZodNullable = 'ZodNullable',
  ZodDefault = 'ZodDefault',
  ZodCatch = 'ZodCatch',
  ZodPromise = 'ZodPromise',
  ZodBranded = 'ZodBranded',
  ZodPipeline = 'ZodPipeline',
  ZodReadonly = 'ZodReadonly',
}
declare type ZodFirstPartySchemaTypes =
  | ZodString
  | ZodNumber
  | ZodNaN
  | ZodBigInt
  | ZodBoolean
  | ZodDate
  | ZodUndefined
  | ZodNull
  | ZodAny
  | ZodUnknown
  | ZodNever
  | ZodVoid
  | ZodArray<any, any>
  | ZodObject<any, any, any>
  | ZodUnion<any>
  | ZodDiscriminatedUnion<any, any>
  | ZodIntersection<any, any>
  | ZodTuple<any, any>
  | ZodRecord<any, any>
  | ZodMap<any>
  | ZodSet<any>
  | ZodFunction<any, any>
  | ZodLazy<any>
  | ZodLiteral<any>
  | ZodEnum<any>
  | ZodEffects<any, any, any>
  | ZodNativeEnum<any>
  | ZodOptional<any>
  | ZodNullable<any>
  | ZodDefault<any>
  | ZodCatch<any>
  | ZodPromise<any>
  | ZodBranded<any, any>
  | ZodPipeline<any, any>
  | ZodReadonly<any>
  | ZodSymbol;
declare abstract class Class {
  constructor(..._: any[]);
}
declare const instanceOfType: <T extends typeof Class>(
  cls: T,
  params?: CustomParams,
) => ZodType<InstanceType<T>, ZodTypeDef, InstanceType<T>>;
declare const stringType: (
  params?:
    | ({
        errorMap?: ZodErrorMap | undefined;
        invalid_type_error?: string | undefined;
        required_error?: string | undefined;
        message?: string | undefined;
        description?: string | undefined;
      } & {
        coerce?: true | undefined;
      })
    | undefined,
) => ZodString;
declare const numberType: (
  params?:
    | ({
        errorMap?: ZodErrorMap | undefined;
        invalid_type_error?: string | undefined;
        required_error?: string | undefined;
        message?: string | undefined;
        description?: string | undefined;
      } & {
        coerce?: boolean | undefined;
      })
    | undefined,
) => ZodNumber;
declare const nanType: (params?: RawCreateParams) => ZodNaN;
declare const bigIntType: (
  params?:
    | ({
        errorMap?: ZodErrorMap | undefined;
        invalid_type_error?: string | undefined;
        required_error?: string | undefined;
        message?: string | undefined;
        description?: string | undefined;
      } & {
        coerce?: boolean | undefined;
      })
    | undefined,
) => ZodBigInt;
declare const booleanType: (
  params?:
    | ({
        errorMap?: ZodErrorMap | undefined;
        invalid_type_error?: string | undefined;
        required_error?: string | undefined;
        message?: string | undefined;
        description?: string | undefined;
      } & {
        coerce?: boolean | undefined;
      })
    | undefined,
) => ZodBoolean;
declare const dateType: (
  params?:
    | ({
        errorMap?: ZodErrorMap | undefined;
        invalid_type_error?: string | undefined;
        required_error?: string | undefined;
        message?: string | undefined;
        description?: string | undefined;
      } & {
        coerce?: boolean | undefined;
      })
    | undefined,
) => ZodDate;
declare const symbolType: (params?: RawCreateParams) => ZodSymbol;
declare const undefinedType: (params?: RawCreateParams) => ZodUndefined;
declare const nullType: (params?: RawCreateParams) => ZodNull;
declare const anyType: (params?: RawCreateParams) => ZodAny;
declare const unknownType: (params?: RawCreateParams) => ZodUnknown;
declare const neverType: (params?: RawCreateParams) => ZodNever;
declare const voidType: (params?: RawCreateParams) => ZodVoid;
declare const arrayType: <T extends ZodTypeAny>(schema: T, params?: RawCreateParams) => ZodArray<T, 'many'>;
declare const objectType: <T extends ZodRawShape>(
  shape: T,
  params?: RawCreateParams,
) => ZodObject<
  T,
  'strip',
  ZodTypeAny,
  {
    [k in keyof objectUtil.addQuestionMarks<baseObjectOutputType<T>, any>]: objectUtil.addQuestionMarks<
      baseObjectOutputType<T>,
      any
    >[k];
  },
  { [k_1 in keyof baseObjectInputType<T>]: baseObjectInputType<T>[k_1] }
>;
declare const strictObjectType: <T extends ZodRawShape>(
  shape: T,
  params?: RawCreateParams,
) => ZodObject<
  T,
  'strict',
  ZodTypeAny,
  {
    [k in keyof objectUtil.addQuestionMarks<baseObjectOutputType<T>, any>]: objectUtil.addQuestionMarks<
      baseObjectOutputType<T>,
      any
    >[k];
  },
  { [k_1 in keyof baseObjectInputType<T>]: baseObjectInputType<T>[k_1] }
>;
declare const unionType: <T extends readonly [ZodTypeAny, ZodTypeAny, ...ZodTypeAny[]]>(
  types: T,
  params?: RawCreateParams,
) => ZodUnion<T>;
declare const discriminatedUnionType: typeof ZodDiscriminatedUnion.create;
declare const intersectionType: <T extends ZodTypeAny, U extends ZodTypeAny>(
  left: T,
  right: U,
  params?: RawCreateParams,
) => ZodIntersection<T, U>;
declare const tupleType: <T extends [] | [ZodTypeAny, ...ZodTypeAny[]]>(
  schemas: T,
  params?: RawCreateParams,
) => ZodTuple<T, null>;
declare const recordType: typeof ZodRecord.create;
declare const mapType: <Key extends ZodTypeAny = ZodTypeAny, Value extends ZodTypeAny = ZodTypeAny>(
  keyType: Key,
  valueType: Value,
  params?: RawCreateParams,
) => ZodMap<Key, Value>;
declare const setType: <Value extends ZodTypeAny = ZodTypeAny>(
  valueType: Value,
  params?: RawCreateParams,
) => ZodSet<Value>;
declare const functionType: typeof ZodFunction.create;
declare const lazyType: <T extends ZodTypeAny>(getter: () => T, params?: RawCreateParams) => ZodLazy<T>;
declare const literalType: <T extends Primitive>(value: T, params?: RawCreateParams) => ZodLiteral<T>;
declare const enumType: typeof createZodEnum;
declare const nativeEnumType: <T extends EnumLike>(values: T, params?: RawCreateParams) => ZodNativeEnum<T>;
declare const promiseType: <T extends ZodTypeAny>(schema: T, params?: RawCreateParams) => ZodPromise<T>;
declare const effectsType: <I extends ZodTypeAny>(
  schema: I,
  effect: Effect<I['_output']>,
  params?: RawCreateParams,
) => ZodEffects<I, I['_output'], input<I>>;
declare const optionalType: <T extends ZodTypeAny>(type: T, params?: RawCreateParams) => ZodOptional<T>;
declare const nullableType: <T extends ZodTypeAny>(type: T, params?: RawCreateParams) => ZodNullable<T>;
declare const preprocessType: <I extends ZodTypeAny>(
  preprocess: (arg: unknown, ctx: RefinementCtx) => unknown,
  schema: I,
  params?: RawCreateParams,
) => ZodEffects<I, I['_output'], unknown>;
declare const pipelineType: typeof ZodPipeline.create;
declare const ostring: () => ZodOptional<ZodString>;
declare const onumber: () => ZodOptional<ZodNumber>;
declare const oboolean: () => ZodOptional<ZodBoolean>;
declare const coerce: {
  string: (
    params?:
      | ({
          errorMap?: ZodErrorMap | undefined;
          invalid_type_error?: string | undefined;
          required_error?: string | undefined;
          message?: string | undefined;
          description?: string | undefined;
        } & {
          coerce?: true | undefined;
        })
      | undefined,
  ) => ZodString;
  number: (
    params?:
      | ({
          errorMap?: ZodErrorMap | undefined;
          invalid_type_error?: string | undefined;
          required_error?: string | undefined;
          message?: string | undefined;
          description?: string | undefined;
        } & {
          coerce?: boolean | undefined;
        })
      | undefined,
  ) => ZodNumber;
  boolean: (
    params?:
      | ({
          errorMap?: ZodErrorMap | undefined;
          invalid_type_error?: string | undefined;
          required_error?: string | undefined;
          message?: string | undefined;
          description?: string | undefined;
        } & {
          coerce?: boolean | undefined;
        })
      | undefined,
  ) => ZodBoolean;
  bigint: (
    params?:
      | ({
          errorMap?: ZodErrorMap | undefined;
          invalid_type_error?: string | undefined;
          required_error?: string | undefined;
          message?: string | undefined;
          description?: string | undefined;
        } & {
          coerce?: boolean | undefined;
        })
      | undefined,
  ) => ZodBigInt;
  date: (
    params?:
      | ({
          errorMap?: ZodErrorMap | undefined;
          invalid_type_error?: string | undefined;
          required_error?: string | undefined;
          message?: string | undefined;
          description?: string | undefined;
        } & {
          coerce?: boolean | undefined;
        })
      | undefined,
  ) => ZodDate;
};

declare const NEVER: never;

//# sourceMappingURL=external.d.ts.map

declare const z_setErrorMap: typeof setErrorMap;
declare const z_getErrorMap: typeof getErrorMap;
declare const z_makeIssue: typeof makeIssue;
type z_ParseParams = ParseParams;
type z_ParsePathComponent = ParsePathComponent;
type z_ParsePath = ParsePath;
declare const z_EMPTY_PATH: typeof EMPTY_PATH;
type z_ParseContext = ParseContext;
type z_ParseInput = ParseInput;
declare const z_addIssueToContext: typeof addIssueToContext;
type z_ObjectPair = ObjectPair;
type z_ParseStatus = ParseStatus;
declare const z_ParseStatus: typeof ParseStatus;
type z_ParseResult = ParseResult;
declare const z_INVALID: typeof INVALID;
declare const z_DIRTY: typeof DIRTY;
declare const z_OK: typeof OK;
type z_SyncParseReturnType<T = any> = SyncParseReturnType<T>;
type z_AsyncParseReturnType<T> = AsyncParseReturnType<T>;
type z_ParseReturnType<T> = ParseReturnType<T>;
declare const z_isAborted: typeof isAborted;
declare const z_isDirty: typeof isDirty;
declare const z_isValid: typeof isValid;
declare const z_isAsync: typeof isAsync;
type z_Primitive = Primitive;
type z_Scalars = Scalars;
declare const z_util: typeof util;
declare const z_objectUtil: typeof objectUtil;
type z_ZodParsedType = ZodParsedType;
declare const z_getParsedType: typeof getParsedType;
declare const z_oboolean: typeof oboolean;
declare const z_onumber: typeof onumber;
declare const z_ostring: typeof ostring;
type z_RefinementCtx = RefinementCtx;
type z_ZodRawShape = ZodRawShape;
type z_ZodTypeAny = ZodTypeAny;
type z_TypeOf<T extends ZodType<any, any, any>> = TypeOf<T>;
type z_input<T extends ZodType<any, any, any>> = input<T>;
type z_output<T extends ZodType<any, any, any>> = output<T>;
type z_CustomErrorParams = CustomErrorParams;
type z_ZodTypeDef = ZodTypeDef;
type z_RawCreateParams = RawCreateParams;
type z_ProcessedCreateParams = ProcessedCreateParams;
type z_SafeParseSuccess<Output> = SafeParseSuccess<Output>;
type z_SafeParseError<Input> = SafeParseError<Input>;
type z_SafeParseReturnType<Input, Output> = SafeParseReturnType<Input, Output>;
type z_ZodType<Output = any, Def extends ZodTypeDef = ZodTypeDef, Input = Output> = ZodType<Output, Def, Input>;
declare const z_ZodType: typeof ZodType;
type z_IpVersion = IpVersion;
type z_ZodStringCheck = ZodStringCheck;
type z_ZodStringDef = ZodStringDef;
declare const z_datetimeRegex: typeof datetimeRegex;
type z_ZodString = ZodString;
declare const z_ZodString: typeof ZodString;
type z_ZodNumberCheck = ZodNumberCheck;
type z_ZodNumberDef = ZodNumberDef;
type z_ZodNumber = ZodNumber;
declare const z_ZodNumber: typeof ZodNumber;
type z_ZodBigIntCheck = ZodBigIntCheck;
type z_ZodBigIntDef = ZodBigIntDef;
type z_ZodBigInt = ZodBigInt;
declare const z_ZodBigInt: typeof ZodBigInt;
type z_ZodBooleanDef = ZodBooleanDef;
type z_ZodBoolean = ZodBoolean;
declare const z_ZodBoolean: typeof ZodBoolean;
type z_ZodDateCheck = ZodDateCheck;
type z_ZodDateDef = ZodDateDef;
type z_ZodDate = ZodDate;
declare const z_ZodDate: typeof ZodDate;
type z_ZodSymbolDef = ZodSymbolDef;
type z_ZodSymbol = ZodSymbol;
declare const z_ZodSymbol: typeof ZodSymbol;
type z_ZodUndefinedDef = ZodUndefinedDef;
type z_ZodUndefined = ZodUndefined;
declare const z_ZodUndefined: typeof ZodUndefined;
type z_ZodNullDef = ZodNullDef;
type z_ZodNull = ZodNull;
declare const z_ZodNull: typeof ZodNull;
type z_ZodAnyDef = ZodAnyDef;
type z_ZodAny = ZodAny;
declare const z_ZodAny: typeof ZodAny;
type z_ZodUnknownDef = ZodUnknownDef;
type z_ZodUnknown = ZodUnknown;
declare const z_ZodUnknown: typeof ZodUnknown;
type z_ZodNeverDef = ZodNeverDef;
type z_ZodNever = ZodNever;
declare const z_ZodNever: typeof ZodNever;
type z_ZodVoidDef = ZodVoidDef;
type z_ZodVoid = ZodVoid;
declare const z_ZodVoid: typeof ZodVoid;
type z_ZodArrayDef<T extends ZodTypeAny = ZodTypeAny> = ZodArrayDef<T>;
type z_ArrayCardinality = ArrayCardinality;
type z_arrayOutputType<T extends ZodTypeAny, Cardinality extends ArrayCardinality = 'many'> = arrayOutputType<
  T,
  Cardinality
>;
type z_ZodArray<T extends ZodTypeAny, Cardinality extends ArrayCardinality = 'many'> = ZodArray<T, Cardinality>;
declare const z_ZodArray: typeof ZodArray;
type z_ZodNonEmptyArray<T extends ZodTypeAny> = ZodNonEmptyArray<T>;
type z_UnknownKeysParam = UnknownKeysParam;
type z_ZodObjectDef<
  T extends ZodRawShape = ZodRawShape,
  UnknownKeys extends UnknownKeysParam = UnknownKeysParam,
  Catchall extends ZodTypeAny = ZodTypeAny,
> = ZodObjectDef<T, UnknownKeys, Catchall>;
type z_mergeTypes<A, B> = mergeTypes<A, B>;
type z_objectOutputType<
  Shape extends ZodRawShape,
  Catchall extends ZodTypeAny,
  UnknownKeys extends UnknownKeysParam = UnknownKeysParam,
> = objectOutputType<Shape, Catchall, UnknownKeys>;
type z_baseObjectOutputType<Shape extends ZodRawShape> = baseObjectOutputType<Shape>;
type z_objectInputType<
  Shape extends ZodRawShape,
  Catchall extends ZodTypeAny,
  UnknownKeys extends UnknownKeysParam = UnknownKeysParam,
> = objectInputType<Shape, Catchall, UnknownKeys>;
type z_baseObjectInputType<Shape extends ZodRawShape> = baseObjectInputType<Shape>;
type z_CatchallOutput<T extends ZodType> = CatchallOutput<T>;
type z_CatchallInput<T extends ZodType> = CatchallInput<T>;
type z_PassthroughType<T extends UnknownKeysParam> = PassthroughType<T>;
type z_deoptional<T extends ZodTypeAny> = deoptional<T>;
type z_SomeZodObject = SomeZodObject;
type z_noUnrecognized<Obj extends object, Shape extends object> = noUnrecognized<Obj, Shape>;
type z_ZodObject<
  T extends ZodRawShape,
  UnknownKeys extends UnknownKeysParam = UnknownKeysParam,
  Catchall extends ZodTypeAny = ZodTypeAny,
  Output = objectOutputType<T, Catchall, UnknownKeys>,
  Input = objectInputType<T, Catchall, UnknownKeys>,
> = ZodObject<T, UnknownKeys, Catchall, Output, Input>;
declare const z_ZodObject: typeof ZodObject;
type z_AnyZodObject = AnyZodObject;
type z_ZodUnionOptions = ZodUnionOptions;
type z_ZodUnionDef<T extends ZodUnionOptions = Readonly<[ZodTypeAny, ZodTypeAny, ...ZodTypeAny[]]>> = ZodUnionDef<T>;
type z_ZodUnion<T extends ZodUnionOptions> = ZodUnion<T>;
declare const z_ZodUnion: typeof ZodUnion;
type z_ZodDiscriminatedUnionOption<Discriminator extends string> = ZodDiscriminatedUnionOption<Discriminator>;
type z_ZodDiscriminatedUnionDef<
  Discriminator extends string,
  Options extends ZodDiscriminatedUnionOption<string>[] = ZodDiscriminatedUnionOption<string>[],
> = ZodDiscriminatedUnionDef<Discriminator, Options>;
type z_ZodDiscriminatedUnion<
  Discriminator extends string,
  Options extends ZodDiscriminatedUnionOption<Discriminator>[],
> = ZodDiscriminatedUnion<Discriminator, Options>;
declare const z_ZodDiscriminatedUnion: typeof ZodDiscriminatedUnion;
type z_ZodIntersectionDef<T extends ZodTypeAny = ZodTypeAny, U extends ZodTypeAny = ZodTypeAny> = ZodIntersectionDef<
  T,
  U
>;
type z_ZodIntersection<T extends ZodTypeAny, U extends ZodTypeAny> = ZodIntersection<T, U>;
declare const z_ZodIntersection: typeof ZodIntersection;
type z_ZodTupleItems = ZodTupleItems;
type z_AssertArray<T> = AssertArray<T>;
type z_OutputTypeOfTuple<T extends ZodTupleItems | []> = OutputTypeOfTuple<T>;
type z_OutputTypeOfTupleWithRest<
  T extends ZodTupleItems | [],
  Rest extends ZodTypeAny | null = null,
> = OutputTypeOfTupleWithRest<T, Rest>;
type z_InputTypeOfTuple<T extends ZodTupleItems | []> = InputTypeOfTuple<T>;
type z_InputTypeOfTupleWithRest<
  T extends ZodTupleItems | [],
  Rest extends ZodTypeAny | null = null,
> = InputTypeOfTupleWithRest<T, Rest>;
type z_ZodTupleDef<T extends ZodTupleItems | [] = ZodTupleItems, Rest extends ZodTypeAny | null = null> = ZodTupleDef<
  T,
  Rest
>;
type z_AnyZodTuple = AnyZodTuple;
type z_ZodTuple<
  T extends [ZodTypeAny, ...ZodTypeAny[]] | [] = [ZodTypeAny, ...ZodTypeAny[]],
  Rest extends ZodTypeAny | null = null,
> = ZodTuple<T, Rest>;
declare const z_ZodTuple: typeof ZodTuple;
type z_ZodRecordDef<Key extends KeySchema = ZodString, Value extends ZodTypeAny = ZodTypeAny> = ZodRecordDef<
  Key,
  Value
>;
type z_KeySchema = KeySchema;
type z_RecordType<K extends string | number | symbol, V> = RecordType<K, V>;
type z_ZodRecord<Key extends KeySchema = ZodString, Value extends ZodTypeAny = ZodTypeAny> = ZodRecord<Key, Value>;
declare const z_ZodRecord: typeof ZodRecord;
type z_ZodMapDef<Key extends ZodTypeAny = ZodTypeAny, Value extends ZodTypeAny = ZodTypeAny> = ZodMapDef<Key, Value>;
type z_ZodMap<Key extends ZodTypeAny = ZodTypeAny, Value extends ZodTypeAny = ZodTypeAny> = ZodMap<Key, Value>;
declare const z_ZodMap: typeof ZodMap;
type z_ZodSetDef<Value extends ZodTypeAny = ZodTypeAny> = ZodSetDef<Value>;
type z_ZodSet<Value extends ZodTypeAny = ZodTypeAny> = ZodSet<Value>;
declare const z_ZodSet: typeof ZodSet;
type z_ZodFunctionDef<
  Args extends ZodTuple<any, any> = ZodTuple<any, any>,
  Returns extends ZodTypeAny = ZodTypeAny,
> = ZodFunctionDef<Args, Returns>;
type z_OuterTypeOfFunction<Args extends ZodTuple<any, any>, Returns extends ZodTypeAny> = OuterTypeOfFunction<
  Args,
  Returns
>;
type z_InnerTypeOfFunction<Args extends ZodTuple<any, any>, Returns extends ZodTypeAny> = InnerTypeOfFunction<
  Args,
  Returns
>;
type z_ZodFunction<Args extends ZodTuple<any, any>, Returns extends ZodTypeAny> = ZodFunction<Args, Returns>;
declare const z_ZodFunction: typeof ZodFunction;
type z_ZodLazyDef<T extends ZodTypeAny = ZodTypeAny> = ZodLazyDef<T>;
type z_ZodLazy<T extends ZodTypeAny> = ZodLazy<T>;
declare const z_ZodLazy: typeof ZodLazy;
type z_ZodLiteralDef<T = any> = ZodLiteralDef<T>;
type z_ZodLiteral<T> = ZodLiteral<T>;
declare const z_ZodLiteral: typeof ZodLiteral;
type z_ArrayKeys = ArrayKeys;
type z_Indices<T> = Indices<T>;
type z_EnumValues<T extends string = string> = EnumValues<T>;
type z_Values<T extends EnumValues> = Values<T>;
type z_ZodEnumDef<T extends EnumValues = EnumValues> = ZodEnumDef<T>;
type z_Writeable<T> = Writeable<T>;
type z_FilterEnum<Values, ToExclude> = FilterEnum<Values, ToExclude>;
type z_typecast<A, T> = typecast<A, T>;
type z_ZodEnum<T extends [string, ...string[]]> = ZodEnum<T>;
declare const z_ZodEnum: typeof ZodEnum;
type z_ZodNativeEnumDef<T extends EnumLike = EnumLike> = ZodNativeEnumDef<T>;
type z_EnumLike = EnumLike;
type z_ZodNativeEnum<T extends EnumLike> = ZodNativeEnum<T>;
declare const z_ZodNativeEnum: typeof ZodNativeEnum;
type z_ZodPromiseDef<T extends ZodTypeAny = ZodTypeAny> = ZodPromiseDef<T>;
type z_ZodPromise<T extends ZodTypeAny> = ZodPromise<T>;
declare const z_ZodPromise: typeof ZodPromise;
type z_Refinement<T> = Refinement<T>;
type z_SuperRefinement<T> = SuperRefinement<T>;
type z_RefinementEffect<T> = RefinementEffect<T>;
type z_TransformEffect<T> = TransformEffect<T>;
type z_PreprocessEffect<T> = PreprocessEffect<T>;
type z_Effect<T> = Effect<T>;
type z_ZodEffectsDef<T extends ZodTypeAny = ZodTypeAny> = ZodEffectsDef<T>;
type z_ZodEffects<T extends ZodTypeAny, Output = output<T>, Input = input<T>> = ZodEffects<T, Output, Input>;
declare const z_ZodEffects: typeof ZodEffects;
type z_ZodOptionalDef<T extends ZodTypeAny = ZodTypeAny> = ZodOptionalDef<T>;
type z_ZodOptionalType<T extends ZodTypeAny> = ZodOptionalType<T>;
type z_ZodOptional<T extends ZodTypeAny> = ZodOptional<T>;
declare const z_ZodOptional: typeof ZodOptional;
type z_ZodNullableDef<T extends ZodTypeAny = ZodTypeAny> = ZodNullableDef<T>;
type z_ZodNullableType<T extends ZodTypeAny> = ZodNullableType<T>;
type z_ZodNullable<T extends ZodTypeAny> = ZodNullable<T>;
declare const z_ZodNullable: typeof ZodNullable;
type z_ZodDefaultDef<T extends ZodTypeAny = ZodTypeAny> = ZodDefaultDef<T>;
type z_ZodDefault<T extends ZodTypeAny> = ZodDefault<T>;
declare const z_ZodDefault: typeof ZodDefault;
type z_ZodCatchDef<T extends ZodTypeAny = ZodTypeAny> = ZodCatchDef<T>;
type z_ZodCatch<T extends ZodTypeAny> = ZodCatch<T>;
declare const z_ZodCatch: typeof ZodCatch;
type z_ZodNaNDef = ZodNaNDef;
type z_ZodNaN = ZodNaN;
declare const z_ZodNaN: typeof ZodNaN;
type z_ZodBrandedDef<T extends ZodTypeAny> = ZodBrandedDef<T>;
type z_BRAND<T extends string | number | symbol> = BRAND<T>;
type z_ZodBranded<T extends ZodTypeAny, B extends string | number | symbol> = ZodBranded<T, B>;
declare const z_ZodBranded: typeof ZodBranded;
type z_ZodPipelineDef<A extends ZodTypeAny, B extends ZodTypeAny> = ZodPipelineDef<A, B>;
type z_ZodPipeline<A extends ZodTypeAny, B extends ZodTypeAny> = ZodPipeline<A, B>;
declare const z_ZodPipeline: typeof ZodPipeline;
type z_ZodReadonlyDef<T extends ZodTypeAny = ZodTypeAny> = ZodReadonlyDef<T>;
type z_ZodReadonly<T extends ZodTypeAny> = ZodReadonly<T>;
declare const z_ZodReadonly: typeof ZodReadonly;
declare const z_custom: typeof custom;
declare const z_late: typeof late;
type z_ZodFirstPartyTypeKind = ZodFirstPartyTypeKind;
declare const z_ZodFirstPartyTypeKind: typeof ZodFirstPartyTypeKind;
type z_ZodFirstPartySchemaTypes = ZodFirstPartySchemaTypes;
declare const z_coerce: typeof coerce;
declare const z_NEVER: typeof NEVER;
type z_inferFlattenedErrors<T extends ZodType<any, any, any>, U = string> = inferFlattenedErrors<T, U>;
type z_typeToFlattenedError<T, U = string> = typeToFlattenedError<T, U>;
type z_ZodIssueCode = ZodIssueCode;
type z_ZodIssueBase = ZodIssueBase;
type z_ZodInvalidTypeIssue = ZodInvalidTypeIssue;
type z_ZodInvalidLiteralIssue = ZodInvalidLiteralIssue;
type z_ZodUnrecognizedKeysIssue = ZodUnrecognizedKeysIssue;
type z_ZodInvalidUnionIssue = ZodInvalidUnionIssue;
type z_ZodInvalidUnionDiscriminatorIssue = ZodInvalidUnionDiscriminatorIssue;
type z_ZodInvalidEnumValueIssue = ZodInvalidEnumValueIssue;
type z_ZodInvalidArgumentsIssue = ZodInvalidArgumentsIssue;
type z_ZodInvalidReturnTypeIssue = ZodInvalidReturnTypeIssue;
type z_ZodInvalidDateIssue = ZodInvalidDateIssue;
type z_StringValidation = StringValidation;
type z_ZodInvalidStringIssue = ZodInvalidStringIssue;
type z_ZodTooSmallIssue = ZodTooSmallIssue;
type z_ZodTooBigIssue = ZodTooBigIssue;
type z_ZodInvalidIntersectionTypesIssue = ZodInvalidIntersectionTypesIssue;
type z_ZodNotMultipleOfIssue = ZodNotMultipleOfIssue;
type z_ZodNotFiniteIssue = ZodNotFiniteIssue;
type z_ZodCustomIssue = ZodCustomIssue;
type z_DenormalizedError = DenormalizedError;
type z_ZodIssueOptionalMessage = ZodIssueOptionalMessage;
type z_ZodIssue = ZodIssue;
declare const z_quotelessJson: typeof quotelessJson;
type z_ZodFormattedError<T, U = string> = ZodFormattedError<T, U>;
type z_inferFormattedError<T extends ZodType<any, any, any>, U = string> = inferFormattedError<T, U>;
type z_ZodError<T = any> = ZodError<T>;
declare const z_ZodError: typeof ZodError;
type z_IssueData = IssueData;
type z_ErrorMapCtx = ErrorMapCtx;
type z_ZodErrorMap = ZodErrorMap;
declare namespace z {
  export {
    errorMap as defaultErrorMap,
    z_setErrorMap as setErrorMap,
    z_getErrorMap as getErrorMap,
    z_makeIssue as makeIssue,
    type z_ParseParams as ParseParams,
    type z_ParsePathComponent as ParsePathComponent,
    type z_ParsePath as ParsePath,
    z_EMPTY_PATH as EMPTY_PATH,
    type z_ParseContext as ParseContext,
    type z_ParseInput as ParseInput,
    z_addIssueToContext as addIssueToContext,
    type z_ObjectPair as ObjectPair,
    z_ParseStatus as ParseStatus,
    type z_ParseResult as ParseResult,
    z_INVALID as INVALID,
    z_DIRTY as DIRTY,
    z_OK as OK,
    type z_SyncParseReturnType as SyncParseReturnType,
    type z_AsyncParseReturnType as AsyncParseReturnType,
    type z_ParseReturnType as ParseReturnType,
    z_isAborted as isAborted,
    z_isDirty as isDirty,
    z_isValid as isValid,
    z_isAsync as isAsync,
    type z_Primitive as Primitive,
    type z_Scalars as Scalars,
    z_util as util,
    z_objectUtil as objectUtil,
    type z_ZodParsedType as ZodParsedType,
    z_getParsedType as getParsedType,
    type TypeOf as infer,
    ZodEffects as ZodTransformer,
    ZodType as Schema,
    ZodType as ZodSchema,
    anyType as any,
    arrayType as array,
    bigIntType as bigint,
    booleanType as boolean,
    dateType as date,
    discriminatedUnionType as discriminatedUnion,
    effectsType as effect,
    enumType as enum,
    functionType as function,
    instanceOfType as instanceof,
    intersectionType as intersection,
    lazyType as lazy,
    literalType as literal,
    mapType as map,
    nanType as nan,
    nativeEnumType as nativeEnum,
    neverType as never,
    nullType as null,
    nullableType as nullable,
    numberType as number,
    objectType as object,
    z_oboolean as oboolean,
    z_onumber as onumber,
    optionalType as optional,
    z_ostring as ostring,
    pipelineType as pipeline,
    preprocessType as preprocess,
    promiseType as promise,
    recordType as record,
    setType as set,
    strictObjectType as strictObject,
    stringType as string,
    symbolType as symbol,
    effectsType as transformer,
    tupleType as tuple,
    undefinedType as undefined,
    unionType as union,
    unknownType as unknown,
    voidType as void,
    type z_RefinementCtx as RefinementCtx,
    type z_ZodRawShape as ZodRawShape,
    type z_ZodTypeAny as ZodTypeAny,
    type z_TypeOf as TypeOf,
    type z_input as input,
    type z_output as output,
    type z_CustomErrorParams as CustomErrorParams,
    type z_ZodTypeDef as ZodTypeDef,
    type z_RawCreateParams as RawCreateParams,
    type z_ProcessedCreateParams as ProcessedCreateParams,
    type z_SafeParseSuccess as SafeParseSuccess,
    type z_SafeParseError as SafeParseError,
    type z_SafeParseReturnType as SafeParseReturnType,
    z_ZodType as ZodType,
    type z_IpVersion as IpVersion,
    type z_ZodStringCheck as ZodStringCheck,
    type z_ZodStringDef as ZodStringDef,
    z_datetimeRegex as datetimeRegex,
    z_ZodString as ZodString,
    type z_ZodNumberCheck as ZodNumberCheck,
    type z_ZodNumberDef as ZodNumberDef,
    z_ZodNumber as ZodNumber,
    type z_ZodBigIntCheck as ZodBigIntCheck,
    type z_ZodBigIntDef as ZodBigIntDef,
    z_ZodBigInt as ZodBigInt,
    type z_ZodBooleanDef as ZodBooleanDef,
    z_ZodBoolean as ZodBoolean,
    type z_ZodDateCheck as ZodDateCheck,
    type z_ZodDateDef as ZodDateDef,
    z_ZodDate as ZodDate,
    type z_ZodSymbolDef as ZodSymbolDef,
    z_ZodSymbol as ZodSymbol,
    type z_ZodUndefinedDef as ZodUndefinedDef,
    z_ZodUndefined as ZodUndefined,
    type z_ZodNullDef as ZodNullDef,
    z_ZodNull as ZodNull,
    type z_ZodAnyDef as ZodAnyDef,
    z_ZodAny as ZodAny,
    type z_ZodUnknownDef as ZodUnknownDef,
    z_ZodUnknown as ZodUnknown,
    type z_ZodNeverDef as ZodNeverDef,
    z_ZodNever as ZodNever,
    type z_ZodVoidDef as ZodVoidDef,
    z_ZodVoid as ZodVoid,
    type z_ZodArrayDef as ZodArrayDef,
    type z_ArrayCardinality as ArrayCardinality,
    type z_arrayOutputType as arrayOutputType,
    z_ZodArray as ZodArray,
    type z_ZodNonEmptyArray as ZodNonEmptyArray,
    type z_UnknownKeysParam as UnknownKeysParam,
    type z_ZodObjectDef as ZodObjectDef,
    type z_mergeTypes as mergeTypes,
    type z_objectOutputType as objectOutputType,
    type z_baseObjectOutputType as baseObjectOutputType,
    type z_objectInputType as objectInputType,
    type z_baseObjectInputType as baseObjectInputType,
    type z_CatchallOutput as CatchallOutput,
    type z_CatchallInput as CatchallInput,
    type z_PassthroughType as PassthroughType,
    type z_deoptional as deoptional,
    type z_SomeZodObject as SomeZodObject,
    type z_noUnrecognized as noUnrecognized,
    z_ZodObject as ZodObject,
    type z_AnyZodObject as AnyZodObject,
    type z_ZodUnionOptions as ZodUnionOptions,
    type z_ZodUnionDef as ZodUnionDef,
    z_ZodUnion as ZodUnion,
    type z_ZodDiscriminatedUnionOption as ZodDiscriminatedUnionOption,
    type z_ZodDiscriminatedUnionDef as ZodDiscriminatedUnionDef,
    z_ZodDiscriminatedUnion as ZodDiscriminatedUnion,
    type z_ZodIntersectionDef as ZodIntersectionDef,
    z_ZodIntersection as ZodIntersection,
    type z_ZodTupleItems as ZodTupleItems,
    type z_AssertArray as AssertArray,
    type z_OutputTypeOfTuple as OutputTypeOfTuple,
    type z_OutputTypeOfTupleWithRest as OutputTypeOfTupleWithRest,
    type z_InputTypeOfTuple as InputTypeOfTuple,
    type z_InputTypeOfTupleWithRest as InputTypeOfTupleWithRest,
    type z_ZodTupleDef as ZodTupleDef,
    type z_AnyZodTuple as AnyZodTuple,
    z_ZodTuple as ZodTuple,
    type z_ZodRecordDef as ZodRecordDef,
    type z_KeySchema as KeySchema,
    type z_RecordType as RecordType,
    z_ZodRecord as ZodRecord,
    type z_ZodMapDef as ZodMapDef,
    z_ZodMap as ZodMap,
    type z_ZodSetDef as ZodSetDef,
    z_ZodSet as ZodSet,
    type z_ZodFunctionDef as ZodFunctionDef,
    type z_OuterTypeOfFunction as OuterTypeOfFunction,
    type z_InnerTypeOfFunction as InnerTypeOfFunction,
    z_ZodFunction as ZodFunction,
    type z_ZodLazyDef as ZodLazyDef,
    z_ZodLazy as ZodLazy,
    type z_ZodLiteralDef as ZodLiteralDef,
    z_ZodLiteral as ZodLiteral,
    type z_ArrayKeys as ArrayKeys,
    type z_Indices as Indices,
    type z_EnumValues as EnumValues,
    type z_Values as Values,
    type z_ZodEnumDef as ZodEnumDef,
    type z_Writeable as Writeable,
    type z_FilterEnum as FilterEnum,
    type z_typecast as typecast,
    z_ZodEnum as ZodEnum,
    type z_ZodNativeEnumDef as ZodNativeEnumDef,
    type z_EnumLike as EnumLike,
    z_ZodNativeEnum as ZodNativeEnum,
    type z_ZodPromiseDef as ZodPromiseDef,
    z_ZodPromise as ZodPromise,
    type z_Refinement as Refinement,
    type z_SuperRefinement as SuperRefinement,
    type z_RefinementEffect as RefinementEffect,
    type z_TransformEffect as TransformEffect,
    type z_PreprocessEffect as PreprocessEffect,
    type z_Effect as Effect,
    type z_ZodEffectsDef as ZodEffectsDef,
    z_ZodEffects as ZodEffects,
    type z_ZodOptionalDef as ZodOptionalDef,
    type z_ZodOptionalType as ZodOptionalType,
    z_ZodOptional as ZodOptional,
    type z_ZodNullableDef as ZodNullableDef,
    type z_ZodNullableType as ZodNullableType,
    z_ZodNullable as ZodNullable,
    type z_ZodDefaultDef as ZodDefaultDef,
    z_ZodDefault as ZodDefault,
    type z_ZodCatchDef as ZodCatchDef,
    z_ZodCatch as ZodCatch,
    type z_ZodNaNDef as ZodNaNDef,
    z_ZodNaN as ZodNaN,
    type z_ZodBrandedDef as ZodBrandedDef,
    type z_BRAND as BRAND,
    z_ZodBranded as ZodBranded,
    type z_ZodPipelineDef as ZodPipelineDef,
    z_ZodPipeline as ZodPipeline,
    type z_ZodReadonlyDef as ZodReadonlyDef,
    z_ZodReadonly as ZodReadonly,
    z_custom as custom,
    z_late as late,
    z_ZodFirstPartyTypeKind as ZodFirstPartyTypeKind,
    type z_ZodFirstPartySchemaTypes as ZodFirstPartySchemaTypes,
    z_coerce as coerce,
    z_NEVER as NEVER,
    type z_inferFlattenedErrors as inferFlattenedErrors,
    type z_typeToFlattenedError as typeToFlattenedError,
    type z_ZodIssueCode as ZodIssueCode,
    type z_ZodIssueBase as ZodIssueBase,
    type z_ZodInvalidTypeIssue as ZodInvalidTypeIssue,
    type z_ZodInvalidLiteralIssue as ZodInvalidLiteralIssue,
    type z_ZodUnrecognizedKeysIssue as ZodUnrecognizedKeysIssue,
    type z_ZodInvalidUnionIssue as ZodInvalidUnionIssue,
    type z_ZodInvalidUnionDiscriminatorIssue as ZodInvalidUnionDiscriminatorIssue,
    type z_ZodInvalidEnumValueIssue as ZodInvalidEnumValueIssue,
    type z_ZodInvalidArgumentsIssue as ZodInvalidArgumentsIssue,
    type z_ZodInvalidReturnTypeIssue as ZodInvalidReturnTypeIssue,
    type z_ZodInvalidDateIssue as ZodInvalidDateIssue,
    type z_StringValidation as StringValidation,
    type z_ZodInvalidStringIssue as ZodInvalidStringIssue,
    type z_ZodTooSmallIssue as ZodTooSmallIssue,
    type z_ZodTooBigIssue as ZodTooBigIssue,
    type z_ZodInvalidIntersectionTypesIssue as ZodInvalidIntersectionTypesIssue,
    type z_ZodNotMultipleOfIssue as ZodNotMultipleOfIssue,
    type z_ZodNotFiniteIssue as ZodNotFiniteIssue,
    type z_ZodCustomIssue as ZodCustomIssue,
    type z_DenormalizedError as DenormalizedError,
    type z_ZodIssueOptionalMessage as ZodIssueOptionalMessage,
    type z_ZodIssue as ZodIssue,
    z_quotelessJson as quotelessJson,
    type z_ZodFormattedError as ZodFormattedError,
    type z_inferFormattedError as inferFormattedError,
    z_ZodError as ZodError,
    type z_IssueData as IssueData,
    type z_ErrorMapCtx as ErrorMapCtx,
    type z_ZodErrorMap as ZodErrorMap,
  };
}

//# sourceMappingURL=index.d.ts.map

export {
  type AnyZodObject,
  type AnyZodTuple,
  type ArrayCardinality,
  type ArrayKeys,
  type AssertArray,
  type AsyncParseReturnType,
  BRAND,
  type CatchallInput,
  type CatchallOutput,
  type CustomErrorParams,
  DIRTY,
  type DenormalizedError,
  EMPTY_PATH,
  type Effect,
  type EnumLike,
  type EnumValues,
  type ErrorMapCtx,
  type FilterEnum,
  INVALID,
  type Indices,
  type InnerTypeOfFunction,
  type InputTypeOfTuple,
  type InputTypeOfTupleWithRest,
  type IpVersion,
  type IssueData,
  type KeySchema,
  NEVER,
  OK,
  type ObjectPair,
  type OuterTypeOfFunction,
  type OutputTypeOfTuple,
  type OutputTypeOfTupleWithRest,
  type ParseContext,
  type ParseInput,
  type ParseParams,
  type ParsePath,
  type ParsePathComponent,
  type ParseResult,
  type ParseReturnType,
  ParseStatus,
  type PassthroughType,
  type PreprocessEffect,
  type Primitive,
  type ProcessedCreateParams,
  type RawCreateParams,
  type RecordType,
  type Refinement,
  type RefinementCtx,
  type RefinementEffect,
  type SafeParseError,
  type SafeParseReturnType,
  type SafeParseSuccess,
  type Scalars,
  ZodType as Schema,
  type SomeZodObject,
  type StringValidation,
  type SuperRefinement,
  type SyncParseReturnType,
  type TransformEffect,
  type TypeOf,
  type UnknownKeysParam,
  type Values,
  type Writeable,
  ZodAny,
  type ZodAnyDef,
  ZodArray,
  type ZodArrayDef,
  ZodBigInt,
  type ZodBigIntCheck,
  type ZodBigIntDef,
  ZodBoolean,
  type ZodBooleanDef,
  ZodBranded,
  type ZodBrandedDef,
  ZodCatch,
  type ZodCatchDef,
  type ZodCustomIssue,
  ZodDate,
  type ZodDateCheck,
  type ZodDateDef,
  ZodDefault,
  type ZodDefaultDef,
  ZodDiscriminatedUnion,
  type ZodDiscriminatedUnionDef,
  type ZodDiscriminatedUnionOption,
  ZodEffects,
  type ZodEffectsDef,
  ZodEnum,
  type ZodEnumDef,
  ZodError,
  type ZodErrorMap,
  type ZodFirstPartySchemaTypes,
  ZodFirstPartyTypeKind,
  type ZodFormattedError,
  ZodFunction,
  type ZodFunctionDef,
  ZodIntersection,
  type ZodIntersectionDef,
  type ZodInvalidArgumentsIssue,
  type ZodInvalidDateIssue,
  type ZodInvalidEnumValueIssue,
  type ZodInvalidIntersectionTypesIssue,
  type ZodInvalidLiteralIssue,
  type ZodInvalidReturnTypeIssue,
  type ZodInvalidStringIssue,
  type ZodInvalidTypeIssue,
  type ZodInvalidUnionDiscriminatorIssue,
  type ZodInvalidUnionIssue,
  type ZodIssue,
  type ZodIssueBase,
  ZodIssueCode,
  type ZodIssueOptionalMessage,
  ZodLazy,
  type ZodLazyDef,
  ZodLiteral,
  type ZodLiteralDef,
  ZodMap,
  type ZodMapDef,
  ZodNaN,
  type ZodNaNDef,
  ZodNativeEnum,
  type ZodNativeEnumDef,
  ZodNever,
  type ZodNeverDef,
  type ZodNonEmptyArray,
  type ZodNotFiniteIssue,
  type ZodNotMultipleOfIssue,
  ZodNull,
  type ZodNullDef,
  ZodNullable,
  type ZodNullableDef,
  type ZodNullableType,
  ZodNumber,
  type ZodNumberCheck,
  type ZodNumberDef,
  ZodObject,
  type ZodObjectDef,
  ZodOptional,
  type ZodOptionalDef,
  type ZodOptionalType,
  ZodParsedType,
  ZodPipeline,
  type ZodPipelineDef,
  ZodPromise,
  type ZodPromiseDef,
  type ZodRawShape,
  ZodReadonly,
  type ZodReadonlyDef,
  ZodRecord,
  type ZodRecordDef,
  ZodType as ZodSchema,
  ZodSet,
  type ZodSetDef,
  ZodString,
  type ZodStringCheck,
  type ZodStringDef,
  ZodSymbol,
  type ZodSymbolDef,
  type ZodTooBigIssue,
  type ZodTooSmallIssue,
  ZodEffects as ZodTransformer,
  ZodTuple,
  type ZodTupleDef,
  type ZodTupleItems,
  ZodType,
  type ZodTypeAny,
  type ZodTypeDef,
  ZodUndefined,
  type ZodUndefinedDef,
  ZodUnion,
  type ZodUnionDef,
  type ZodUnionOptions,
  ZodUnknown,
  type ZodUnknownDef,
  type ZodUnrecognizedKeysIssue,
  ZodVoid,
  type ZodVoidDef,
  addIssueToContext,
  anyType as any,
  arrayType as array,
  type arrayOutputType,
  type baseObjectInputType,
  type baseObjectOutputType,
  bigIntType as bigint,
  booleanType as boolean,
  coerce,
  custom,
  dateType as date,
  datetimeRegex,
  z as default,
  errorMap as defaultErrorMap,
  type deoptional,
  discriminatedUnionType as discriminatedUnion,
  effectsType as effect,
  enumType as enum,
  functionType as function,
  getErrorMap,
  getParsedType,
  type TypeOf as infer,
  type inferFlattenedErrors,
  type inferFormattedError,
  type input,
  instanceOfType as instanceof,
  intersectionType as intersection,
  isAborted,
  isAsync,
  isDirty,
  isValid,
  late,
  lazyType as lazy,
  literalType as literal,
  makeIssue,
  mapType as map,
  type mergeTypes,
  nanType as nan,
  nativeEnumType as nativeEnum,
  neverType as never,
  type noUnrecognized,
  nullType as null,
  nullableType as nullable,
  numberType as number,
  objectType as object,
  type objectInputType,
  type objectOutputType,
  objectUtil,
  oboolean,
  onumber,
  optionalType as optional,
  ostring,
  type output,
  pipelineType as pipeline,
  preprocessType as preprocess,
  promiseType as promise,
  quotelessJson,
  recordType as record,
  setType as set,
  setErrorMap,
  strictObjectType as strictObject,
  stringType as string,
  symbolType as symbol,
  effectsType as transformer,
  tupleType as tuple,
  type typeToFlattenedError,
  type typecast,
  undefinedType as undefined,
  unionType as union,
  unknownType as unknown,
  util,
  voidType as void,
  z,
};
`,pH={libs:{dayjs:s2e,"big.js":n2e,zod:c2e,http:a2e,zen:l2e},globals:{"global.d.ts":r2e}},y3e=o2e,d2e=({disabled:s=!1,disableDebug:e,language:t="javascript",defaultValue:i,value:n,onChange:o,trace:r,onMonacoReady:a,error:l,inputData:c})=>{const d=QX(),h=ce.useRef(!1),{token:u}=fP.useToken(),[g,f]=ce.useState(),[m,_]=ce.useState(),b=FH(w=>{o?.(w)},100),[v,C]=ce.useState(),y=YY(()=>v?.layout(),100,{trailing:!0});return ce.useEffect(()=>(window.addEventListener("resize",y),()=>window.removeEventListener("resize",y)),[y,v]),ce.useEffect(()=>{d&&(d.languages.typescript.javascriptDefaults.setCompilerOptions({target:d.languages.typescript.ScriptTarget.ES2020,module:d.languages.typescript.ModuleKind.ESNext,moduleResolution:d.languages.typescript.ModuleResolutionKind.NodeJs,allowSyntheticDefaultImports:!0,allowNonTsExtensions:!0,allowJs:!0,checkJs:!0,lib:["es2023"]}),d.languages.typescript.javascriptDefaults.setDiagnosticsOptions({noSyntaxValidation:!1,noSemanticValidation:!1,noSuggestionDiagnostics:!1,onlyVisible:!1}),Object.entries(pH.libs).forEach(([w,x])=>{d.languages.typescript.javascriptDefaults.addExtraLib(`declare module '${w}' { ${x} }`,w)}),Object.entries(pH.globals).forEach(([w,x])=>{d.languages.typescript.javascriptDefaults.addExtraLib(x,`ts:${w}`)}),a?.(d))},[d]),ce.useEffect(()=>{h.current&&n!==void 0&&n!==g&&f(n)},[n]),ce.useEffect(()=>{f(n===void 0?i:n),h.current=!0},[]),ce.useEffect(()=>{if(!d)return;const w=i2e(kG(c));d.languages.typescript.javascriptDefaults.addExtraLib(`
    type Input = ${w};
    type Output = Promise<any>;
    
    type Handler = (input: Input) => Output; 
    `,"ts:input.d.ts")},[d,c]),ce.useEffect(()=>{if(!d)return;const w=d.editor.getModels()?.[0];w&&d.editor.setModelMarkers(w,"gorules",[])},[g,d]),ce.useEffect(()=>{m&&(m.clear(),_(void 0))},[g]),ce.useEffect(()=>{try{if(!l||!d)return;const w=/Error:(\[.*])?(:?\d+)?(:\d+)?(.*)/s.exec(l.data.source??"");if(!w||w.length===0)return;const x=parseFloat((w?.[2]??"").replace(/^:/,"")),L=w?.[4]??"";if(!x||!L)return;const D=d.editor.getModels()[0];if(!D)return;const T=new d.Range(x,D.getLineFirstNonWhitespaceColumn(x),x,D.getLineLastNonWhitespaceColumn(x));d.editor.setModelMarkers(D,"gorules",[{severity:kj.Error,message:L,startLineNumber:T.startLineNumber,endLineNumber:T.endLineNumber,startColumn:T.startColumn,endColumn:T.endColumn}]);const F=d.editor.getEditors()[0];if(!F)return;const W=F.createDecorationsCollection([{range:T,options:{hoverMessage:{value:L},isWholeLine:!0,className:"grl-function__errorLineContent"}}]);_(H=>(H?.clear?.(),W))}catch{}},[l,v]),St.jsxs("div",{className:"grl-function","data-theme":u.mode,style:{height:"100%","--color-text":u.colorTextBase,"--color-background-elevated":u.colorBgElevated,"--color-border":u.colorBorder,"--line-height":u.lineHeight},children:[St.jsx(ZI,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",className:"grl-function__command-bar",children:St.jsx(ZI,{gap:8,horizontal:!0,className:"full-width",children:St.jsx(yP,{type:"text",size:"small",color:"default",icon:St.jsx(GY,{}),disabled:s,onClick:()=>{v?.getAction?.("editor.action.formatDocument")?.run?.()},children:"Format"})})}),St.jsxs("div",{className:"grl-function__content",children:[St.jsx(nQ,{loading:St.jsx(OH,{size:"large"}),language:t,value:g,onMount:w=>C(w),onChange:w=>{f(w??""),b(w??"")},theme:u.mode==="dark"?"vs-dark":"light",height:"100%",options:{automaticLayout:!0,contextmenu:!1,fontSize:13,fontFamily:"var(--mono-font-family)",readOnly:s,tabSize:2}}),!e&&St.jsx(iG,{trace:r})]})]})};d2e.__docgenInfo={description:"",methods:[],displayName:"Function",props:{disabled:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},defaultValue:{required:!1,tsType:{name:"string"},description:""},disableDebug:{required:!1,tsType:{name:"boolean"},description:""},language:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'javascript'",computed:!1}},value:{required:!1,tsType:{name:"string"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},trace:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  input: Input | null;
  output: Output | null;
  name: string;
  id: string;
  performance: string | null;
  traceData: Trace;
}`,signature:{properties:[{key:"input",value:{name:"union",raw:"Input | null",elements:[{name:"unknown"},{name:"null"}],required:!0}},{key:"output",value:{name:"union",raw:"Output | null",elements:[{name:"unknown"},{name:"null"}],required:!0}},{key:"name",value:{name:"string",required:!0}},{key:"id",value:{name:"string",required:!0}},{key:"performance",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!0}},{key:"traceData",value:{name:"signature",type:"object",raw:`{
  log?: TraceFunctionLog[];
}`,signature:{properties:[{key:"log",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  lines: string[];
  msSinceRun: number;
}`,signature:{properties:[{key:"lines",value:{name:"Array",elements:[{name:"string"}],raw:"string[]",required:!0}},{key:"msSinceRun",value:{name:"number",required:!0}}]}}],raw:"TraceFunctionLog[]",required:!1}}]},required:!0}}]}},description:""},onMonacoReady:{required:!1,tsType:{name:"signature",type:"function",raw:"(monaco: Monaco) => void",signature:{arguments:[{type:{name:"Monaco"},name:"monaco"}],return:{name:"void"}}},description:""},inputData:{required:!1,tsType:{name:"unknown"},description:""},error:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  data: { nodeId: string; source?: string };
}`,signature:{properties:[{key:"data",value:{name:"signature",type:"object",raw:"{ nodeId: string; source?: string }",signature:{properties:[{key:"nodeId",value:{name:"string",required:!0}},{key:"source",value:{name:"string",required:!1}}]},required:!0}}]}},description:""}}};export{yP as B,d2e as F,RY as R,ZI as S,DH as T,$G as W,FH as a,GY as b,b2e as c,y3e as d,OH as e,nQ as f,jC as m,AG as r,$j as t,FG as u};
