import{j as o}from"./index-CQHSiloJ.js";import{c as g,C as fe,a as S}from"./ce-base-WZGwKeKc.js";import{D as le,u as ve,f as be,L as ge,C as H,d as A,S as Z,a as P,A as xe,T as U}from"./focus-helper-ZxZ0PQkW.js";import{r as i,R as ke}from"./index-DQDNmYQF.js";import{l as we,m as je,r as Ne,n as Ce,C as ie,e as J,v as Oe,A as Ie,B as Se,E as Pe,F as Me,z as C,N as ce,G as ee,t as Ae}from"./index-BPZMdQjL.js";import{i as _e,g as Ee,P as qe,a as We,b as Be,T as Te}from"./index-Bc_E4zOA.js";import{g as $e}from"./Overflow-BaFppTl7.js";const $=e=>e?typeof e=="function"?e():e:null,ze=e=>{const{componentCls:t,popoverColor:n,titleMinWidth:a,fontWeightStrong:r,innerPadding:s,boxShadowSecondary:l,colorTextHeading:p,borderRadiusLG:u,zIndexPopup:m,titleMarginBottom:h,colorBgElevated:j,popoverBg:x,titleBorderBottom:b,innerContentPadding:k,titlePadding:y}=e;return[{[t]:Object.assign(Object.assign({},Ne(e)),{position:"absolute",top:0,left:{_skip_check_:!0,value:0},zIndex:m,fontWeight:"normal",whiteSpace:"normal",textAlign:"start",cursor:"auto",userSelect:"text","--valid-offset-x":"var(--arrow-offset-horizontal, var(--arrow-x))",transformOrigin:["var(--valid-offset-x, 50%)","var(--arrow-y, 50%)"].join(" "),"--antd-arrow-background-color":j,width:"max-content",maxWidth:"100vw","&-rtl":{direction:"rtl"},"&-hidden":{display:"none"},[`${t}-content`]:{position:"relative"},[`${t}-inner`]:{backgroundColor:x,backgroundClip:"padding-box",borderRadius:u,boxShadow:l,padding:s},[`${t}-title`]:{minWidth:a,marginBottom:h,color:p,fontWeight:r,borderBottom:b,padding:y},[`${t}-inner-content`]:{color:n,padding:k}})},Ee(e,"var(--antd-arrow-background-color)"),{[`${t}-pure`]:{position:"relative",maxWidth:"none",margin:e.sizePopupArrow,display:"inline-block",[`${t}-content`]:{display:"inline-block"}}}]},De=e=>{const{componentCls:t}=e;return{[t]:qe.map(n=>{const a=e[`${n}6`];return{[`&${t}-${n}`]:{"--antd-arrow-background-color":a,[`${t}-inner`]:{backgroundColor:a},[`${t}-arrow`]:{background:"transparent"}}}})}},Re=e=>{const{lineWidth:t,controlHeight:n,fontHeight:a,padding:r,wireframe:s,zIndexPopupBase:l,borderRadiusLG:p,marginXS:u,lineType:m,colorSplit:h,paddingSM:j}=e,x=n-a,b=x/2,k=x/2-t,y=r;return Object.assign(Object.assign(Object.assign({titleMinWidth:177,zIndexPopup:l+30},Ce(e)),We({contentRadius:p,limitVerticalRadius:!0})),{innerPadding:s?0:12,titleMarginBottom:s?0:u,titlePadding:s?`${b}px ${y}px ${k}px`:0,titleBorderBottom:s?`${t}px ${m} ${h}`:"none",innerContentPadding:s?`${j}px ${y}px`:0})},ue=we("Popover",e=>{const{colorBgElevated:t,colorText:n}=e,a=je(e,{popoverBg:t,popoverColor:n});return[ze(a),De(a),_e(a,"zoom-big")]},Re,{resetStyle:!1,deprecatedTokens:[["width","titleMinWidth"],["minWidth","titleMinWidth"]]});var Le=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n};const pe=e=>{let{title:t,content:n,prefixCls:a}=e;return!t&&!n?null:i.createElement(i.Fragment,null,t&&i.createElement("div",{className:`${a}-title`},t),n&&i.createElement("div",{className:`${a}-inner-content`},n))},Ve=e=>{const{hashId:t,prefixCls:n,className:a,style:r,placement:s="top",title:l,content:p,children:u}=e,m=$(l),h=$(p),j=J(t,n,`${n}-pure`,`${n}-placement-${s}`,a);return i.createElement("div",{className:j,style:r},i.createElement("div",{className:`${n}-arrow`}),i.createElement(Be,Object.assign({},e,{className:t,prefixCls:n}),u||i.createElement(pe,{prefixCls:n,title:m,content:h})))},Ye=e=>{const{prefixCls:t,className:n}=e,a=Le(e,["prefixCls","className"]),{getPrefixCls:r}=i.useContext(ie),s=r("popover",t),[l,p,u]=ue(s);return l(i.createElement(Ve,Object.assign({},a,{prefixCls:s,hashId:p,className:J(n,u)})))};var Fe=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n};const He=i.forwardRef((e,t)=>{var n,a;const{prefixCls:r,title:s,content:l,overlayClassName:p,placement:u="top",trigger:m="hover",children:h,mouseEnterDelay:j=.1,mouseLeaveDelay:x=.1,onOpenChange:b,overlayStyle:k={}}=e,y=Fe(e,["prefixCls","title","content","overlayClassName","placement","trigger","children","mouseEnterDelay","mouseLeaveDelay","onOpenChange","overlayStyle"]),{getPrefixCls:c}=i.useContext(ie),I=c("popover",r),[D,E,R]=ue(I),L=c(),V=J(p,E,R),[v,Y]=Oe(!1,{value:(n=e.open)!==null&&n!==void 0?n:e.visible,defaultValue:(a=e.defaultOpen)!==null&&a!==void 0?a:e.defaultVisible}),q=(d,f)=>{Y(d,!0),b?.(d,f)},W=d=>{d.keyCode===Pe.ESC&&q(!1,d)},F=d=>{q(d)},M=$(s),N=$(l);return D(i.createElement(Te,Object.assign({placement:u,trigger:m,mouseEnterDelay:j,mouseLeaveDelay:x,overlayStyle:k},y,{prefixCls:I,overlayClassName:V,ref:t,open:v,onOpenChange:F,overlay:M||N?i.createElement(pe,{prefixCls:I,title:M,content:N}):null,transitionName:Ie(L,"zoom-big",y.transitionName),"data-popover-inject":!0}),Se(h,{onKeyDown:d=>{var f,w;i.isValidElement(h)&&((w=h==null?void 0:(f=h.props).onKeyDown)===null||w===void 0||w.call(f,d)),W(d)}})))}),de=He;de._InternalPanelDoNotUseOrYouWillBeFired=Ye;var Ge=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n};const{TimePicker:Ke,RangePicker:Ue}=le,Qe=i.forwardRef((e,t)=>i.createElement(Ue,Object.assign({},e,{picker:"time",mode:void 0,ref:t}))),_=i.forwardRef((e,t)=>{var{addon:n,renderExtraFooter:a,variant:r,bordered:s}=e,l=Ge(e,["addon","renderExtraFooter","variant","bordered"]);const[p]=Me("timePicker",r,s),u=i.useMemo(()=>{if(a)return a;if(n)return n},[n,a]);return i.createElement(Ke,Object.assign({},l,{mode:void 0,ref:t,renderExtraFooter:u,variant:p}))}),me=$e(_,"picker");_._InternalPanelDoNotUseOrYouWillBeFired=me;_.RangePicker=Qe;_._InternalPanelDoNotUseOrYouWillBeFired=me;/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],Xe=g("arrow-left-right",Je);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["path",{d:"M12 6v12",key:"1vza4d"}],["path",{d:"M17.196 9 6.804 15",key:"1ah31z"}],["path",{d:"m6.804 9 10.392 6",key:"1b6pxd"}]],et=g("asterisk",Ze);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],nt=g("calendar-check",tt);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=[["path",{d:"M16 19h6",key:"xwg31i"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 15V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8.5",key:"1scpom"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}]],rt=g("calendar-minus",at);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 13V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"3spt84"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M16 19h6",key:"xwg31i"}],["path",{d:"M19 16v6",key:"tddt3s"}]],st=g("calendar-plus",ot);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}]],it=g("circle-dot",lt);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"9",x2:"15",y1:"15",y2:"9",key:"1dfufj"}]],ut=g("circle-slash",ct);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=[["path",{d:"M12.338 21.994A10 10 0 1 1 21.925 13.227",key:"1i7shu"}],["path",{d:"M12 6v6l2 1",key:"19cm8n"}],["path",{d:"m14 18 4 4 4-4",key:"1waygx"}],["path",{d:"M18 14v8",key:"irew45"}]],te=g("clock-arrow-down",pt);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=[["path",{d:"M13.228 21.925A10 10 0 1 1 21.994 12.338",key:"1fzlyi"}],["path",{d:"M12 6v6l1.562.781",key:"1ujuk9"}],["path",{d:"m14 18 4-4 4 4",key:"ftkppy"}],["path",{d:"M18 22v-8",key:"su0gjh"}]],ne=g("clock-arrow-up",dt);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=[["line",{x1:"5",x2:"19",y1:"9",y2:"9",key:"1nwqeh"}],["line",{x1:"5",x2:"19",y1:"15",y2:"15",key:"g8yjpy"}],["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}]],yt=g("equal-not",mt);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=[["line",{x1:"5",x2:"19",y1:"9",y2:"9",key:"1nwqeh"}],["line",{x1:"5",x2:"19",y1:"15",y2:"15",key:"g8yjpy"}]],ft=g("equal",ht);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"m19 10-4 4",key:"1tz659"}],["path",{d:"m15 10 4 4",key:"1n7nei"}]],bt=g("list-x",vt);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],xt=g("search",gt);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=[["path",{d:"M5 4h1a3 3 0 0 1 3 3 3 3 0 0 1 3-3h1",key:"18xjzo"}],["path",{d:"M13 20h-1a3 3 0 0 1-3-3 3 3 0 0 1-3 3H5",key:"fj48gi"}],["path",{d:"M5 16H4a2 2 0 0 1-2-2v-4a2 2 0 0 1 2-2h1",key:"1n9rhb"}],["path",{d:"M13 8h7a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-7",key:"13ksps"}],["path",{d:"M9 7v10",key:"1vc8ob"}]],ae=g("text-cursor-input",kt),wt=[{kind:"string",label:"Text"},{kind:"number",label:"Number"},{kind:"boolean",label:"Boolean"},{kind:"date",label:"Date"}],Q=[{type:"eq",icon:ft,label:"equals"},{type:"neq",icon:yt,label:"not equals"},{type:"gt",symbol:">",label:"greater than"},{type:"gte",symbol:"≥",label:"greater or equal"},{type:"lt",symbol:"<",label:"less than"},{type:"lte",symbol:"≤",label:"less or equal"},{type:"in",icon:ge,label:"is one of"},{type:"notIn",icon:bt,label:"is not one of"},{type:"between",icon:Xe,label:"between"},{type:"null",icon:ut,label:"is empty"},{type:"notNull",icon:it,label:"is not empty"},{type:"any",icon:et,label:"any"},{type:"startsWith",icon:ae,label:"starts with"},{type:"endsWith",icon:ae,rotate:!0,label:"ends with"},{type:"contains",icon:xt,label:"contains"},{type:"dateAfter",icon:st,label:"after"},{type:"dateBefore",icon:rt,label:"before"},{type:"dateSame",icon:nt,label:"same day"},{type:"dateSameOrAfter",symbol:"≥",label:"same or after"},{type:"dateSameOrBefore",symbol:"≤",label:"same or before"},{type:"dateIsToday",icon:H,label:"is today"},{type:"timeGt",icon:ne,label:"time after"},{type:"timeGte",icon:ne,label:"time at or after"},{type:"timeLt",icon:te,label:"time before"},{type:"timeLte",icon:te,label:"time at or before"},{type:"dayOfWeekIn",icon:H,label:"day is one of"},{type:"quarterIn",icon:H,label:"quarter is one of"}],T=e=>Q.find(t=>t.type===e)??Q[0],X={string:["eq","neq","in","notIn","startsWith","endsWith","contains","null","notNull","any"],number:["eq","neq","gt","gte","lt","lte","in","notIn","between","null","notNull","any"],boolean:["eq","null","notNull","any"],date:["dateAfter","dateBefore","dateSame","dateSameOrAfter","dateSameOrBefore","dateIsToday","timeGt","timeGte","timeLt","timeLte","dayOfWeekIn","quarterIn","null","notNull","any"],any:Q.map(e=>e.type)},re={string:["eq","neq","in","startsWith","endsWith","contains"],number:["eq","neq","gt","gte","lt","lte"],boolean:["eq","null","notNull","any"],date:["dateAfter","dateBefore","dateSame","dateIsToday","dayOfWeekIn","quarterIn"],any:["eq","neq","gt","gte","lt","lte"]},z=["null","notNull","any","dateIsToday"],jt=[{value:"",label:"Exact"},{value:"day",label:"Day"},{value:"week",label:"Week"},{value:"month",label:"Month"},{value:"quarter",label:"Quarter"},{value:"year",label:"Year"}],Nt=e=>C(e?.type).with("string",()=>"string").with("number",()=>"number").with("boolean",()=>"boolean").with("date",()=>"date").otherwise(()=>"any"),G=(e,t)=>{const n=e.toLowerCase();return(t?.label?.toLowerCase().includes(n)||t?.value?.toLowerCase().includes(n))??!1},Ct=(e,t)=>{if(e?.type!=="string"||!e.enum)return null;const n=e.enum;if(n.type==="inline")return n.values.length?{values:n.values,loose:n.loose??!1}:null;const a=t?.[n.ref];return a?.length?{values:a,loose:n.loose??!1}:null},O=(e,t)=>C(e).with(ce.when(n=>z.includes(n)),()=>null).with("between",()=>({type:"interval",left:0,right:100,leftInclusive:!0,rightInclusive:!0})).with("in","notIn",()=>t==="number"?{type:"numberArray",values:[]}:{type:"stringArray",values:[]}).with("dateAfter","dateBefore","dateSame","dateSameOrAfter","dateSameOrBefore",()=>({type:"date",value:A().format("YYYY-MM-DD")})).with("timeGt","timeGte","timeLt","timeLte",()=>({type:"time",hour:9,minute:0})).with("dayOfWeekIn",()=>({type:"intArray",values:[1,2,3,4,5]})).with("quarterIn",()=>({type:"intArray",values:[1]})).with("startsWith","endsWith","contains",()=>({type:"string",value:""})).otherwise(()=>C(t).with("number",()=>({type:"number",value:0})).with("boolean",()=>({type:"boolean",value:!0})).otherwise(()=>({type:"string",value:""}))),K=({op:e,size:t,className:n})=>e.icon?o.jsx(e.icon,{size:t,className:n,style:e.rotate?{transform:"rotate(180deg)"}:void 0}):o.jsx("span",{className:n,style:{fontSize:t},children:e.symbol}),Ot=e=>{if(e.kind!=="simple")return null;const t=e.operator.type;if(t.startsWith("date")||t.startsWith("time")||t==="dayOfWeekIn"||t==="quarterIn")return"date";if(["startsWith","endsWith","contains"].includes(t))return"string";const n=e.value;return n?C(n.type).with("string","stringArray",()=>"string").with("number","numberArray","interval",()=>"number").with("boolean",()=>"boolean").with("date","time",()=>"date").otherwise(()=>null):null},It=(e,t)=>{if(e.kind!=="simple")return!0;const n=e.operator.type;if(!X[t].includes(n))return!1;if(z.includes(n))return!0;const a=e.value;return a?C(t).with("boolean",()=>a.type==="boolean").with("number",()=>["number","numberArray","interval"].includes(a.type)).with("string",()=>["string","stringArray"].includes(a.type)).with("date",()=>["date","time","intArray"].includes(a.type)).with("any",()=>!0).exhaustive():!0},St=(e,t)=>{const n=i.useMemo(()=>{const u=ee.parseUnary(e),m=u.toJson();return u.free(),m},[e]),a=i.useCallback(u=>{const m=ee.fromJson(u);t(m.serialize()),m.free()},[t]),r=i.useCallback(u=>{n.kind==="simple"&&a({kind:"simple",operator:n.operator,value:u})},[n,a]),[s,l]=i.useState(n.kind==="complex");i.useEffect(()=>{n.kind==="complex"&&l(!0)},[n.kind]);const p=i.useCallback(()=>l(u=>!u),[]);return{expr:n,update:a,setVal:r,isCustom:s,setIsCustom:l,toggleCustom:p}},Pt=ke.forwardRef(({value:e,onChange:t,disabled:n=!1,fieldType:a,maxRows:r=3},s)=>{const l=i.useRef(null),p=ve(),u={"--b-max-rows":r};i.useImperativeHandle(s,()=>({focus:()=>be(l.current)}));const m=Ct(a,p),h=m?.values??null,j=m?.loose??!1,x=Nt(a),b=!!h?.length,k=!b&&x==="any",{expr:y,update:c,setVal:I,isCustom:D,setIsCustom:E,toggleCustom:R}=St(e,t),[L,V]=i.useState(null),v=b?"string":k?L??Ot(y)??"string":x,Y=!k&&y.kind==="simple"&&!It(y,v),q=i.useCallback(d=>{V(d);const f=X[d][0];c({kind:"simple",operator:{type:f},value:O(f,d)})},[c]),W=i.useCallback(d=>{const f=y.kind==="simple"?y.value:null,w=B=>f?.type===B,he=C(d).with(ce.when(B=>z.includes(B)),()=>null).with("between",()=>w("interval")?f:O(d,v)).with("in","notIn",()=>w("stringArray")||w("numberArray")?f:O(d,v)).with("dateAfter","dateBefore","dateSame","dateSameOrAfter","dateSameOrBefore",()=>w("date")?f:O(d,v)).with("timeGt","timeGte","timeLt","timeLte",()=>w("time")?f:O(d,v)).with("dayOfWeekIn","quarterIn",()=>w("intArray")?f:O(d,v)).with("startsWith","endsWith","contains",()=>w("string")?f:O(d,v)).otherwise(()=>w(v==="number"?"number":v==="boolean"?"boolean":"string")?f:O(d,v));c({kind:"simple",operator:{type:d},value:he})},[y,v,c]),F=i.useCallback(d=>{E(!1),W(d)},[W,E]),M={kind:v,operator:y.kind==="simple"?y.operator.type:"eq",onSelect:F,onKindChange:k?q:void 0,onCustomToggle:R,disabled:n};if(D||Y||y.kind==="complex")return o.jsxs("div",{ref:l,className:"eb",style:u,children:[o.jsx(oe,{...M,isCustom:!0}),o.jsx(fe,{className:"eb-code",value:e,onChange:t,type:"unary",disabled:n,noStyle:!0,maxRows:r,placeholder:"Expression..."})]});const N=y.operator.type;return o.jsxs("div",{ref:l,className:"eb",style:u,children:[o.jsx(oe,{...M,operator:N}),z.includes(N)?N!=="any"&&o.jsx("span",{className:"eb-label",children:T(N).label}):b?o.jsx(zt,{value:y.value,onChange:I,operator:N,options:h,loose:j,disabled:n}):o.jsx(Mt,{value:y.value,onChange:I,operator:N,kind:v,disabled:n})]})}),oe=({kind:e,operator:t,isCustom:n,onSelect:a,onKindChange:r,onCustomToggle:s,disabled:l})=>{const[p,u]=i.useState(!1),[m,h]=i.useState(""),j=re[e].map(T),x=X[e].filter(c=>!re[e].includes(c)).map(T),b=x.filter(c=>!m||c.label.toLowerCase().includes(m.toLowerCase())),k=c=>{a(c),u(!1),h("")},y=o.jsxs("div",{className:"op-panel",children:[r&&o.jsx("div",{className:"op-types",children:wt.map(c=>o.jsx("button",{className:S("op-type-btn",{active:c.kind===e}),onClick:()=>r(c.kind),children:c.label},c.kind))}),o.jsxs("div",{className:"op-body",children:[o.jsxs("div",{className:"op-grid",children:[j.map(c=>o.jsxs("button",{className:S("op-tile",{active:c.type===t&&!n}),onClick:()=>k(c.type),children:[o.jsx(K,{op:c,size:20,className:"op-tile-icon"}),o.jsx("span",{className:"op-tile-label",children:c.label})]},c.type)),s&&o.jsxs("button",{className:S("op-tile","op-tile-wide",{active:n}),onClick:()=>{s(),u(!1)},children:[o.jsx(Z,{size:20,className:"op-tile-icon"}),o.jsx("span",{className:"op-tile-label",children:"custom"})]})]}),x.length>0&&o.jsxs("div",{className:"op-list-section",children:[o.jsx("input",{className:"op-search",placeholder:"Search...",value:m,onChange:c=>h(c.target.value)}),o.jsxs("div",{className:"op-list",children:[b.map(c=>o.jsxs("button",{className:S("op-row",{active:c.type===t&&!n}),onClick:()=>k(c.type),children:[o.jsx(K,{op:c,size:16,className:"op-row-icon"}),o.jsx("span",{className:"op-row-label",children:c.label})]},c.type)),!b.length&&o.jsx("div",{className:"op-empty",children:"No matches"})]})]})]})]});return o.jsx(de,{content:y,trigger:"click",open:p,onOpenChange:c=>{u(c),c||h("")},placement:"bottomLeft",overlayClassName:"op-dropdown-popover",arrow:!1,children:o.jsx("button",{className:S("op-trigger",{disabled:l}),disabled:l,children:n?o.jsx(Z,{size:14}):o.jsx(K,{op:T(t),size:14})})})},Mt=({value:e,onChange:t,operator:n,kind:a,disabled:r})=>C(n).with("between",()=>o.jsx($t,{value:e,onChange:t,disabled:r})).with("in","notIn",()=>o.jsx(Tt,{value:e,onChange:t,kind:a,disabled:r})).with("dateAfter","dateBefore","dateSame","dateSameOrAfter","dateSameOrBefore",()=>o.jsx(Et,{value:e,onChange:t,disabled:r})).with("timeGt","timeGte","timeLt","timeLte",()=>o.jsx(qt,{value:e,onChange:t,disabled:r})).with("dayOfWeekIn",()=>o.jsx(se,{value:e,onChange:t,disabled:r,options:Wt,defaultValues:[1,2,3,4,5]})).with("quarterIn",()=>o.jsx(se,{value:e,onChange:t,disabled:r,options:Bt,defaultValues:[1]})).otherwise(()=>C(a).with("boolean",()=>o.jsx(_t,{value:e,onChange:t,disabled:r})).with("number",()=>o.jsx(At,{value:e,onChange:t,disabled:r})).otherwise(()=>o.jsx(ye,{value:e,onChange:t,disabled:r}))),ye=({value:e,onChange:t,disabled:n})=>{const[a,r]=i.useState(e?.type==="string"?e.value:""),s=()=>t({type:"string",value:a});return o.jsx(xe,{className:"eb-input",value:a,maxRows:3,onChange:l=>r(l.target.value),onBlur:s,onKeyDown:l=>l.key==="Enter"&&!l.shiftKey&&s(),disabled:n})},At=({value:e,onChange:t,disabled:n})=>o.jsx(U,{className:"eb-number",value:e?.type==="number"?e.value:0,onChange:a=>a!==null&&t({type:"number",value:a}),disabled:n,variant:"borderless",size:"small",controls:!1}),_t=({value:e,onChange:t,disabled:n})=>o.jsx(P,{className:"eb-select",value:e?.type==="boolean"?e.value:!0,onChange:a=>t({type:"boolean",value:a}),disabled:n,variant:"borderless",size:"small",suffixIcon:null,popupMatchSelectWidth:80,options:[{value:!0,label:"true"},{value:!1,label:"false"}]}),Et=({value:e,onChange:t,disabled:n})=>{const a=e?.type==="date"?e.value:A().format("YYYY-MM-DD"),r=e?.type==="date"?e.granularity:void 0;return o.jsxs(o.Fragment,{children:[o.jsx(le,{className:"eb-date",value:A(a),onChange:s=>s&&t({type:"date",value:s.format("YYYY-MM-DD"),granularity:r}),disabled:n,variant:"borderless",size:"small",allowClear:!1}),o.jsx(P,{className:"eb-granularity",value:r??"",onChange:s=>t({type:"date",value:a,granularity:s||void 0}),options:jt,disabled:n,variant:"borderless",size:"small",suffixIcon:null})]})},qt=({value:e,onChange:t,disabled:n})=>o.jsx(_,{className:"eb-time",value:e?.type==="time"?A().hour(e.hour).minute(e.minute):A().hour(9).minute(0),onChange:a=>a&&t({type:"time",hour:a.hour(),minute:a.minute()}),disabled:n,variant:"borderless",size:"small",format:"HH:mm",allowClear:!1,needConfirm:!1}),Wt=[{v:1,l:"Mon"},{v:2,l:"Tue"},{v:3,l:"Wed"},{v:4,l:"Thu"},{v:5,l:"Fri"},{v:6,l:"Sat"},{v:7,l:"Sun"}],Bt=[{v:1,l:"Q1"},{v:2,l:"Q2"},{v:3,l:"Q3"},{v:4,l:"Q4"}],se=({value:e,onChange:t,disabled:n,options:a,defaultValues:r})=>{const s=e?.type==="intArray"?e.values:r,l=p=>{if(n)return;const u=s.includes(p)?s.filter(m=>m!==p):[...s,p].sort((m,h)=>m-h);u.length&&t({type:"intArray",values:u})};return o.jsx("div",{className:"eb-chips",children:a.map(p=>o.jsx("span",{className:S("eb-chip",{active:s.includes(p.v),disabled:n}),onClick:()=>l(p.v),children:p.l},p.v))})},Tt=({value:e,onChange:t,kind:n,disabled:a})=>{const r=i.useMemo(()=>e?.type==="stringArray"?e.values:e?.type==="numberArray"?e.values.map(String):[],[e]);return o.jsx(P,{className:"eb-tags",mode:"tags",value:r,onChange:s=>t(n==="number"?{type:"numberArray",values:s.map(l=>parseFloat(l)).filter(l=>!isNaN(l))}:{type:"stringArray",values:s}),disabled:a,variant:"borderless",size:"small",tokenSeparators:[","],suffixIcon:null})},$t=({value:e,onChange:t,disabled:n})=>{const{token:a}=Ae.useToken(),r=e?.type==="interval"?e:{left:0,right:100,leftInclusive:!0,rightInclusive:!0},s=l=>t({type:"interval",...r,...l});return o.jsxs("div",{className:"eb-interval",children:[o.jsx("span",{className:"eb-bracket",onClick:()=>!n&&s({leftInclusive:!r.leftInclusive}),children:r.leftInclusive?"[":"("}),o.jsx(U,{className:"eb-interval-num",value:r.left,onChange:l=>l!==null&&s({left:l}),disabled:n,variant:"borderless",size:"small",controls:!1}),o.jsx("span",{style:{color:a.colorTextSecondary},children:".."}),o.jsx(U,{className:"eb-interval-num",value:r.right,onChange:l=>l!==null&&s({right:l}),disabled:n,variant:"borderless",size:"small",controls:!1}),o.jsx("span",{className:"eb-bracket",onClick:()=>!n&&s({rightInclusive:!r.rightInclusive}),children:r.rightInclusive?"]":")"})]})},zt=({value:e,onChange:t,operator:n,options:a,loose:r,disabled:s})=>C(n).with("in","notIn",()=>o.jsx(P,{className:"eb-enum",mode:r?"tags":"multiple",value:e?.type==="stringArray"?e.values:[],onChange:l=>t({type:"stringArray",values:l}),options:a,disabled:s,variant:"borderless",size:"small",style:{flex:1,minWidth:80},suffixIcon:null,showSearch:!0,filterOption:G,...r?{tokenSeparators:[","]}:{}})).with("eq","neq",()=>r?o.jsx(P,{className:"eb-enum",mode:"tags",maxCount:1,value:e?.type==="string"&&e.value?[e.value]:[],onChange:l=>t({type:"string",value:l[0]??""}),options:a,disabled:s,variant:"borderless",size:"small",style:{flex:1,minWidth:80},suffixIcon:null,showSearch:!0,filterOption:G}):o.jsx(P,{className:"eb-enum",value:e?.type==="string"?e.value:void 0,onChange:l=>t({type:"string",value:l}),options:a,disabled:s,variant:"borderless",size:"small",style:{flex:1,minWidth:80},suffixIcon:null,showSearch:!0,filterOption:G})).otherwise(()=>o.jsx(ye,{value:e,onChange:t,disabled:s}));Pt.__docgenInfo={description:"",methods:[{name:"focus",docblock:null,modifiers:[],params:[],returns:null}],displayName:"ExpressionBuilder",props:{value:{required:!0,tsType:{name:"string"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},fieldType:{required:!1,tsType:{name:"z.infer",elements:[{name:"columnFieldTypeSchema"}],raw:"z.infer<typeof columnFieldTypeSchema>"},description:""},maxRows:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"3",computed:!1}}}};export{Pt as E,de as P,Ye as a,$ as g};
