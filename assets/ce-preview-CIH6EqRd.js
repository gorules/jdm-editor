import{j as o}from"./index-CQHSiloJ.js";import{R as L,r as l}from"./index-DQDNmYQF.js";import{t as U,i as V,z as W,N as _,c as z}from"./index-BPZMdQjL.js";import{c as Y,v as X,a as C,r as Z,z as P,b as O,E as G,d as K,s as Q,e as E,h as ee,C as te,f as ne}from"./ce-base-WZGwKeKc.js";import{T as S}from"./index-CMwgERd7.js";/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]],re=Y("bug",ae),se="zen-highlight-styles",ie=r=>{const n=r==="dark"?P:O,i=`${se}-${r}`;if(!(typeof document>"u"||document.getElementById(i))&&n.module){const s=document.createElement("style");s.id=i,s.textContent=n.module.getRules(),document.head.appendChild(s)}},oe=({code:r,theme:n="light",type:i="standard",placeholder:s})=>{if(!r.trim())return`<span class="cm-line">${s?`<span class="cm-placeholder">${s}</span>`:"<br />"}</span>`;try{const e=n==="dark"?P:O,u=G.create({doc:r,extensions:[K({type:i,lazy:!0})]}),t=Q(u);if(!t||t.length===0)return E(r);let a='<span class="cm-line"><span class="cm-lintRange">';return ee(r,t,e,(y,d)=>{d?a+=`<span class="${d}">${E(y)}</span>`:a+=E(y)},()=>{a+=`
</span></span><span class="cm-line"><span class="cm-lintRange">`}),a+="</span></span>",a}catch(e){return console.warn("Syntax highlighting failed:",e),E(r)}},I=L.forwardRef(({noStyle:r=!1,fullHeight:n=!1,strict:i=!1,maxRows:s,value:e,className:u,type:t="standard",variableType:a,expectedVariableType:y,lint:d=!0,placeholder:g,extension:h,initialSelection:v,onStateChange:p,disabled:T,onChange:q,style:m={},...w},b)=>{const{token:x}=U.useToken(),[k,N]=l.useState(null),[f,M]=l.useState(null),[,D]=l.useTransition();l.useEffect(()=>{ie(x.mode)},[x.mode]),l.useEffect(()=>{f?.length||N(null)},[f]);const H=l.useMemo(()=>oe({code:e??"",type:t,theme:x.mode,placeholder:g}),[e,t,x.mode,g]);l.useEffect(()=>{if(!e||!e.trim()||!d||!V()){M(null);return}D(()=>{const c=W([t,a]).with(["unary",_.nonNullable],()=>z(a).typeCheckUnary(e)).with(["standard",_.nonNullable],()=>z(a).typeCheck(e)).otherwise(()=>[]);M(X({source:e,expectedVariableType:y,expressionType:t,strict:i,types:c}))})},[e,d,a,y,t,i]);const J=l.useMemo(()=>{if(f){if(f.some(c=>c.severity==="error"))return"error";if(f.some(c=>c.severity==="warning"))return"warning";if(f.some(c=>c.severity==="info"))return"info";if(f.some(c=>c.severity==="hint"))return"hint"}},[f]),A=l.useCallback(c=>{if(!f?.length)return;const j=c.currentTarget.getBoundingClientRect();N({x:j.left,y:j.bottom,diagnostics:f})},[f]),F=l.useCallback(()=>{N(null)},[]);return o.jsx("div",{ref:b,tabIndex:0,className:C("grl-ce","grl-ce-highlighter",r&&"no-style",s&&!n&&"max-rows",n&&"full-height",u),style:{"--editorMaxRows":s,...m},...w,children:o.jsxs("div",{className:C("cm-editor"),"data-severity":J,children:[o.jsx("div",{className:C("cm-scroller"),children:o.jsx("div",{className:C("cm-content","cm-lineWrapping"),onMouseEnter:A,onMouseLeave:F,dangerouslySetInnerHTML:{__html:H}})}),k&&o.jsx("div",{className:"cm-tooltip-hover cm-tooltip cm-tooltip-below",style:{position:"fixed",top:`${k.y}px`,left:`${k.x}px`},children:o.jsx("ul",{className:"cm-tooltip-lint cm-tooltip-section",children:k.diagnostics.map((c,R)=>o.jsxs("li",{className:`cm-diagnostic cm-diagnostic-${c.severity}`,children:[o.jsx("span",{className:"cm-diagnosticText",children:o.jsx("div",{dangerouslySetInnerHTML:{__html:Z({text:c.message,className:"cm-diagnosticMessageToken"})}})}),c.source&&o.jsx("div",{className:"cm-diagnosticSource",children:c.source})]},R))})})]})})});I.__docgenInfo={description:"",methods:[],displayName:"CodeHighlighter",props:{maxRows:{required:!1,tsType:{name:"number"},description:""},value:{required:!1,tsType:{name:"string"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},onStateChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(state: EditorState) => void",signature:{arguments:[{type:{name:"EditorState"},name:"state"}],return:{name:"void"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},type:{required:!1,tsType:{name:"union",raw:"'unary' | 'standard' | 'template'",elements:[{name:"literal",value:"'unary'"},{name:"literal",value:"'standard'"},{name:"literal",value:"'template'"}]},description:"",defaultValue:{value:"'standard'",computed:!1}},lint:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},strict:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},fullHeight:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},noStyle:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},extension:{required:!1,tsType:{name:"signature",type:"function",raw:"(params: ExtensionParams) => Extension",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  type?: 'standard' | 'unary' | 'template';
}`,signature:{properties:[{key:"type",value:{name:"union",raw:"'standard' | 'unary' | 'template'",elements:[{name:"literal",value:"'standard'"},{name:"literal",value:"'unary'"},{name:"literal",value:"'template'"}],required:!1}}]}},name:"params"}],return:{name:"Extension"}}},description:""},livePreview:{required:!1,tsType:{name:"signature",type:"object",raw:"{ input: unknown; fromSimulation: boolean; result?: unknown }",signature:{properties:[{key:"input",value:{name:"unknown",required:!0}},{key:"fromSimulation",value:{name:"boolean",required:!0}},{key:"result",value:{name:"unknown",required:!1}}]}},description:""},variableType:{required:!1,tsType:{name:"any"},description:""},expectedVariableType:{required:!1,tsType:{name:"any"},description:""},lazy:{required:!1,tsType:{name:"boolean"},description:""},initialSelection:{required:!1,tsType:{name:"signature",type:"object",raw:"{ anchor: number; head?: number }",signature:{properties:[{key:"anchor",value:{name:"number",required:!0}},{key:"head",value:{name:"number",required:!1}}]}},description:""},style:{defaultValue:{value:"{}",computed:!1},required:!1}}};const le=(r,n)=>{const i=document.getSelection();if(i&&i.rangeCount>0){const u=i.getRangeAt(0),t=document.createRange();t.selectNodeContents(n),t.setEnd(u.startContainer,u.startOffset);const a=document.createRange();return a.selectNodeContents(n),a.setEnd(u.endContainer,u.endOffset),{anchor:t.toString().length,head:a.toString().length}}const s=document.caretPositionFromPoint(r.clientX,r.clientY);if(!s)return null;const e=document.createRange();return e.selectNodeContents(n),e.setEnd(s.offsetNode,s.offset),{anchor:e.toString().length}},B=L.forwardRef(({lazy:r=!1,value:n="",type:i="standard",disabled:s,onBlur:e,...u},t)=>{const[a,y]=l.useState(()=>r?{type:"lazy"}:{type:"edit"}),d=l.useRef(null),g=l.useRef(!1),h=l.useCallback(()=>{g.current=!0},[]),v=l.useCallback(()=>{g.current=!1},[]),p=l.useCallback(m=>{if(s||a.type!=="lazy")return;const w=d.current?le(m,d.current)??void 0:void 0;y({type:"edit",initialSelection:w})},[s,a.type]),T=l.useCallback(m=>{s||a.type!=="lazy"||g.current||y({type:"edit",initialSelection:{anchor:n.length}})},[s,a.type,n]),q=l.useCallback(m=>{e?.(m),r&&y({type:"lazy"})},[r,e]);return a.type==="edit"||!r?o.jsx(te,{ref:t,value:n,type:i,disabled:s,onBlur:q,initialSelection:a.type==="edit"?a.initialSelection:void 0,...u}):o.jsx(I,{ref:ne(d,t),type:i,value:n,onClick:p,onFocus:T,onMouseDown:h,onMouseUp:v,disabled:s,...u})});B.__docgenInfo={description:"",methods:[],displayName:"CodeEditor",props:{maxRows:{required:!1,tsType:{name:"number"},description:""},value:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"''",computed:!1}},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},onStateChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(state: EditorState) => void",signature:{arguments:[{type:{name:"EditorState"},name:"state"}],return:{name:"void"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},type:{required:!1,tsType:{name:"union",raw:"'unary' | 'standard' | 'template'",elements:[{name:"literal",value:"'unary'"},{name:"literal",value:"'standard'"},{name:"literal",value:"'template'"}]},description:"",defaultValue:{value:"'standard'",computed:!1}},lint:{required:!1,tsType:{name:"boolean"},description:""},strict:{required:!1,tsType:{name:"boolean"},description:""},fullHeight:{required:!1,tsType:{name:"boolean"},description:""},noStyle:{required:!1,tsType:{name:"boolean"},description:""},extension:{required:!1,tsType:{name:"signature",type:"function",raw:"(params: ExtensionParams) => Extension",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  type?: 'standard' | 'unary' | 'template';
}`,signature:{properties:[{key:"type",value:{name:"union",raw:"'standard' | 'unary' | 'template'",elements:[{name:"literal",value:"'standard'"},{name:"literal",value:"'unary'"},{name:"literal",value:"'template'"}],required:!1}}]}},name:"params"}],return:{name:"Extension"}}},description:""},livePreview:{required:!1,tsType:{name:"signature",type:"object",raw:"{ input: unknown; fromSimulation: boolean; result?: unknown }",signature:{properties:[{key:"input",value:{name:"unknown",required:!0}},{key:"fromSimulation",value:{name:"boolean",required:!0}},{key:"result",value:{name:"unknown",required:!1}}]}},description:""},variableType:{required:!1,tsType:{name:"any"},description:""},expectedVariableType:{required:!1,tsType:{name:"any"},description:""},lazy:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},initialSelection:{required:!1,tsType:{name:"signature",type:"object",raw:"{ anchor: number; head?: number }",signature:{properties:[{key:"anchor",value:{name:"number",required:!0}},{key:"head",value:{name:"number",required:!1}}]}},description:""}}};const ue=/("(?:[^\\"]|\\.)*")|[:,]/g;function $(r,n={}){const i=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),s=i===""?1/0:n.maxLength===void 0?80:n.maxLength;let{replacer:e}=n;return function u(t,a,y){t&&typeof t.toJSON=="function"&&(t=t.toJSON());const d=JSON.stringify(t,e);if(d===void 0)return d;const g=s-a.length-y;if(d.length<=g){const h=d.replace(ue,(v,p)=>p||`${v} `);if(h.length<=g)return h}if(e!=null&&(t=JSON.parse(d),e=void 0),typeof t=="object"&&t!==null){const h=a+i,v=[];let p=0,T,q;if(Array.isArray(t)){T="[",q="]";const{length:m}=t;for(;p<m;p++)v.push(u(t[p],h,p===m-1?0:1)||"null")}else{T="{",q="}";const m=Object.keys(t),{length:w}=m;for(;p<w;p++){const b=m[p],x=`${JSON.stringify(b)}: `,k=u(t[b],h,x.length+(p===w-1?0:1));k!==void 0&&v.push(x+k)}}if(v.length>0)return[T,i+v.join(`,
${h}`),q].join(`
${a}`)}return d}(r,"",0)}const de=({initial:r,expression:n,inputData:i,noPreviewText:s="Run simulation to see the results"})=>{const e=l.useMemo(()=>{if(i){if(!V()||n===r?.expression)return{type:"initial",value:$(r?.result,{maxLength:30})};if(!n)return{type:"none",value:"-"};try{const u=i.evaluateExpression(n);return{type:"success",value:$(u,{maxLength:30})}}catch(u){return{type:"error",value:u.toString()}}}},[i,n,r]);return o.jsxs("div",{children:[o.jsxs(S.Text,{style:{fontSize:12},children:["Live Preview ",o.jsx(re,{size:"1em",opacity:.5,color:"#077D16"})]}),o.jsx(S.Text,{style:{fontSize:12,display:"block"},type:"secondary",children:e?.type==="initial"?"Based on simulation data":"Based on live calculation"}),o.jsxs("div",{className:"grl-ce-preview",children:[(e?.type==="success"||e?.type==="initial")&&o.jsx(B,{value:e.value,disabled:!0,noStyle:!0,maxRows:3}),e?.type==="none"&&o.jsx(S.Text,{type:"secondary",ellipsis:!0,children:e.value}),e?.type==="error"&&o.jsx(S.Text,{type:"danger",ellipsis:!0,children:e.value}),!e&&o.jsx(S.Text,{type:"secondary",ellipsis:!0,children:s})]})]})};de.__docgenInfo={description:"",methods:[],displayName:"CodeEditorPreview",props:{initial:{required:!1,tsType:{name:"signature",type:"object",raw:"{ expression: string; result: unknown }",signature:{properties:[{key:"expression",value:{name:"string",required:!0}},{key:"result",value:{name:"unknown",required:!0}}]}},description:""},expression:{required:!0,tsType:{name:"string"},description:""},inputData:{required:!1,tsType:{name:"Variable"},description:""},noPreviewText:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'Run simulation to see the results'",computed:!1}}}};export{B as C,de as a};
