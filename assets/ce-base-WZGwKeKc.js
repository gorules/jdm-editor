import{r as zt,c as oo,g as TO,R as PO}from"./index-DQDNmYQF.js";import{j as MO}from"./index-CQHSiloJ.js";import{i as Kr,H as RO,z as se,N as Qt,b as _O,I as EO,J as DO,t as IO,c as Uc}from"./index-BPZMdQjL.js";function Bp(r){var t,e,i="";if(typeof r=="string"||typeof r=="number")i+=r;else if(typeof r=="object")if(Array.isArray(r)){var n=r.length;for(t=0;t<n;t++)r[t]&&(e=Bp(r[t]))&&(i&&(i+=" "),i+=e)}else for(e in r)r[e]&&(i&&(i+=" "),i+=e);return i}function BO(){for(var r,t,e=0,i="",n=arguments.length;e<n;e++)(r=arguments[e])&&(t=Bp(r))&&(i&&(i+=" "),i+=t);return i}/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LO=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),NO=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,i)=>i?i.toUpperCase():e.toLowerCase()),qc=r=>{const t=NO(r);return t.charAt(0).toUpperCase()+t.slice(1)},Lp=(...r)=>r.filter((t,e,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===e).join(" ").trim();/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var $O={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WO=zt.forwardRef(({color:r="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:i,className:n="",children:o,iconNode:l,...h},f)=>zt.createElement("svg",{ref:f,...$O,width:t,height:t,stroke:r,strokeWidth:i?Number(e)*24/Number(t):e,className:Lp("lucide",n),...h},[...l.map(([c,d])=>zt.createElement(c,d)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KT=(r,t)=>{const e=zt.forwardRef(({className:i,...n},o)=>zt.createElement(WO,{ref:o,iconNode:t,className:Lp(`lucide-${LO(qc(r))}`,`lucide-${r}`,i),...n}));return e.displayName=qc(r),e};function FO(...r){return r.length===2?Yc(r[0],r[1])||null:r.slice(1).reduce((e,i)=>Yc(e,i),r[0])||null}const Xc=new WeakMap;function Yc(r,t){if(r&&t){const e=Xc.get(r)||new WeakMap;Xc.set(r,e);const i=e.get(t)||(n=>{Kc(r,n),Kc(t,n)});return e.set(t,i),i}return r||t}function Kc(r,t){typeof r=="function"?r(t):r.current=t}const Np=1024;let HO=0,ze=class{constructor(t,e){this.from=t,this.to=e}};class ot{constructor(t={}){this.id=HO++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof t!="function"&&(t=he.match(t)),e=>{let i=t(e);return i===void 0?null:[this,i]}}}ot.closedBy=new ot({deserialize:r=>r.split(" ")});ot.openedBy=new ot({deserialize:r=>r.split(" ")});ot.group=new ot({deserialize:r=>r.split(" ")});ot.isolate=new ot({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});ot.contextHash=new ot({perNode:!0});ot.lookAhead=new ot({perNode:!0});ot.mounted=new ot({perNode:!0});class Gr{constructor(t,e,i){this.tree=t,this.overlay=e,this.parser=i}static get(t){return t&&t.props&&t.props[ot.mounted.id]}}const zO=Object.create(null);class he{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):zO,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(t.name==null?8:0),n=new he(t.name||"",e,t.id,i);if(t.props){for(let o of t.props)if(Array.isArray(o)||(o=o(n)),o){if(o[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[o[0].id]=o[1]}}return n}prop(t){return this.props[t.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(t){if(typeof t=="string"){if(this.name==t)return!0;let e=this.prop(ot.group);return e?e.indexOf(t)>-1:!1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return i=>{for(let n=i.prop(ot.group),o=-1;o<(n?n.length:0);o++){let l=e[o<0?i.name:n[o]];if(l)return l}}}}he.none=new he("",Object.create(null),0,8);class $h{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let i of this.types){let n=null;for(let o of t){let l=o(i);l&&(n||(n=Object.assign({},i.props)),n[l[0].id]=l[1])}e.push(n?new he(i.name,n,i.id,i.flags):i)}return new $h(e)}}const lo=new WeakMap,Gc=new WeakMap;var Mt;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(Mt||(Mt={}));class _t{constructor(t,e,i,n,o){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,o&&o.length){this.props=Object.create(null);for(let[l,h]of o)this.props[typeof l=="number"?l:l.id]=h}}toString(){let t=Gr.get(this);if(t&&!t.overlay)return t.tree.toString();let e="";for(let i of this.children){let n=i.toString();n&&(e&&(e+=","),e+=n)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new $o(this.topNode,t)}cursorAt(t,e=0,i=0){let n=lo.get(this)||this.topNode,o=new $o(n);return o.moveTo(t,e),lo.set(this,o._tree),o}get topNode(){return new ye(this,0,0,null)}resolve(t,e=0){let i=Zr(lo.get(this)||this.topNode,t,e,!1);return lo.set(this,i),i}resolveInner(t,e=0){let i=Zr(Gc.get(this)||this.topNode,t,e,!0);return Gc.set(this,i),i}resolveStack(t,e=0){return UO(this,t,e)}iterate(t){let{enter:e,leave:i,from:n=0,to:o=this.length}=t,l=t.mode||0,h=(l&Mt.IncludeAnonymous)>0;for(let f=this.cursor(l|Mt.IncludeAnonymous);;){let c=!1;if(f.from<=o&&f.to>=n&&(!h&&f.type.isAnonymous||e(f)!==!1)){if(f.firstChild())continue;c=!0}for(;c&&i&&(h||!f.type.isAnonymous)&&i(f),!f.nextSibling();){if(!f.parent())return;c=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:Hh(he.none,this.children,this.positions,0,this.children.length,0,this.length,(e,i,n)=>new _t(this.type,e,i,n,this.propValues),t.makeTree||((e,i,n)=>new _t(he.none,e,i,n)))}static build(t){return qO(t)}}_t.empty=new _t(he.none,[],[],0);class Wh{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Wh(this.buffer,this.index)}}class ln{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return he.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],o=n.name;if(/\W/.test(o)&&!n.isError&&(o=JSON.stringify(o)),t+=4,i==t)return o;let l=[];for(;t<i;)l.push(this.childString(t)),t=this.buffer[t+3];return o+"("+l.join(",")+")"}findChild(t,e,i,n,o){let{buffer:l}=this,h=-1;for(let f=t;f!=e&&!($p(o,n,l[f+1],l[f+2])&&(h=f,i>0));f=l[f+3]);return h}slice(t,e,i){let n=this.buffer,o=new Uint16Array(e-t),l=0;for(let h=t,f=0;h<e;){o[f++]=n[h++],o[f++]=n[h++]-i;let c=o[f++]=n[h++]-i;o[f++]=n[h++]-t,l=Math.max(l,c)}return new ln(o,l,this.set)}}function $p(r,t,e,i){switch(r){case-2:return e<t;case-1:return i>=t&&e<t;case 0:return e<t&&i>t;case 1:return e<=t&&i>t;case 2:return i>t;case 4:return!0}}function Zr(r,t,e,i){for(var n;r.from==r.to||(e<1?r.from>=t:r.from>t)||(e>-1?r.to<=t:r.to<t);){let l=!i&&r instanceof ye&&r.index<0?null:r.parent;if(!l)return r;r=l}let o=i?0:Mt.IgnoreOverlays;if(i)for(let l=r,h=l.parent;h;l=h,h=l.parent)l instanceof ye&&l.index<0&&((n=h.enter(t,e,o))===null||n===void 0?void 0:n.from)!=l.from&&(r=h);for(;;){let l=r.enter(t,e,o);if(!l)return r;r=l}}class Wp{cursor(t=0){return new $o(this,t)}getChild(t,e=null,i=null){let n=Zc(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return Zc(this,t,e,i)}resolve(t,e=0){return Zr(this,t,e,!1)}resolveInner(t,e=0){return Zr(this,t,e,!0)}matchContext(t){return ja(this.parent,t)}enterUnfinishedNodesBefore(t){let e=this.childBefore(t),i=this;for(;e;){let n=e.lastChild;if(!n||n.to!=e.to)break;n.type.isError&&n.from==n.to?(i=e,e=n.prevSibling):e=n}return i}get node(){return this}get next(){return this.parent}}class ye extends Wp{constructor(t,e,i,n){super(),this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,o=0){for(let l=this;;){for(let{children:h,positions:f}=l._tree,c=e>0?h.length:-1;t!=c;t+=e){let d=h[t],g=f[t]+l.from;if($p(n,i,g,g+d.length)){if(d instanceof ln){if(o&Mt.ExcludeBuffers)continue;let m=d.findChild(0,d.buffer.length,e,i-g,n);if(m>-1)return new nn(new VO(l,d,t,g),null,m)}else if(o&Mt.IncludeAnonymous||!d.type.isAnonymous||Fh(d)){let m;if(!(o&Mt.IgnoreMounts)&&(m=Gr.get(d))&&!m.overlay)return new ye(m.tree,g,t,l);let y=new ye(d,g,t,l);return o&Mt.IncludeAnonymous||!y.type.isAnonymous?y:y.nextChild(e<0?d.children.length-1:0,e,i,n)}}}if(o&Mt.IncludeAnonymous||!l.type.isAnonymous||(l.index>=0?t=l.index+e:t=e<0?-1:l._parent._tree.children.length,l=l._parent,!l))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&Mt.IgnoreOverlays)&&(n=Gr.get(this._tree))&&n.overlay){let o=t-this.from;for(let{from:l,to:h}of n.overlay)if((e>0?l<=o:l<o)&&(e<0?h>=o:h>o))return new ye(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Zc(r,t,e,i){let n=r.cursor(),o=[];if(!n.firstChild())return o;if(e!=null){for(let l=!1;!l;)if(l=n.type.is(e),!n.nextSibling())return o}for(;;){if(i!=null&&n.type.is(i))return o;if(n.type.is(t)&&o.push(n.node),!n.nextSibling())return i==null?o:[]}}function ja(r,t,e=t.length-1){for(let i=r;e>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(t[e]&&t[e]!=i.name)return!1;e--}}return!0}class VO{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}}class nn extends Wp{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,i){super(),this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}child(t,e,i){let{buffer:n}=this.context,o=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return o<0?null:new nn(this.context,this,o)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&Mt.ExcludeBuffers)return null;let{buffer:n}=this.context,o=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return o<0?null:new nn(this.context,this,o)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new nn(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new nn(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,o=i.buffer[this.index+3];if(o>n){let l=i.buffer[this.index+1];t.push(i.slice(n,o,l)),e.push(0)}return new _t(this.type,t,e,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Fp(r){if(!r.length)return null;let t=0,e=r[0];for(let o=1;o<r.length;o++){let l=r[o];(l.from>e.from||l.to<e.to)&&(e=l,t=o)}let i=e instanceof ye&&e.index<0?null:e.parent,n=r.slice();return i?n[t]=i:n.splice(t,1),new QO(n,e)}class QO{constructor(t,e){this.heads=t,this.node=e}get next(){return Fp(this.heads)}}function UO(r,t,e){let i=r.resolveInner(t,e),n=null;for(let o=i instanceof ye?i:i.context.parent;o;o=o.parent)if(o.index<0){let l=o.parent;(n||(n=[i])).push(l.resolve(t,e)),o=l}else{let l=Gr.get(o.tree);if(l&&l.overlay&&l.overlay[0].from<=t&&l.overlay[l.overlay.length-1].to>=t){let h=new ye(l.tree,l.overlay[0].from+o.from,-1,o);(n||(n=[i])).push(Zr(h,t,e,!1))}}return n?Fp(n):i}class $o{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof ye)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let i=t._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return t?(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0):!1}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return t?t instanceof ye?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,o=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return o<0?!1:(this.stack.push(this.index),this.yieldBuf(o))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?i&Mt.ExcludeBuffers?!1:this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Mt.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&Mt.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode)):!1;let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let n=i<0?0:this.stack[i]+4;if(this.index!=n)return this.yieldBuf(e.findChild(n,this.index,-1,0,4))}else{let n=e.buffer[this.index+3];if(n<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(n)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let o=0;o<this.index;o++)if(n.buffer.buffer[o+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;{index:e,_parent:i}=i)if(e>-1)for(let o=e+t,l=t<0?-1:i._tree.children.length;o!=l;o+=t){let h=i._tree.children[o];if(this.mode&Mt.IncludeAnonymous||h instanceof ln||!h.type.isAnonymous||Fh(h))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let n=this.index,o=this.stack.length;o>=0;){for(let l=t;l;l=l._parent)if(l.index==n){if(n==this.index)return l;e=l,i=o+1;break t}n=this.stack[--o]}for(let n=i;n<this.stack.length;n++)e=new nn(this.buffer,e,this.stack[n]);return this.bufferNode=new nn(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||t(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;;){if(n&&e&&e(this),n=this.type.isAnonymous,!i)return;if(this.nextSibling())break;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return ja(this.node.parent,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,o=this.stack.length-1;n>=0;o--){if(o<0)return ja(this._tree,t,n);let l=i[e.buffer[this.stack[o]]];if(!l.isAnonymous){if(t[n]&&t[n]!=l.name)return!1;n--}}return!0}}function Fh(r){return r.children.some(t=>t instanceof ln||!t.type.isAnonymous||Fh(t))}function qO(r){var t;let{buffer:e,nodeSet:i,maxBufferLength:n=Np,reused:o=[],minRepeatType:l=i.types.length}=r,h=Array.isArray(e)?new Wh(e,e.length):e,f=i.types,c=0,d=0;function g($,W,F,et,st,bt){let{id:at,start:j,end:Ot,size:St}=h,Wt=d,si=c;for(;St<0;)if(h.next(),St==-1){let Lt=o[at];F.push(Lt),et.push(j-$);return}else if(St==-3){c=at;return}else if(St==-4){d=at;return}else throw new RangeError(`Unrecognized record size: ${St}`);let oi=f[at],Ye,ki,un=j-$;if(Ot-j<=n&&(ki=A(h.pos-W,st))){let Lt=new Uint16Array(ki.size-ki.skip),fe=h.pos-ki.size,_e=Lt.length;for(;h.pos>fe;)_e=P(ki.start,Lt,_e);Ye=new ln(Lt,Ot-ki.start,i),un=ki.start-$}else{let Lt=h.pos-St;h.next();let fe=[],_e=[],Ci=at>=l?at:-1,xe=0,Ai=Ot;for(;h.pos>Lt;)Ci>=0&&h.id==Ci&&h.size>=0?(h.end<=Ai-n&&(b(fe,_e,j,xe,h.end,Ai,Ci,Wt,si),xe=fe.length,Ai=h.end),h.next()):bt>2500?m(j,Lt,fe,_e):g(j,Lt,fe,_e,Ci,bt+1);if(Ci>=0&&xe>0&&xe<fe.length&&b(fe,_e,j,xe,j,Ai,Ci,Wt,si),fe.reverse(),_e.reverse(),Ci>-1&&xe>0){let ps=y(oi,si);Ye=Hh(oi,fe,_e,0,fe.length,0,Ot-j,ps,ps)}else Ye=S(oi,fe,_e,Ot-j,Wt-Ot,si)}F.push(Ye),et.push(un)}function m($,W,F,et){let st=[],bt=0,at=-1;for(;h.pos>W;){let{id:j,start:Ot,end:St,size:Wt}=h;if(Wt>4)h.next();else{if(at>-1&&Ot<at)break;at<0&&(at=St-n),st.push(j,Ot,St),bt++,h.next()}}if(bt){let j=new Uint16Array(bt*4),Ot=st[st.length-2];for(let St=st.length-3,Wt=0;St>=0;St-=3)j[Wt++]=st[St],j[Wt++]=st[St+1]-Ot,j[Wt++]=st[St+2]-Ot,j[Wt++]=Wt;F.push(new ln(j,st[2]-Ot,i)),et.push(Ot-$)}}function y($,W){return(F,et,st)=>{let bt=0,at=F.length-1,j,Ot;if(at>=0&&(j=F[at])instanceof _t){if(!at&&j.type==$&&j.length==st)return j;(Ot=j.prop(ot.lookAhead))&&(bt=et[at]+j.length+Ot)}return S($,F,et,st,bt,W)}}function b($,W,F,et,st,bt,at,j,Ot){let St=[],Wt=[];for(;$.length>et;)St.push($.pop()),Wt.push(W.pop()+F-st);$.push(S(i.types[at],St,Wt,bt-st,j-bt,Ot)),W.push(st-F)}function S($,W,F,et,st,bt,at){if(bt){let j=[ot.contextHash,bt];at=at?[j].concat(at):[j]}if(st>25){let j=[ot.lookAhead,st];at=at?[j].concat(at):[j]}return new _t($,W,F,et,at)}function A($,W){let F=h.fork(),et=0,st=0,bt=0,at=F.end-n,j={size:0,start:0,skip:0};t:for(let Ot=F.pos-$;F.pos>Ot;){let St=F.size;if(F.id==W&&St>=0){j.size=et,j.start=st,j.skip=bt,bt+=4,et+=4,F.next();continue}let Wt=F.pos-St;if(St<0||Wt<Ot||F.start<at)break;let si=F.id>=l?4:0,oi=F.start;for(F.next();F.pos>Wt;){if(F.size<0)if(F.size==-3)si+=4;else break t;else F.id>=l&&(si+=4);F.next()}st=oi,et+=St,bt+=si}return(W<0||et==$)&&(j.size=et,j.start=st,j.skip=bt),j.size>4?j:void 0}function P($,W,F){let{id:et,start:st,end:bt,size:at}=h;if(h.next(),at>=0&&et<l){let j=F;if(at>4){let Ot=h.pos-(at-4);for(;h.pos>Ot;)F=P($,W,F)}W[--F]=j,W[--F]=bt-$,W[--F]=st-$,W[--F]=et}else at==-3?c=et:at==-4&&(d=et);return F}let B=[],N=[];for(;h.pos>0;)g(r.start||0,r.bufferStart||0,B,N,-1,0);let D=(t=r.length)!==null&&t!==void 0?t:B.length?N[0]+B[0].length:0;return new _t(f[r.topID],B.reverse(),N.reverse(),D)}const jc=new WeakMap;function Ro(r,t){if(!r.isAnonymous||t instanceof ln||t.type!=r)return 1;let e=jc.get(t);if(e==null){e=1;for(let i of t.children){if(i.type!=r||!(i instanceof _t)){e=1;break}e+=Ro(r,i)}jc.set(t,e)}return e}function Hh(r,t,e,i,n,o,l,h,f){let c=0;for(let b=i;b<n;b++)c+=Ro(r,t[b]);let d=Math.ceil(c*1.5/8),g=[],m=[];function y(b,S,A,P,B){for(let N=A;N<P;){let D=N,$=S[N],W=Ro(r,b[N]);for(N++;N<P;N++){let F=Ro(r,b[N]);if(W+F>=d)break;W+=F}if(N==D+1){if(W>d){let F=b[D];y(F.children,F.positions,0,F.children.length,S[D]+B);continue}g.push(b[D])}else{let F=S[N-1]+b[N-1].length-$;g.push(Hh(r,b,S,D,N,$,F,null,f))}m.push($+B-o)}}return y(t,e,i,n,0),(h||f)(g,m,l)}class Fi{constructor(t,e,i,n,o=!1,l=!1){this.from=t,this.to=e,this.tree=i,this.offset=n,this.open=(o?1:0)|(l?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(t,e=[],i=!1){let n=[new Fi(0,t.length,t,0,!1,i)];for(let o of e)o.to>t.length&&n.push(o);return n}static applyChanges(t,e,i=128){if(!e.length)return t;let n=[],o=1,l=t.length?t[0]:null;for(let h=0,f=0,c=0;;h++){let d=h<e.length?e[h]:null,g=d?d.fromA:1e9;if(g-f>=i)for(;l&&l.from<g;){let m=l;if(f>=m.from||g<=m.to||c){let y=Math.max(m.from,f)-c,b=Math.min(m.to,g)-c;m=y>=b?null:new Fi(y,b,m.tree,m.offset+c,h>0,!!d)}if(m&&n.push(m),l.to>g)break;l=o<t.length?t[o++]:null}if(!d)break;f=d.toA,c=d.toA-d.toB}return n}}class Hp{startParse(t,e,i){return typeof t=="string"&&(t=new XO(t)),i=i?i.length?i.map(n=>new ze(n.from,n.to)):[new ze(0,0)]:[new ze(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let o=n.advance();if(o)return o}}}class XO{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}function YO(r){return(t,e,i,n)=>new GO(t,r,e,i,n)}class Jc{constructor(t,e,i,n,o){this.parser=t,this.parse=e,this.overlay=i,this.target=n,this.from=o}}function td(r){if(!r.length||r.some(t=>t.from>=t.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(r))}class KO{constructor(t,e,i,n,o,l,h){this.parser=t,this.predicate=e,this.mounts=i,this.index=n,this.start=o,this.target=l,this.prev=h,this.depth=0,this.ranges=[]}}const Ja=new ot({perNode:!0});class GO{constructor(t,e,i,n,o){this.nest=e,this.input=i,this.fragments=n,this.ranges=o,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=t}advance(){if(this.baseParse){let i=this.baseParse.advance();if(!i)return null;if(this.baseParse=null,this.baseTree=i,this.startInner(),this.stoppedAt!=null)for(let n of this.inner)n.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let i=this.baseTree;return this.stoppedAt!=null&&(i=new _t(i.type,i.children,i.positions,i.length,i.propValues.concat([[Ja,this.stoppedAt]]))),i}let t=this.inner[this.innerDone],e=t.parse.advance();if(e){this.innerDone++;let i=Object.assign(Object.create(null),t.target.props);i[ot.mounted.id]=new Gr(e,t.overlay,t.parser),t.target.props=i}return null}get parsedPos(){if(this.baseParse)return 0;let t=this.input.length;for(let e=this.innerDone;e<this.inner.length;e++)this.inner[e].from<t&&(t=Math.min(t,this.inner[e].parse.parsedPos));return t}stopAt(t){if(this.stoppedAt=t,this.baseParse)this.baseParse.stopAt(t);else for(let e=this.innerDone;e<this.inner.length;e++)this.inner[e].parse.stopAt(t)}startInner(){let t=new JO(this.fragments),e=null,i=null,n=new $o(new ye(this.baseTree,this.ranges[0].from,0,null),Mt.IncludeAnonymous|Mt.IgnoreMounts);t:for(let o,l;;){let h=!0,f;if(this.stoppedAt!=null&&n.from>=this.stoppedAt)h=!1;else if(t.hasNode(n)){if(e){let c=e.mounts.find(d=>d.frag.from<=n.from&&d.frag.to>=n.to&&d.mount.overlay);if(c)for(let d of c.mount.overlay){let g=d.from+c.pos,m=d.to+c.pos;g>=n.from&&m<=n.to&&!e.ranges.some(y=>y.from<m&&y.to>g)&&e.ranges.push({from:g,to:m})}}h=!1}else if(i&&(l=ZO(i.ranges,n.from,n.to)))h=l!=2;else if(!n.type.isAnonymous&&(o=this.nest(n,this.input))&&(n.from<n.to||!o.overlay)){n.tree||jO(n);let c=t.findMounts(n.from,o.parser);if(typeof o.overlay=="function")e=new KO(o.parser,o.overlay,c,this.inner.length,n.from,n.tree,e);else{let d=nd(this.ranges,o.overlay||(n.from<n.to?[new ze(n.from,n.to)]:[]));d.length&&td(d),(d.length||!o.overlay)&&this.inner.push(new Jc(o.parser,d.length?o.parser.startParse(this.input,rd(c,d),d):o.parser.startParse(""),o.overlay?o.overlay.map(g=>new ze(g.from-n.from,g.to-n.from)):null,n.tree,d.length?d[0].from:n.from)),o.overlay?d.length&&(i={ranges:d,depth:0,prev:i}):h=!1}}else if(e&&(f=e.predicate(n))&&(f===!0&&(f=new ze(n.from,n.to)),f.from<f.to)){let c=e.ranges.length-1;c>=0&&e.ranges[c].to==f.from?e.ranges[c]={from:e.ranges[c].from,to:f.to}:e.ranges.push(f)}if(h&&n.firstChild())e&&e.depth++,i&&i.depth++;else for(;!n.nextSibling();){if(!n.parent())break t;if(e&&!--e.depth){let c=nd(this.ranges,e.ranges);c.length&&(td(c),this.inner.splice(e.index,0,new Jc(e.parser,e.parser.startParse(this.input,rd(e.mounts,c),c),e.ranges.map(d=>new ze(d.from-e.start,d.to-e.start)),e.target,c[0].from))),e=e.prev}i&&!--i.depth&&(i=i.prev)}}}}function ZO(r,t,e){for(let i of r){if(i.from>=e)break;if(i.to>t)return i.from<=t&&i.to>=e?2:1}return 0}function ed(r,t,e,i,n,o){if(t<e){let l=r.buffer[t+1];i.push(r.slice(t,e,l)),n.push(l-o)}}function jO(r){let{node:t}=r,e=[],i=t.context.buffer;do e.push(r.index),r.parent();while(!r.tree);let n=r.tree,o=n.children.indexOf(i),l=n.children[o],h=l.buffer,f=[o];function c(d,g,m,y,b,S){let A=e[S],P=[],B=[];ed(l,d,A,P,B,y);let N=h[A+1],D=h[A+2];f.push(P.length);let $=S?c(A+4,h[A+3],l.set.types[h[A]],N,D-N,S-1):t.toTree();return P.push($),B.push(N-y),ed(l,h[A+3],g,P,B,y),new _t(m,P,B,b)}n.children[o]=c(0,h.length,he.none,0,l.length,e.length-1);for(let d of f){let g=r.tree.children[d],m=r.tree.positions[d];r.yield(new ye(g,m+r.from,d,r._tree))}}class id{constructor(t,e){this.offset=e,this.done=!1,this.cursor=t.cursor(Mt.IncludeAnonymous|Mt.IgnoreMounts)}moveTo(t){let{cursor:e}=this,i=t-this.offset;for(;!this.done&&e.from<i;)e.to>=t&&e.enter(i,1,Mt.IgnoreOverlays|Mt.ExcludeBuffers)||e.next(!1)||(this.done=!0)}hasNode(t){if(this.moveTo(t.from),!this.done&&this.cursor.from+this.offset==t.from&&this.cursor.tree)for(let e=this.cursor.tree;;){if(e==t.tree)return!0;if(e.children.length&&e.positions[0]==0&&e.children[0]instanceof _t)e=e.children[0];else break}return!1}}let JO=class{constructor(t){var e;if(this.fragments=t,this.curTo=0,this.fragI=0,t.length){let i=this.curFrag=t[0];this.curTo=(e=i.tree.prop(Ja))!==null&&e!==void 0?e:i.to,this.inner=new id(i.tree,-i.offset)}else this.curFrag=this.inner=null}hasNode(t){for(;this.curFrag&&t.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=t.from&&this.curTo>=t.to&&this.inner.hasNode(t)}nextFrag(){var t;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let e=this.curFrag=this.fragments[this.fragI];this.curTo=(t=e.tree.prop(Ja))!==null&&t!==void 0?t:e.to,this.inner=new id(e.tree,-e.offset)}}findMounts(t,e){var i;let n=[];if(this.inner){this.inner.cursor.moveTo(t,1);for(let o=this.inner.cursor.node;o;o=o.parent){let l=(i=o.tree)===null||i===void 0?void 0:i.prop(ot.mounted);if(l&&l.parser==e)for(let h=this.fragI;h<this.fragments.length;h++){let f=this.fragments[h];if(f.from>=o.to)break;f.tree==this.curFrag.tree&&n.push({frag:f,pos:o.from-f.offset,mount:l})}}}return n}};function nd(r,t){let e=null,i=t;for(let n=1,o=0;n<r.length;n++){let l=r[n-1].to,h=r[n].from;for(;o<i.length;o++){let f=i[o];if(f.from>=h)break;f.to<=l||(e||(i=e=t.slice()),f.from<l?(e[o]=new ze(f.from,l),f.to>h&&e.splice(o+1,0,new ze(h,f.to))):f.to>h?e[o--]=new ze(h,f.to):e.splice(o--,1))}}return i}function tS(r,t,e,i){let n=0,o=0,l=!1,h=!1,f=-1e9,c=[];for(;;){let d=n==r.length?1e9:l?r[n].to:r[n].from,g=o==t.length?1e9:h?t[o].to:t[o].from;if(l!=h){let m=Math.max(f,e),y=Math.min(d,g,i);m<y&&c.push(new ze(m,y))}if(f=Math.min(d,g),f==1e9)break;d==f&&(l?(l=!1,n++):l=!0),g==f&&(h?(h=!1,o++):h=!0)}return c}function rd(r,t){let e=[];for(let{pos:i,mount:n,frag:o}of r){let l=i+(n.overlay?n.overlay[0].from:0),h=l+n.tree.length,f=Math.max(o.from,l),c=Math.min(o.to,h);if(n.overlay){let d=n.overlay.map(m=>new ze(m.from+i,m.to+i)),g=tS(t,d,f,c);for(let m=0,y=f;;m++){let b=m==g.length,S=b?c:g[m].from;if(S>y&&e.push(new Fi(y,S,n.tree,-l,o.from>=y||o.openStart,o.to<=S||o.openEnd)),b)break;y=g[m].to}}else e.push(new Fi(f,c,n.tree,-l,o.from>=l||o.openStart,o.to<=h||o.openEnd))}return e}let th=[],zp=[];(()=>{let r="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(t=>t?parseInt(t,36):1);for(let t=0,e=0;t<r.length;t++)(t%2?zp:th).push(e=e+r[t])})();function eS(r){if(r<768)return!1;for(let t=0,e=th.length;;){let i=t+e>>1;if(r<th[i])e=i;else if(r>=zp[i])t=i+1;else return!0;if(t==e)return!1}}function sd(r){return r>=127462&&r<=127487}const od=8205;function iS(r,t,e=!0,i=!0){return(e?Vp:nS)(r,t,i)}function Vp(r,t,e){if(t==r.length)return t;t&&Qp(r.charCodeAt(t))&&Up(r.charCodeAt(t-1))&&t--;let i=_a(r,t);for(t+=ld(i);t<r.length;){let n=_a(r,t);if(i==od||n==od||e&&eS(n))t+=ld(n),i=n;else if(sd(n)){let o=0,l=t-2;for(;l>=0&&sd(_a(r,l));)o++,l-=2;if(o%2==0)break;t+=2}else break}return t}function nS(r,t,e){for(;t>0;){let i=Vp(r,t-2,e);if(i<t)return i;t--}return 0}function _a(r,t){let e=r.charCodeAt(t);if(!Up(e)||t+1==r.length)return e;let i=r.charCodeAt(t+1);return Qp(i)?(e-55296<<10)+(i-56320)+65536:e}function Qp(r){return r>=56320&&r<57344}function Up(r){return r>=55296&&r<56320}function ld(r){return r<65536?1:2}class ct{lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,i){[t,e]=ir(this,t,e);let n=[];return this.decompose(0,t,n,2),i.length&&i.decompose(0,i.length,n,3),this.decompose(e,this.length,n,1),gi.from(n,this.length-(e-t)+i.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){[t,e]=ir(this,t,e);let i=[];return this.decompose(t,e,i,0),gi.from(i,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),i=this.length-this.scanIdentical(t,-1),n=new Ur(this),o=new Ur(t);for(let l=e,h=e;;){if(n.next(l),o.next(l),l=0,n.lineBreak!=o.lineBreak||n.done!=o.done||n.value!=o.value)return!1;if(h+=n.value.length,n.done||h>=i)return!0}}iter(t=1){return new Ur(this,t)}iterRange(t,e=this.length){return new qp(this,t,e)}iterLines(t,e){let i;if(t==null)i=this.iter();else{e==null&&(e=this.lines+1);let n=this.line(t).from;i=this.iterRange(n,Math.max(n,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new Xp(i)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}constructor(){}static of(t){if(t.length==0)throw new RangeError("A document must have at least one line");return t.length==1&&!t[0]?ct.empty:t.length<=32?new Bt(t):gi.from(Bt.split(t,[]))}}class Bt extends ct{constructor(t,e=rS(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,i,n){for(let o=0;;o++){let l=this.text[o],h=n+l.length;if((e?i:h)>=t)return new sS(n,h,i,l);n=h+1,i++}}decompose(t,e,i,n){let o=t<=0&&e>=this.length?this:new Bt(ad(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(n&1){let l=i.pop(),h=_o(o.text,l.text.slice(),0,o.length);if(h.length<=32)i.push(new Bt(h,l.length+o.length));else{let f=h.length>>1;i.push(new Bt(h.slice(0,f)),new Bt(h.slice(f)))}}else i.push(o)}replace(t,e,i){if(!(i instanceof Bt))return super.replace(t,e,i);[t,e]=ir(this,t,e);let n=_o(this.text,_o(i.text,ad(this.text,0,t)),e),o=this.length+i.length-(e-t);return n.length<=32?new Bt(n,o):gi.from(Bt.split(n,[]),o)}sliceString(t,e=this.length,i=`
`){[t,e]=ir(this,t,e);let n="";for(let o=0,l=0;o<=e&&l<this.text.length;l++){let h=this.text[l],f=o+h.length;o>t&&l&&(n+=i),t<f&&e>o&&(n+=h.slice(Math.max(0,t-o),e-o)),o=f+1}return n}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let i=[],n=-1;for(let o of t)i.push(o),n+=o.length+1,i.length==32&&(e.push(new Bt(i,n)),i=[],n=-1);return n>-1&&e.push(new Bt(i,n)),e}}class gi extends ct{constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let i of t)this.lines+=i.lines}lineInner(t,e,i,n){for(let o=0;;o++){let l=this.children[o],h=n+l.length,f=i+l.lines-1;if((e?f:h)>=t)return l.lineInner(t,e,i,n);n=h+1,i=f+1}}decompose(t,e,i,n){for(let o=0,l=0;l<=e&&o<this.children.length;o++){let h=this.children[o],f=l+h.length;if(t<=f&&e>=l){let c=n&((l<=t?1:0)|(f>=e?2:0));l>=t&&f<=e&&!c?i.push(h):h.decompose(t-l,e-l,i,c)}l=f+1}}replace(t,e,i){if([t,e]=ir(this,t,e),i.lines<this.lines)for(let n=0,o=0;n<this.children.length;n++){let l=this.children[n],h=o+l.length;if(t>=o&&e<=h){let f=l.replace(t-o,e-o,i),c=this.lines-l.lines+f.lines;if(f.lines<c>>4&&f.lines>c>>6){let d=this.children.slice();return d[n]=f,new gi(d,this.length-(e-t)+i.length)}return super.replace(o,h,f)}o=h+1}return super.replace(t,e,i)}sliceString(t,e=this.length,i=`
`){[t,e]=ir(this,t,e);let n="";for(let o=0,l=0;o<this.children.length&&l<=e;o++){let h=this.children[o],f=l+h.length;l>t&&o&&(n+=i),t<f&&e>l&&(n+=h.sliceString(t-l,e-l,i)),l=f+1}return n}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof gi))return 0;let i=0,[n,o,l,h]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;n+=e,o+=e){if(n==l||o==h)return i;let f=this.children[n],c=t.children[o];if(f!=c)return i+f.scanIdentical(c,e);i+=f.length+1}}static from(t,e=t.reduce((i,n)=>i+n.length+1,-1)){let i=0;for(let y of t)i+=y.lines;if(i<32){let y=[];for(let b of t)b.flatten(y);return new Bt(y,e)}let n=Math.max(32,i>>5),o=n<<1,l=n>>1,h=[],f=0,c=-1,d=[];function g(y){let b;if(y.lines>o&&y instanceof gi)for(let S of y.children)g(S);else y.lines>l&&(f>l||!f)?(m(),h.push(y)):y instanceof Bt&&f&&(b=d[d.length-1])instanceof Bt&&y.lines+b.lines<=32?(f+=y.lines,c+=y.length+1,d[d.length-1]=new Bt(b.text.concat(y.text),b.length+1+y.length)):(f+y.lines>n&&m(),f+=y.lines,c+=y.length+1,d.push(y))}function m(){f!=0&&(h.push(d.length==1?d[0]:gi.from(d,c)),c=-1,f=d.length=0)}for(let y of t)g(y);return m(),h.length==1?h[0]:new gi(h,e)}}ct.empty=new Bt([""],0);function rS(r){let t=-1;for(let e of r)t+=e.length+1;return t}function _o(r,t,e=0,i=1e9){for(let n=0,o=0,l=!0;o<r.length&&n<=i;o++){let h=r[o],f=n+h.length;f>=e&&(f>i&&(h=h.slice(0,i-n)),n<e&&(h=h.slice(e-n)),l?(t[t.length-1]+=h,l=!1):t.push(h)),n=f+1}return t}function ad(r,t,e){return _o(r,[""],t,e)}class Ur{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof Bt?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,n=this.nodes[i],o=this.offsets[i],l=o>>1,h=n instanceof Bt?n.text.length:n.children.length;if(l==(e>0?h:0)){if(i==0)return this.done=!0,this.value="",this;e>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((o&1)==(e>0?0:1)){if(this.offsets[i]+=e,t==0)return this.lineBreak=!0,this.value=`
`,this;t--}else if(n instanceof Bt){let f=n.text[l+(e<0?-1:0)];if(this.offsets[i]+=e,f.length>Math.max(0,t))return this.value=t==0?f:e>0?f.slice(t):f.slice(0,f.length-t),this;t-=f.length}else{let f=n.children[l+(e<0?-1:0)];t>f.length?(t-=f.length,this.offsets[i]+=e):(e<0&&this.offsets[i]--,this.nodes.push(f),this.offsets.push(e>0?1:(f instanceof Bt?f.text.length:f.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class qp{constructor(t,e,i){this.value="",this.done=!1,this.cursor=new Ur(t,e>i?-1:1),this.pos=e>i?t.length:0,this.from=Math.min(e,i),this.to=Math.max(e,i)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let i=e<0?this.pos-this.from:this.to-this.pos;t>i&&(t=i),i-=t;let{value:n}=this.cursor.next(t);return this.pos+=(n.length+t)*e,this.value=n.length<=i?n:e<0?n.slice(n.length-i):n.slice(0,i),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class Xp{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:i,value:n}=this.inner.next(t);return e&&this.afterBreak?(this.value="",this.afterBreak=!1):e?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(ct.prototype[Symbol.iterator]=function(){return this.iter()},Ur.prototype[Symbol.iterator]=qp.prototype[Symbol.iterator]=Xp.prototype[Symbol.iterator]=function(){return this});class sS{constructor(t,e,i,n){this.from=t,this.to=e,this.number=i,this.text=n}get length(){return this.to-this.from}}function ir(r,t,e){return t=Math.max(0,Math.min(r.length,t)),[t,Math.max(t,Math.min(r.length,e))]}function yi(r,t,e=!0,i=!0){return iS(r,t,e,i)}function oS(r){return r>=56320&&r<57344}function lS(r){return r>=55296&&r<56320}function Fe(r,t){let e=r.charCodeAt(t);if(!lS(e)||t+1==r.length)return e;let i=r.charCodeAt(t+1);return oS(i)?(e-55296<<10)+(i-56320)+65536:e}function Yp(r){return r<=65535?String.fromCharCode(r):(r-=65536,String.fromCharCode((r>>10)+55296,(r&1023)+56320))}function $i(r){return r<65536?1:2}const eh=/\r\n?|\n/;var oe=function(r){return r[r.Simple=0]="Simple",r[r.TrackDel=1]="TrackDel",r[r.TrackBefore=2]="TrackBefore",r[r.TrackAfter=3]="TrackAfter",r}(oe||(oe={}));class bi{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e+1];t+=i<0?this.sections[e]:i}return t}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(t){for(let e=0,i=0,n=0;e<this.sections.length;){let o=this.sections[e++],l=this.sections[e++];l<0?(t(i,n,o),n+=o):n+=l,i+=o}}iterChangedRanges(t,e=!1){ih(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];n<0?t.push(i,n):t.push(n,i)}return new bi(t)}composeDesc(t){return this.empty?t:t.empty?this:Kp(this,t)}mapDesc(t,e=!1){return t.empty?this:nh(this,t,e)}mapPos(t,e=-1,i=oe.Simple){let n=0,o=0;for(let l=0;l<this.sections.length;){let h=this.sections[l++],f=this.sections[l++],c=n+h;if(f<0){if(c>t)return o+(t-n);o+=h}else{if(i!=oe.Simple&&c>=t&&(i==oe.TrackDel&&n<t&&c>t||i==oe.TrackBefore&&n<t||i==oe.TrackAfter&&c>t))return null;if(c>t||c==t&&e<0&&!h)return t==n||e<0?o:o+f;o+=f}n=c}if(t>n)throw new RangeError(`Position ${t} is out of range for changeset of length ${n}`);return o}touchesRange(t,e=t){for(let i=0,n=0;i<this.sections.length&&n<=e;){let o=this.sections[i++],l=this.sections[i++],h=n+o;if(l>=0&&n<=e&&h>=t)return n<t&&h>e?"cover":!0;n=h}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];t+=(t?" ":"")+i+(n>=0?":"+n:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some(e=>typeof e!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new bi(t)}static create(t){return new bi(t)}}class Vt extends bi{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return ih(this,(e,i,n,o,l)=>t=t.replace(n,n+(i-e),l),!1),t}mapDesc(t,e=!1){return nh(this,t,e,!0)}invert(t){let e=this.sections.slice(),i=[];for(let n=0,o=0;n<e.length;n+=2){let l=e[n],h=e[n+1];if(h>=0){e[n]=h,e[n+1]=l;let f=n>>1;for(;i.length<f;)i.push(ct.empty);i.push(l?t.slice(o,o+l):ct.empty)}o+=l}return new Vt(e,i)}compose(t){return this.empty?t:t.empty?this:Kp(this,t,!0)}map(t,e=!1){return t.empty?this:nh(this,t,e,!0)}iterChanges(t,e=!1){ih(this,t,e)}get desc(){return bi.create(this.sections)}filter(t){let e=[],i=[],n=[],o=new jr(this);t:for(let l=0,h=0;;){let f=l==t.length?1e9:t[l++];for(;h<f||h==f&&o.len==0;){if(o.done)break t;let d=Math.min(o.len,f-h);te(n,d,-1);let g=o.ins==-1?-1:o.off==0?o.ins:0;te(e,d,g),g>0&&rn(i,e,o.text),o.forward(d),h+=d}let c=t[l++];for(;h<c;){if(o.done)break t;let d=Math.min(o.len,c-h);te(e,d,-1),te(n,d,o.ins==-1?-1:o.off==0?o.ins:0),o.forward(d),h+=d}}return{changes:new Vt(e,i),filtered:bi.create(n)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e],n=this.sections[e+1];n<0?t.push(i):n==0?t.push([i]):t.push([i].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,i){let n=[],o=[],l=0,h=null;function f(d=!1){if(!d&&!n.length)return;l<e&&te(n,e-l,-1);let g=new Vt(n,o);h=h?h.compose(g.map(h)):g,n=[],o=[],l=0}function c(d){if(Array.isArray(d))for(let g of d)c(g);else if(d instanceof Vt){if(d.length!=e)throw new RangeError(`Mismatched change set length (got ${d.length}, expected ${e})`);f(),h=h?h.compose(d.map(h)):d}else{let{from:g,to:m=g,insert:y}=d;if(g>m||g<0||m>e)throw new RangeError(`Invalid change range ${g} to ${m} (in doc of length ${e})`);let b=y?typeof y=="string"?ct.of(y.split(i||eh)):y:ct.empty,S=b.length;if(g==m&&S==0)return;g<l&&f(),g>l&&te(n,g-l,-1),te(n,m-g,S),rn(o,n,b),l=m}}return c(t),f(!h),h}static empty(t){return new Vt(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let e=[],i=[];for(let n=0;n<t.length;n++){let o=t[n];if(typeof o=="number")e.push(o,-1);else{if(!Array.isArray(o)||typeof o[0]!="number"||o.some((l,h)=>h&&typeof l!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(o.length==1)e.push(o[0],0);else{for(;i.length<n;)i.push(ct.empty);i[n]=ct.of(o.slice(1)),e.push(o[0],i[n].length)}}}return new Vt(e,i)}static createSet(t,e){return new Vt(t,e)}}function te(r,t,e,i=!1){if(t==0&&e<=0)return;let n=r.length-2;n>=0&&e<=0&&e==r[n+1]?r[n]+=t:n>=0&&t==0&&r[n]==0?r[n+1]+=e:i?(r[n]+=t,r[n+1]+=e):r.push(t,e)}function rn(r,t,e){if(e.length==0)return;let i=t.length-2>>1;if(i<r.length)r[r.length-1]=r[r.length-1].append(e);else{for(;r.length<i;)r.push(ct.empty);r.push(e)}}function ih(r,t,e){let i=r.inserted;for(let n=0,o=0,l=0;l<r.sections.length;){let h=r.sections[l++],f=r.sections[l++];if(f<0)n+=h,o+=h;else{let c=n,d=o,g=ct.empty;for(;c+=h,d+=f,f&&i&&(g=g.append(i[l-2>>1])),!(e||l==r.sections.length||r.sections[l+1]<0);)h=r.sections[l++],f=r.sections[l++];t(n,c,o,d,g),n=c,o=d}}}function nh(r,t,e,i=!1){let n=[],o=i?[]:null,l=new jr(r),h=new jr(t);for(let f=-1;;){if(l.done&&h.len||h.done&&l.len)throw new Error("Mismatched change set lengths");if(l.ins==-1&&h.ins==-1){let c=Math.min(l.len,h.len);te(n,c,-1),l.forward(c),h.forward(c)}else if(h.ins>=0&&(l.ins<0||f==l.i||l.off==0&&(h.len<l.len||h.len==l.len&&!e))){let c=h.len;for(te(n,h.ins,-1);c;){let d=Math.min(l.len,c);l.ins>=0&&f<l.i&&l.len<=d&&(te(n,0,l.ins),o&&rn(o,n,l.text),f=l.i),l.forward(d),c-=d}h.next()}else if(l.ins>=0){let c=0,d=l.len;for(;d;)if(h.ins==-1){let g=Math.min(d,h.len);c+=g,d-=g,h.forward(g)}else if(h.ins==0&&h.len<d)d-=h.len,h.next();else break;te(n,c,f<l.i?l.ins:0),o&&f<l.i&&rn(o,n,l.text),f=l.i,l.forward(l.len-d)}else{if(l.done&&h.done)return o?Vt.createSet(n,o):bi.create(n);throw new Error("Mismatched change set lengths")}}}function Kp(r,t,e=!1){let i=[],n=e?[]:null,o=new jr(r),l=new jr(t);for(let h=!1;;){if(o.done&&l.done)return n?Vt.createSet(i,n):bi.create(i);if(o.ins==0)te(i,o.len,0,h),o.next();else if(l.len==0&&!l.done)te(i,0,l.ins,h),n&&rn(n,i,l.text),l.next();else{if(o.done||l.done)throw new Error("Mismatched change set lengths");{let f=Math.min(o.len2,l.len),c=i.length;if(o.ins==-1){let d=l.ins==-1?-1:l.off?0:l.ins;te(i,f,d,h),n&&d&&rn(n,i,l.text)}else l.ins==-1?(te(i,o.off?0:o.len,f,h),n&&rn(n,i,o.textBit(f))):(te(i,o.off?0:o.len,l.off?0:l.ins,h),n&&!l.off&&rn(n,i,l.text));h=(o.ins>f||l.ins>=0&&l.len>f)&&(h||i.length>c),o.forward2(f),l.forward(f)}}}}class jr{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?ct.empty:t[e]}textBit(t){let{inserted:e}=this.set,i=this.i-2>>1;return i>=e.length&&!t?ct.empty:e[i].slice(this.off,t==null?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){this.ins==-1?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class kn{constructor(t,e,i){this.from=t,this.to=e,this.flags=i}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let t=this.flags&7;return t==7?null:t}get goalColumn(){let t=this.flags>>6;return t==16777215?void 0:t}map(t,e=-1){let i,n;return this.empty?i=n=t.mapPos(this.from,e):(i=t.mapPos(this.from,1),n=t.mapPos(this.to,-1)),i==this.from&&n==this.to?this:new kn(i,n,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return V.range(t,e);let i=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return V.range(this.anchor,i)}eq(t,e=!1){return this.anchor==t.anchor&&this.head==t.head&&(!e||!this.empty||this.assoc==t.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return V.range(t.anchor,t.head)}static create(t,e,i){return new kn(t,e,i)}}class V{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:V.create(this.ranges.map(i=>i.map(t,e)),this.mainIndex)}eq(t,e=!1){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(t.ranges[i],e))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new V([this.main],0)}addRange(t,e=!0){return V.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let i=this.ranges.slice();return i[e]=t,V.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(t=>t.toJSON()),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||typeof t.main!="number"||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new V(t.ranges.map(e=>kn.fromJSON(e)),t.main)}static single(t,e=t){return new V([V.range(t,e)],0)}static create(t,e=0){if(t.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,n=0;n<t.length;n++){let o=t[n];if(o.empty?o.from<=i:o.from<i)return V.normalized(t.slice(),e);i=o.to}return new V(t,e)}static cursor(t,e=0,i,n){return kn.create(t,t,(e==0?0:e<0?8:16)|(i==null?7:Math.min(6,i))|(n??16777215)<<6)}static range(t,e,i,n){let o=(i??16777215)<<6|(n==null?7:Math.min(6,n));return e<t?kn.create(e,t,48|o):kn.create(t,e,(e>t?8:0)|o)}static normalized(t,e=0){let i=t[e];t.sort((n,o)=>n.from-o.from),e=t.indexOf(i);for(let n=1;n<t.length;n++){let o=t[n],l=t[n-1];if(o.empty?o.from<=l.to:o.from<l.to){let h=l.from,f=Math.max(o.to,l.to);n<=e&&e--,t.splice(--n,2,o.anchor>o.head?V.range(f,h):V.range(h,f))}}return new V(t,e)}}function Gp(r,t){for(let e of r.ranges)if(e.to>t)throw new RangeError("Selection points outside of document")}let zh=0;class X{constructor(t,e,i,n,o){this.combine=t,this.compareInput=e,this.compare=i,this.isStatic=n,this.id=zh++,this.default=t([]),this.extensions=typeof o=="function"?o(this):o}get reader(){return this}static define(t={}){return new X(t.combine||(e=>e),t.compareInput||((e,i)=>e===i),t.compare||(t.combine?(e,i)=>e===i:Vh),!!t.static,t.enables)}of(t){return new Eo([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Eo(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Eo(t,this,2,e)}from(t,e){return e||(e=i=>i),this.compute([t],i=>e(i.field(t)))}}function Vh(r,t){return r==t||r.length==t.length&&r.every((e,i)=>e===t[i])}class Eo{constructor(t,e,i,n){this.dependencies=t,this.facet=e,this.type=i,this.value=n,this.id=zh++}dynamicSlot(t){var e;let i=this.value,n=this.facet.compareInput,o=this.id,l=t[o]>>1,h=this.type==2,f=!1,c=!1,d=[];for(let g of this.dependencies)g=="doc"?f=!0:g=="selection"?c=!0:(((e=t[g.id])!==null&&e!==void 0?e:1)&1)==0&&d.push(t[g.id]);return{create(g){return g.values[l]=i(g),1},update(g,m){if(f&&m.docChanged||c&&(m.docChanged||m.selection)||rh(g,d)){let y=i(g);if(h?!hd(y,g.values[l],n):!n(y,g.values[l]))return g.values[l]=y,1}return 0},reconfigure:(g,m)=>{let y,b=m.config.address[o];if(b!=null){let S=Fo(m,b);if(this.dependencies.every(A=>A instanceof X?m.facet(A)===g.facet(A):A instanceof ve?m.field(A,!1)==g.field(A,!1):!0)||(h?hd(y=i(g),S,n):n(y=i(g),S)))return g.values[l]=S,0}else y=i(g);return g.values[l]=y,1}}}}function hd(r,t,e){if(r.length!=t.length)return!1;for(let i=0;i<r.length;i++)if(!e(r[i],t[i]))return!1;return!0}function rh(r,t){let e=!1;for(let i of t)qr(r,i)&1&&(e=!0);return e}function aS(r,t,e){let i=e.map(f=>r[f.id]),n=e.map(f=>f.type),o=i.filter(f=>!(f&1)),l=r[t.id]>>1;function h(f){let c=[];for(let d=0;d<i.length;d++){let g=Fo(f,i[d]);if(n[d]==2)for(let m of g)c.push(m);else c.push(g)}return t.combine(c)}return{create(f){for(let c of i)qr(f,c);return f.values[l]=h(f),1},update(f,c){if(!rh(f,o))return 0;let d=h(f);return t.compare(d,f.values[l])?0:(f.values[l]=d,1)},reconfigure(f,c){let d=rh(f,i),g=c.config.facets[t.id],m=c.facet(t);if(g&&!d&&Vh(e,g))return f.values[l]=m,0;let y=h(f);return t.compare(y,m)?(f.values[l]=m,0):(f.values[l]=y,1)}}}const ao=X.define({static:!0});class ve{constructor(t,e,i,n,o){this.id=t,this.createF=e,this.updateF=i,this.compareF=n,this.spec=o,this.provides=void 0}static define(t){let e=new ve(zh++,t.create,t.update,t.compare||((i,n)=>i===n),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet(ao).find(i=>i.field==this);return(e?.create||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:i=>(i.values[e]=this.create(i),1),update:(i,n)=>{let o=i.values[e],l=this.updateF(o,n);return this.compareF(o,l)?0:(i.values[e]=l,1)},reconfigure:(i,n)=>{let o=i.facet(ao),l=n.facet(ao),h;return(h=o.find(f=>f.field==this))&&h!=l.find(f=>f.field==this)?(i.values[e]=h.create(i),1):n.config.address[this.id]!=null?(i.values[e]=n.field(this),0):(i.values[e]=this.create(i),1)}}}init(t){return[this,ao.of({field:this,create:t})]}get extension(){return this}}const On={lowest:4,low:3,default:2,high:1,highest:0};function Ir(r){return t=>new Zp(t,r)}const as={highest:Ir(On.highest),high:Ir(On.high),default:Ir(On.default),low:Ir(On.low),lowest:Ir(On.lowest)};class Zp{constructor(t,e){this.inner=t,this.prec=e}}class pi{of(t){return new sh(this,t)}reconfigure(t){return pi.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class sh{constructor(t,e){this.compartment=t,this.inner=e}}class Wo{constructor(t,e,i,n,o,l){for(this.base=t,this.compartments=e,this.dynamicSlots=i,this.address=n,this.staticValues=o,this.facets=l,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return e==null?t.default:this.staticValues[e>>1]}static resolve(t,e,i){let n=[],o=Object.create(null),l=new Map;for(let m of hS(t,e,l))m instanceof ve?n.push(m):(o[m.facet.id]||(o[m.facet.id]=[])).push(m);let h=Object.create(null),f=[],c=[];for(let m of n)h[m.id]=c.length<<1,c.push(y=>m.slot(y));let d=i?.config.facets;for(let m in o){let y=o[m],b=y[0].facet,S=d&&d[m]||[];if(y.every(A=>A.type==0))if(h[b.id]=f.length<<1|1,Vh(S,y))f.push(i.facet(b));else{let A=b.combine(y.map(P=>P.value));f.push(i&&b.compare(A,i.facet(b))?i.facet(b):A)}else{for(let A of y)A.type==0?(h[A.id]=f.length<<1|1,f.push(A.value)):(h[A.id]=c.length<<1,c.push(P=>A.dynamicSlot(P)));h[b.id]=c.length<<1,c.push(A=>aS(A,b,y))}}let g=c.map(m=>m(h));return new Wo(t,l,g,h,f,o)}}function hS(r,t,e){let i=[[],[],[],[],[]],n=new Map;function o(l,h){let f=n.get(l);if(f!=null){if(f<=h)return;let c=i[f].indexOf(l);c>-1&&i[f].splice(c,1),l instanceof sh&&e.delete(l.compartment)}if(n.set(l,h),Array.isArray(l))for(let c of l)o(c,h);else if(l instanceof sh){if(e.has(l.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=t.get(l.compartment)||l.inner;e.set(l.compartment,c),o(c,h)}else if(l instanceof Zp)o(l.inner,l.prec);else if(l instanceof ve)i[h].push(l),l.provides&&o(l.provides,h);else if(l instanceof Eo)i[h].push(l),l.facet.extensions&&o(l.facet.extensions,On.default);else{let c=l.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${l}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);o(c,h)}}return o(r,On.default),i.reduce((l,h)=>l.concat(h))}function qr(r,t){if(t&1)return 2;let e=t>>1,i=r.status[e];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;r.status[e]=4;let n=r.computeSlot(r,r.config.dynamicSlots[e]);return r.status[e]=2|n}function Fo(r,t){return t&1?r.config.staticValues[t>>1]:r.values[t>>1]}const jp=X.define(),oh=X.define({combine:r=>r.some(t=>t),static:!0}),Jp=X.define({combine:r=>r.length?r[0]:void 0,static:!0}),tg=X.define(),eg=X.define(),ig=X.define(),ng=X.define({combine:r=>r.length?r[0]:!1});class Vi{constructor(t,e){this.type=t,this.value=e}static define(){return new fS}}class fS{of(t){return new Vi(this,t)}}class uS{constructor(t){this.map=t}of(t){return new ft(this,t)}}class ft{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return e===void 0?void 0:e==this.value?this:new ft(this.type,e)}is(t){return this.type==t}static define(t={}){return new uS(t.map||(e=>e))}static mapEffects(t,e){if(!t.length)return t;let i=[];for(let n of t){let o=n.map(e);o&&i.push(o)}return i}}ft.reconfigure=ft.define();ft.appendConfig=ft.define();class Ut{constructor(t,e,i,n,o,l){this.startState=t,this.changes=e,this.selection=i,this.effects=n,this.annotations=o,this.scrollIntoView=l,this._doc=null,this._state=null,i&&Gp(i,e.newLength),o.some(h=>h.type==Ut.time)||(this.annotations=o.concat(Ut.time.of(Date.now())))}static create(t,e,i,n,o,l){return new Ut(t,e,i,n,o,l)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(Ut.userEvent);return!!(e&&(e==t||e.length>t.length&&e.slice(0,t.length)==t&&e[t.length]=="."))}}Ut.time=Vi.define();Ut.userEvent=Vi.define();Ut.addToHistory=Vi.define();Ut.remote=Vi.define();function cS(r,t){let e=[];for(let i=0,n=0;;){let o,l;if(i<r.length&&(n==t.length||t[n]>=r[i]))o=r[i++],l=r[i++];else if(n<t.length)o=t[n++],l=t[n++];else return e;!e.length||e[e.length-1]<o?e.push(o,l):e[e.length-1]<l&&(e[e.length-1]=l)}}function rg(r,t,e){var i;let n,o,l;return e?(n=t.changes,o=Vt.empty(t.changes.length),l=r.changes.compose(t.changes)):(n=t.changes.map(r.changes),o=r.changes.mapDesc(t.changes,!0),l=r.changes.compose(n)),{changes:l,selection:t.selection?t.selection.map(o):(i=r.selection)===null||i===void 0?void 0:i.map(n),effects:ft.mapEffects(r.effects,n).concat(ft.mapEffects(t.effects,o)),annotations:r.annotations.length?r.annotations.concat(t.annotations):t.annotations,scrollIntoView:r.scrollIntoView||t.scrollIntoView}}function lh(r,t,e){let i=t.selection,n=Kn(t.annotations);return t.userEvent&&(n=n.concat(Ut.userEvent.of(t.userEvent))),{changes:t.changes instanceof Vt?t.changes:Vt.of(t.changes||[],e,r.facet(Jp)),selection:i&&(i instanceof V?i:V.single(i.anchor,i.head)),effects:Kn(t.effects),annotations:n,scrollIntoView:!!t.scrollIntoView}}function sg(r,t,e){let i=lh(r,t.length?t[0]:{},r.doc.length);t.length&&t[0].filter===!1&&(e=!1);for(let o=1;o<t.length;o++){t[o].filter===!1&&(e=!1);let l=!!t[o].sequential;i=rg(i,lh(r,t[o],l?i.changes.newLength:r.doc.length),l)}let n=Ut.create(r,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return pS(e?dS(n):n)}function dS(r){let t=r.startState,e=!0;for(let n of t.facet(tg)){let o=n(r);if(o===!1){e=!1;break}Array.isArray(o)&&(e=e===!0?o:cS(e,o))}if(e!==!0){let n,o;if(e===!1)o=r.changes.invertedDesc,n=Vt.empty(t.doc.length);else{let l=r.changes.filter(e);n=l.changes,o=l.filtered.mapDesc(l.changes).invertedDesc}r=Ut.create(t,n,r.selection&&r.selection.map(o),ft.mapEffects(r.effects,o),r.annotations,r.scrollIntoView)}let i=t.facet(eg);for(let n=i.length-1;n>=0;n--){let o=i[n](r);o instanceof Ut?r=o:Array.isArray(o)&&o.length==1&&o[0]instanceof Ut?r=o[0]:r=sg(t,Kn(o),!1)}return r}function pS(r){let t=r.startState,e=t.facet(ig),i=r;for(let n=e.length-1;n>=0;n--){let o=e[n](r);o&&Object.keys(o).length&&(i=rg(i,lh(t,o,r.changes.newLength),!0))}return i==r?r:Ut.create(t,r.changes,r.selection,i.effects,i.annotations,i.scrollIntoView)}const gS=[];function Kn(r){return r==null?gS:Array.isArray(r)?r:[r]}var Ve=function(r){return r[r.Word=0]="Word",r[r.Space=1]="Space",r[r.Other=2]="Other",r}(Ve||(Ve={}));const mS=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let ah;try{ah=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function wS(r){if(ah)return ah.test(r);for(let t=0;t<r.length;t++){let e=r[t];if(/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||mS.test(e)))return!0}return!1}function yS(r){return t=>{if(!/\S/.test(t))return Ve.Space;if(wS(t))return Ve.Word;for(let e=0;e<r.length;e++)if(t.indexOf(r[e])>-1)return Ve.Word;return Ve.Other}}class mt{constructor(t,e,i,n,o,l){this.config=t,this.doc=e,this.selection=i,this.values=n,this.status=t.statusTemplate.slice(),this.computeSlot=o,l&&(l._state=this);for(let h=0;h<this.config.dynamicSlots.length;h++)qr(this,h<<1);this.computeSlot=null}field(t,e=!0){let i=this.config.address[t.id];if(i==null){if(e)throw new RangeError("Field is not present in this state");return}return qr(this,i),Fo(this,i)}update(...t){return sg(this,t,!0)}applyTransaction(t){let e=this.config,{base:i,compartments:n}=e;for(let h of t.effects)h.is(pi.reconfigure)?(e&&(n=new Map,e.compartments.forEach((f,c)=>n.set(c,f)),e=null),n.set(h.value.compartment,h.value.extension)):h.is(ft.reconfigure)?(e=null,i=h.value):h.is(ft.appendConfig)&&(e=null,i=Kn(i).concat(h.value));let o;e?o=t.startState.values.slice():(e=Wo.resolve(i,n,this),o=new mt(e,this.doc,this.selection,e.dynamicSlots.map(()=>null),(f,c)=>c.reconfigure(f,this),null).values);let l=t.startState.facet(oh)?t.newSelection:t.newSelection.asSingle();new mt(e,t.newDoc,l,o,(h,f)=>f.update(h,t),t)}replaceSelection(t){return typeof t=="string"&&(t=this.toText(t)),this.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:t},range:V.cursor(e.from+t.length)}))}changeByRange(t){let e=this.selection,i=t(e.ranges[0]),n=this.changes(i.changes),o=[i.range],l=Kn(i.effects);for(let h=1;h<e.ranges.length;h++){let f=t(e.ranges[h]),c=this.changes(f.changes),d=c.map(n);for(let m=0;m<h;m++)o[m]=o[m].map(d);let g=n.mapDesc(c,!0);o.push(f.range.map(g)),n=n.compose(d),l=ft.mapEffects(l,d).concat(ft.mapEffects(Kn(f.effects),g))}return{changes:n,selection:V.create(o,e.mainIndex),effects:l}}changes(t=[]){return t instanceof Vt?t:Vt.of(t,this.doc.length,this.facet(mt.lineSeparator))}toText(t){return ct.of(t.split(this.facet(mt.lineSeparator)||eh))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return e==null?t.default:(qr(this,e),Fo(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let i in t){let n=t[i];n instanceof ve&&this.config.address[n.id]!=null&&(e[i]=n.spec.toJSON(this.field(t[i]),this))}return e}static fromJSON(t,e={},i){if(!t||typeof t.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(i){for(let o in i)if(Object.prototype.hasOwnProperty.call(t,o)){let l=i[o],h=t[o];n.push(l.init(f=>l.spec.fromJSON(h,f)))}}return mt.create({doc:t.doc,selection:V.fromJSON(t.selection),extensions:e.extensions?n.concat([e.extensions]):n})}static create(t={}){let e=Wo.resolve(t.extensions||[],new Map),i=t.doc instanceof ct?t.doc:ct.of((t.doc||"").split(e.staticFacet(mt.lineSeparator)||eh)),n=t.selection?t.selection instanceof V?t.selection:V.single(t.selection.anchor,t.selection.head):V.single(0);return Gp(n,i.length),e.staticFacet(oh)||(n=n.asSingle()),new mt(e,i,n,e.dynamicSlots.map(()=>null),(o,l)=>l.create(o),null)}get tabSize(){return this.facet(mt.tabSize)}get lineBreak(){return this.facet(mt.lineSeparator)||`
`}get readOnly(){return this.facet(ng)}phrase(t,...e){for(let i of this.facet(mt.phrases))if(Object.prototype.hasOwnProperty.call(i,t)){t=i[t];break}return e.length&&(t=t.replace(/\$(\$|\d*)/g,(i,n)=>{if(n=="$")return"$";let o=+(n||1);return!o||o>e.length?i:e[o-1]})),t}languageDataAt(t,e,i=-1){let n=[];for(let o of this.facet(jp))for(let l of o(this,e,i))Object.prototype.hasOwnProperty.call(l,t)&&n.push(l[t]);return n}charCategorizer(t){return yS(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:e,from:i,length:n}=this.doc.lineAt(t),o=this.charCategorizer(t),l=t-i,h=t-i;for(;l>0;){let f=yi(e,l,!1);if(o(e.slice(f,l))!=Ve.Word)break;l=f}for(;h<n;){let f=yi(e,h);if(o(e.slice(h,f))!=Ve.Word)break;h=f}return l==h?null:V.range(l+i,h+i)}}mt.allowMultipleSelections=oh;mt.tabSize=X.define({combine:r=>r.length?r[0]:4});mt.lineSeparator=Jp;mt.readOnly=ng;mt.phrases=X.define({compare(r,t){let e=Object.keys(r),i=Object.keys(t);return e.length==i.length&&e.every(n=>r[n]==t[n])}});mt.languageData=jp;mt.changeFilter=tg;mt.transactionFilter=eg;mt.transactionExtender=ig;pi.reconfigure=ft.define();function rl(r,t,e={}){let i={};for(let n of r)for(let o of Object.keys(n)){let l=n[o],h=i[o];if(h===void 0)i[o]=l;else if(!(h===l||l===void 0))if(Object.hasOwnProperty.call(e,o))i[o]=e[o](h,l);else throw new Error("Config merge conflict for field "+o)}for(let n in t)i[n]===void 0&&(i[n]=t[n]);return i}class Tn{eq(t){return this==t}range(t,e=t){return Jr.create(t,e,this)}}Tn.prototype.startSide=Tn.prototype.endSide=0;Tn.prototype.point=!1;Tn.prototype.mapMode=oe.TrackDel;class Jr{constructor(t,e,i){this.from=t,this.to=e,this.value=i}static create(t,e,i){return new Jr(t,e,i)}}function hh(r,t){return r.from-t.from||r.value.startSide-t.value.startSide}class Qh{constructor(t,e,i,n){this.from=t,this.to=e,this.value=i,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(t,e,i,n=0){let o=i?this.to:this.from;for(let l=n,h=o.length;;){if(l==h)return l;let f=l+h>>1,c=o[f]-t||(i?this.value[f].endSide:this.value[f].startSide)-e;if(f==l)return c>=0?l:h;c>=0?h=f:l=f+1}}between(t,e,i,n){for(let o=this.findIndex(e,-1e9,!0),l=this.findIndex(i,1e9,!1,o);o<l;o++)if(n(this.from[o]+t,this.to[o]+t,this.value[o])===!1)return!1}map(t,e){let i=[],n=[],o=[],l=-1,h=-1;for(let f=0;f<this.value.length;f++){let c=this.value[f],d=this.from[f]+t,g=this.to[f]+t,m,y;if(d==g){let b=e.mapPos(d,c.startSide,c.mapMode);if(b==null||(m=y=b,c.startSide!=c.endSide&&(y=e.mapPos(d,c.endSide),y<m)))continue}else if(m=e.mapPos(d,c.startSide),y=e.mapPos(g,c.endSide),m>y||m==y&&c.startSide>0&&c.endSide<=0)continue;(y-m||c.endSide-c.startSide)<0||(l<0&&(l=m),c.point&&(h=Math.max(h,y-m)),i.push(c),n.push(m-l),o.push(y-l))}return{mapped:i.length?new Qh(n,o,i,h):null,pos:l}}}class Ct{constructor(t,e,i,n){this.chunkPos=t,this.chunk=e,this.nextLayer=i,this.maxPoint=n}static create(t,e,i,n){return new Ct(t,e,i,n)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:i=!1,filterFrom:n=0,filterTo:o=this.length}=t,l=t.filter;if(e.length==0&&!l)return this;if(i&&(e=e.slice().sort(hh)),this.isEmpty)return e.length?Ct.of(e):this;let h=new og(this,null,-1).goto(0),f=0,c=[],d=new nr;for(;h.value||f<e.length;)if(f<e.length&&(h.from-e[f].from||h.startSide-e[f].value.startSide)>=0){let g=e[f++];d.addInner(g.from,g.to,g.value)||c.push(g)}else h.rangeIndex==1&&h.chunkIndex<this.chunk.length&&(f==e.length||this.chunkEnd(h.chunkIndex)<e[f].from)&&(!l||n>this.chunkEnd(h.chunkIndex)||o<this.chunkPos[h.chunkIndex])&&d.addChunk(this.chunkPos[h.chunkIndex],this.chunk[h.chunkIndex])?h.nextChunk():((!l||n>h.to||o<h.from||l(h.from,h.to,h.value))&&(d.addInner(h.from,h.to,h.value)||c.push(Jr.create(h.from,h.to,h.value))),h.next());return d.finishInner(this.nextLayer.isEmpty&&!c.length?Ct.empty:this.nextLayer.update({add:c,filter:l,filterFrom:n,filterTo:o}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],i=[],n=-1;for(let l=0;l<this.chunk.length;l++){let h=this.chunkPos[l],f=this.chunk[l],c=t.touchesRange(h,h+f.length);if(c===!1)n=Math.max(n,f.maxPoint),e.push(f),i.push(t.mapPos(h));else if(c===!0){let{mapped:d,pos:g}=f.map(h,t);d&&(n=Math.max(n,d.maxPoint),e.push(d),i.push(g))}}let o=this.nextLayer.map(t);return e.length==0?o:new Ct(i,e,o||Ct.empty,n)}between(t,e,i){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let o=this.chunkPos[n],l=this.chunk[n];if(e>=o&&t<=o+l.length&&l.between(o,t-o,e-o,i)===!1)return}this.nextLayer.between(t,e,i)}}iter(t=0){return ts.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return ts.from(t).goto(e)}static compare(t,e,i,n,o=-1){let l=t.filter(g=>g.maxPoint>0||!g.isEmpty&&g.maxPoint>=o),h=e.filter(g=>g.maxPoint>0||!g.isEmpty&&g.maxPoint>=o),f=fd(l,h,i),c=new Br(l,f,o),d=new Br(h,f,o);i.iterGaps((g,m,y)=>ud(c,g,d,m,y,n)),i.empty&&i.length==0&&ud(c,0,d,0,0,n)}static eq(t,e,i=0,n){n==null&&(n=999999999);let o=t.filter(d=>!d.isEmpty&&e.indexOf(d)<0),l=e.filter(d=>!d.isEmpty&&t.indexOf(d)<0);if(o.length!=l.length)return!1;if(!o.length)return!0;let h=fd(o,l),f=new Br(o,h,0).goto(i),c=new Br(l,h,0).goto(i);for(;;){if(f.to!=c.to||!fh(f.active,c.active)||f.point&&(!c.point||!f.point.eq(c.point)))return!1;if(f.to>n)return!0;f.next(),c.next()}}static spans(t,e,i,n,o=-1){let l=new Br(t,null,o).goto(e),h=e,f=l.openStart;for(;;){let c=Math.min(l.to,i);if(l.point){let d=l.activeForPoint(l.to),g=l.pointFrom<e?d.length+1:l.point.startSide<0?d.length:Math.min(d.length,f);n.point(h,c,l.point,d,g,l.pointRank),f=Math.min(l.openEnd(c),d.length)}else c>h&&(n.span(h,c,l.active,f),f=l.openEnd(c));if(l.to>i)return f+(l.point&&l.to>i?1:0);h=l.to,l.next()}}static of(t,e=!1){let i=new nr;for(let n of t instanceof Jr?[t]:e?vS(t):t)i.add(n.from,n.to,n.value);return i.finish()}static join(t){if(!t.length)return Ct.empty;let e=t[t.length-1];for(let i=t.length-2;i>=0;i--)for(let n=t[i];n!=Ct.empty;n=n.nextLayer)e=new Ct(n.chunkPos,n.chunk,e,Math.max(n.maxPoint,e.maxPoint));return e}}Ct.empty=new Ct([],[],null,-1);function vS(r){if(r.length>1)for(let t=r[0],e=1;e<r.length;e++){let i=r[e];if(hh(t,i)>0)return r.slice().sort(hh);t=i}return r}Ct.empty.nextLayer=Ct.empty;class nr{finishChunk(t){this.chunks.push(new Qh(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(t,e,i){this.addInner(t,e,i)||(this.nextLayer||(this.nextLayer=new nr)).add(t,e,i)}addInner(t,e,i){let n=t-this.lastTo||i.startSide-this.last.endSide;if(n<=0&&(t-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return n<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=i,this.lastFrom=t,this.lastTo=e,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let i=e.value.length-1;return this.last=e.value[i],this.lastFrom=e.from[i]+t,this.lastTo=e.to[i]+t,!0}finish(){return this.finishInner(Ct.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return t;let e=Ct.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}}function fd(r,t,e){let i=new Map;for(let o of r)for(let l=0;l<o.chunk.length;l++)o.chunk[l].maxPoint<=0&&i.set(o.chunk[l],o.chunkPos[l]);let n=new Set;for(let o of t)for(let l=0;l<o.chunk.length;l++){let h=i.get(o.chunk[l]);h!=null&&(e?e.mapPos(h):h)==o.chunkPos[l]&&!e?.touchesRange(h,h+o.chunk[l].length)&&n.add(o.chunk[l])}return n}class og{constructor(t,e,i,n=0){this.layer=t,this.skip=e,this.minPoint=i,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,i){for(;this.chunkIndex<this.layer.chunk.length;){let n=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(n)||this.layer.chunkEnd(this.chunkIndex)<t||n.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!i||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],i=t+e.from[this.rangeIndex];if(this.from=i,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class ts{constructor(t){this.heap=t}static from(t,e=null,i=-1){let n=[];for(let o=0;o<t.length;o++)for(let l=t[o];!l.isEmpty;l=l.nextLayer)l.maxPoint>=i&&n.push(new og(l,e,i,o));return n.length==1?n[0]:new ts(n)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let i of this.heap)i.goto(t,e);for(let i=this.heap.length>>1;i>=0;i--)Ea(this.heap,i);return this.next(),this}forward(t,e){for(let i of this.heap)i.forward(t,e);for(let i=this.heap.length>>1;i>=0;i--)Ea(this.heap,i);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),Ea(this.heap,0)}}}function Ea(r,t){for(let e=r[t];;){let i=(t<<1)+1;if(i>=r.length)break;let n=r[i];if(i+1<r.length&&n.compare(r[i+1])>=0&&(n=r[i+1],i++),e.compare(n)<0)break;r[i]=e,r[t]=n,t=i}}class Br{constructor(t,e,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=ts.from(t,e,i)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){ho(this.active,t),ho(this.activeTo,t),ho(this.activeRank,t),this.minActive=cd(this.active,this.activeTo)}addActive(t){let e=0,{value:i,to:n,rank:o}=this.cursor;for(;e<this.activeRank.length&&(o-this.activeRank[e]||n-this.activeTo[e])>0;)e++;fo(this.active,e,i),fo(this.activeTo,e,n),fo(this.activeRank,e,o),t&&fo(t,e,this.cursor.from),this.minActive=cd(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let n=this.minActive;if(n>-1&&(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)<0){if(this.activeTo[n]>t){this.to=this.activeTo[n],this.endSide=this.active[n].endSide;break}this.removeActive(n),i&&ho(i,n)}else if(this.cursor.value)if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let o=this.cursor.value;if(!o.point)this.addActive(i),this.cursor.next();else if(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=o,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=o.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let n=i.length-1;n>=0&&i[n]<t;n--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>t||this.activeTo[i]==t&&this.active[i].endSide>=this.point.endSide)&&e.push(this.active[i]);return e.reverse()}openEnd(t){let e=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>t;i--)e++;return e}}function ud(r,t,e,i,n,o){r.goto(t),e.goto(i);let l=i+n,h=i,f=i-t;for(;;){let c=r.to+f-e.to,d=c||r.endSide-e.endSide,g=d<0?r.to+f:e.to,m=Math.min(g,l);if(r.point||e.point?r.point&&e.point&&(r.point==e.point||r.point.eq(e.point))&&fh(r.activeForPoint(r.to),e.activeForPoint(e.to))||o.comparePoint(h,m,r.point,e.point):m>h&&!fh(r.active,e.active)&&o.compareRange(h,m,r.active,e.active),g>l)break;(c||r.openEnd!=e.openEnd)&&o.boundChange&&o.boundChange(g),h=g,d<=0&&r.next(),d>=0&&e.next()}}function fh(r,t){if(r.length!=t.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!=t[e]&&!r[e].eq(t[e]))return!1;return!0}function ho(r,t){for(let e=t,i=r.length-1;e<i;e++)r[e]=r[e+1];r.pop()}function fo(r,t,e){for(let i=r.length-1;i>=t;i--)r[i+1]=r[i];r[t]=e}function cd(r,t){let e=-1,i=1e9;for(let n=0;n<t.length;n++)(t[n]-i||r[n].endSide-r[e].endSide)<0&&(e=n,i=t[n]);return e}function lg(r,t,e=r.length){let i=0;for(let n=0;n<e&&n<r.length;)r.charCodeAt(n)==9?(i+=t-i%t,n++):(i++,n=yi(r,n));return i}function xS(r,t,e,i){for(let n=0,o=0;;){if(o>=t)return n;if(n==r.length)break;o+=r.charCodeAt(n)==9?e-o%e:1,n=yi(r,n)}return r.length}const uh="",dd=typeof Symbol>"u"?"__"+uh:Symbol.for(uh),ch=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),pd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class an{constructor(t,e){this.rules=[];let{finish:i}=e||{};function n(l){return/^@/.test(l)?[l]:l.split(/,\s*/)}function o(l,h,f,c){let d=[],g=/^@(\w+)\b/.exec(l[0]),m=g&&g[1]=="keyframes";if(g&&h==null)return f.push(l[0]+";");for(let y in h){let b=h[y];if(/&/.test(y))o(y.split(/,\s*/).map(S=>l.map(A=>S.replace(/&/,A))).reduce((S,A)=>S.concat(A)),b,f);else if(b&&typeof b=="object"){if(!g)throw new RangeError("The value of a property ("+y+") should be a primitive value.");o(n(y),b,d,m)}else b!=null&&d.push(y.replace(/_.*/,"").replace(/[A-Z]/g,S=>"-"+S.toLowerCase())+": "+b+";")}(d.length||m)&&f.push((i&&!g&&!c?l.map(i):l).join(", ")+" {"+d.join(" ")+"}")}for(let l in t)o(n(l),t[l],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let t=pd[dd]||1;return pd[dd]=t+1,uh+t.toString(36)}static mount(t,e,i){let n=t[ch],o=i&&i.nonce;n?o&&n.setNonce(o):n=new bS(t,o),n.mount(Array.isArray(e)?e:[e],t)}}let gd=new Map;class bS{constructor(t,e){let i=t.ownerDocument||t,n=i.defaultView;if(!t.head&&t.adoptedStyleSheets&&n.CSSStyleSheet){let o=gd.get(i);if(o)return t[ch]=o;this.sheet=new n.CSSStyleSheet,gd.set(i,this)}else this.styleTag=i.createElement("style"),e&&this.styleTag.setAttribute("nonce",e);this.modules=[],t[ch]=this}mount(t,e){let i=this.sheet,n=0,o=0;for(let l=0;l<t.length;l++){let h=t[l],f=this.modules.indexOf(h);if(f<o&&f>-1&&(this.modules.splice(f,1),o--,f=-1),f==-1){if(this.modules.splice(o++,0,h),i)for(let c=0;c<h.rules.length;c++)i.insertRule(h.rules[c],n++)}else{for(;o<f;)n+=this.modules[o++].rules.length;n+=h.rules.length,o++}}if(i)e.adoptedStyleSheets.indexOf(this.sheet)<0&&(e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets]);else{let l="";for(let f=0;f<this.modules.length;f++)l+=this.modules[f].getRules()+`
`;this.styleTag.textContent=l;let h=e.head||e;this.styleTag.parentNode!=h&&h.insertBefore(this.styleTag,h.firstChild)}}setNonce(t){this.styleTag&&this.styleTag.getAttribute("nonce")!=t&&this.styleTag.setAttribute("nonce",t)}}var hn={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},es={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},OS=typeof navigator<"u"&&/Mac/.test(navigator.platform),SS=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Zt=0;Zt<10;Zt++)hn[48+Zt]=hn[96+Zt]=String(Zt);for(var Zt=1;Zt<=24;Zt++)hn[Zt+111]="F"+Zt;for(var Zt=65;Zt<=90;Zt++)hn[Zt]=String.fromCharCode(Zt+32),es[Zt]=String.fromCharCode(Zt);for(var Da in hn)es.hasOwnProperty(Da)||(es[Da]=hn[Da]);function kS(r){var t=OS&&r.metaKey&&r.shiftKey&&!r.ctrlKey&&!r.altKey||SS&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",e=!t&&r.key||(r.shiftKey?es:hn)[r.keyCode]||r.key||"Unidentified";return e=="Esc"&&(e="Escape"),e=="Del"&&(e="Delete"),e=="Left"&&(e="ArrowLeft"),e=="Up"&&(e="ArrowUp"),e=="Right"&&(e="ArrowRight"),e=="Down"&&(e="ArrowDown"),e}function is(r){let t;return r.nodeType==11?t=r.getSelection?r:r.ownerDocument:t=r,t.getSelection()}function dh(r,t){return t?r==t||r.contains(t.nodeType!=1?t.parentNode:t):!1}function Do(r,t){if(!t.anchorNode)return!1;try{return dh(r,t.anchorNode)}catch{return!1}}function rr(r){return r.nodeType==3?Mn(r,0,r.nodeValue.length).getClientRects():r.nodeType==1?r.getClientRects():[]}function Xr(r,t,e,i){return e?md(r,t,e,i,-1)||md(r,t,e,i,1):!1}function Pn(r){for(var t=0;;t++)if(r=r.previousSibling,!r)return t}function Ho(r){return r.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(r.nodeName)}function md(r,t,e,i,n){for(;;){if(r==e&&t==i)return!0;if(t==(n<0?0:Si(r))){if(r.nodeName=="DIV")return!1;let o=r.parentNode;if(!o||o.nodeType!=1)return!1;t=Pn(r)+(n<0?0:1),r=o}else if(r.nodeType==1){if(r=r.childNodes[t+(n<0?-1:0)],r.nodeType==1&&r.contentEditable=="false")return!1;t=n<0?Si(r):0}else return!1}}function Si(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function hs(r,t){let e=t?r.left:r.right;return{left:e,right:e,top:r.top,bottom:r.bottom}}function CS(r){let t=r.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:r.innerWidth,top:0,bottom:r.innerHeight}}function ag(r,t){let e=t.width/r.offsetWidth,i=t.height/r.offsetHeight;return(e>.995&&e<1.005||!isFinite(e)||Math.abs(t.width-r.offsetWidth)<1)&&(e=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(t.height-r.offsetHeight)<1)&&(i=1),{scaleX:e,scaleY:i}}function AS(r,t,e,i,n,o,l,h){let f=r.ownerDocument,c=f.defaultView||window;for(let d=r,g=!1;d&&!g;)if(d.nodeType==1){let m,y=d==f.body,b=1,S=1;if(y)m=CS(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(d).position)&&(g=!0),d.scrollHeight<=d.clientHeight&&d.scrollWidth<=d.clientWidth){d=d.assignedSlot||d.parentNode;continue}let B=d.getBoundingClientRect();({scaleX:b,scaleY:S}=ag(d,B)),m={left:B.left,right:B.left+d.clientWidth*b,top:B.top,bottom:B.top+d.clientHeight*S}}let A=0,P=0;if(n=="nearest")t.top<m.top?(P=t.top-(m.top+l),e>0&&t.bottom>m.bottom+P&&(P=t.bottom-m.bottom+l)):t.bottom>m.bottom&&(P=t.bottom-m.bottom+l,e<0&&t.top-P<m.top&&(P=t.top-(m.top+l)));else{let B=t.bottom-t.top,N=m.bottom-m.top;P=(n=="center"&&B<=N?t.top+B/2-N/2:n=="start"||n=="center"&&e<0?t.top-l:t.bottom-N+l)-m.top}if(i=="nearest"?t.left<m.left?(A=t.left-(m.left+o),e>0&&t.right>m.right+A&&(A=t.right-m.right+o)):t.right>m.right&&(A=t.right-m.right+o,e<0&&t.left<m.left+A&&(A=t.left-(m.left+o))):A=(i=="center"?t.left+(t.right-t.left)/2-(m.right-m.left)/2:i=="start"==h?t.left-o:t.right-(m.right-m.left)+o)-m.left,A||P)if(y)c.scrollBy(A,P);else{let B=0,N=0;if(P){let D=d.scrollTop;d.scrollTop+=P/S,N=(d.scrollTop-D)*S}if(A){let D=d.scrollLeft;d.scrollLeft+=A/b,B=(d.scrollLeft-D)*b}t={left:t.left-B,top:t.top-N,right:t.right-B,bottom:t.bottom-N},B&&Math.abs(B-A)<1&&(i="nearest"),N&&Math.abs(N-P)<1&&(n="nearest")}if(y)break;(t.top<m.top||t.bottom>m.bottom||t.left<m.left||t.right>m.right)&&(t={left:Math.max(t.left,m.left),right:Math.min(t.right,m.right),top:Math.max(t.top,m.top),bottom:Math.min(t.bottom,m.bottom)}),d=d.assignedSlot||d.parentNode}else if(d.nodeType==11)d=d.host;else break}function TS(r){let t=r.ownerDocument,e,i;for(let n=r.parentNode;n&&!(n==t.body||e&&i);)if(n.nodeType==1)!i&&n.scrollHeight>n.clientHeight&&(i=n),!e&&n.scrollWidth>n.clientWidth&&(e=n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;return{x:e,y:i}}class PS{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:i}=t;this.set(e,Math.min(t.anchorOffset,e?Si(e):0),i,Math.min(t.focusOffset,i?Si(i):0))}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let qn=null;function hg(r){if(r.setActive)return r.setActive();if(qn)return r.focus(qn);let t=[];for(let e=r;e&&(t.push(e,e.scrollTop,e.scrollLeft),e!=e.ownerDocument);e=e.parentNode);if(r.focus(qn==null?{get preventScroll(){return qn={preventScroll:!0},!0}}:void 0),!qn){qn=!1;for(let e=0;e<t.length;){let i=t[e++],n=t[e++],o=t[e++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=o&&(i.scrollLeft=o)}}}let wd;function Mn(r,t,e=t){let i=wd||(wd=document.createRange());return i.setEnd(r,e),i.setStart(r,t),i}function Gn(r,t,e,i){let n={key:t,code:t,keyCode:e,which:e,cancelable:!0};i&&({altKey:n.altKey,ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,metaKey:n.metaKey}=i);let o=new KeyboardEvent("keydown",n);o.synthetic=!0,r.dispatchEvent(o);let l=new KeyboardEvent("keyup",n);return l.synthetic=!0,r.dispatchEvent(l),o.defaultPrevented||l.defaultPrevented}function MS(r){for(;r;){if(r&&(r.nodeType==9||r.nodeType==11&&r.host))return r;r=r.assignedSlot||r.parentNode}return null}function fg(r){for(;r.attributes.length;)r.removeAttributeNode(r.attributes[0])}function RS(r,t){let e=t.focusNode,i=t.focusOffset;if(!e||t.anchorNode!=e||t.anchorOffset!=i)return!1;for(i=Math.min(i,Si(e));;)if(i){if(e.nodeType!=1)return!1;let n=e.childNodes[i-1];n.contentEditable=="false"?i--:(e=n,i=Si(e))}else{if(e==r)return!0;i=Pn(e),e=e.parentNode}}function ug(r){return r.scrollTop>Math.max(1,r.scrollHeight-r.clientHeight-4)}function cg(r,t){for(let e=r,i=t;;){if(e.nodeType==3&&i>0)return{node:e,offset:i};if(e.nodeType==1&&i>0){if(e.contentEditable=="false")return null;e=e.childNodes[i-1],i=Si(e)}else if(e.parentNode&&!Ho(e))i=Pn(e),e=e.parentNode;else return null}}function dg(r,t){for(let e=r,i=t;;){if(e.nodeType==3&&i<e.nodeValue.length)return{node:e,offset:i};if(e.nodeType==1&&i<e.childNodes.length){if(e.contentEditable=="false")return null;e=e.childNodes[i],i=0}else if(e.parentNode&&!Ho(e))i=Pn(e)+1,e=e.parentNode;else return null}}class ee{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new ee(t.parentNode,Pn(t),e)}static after(t,e){return new ee(t.parentNode,Pn(t)+1,e)}}const Uh=[];class xt{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(this.flags&2){let i=this.dom,n=null,o;for(let l of this.children){if(l.flags&7){if(!l.dom&&(o=n?n.nextSibling:i.firstChild)){let h=xt.get(o);(!h||!h.parent&&h.canReuseDOM(l))&&l.reuseDOM(o)}l.sync(t,e),l.flags&=-8}if(o=n?n.nextSibling:i.firstChild,e&&!e.written&&e.node==i&&o!=l.dom&&(e.written=!0),l.dom.parentNode==i)for(;o&&o!=l.dom;)o=yd(o);else i.insertBefore(l.dom,o);n=l.dom}for(o=n?n.nextSibling:i.firstChild,o&&e&&e.node==i&&(e.written=!0);o;)o=yd(o)}else if(this.flags&1)for(let i of this.children)i.flags&7&&(i.sync(t,e),i.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=Si(t)==0?0:e==0?-1:1;for(;;){let o=t.parentNode;if(o==this.dom)break;n==0&&o.firstChild!=o.lastChild&&(t==o.firstChild?n=-1:n=1),t=o}n<0?i=t:i=t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!xt.get(i);)i=i.nextSibling;if(!i)return this.length;for(let n=0,o=0;;n++){let l=this.children[n];if(l.dom==i)return o;o+=l.length+l.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,o=-1,l=-1,h=-1;for(let f=0,c=i,d=i;f<this.children.length;f++){let g=this.children[f],m=c+g.length;if(c<t&&m>e)return g.domBoundsAround(t,e,c);if(m>=t&&n==-1&&(n=f,o=c),c>e&&g.dom.parentNode==this.dom){l=f,h=d;break}d=m,c=m+g.breakAfter}return{from:o,to:h<0?i+this.length:h,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:l<this.children.length&&l>=0?this.children[l].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),e.flags&1)return;e.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.flags&7&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=Uh){this.markDirty();for(let n=t;n<e;n++){let o=this.children[n];o.parent==this&&i.indexOf(o)<0&&o.destroy()}i.length<250?this.children.splice(t,e-t,...i):this.children=[].concat(this.children.slice(0,t),i,this.children.slice(e));for(let n=0;n<i.length;n++)i[n].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new pg(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+(t=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,i,n,o,l){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!((this.flags|t.flags)&8)}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}xt.prototype.breakAfter=0;function yd(r){let t=r.nextSibling;return r.parentNode.removeChild(r),t}class pg{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function gg(r,t,e,i,n,o,l,h,f){let{children:c}=r,d=c.length?c[t]:null,g=o.length?o[o.length-1]:null,m=g?g.breakAfter:l;if(!(t==i&&d&&!l&&!m&&o.length<2&&d.merge(e,n,o.length?g:null,e==0,h,f))){if(i<c.length){let y=c[i];y&&(n<y.length||y.breakAfter&&g?.breakAfter)?(t==i&&(y=y.split(n),n=0),!m&&g&&y.merge(0,n,g,!0,0,f)?o[o.length-1]=y:((n||y.children.length&&!y.children[0].length)&&y.merge(0,n,null,!1,0,f),o.push(y))):y?.breakAfter&&(g?g.breakAfter=1:l=1),i++}for(d&&(d.breakAfter=l,e>0&&(!l&&o.length&&d.merge(e,d.length,o[0],!1,h,0)?d.breakAfter=o.shift().breakAfter:(e<d.length||d.children.length&&d.children[d.children.length-1].length==0)&&d.merge(e,d.length,null,!1,h,0),t++));t<i&&o.length;)if(c[i-1].become(o[o.length-1]))i--,o.pop(),f=o.length?0:h;else if(c[t].become(o[0]))t++,o.shift(),h=o.length?0:f;else break;!o.length&&t&&i<c.length&&!c[t-1].breakAfter&&c[i].merge(0,0,c[t-1],!1,h,f)&&t--,(t<i||o.length)&&r.replaceChildren(t,i,o)}}function mg(r,t,e,i,n,o){let l=r.childCursor(),{i:h,off:f}=l.findPos(e,1),{i:c,off:d}=l.findPos(t,-1),g=t-e;for(let m of i)g+=m.length;r.length+=g,gg(r,c,d,h,f,i,0,n,o)}let ge=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},ph=typeof document<"u"?document:{documentElement:{style:{}}};const gh=/Edge\/(\d+)/.exec(ge.userAgent),wg=/MSIE \d/.test(ge.userAgent),mh=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ge.userAgent),sl=!!(wg||mh||gh),vd=!sl&&/gecko\/(\d+)/i.test(ge.userAgent),Ia=!sl&&/Chrome\/(\d+)/.exec(ge.userAgent),_S="webkitFontSmoothing"in ph.documentElement.style,yg=!sl&&/Apple Computer/.test(ge.vendor),xd=yg&&(/Mobile\/\w+/.test(ge.userAgent)||ge.maxTouchPoints>2);var Q={mac:xd||/Mac/.test(ge.platform),windows:/Win/.test(ge.platform),linux:/Linux|X11/.test(ge.platform),ie:sl,ie_version:wg?ph.documentMode||6:mh?+mh[1]:gh?+gh[1]:0,gecko:vd,gecko_version:vd?+(/Firefox\/(\d+)/.exec(ge.userAgent)||[0,0])[1]:0,chrome:!!Ia,chrome_version:Ia?+Ia[1]:0,ios:xd,android:/Android\b/.test(ge.userAgent),safari:yg,webkit_version:_S?+(/\bAppleWebKit\/(\d+)/.exec(ge.userAgent)||[0,0])[1]:0,tabSize:ph.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const ES=256;class ni extends xt{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){t.nodeType==3&&this.createDOM(t)}merge(t,e,i){return this.flags&8||i&&(!(i instanceof ni)||this.length-(e-t)+i.length>ES||i.flags&8)?!1:(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),!0)}split(t){let e=new ni(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e.flags|=this.flags&8,e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new ee(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return DS(this.dom,t,e)}}class zi extends xt{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let n of e)n.setParent(this)}setAttrs(t){if(fg(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!((this.flags|t.flags)&8)}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,e){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,i,n,o,l){return i&&(!(i instanceof zi&&i.mark.eq(this.mark))||t&&o<=0||e<this.length&&l<=0)?!1:(mg(this,t,e,i?i.children.slice():[],o-1,l-1),this.markDirty(),!0)}split(t){let e=[],i=0,n=-1,o=0;for(let h of this.children){let f=i+h.length;f>t&&e.push(i<t?h.split(t-i):h),n<0&&i>=t&&(n=o),i=f,o++}let l=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new zi(this.mark,e,l)}domAtPos(t){return vg(this,t)}coordsAt(t,e){return bg(this,t,e)}}function DS(r,t,e){let i=r.nodeValue.length;t>i&&(t=i);let n=t,o=t,l=0;t==0&&e<0||t==i&&e>=0?Q.chrome||Q.gecko||(t?(n--,l=1):o<i&&(o++,l=-1)):e<0?n--:o<i&&o++;let h=Mn(r,n,o).getClientRects();if(!h.length)return null;let f=h[(l?l<0:e>=0)?0:h.length-1];return Q.safari&&!l&&f.width==0&&(f=Array.prototype.find.call(h,c=>c.width)||f),l?hs(f,l<0):f||null}class sn extends xt{static create(t,e,i){return new sn(t,e,i)}constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}split(t){let e=sn.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,e,i,n,o,l){return i&&(!(i instanceof sn)||!this.widget.compare(i.widget)||t>0&&o<=0||e<this.length&&l<=0)?!1:(this.length=t+(i?i.length:0)+(this.length-e),!0)}become(t){return t instanceof sn&&t.side==this.side&&this.widget.constructor==t.widget.constructor?(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(this.length==0)return ct.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):ct.empty}domAtPos(t){return(this.length?t==0:this.side>0)?ee.before(this.dom):ee.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.widget.coordsAt(this.dom,t,e);if(i)return i;let n=this.dom.getClientRects(),o=null;if(!n.length)return null;let l=this.side?this.side<0:t>0;for(let h=l?n.length-1:0;o=n[h],!(t>0?h==0:h==n.length-1||o.top<o.bottom);h+=l?-1:1);return hs(o,!l)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class sr extends xt{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof sr&&t.side==this.side}split(){return new sr(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?ee.before(this.dom):ee.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return ct.empty}get isHidden(){return!0}}ni.prototype.children=sn.prototype.children=sr.prototype.children=Uh;function vg(r,t){let e=r.dom,{children:i}=r,n=0;for(let o=0;n<i.length;n++){let l=i[n],h=o+l.length;if(!(h==o&&l.getSide()<=0)){if(t>o&&t<h&&l.dom.parentNode==e)return l.domAtPos(t-o);if(t<=o)break;o=h}}for(let o=n;o>0;o--){let l=i[o-1];if(l.dom.parentNode==e)return l.domAtPos(l.length)}for(let o=n;o<i.length;o++){let l=i[o];if(l.dom.parentNode==e)return l.domAtPos(0)}return new ee(e,0)}function xg(r,t,e){let i,{children:n}=r;e>0&&t instanceof zi&&n.length&&(i=n[n.length-1])instanceof zi&&i.mark.eq(t.mark)?xg(i,t.children[0],e-1):(n.push(t),t.setParent(r)),r.length+=t.length}function bg(r,t,e){let i=null,n=-1,o=null,l=-1;function h(c,d){for(let g=0,m=0;g<c.children.length&&m<=d;g++){let y=c.children[g],b=m+y.length;b>=d&&(y.children.length?h(y,d-m):(!o||o.isHidden&&(e>0||BS(o,y)))&&(b>d||m==b&&y.getSide()>0)?(o=y,l=d-m):(m<d||m==b&&y.getSide()<0&&!y.isHidden)&&(i=y,n=d-m)),m=b}}h(r,t);let f=(e<0?i:o)||i||o;return f?f.coordsAt(Math.max(0,f==i?n:l),e):IS(r)}function IS(r){let t=r.dom.lastChild;if(!t)return r.dom.getBoundingClientRect();let e=rr(t);return e[e.length-1]||null}function BS(r,t){let e=r.coordsAt(0,1),i=t.coordsAt(0,1);return e&&i&&i.top<e.bottom}function wh(r,t){for(let e in r)e=="class"&&t.class?t.class+=" "+r.class:e=="style"&&t.style?t.style+=";"+r.style:t[e]=r[e];return t}const bd=Object.create(null);function zo(r,t,e){if(r==t)return!0;r||(r=bd),t||(t=bd);let i=Object.keys(r),n=Object.keys(t);if(i.length-(e&&i.indexOf(e)>-1?1:0)!=n.length-(e&&n.indexOf(e)>-1?1:0))return!1;for(let o of i)if(o!=e&&(n.indexOf(o)==-1||r[o]!==t[o]))return!1;return!0}function yh(r,t,e){let i=!1;if(t)for(let n in t)e&&n in e||(i=!0,n=="style"?r.style.cssText="":r.removeAttribute(n));if(e)for(let n in e)t&&t[n]==e[n]||(i=!0,n=="style"?r.style.cssText=e[n]:r.setAttribute(n,e[n]));return i}function LS(r){let t=Object.create(null);for(let e=0;e<r.attributes.length;e++){let i=r.attributes[e];t[i.name]=i.value}return t}class fs{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,e,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var Oi=function(r){return r[r.Text=0]="Text",r[r.WidgetBefore=1]="WidgetBefore",r[r.WidgetAfter=2]="WidgetAfter",r[r.WidgetRange=3]="WidgetRange",r}(Oi||(Oi={}));class pt extends Tn{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new us(t)}static widget(t){let e=Math.max(-1e4,Math.min(1e4,t.side||0)),i=!!t.block;return e+=i&&!t.inlineOrder?e>0?3e8:-4e8:e>0?1e8:-1e8,new fn(t,e,e,i,t.widget||null,!1)}static replace(t){let e=!!t.block,i,n;if(t.isBlockGap)i=-5e8,n=4e8;else{let{start:o,end:l}=Og(t,e);i=(o?e?-3e8:-1:5e8)-1,n=(l?e?2e8:1:-6e8)+1}return new fn(t,i,n,e,t.widget||null,!0)}static line(t){return new cs(t)}static set(t,e=!1){return Ct.of(t,e)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}pt.none=Ct.empty;class us extends pt{constructor(t){let{start:e,end:i}=Og(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var e,i;return this==t||t instanceof us&&this.tagName==t.tagName&&(this.class||((e=this.attrs)===null||e===void 0?void 0:e.class))==(t.class||((i=t.attrs)===null||i===void 0?void 0:i.class))&&zo(this.attrs,t.attrs,"class")}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}us.prototype.point=!1;class cs extends pt{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof cs&&this.spec.class==t.spec.class&&zo(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}cs.prototype.mapMode=oe.TrackBefore;cs.prototype.point=!0;class fn extends pt{constructor(t,e,i,n,o,l){super(e,i,o,t),this.block=n,this.isReplace=l,this.mapMode=n?e<=0?oe.TrackBefore:oe.TrackAfter:oe.TrackDel}get type(){return this.startSide!=this.endSide?Oi.WidgetRange:this.startSide<=0?Oi.WidgetBefore:Oi.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof fn&&NS(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}fn.prototype.point=!0;function Og(r,t=!1){let{inclusiveStart:e,inclusiveEnd:i}=r;return e==null&&(e=r.inclusive),i==null&&(i=r.inclusive),{start:e??t,end:i??t}}function NS(r,t){return r==t||!!(r&&t&&r.compare(t))}function Io(r,t,e,i=0){let n=e.length-1;n>=0&&e[n]+i>=r?e[n]=Math.max(e[n],t):e.push(r,t)}class Nt extends xt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,o,l){if(i){if(!(i instanceof Nt))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),mg(this,t,e,i?i.children.slice():[],o,l),!0}split(t){let e=new Nt;if(e.breakAfter=this.breakAfter,this.length==0)return e;let{i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let o=i;o<this.children.length;o++)e.append(this.children[o],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){zo(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){xg(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=wh(e,this.attrs||{})),i&&(this.attrs=wh({class:i},this.attrs||{}))}domAtPos(t){return vg(this,t)}reuseDOM(t){t.nodeName=="DIV"&&(this.setDOM(t),this.flags|=6)}sync(t,e){var i;this.dom?this.flags&4&&(fg(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(yh(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let n=this.dom.lastChild;for(;n&&xt.get(n)instanceof zi;)n=n.lastChild;if(!n||!this.length||n.nodeName!="BR"&&((i=xt.get(n))===null||i===void 0?void 0:i.isEditable)==!1&&(!Q.ios||!this.children.some(o=>o instanceof ni))){let o=document.createElement("BR");o.cmIgnore=!0,this.dom.appendChild(o)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let t=0,e;for(let i of this.children){if(!(i instanceof ni)||/[^ -~]/.test(i.text))return null;let n=rr(i.dom);if(n.length!=1)return null;t+=n[0].width,e=n[0].height}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length,textHeight:e}:null}coordsAt(t,e){let i=bg(this,t,e);if(!this.children.length&&i&&this.parent){let{heightOracle:n}=this.parent.view.viewState,o=i.bottom-i.top;if(Math.abs(o-n.lineHeight)<2&&n.textHeight<o){let l=(o-n.textHeight)/2;return{top:i.top+l,bottom:i.bottom-l,left:i.left,right:i.left}}}return i}become(t){return t instanceof Nt&&this.children.length==0&&t.children.length==0&&zo(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let o=t.children[i],l=n+o.length;if(l>=e){if(o instanceof Nt)return o;if(l>e)break}n=l+o.breakAfter}return null}}class Hi extends xt{constructor(t,e,i){super(),this.widget=t,this.length=e,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,o,l){return i&&(!(i instanceof Hi)||!this.widget.compare(i.widget)||t>0&&o<=0||e<this.length&&l<=0)?!1:(this.length=t+(i?i.length:0)+(this.length-e),!0)}domAtPos(t){return t==0?ee.before(this.dom):ee.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new Hi(this.widget,e,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return Uh}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):ct.empty}domBoundsAround(){return null}become(t){return t instanceof Hi&&t.widget.constructor==this.widget.constructor?(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){let i=this.widget.coordsAt(this.dom,t,e);return i||(this.widget instanceof vh?null:hs(this.dom.getBoundingClientRect(),this.length?t==0:e<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:e,endSide:i}=this.deco;return e==i?!1:t<0?e<0:i>0}}class vh extends fs{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class Yr{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof Hi&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Nt),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(uo(new sr(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(t&&this.content.length&&this.content[this.content.length-1]instanceof Hi)&&this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:o,lineBreak:l,done:h}=this.cursor.next(this.skip);if(this.skip=0,h)throw new Error("Ran out of text content when drawing inline views");if(l){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}else this.text=o,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-i)),this.getLine().append(uo(new ni(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,o,l){if(this.disallowBlockEffectsFor[l]&&i instanceof fn){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let h=e-t;if(i instanceof fn)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Hi(i.widget||or.block,h,i));else{let f=sn.create(i.widget||or.inline,h,h?0:i.startSide),c=this.atCursorPos&&!f.isEditable&&o<=n.length&&(t<e||i.startSide>0),d=!f.isEditable&&(t<e||o>n.length||i.startSide<=0),g=this.getLine();this.pendingBuffer==2&&!c&&!f.isEditable&&(this.pendingBuffer=0),this.flushBuffer(n),c&&(g.append(uo(new sr(1),n),o),o=n.length+Math.max(0,o-n.length)),g.append(uo(f,n),o),this.atCursorPos=d,this.pendingBuffer=d?t<e||o>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);h&&(this.textOff+h<=this.text.length?this.textOff+=h:(this.skip+=h-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=o)}static build(t,e,i,n,o){let l=new Yr(t,e,i,o);return l.openEnd=Ct.spans(n,e,i,l),l.openStart<0&&(l.openStart=l.openEnd),l.finish(l.openEnd),l}}function uo(r,t){for(let e of t)r=new zi(e,[r],r.length);return r}class or extends fs{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}or.inline=new or("span");or.block=new or("div");var $t=function(r){return r[r.LTR=0]="LTR",r[r.RTL=1]="RTL",r}($t||($t={}));const Rn=$t.LTR,qh=$t.RTL;function Sg(r){let t=[];for(let e=0;e<r.length;e++)t.push(1<<+r[e]);return t}const $S=Sg("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),WS=Sg("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),xh=Object.create(null),fi=[];for(let r of["()","[]","{}"]){let t=r.charCodeAt(0),e=r.charCodeAt(1);xh[t]=e,xh[e]=-t}function kg(r){return r<=247?$S[r]:1424<=r&&r<=1524?2:1536<=r&&r<=1785?WS[r-1536]:1774<=r&&r<=2220?4:8192<=r&&r<=8204?256:64336<=r&&r<=65023?4:1}const FS=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class on{get dir(){return this.level%2?qh:Rn}constructor(t,e,i){this.from=t,this.to=e,this.level=i}side(t,e){return this.dir==e==t?this.to:this.from}forward(t,e){return t==(this.dir==e)}static find(t,e,i,n){let o=-1;for(let l=0;l<t.length;l++){let h=t[l];if(h.from<=e&&h.to>=e){if(h.level==i)return l;(o<0||(n!=0?n<0?h.from<e:h.to>e:t[o].level>h.level))&&(o=l)}}if(o<0)throw new RangeError("Index out of range");return o}}function Cg(r,t){if(r.length!=t.length)return!1;for(let e=0;e<r.length;e++){let i=r[e],n=t[e];if(i.from!=n.from||i.to!=n.to||i.direction!=n.direction||!Cg(i.inner,n.inner))return!1}return!0}const vt=[];function HS(r,t,e,i,n){for(let o=0;o<=i.length;o++){let l=o?i[o-1].to:t,h=o<i.length?i[o].from:e,f=o?256:n;for(let c=l,d=f,g=f;c<h;c++){let m=kg(r.charCodeAt(c));m==512?m=d:m==8&&g==4&&(m=16),vt[c]=m==4?2:m,m&7&&(g=m),d=m}for(let c=l,d=f,g=f;c<h;c++){let m=vt[c];if(m==128)c<h-1&&d==vt[c+1]&&d&24?m=vt[c]=d:vt[c]=256;else if(m==64){let y=c+1;for(;y<h&&vt[y]==64;)y++;let b=c&&d==8||y<e&&vt[y]==8?g==1?1:8:256;for(let S=c;S<y;S++)vt[S]=b;c=y-1}else m==8&&g==1&&(vt[c]=1);d=m,m&7&&(g=m)}}}function zS(r,t,e,i,n){let o=n==1?2:1;for(let l=0,h=0,f=0;l<=i.length;l++){let c=l?i[l-1].to:t,d=l<i.length?i[l].from:e;for(let g=c,m,y,b;g<d;g++)if(y=xh[m=r.charCodeAt(g)])if(y<0){for(let S=h-3;S>=0;S-=3)if(fi[S+1]==-y){let A=fi[S+2],P=A&2?n:A&4?A&1?o:n:0;P&&(vt[g]=vt[fi[S]]=P),h=S;break}}else{if(fi.length==189)break;fi[h++]=g,fi[h++]=m,fi[h++]=f}else if((b=vt[g])==2||b==1){let S=b==n;f=S?0:1;for(let A=h-3;A>=0;A-=3){let P=fi[A+2];if(P&2)break;if(S)fi[A+2]|=2;else{if(P&4)break;fi[A+2]|=4}}}}}function VS(r,t,e,i){for(let n=0,o=i;n<=e.length;n++){let l=n?e[n-1].to:r,h=n<e.length?e[n].from:t;for(let f=l;f<h;){let c=vt[f];if(c==256){let d=f+1;for(;;)if(d==h){if(n==e.length)break;d=e[n++].to,h=n<e.length?e[n].from:t}else if(vt[d]==256)d++;else break;let g=o==1,m=(d<t?vt[d]:i)==1,y=g==m?g?1:2:i;for(let b=d,S=n,A=S?e[S-1].to:r;b>f;)b==A&&(b=e[--S].from,A=S?e[S-1].to:r),vt[--b]=y;f=d}else o=c,f++}}}function bh(r,t,e,i,n,o,l){let h=i%2?2:1;if(i%2==n%2)for(let f=t,c=0;f<e;){let d=!0,g=!1;if(c==o.length||f<o[c].from){let S=vt[f];S!=h&&(d=!1,g=S==16)}let m=!d&&h==1?[]:null,y=d?i:i+1,b=f;t:for(;;)if(c<o.length&&b==o[c].from){if(g)break t;let S=o[c];if(!d)for(let A=S.to,P=c+1;;){if(A==e)break t;if(P<o.length&&o[P].from==A)A=o[P++].to;else{if(vt[A]==h)break t;break}}if(c++,m)m.push(S);else{S.from>f&&l.push(new on(f,S.from,y));let A=S.direction==Rn!=!(y%2);Oh(r,A?i+1:i,n,S.inner,S.from,S.to,l),f=S.to}b=S.to}else{if(b==e||(d?vt[b]!=h:vt[b]==h))break;b++}m?bh(r,f,b,i+1,n,m,l):f<b&&l.push(new on(f,b,y)),f=b}else for(let f=e,c=o.length;f>t;){let d=!0,g=!1;if(!c||f>o[c-1].to){let S=vt[f-1];S!=h&&(d=!1,g=S==16)}let m=!d&&h==1?[]:null,y=d?i:i+1,b=f;t:for(;;)if(c&&b==o[c-1].to){if(g)break t;let S=o[--c];if(!d)for(let A=S.from,P=c;;){if(A==t)break t;if(P&&o[P-1].to==A)A=o[--P].from;else{if(vt[A-1]==h)break t;break}}if(m)m.push(S);else{S.to<f&&l.push(new on(S.to,f,y));let A=S.direction==Rn!=!(y%2);Oh(r,A?i+1:i,n,S.inner,S.from,S.to,l),f=S.from}b=S.from}else{if(b==t||(d?vt[b-1]!=h:vt[b-1]==h))break;b--}m?bh(r,b,f,i+1,n,m,l):b<f&&l.push(new on(b,f,y)),f=b}}function Oh(r,t,e,i,n,o,l){let h=t%2?2:1;HS(r,n,o,i,h),zS(r,n,o,i,h),VS(n,o,i,h),bh(r,n,o,t,e,i,l)}function QS(r,t,e){if(!r)return[new on(0,0,t==qh?1:0)];if(t==Rn&&!e.length&&!FS.test(r))return Ag(r.length);if(e.length)for(;r.length>vt.length;)vt[vt.length]=256;let i=[],n=t==Rn?0:1;return Oh(r,n,n,e,0,r.length,i),i}function Ag(r){return[new on(0,r,0)]}let Tg="";function US(r,t,e,i,n){var o;let l=i.head-r.from,h=on.find(t,l,(o=i.bidiLevel)!==null&&o!==void 0?o:-1,i.assoc),f=t[h],c=f.side(n,e);if(l==c){let m=h+=n?1:-1;if(m<0||m>=t.length)return null;f=t[h=m],l=f.side(!n,e),c=f.side(n,e)}let d=yi(r.text,l,f.forward(n,e));(d<f.from||d>f.to)&&(d=c),Tg=r.text.slice(Math.min(l,d),Math.max(l,d));let g=h==(n?t.length-1:0)?null:t[h+(n?1:-1)];return g&&d==c&&g.level+(n?0:1)<f.level?V.cursor(g.side(!n,e)+r.from,g.forward(n,e)?1:-1,g.level):V.cursor(d+r.from,f.forward(n,e)?-1:1,f.level)}function qS(r,t,e){for(let i=t;i<e;i++){let n=kg(r.charCodeAt(i));if(n==1)return Rn;if(n==2||n==4)return qh}return Rn}const Pg=X.define(),Mg=X.define(),Rg=X.define(),_g=X.define(),Sh=X.define(),Eg=X.define(),Dg=X.define(),Xh=X.define(),Yh=X.define(),Ig=X.define({combine:r=>r.some(t=>t)}),XS=X.define({combine:r=>r.some(t=>t)}),Bg=X.define();class Zn{constructor(t,e="nearest",i="nearest",n=5,o=5,l=!1){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=o,this.isSnapshot=l}map(t){return t.empty?this:new Zn(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new Zn(V.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const co=ft.define({map:(r,t)=>r.map(t)}),Lg=ft.define();function le(r,t,e){let i=r.facet(_g);i.length?i[0](t):window.onerror?window.onerror(String(t),e,void 0,void 0,t):e?console.error(e+":",t):console.error(t)}const Wi=X.define({combine:r=>r.length?r[0]:!0});let YS=0;const Wr=X.define();class Me{constructor(t,e,i,n,o){this.id=t,this.create=e,this.domEventHandlers=i,this.domEventObservers=n,this.extension=o(this)}static define(t,e){const{eventHandlers:i,eventObservers:n,provide:o,decorations:l}=e||{};return new Me(YS++,t,i,n,h=>{let f=[Wr.of(h)];return l&&f.push(ns.of(c=>{let d=c.plugin(h);return d?l(d):pt.none})),o&&f.push(o(h)),f})}static fromClass(t,e){return Me.define(i=>new t(i),e)}}class Ba{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let e=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(e)}catch(i){if(le(e.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){le(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(!((e=this.value)===null||e===void 0)&&e.destroy)try{this.value.destroy()}catch(i){le(t.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Ng=X.define(),Kh=X.define(),ns=X.define(),$g=X.define(),Gh=X.define(),Wg=X.define();function Od(r,t){let e=r.state.facet(Wg);if(!e.length)return e;let i=e.map(o=>o instanceof Function?o(r):o),n=[];return Ct.spans(i,t.from,t.to,{point(){},span(o,l,h,f){let c=o-t.from,d=l-t.from,g=n;for(let m=h.length-1;m>=0;m--,f--){let y=h[m].spec.bidiIsolate,b;if(y==null&&(y=qS(t.text,c,d)),f>0&&g.length&&(b=g[g.length-1]).to==c&&b.direction==y)b.to=d,g=b.inner;else{let S={from:c,to:d,direction:y,inner:[]};g.push(S),g=S.inner}}}}),n}const Fg=X.define();function Zh(r){let t=0,e=0,i=0,n=0;for(let o of r.state.facet(Fg)){let l=o(r);l&&(l.left!=null&&(t=Math.max(t,l.left)),l.right!=null&&(e=Math.max(e,l.right)),l.top!=null&&(i=Math.max(i,l.top)),l.bottom!=null&&(n=Math.max(n,l.bottom)))}return{left:t,right:e,top:i,bottom:n}}const Fr=X.define();class qe{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new qe(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(e.length==0)return t;let i=[];for(let n=0,o=0,l=0,h=0;;n++){let f=n==t.length?null:t[n],c=l-h,d=f?f.fromB:1e9;for(;o<e.length&&e[o]<d;){let g=e[o],m=e[o+1],y=Math.max(h,g),b=Math.min(d,m);if(y<=b&&new qe(y+c,b+c,y,b).addToSet(i),m>d)break;o+=2}if(!f)return i;new qe(f.fromA,f.toA,f.fromB,f.toB).addToSet(i),l=f.toA,h=f.toB}}}class Vo{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=Vt.empty(this.startState.doc.length);for(let o of i)this.changes=this.changes.compose(o.changes);let n=[];this.changes.iterChangedRanges((o,l,h,f)=>n.push(new qe(o,l,h,f))),this.changedRanges=n}static create(t,e,i){return new Vo(t,e,i)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(t=>t.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class Sd extends xt{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=pt.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new Nt],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new qe(0,0,0,t.state.doc.length)],0,null)}update(t){var e;let i=t.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:c,toA:d})=>d<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let n=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((e=this.domChanged)===null||e===void 0)&&e.newSel?n=this.domChanged.newSel.head:!ek(t.changes,this.hasComposition)&&!t.selectionSet&&(n=t.state.selection.main.head));let o=n>-1?GS(this.view,t.changes,n):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:d}=this.hasComposition;i=new qe(c,d,t.changes.mapPos(c,-1),t.changes.mapPos(d,1)).addToSet(i.slice())}this.hasComposition=o?{from:o.range.fromB,to:o.range.toB}:null,(Q.ie||Q.chrome)&&!o&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let l=this.decorations,h=this.updateDeco(),f=JS(l,h,t.changes);return i=qe.extendWithRanges(i,f),!(this.flags&7)&&i.length==0?!1:(this.updateInner(i,t.startState.doc.length,o),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e,i);let{observer:n}=this.view;n.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let l=Q.chrome||Q.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,l),this.flags&=-8,l&&(l.written||n.selectionRange.focusNode!=l.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(l=>l.flags&=-9);let o=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let l of this.children)l instanceof Hi&&l.widget instanceof vh&&o.push(l.dom);n.updateGaps(o)}updateChildren(t,e,i){let n=i?i.range.addToSet(t.slice()):t,o=this.childCursor(e);for(let l=n.length-1;;l--){let h=l>=0?n[l]:null;if(!h)break;let{fromA:f,toA:c,fromB:d,toB:g}=h,m,y,b,S;if(i&&i.range.fromB<g&&i.range.toB>d){let D=Yr.build(this.view.state.doc,d,i.range.fromB,this.decorations,this.dynamicDecorationMap),$=Yr.build(this.view.state.doc,i.range.toB,g,this.decorations,this.dynamicDecorationMap);y=D.breakAtStart,b=D.openStart,S=$.openEnd;let W=this.compositionView(i);$.breakAtStart?W.breakAfter=1:$.content.length&&W.merge(W.length,W.length,$.content[0],!1,$.openStart,0)&&(W.breakAfter=$.content[0].breakAfter,$.content.shift()),D.content.length&&W.merge(0,0,D.content[D.content.length-1],!0,0,D.openEnd)&&D.content.pop(),m=D.content.concat(W).concat($.content)}else({content:m,breakAtStart:y,openStart:b,openEnd:S}=Yr.build(this.view.state.doc,d,g,this.decorations,this.dynamicDecorationMap));let{i:A,off:P}=o.findPos(c,1),{i:B,off:N}=o.findPos(f,-1);gg(this,B,N,A,P,m,y,b,S)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let e of t.transactions)for(let i of e.effects)i.is(Lg)&&(this.editContextFormatting=i.value)}compositionView(t){let e=new ni(t.text.nodeValue);e.flags|=8;for(let{deco:n}of t.marks)e=new zi(n,[e],e.length);let i=new Nt;return i.append(e,0),i}fixCompositionDOM(t){let e=(o,l)=>{l.flags|=8|(l.children.some(f=>f.flags&7)?1:0),this.markedForComposition.add(l);let h=xt.get(o);h&&h!=l&&(h.dom=null),l.setDOM(o)},i=this.childPos(t.range.fromB,1),n=this.children[i.i];e(t.line,n);for(let o=t.marks.length-1;o>=-1;o--)i=n.childPos(i.off,1),n=n.children[i.i],e(o>=0?t.marks[o].node:t.text,n)}updateSelection(t=!1,e=!1){(t||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let i=this.view.root.activeElement,n=i==this.dom,o=!n&&!(this.view.state.facet(Wi)||this.dom.tabIndex>-1)&&Do(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(n||e||o))return;let l=this.forceSelection;this.forceSelection=!1;let h=this.view.state.selection.main,f=this.moveToLine(this.domAtPos(h.anchor)),c=h.empty?f:this.moveToLine(this.domAtPos(h.head));if(Q.gecko&&h.empty&&!this.hasComposition&&KS(f)){let g=document.createTextNode("");this.view.observer.ignore(()=>f.node.insertBefore(g,f.node.childNodes[f.offset]||null)),f=c=new ee(g,0),l=!0}let d=this.view.observer.selectionRange;(l||!d.focusNode||(!Xr(f.node,f.offset,d.anchorNode,d.anchorOffset)||!Xr(c.node,c.offset,d.focusNode,d.focusOffset))&&!this.suppressWidgetCursorChange(d,h))&&(this.view.observer.ignore(()=>{Q.android&&Q.chrome&&this.dom.contains(d.focusNode)&&tk(d.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let g=is(this.view.root);if(g)if(h.empty){if(Q.gecko){let m=ZS(f.node,f.offset);if(m&&m!=3){let y=(m==1?cg:dg)(f.node,f.offset);y&&(f=new ee(y.node,y.offset))}}g.collapse(f.node,f.offset),h.bidiLevel!=null&&g.caretBidiLevel!==void 0&&(g.caretBidiLevel=h.bidiLevel)}else if(g.extend){g.collapse(f.node,f.offset);try{g.extend(c.node,c.offset)}catch{}}else{let m=document.createRange();h.anchor>h.head&&([f,c]=[c,f]),m.setEnd(c.node,c.offset),m.setStart(f.node,f.offset),g.removeAllRanges(),g.addRange(m)}o&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(f,c)),this.impreciseAnchor=f.precise?null:new ee(d.anchorNode,d.anchorOffset),this.impreciseHead=c.precise?null:new ee(d.focusNode,d.focusOffset)}suppressWidgetCursorChange(t,e){return this.hasComposition&&e.empty&&Xr(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==e.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,e=t.state.selection.main,i=is(t.root),{anchorNode:n,anchorOffset:o}=t.observer.selectionRange;if(!i||!e.empty||!e.assoc||!i.modify)return;let l=Nt.find(this,e.head);if(!l)return;let h=l.posAtStart;if(e.head==h||e.head==h+l.length)return;let f=this.coordsAt(e.head,-1),c=this.coordsAt(e.head,1);if(!f||!c||f.bottom>c.top)return;let d=this.domAtPos(e.head+e.assoc);i.collapse(d.node,d.offset),i.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let g=t.observer.selectionRange;t.docView.posFromDOM(g.anchorNode,g.anchorOffset)!=e.from&&i.collapse(n,o)}moveToLine(t){let e=this.dom,i;if(t.node!=e)return t;for(let n=t.offset;!i&&n<e.childNodes.length;n++){let o=xt.get(e.childNodes[n]);o instanceof Nt&&(i=o.domAtPos(0))}for(let n=t.offset-1;!i&&n>=0;n--){let o=xt.get(e.childNodes[n]);o instanceof Nt&&(i=o.domAtPos(o.length))}return i?new ee(i.node,i.offset,!0):t}nearest(t){for(let e=t;e;){let i=xt.get(e);if(i&&i.rootView==this)return i;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let n=this.children[e];if(i<n.length||n instanceof Nt)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){let i=null,n=0;for(let o=this.length,l=this.children.length-1;l>=0;l--){let h=this.children[l],f=o-h.breakAfter,c=f-h.length;if(f<t)break;if(c<=t&&(c<t||h.covers(-1))&&(f>t||h.covers(1))&&(!i||h instanceof Nt&&!(i instanceof Nt&&e>=0)))i=h,n=c;else if(i&&c==t&&f==t&&h instanceof Hi&&Math.abs(e)<2){if(h.deco.startSide<0)break;l&&(i=null)}o=c}return i?i.coordsAt(t-n,e):null}coordsForChar(t){let{i:e,off:i}=this.childPos(t,1),n=this.children[e];if(!(n instanceof Nt))return null;for(;n.children.length;){let{i:h,off:f}=n.childPos(i,1);for(;;h++){if(h==n.children.length)return null;if((n=n.children[h]).length)break}i=f}if(!(n instanceof ni))return null;let o=yi(n.text,i);if(o==i)return null;let l=Mn(n.dom,i,o).getClientRects();for(let h=0;h<l.length;h++){let f=l[h];if(h==l.length-1||f.top<f.bottom&&f.left<f.right)return f}return null}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,o=this.view.contentDOM.clientWidth,l=o>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,h=-1,f=this.view.textDirection==$t.LTR;for(let c=0,d=0;d<this.children.length;d++){let g=this.children[d],m=c+g.length;if(m>n)break;if(c>=i){let y=g.dom.getBoundingClientRect();if(e.push(y.height),l){let b=g.dom.lastChild,S=b?rr(b):[];if(S.length){let A=S[S.length-1],P=f?A.right-y.left:y.right-A.left;P>h&&(h=P,this.minWidth=o,this.minWidthFrom=c,this.minWidthTo=m)}}}c=m+g.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return getComputedStyle(this.children[e].dom).direction=="rtl"?$t.RTL:$t.LTR}measureTextSize(){for(let o of this.children)if(o instanceof Nt){let l=o.measureTextSize();if(l)return l}let t=document.createElement("div"),e,i,n;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(t);let o=rr(t.firstChild)[0];e=t.getBoundingClientRect().height,i=o?o.width/27:7,n=o?o.height:e,t.remove()}),{lineHeight:e,charWidth:i,textHeight:n}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new pg(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let o=n==e.viewports.length?null:e.viewports[n],l=o?o.from-1:this.length;if(l>i){let h=(e.lineBlockAt(l).bottom-e.lineBlockAt(i).top)/this.view.scaleY;t.push(pt.replace({widget:new vh(h),block:!0,inclusive:!0,isBlockGap:!0}).range(i,l))}if(!o)break;i=o.to+1}return pt.set(t)}updateDeco(){let t=1,e=this.view.state.facet(ns).map(o=>(this.dynamicDecorationMap[t++]=typeof o=="function")?o(this.view):o),i=!1,n=this.view.state.facet($g).map((o,l)=>{let h=typeof o=="function";return h&&(i=!0),h?o(this.view):o});for(n.length&&(this.dynamicDecorationMap[t++]=i,e.push(Ct.join(n))),this.decorations=[this.editContextFormatting,...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let c=this.view.viewState.lineBlockAt(t.range.head);this.view.scrollDOM.scrollTop=c.top-t.yMargin,this.view.scrollDOM.scrollLeft=t.xMargin;return}for(let c of this.view.state.facet(Bg))try{if(c(this.view,t.range,t))return!0}catch(d){le(this.view.state,d,"scroll handler")}let{range:e}=t,i=this.coordsAt(e.head,e.empty?e.assoc:e.head>e.anchor?-1:1),n;if(!i)return;!e.empty&&(n=this.coordsAt(e.anchor,e.anchor>e.head?-1:1))&&(i={left:Math.min(i.left,n.left),top:Math.min(i.top,n.top),right:Math.max(i.right,n.right),bottom:Math.max(i.bottom,n.bottom)});let o=Zh(this.view),l={left:i.left-o.left,top:i.top-o.top,right:i.right+o.right,bottom:i.bottom+o.bottom},{offsetWidth:h,offsetHeight:f}=this.view.scrollDOM;AS(this.view.scrollDOM,l,e.head<e.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,h),-h),Math.max(Math.min(t.yMargin,f),-f),this.view.textDirection==$t.LTR)}}function KS(r){return r.node.nodeType==1&&r.node.firstChild&&(r.offset==0||r.node.childNodes[r.offset-1].contentEditable=="false")&&(r.offset==r.node.childNodes.length||r.node.childNodes[r.offset].contentEditable=="false")}function Hg(r,t){let e=r.observer.selectionRange;if(!e.focusNode)return null;let i=cg(e.focusNode,e.focusOffset),n=dg(e.focusNode,e.focusOffset),o=i||n;if(n&&i&&n.node!=i.node){let h=xt.get(n.node);if(!h||h instanceof ni&&h.text!=n.node.nodeValue)o=n;else if(r.docView.lastCompositionAfterCursor){let f=xt.get(i.node);!f||f instanceof ni&&f.text!=i.node.nodeValue||(o=n)}}if(r.docView.lastCompositionAfterCursor=o!=i,!o)return null;let l=t-o.offset;return{from:l,to:l+o.node.nodeValue.length,node:o.node}}function GS(r,t,e){let i=Hg(r,e);if(!i)return null;let{node:n,from:o,to:l}=i,h=n.nodeValue;if(/[\n\r]/.test(h)||r.state.doc.sliceString(i.from,i.to)!=h)return null;let f=t.invertedDesc,c=new qe(f.mapPos(o),f.mapPos(l),o,l),d=[];for(let g=n.parentNode;;g=g.parentNode){let m=xt.get(g);if(m instanceof zi)d.push({node:g,deco:m.mark});else{if(m instanceof Nt||g.nodeName=="DIV"&&g.parentNode==r.contentDOM)return{range:c,text:n,marks:d,line:g};if(g!=r.contentDOM)d.push({node:g,deco:new us({inclusive:!0,attributes:LS(g),tagName:g.tagName.toLowerCase()})});else return null}}}function ZS(r,t){return r.nodeType!=1?0:(t&&r.childNodes[t-1].contentEditable=="false"?1:0)|(t<r.childNodes.length&&r.childNodes[t].contentEditable=="false"?2:0)}let jS=class{constructor(){this.changes=[]}compareRange(t,e){Io(t,e,this.changes)}comparePoint(t,e){Io(t,e,this.changes)}boundChange(t){Io(t,t,this.changes)}};function JS(r,t,e){let i=new jS;return Ct.compare(r,t,e,i),i.changes}function tk(r,t){for(let e=r;e&&e!=t;e=e.assignedSlot||e.parentNode)if(e.nodeType==1&&e.contentEditable=="false")return!0;return!1}function ek(r,t){let e=!1;return t&&r.iterChangedRanges((i,n)=>{i<t.to&&n>t.from&&(e=!0)}),e}function ik(r,t,e=1){let i=r.charCategorizer(t),n=r.doc.lineAt(t),o=t-n.from;if(n.length==0)return V.cursor(t);o==0?e=1:o==n.length&&(e=-1);let l=o,h=o;e<0?l=yi(n.text,o,!1):h=yi(n.text,o);let f=i(n.text.slice(l,h));for(;l>0;){let c=yi(n.text,l,!1);if(i(n.text.slice(c,l))!=f)break;l=c}for(;h<n.length;){let c=yi(n.text,h);if(i(n.text.slice(h,c))!=f)break;h=c}return V.range(l+n.from,h+n.from)}function nk(r,t){return t.left>r?t.left-r:Math.max(0,r-t.right)}function rk(r,t){return t.top>r?t.top-r:Math.max(0,r-t.bottom)}function La(r,t){return r.top<t.bottom-1&&r.bottom>t.top+1}function kd(r,t){return t<r.top?{top:t,left:r.left,right:r.right,bottom:r.bottom}:r}function Cd(r,t){return t>r.bottom?{top:r.top,left:r.left,right:r.right,bottom:t}:r}function kh(r,t,e){let i,n,o,l,h=!1,f,c,d,g;for(let b=r.firstChild;b;b=b.nextSibling){let S=rr(b);for(let A=0;A<S.length;A++){let P=S[A];n&&La(n,P)&&(P=kd(Cd(P,n.bottom),n.top));let B=nk(t,P),N=rk(e,P);if(B==0&&N==0)return b.nodeType==3?Ad(b,t,e):kh(b,t,e);if(!i||l>N||l==N&&o>B){i=b,n=P,o=B,l=N;let D=N?e<P.top?-1:1:B?t<P.left?-1:1:0;h=!D||(D>0?A<S.length-1:A>0)}B==0?e>P.bottom&&(!d||d.bottom<P.bottom)?(f=b,d=P):e<P.top&&(!g||g.top>P.top)&&(c=b,g=P):d&&La(d,P)?d=Cd(d,P.bottom):g&&La(g,P)&&(g=kd(g,P.top))}}if(d&&d.bottom>=e?(i=f,n=d):g&&g.top<=e&&(i=c,n=g),!i)return{node:r,offset:0};let m=Math.max(n.left,Math.min(n.right,t));if(i.nodeType==3)return Ad(i,m,e);if(h&&i.contentEditable!="false")return kh(i,m,e);let y=Array.prototype.indexOf.call(r.childNodes,i)+(t>=(n.left+n.right)/2?1:0);return{node:r,offset:y}}function Ad(r,t,e){let i=r.nodeValue.length,n=-1,o=1e9,l=0;for(let h=0;h<i;h++){let f=Mn(r,h,h+1).getClientRects();for(let c=0;c<f.length;c++){let d=f[c];if(d.top==d.bottom)continue;l||(l=t-d.left);let g=(d.top>e?d.top-e:e-d.bottom)-1;if(d.left-1<=t&&d.right+1>=t&&g<o){let m=t>=(d.left+d.right)/2,y=m;if((Q.chrome||Q.gecko)&&Mn(r,h).getBoundingClientRect().left==d.right&&(y=!m),g<=0)return{node:r,offset:h+(y?1:0)};n=h+(y?1:0),o=g}}}return{node:r,offset:n>-1?n:l>0?r.nodeValue.length:0}}function zg(r,t,e,i=-1){var n,o;let l=r.contentDOM.getBoundingClientRect(),h=l.top+r.viewState.paddingTop,f,{docHeight:c}=r.viewState,{x:d,y:g}=t,m=g-h;if(m<0)return 0;if(m>c)return r.state.doc.length;for(let D=r.viewState.heightOracle.textHeight/2,$=!1;f=r.elementAtHeight(m),f.type!=Oi.Text;)for(;m=i>0?f.bottom+D:f.top-D,!(m>=0&&m<=c);){if($)return e?null:0;$=!0,i=-i}g=h+m;let y=f.from;if(y<r.viewport.from)return r.viewport.from==0?0:e?null:Td(r,l,f,d,g);if(y>r.viewport.to)return r.viewport.to==r.state.doc.length?r.state.doc.length:e?null:Td(r,l,f,d,g);let b=r.dom.ownerDocument,S=r.root.elementFromPoint?r.root:b,A=S.elementFromPoint(d,g);A&&!r.contentDOM.contains(A)&&(A=null),A||(d=Math.max(l.left+1,Math.min(l.right-1,d)),A=S.elementFromPoint(d,g),A&&!r.contentDOM.contains(A)&&(A=null));let P,B=-1;if(A&&((n=r.docView.nearest(A))===null||n===void 0?void 0:n.isEditable)!=!1){if(b.caretPositionFromPoint){let D=b.caretPositionFromPoint(d,g);D&&({offsetNode:P,offset:B}=D)}else if(b.caretRangeFromPoint){let D=b.caretRangeFromPoint(d,g);D&&({startContainer:P,startOffset:B}=D,(!r.contentDOM.contains(P)||Q.safari&&sk(P,B,d)||Q.chrome&&ok(P,B,d))&&(P=void 0))}P&&(B=Math.min(Si(P),B))}if(!P||!r.docView.dom.contains(P)){let D=Nt.find(r.docView,y);if(!D)return m>f.top+f.height/2?f.to:f.from;({node:P,offset:B}=kh(D.dom,d,g))}let N=r.docView.nearest(P);if(!N)return null;if(N.isWidget&&((o=N.dom)===null||o===void 0?void 0:o.nodeType)==1){let D=N.dom.getBoundingClientRect();return t.y<D.top||t.y<=D.bottom&&t.x<=(D.left+D.right)/2?N.posAtStart:N.posAtEnd}else return N.localPosFromDOM(P,B)+N.posAtStart}function Td(r,t,e,i,n){let o=Math.round((i-t.left)*r.defaultCharacterWidth);if(r.lineWrapping&&e.height>r.defaultLineHeight*1.5){let h=r.viewState.heightOracle.textHeight,f=Math.floor((n-e.top-(r.defaultLineHeight-h)*.5)/h);o+=f*r.viewState.heightOracle.lineLength}let l=r.state.sliceDoc(e.from,e.to);return e.from+xS(l,o,r.state.tabSize)}function sk(r,t,e){let i;if(r.nodeType!=3||t!=(i=r.nodeValue.length))return!1;for(let n=r.nextSibling;n;n=n.nextSibling)if(n.nodeType!=1||n.nodeName!="BR")return!1;return Mn(r,i-1,i).getBoundingClientRect().left>e}function ok(r,t,e){if(t!=0)return!1;for(let n=r;;){let o=n.parentNode;if(!o||o.nodeType!=1||o.firstChild!=n)return!1;if(o.classList.contains("cm-line"))break;n=o}let i=r.nodeType==1?r.getBoundingClientRect():Mn(r,0,Math.max(r.nodeValue.length,1)).getBoundingClientRect();return e-i.left>5}function lk(r,t){let e=r.lineBlockAt(t);if(Array.isArray(e.type)){for(let i of e.type)if(i.to>t||i.to==t&&(i.to==e.to||i.type==Oi.Text))return i}return e}function ak(r,t,e,i){let n=lk(r,t.head),o=!i||n.type!=Oi.Text||!(r.lineWrapping||n.widgetLineBreaks)?null:r.coordsAtPos(t.assoc<0&&t.head>n.from?t.head-1:t.head);if(o){let l=r.dom.getBoundingClientRect(),h=r.textDirectionAt(n.from),f=r.posAtCoords({x:e==(h==$t.LTR)?l.right-1:l.left+1,y:(o.top+o.bottom)/2});if(f!=null)return V.cursor(f,e?-1:1)}return V.cursor(e?n.to:n.from,e?-1:1)}function Pd(r,t,e,i){let n=r.state.doc.lineAt(t.head),o=r.bidiSpans(n),l=r.textDirectionAt(n.from);for(let h=t,f=null;;){let c=US(n,o,l,h,e),d=Tg;if(!c){if(n.number==(e?r.state.doc.lines:1))return h;d=`
`,n=r.state.doc.line(n.number+(e?1:-1)),o=r.bidiSpans(n),c=r.visualLineSide(n,!e)}if(f){if(!f(d))return h}else{if(!i)return c;f=i(d)}h=c}}function hk(r,t,e){let i=r.state.charCategorizer(t),n=i(e);return o=>{let l=i(o);return n==Ve.Space&&(n=l),n==l}}function fk(r,t,e,i){let n=t.head,o=e?1:-1;if(n==(e?r.state.doc.length:0))return V.cursor(n,t.assoc);let l=t.goalColumn,h,f=r.contentDOM.getBoundingClientRect(),c=r.coordsAtPos(n,t.assoc||-1),d=r.documentTop;if(c)l==null&&(l=c.left-f.left),h=o<0?c.top:c.bottom;else{let y=r.viewState.lineBlockAt(n);l==null&&(l=Math.min(f.right-f.left,r.defaultCharacterWidth*(n-y.from))),h=(o<0?y.top:y.bottom)+d}let g=f.left+l,m=i??r.viewState.heightOracle.textHeight>>1;for(let y=0;;y+=10){let b=h+(m+y)*o,S=zg(r,{x:g,y:b},!1,o);if(b<f.top||b>f.bottom||(o<0?S<n:S>n)){let A=r.docView.coordsForChar(S),P=!A||b<A.top?-1:1;return V.cursor(S,P,void 0,l)}}}function Bo(r,t,e){for(;;){let i=0;for(let n of r)n.between(t-1,t+1,(o,l,h)=>{if(t>o&&t<l){let f=i||e||(t-o<l-t?-1:1);t=f<0?o:l,i=f}});if(!i)return t}}function Na(r,t,e){let i=Bo(r.state.facet(Gh).map(n=>n(r)),e.from,t.head>e.from?-1:1);return i==e.from?e:V.cursor(i,i<e.from?1:-1)}const Hr="";class uk{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(mt.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=Hr}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n);let o=this.text.length;this.readNode(n);let l=n.nextSibling;if(l==e)break;let h=xt.get(n),f=xt.get(l);(h&&f?h.breakAfter:(h?h.breakAfter:Ho(n))||Ho(l)&&(n.nodeName!="BR"||n.cmIgnore)&&this.text.length>o)&&this.lineBreak(),n=l}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let o=-1,l=1,h;if(this.lineSeparator?(o=e.indexOf(this.lineSeparator,i),l=this.lineSeparator.length):(h=n.exec(e))&&(o=h.index,l=h[0].length),this.append(e.slice(i,o<0?e.length:o)),o<0)break;if(this.lineBreak(),l>1)for(let f of this.points)f.node==t&&f.pos>this.text.length&&(f.pos-=l-1);i=o+l}}readNode(t){if(t.cmIgnore)return;let e=xt.get(t),i=e&&e.overrideDOMText;if(i!=null){this.findPointInside(t,i.length);for(let n=i.iter();!n.next().done;)n.lineBreak?this.lineBreak():this.append(n.value)}else t.nodeType==3?this.readTextNode(t):t.nodeName=="BR"?t.nextSibling&&this.lineBreak():t.nodeType==1&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(t.nodeType==3?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+(ck(t,i.node,i.offset)?e:0))}}function ck(r,t,e){for(;;){if(!t||e<Si(t))return!1;if(t==r)return!0;e=Pn(t)+1,t=t.parentNode}}class Md{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class dk{constructor(t,e,i,n){this.typeOver=n,this.bounds=null,this.text="",this.domChanged=e>-1;let{impreciseHead:o,impreciseAnchor:l}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,i,0))){let h=o||l?[]:mk(t),f=new uk(h,t.state);f.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=f.text,this.newSel=wk(h,this.bounds.from)}else{let h=t.observer.selectionRange,f=o&&o.node==h.focusNode&&o.offset==h.focusOffset||!dh(t.contentDOM,h.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(h.focusNode,h.focusOffset),c=l&&l.node==h.anchorNode&&l.offset==h.anchorOffset||!dh(t.contentDOM,h.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(h.anchorNode,h.anchorOffset),d=t.viewport;if((Q.ios||Q.chrome)&&t.state.selection.main.empty&&f!=c&&(d.from>0||d.to<t.state.doc.length)){let g=Math.min(f,c),m=Math.max(f,c),y=d.from-g,b=d.to-m;(y==0||y==1||g==0)&&(b==0||b==-1||m==t.state.doc.length)&&(f=0,c=t.state.doc.length)}this.newSel=V.single(c,f)}}}function Vg(r,t){let e,{newSel:i}=t,n=r.state.selection.main,o=r.inputState.lastKeyTime>Date.now()-100?r.inputState.lastKeyCode:-1;if(t.bounds){let{from:l,to:h}=t.bounds,f=n.from,c=null;(o===8||Q.android&&t.text.length<h-l)&&(f=n.to,c="end");let d=gk(r.state.doc.sliceString(l,h,Hr),t.text,f-l,c);d&&(Q.chrome&&o==13&&d.toB==d.from+2&&t.text.slice(d.from,d.toB)==Hr+Hr&&d.toB--,e={from:l+d.from,to:l+d.toA,insert:ct.of(t.text.slice(d.from,d.toB).split(Hr))})}else i&&(!r.hasFocus&&r.state.facet(Wi)||i.main.eq(n))&&(i=null);if(!e&&!i)return!1;if(!e&&t.typeOver&&!n.empty&&i&&i.main.empty?e={from:n.from,to:n.to,insert:r.state.doc.slice(n.from,n.to)}:(Q.mac||Q.android)&&e&&e.from==e.to&&e.from==n.head-1&&/^\. ?$/.test(e.insert.toString())&&r.contentDOM.getAttribute("autocorrect")=="off"?(i&&e.insert.length==2&&(i=V.single(i.main.anchor-1,i.main.head-1)),e={from:e.from,to:e.to,insert:ct.of([e.insert.toString().replace("."," ")])}):e&&e.from>=n.from&&e.to<=n.to&&(e.from!=n.from||e.to!=n.to)&&n.to-n.from-(e.to-e.from)<=4?e={from:n.from,to:n.to,insert:r.state.doc.slice(n.from,e.from).append(e.insert).append(r.state.doc.slice(e.to,n.to))}:Q.chrome&&e&&e.from==e.to&&e.from==n.head&&e.insert.toString()==`
 `&&r.lineWrapping&&(i&&(i=V.single(i.main.anchor-1,i.main.head-1)),e={from:n.from,to:n.to,insert:ct.of([" "])}),e)return jh(r,e,i,o);if(i&&!i.main.eq(n)){let l=!1,h="select";return r.inputState.lastSelectionTime>Date.now()-50&&(r.inputState.lastSelectionOrigin=="select"&&(l=!0),h=r.inputState.lastSelectionOrigin),r.dispatch({selection:i,scrollIntoView:l,userEvent:h}),!0}else return!1}function jh(r,t,e,i=-1){if(Q.ios&&r.inputState.flushIOSKey(t))return!0;let n=r.state.selection.main;if(Q.android&&(t.to==n.to&&(t.from==n.from||t.from==n.from-1&&r.state.sliceDoc(t.from,n.from)==" ")&&t.insert.length==1&&t.insert.lines==2&&Gn(r.contentDOM,"Enter",13)||(t.from==n.from-1&&t.to==n.to&&t.insert.length==0||i==8&&t.insert.length<t.to-t.from&&t.to>n.head)&&Gn(r.contentDOM,"Backspace",8)||t.from==n.from&&t.to==n.to+1&&t.insert.length==0&&Gn(r.contentDOM,"Delete",46)))return!0;let o=t.insert.toString();r.inputState.composing>=0&&r.inputState.composing++;let l,h=()=>l||(l=pk(r,t,e));return r.state.facet(Eg).some(f=>f(r,t.from,t.to,o,h))||r.dispatch(h()),!0}function pk(r,t,e){let i,n=r.state,o=n.selection.main;if(t.from>=o.from&&t.to<=o.to&&t.to-t.from>=(o.to-o.from)/3&&(!e||e.main.empty&&e.main.from==t.from+t.insert.length)&&r.inputState.composing<0){let h=o.from<t.from?n.sliceDoc(o.from,t.from):"",f=o.to>t.to?n.sliceDoc(t.to,o.to):"";i=n.replaceSelection(r.state.toText(h+t.insert.sliceString(0,void 0,r.state.lineBreak)+f))}else{let h=n.changes(t),f=e&&e.main.to<=h.newLength?e.main:void 0;if(n.selection.ranges.length>1&&r.inputState.composing>=0&&t.to<=o.to&&t.to>=o.to-10){let c=r.state.sliceDoc(t.from,t.to),d,g=e&&Hg(r,e.main.head);if(g){let b=t.insert.length-(t.to-t.from);d={from:g.from,to:g.to-b}}else d=r.state.doc.lineAt(o.head);let m=o.to-t.to,y=o.to-o.from;i=n.changeByRange(b=>{if(b.from==o.from&&b.to==o.to)return{changes:h,range:f||b.map(h)};let S=b.to-m,A=S-c.length;if(b.to-b.from!=y||r.state.sliceDoc(A,S)!=c||b.to>=d.from&&b.from<=d.to)return{range:b};let P=n.changes({from:A,to:S,insert:t.insert}),B=b.to-o.to;return{changes:P,range:f?V.range(Math.max(0,f.anchor+B),Math.max(0,f.head+B)):b.map(P)}})}else i={changes:h,selection:f&&n.selection.replaceRange(f)}}let l="input.type";return(r.composing||r.inputState.compositionPendingChange&&r.inputState.compositionEndedAt>Date.now()-50)&&(r.inputState.compositionPendingChange=!1,l+=".compose",r.inputState.compositionFirstChange&&(l+=".start",r.inputState.compositionFirstChange=!1)),n.update(i,{userEvent:l,scrollIntoView:!0})}function gk(r,t,e,i){let n=Math.min(r.length,t.length),o=0;for(;o<n&&r.charCodeAt(o)==t.charCodeAt(o);)o++;if(o==n&&r.length==t.length)return null;let l=r.length,h=t.length;for(;l>0&&h>0&&r.charCodeAt(l-1)==t.charCodeAt(h-1);)l--,h--;if(i=="end"){let f=Math.max(0,o-Math.min(l,h));e-=l+f-o}if(l<o&&r.length<t.length){let f=e<=o&&e>=l?o-e:0;o-=f,h=o+(h-l),l=o}else if(h<o){let f=e<=o&&e>=h?o-e:0;o-=f,l=o+(l-h),h=o}return{from:o,toA:l,toB:h}}function mk(r){let t=[];if(r.root.activeElement!=r.contentDOM)return t;let{anchorNode:e,anchorOffset:i,focusNode:n,focusOffset:o}=r.observer.selectionRange;return e&&(t.push(new Md(e,i)),(n!=e||o!=i)&&t.push(new Md(n,o))),t}function wk(r,t){if(r.length==0)return null;let e=r[0].pos,i=r.length==2?r[1].pos:e;return e>-1&&i>-1?V.single(e+t,i+t):null}class yk{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,Q.safari&&t.contentDOM.addEventListener("input",()=>null),Q.gecko&&Ik(t.contentDOM.ownerDocument)}handleEvent(t){!Ak(this.view,t)||this.ignoreDuringComposition(t)||t.type=="keydown"&&this.keydown(t)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(t.type,t)):this.runHandlers(t.type,t))}runHandlers(t,e){let i=this.handlers[t];if(i){for(let n of i.observers)n(this.view,e);for(let n of i.handlers){if(e.defaultPrevented)break;if(n(this.view,e)){e.preventDefault();break}}}}ensureHandlers(t){let e=vk(t),i=this.handlers,n=this.view.contentDOM;for(let o in e)if(o!="scroll"){let l=!e[o].handlers.length,h=i[o];h&&l!=!h.handlers.length&&(n.removeEventListener(o,this.handleEvent),h=null),h||n.addEventListener(o,this.handleEvent,{passive:l})}for(let o in i)o!="scroll"&&!e[o]&&n.removeEventListener(o,this.handleEvent);this.handlers=e}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&t.keyCode!=27&&Ug.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),Q.android&&Q.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let e;return Q.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((e=Qg.find(i=>i.keyCode==t.keyCode))&&!t.ctrlKey||xk.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=e||t,setTimeout(()=>this.flushIOSKey(),250),!0):(t.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(t){let e=this.pendingIOSKey;return!e||e.key=="Enter"&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString())?!1:(this.pendingIOSKey=void 0,Gn(this.view.contentDOM,e.key,e.keyCode,e instanceof KeyboardEvent?e:void 0))}ignoreDuringComposition(t){return/^key/.test(t.type)?this.composing>0?!0:Q.safari&&!Q.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Rd(r,t){return(e,i)=>{try{return t.call(r,i,e)}catch(n){le(e.state,n)}}}function vk(r){let t=Object.create(null);function e(i){return t[i]||(t[i]={observers:[],handlers:[]})}for(let i of r){let n=i.spec;if(n&&n.domEventHandlers)for(let o in n.domEventHandlers){let l=n.domEventHandlers[o];l&&e(o).handlers.push(Rd(i.value,l))}if(n&&n.domEventObservers)for(let o in n.domEventObservers){let l=n.domEventObservers[o];l&&e(o).observers.push(Rd(i.value,l))}}for(let i in ri)e(i).handlers.push(ri[i]);for(let i in Xe)e(i).observers.push(Xe[i]);return t}const Qg=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],xk="dthko",Ug=[16,17,18,20,91,92,224,225],po=6;function go(r){return Math.max(0,r)*.7+8}function bk(r,t){return Math.max(Math.abs(r.clientX-t.clientX),Math.abs(r.clientY-t.clientY))}class Ok{constructor(t,e,i,n){this.view=t,this.startEvent=e,this.style=i,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParents=TS(t.contentDOM),this.atoms=t.state.facet(Gh).map(l=>l(t));let o=t.contentDOM.ownerDocument;o.addEventListener("mousemove",this.move=this.move.bind(this)),o.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(mt.allowMultipleSelections)&&Sk(t,e),this.dragging=Ck(t,e)&&Yg(e)==1?null:!1}start(t){this.dragging===!1&&this.select(t)}move(t){if(t.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&bk(this.startEvent,t)<10)return;this.select(this.lastEvent=t);let e=0,i=0,n=0,o=0,l=this.view.win.innerWidth,h=this.view.win.innerHeight;this.scrollParents.x&&({left:n,right:l}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:o,bottom:h}=this.scrollParents.y.getBoundingClientRect());let f=Zh(this.view);t.clientX-f.left<=n+po?e=-go(n-t.clientX):t.clientX+f.right>=l-po&&(e=go(t.clientX-l)),t.clientY-f.top<=o+po?i=-go(o-t.clientY):t.clientY+f.bottom>=h-po&&(i=go(t.clientY-h)),this.setScrollSpeed(e,i)}up(t){this.dragging==null&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:e}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),e&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=e,e=0),(t||e)&&this.view.win.scrollBy(t,e),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(t){let e=null;for(let i=0;i<t.ranges.length;i++){let n=t.ranges[i],o=null;if(n.empty){let l=Bo(this.atoms,n.from,0);l!=n.from&&(o=V.cursor(l,-1))}else{let l=Bo(this.atoms,n.from,-1),h=Bo(this.atoms,n.to,1);(l!=n.from||h!=n.to)&&(o=V.range(n.from==n.anchor?l:h,n.from==n.head?l:h))}o&&(e||(e=t.ranges.slice()),e[i]=o)}return e?V.create(e,t.mainIndex):t}select(t){let{view:e}=this,i=this.skipAtoms(this.style.get(t,this.extend,this.multiple));(this.mustSelect||!i.eq(e.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some(e=>e.isUserEvent("input.type"))?this.destroy():this.style.update(t)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Sk(r,t){let e=r.state.facet(Pg);return e.length?e[0](t):Q.mac?t.metaKey:t.ctrlKey}function kk(r,t){let e=r.state.facet(Mg);return e.length?e[0](t):Q.mac?!t.altKey:!t.ctrlKey}function Ck(r,t){let{main:e}=r.state.selection;if(e.empty)return!1;let i=is(r.root);if(!i||i.rangeCount==0)return!0;let n=i.getRangeAt(0).getClientRects();for(let o=0;o<n.length;o++){let l=n[o];if(l.left<=t.clientX&&l.right>=t.clientX&&l.top<=t.clientY&&l.bottom>=t.clientY)return!0}return!1}function Ak(r,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target,i;e!=r.contentDOM;e=e.parentNode)if(!e||e.nodeType==11||(i=xt.get(e))&&i.ignoreEvent(t))return!1;return!0}const ri=Object.create(null),Xe=Object.create(null),qg=Q.ie&&Q.ie_version<15||Q.ios&&Q.webkit_version<604;function Tk(r){let t=r.dom.parentNode;if(!t)return;let e=t.appendChild(document.createElement("textarea"));e.style.cssText="position: fixed; left: -10000px; top: 10px",e.focus(),setTimeout(()=>{r.focus(),e.remove(),Xg(r,e.value)},50)}function ol(r,t,e){for(let i of r.facet(t))e=i(e,r);return e}function Xg(r,t){t=ol(r.state,Xh,t);let{state:e}=r,i,n=1,o=e.toText(t),l=o.lines==e.selection.ranges.length;if(Ch!=null&&e.selection.ranges.every(f=>f.empty)&&Ch==o.toString()){let f=-1;i=e.changeByRange(c=>{let d=e.doc.lineAt(c.from);if(d.from==f)return{range:c};f=d.from;let g=e.toText((l?o.line(n++).text:t)+e.lineBreak);return{changes:{from:d.from,insert:g},range:V.cursor(c.from+g.length)}})}else l?i=e.changeByRange(f=>{let c=o.line(n++);return{changes:{from:f.from,to:f.to,insert:c.text},range:V.cursor(f.from+c.length)}}):i=e.replaceSelection(o);r.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}Xe.scroll=r=>{r.inputState.lastScrollTop=r.scrollDOM.scrollTop,r.inputState.lastScrollLeft=r.scrollDOM.scrollLeft};ri.keydown=(r,t)=>(r.inputState.setSelectionOrigin("select"),t.keyCode==27&&r.inputState.tabFocusMode!=0&&(r.inputState.tabFocusMode=Date.now()+2e3),!1);Xe.touchstart=(r,t)=>{r.inputState.lastTouchTime=Date.now(),r.inputState.setSelectionOrigin("select.pointer")};Xe.touchmove=r=>{r.inputState.setSelectionOrigin("select.pointer")};ri.mousedown=(r,t)=>{if(r.observer.flush(),r.inputState.lastTouchTime>Date.now()-2e3)return!1;let e=null;for(let i of r.state.facet(Rg))if(e=i(r,t),e)break;if(!e&&t.button==0&&(e=Rk(r,t)),e){let i=!r.hasFocus;r.inputState.startMouseSelection(new Ok(r,t,e,i)),i&&r.observer.ignore(()=>{hg(r.contentDOM);let o=r.root.activeElement;o&&!o.contains(r.contentDOM)&&o.blur()});let n=r.inputState.mouseSelection;if(n)return n.start(t),n.dragging===!1}return!1};function _d(r,t,e,i){if(i==1)return V.cursor(t,e);if(i==2)return ik(r.state,t,e);{let n=Nt.find(r.docView,t),o=r.state.doc.lineAt(n?n.posAtEnd:t),l=n?n.posAtStart:o.from,h=n?n.posAtEnd:o.to;return h<r.state.doc.length&&h==o.to&&h++,V.range(l,h)}}let Ed=(r,t,e)=>t>=e.top&&t<=e.bottom&&r>=e.left&&r<=e.right;function Pk(r,t,e,i){let n=Nt.find(r.docView,t);if(!n)return 1;let o=t-n.posAtStart;if(o==0)return 1;if(o==n.length)return-1;let l=n.coordsAt(o,-1);if(l&&Ed(e,i,l))return-1;let h=n.coordsAt(o,1);return h&&Ed(e,i,h)?1:l&&l.bottom>=i?-1:1}function Dd(r,t){let e=r.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:e,bias:Pk(r,e,t.clientX,t.clientY)}}const Mk=Q.ie&&Q.ie_version<=11;let Id=null,Bd=0,Ld=0;function Yg(r){if(!Mk)return r.detail;let t=Id,e=Ld;return Id=r,Ld=Date.now(),Bd=!t||e>Date.now()-400&&Math.abs(t.clientX-r.clientX)<2&&Math.abs(t.clientY-r.clientY)<2?(Bd+1)%3:1}function Rk(r,t){let e=Dd(r,t),i=Yg(t),n=r.state.selection;return{update(o){o.docChanged&&(e.pos=o.changes.mapPos(e.pos),n=n.map(o.changes))},get(o,l,h){let f=Dd(r,o),c,d=_d(r,f.pos,f.bias,i);if(e.pos!=f.pos&&!l){let g=_d(r,e.pos,e.bias,i),m=Math.min(g.from,d.from),y=Math.max(g.to,d.to);d=m<d.from?V.range(m,y):V.range(y,m)}return l?n.replaceRange(n.main.extend(d.from,d.to)):h&&i==1&&n.ranges.length>1&&(c=_k(n,f.pos))?c:h?n.addRange(d):V.create([d])}}}function _k(r,t){for(let e=0;e<r.ranges.length;e++){let{from:i,to:n}=r.ranges[e];if(i<=t&&n>=t)return V.create(r.ranges.slice(0,e).concat(r.ranges.slice(e+1)),r.mainIndex==e?0:r.mainIndex-(r.mainIndex>e?1:0))}return null}ri.dragstart=(r,t)=>{let{selection:{main:e}}=r.state;if(t.target.draggable){let n=r.docView.nearest(t.target);if(n&&n.isWidget){let o=n.posAtStart,l=o+n.length;(o>=e.to||l<=e.from)&&(e=V.range(o,l))}}let{inputState:i}=r;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=e,t.dataTransfer&&(t.dataTransfer.setData("Text",ol(r.state,Yh,r.state.sliceDoc(e.from,e.to))),t.dataTransfer.effectAllowed="copyMove"),!1};ri.dragend=r=>(r.inputState.draggedContent=null,!1);function Nd(r,t,e,i){if(e=ol(r.state,Xh,e),!e)return;let n=r.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:o}=r.inputState,l=i&&o&&kk(r,t)?{from:o.from,to:o.to}:null,h={from:n,insert:e},f=r.state.changes(l?[l,h]:h);r.focus(),r.dispatch({changes:f,selection:{anchor:f.mapPos(n,-1),head:f.mapPos(n,1)},userEvent:l?"move.drop":"input.drop"}),r.inputState.draggedContent=null}ri.drop=(r,t)=>{if(!t.dataTransfer)return!1;if(r.state.readOnly)return!0;let e=t.dataTransfer.files;if(e&&e.length){let i=Array(e.length),n=0,o=()=>{++n==e.length&&Nd(r,t,i.filter(l=>l!=null).join(r.state.lineBreak),!1)};for(let l=0;l<e.length;l++){let h=new FileReader;h.onerror=o,h.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(h.result)||(i[l]=h.result),o()},h.readAsText(e[l])}return!0}else{let i=t.dataTransfer.getData("Text");if(i)return Nd(r,t,i,!0),!0}return!1};ri.paste=(r,t)=>{if(r.state.readOnly)return!0;r.observer.flush();let e=qg?null:t.clipboardData;return e?(Xg(r,e.getData("text/plain")||e.getData("text/uri-list")),!0):(Tk(r),!1)};function Ek(r,t){let e=r.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=t,i.focus(),i.selectionEnd=t.length,i.selectionStart=0,setTimeout(()=>{i.remove(),r.focus()},50)}function Dk(r){let t=[],e=[],i=!1;for(let n of r.selection.ranges)n.empty||(t.push(r.sliceDoc(n.from,n.to)),e.push(n));if(!t.length){let n=-1;for(let{from:o}of r.selection.ranges){let l=r.doc.lineAt(o);l.number>n&&(t.push(l.text),e.push({from:l.from,to:Math.min(r.doc.length,l.to+1)})),n=l.number}i=!0}return{text:ol(r,Yh,t.join(r.lineBreak)),ranges:e,linewise:i}}let Ch=null;ri.copy=ri.cut=(r,t)=>{let{text:e,ranges:i,linewise:n}=Dk(r.state);if(!e&&!n)return!1;Ch=n?e:null,t.type=="cut"&&!r.state.readOnly&&r.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let o=qg?null:t.clipboardData;return o?(o.clearData(),o.setData("text/plain",e),!0):(Ek(r,e),!1)};const Kg=Vi.define();function Gg(r,t){let e=[];for(let i of r.facet(Dg)){let n=i(r,t);n&&e.push(n)}return e?r.update({effects:e,annotations:Kg.of(!0)}):null}function Zg(r){setTimeout(()=>{let t=r.hasFocus;if(t!=r.inputState.notifiedFocused){let e=Gg(r.state,t);e?r.dispatch(e):r.update([])}},10)}Xe.focus=r=>{r.inputState.lastFocusTime=Date.now(),!r.scrollDOM.scrollTop&&(r.inputState.lastScrollTop||r.inputState.lastScrollLeft)&&(r.scrollDOM.scrollTop=r.inputState.lastScrollTop,r.scrollDOM.scrollLeft=r.inputState.lastScrollLeft),Zg(r)};Xe.blur=r=>{r.observer.clearSelectionRange(),Zg(r)};Xe.compositionstart=Xe.compositionupdate=r=>{r.observer.editContext||(r.inputState.compositionFirstChange==null&&(r.inputState.compositionFirstChange=!0),r.inputState.composing<0&&(r.inputState.composing=0))};Xe.compositionend=r=>{r.observer.editContext||(r.inputState.composing=-1,r.inputState.compositionEndedAt=Date.now(),r.inputState.compositionPendingKey=!0,r.inputState.compositionPendingChange=r.observer.pendingRecords().length>0,r.inputState.compositionFirstChange=null,Q.chrome&&Q.android?r.observer.flushSoon():r.inputState.compositionPendingChange?Promise.resolve().then(()=>r.observer.flush()):setTimeout(()=>{r.inputState.composing<0&&r.docView.hasComposition&&r.update([])},50))};Xe.contextmenu=r=>{r.inputState.lastContextMenu=Date.now()};ri.beforeinput=(r,t)=>{var e,i;if(t.inputType=="insertReplacementText"&&r.observer.editContext){let o=(e=t.dataTransfer)===null||e===void 0?void 0:e.getData("text/plain"),l=t.getTargetRanges();if(o&&l.length){let h=l[0],f=r.posAtDOM(h.startContainer,h.startOffset),c=r.posAtDOM(h.endContainer,h.endOffset);return jh(r,{from:f,to:c,insert:r.state.toText(o)},null),!0}}let n;if(Q.chrome&&Q.android&&(n=Qg.find(o=>o.inputType==t.inputType))&&(r.observer.delayAndroidKey(n.key,n.keyCode),n.key=="Backspace"||n.key=="Delete")){let o=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var l;(((l=window.visualViewport)===null||l===void 0?void 0:l.height)||0)>o+10&&r.hasFocus&&(r.contentDOM.blur(),r.focus())},100)}return Q.ios&&t.inputType=="deleteContentForward"&&r.observer.flushSoon(),Q.safari&&t.inputType=="insertText"&&r.inputState.composing>=0&&setTimeout(()=>Xe.compositionend(r,t),20),!1};const $d=new Set;function Ik(r){$d.has(r)||($d.add(r),r.addEventListener("copy",()=>{}),r.addEventListener("cut",()=>{}))}const Wd=["pre-wrap","normal","pre-line","break-spaces"];let lr=!1;function Fd(){lr=!1}class Bk{constructor(t){this.lineWrapping=t,this.doc=ct.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return Wd.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(n*10)]||(e=!0,this.heightSamples[Math.floor(n*10)]=!0)}return e}refresh(t,e,i,n,o,l){let h=Wd.indexOf(t)>-1,f=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=h;if(this.lineWrapping=h,this.lineHeight=e,this.charWidth=i,this.textHeight=n,this.lineLength=o,f){this.heightSamples={};for(let c=0;c<l.length;c++){let d=l[c];d<0?c++:this.heightSamples[Math.floor(d*10)]=!0}}return f}}class Lk{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class mi{constructor(t,e,i,n,o){this.from=t,this.length=e,this.top=i,this.height=n,this._content=o}get type(){return typeof this._content=="number"?Oi.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof fn?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(t){let e=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new mi(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var Tt=function(r){return r[r.ByPos=0]="ByPos",r[r.ByHeight=1]="ByHeight",r[r.ByPosNoHeight=2]="ByPosNoHeight",r}(Tt||(Tt={}));const Lo=.001;class ae{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(t){this.flags=(t?2:0)|this.flags&-3}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>Lo&&(lr=!0),this.height=t)}replace(t,e,i){return ae.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let o=this,l=i.doc;for(let h=n.length-1;h>=0;h--){let{fromA:f,toA:c,fromB:d,toB:g}=n[h],m=o.lineAt(f,Tt.ByPosNoHeight,i.setDoc(e),0,0),y=m.to>=c?m:o.lineAt(c,Tt.ByPosNoHeight,i,0,0);for(g+=y.to-c,c=y.to;h>0&&m.from<=n[h-1].toA;)f=n[h-1].fromA,d=n[h-1].fromB,h--,f<m.from&&(m=o.lineAt(f,Tt.ByPosNoHeight,i,0,0));d+=m.from-f,f=m.from;let b=Jh.build(i.setDoc(l),t,d,g);o=Qo(o,o.replace(f,c,b))}return o.updateHeight(i,0)}static empty(){return new Pe(0,0)}static of(t){if(t.length==1)return t[0];let e=0,i=t.length,n=0,o=0;for(;;)if(e==i)if(n>o*2){let h=t[e-1];h.break?t.splice(--e,1,h.left,null,h.right):t.splice(--e,1,h.left,h.right),i+=1+h.break,n-=h.size}else if(o>n*2){let h=t[i];h.break?t.splice(i,1,h.left,null,h.right):t.splice(i,1,h.left,h.right),i+=2+h.break,o-=h.size}else break;else if(n<o){let h=t[e++];h&&(n+=h.size)}else{let h=t[--i];h&&(o+=h.size)}let l=0;return t[e-1]==null?(l=1,e--):t[e]==null&&(l=1,i++),new Nk(ae.of(t.slice(0,e)),l,ae.of(t.slice(i)))}}function Qo(r,t){return r==t?r:(r.constructor!=t.constructor&&(lr=!0),t)}ae.prototype.size=1;class jg extends ae{constructor(t,e,i){super(t,e),this.deco=i}blockAt(t,e,i,n){return new mi(n,this.length,i,this.height,this.deco||0)}lineAt(t,e,i,n,o){return this.blockAt(0,i,n,o)}forEachLine(t,e,i,n,o,l){t<=o+this.length&&e>=o&&l(this.blockAt(0,i,n,o))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Pe extends jg{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,e,i,n){return new mi(n,this.length,i,this.height,this.breaks)}replace(t,e,i){let n=i[0];return i.length==1&&(n instanceof Pe||n instanceof Gt&&n.flags&4)&&Math.abs(this.length-n.length)<10?(n instanceof Gt?n=new Pe(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):ae.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(n.heights[n.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Gt extends ae{constructor(t){super(t,0)}heightMetrics(t,e){let i=t.doc.lineAt(e).number,n=t.doc.lineAt(e+this.length).number,o=n-i+1,l,h=0;if(t.lineWrapping){let f=Math.min(this.height,t.lineHeight*o);l=f/o,this.length>o+1&&(h=(this.height-f)/(this.length-o-1))}else l=this.height/o;return{firstLine:i,lastLine:n,perLine:l,perChar:h}}blockAt(t,e,i,n){let{firstLine:o,lastLine:l,perLine:h,perChar:f}=this.heightMetrics(e,n);if(e.lineWrapping){let c=n+(t<e.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-i)/this.height))*this.length)),d=e.doc.lineAt(c),g=h+d.length*f,m=Math.max(i,t-g/2);return new mi(d.from,d.length,m,g,0)}else{let c=Math.max(0,Math.min(l-o,Math.floor((t-i)/h))),{from:d,length:g}=e.doc.line(o+c);return new mi(d,g,i+h*c,h,0)}}lineAt(t,e,i,n,o){if(e==Tt.ByHeight)return this.blockAt(t,i,n,o);if(e==Tt.ByPosNoHeight){let{from:y,to:b}=i.doc.lineAt(t);return new mi(y,b-y,0,0,0)}let{firstLine:l,perLine:h,perChar:f}=this.heightMetrics(i,o),c=i.doc.lineAt(t),d=h+c.length*f,g=c.number-l,m=n+h*g+f*(c.from-o-g);return new mi(c.from,c.length,Math.max(n,Math.min(m,n+this.height-d)),d,0)}forEachLine(t,e,i,n,o,l){t=Math.max(t,o),e=Math.min(e,o+this.length);let{firstLine:h,perLine:f,perChar:c}=this.heightMetrics(i,o);for(let d=t,g=n;d<=e;){let m=i.doc.lineAt(d);if(d==t){let b=m.number-h;g+=f*b+c*(t-o-b)}let y=f+c*m.length;l(new mi(m.from,m.length,g,y,0)),g+=y,d=m.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let o=i[i.length-1];o instanceof Gt?i[i.length-1]=new Gt(o.length+n):i.push(null,new Gt(n-1))}if(t>0){let o=i[0];o instanceof Gt?i[0]=new Gt(t+o.length):i.unshift(new Gt(t-1),null)}return ae.of(i)}decomposeLeft(t,e){e.push(new Gt(t-1),null)}decomposeRight(t,e){e.push(null,new Gt(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let o=e+this.length;if(n&&n.from<=e+this.length&&n.more){let l=[],h=Math.max(e,n.from),f=-1;for(n.from>e&&l.push(new Gt(n.from-e-1).updateHeight(t,e));h<=o&&n.more;){let d=t.doc.lineAt(h).length;l.length&&l.push(null);let g=n.heights[n.index++];f==-1?f=g:Math.abs(g-f)>=Lo&&(f=-2);let m=new Pe(d,g);m.outdated=!1,l.push(m),h+=d+1}h<=o&&l.push(null,new Gt(o-h).updateHeight(t,h));let c=ae.of(l);return(f<0||Math.abs(c.height-this.height)>=Lo||Math.abs(f-this.heightMetrics(t,e).perLine)>=Lo)&&(lr=!0),Qo(this,c)}else(i||this.outdated)&&(this.setHeight(t.heightForGap(e,e+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Nk extends ae{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return this.flags&1}blockAt(t,e,i,n){let o=i+this.left.height;return t<o?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,o,n+this.left.length+this.break)}lineAt(t,e,i,n,o){let l=n+this.left.height,h=o+this.left.length+this.break,f=e==Tt.ByHeight?t<l:t<h,c=f?this.left.lineAt(t,e,i,n,o):this.right.lineAt(t,e,i,l,h);if(this.break||(f?c.to<h:c.from>h))return c;let d=e==Tt.ByPosNoHeight?Tt.ByPosNoHeight:Tt.ByPos;return f?c.join(this.right.lineAt(h,d,i,l,h)):this.left.lineAt(h,d,i,n,o).join(c)}forEachLine(t,e,i,n,o,l){let h=n+this.left.height,f=o+this.left.length+this.break;if(this.break)t<f&&this.left.forEachLine(t,e,i,n,o,l),e>=f&&this.right.forEachLine(t,e,i,h,f,l);else{let c=this.lineAt(f,Tt.ByPos,i,n,o);t<c.from&&this.left.forEachLine(t,c.from-1,i,n,o,l),c.to>=t&&c.from<=e&&l(c),e>c.to&&this.right.forEachLine(c.to+1,e,i,h,f,l)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let o=[];t>0&&this.decomposeLeft(t,o);let l=o.length;for(let h of i)o.push(h);if(t>0&&Hd(o,l-1),e<this.length){let h=o.length;this.decomposeRight(e,o),Hd(o,h)}return ae.of(o)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?ae.of(this.break?[t,null,e]:[t,e]):(this.left=Qo(this.left,t),this.right=Qo(this.right,e),this.setHeight(t.height+e.height),this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:o,right:l}=this,h=e+o.length+this.break,f=null;return n&&n.from<=e+o.length&&n.more?f=o=o.updateHeight(t,e,i,n):o.updateHeight(t,e,i),n&&n.from<=h+l.length&&n.more?f=l=l.updateHeight(t,h,i,n):l.updateHeight(t,h,i),f?this.balanced(o,l):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Hd(r,t){let e,i;r[t]==null&&(e=r[t-1])instanceof Gt&&(i=r[t+1])instanceof Gt&&r.splice(t-1,3,new Gt(e.length+1+i.length))}const $k=5;class Jh{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let i=Math.min(e,this.lineEnd),n=this.nodes[this.nodes.length-1];n instanceof Pe?n.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new Pe(i-this.pos,-1)),this.writtenTo=i,e>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0,o=i.widget?i.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let l=e-t;i.block?this.addBlock(new jg(l,n,i)):(l||o||n>=$k)&&this.addLineDeco(n,o,l)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new Pe(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new Gt(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof Pe)return t;let e=new Pe(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine();let e=t.deco;e&&e.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,e&&e.endSide>0&&(this.covering=t)}addLineDeco(t,e,i){let n=this.ensureLine();n.length+=i,n.collapsed+=i,n.widgetHeight=Math.max(n.widgetHeight,t),n.breaks+=e,this.writtenTo=this.pos=this.pos+i}finish(t){let e=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(e instanceof Pe)&&!this.isCovered?this.nodes.push(new Pe(0,-1)):(this.writtenTo<this.pos||e==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=t;for(let n of this.nodes)n instanceof Pe&&n.updateHeight(this.oracle,i),i+=n?n.length:1;return this.nodes}static build(t,e,i,n){let o=new Jh(i,t);return Ct.spans(e,i,n,o,0),o.finish(i)}}function Wk(r,t,e){let i=new Fk;return Ct.compare(r,t,e,i,0),i.changes}class Fk{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&Io(t,e,this.changes,5)}}function Hk(r,t){let e=r.getBoundingClientRect(),i=r.ownerDocument,n=i.defaultView||window,o=Math.max(0,e.left),l=Math.min(n.innerWidth,e.right),h=Math.max(0,e.top),f=Math.min(n.innerHeight,e.bottom);for(let c=r.parentNode;c&&c!=i.body;)if(c.nodeType==1){let d=c,g=window.getComputedStyle(d);if((d.scrollHeight>d.clientHeight||d.scrollWidth>d.clientWidth)&&g.overflow!="visible"){let m=d.getBoundingClientRect();o=Math.max(o,m.left),l=Math.min(l,m.right),h=Math.max(h,m.top),f=Math.min(c==r.parentNode?n.innerHeight:f,m.bottom)}c=g.position=="absolute"||g.position=="fixed"?d.offsetParent:d.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:o-e.left,right:Math.max(o,l)-e.left,top:h-(e.top+t),bottom:Math.max(h,f)-(e.top+t)}}function zk(r){let t=r.getBoundingClientRect(),e=r.ownerDocument.defaultView||window;return t.left<e.innerWidth&&t.right>0&&t.top<e.innerHeight&&t.bottom>0}function Vk(r,t){let e=r.getBoundingClientRect();return{left:0,right:e.right-e.left,top:t,bottom:e.bottom-(e.top+t)}}class $a{constructor(t,e,i,n){this.from=t,this.to=e,this.size=i,this.displaySize=n}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],o=e[i];if(n.from!=o.from||n.to!=o.to||n.size!=o.size)return!1}return!0}draw(t,e){return pt.replace({widget:new Qk(this.displaySize*(e?t.scaleY:t.scaleX),e)}).range(this.from,this.to)}}class Qk extends fs{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class zd{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Vd,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=$t.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(Kh).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new Bk(e),this.stateDeco=t.facet(ns).filter(i=>typeof i!="function"),this.heightMap=ae.empty().applyChanges(this.stateDeco,ct.empty,this.heightOracle.setDoc(t.doc),[new qe(0,0,0,t.doc.length)]);for(let i=0;i<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());i++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=pt.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some(({from:o,to:l})=>n>=o&&n<=l)){let{from:o,to:l}=this.lineBlockAt(n);t.push(new mo(o,l))}}return this.viewports=t.sort((i,n)=>i.from-n.from),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?Vd:new tf(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,t=>{this.viewportLines.push(zr(t,this.scaler))})}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(ns).filter(d=>typeof d!="function");let n=t.changedRanges,o=qe.extendWithRanges(n,Wk(i,this.stateDeco,t?t.changes:Vt.empty(this.state.doc.length))),l=this.heightMap.height,h=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);Fd(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),o),(this.heightMap.height!=l||lr)&&(t.flags|=2),h?(this.scrollAnchorPos=t.changes.mapPos(h.from,-1),this.scrollAnchorHeight=h.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let f=o.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<f.from||e.range.head>f.to)||!this.viewportIsAppropriate(f))&&(f=this.getViewport(0,e));let c=f.from!=this.viewport.from||f.to!=this.viewport.to;this.viewport=f,t.flags|=this.updateForViewport(),(c||!t.changes.empty||t.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(t.changes),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(XS)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,o=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?$t.RTL:$t.LTR;let l=this.heightOracle.mustRefreshForWrapping(o),h=e.getBoundingClientRect(),f=l||this.mustMeasureContent||this.contentDOMHeight!=h.height;this.contentDOMHeight=h.height,this.mustMeasureContent=!1;let c=0,d=0;if(h.width&&h.height){let{scaleX:D,scaleY:$}=ag(e,h);(D>.005&&Math.abs(this.scaleX-D)>.005||$>.005&&Math.abs(this.scaleY-$)>.005)&&(this.scaleX=D,this.scaleY=$,c|=16,l=f=!0)}let g=(parseInt(i.paddingTop)||0)*this.scaleY,m=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=g||this.paddingBottom!=m)&&(this.paddingTop=g,this.paddingBottom=m,c|=18),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(f=!0),this.editorWidth=t.scrollDOM.clientWidth,c|=16);let y=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=y&&(this.scrollAnchorHeight=-1,this.scrollTop=y),this.scrolledToBottom=ug(t.scrollDOM);let b=(this.printing?Vk:Hk)(e,this.paddingTop),S=b.top-this.pixelViewport.top,A=b.bottom-this.pixelViewport.bottom;this.pixelViewport=b;let P=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(P!=this.inView&&(this.inView=P,P&&(f=!0)),!this.inView&&!this.scrollTarget&&!zk(t.dom))return 0;let B=h.width;if((this.contentDOMWidth!=B||this.editorHeight!=t.scrollDOM.clientHeight)&&(this.contentDOMWidth=h.width,this.editorHeight=t.scrollDOM.clientHeight,c|=16),f){let D=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(D)&&(l=!0),l||n.lineWrapping&&Math.abs(B-this.contentDOMWidth)>n.charWidth){let{lineHeight:$,charWidth:W,textHeight:F}=t.docView.measureTextSize();l=$>0&&n.refresh(o,$,W,F,B/W,D),l&&(t.docView.minWidth=0,c|=16)}S>0&&A>0?d=Math.max(S,A):S<0&&A<0&&(d=Math.min(S,A)),Fd();for(let $ of this.viewports){let W=$.from==this.viewport.from?D:t.docView.measureVisibleLineHeights($);this.heightMap=(l?ae.empty().applyChanges(this.stateDeco,ct.empty,this.heightOracle,[new qe(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(n,0,l,new Lk($.from,W))}lr&&(c|=2)}let N=!this.viewportIsAppropriate(this.viewport,d)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return N&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(d,this.scrollTarget),c|=this.updateForViewport()),(c&2||N)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(l?[]:this.lineGaps,t)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,o=this.heightOracle,{visibleTop:l,visibleBottom:h}=this,f=new mo(n.lineAt(l-i*1e3,Tt.ByHeight,o,0,0).from,n.lineAt(h+(1-i)*1e3,Tt.ByHeight,o,0,0).to);if(e){let{head:c}=e.range;if(c<f.from||c>f.to){let d=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),g=n.lineAt(c,Tt.ByPos,o,0,0),m;e.y=="center"?m=(g.top+g.bottom)/2-d/2:e.y=="start"||e.y=="nearest"&&c<f.from?m=g.top:m=g.bottom-d,f=new mo(n.lineAt(m-1e3/2,Tt.ByHeight,o,0,0).from,n.lineAt(m+d+1e3/2,Tt.ByHeight,o,0,0).to)}}return f}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new mo(this.heightMap.lineAt(i,Tt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,Tt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,Tt.ByPos,this.heightOracle,0,0),{bottom:o}=this.heightMap.lineAt(e,Tt.ByPos,this.heightOracle,0,0),{visibleTop:l,visibleBottom:h}=this;return(t==0||n<=l-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||o>=h+Math.max(10,Math.min(i,250)))&&n>l-2*1e3&&o<h+2*1e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new $a(e.mapPos(n.from),e.mapPos(n.to),n.size,n.displaySize));return i}ensureLineGaps(t,e){let i=this.heightOracle.lineWrapping,n=i?1e4:2e3,o=n>>1,l=n<<1;if(this.defaultTextDirection!=$t.LTR&&!i)return[];let h=[],f=(d,g,m,y)=>{if(g-d<o)return;let b=this.state.selection.main,S=[b.from];b.empty||S.push(b.to);for(let P of S)if(P>d&&P<g){f(d,P-10,m,y),f(P+10,g,m,y);return}let A=qk(t,P=>P.from>=m.from&&P.to<=m.to&&Math.abs(P.from-d)<o&&Math.abs(P.to-g)<o&&!S.some(B=>P.from<B&&P.to>B));if(!A){if(g<m.to&&e&&i&&e.visibleRanges.some(N=>N.from<=g&&N.to>=g)){let N=e.moveToLineBoundary(V.cursor(g),!1,!0).head;N>d&&(g=N)}let P=this.gapSize(m,d,g,y),B=i||P<2e6?P:2e6;A=new $a(d,g,P,B)}h.push(A)},c=d=>{if(d.length<l||d.type!=Oi.Text)return;let g=Uk(d.from,d.to,this.stateDeco);if(g.total<l)return;let m=this.scrollTarget?this.scrollTarget.range.head:null,y,b;if(i){let S=n/this.heightOracle.lineLength*this.heightOracle.lineHeight,A,P;if(m!=null){let B=yo(g,m),N=((this.visibleBottom-this.visibleTop)/2+S)/d.height;A=B-N,P=B+N}else A=(this.visibleTop-d.top-S)/d.height,P=(this.visibleBottom-d.top+S)/d.height;y=wo(g,A),b=wo(g,P)}else{let S=g.total*this.heightOracle.charWidth,A=n*this.heightOracle.charWidth,P=0;if(S>2e6)for(let W of t)W.from>=d.from&&W.from<d.to&&W.size!=W.displaySize&&W.from*this.heightOracle.charWidth+P<this.pixelViewport.left&&(P=W.size-W.displaySize);let B=this.pixelViewport.left+P,N=this.pixelViewport.right+P,D,$;if(m!=null){let W=yo(g,m),F=((N-B)/2+A)/S;D=W-F,$=W+F}else D=(B-A)/S,$=(N+A)/S;y=wo(g,D),b=wo(g,$)}y>d.from&&f(d.from,y,d,g),b<d.to&&f(b,d.to,d,g)};for(let d of this.viewportLines)Array.isArray(d.type)?d.type.forEach(c):c(d);return h}gapSize(t,e,i,n){let o=yo(n,i)-yo(n,e);return this.heightOracle.lineWrapping?t.height*o:n.total*this.heightOracle.charWidth*o}updateLineGaps(t){$a.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=pt.set(t.map(e=>e.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(t){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let i=[];Ct.spans(e,this.viewport.from,this.viewport.to,{span(o,l){i.push({from:o,to:l})},point(){}},20);let n=0;if(i.length!=this.visibleRanges.length)n=12;else for(let o=0;o<i.length&&!(n&8);o++){let l=this.visibleRanges[o],h=i[o];(l.from!=h.from||l.to!=h.to)&&(n|=4,t&&t.mapPos(l.from,-1)==h.from&&t.mapPos(l.to,1)==h.to||(n|=8))}return this.visibleRanges=i,n}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(e=>e.from<=t&&e.to>=t)||zr(this.heightMap.lineAt(t,Tt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(e=>e.top<=t&&e.bottom>=t)||zr(this.heightMap.lineAt(this.scaler.fromDOM(t),Tt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let e=this.lineBlockAtHeight(t+8);return e.from>=this.viewport.from||this.viewportLines[0].top-t>200?e:this.viewportLines[0]}elementAtHeight(t){return zr(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class mo{constructor(t,e){this.from=t,this.to=e}}function Uk(r,t,e){let i=[],n=r,o=0;return Ct.spans(e,r,t,{span(){},point(l,h){l>n&&(i.push({from:n,to:l}),o+=l-n),n=h}},20),n<t&&(i.push({from:n,to:t}),o+=t-n),{total:o,ranges:i}}function wo({total:r,ranges:t},e){if(e<=0)return t[0].from;if(e>=1)return t[t.length-1].to;let i=Math.floor(r*e);for(let n=0;;n++){let{from:o,to:l}=t[n],h=l-o;if(i<=h)return o+i;i-=h}}function yo(r,t){let e=0;for(let{from:i,to:n}of r.ranges){if(t<=n){e+=t-i;break}e+=n-i}return e/r.total}function qk(r,t){for(let e of r)if(t(e))return e}const Vd={toDOM(r){return r},fromDOM(r){return r},scale:1,eq(r){return r==this}};class tf{constructor(t,e,i){let n=0,o=0,l=0;this.viewports=i.map(({from:h,to:f})=>{let c=e.lineAt(h,Tt.ByPos,t,0,0).top,d=e.lineAt(f,Tt.ByPos,t,0,0).bottom;return n+=d-c,{from:h,to:f,top:c,bottom:d,domTop:0,domBottom:0}}),this.scale=(7e6-n)/(e.height-n);for(let h of this.viewports)h.domTop=l+(h.top-o)*this.scale,l=h.domBottom=h.domTop+(h.bottom-h.top),o=h.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let o=e<this.viewports.length?this.viewports[e]:null;if(!o||t<o.top)return n+(t-i)*this.scale;if(t<=o.bottom)return o.domTop+(t-o.top);i=o.bottom,n=o.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let o=e<this.viewports.length?this.viewports[e]:null;if(!o||t<o.domTop)return i+(t-n)/this.scale;if(t<=o.domBottom)return o.top+(t-o.domTop);i=o.bottom,n=o.domBottom}}eq(t){return t instanceof tf?this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every((e,i)=>e.from==t.viewports[i].from&&e.to==t.viewports[i].to):!1}}function zr(r,t){if(t.scale==1)return r;let e=t.toDOM(r.top),i=t.toDOM(r.bottom);return new mi(r.from,r.length,e,i-e,Array.isArray(r._content)?r._content.map(n=>zr(n,t)):r._content)}const vo=X.define({combine:r=>r.join(" ")}),Ah=X.define({combine:r=>r.indexOf(!0)>-1}),Th=an.newName(),Jg=an.newName(),tm=an.newName(),em={"&light":"."+Jg,"&dark":"."+tm};function Ph(r,t,e){return new an(t,{finish(i){return/&/.test(i)?i.replace(/&\w*/,n=>{if(n=="&")return r;if(!e||!e[n])throw new RangeError(`Unsupported selector: ${n}`);return e[n]}):r+" "+i}})}const Xk=Ph("."+Th,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},em),Yk={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Wa=Q.ie&&Q.ie_version<=11;class Kk{constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new PS,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver(e=>{for(let i of e)this.queue.push(i);(Q.ie&&Q.ie_version<=11||Q.ios&&t.composing)&&e.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&t.constructor.EDIT_CONTEXT!==!1&&!(Q.chrome&&Q.chrome_version<126)&&(this.editContext=new Zk(t),t.state.facet(Wi)&&(t.contentDOM.editContext=this.editContext.editContext)),Wa&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var e;((e=this.view.docView)===null||e===void 0?void 0:e.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(e=>{e.length>0&&e[e.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(t){(t.type=="change"||!t.type)&&!t.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some((e,i)=>e!=t[i]))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,n=this.selectionRange;if(i.state.facet(Wi)?i.root.activeElement!=this.dom:!Do(this.dom,n))return;let o=n.anchorNode&&i.docView.nearest(n.anchorNode);if(o&&o.ignoreEvent(t)){e||(this.selectionChanged=!1);return}(Q.ie&&Q.ie_version<=11||Q.android&&Q.chrome)&&!i.state.selection.main.empty&&n.focusNode&&Xr(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=is(t.root);if(!e)return!1;let i=Q.safari&&t.root.nodeType==11&&t.root.activeElement==this.dom&&Gk(this.view,e)||e;if(!i||this.selectionRange.eq(i))return!1;let n=Do(this.dom,i);return n&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&RS(this.dom,i)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(i),n&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(i.nodeType==1)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=e)i.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Yk),Wa&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Wa&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var i;if(!this.delayedAndroidKey){let n=()=>{let o=this.delayedAndroidKey;o&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=o.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&o.force&&Gn(this.dom,o.key,o.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(n)}(!this.delayedAndroidKey||t=="Enter")&&(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let o of t){let l=this.readMutation(o);l&&(l.typeOver&&(n=!0),e==-1?{from:e,to:i}=l:(e=Math.min(l.from,e),i=Math.max(l.to,i)))}return{from:e,to:i,typeOver:n}}readChange(){let{from:t,to:e,typeOver:i}=this.processRecords(),n=this.selectionChanged&&Do(this.dom,this.selectionRange);if(t<0&&!n)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let o=new dk(this.view,t,e,i);return this.view.docView.domChanged={newSel:o.newSel?o.newSel.main:null},o}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return this.view.requestMeasure(),!1;let i=this.view.state,n=Vg(this.view,e);return this.view.state==i&&(e.domChanged||e.newSel&&!e.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),n}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty(t.type=="attributes"),t.type=="attributes"&&(e.flags|=4),t.type=="childList"){let i=Qd(e,t.previousSibling||t.target.previousSibling,-1),n=Qd(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}else return t.type=="characterData"?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(Wi)!=t.state.facet(Wi)&&(t.view.contentDOM.editContext=t.state.facet(Wi)?this.editContext.editContext:null))}destroy(){var t,e,i;this.stop(),(t=this.intersection)===null||t===void 0||t.disconnect(),(e=this.gapIntersection)===null||e===void 0||e.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function Qd(r,t,e){for(;t;){let i=xt.get(t);if(i&&i.parent==r)return i;let n=t.parentNode;t=n!=r.dom?n:e>0?t.nextSibling:t.previousSibling}return null}function Ud(r,t){let e=t.startContainer,i=t.startOffset,n=t.endContainer,o=t.endOffset,l=r.docView.domAtPos(r.state.selection.main.anchor);return Xr(l.node,l.offset,n,o)&&([e,i,n,o]=[n,o,e,i]),{anchorNode:e,anchorOffset:i,focusNode:n,focusOffset:o}}function Gk(r,t){if(t.getComposedRanges){let n=t.getComposedRanges(r.root)[0];if(n)return Ud(r,n)}let e=null;function i(n){n.preventDefault(),n.stopImmediatePropagation(),e=n.getTargetRanges()[0]}return r.contentDOM.addEventListener("beforeinput",i,!0),r.dom.ownerDocument.execCommand("indent"),r.contentDOM.removeEventListener("beforeinput",i,!0),e?Ud(r,e):null}class Zk{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(t.state);let e=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=i=>{let n=t.state.selection.main,{anchor:o,head:l}=n,h=this.toEditorPos(i.updateRangeStart),f=this.toEditorPos(i.updateRangeEnd);t.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:i.updateRangeStart,editorBase:h,drifted:!1});let c={from:h,to:f,insert:ct.of(i.text.split(`
`))};if(c.from==this.from&&o<this.from?c.from=o:c.to==this.to&&o>this.to&&(c.to=o),c.from==c.to&&!c.insert.length){let d=V.single(this.toEditorPos(i.selectionStart),this.toEditorPos(i.selectionEnd));d.main.eq(n)||t.dispatch({selection:d,userEvent:"select"});return}if((Q.mac||Q.android)&&c.from==l-1&&/^\. ?$/.test(i.text)&&t.contentDOM.getAttribute("autocorrect")=="off"&&(c={from:h,to:f,insert:ct.of([i.text.replace("."," ")])}),this.pendingContextChange=c,!t.state.readOnly){let d=this.to-this.from+(c.to-c.from+c.insert.length);jh(t,c,V.single(this.toEditorPos(i.selectionStart,d),this.toEditorPos(i.selectionEnd,d)))}this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state))},this.handlers.characterboundsupdate=i=>{let n=[],o=null;for(let l=this.toEditorPos(i.rangeStart),h=this.toEditorPos(i.rangeEnd);l<h;l++){let f=t.coordsForChar(l);o=f&&new DOMRect(f.left,f.top,f.right-f.left,f.bottom-f.top)||o||new DOMRect,n.push(o)}e.updateCharacterBounds(i.rangeStart,n)},this.handlers.textformatupdate=i=>{let n=[];for(let o of i.getTextFormats()){let l=o.underlineStyle,h=o.underlineThickness;if(l!="None"&&h!="None"){let f=this.toEditorPos(o.rangeStart),c=this.toEditorPos(o.rangeEnd);if(f<c){let d=`text-decoration: underline ${l=="Dashed"?"dashed ":l=="Squiggle"?"wavy ":""}${h=="Thin"?1:2}px`;n.push(pt.mark({attributes:{style:d}}).range(f,c))}}}t.dispatch({effects:Lg.of(pt.set(n))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(t.inputState.composing=-1,t.inputState.compositionFirstChange=null,this.composing){let{drifted:i}=this.composing;this.composing=null,i&&this.reset(t.state)}};for(let i in this.handlers)e.addEventListener(i,this.handlers[i]);this.measureReq={read:i=>{this.editContext.updateControlBounds(i.contentDOM.getBoundingClientRect());let n=is(i.root);n&&n.rangeCount&&this.editContext.updateSelectionBounds(n.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let e=0,i=!1,n=this.pendingContextChange;return t.changes.iterChanges((o,l,h,f,c)=>{if(i)return;let d=c.length-(l-o);if(n&&l>=n.to)if(n.from==o&&n.to==l&&n.insert.eq(c)){n=this.pendingContextChange=null,e+=d,this.to+=d;return}else n=null,this.revertPending(t.state);if(o+=e,l+=e,l<=this.from)this.from+=d,this.to+=d;else if(o<this.to){if(o<this.from||l>this.to||this.to-this.from+c.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(o),this.toContextPos(l),c.toString()),this.to+=d}e+=d}),n&&!i&&this.revertPending(t.state),!i}update(t){let e=this.pendingContextChange,i=t.startState.selection.main;this.composing&&(this.composing.drifted||!t.changes.touchesRange(i.from,i.to)&&t.transactions.some(n=>!n.isUserEvent("input.type")&&n.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=t.changes.mapPos(this.composing.editorBase)):!this.applyEdits(t)||!this.rangeIsValid(t.state)?(this.pendingContextChange=null,this.reset(t.state)):(t.docChanged||t.selectionSet||e)&&this.setSelection(t.state),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:e}=t.selection.main;this.from=Math.max(0,e-1e4),this.to=Math.min(t.doc.length,e+1e4)}reset(t){this.resetRange(t),this.editContext.updateText(0,this.editContext.text.length,t.doc.sliceString(this.from,this.to)),this.setSelection(t)}revertPending(t){let e=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(e.from),this.toContextPos(e.from+e.insert.length),t.doc.sliceString(e.from,e.to))}setSelection(t){let{main:e}=t.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,e.anchor))),n=this.toContextPos(e.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=n)&&this.editContext.updateSelection(i,n)}rangeIsValid(t){let{head:e}=t.selection.main;return!(this.from>0&&e-this.from<500||this.to<t.doc.length&&this.to-e<500||this.to-this.from>1e4*3)}toEditorPos(t,e=this.to-this.from){t=Math.min(t,e);let i=this.composing;return i&&i.drifted?i.editorBase+(t-i.contextBase):t+this.from}toContextPos(t){let e=this.composing;return e&&e.drifted?e.contextBase+(t-e.editorBase):t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class Z{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var e;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:i}=t;this.dispatchTransactions=t.dispatchTransactions||i&&(n=>n.forEach(o=>i(o,this)))||(n=>this.update(n)),this.dispatch=this.dispatch.bind(this),this._root=t.root||MS(t.parent)||document,this.viewState=new zd(t.state||mt.create(t)),t.scrollTo&&t.scrollTo.is(co)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Wr).map(n=>new Ba(n));for(let n of this.plugins)n.update(this);this.observer=new Kk(this),this.inputState=new yk(this),this.inputState.ensureHandlers(this.plugins),this.docView=new Sd(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((e=document.fonts)===null||e===void 0)&&e.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...t){let e=t.length==1&&t[0]instanceof Ut?t:t.length==1&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(e,this)}update(t){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e=!1,i=!1,n,o=this.state;for(let m of t){if(m.startState!=o)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");o=m.state}if(this.destroyed){this.viewState.state=o;return}let l=this.hasFocus,h=0,f=null;t.some(m=>m.annotation(Kg))?(this.inputState.notifiedFocused=l,h=1):l!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=l,f=Gg(o,l),f||(h=1));let c=this.observer.delayedAndroidKey,d=null;if(c?(this.observer.clearDelayedAndroidKey(),d=this.observer.readChange(),(d&&!this.state.doc.eq(o.doc)||!this.state.selection.eq(o.selection))&&(d=null)):this.observer.clear(),o.facet(mt.phrases)!=this.state.facet(mt.phrases))return this.setState(o);n=Vo.create(this,o,t),n.flags|=h;let g=this.viewState.scrollTarget;try{this.updateState=2;for(let m of t){if(g&&(g=g.map(m.changes)),m.scrollIntoView){let{main:y}=m.state.selection;g=new Zn(y.empty?y:V.cursor(y.head,y.head>y.anchor?-1:1))}for(let y of m.effects)y.is(co)&&(g=y.value.clip(this.state))}this.viewState.update(n,g),this.bidiCache=Uo.update(this.bidiCache,n.changes),n.empty||(this.updatePlugins(n),this.inputState.update(n)),e=this.docView.update(n),this.state.facet(Fr)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(e,t.some(m=>m.isUserEvent("select.pointer")))}finally{this.updateState=0}if(n.startState.facet(vo)!=n.state.facet(vo)&&(this.viewState.mustMeasureContent=!0),(e||i||g||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),e&&this.docViewUpdate(),!n.empty)for(let m of this.state.facet(Sh))try{m(n)}catch(y){le(this.state,y,"update listener")}(f||d)&&Promise.resolve().then(()=>{f&&this.state==f.startState&&this.dispatch(f),d&&!Vg(this,d)&&c.force&&Gn(this.contentDOM,c.key,c.keyCode)})}setState(t){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=t;return}this.updateState=2;let e=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new zd(t),this.plugins=t.facet(Wr).map(i=>new Ba(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new Sd(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(Wr),i=t.state.facet(Wr);if(e!=i){let n=[];for(let o of i){let l=e.indexOf(o);if(l<0)n.push(new Ba(o));else{let h=this.plugins[l];h.mustUpdate=t,n.push(h)}}for(let o of this.plugins)o.mustUpdate!=t&&o.destroy(this);this.plugins=n,this.pluginMap.clear()}else for(let n of this.plugins)n.mustUpdate=t;for(let n=0;n<this.plugins.length;n++)this.plugins[n].update(this);e!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let e=t.value;if(e&&e.docViewUpdate)try{e.docViewUpdate(this)}catch(i){le(this.state,i,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,i=this.scrollDOM,n=i.scrollTop*this.scaleY,{scrollAnchorPos:o,scrollAnchorHeight:l}=this.viewState;Math.abs(n-this.viewState.scrollTop)>1&&(l=-1),this.viewState.scrollAnchorHeight=-1;try{for(let h=0;;h++){if(l<0)if(ug(i))o=-1,l=this.viewState.heightMap.height;else{let y=this.viewState.scrollAnchorAt(n);o=y.from,l=y.top}this.updateState=1;let f=this.viewState.measure(this);if(!f&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(h>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];f&4||([this.measureRequests,c]=[c,this.measureRequests]);let d=c.map(y=>{try{return y.read(this)}catch(b){return le(this.state,b),qd}}),g=Vo.create(this,this.state,[]),m=!1;g.flags|=f,e?e.flags|=f:e=g,this.updateState=2,g.empty||(this.updatePlugins(g),this.inputState.update(g),this.updateAttrs(),m=this.docView.update(g),m&&this.docViewUpdate());for(let y=0;y<c.length;y++)if(d[y]!=qd)try{let b=c[y];b.write&&b.write(d[y],this)}catch(b){le(this.state,b)}if(m&&this.docView.updateSelection(!0),!g.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,l=-1;continue}else{let b=(o<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(o).top)-l;if(b>1||b<-1){n=n+b,i.scrollTop=n/this.scaleY,l=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let h of this.state.facet(Sh))h(e)}get themeClasses(){return Th+" "+(this.state.facet(Ah)?tm:Jg)+" "+this.state.facet(vo)}updateAttrs(){let t=Xd(this,Ng,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Wi)?"true":"false",class:"cm-content",style:`${Q.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),Xd(this,Kh,e);let i=this.observer.ignore(()=>{let n=yh(this.contentDOM,this.contentAttrs,e),o=yh(this.dom,this.editorAttrs,t);return n||o});return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let n of i.effects)if(n.is(Z.announce)){e&&(this.announceDOM.textContent=""),e=!1;let o=this.announceDOM.appendChild(document.createElement("div"));o.textContent=n.value}}mountStyles(){this.styleModules=this.state.facet(Fr);let t=this.state.facet(Z.cspNonce);an.mount(this.root,this.styleModules.concat(Xk).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t){if(this.measureRequests.indexOf(t)>-1)return;if(t.key!=null){for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key){this.measureRequests[e]=t;return}}this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(e===void 0||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find(i=>i.spec==t)||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return Na(this,t,Pd(this,t,e,i))}moveByGroup(t,e){return Na(this,t,Pd(this,t,e,i=>hk(this,t.head,i)))}visualLineSide(t,e){let i=this.bidiSpans(t),n=this.textDirectionAt(t.from),o=i[e?i.length-1:0];return V.cursor(o.side(e,n)+t.from,o.forward(!e,n)?1:-1)}moveToLineBoundary(t,e,i=!0){return ak(this,t,e,i)}moveVertically(t,e,i){return Na(this,t,fk(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),zg(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),o=this.bidiSpans(n),l=o[on.find(o,t-n.from,-1,e)];return hs(i,l.dir==$t.LTR==e>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(Ig)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>jk)return Ag(t.length);let e=this.textDirectionAt(t.from),i;for(let o of this.bidiCache)if(o.from==t.from&&o.dir==e&&(o.fresh||Cg(o.isolates,i=Od(this,t))))return o.order;i||(i=Od(this,t));let n=QS(t.text,e,i);return this.bidiCache.push(new Uo(t.from,t.to,e,i,!0,n)),n}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||Q.safari&&((t=this.inputState)===null||t===void 0?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{hg(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((t.nodeType==9?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return co.of(new Zn(typeof t=="number"?V.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:e}=this.scrollDOM,i=this.viewState.scrollAnchorAt(t);return co.of(new Zn(V.cursor(i.from),"start","start",i.top-t,e,!0))}setTabFocusMode(t){t==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof t=="boolean"?this.inputState.tabFocusMode=t?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return Me.define(()=>({}),{eventHandlers:t})}static domEventObservers(t){return Me.define(()=>({}),{eventObservers:t})}static theme(t,e){let i=an.newName(),n=[vo.of(i),Fr.of(Ph(`.${i}`,t))];return e&&e.dark&&n.push(Ah.of(!0)),n}static baseTheme(t){return as.lowest(Fr.of(Ph("."+Th,t,em)))}static findFromDOM(t){var e;let i=t.querySelector(".cm-content"),n=i&&xt.get(i)||xt.get(t);return((e=n?.rootView)===null||e===void 0?void 0:e.view)||null}}Z.styleModule=Fr;Z.inputHandler=Eg;Z.clipboardInputFilter=Xh;Z.clipboardOutputFilter=Yh;Z.scrollHandler=Bg;Z.focusChangeEffect=Dg;Z.perLineTextDirection=Ig;Z.exceptionSink=_g;Z.updateListener=Sh;Z.editable=Wi;Z.mouseSelectionStyle=Rg;Z.dragMovesSelection=Mg;Z.clickAddsSelectionRange=Pg;Z.decorations=ns;Z.outerDecorations=$g;Z.atomicRanges=Gh;Z.bidiIsolatedRanges=Wg;Z.scrollMargins=Fg;Z.darkTheme=Ah;Z.cspNonce=X.define({combine:r=>r.length?r[0]:""});Z.contentAttributes=Kh;Z.editorAttributes=Ng;Z.lineWrapping=Z.contentAttributes.of({class:"cm-lineWrapping"});Z.announce=ft.define();const jk=4096,qd={};class Uo{constructor(t,e,i,n,o,l){this.from=t,this.to=e,this.dir=i,this.isolates=n,this.fresh=o,this.order=l}static update(t,e){if(e.empty&&!t.some(o=>o.fresh))return t;let i=[],n=t.length?t[t.length-1].dir:$t.LTR;for(let o=Math.max(0,t.length-10);o<t.length;o++){let l=t[o];l.dir==n&&!e.touchesRange(l.from,l.to)&&i.push(new Uo(e.mapPos(l.from,1),e.mapPos(l.to,-1),l.dir,l.isolates,!1,l.order))}return i}}function Xd(r,t,e){for(let i=r.state.facet(t),n=i.length-1;n>=0;n--){let o=i[n],l=typeof o=="function"?o(r):o;l&&wh(l,e)}return e}const Jk=Q.mac?"mac":Q.windows?"win":Q.linux?"linux":"key";function tC(r,t){const e=r.split(/-(?!$)/);let i=e[e.length-1];i=="Space"&&(i=" ");let n,o,l,h;for(let f=0;f<e.length-1;++f){const c=e[f];if(/^(cmd|meta|m)$/i.test(c))h=!0;else if(/^a(lt)?$/i.test(c))n=!0;else if(/^(c|ctrl|control)$/i.test(c))o=!0;else if(/^s(hift)?$/i.test(c))l=!0;else if(/^mod$/i.test(c))t=="mac"?h=!0:o=!0;else throw new Error("Unrecognized modifier name: "+c)}return n&&(i="Alt-"+i),o&&(i="Ctrl-"+i),h&&(i="Meta-"+i),l&&(i="Shift-"+i),i}function xo(r,t,e){return t.altKey&&(r="Alt-"+r),t.ctrlKey&&(r="Ctrl-"+r),t.metaKey&&(r="Meta-"+r),e!==!1&&t.shiftKey&&(r="Shift-"+r),r}const eC=as.default(Z.domEventHandlers({keydown(r,t){return sC(iC(t.state),r,t,"editor")}})),ef=X.define({enables:eC}),Yd=new WeakMap;function iC(r){let t=r.facet(ef),e=Yd.get(t);return e||Yd.set(t,e=rC(t.reduce((i,n)=>i.concat(n),[]))),e}let en=null;const nC=4e3;function rC(r,t=Jk){let e=Object.create(null),i=Object.create(null),n=(l,h)=>{let f=i[l];if(f==null)i[l]=h;else if(f!=h)throw new Error("Key binding "+l+" is used both as a regular binding and as a multi-stroke prefix")},o=(l,h,f,c,d)=>{var g,m;let y=e[l]||(e[l]=Object.create(null)),b=h.split(/ (?!$)/).map(P=>tC(P,t));for(let P=1;P<b.length;P++){let B=b.slice(0,P).join(" ");n(B,!0),y[B]||(y[B]={preventDefault:!0,stopPropagation:!1,run:[N=>{let D=en={view:N,prefix:B,scope:l};return setTimeout(()=>{en==D&&(en=null)},nC),!0}]})}let S=b.join(" ");n(S,!1);let A=y[S]||(y[S]={preventDefault:!1,stopPropagation:!1,run:((m=(g=y._any)===null||g===void 0?void 0:g.run)===null||m===void 0?void 0:m.slice())||[]});f&&A.run.push(f),c&&(A.preventDefault=!0),d&&(A.stopPropagation=!0)};for(let l of r){let h=l.scope?l.scope.split(" "):["editor"];if(l.any)for(let c of h){let d=e[c]||(e[c]=Object.create(null));d._any||(d._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:g}=l;for(let m in d)d[m].run.push(y=>g(y,Mh))}let f=l[t]||l.key;if(f)for(let c of h)o(c,f,l.run,l.preventDefault,l.stopPropagation),l.shift&&o(c,"Shift-"+f,l.shift,l.preventDefault,l.stopPropagation)}return e}let Mh=null;function sC(r,t,e,i){Mh=t;let n=kS(t),o=Fe(n,0),l=$i(o)==n.length&&n!=" ",h="",f=!1,c=!1,d=!1;en&&en.view==e&&en.scope==i&&(h=en.prefix+" ",Ug.indexOf(t.keyCode)<0&&(c=!0,en=null));let g=new Set,m=A=>{if(A){for(let P of A.run)if(!g.has(P)&&(g.add(P),P(e)))return A.stopPropagation&&(d=!0),!0;A.preventDefault&&(A.stopPropagation&&(d=!0),c=!0)}return!1},y=r[i],b,S;return y&&(m(y[h+xo(n,t,!l)])?f=!0:l&&(t.altKey||t.metaKey||t.ctrlKey)&&!(Q.windows&&t.ctrlKey&&t.altKey)&&(b=hn[t.keyCode])&&b!=n?(m(y[h+xo(b,t,!0)])||t.shiftKey&&(S=es[t.keyCode])!=n&&S!=b&&m(y[h+xo(S,t,!1)]))&&(f=!0):l&&t.shiftKey&&m(y[h+xo(n,t,!0)])&&(f=!0),!f&&m(y._any)&&(f=!0)),c&&(f=!0),f&&d&&t.stopPropagation(),Mh=null,f}class oC extends fs{constructor(t){super(),this.content=t}toDOM(t){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(t):this.content.cloneNode(!0)),typeof this.content=="string"?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}coordsAt(t){let e=t.firstChild?rr(t.firstChild):[];if(!e.length)return null;let i=window.getComputedStyle(t.parentNode),n=hs(e[0],i.direction!="rtl"),o=parseInt(i.lineHeight);return n.bottom-n.top>o*1.5?{left:n.left,right:n.right,top:n.top,bottom:n.top+o}:n}ignoreEvent(){return!1}}function Kd(r){return Me.fromClass(class{constructor(t){this.view=t,this.placeholder=r?pt.set([pt.widget({widget:new oC(r),side:1}).range(0)]):pt.none}get decorations(){return this.view.state.doc.length?pt.none:this.placeholder}},{decorations:t=>t.decorations})}const Lr="-10000px";class im{constructor(t,e,i,n){this.facet=e,this.createTooltipView=i,this.removeTooltipView=n,this.input=t.state.facet(e),this.tooltips=this.input.filter(l=>l);let o=null;this.tooltipViews=this.tooltips.map(l=>o=i(l,o))}update(t,e){var i;let n=t.state.facet(this.facet),o=n.filter(f=>f);if(n===this.input){for(let f of this.tooltipViews)f.update&&f.update(t);return!1}let l=[],h=e?[]:null;for(let f=0;f<o.length;f++){let c=o[f],d=-1;if(c){for(let g=0;g<this.tooltips.length;g++){let m=this.tooltips[g];m&&m.create==c.create&&(d=g)}if(d<0)l[f]=this.createTooltipView(c,f?l[f-1]:null),h&&(h[f]=!!c.above);else{let g=l[f]=this.tooltipViews[d];h&&(h[f]=e[d]),g.update&&g.update(t)}}}for(let f of this.tooltipViews)l.indexOf(f)<0&&(this.removeTooltipView(f),(i=f.destroy)===null||i===void 0||i.call(f));return e&&(h.forEach((f,c)=>e[c]=f),e.length=h.length),this.input=n,this.tooltips=o,this.tooltipViews=l,!0}}function lC(r){let t=r.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:t.clientHeight,right:t.clientWidth}}const Fa=X.define({combine:r=>{var t,e,i;return{position:Q.ios?"absolute":((t=r.find(n=>n.position))===null||t===void 0?void 0:t.position)||"fixed",parent:((e=r.find(n=>n.parent))===null||e===void 0?void 0:e.parent)||null,tooltipSpace:((i=r.find(n=>n.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||lC}}}),Gd=new WeakMap,nf=Me.fromClass(class{constructor(r){this.view=r,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let t=r.state.facet(Fa);this.position=t.position,this.parent=t.parent,this.classes=r.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new im(r,rf,(e,i)=>this.createTooltip(e,i),e=>{this.resizeObserver&&this.resizeObserver.unobserve(e.dom),e.dom.remove()}),this.above=this.manager.tooltips.map(e=>!!e.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(e=>{Date.now()>this.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),r.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let r of this.manager.tooltipViews)this.intersectionObserver.observe(r.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(r){r.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(r,this.above);t&&this.observeIntersection();let e=t||r.geometryChanged,i=r.state.facet(Fa);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let n of this.manager.tooltipViews)n.dom.style.position=this.position;e=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let n of this.manager.tooltipViews)this.container.appendChild(n.dom);e=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);e&&this.maybeMeasure()}createTooltip(r,t){let e=r.create(this.view),i=t?t.dom:null;if(e.dom.classList.add("cm-tooltip"),r.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let n=document.createElement("div");n.className="cm-tooltip-arrow",e.dom.appendChild(n)}return e.dom.style.position=this.position,e.dom.style.top=Lr,e.dom.style.left="0px",this.container.insertBefore(e.dom,i),e.mount&&e.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(e.dom),e}destroy(){var r,t,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),(r=i.destroy)===null||r===void 0||r.call(i);this.parent&&this.container.remove(),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let r=1,t=1,e=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:o}=this.manager.tooltipViews[0];if(Q.gecko)e=o.offsetParent!=this.container.ownerDocument.body;else if(o.style.top==Lr&&o.style.left=="0px"){let l=o.getBoundingClientRect();e=Math.abs(l.top+1e4)>1||Math.abs(l.left)>1}}if(e||this.position=="absolute")if(this.parent){let o=this.parent.getBoundingClientRect();o.width&&o.height&&(r=o.width/this.parent.offsetWidth,t=o.height/this.parent.offsetHeight)}else({scaleX:r,scaleY:t}=this.view.viewState);let i=this.view.scrollDOM.getBoundingClientRect(),n=Zh(this.view);return{visible:{left:i.left+n.left,top:i.top+n.top,right:i.right-n.right,bottom:i.bottom-n.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((o,l)=>{let h=this.manager.tooltipViews[l];return h.getCoords?h.getCoords(o.pos):this.view.coordsAtPos(o.pos)}),size:this.manager.tooltipViews.map(({dom:o})=>o.getBoundingClientRect()),space:this.view.state.facet(Fa).tooltipSpace(this.view),scaleX:r,scaleY:t,makeAbsolute:e}}writeMeasure(r){var t;if(r.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let h of this.manager.tooltipViews)h.dom.style.position="absolute"}let{visible:e,space:i,scaleX:n,scaleY:o}=r,l=[];for(let h=0;h<this.manager.tooltips.length;h++){let f=this.manager.tooltips[h],c=this.manager.tooltipViews[h],{dom:d}=c,g=r.pos[h],m=r.size[h];if(!g||f.clip!==!1&&(g.bottom<=Math.max(e.top,i.top)||g.top>=Math.min(e.bottom,i.bottom)||g.right<Math.max(e.left,i.left)-.1||g.left>Math.min(e.right,i.right)+.1)){d.style.top=Lr;continue}let y=f.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,b=y?7:0,S=m.right-m.left,A=(t=Gd.get(c))!==null&&t!==void 0?t:m.bottom-m.top,P=c.offset||hC,B=this.view.textDirection==$t.LTR,N=m.width>i.right-i.left?B?i.left:i.right-m.width:B?Math.max(i.left,Math.min(g.left-(y?14:0)+P.x,i.right-S)):Math.min(Math.max(i.left,g.left-S+(y?14:0)-P.x),i.right-S),D=this.above[h];!f.strictSide&&(D?g.top-A-b-P.y<i.top:g.bottom+A+b+P.y>i.bottom)&&D==i.bottom-g.bottom>g.top-i.top&&(D=this.above[h]=!D);let $=(D?g.top-i.top:i.bottom-g.bottom)-b;if($<A&&c.resize!==!1){if($<this.view.defaultLineHeight){d.style.top=Lr;continue}Gd.set(c,A),d.style.height=(A=$)/o+"px"}else d.style.height&&(d.style.height="");let W=D?g.top-A-b-P.y:g.bottom+b+P.y,F=N+S;if(c.overlap!==!0)for(let et of l)et.left<F&&et.right>N&&et.top<W+A&&et.bottom>W&&(W=D?et.top-A-2-b:et.bottom+b+2);if(this.position=="absolute"?(d.style.top=(W-r.parent.top)/o+"px",Zd(d,(N-r.parent.left)/n)):(d.style.top=W/o+"px",Zd(d,N/n)),y){let et=g.left+(B?P.x:-P.x)-(N+14-7);y.style.left=et/n+"px"}c.overlap!==!0&&l.push({left:N,top:W,right:F,bottom:W+A}),d.classList.toggle("cm-tooltip-above",D),d.classList.toggle("cm-tooltip-below",!D),c.positioned&&c.positioned(r.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let r of this.manager.tooltipViews)r.dom.style.top=Lr}},{eventObservers:{scroll(){this.maybeMeasure()}}});function Zd(r,t){let e=parseInt(r.style.left,10);(isNaN(e)||Math.abs(t-e)>1)&&(r.style.left=t+"px")}const aC=Z.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),hC={x:0,y:0},rf=X.define({enables:[nf,aC]}),qo=X.define({combine:r=>r.reduce((t,e)=>t.concat(e),[])});class ll{static create(t){return new ll(t)}constructor(t){this.view=t,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new im(t,qo,(e,i)=>this.createHostedView(e,i),e=>e.dom.remove())}createHostedView(t,e){let i=t.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(i.dom,e?e.dom.nextSibling:this.dom.firstChild),this.mounted&&i.mount&&i.mount(this.view),i}mount(t){for(let e of this.manager.tooltipViews)e.mount&&e.mount(t);this.mounted=!0}positioned(t){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned(t)}update(t){this.manager.update(t)}destroy(){var t;for(let e of this.manager.tooltipViews)(t=e.destroy)===null||t===void 0||t.call(e)}passProp(t){let e;for(let i of this.manager.tooltipViews){let n=i[t];if(n!==void 0){if(e===void 0)e=n;else if(e!==n)return}}return e}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const fC=rf.compute([qo],r=>{let t=r.facet(qo);return t.length===0?null:{pos:Math.min(...t.map(e=>e.pos)),end:Math.max(...t.map(e=>{var i;return(i=e.end)!==null&&i!==void 0?i:e.pos})),create:ll.create,above:t[0].above,arrow:t.some(e=>e.arrow)}});class uC{constructor(t,e,i,n,o){this.view=t,this.source=e,this.field=i,this.setHover=n,this.hoverTime=o,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:t.dom,time:0},this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let t=Date.now()-this.lastMove.time;t<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-t):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:t,lastMove:e}=this,i=t.docView.nearest(e.target);if(!i)return;let n,o=1;if(i instanceof sn)n=i.posAtStart;else{if(n=t.posAtCoords(e),n==null)return;let h=t.coordsAtPos(n);if(!h||e.y<h.top||e.y>h.bottom||e.x<h.left-t.defaultCharacterWidth||e.x>h.right+t.defaultCharacterWidth)return;let f=t.bidiSpans(t.state.doc.lineAt(n)).find(d=>d.from<=n&&d.to>=n),c=f&&f.dir==$t.RTL?-1:1;o=e.x<h.left?-c:c}let l=this.source(t,n,o);if(l?.then){let h=this.pending={pos:n};l.then(f=>{this.pending==h&&(this.pending=null,f&&!(Array.isArray(f)&&!f.length)&&t.dispatch({effects:this.setHover.of(Array.isArray(f)?f:[f])}))},f=>le(t.state,f,"hover tooltip"))}else l&&!(Array.isArray(l)&&!l.length)&&t.dispatch({effects:this.setHover.of(Array.isArray(l)?l:[l])})}get tooltip(){let t=this.view.plugin(nf),e=t?t.manager.tooltips.findIndex(i=>i.create==ll.create):-1;return e>-1?t.manager.tooltipViews[e]:null}mousemove(t){var e,i;this.lastMove={x:t.clientX,y:t.clientY,target:t.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:n,tooltip:o}=this;if(n.length&&o&&!cC(o.dom,t)||this.pending){let{pos:l}=n[0]||this.pending,h=(i=(e=n[0])===null||e===void 0?void 0:e.end)!==null&&i!==void 0?i:l;(l==h?this.view.posAtCoords(this.lastMove)!=l:!dC(this.view,l,h,t.clientX,t.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(t){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:e}=this;if(e.length){let{tooltip:i}=this;i&&i.dom.contains(t.relatedTarget)?this.watchTooltipLeave(i.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(t){let e=i=>{t.removeEventListener("mouseleave",e),this.active.length&&!this.view.dom.contains(i.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};t.addEventListener("mouseleave",e)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const bo=4;function cC(r,t){let{left:e,right:i,top:n,bottom:o}=r.getBoundingClientRect(),l;if(l=r.querySelector(".cm-tooltip-arrow")){let h=l.getBoundingClientRect();n=Math.min(h.top,n),o=Math.max(h.bottom,o)}return t.clientX>=e-bo&&t.clientX<=i+bo&&t.clientY>=n-bo&&t.clientY<=o+bo}function dC(r,t,e,i,n,o){let l=r.scrollDOM.getBoundingClientRect(),h=r.documentTop+r.documentPadding.top+r.contentHeight;if(l.left>i||l.right<i||l.top>n||Math.min(l.bottom,h)<n)return!1;let f=r.posAtCoords({x:i,y:n},!1);return f>=t&&f<=e}function nm(r,t={}){let e=ft.define(),i=ve.define({create(){return[]},update(n,o){if(n.length&&(t.hideOnChange&&(o.docChanged||o.selection)?n=[]:t.hideOn&&(n=n.filter(l=>!t.hideOn(o,l))),o.docChanged)){let l=[];for(let h of n){let f=o.changes.mapPos(h.pos,-1,oe.TrackDel);if(f!=null){let c=Object.assign(Object.create(null),h);c.pos=f,c.end!=null&&(c.end=o.changes.mapPos(c.end)),l.push(c)}}n=l}for(let l of o.effects)l.is(e)&&(n=l.value),l.is(pC)&&(n=[]);return n},provide:n=>qo.from(n)});return{active:i,extension:[i,Me.define(n=>new uC(n,r,i,e,t.hoverTime||300)),fC]}}function rm(r,t){let e=r.plugin(nf);if(!e)return null;let i=e.manager.tooltips.indexOf(t);return i<0?null:e.manager.tooltipViews[i]}const pC=ft.define(),jd=X.define({combine(r){let t,e;for(let i of r)t=t||i.topContainer,e=e||i.bottomContainer;return{topContainer:t,bottomContainer:e}}}),gC=Me.fromClass(class{constructor(r){this.input=r.state.facet(Rh),this.specs=this.input.filter(e=>e),this.panels=this.specs.map(e=>e(r));let t=r.state.facet(jd);this.top=new Oo(r,!0,t.topContainer),this.bottom=new Oo(r,!1,t.bottomContainer),this.top.sync(this.panels.filter(e=>e.top)),this.bottom.sync(this.panels.filter(e=>!e.top));for(let e of this.panels)e.dom.classList.add("cm-panel"),e.mount&&e.mount()}update(r){let t=r.state.facet(jd);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new Oo(r.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new Oo(r.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let e=r.state.facet(Rh);if(e!=this.input){let i=e.filter(f=>f),n=[],o=[],l=[],h=[];for(let f of i){let c=this.specs.indexOf(f),d;c<0?(d=f(r.view),h.push(d)):(d=this.panels[c],d.update&&d.update(r)),n.push(d),(d.top?o:l).push(d)}this.specs=i,this.panels=n,this.top.sync(o),this.bottom.sync(l);for(let f of h)f.dom.classList.add("cm-panel"),f.mount&&f.mount()}else for(let i of this.panels)i.update&&i.update(r)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:r=>Z.scrollMargins.of(t=>{let e=t.plugin(r);return e&&{top:e.top.scrollMargin(),bottom:e.bottom.scrollMargin()}})});class Oo{constructor(t,e,i){this.view=t,this.top=e,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){for(let e of this.panels)e.destroy&&t.indexOf(e)<0&&e.destroy();this.panels=t,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let e=this.container||this.view.dom;e.insertBefore(this.dom,this.top?e.firstChild:null)}let t=this.dom.firstChild;for(let e of this.panels)if(e.dom.parentNode==this.dom){for(;t!=e.dom;)t=Jd(t);t=t.nextSibling}else this.dom.insertBefore(e.dom,t);for(;t;)t=Jd(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function Jd(r){let t=r.nextSibling;return r.remove(),t}const Rh=X.define({enables:gC});class ar extends Tn{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}ar.prototype.elementClass="";ar.prototype.toDOM=void 0;ar.prototype.mapMode=oe.TrackBefore;ar.prototype.startSide=ar.prototype.endSide=-1;ar.prototype.point=!0;let mC=0;class He{constructor(t,e,i,n){this.name=t,this.set=e,this.base=i,this.modified=n,this.id=mC++}toString(){let{name:t}=this;for(let e of this.modified)e.name&&(t=`${e.name}(${t})`);return t}static define(t,e){let i=typeof t=="string"?t:"?";if(t instanceof He&&(e=t),e?.base)throw new Error("Can not derive from a modified tag");let n=new He(i,[],null,[]);if(n.set.push(n),e)for(let o of e.set)n.set.push(o);return n}static defineModifier(t){let e=new Xo(t);return i=>i.modified.indexOf(e)>-1?i:Xo.get(i.base||i,i.modified.concat(e).sort((n,o)=>n.id-o.id))}}let wC=0;class Xo{constructor(t){this.name=t,this.instances=[],this.id=wC++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find(h=>h.base==t&&yC(e,h.modified));if(i)return i;let n=[],o=new He(t.name,n,t,e);for(let h of e)h.instances.push(o);let l=vC(e);for(let h of t.set)if(!h.modified.length)for(let f of l)n.push(Xo.get(h,f));return o}}function yC(r,t){return r.length==t.length&&r.every((e,i)=>e==t[i])}function vC(r){let t=[[]];for(let e=0;e<r.length;e++)for(let i=0,n=t.length;i<n;i++)t.push(t[i].concat(r[e]));return t.sort((e,i)=>i.length-e.length)}function sf(r){let t=Object.create(null);for(let e in r){let i=r[e];Array.isArray(i)||(i=[i]);for(let n of e.split(" "))if(n){let o=[],l=2,h=n;for(let g=0;;){if(h=="..."&&g>0&&g+3==n.length){l=1;break}let m=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(h);if(!m)throw new RangeError("Invalid path: "+n);if(o.push(m[0]=="*"?"":m[0][0]=='"'?JSON.parse(m[0]):m[0]),g+=m[0].length,g==n.length)break;let y=n[g++];if(g==n.length&&y=="!"){l=0;break}if(y!="/")throw new RangeError("Invalid path: "+n);h=n.slice(g)}let f=o.length-1,c=o[f];if(!c)throw new RangeError("Invalid path: "+n);let d=new Yo(i,l,f>0?o.slice(0,f):null);t[c]=d.sort(t[c])}}return sm.add(t)}const sm=new ot;class Yo{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}Yo.empty=new Yo([],2,null);function om(r,t){let e=Object.create(null);for(let o of r)if(!Array.isArray(o.tag))e[o.tag.id]=o.class;else for(let l of o.tag)e[l.id]=o.class;let{scope:i,all:n=null}=t||{};return{style:o=>{let l=n;for(let h of o)for(let f of h.set){let c=e[f.id];if(c){l=l?l+" "+c:c;break}}return l},scope:i}}function xC(r,t){let e=null;for(let i of r){let n=i.style(t);n&&(e=e?e+" "+n:n)}return e}function lm(r,t,e,i=0,n=r.length){let o=new bC(i,Array.isArray(t)?t:[t],e);o.highlightRange(r.cursor(),i,n,"",o.highlighters),o.flush(n)}function JT(r,t,e,i,n,o=0,l=r.length){let h=o;function f(c,d){if(!(c<=h)){for(let g=r.slice(h,c),m=0;;){let y=g.indexOf(`
`,m),b=y<0?g.length:y;if(b>m&&i(g.slice(m,b),d),y<0)break;n(),m=y+1}h=c}}lm(t,e,(c,d,g)=>{f(c,""),f(d,g)},o,l),f(l,"")}class bC{constructor(t,e,i){this.at=t,this.highlighters=e,this.span=i,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,i,n,o){let{type:l,from:h,to:f}=t;if(h>=i||f<=e)return;l.isTop&&(o=this.highlighters.filter(y=>!y.scope||y.scope(l)));let c=n,d=OC(t)||Yo.empty,g=xC(o,d.tags);if(g&&(c&&(c+=" "),c+=g,d.mode==1&&(n+=(n?" ":"")+g)),this.startSpan(Math.max(e,h),c),d.opaque)return;let m=t.tree&&t.tree.prop(ot.mounted);if(m&&m.overlay){let y=t.node.enter(m.overlay[0].from+h,1),b=this.highlighters.filter(A=>!A.scope||A.scope(m.tree.type)),S=t.firstChild();for(let A=0,P=h;;A++){let B=A<m.overlay.length?m.overlay[A]:null,N=B?B.from+h:f,D=Math.max(e,P),$=Math.min(i,N);if(D<$&&S)for(;t.from<$&&(this.highlightRange(t,D,$,n,o),this.startSpan(Math.min($,t.to),c),!(t.to>=N||!t.nextSibling())););if(!B||N>i)break;P=B.to+h,P>e&&(this.highlightRange(y.cursor(),Math.max(e,B.from+h),Math.min(i,P),"",b),this.startSpan(Math.min(i,P),c))}S&&t.parent()}else if(t.firstChild()){m&&(n="");do if(!(t.to<=e)){if(t.from>=i)break;this.highlightRange(t,e,i,n,o),this.startSpan(Math.min(i,t.to),c)}while(t.nextSibling());t.parent()}}}function OC(r){let t=r.type.prop(sm);for(;t&&t.context&&!r.matchContext(t.context);)t=t.next;return t||null}const H=He.define,So=H(),Ji=H(),tp=H(Ji),ep=H(Ji),tn=H(),ko=H(tn),Ha=H(tn),di=H(),bn=H(di),ui=H(),ci=H(),_h=H(),Nr=H(_h),Co=H(),I={comment:So,lineComment:H(So),blockComment:H(So),docComment:H(So),name:Ji,variableName:H(Ji),typeName:tp,tagName:H(tp),propertyName:ep,attributeName:H(ep),className:H(Ji),labelName:H(Ji),namespace:H(Ji),macroName:H(Ji),literal:tn,string:ko,docString:H(ko),character:H(ko),attributeValue:H(ko),number:Ha,integer:H(Ha),float:H(Ha),bool:H(tn),regexp:H(tn),escape:H(tn),color:H(tn),url:H(tn),keyword:ui,self:H(ui),null:H(ui),atom:H(ui),unit:H(ui),modifier:H(ui),operatorKeyword:H(ui),controlKeyword:H(ui),definitionKeyword:H(ui),moduleKeyword:H(ui),operator:ci,derefOperator:H(ci),arithmeticOperator:H(ci),logicOperator:H(ci),bitwiseOperator:H(ci),compareOperator:H(ci),updateOperator:H(ci),definitionOperator:H(ci),typeOperator:H(ci),controlOperator:H(ci),punctuation:_h,separator:H(_h),bracket:Nr,angleBracket:H(Nr),squareBracket:H(Nr),paren:H(Nr),brace:H(Nr),content:di,heading:bn,heading1:H(bn),heading2:H(bn),heading3:H(bn),heading4:H(bn),heading5:H(bn),heading6:H(bn),contentSeparator:H(di),list:H(di),quote:H(di),emphasis:H(di),strong:H(di),link:H(di),monospace:H(di),strikethrough:H(di),inserted:H(),deleted:H(),changed:H(),invalid:H(),meta:Co,documentMeta:H(Co),annotation:H(Co),processingInstruction:H(Co),definition:He.defineModifier("definition"),constant:He.defineModifier("constant"),function:He.defineModifier("function"),standard:He.defineModifier("standard"),local:He.defineModifier("local"),special:He.defineModifier("special")};for(let r in I){let t=I[r];t instanceof He&&(t.name=r)}om([{tag:I.link,class:"tok-link"},{tag:I.heading,class:"tok-heading"},{tag:I.emphasis,class:"tok-emphasis"},{tag:I.strong,class:"tok-strong"},{tag:I.keyword,class:"tok-keyword"},{tag:I.atom,class:"tok-atom"},{tag:I.bool,class:"tok-bool"},{tag:I.url,class:"tok-url"},{tag:I.labelName,class:"tok-labelName"},{tag:I.inserted,class:"tok-inserted"},{tag:I.deleted,class:"tok-deleted"},{tag:I.literal,class:"tok-literal"},{tag:I.string,class:"tok-string"},{tag:I.number,class:"tok-number"},{tag:[I.regexp,I.escape,I.special(I.string)],class:"tok-string2"},{tag:I.variableName,class:"tok-variableName"},{tag:I.local(I.variableName),class:"tok-variableName tok-local"},{tag:I.definition(I.variableName),class:"tok-variableName tok-definition"},{tag:I.special(I.variableName),class:"tok-variableName2"},{tag:I.definition(I.propertyName),class:"tok-propertyName tok-definition"},{tag:I.typeName,class:"tok-typeName"},{tag:I.namespace,class:"tok-namespace"},{tag:I.className,class:"tok-className"},{tag:I.macroName,class:"tok-macroName"},{tag:I.propertyName,class:"tok-propertyName"},{tag:I.operator,class:"tok-operator"},{tag:I.comment,class:"tok-comment"},{tag:I.meta,class:"tok-meta"},{tag:I.invalid,class:"tok-invalid"},{tag:I.punctuation,class:"tok-punctuation"}]);var za;const Xn=new ot;function SC(r){return X.define({combine:r?t=>t.concat(r):void 0})}const kC=new ot;class ei{constructor(t,e,i=[],n=""){this.data=t,this.name=n,mt.prototype.hasOwnProperty("tree")||Object.defineProperty(mt.prototype,"tree",{get(){return Re(this)}}),this.parser=e,this.extension=[fr.of(this),mt.languageData.of((o,l,h)=>{let f=ip(o,l,h),c=f.type.prop(Xn);if(!c)return[];let d=o.facet(c),g=f.type.prop(kC);if(g){let m=f.resolve(l-f.from,h);for(let y of g)if(y.test(m,o)){let b=o.facet(y.facet);return y.type=="replace"?b:b.concat(d)}}return d})].concat(i)}isActiveAt(t,e,i=-1){return ip(t,e,i).type.prop(Xn)==this.data}findRegions(t){let e=t.facet(fr);if(e?.data==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let i=[],n=(o,l)=>{if(o.prop(Xn)==this.data){i.push({from:l,to:l+o.length});return}let h=o.prop(ot.mounted);if(h){if(h.tree.prop(Xn)==this.data){if(h.overlay)for(let f of h.overlay)i.push({from:f.from+l,to:f.to+l});else i.push({from:l,to:l+o.length});return}else if(h.overlay){let f=i.length;if(n(h.tree,h.overlay[0].from+l),i.length>f)return}}for(let f=0;f<o.children.length;f++){let c=o.children[f];c instanceof _t&&n(c,o.positions[f]+l)}};return n(Re(t),0),i}get allowsNesting(){return!0}}ei.setState=ft.define();function ip(r,t,e){let i=r.facet(fr),n=Re(r).topNode;if(!i||i.allowsNesting)for(let o=n;o;o=o.enter(t,e,Mt.ExcludeBuffers))o.type.isTop&&(n=o);return n}class rs extends ei{constructor(t,e,i){super(t,e,[],i),this.parser=e}static define(t){let e=SC(t.languageData);return new rs(e,t.parser.configure({props:[Xn.add(i=>i.isTop?e:void 0)]}),t.name)}configure(t,e){return new rs(this.data,this.parser.configure(t),e||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Re(r){let t=r.field(ei.state,!1);return t?t.tree:_t.empty}class CC{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let i=this.cursorPos-this.string.length;return t<i||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-i,e-i)}}let $r=null;class Ko{constructor(t,e,i=[],n,o,l,h,f){this.parser=t,this.state=e,this.fragments=i,this.tree=n,this.treeLen=o,this.viewport=l,this.skipped=h,this.scheduleOn=f,this.parse=null,this.tempSkipped=[]}static create(t,e,i){return new Ko(t,e,[],_t.empty,0,i,[],null)}startParse(){return this.parser.startParse(new CC(this.state.doc),this.fragments)}work(t,e){return e!=null&&e>=this.state.doc.length&&(e=void 0),this.tree!=_t.empty&&this.isDone(e??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof t=="number"){let n=Date.now()+t;t=()=>Date.now()>n}for(this.parse||(this.parse=this.startParse()),e!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let n=this.parse.advance();if(n)if(this.fragments=this.withoutTempSkipped(Fi.addTree(n,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=n,this.parse=null,this.treeLen<(e??this.state.doc.length))this.parse=this.startParse();else return!0;if(t())return!1}})}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(e=this.parse.advance()););}),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(Fi.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=$r;$r=this;try{return t()}finally{$r=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=np(t,e.from,e.to);return t}changes(t,e){let{fragments:i,tree:n,treeLen:o,viewport:l,skipped:h}=this;if(this.takeTree(),!t.empty){let f=[];if(t.iterChangedRanges((c,d,g,m)=>f.push({fromA:c,toA:d,fromB:g,toB:m})),i=Fi.applyChanges(i,f),n=_t.empty,o=0,l={from:t.mapPos(l.from,-1),to:t.mapPos(l.to,1)},this.skipped.length){h=[];for(let c of this.skipped){let d=t.mapPos(c.from,1),g=t.mapPos(c.to,-1);d<g&&h.push({from:d,to:g})}}}return new Ko(this.parser,e,i,n,o,l,h,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:n,to:o}=this.skipped[i];n<t.to&&o>t.from&&(this.fragments=np(this.fragments,n,o),this.skipped.splice(i--,1))}return this.skipped.length>=e?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends Hp{createParse(e,i,n){let o=n[0].from,l=n[n.length-1].to;return{parsedPos:o,advance(){let f=$r;if(f){for(let c of n)f.tempSkipped.push(c);t&&(f.scheduleOn=f.scheduleOn?Promise.all([f.scheduleOn,t]):t)}return this.parsedPos=l,new _t(he.none,[],[],l-o)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&e[0].from==0&&e[0].to>=t}static get(){return $r}}function np(r,t,e){return Fi.applyChanges(r,[{fromA:t,toA:e,fromB:t,toB:e}])}class hr{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),i=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,i)||e.takeTree(),new hr(e)}static init(t){let e=Math.min(3e3,t.doc.length),i=Ko.create(t.facet(fr).parser,t,{from:0,to:e});return i.work(20,e)||i.takeTree(),new hr(i)}}ei.state=ve.define({create:hr.init,update(r,t){for(let e of t.effects)if(e.is(ei.setState))return e.value;return t.startState.facet(fr)!=t.state.facet(fr)?hr.init(t.state):r.apply(t)}});let am=r=>{let t=setTimeout(()=>r(),500);return()=>clearTimeout(t)};typeof requestIdleCallback<"u"&&(am=r=>{let t=-1,e=setTimeout(()=>{t=requestIdleCallback(r,{timeout:400})},100);return()=>t<0?clearTimeout(e):cancelIdleCallback(t)});const Va=typeof navigator<"u"&&(!((za=navigator.scheduling)===null||za===void 0)&&za.isInputPending)?()=>navigator.scheduling.isInputPending():null,AC=Me.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(ei.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),(t.docChanged||t.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(ei.state);(e.tree!=e.context.tree||!e.context.isDone(t.doc.length))&&(this.working=am(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,o=i.field(ei.state);if(o.tree==o.context.tree&&o.context.isDone(n+1e5))return;let l=Date.now()+Math.min(this.chunkBudget,100,t&&!Va?Math.max(25,t.timeRemaining()-5):1e9),h=o.context.treeLen<n&&i.doc.length>n+1e3,f=o.context.work(()=>Va&&Va()||Date.now()>l,n+(h?0:1e5));this.chunkBudget-=Date.now()-e,(f||this.chunkBudget<=0)&&(o.context.takeTree(),this.view.dispatch({effects:ei.setState.of(new hr(o.context))})),this.chunkBudget>0&&!(f&&!h)&&this.scheduleWork(),this.checkAsyncSchedule(o.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then(()=>this.scheduleWork()).catch(e=>le(this.view.state,e)).then(()=>this.workScheduled--),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),fr=X.define({combine(r){return r.length?r[0]:null},enables:r=>[ei.state,AC,Z.contentAttributes.compute([r],t=>{let e=t.facet(r);return e&&e.name?{"data-language":e.name}:{}})]});class hm{constructor(t,e=[]){this.language=t,this.support=e,this.extension=[t,e]}}const TC=X.define(),fm=X.define({combine:r=>{if(!r.length)return"  ";let t=r[0];if(!t||/\S/.test(t)||Array.from(t).some(e=>e!=t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(r[0]));return t}});function PC(r){let t=r.facet(fm);return t.charCodeAt(0)==9?r.tabSize*t.length:t.length}function rp(r,t){let e="",i=r.tabSize,n=r.facet(fm)[0];if(n=="	"){for(;t>=i;)e+="	",t-=i;n=" "}for(let o=0;o<t;o++)e+=n;return e}function MC(r,t){r instanceof mt&&(r=new of(r));for(let i of r.state.facet(TC)){let n=i(r,t);if(n!==void 0)return n}let e=Re(r.state);return e.length>=t?_C(r,e,t):null}class of{constructor(t,e={}){this.state=t,this.options=e,this.unit=PC(t)}lineAt(t,e=1){let i=this.state.doc.lineAt(t),{simulateBreak:n,simulateDoubleBreak:o}=this.options;return n!=null&&n>=i.from&&n<=i.to?o&&n==t?{text:"",from:t}:(e<0?n<t:n<=t)?{text:i.text.slice(n-i.from),from:n}:{text:i.text.slice(0,n-i.from),from:i.from}:i}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:i,from:n}=this.lineAt(t,e);return i.slice(t-n,Math.min(i.length,t+100-n))}column(t,e=1){let{text:i,from:n}=this.lineAt(t,e),o=this.countColumn(i,t-n),l=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return l>-1&&(o+=l-this.countColumn(i,i.search(/\S|$/))),o}countColumn(t,e=t.length){return lg(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:i,from:n}=this.lineAt(t,e),o=this.options.overrideIndentation;if(o){let l=o(n);if(l>-1)return l}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const RC=new ot;function _C(r,t,e){let i=t.resolveStack(e),n=t.resolveInner(e,-1).resolve(e,0).enterUnfinishedNodesBefore(e);if(n!=i.node){let o=[];for(let l=n;l&&!(l.from==i.node.from&&l.type==i.node.type);l=l.parent)o.push(l);for(let l=o.length-1;l>=0;l--)i={node:o[l],next:i}}return um(i,r,e)}function um(r,t,e){for(let i=r;i;i=i.next){let n=DC(i.node);if(n)return n(lf.create(t,e,i))}return 0}function EC(r){return r.pos==r.options.simulateBreak&&r.options.simulateDoubleBreak}function DC(r){let t=r.type.prop(RC);if(t)return t;let e=r.firstChild,i;if(e&&(i=e.type.prop(ot.closedBy))){let n=r.lastChild,o=n&&i.indexOf(n.name)>-1;return l=>NC(l,!0,1,void 0,o&&!EC(l)?n.from:void 0)}return r.parent==null?IC:null}function IC(){return 0}class lf extends of{constructor(t,e,i){super(t.state,t.options),this.base=t,this.pos=e,this.context=i}get node(){return this.context.node}static create(t,e,i){return new lf(t,e,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(t){let e=this.state.doc.lineAt(t.from);for(;;){let i=t.resolve(e.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if(BC(i,t))break;e=this.state.doc.lineAt(i.from)}return this.lineIndent(e.from)}continue(){return um(this.context.next,this.base,this.pos)}}function BC(r,t){for(let e=t;e;e=e.parent)if(r==e)return!0;return!1}function LC(r){let t=r.node,e=t.childAfter(t.from),i=t.lastChild;if(!e)return null;let n=r.options.simulateBreak,o=r.state.doc.lineAt(e.from),l=n==null||n<=o.from?o.to:Math.min(o.to,n);for(let h=e.to;;){let f=t.childAfter(h);if(!f||f==i)return null;if(!f.type.isSkipped){if(f.from>=l)return null;let c=/^ */.exec(o.text.slice(e.to-o.from))[0].length;return{from:e.from,to:e.to+c}}h=f.to}}function NC(r,t,e,i,n){let o=r.textAfter,l=o.match(/^\s*/)[0].length,h=i&&o.slice(l,l+i.length)==i||n==r.pos+l,f=LC(r);return f?h?r.column(f.from):r.column(f.to):r.baseIndent+(h?0:r.unit*e)}class ds{constructor(t,e){this.specs=t;let i;function n(h){let f=an.newName();return(i||(i=Object.create(null)))["."+f]=h,f}const o=typeof e.all=="string"?e.all:e.all?n(e.all):void 0,l=e.scope;this.scope=l instanceof ei?h=>h.prop(Xn)==l.data:l?h=>h==l:void 0,this.style=om(t.map(h=>({tag:h.tag,class:h.class||n(Object.assign({},h,{tag:null}))})),{all:o}).style,this.module=i?new an(i):null,this.themeType=e.themeType}static define(t,e){return new ds(t,e||{})}}const Eh=X.define(),$C=X.define({combine(r){return r.length?[r[0]]:null}});function Qa(r){let t=r.facet(Eh);return t.length?t:r.facet($C)}function cm(r,t){let e=[FC],i;return r instanceof ds&&(r.module&&e.push(Z.styleModule.of(r.module)),i=r.themeType),i?e.push(Eh.computeN([Z.darkTheme],n=>n.facet(Z.darkTheme)==(i=="dark")?[r]:[])):e.push(Eh.of(r)),e}class WC{constructor(t){this.markCache=Object.create(null),this.tree=Re(t.state),this.decorations=this.buildDeco(t,Qa(t.state)),this.decoratedTo=t.viewport.to}update(t){let e=Re(t.state),i=Qa(t.state),n=i!=Qa(t.startState),{viewport:o}=t.view,l=t.changes.mapPos(this.decoratedTo,1);e.length<o.to&&!n&&e.type==this.tree.type&&l>=o.to?(this.decorations=this.decorations.map(t.changes),this.decoratedTo=l):(e!=this.tree||t.viewportChanged||n)&&(this.tree=e,this.decorations=this.buildDeco(t.view,i),this.decoratedTo=o.to)}buildDeco(t,e){if(!e||!this.tree.length)return pt.none;let i=new nr;for(let{from:n,to:o}of t.visibleRanges)lm(this.tree,e,(l,h,f)=>{i.add(l,h,this.markCache[f]||(this.markCache[f]=pt.mark({class:f})))},n,o);return i.finish()}}const FC=as.high(Me.fromClass(WC,{decorations:r=>r.decorations})),HC=Z.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),dm=1e4,pm="()[]{}",gm=X.define({combine(r){return rl(r,{afterCursor:!0,brackets:pm,maxScanDistance:dm,renderMatch:QC})}}),zC=pt.mark({class:"cm-matchingBracket"}),VC=pt.mark({class:"cm-nonmatchingBracket"});function QC(r){let t=[],e=r.matched?zC:VC;return t.push(e.range(r.start.from,r.start.to)),r.end&&t.push(e.range(r.end.from,r.end.to)),t}const UC=ve.define({create(){return pt.none},update(r,t){if(!t.docChanged&&!t.selection)return r;let e=[],i=t.state.facet(gm);for(let n of t.state.selection.ranges){if(!n.empty)continue;let o=Ao(t.state,n.head,-1,i)||n.head>0&&Ao(t.state,n.head-1,1,i)||i.afterCursor&&(Ao(t.state,n.head,1,i)||n.head<t.state.doc.length&&Ao(t.state,n.head+1,-1,i));o&&(e=e.concat(i.renderMatch(o,t.state)))}return pt.set(e,!0)},provide:r=>Z.decorations.from(r)}),qC=[UC,HC];function XC(r={}){return[gm.of(r),qC]}const YC=new ot;function Dh(r,t,e){let i=r.prop(t<0?ot.openedBy:ot.closedBy);if(i)return i;if(r.name.length==1){let n=e.indexOf(r.name);if(n>-1&&n%2==(t<0?1:0))return[e[n+t]]}return null}function Ih(r){let t=r.type.prop(YC);return t?t(r.node):r}function Ao(r,t,e,i={}){let n=i.maxScanDistance||dm,o=i.brackets||pm,l=Re(r),h=l.resolveInner(t,e);for(let f=h;f;f=f.parent){let c=Dh(f.type,e,o);if(c&&f.from<f.to){let d=Ih(f);if(d&&(e>0?t>=d.from&&t<d.to:t>d.from&&t<=d.to))return KC(r,t,e,f,d,c,o)}}return GC(r,t,e,l,h.type,n,o)}function KC(r,t,e,i,n,o,l){let h=i.parent,f={from:n.from,to:n.to},c=0,d=h?.cursor();if(d&&(e<0?d.childBefore(i.from):d.childAfter(i.to)))do if(e<0?d.to<=i.from:d.from>=i.to){if(c==0&&o.indexOf(d.type.name)>-1&&d.from<d.to){let g=Ih(d);return{start:f,end:g?{from:g.from,to:g.to}:void 0,matched:!0}}else if(Dh(d.type,e,l))c++;else if(Dh(d.type,-e,l)){if(c==0){let g=Ih(d);return{start:f,end:g&&g.from<g.to?{from:g.from,to:g.to}:void 0,matched:!1}}c--}}while(e<0?d.prevSibling():d.nextSibling());return{start:f,matched:!1}}function GC(r,t,e,i,n,o,l){let h=e<0?r.sliceDoc(t-1,t):r.sliceDoc(t,t+1),f=l.indexOf(h);if(f<0||f%2==0!=e>0)return null;let c={from:e<0?t-1:t,to:e>0?t+1:t},d=r.doc.iterRange(t,e>0?r.doc.length:0),g=0;for(let m=0;!d.next().done&&m<=o;){let y=d.value;e<0&&(m+=y.length);let b=t+m*e;for(let S=e>0?0:y.length-1,A=e>0?y.length:-1;S!=A;S+=e){let P=l.indexOf(y[S]);if(!(P<0||i.resolveInner(b+S,1).type!=n))if(P%2==0==e>0)g++;else{if(g==1)return{start:c,end:{from:b+S,to:b+S+1},matched:P>>1==f>>1};g--}}e>0&&(m+=y.length)}return d.done?{start:c,matched:!1}:null}const ZC=Object.create(null),sp=[he.none],op=[],lp=Object.create(null),jC=Object.create(null);for(let[r,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])jC[r]=JC(ZC,t);function Ua(r,t){op.indexOf(r)>-1||(op.push(r),console.warn(t))}function JC(r,t){let e=[];for(let h of t.split(" ")){let f=[];for(let c of h.split(".")){let d=r[c]||I[c];d?typeof d=="function"?f.length?f=f.map(d):Ua(c,`Modifier ${c} used at start of tag`):f.length?Ua(c,`Tag ${c} used as modifier`):f=Array.isArray(d)?d:[d]:Ua(c,`Unknown highlighting tag ${c}`)}for(let c of f)e.push(c)}if(!e.length)return 0;let i=t.replace(/ /g,"_"),n=i+" "+e.map(h=>h.id),o=lp[n];if(o)return o.id;let l=lp[n]=he.define({id:sp.length,name:i,props:[sf({[i]:e})]});return sp.push(l),l.id}$t.RTL,$t.LTR;var Vr={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var tA=Vr.exports,ap;function eA(){return ap||(ap=1,function(r,t){(function(){var e,i="4.17.21",n=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",h="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",c=500,d="__lodash_placeholder__",g=1,m=2,y=4,b=1,S=2,A=1,P=2,B=4,N=8,D=16,$=32,W=64,F=128,et=256,st=512,bt=30,at="...",j=800,Ot=16,St=1,Wt=2,si=3,oi=1/0,Ye=9007199254740991,ki=17976931348623157e292,un=NaN,Lt=4294967295,fe=Lt-1,_e=Lt>>>1,Ci=[["ary",F],["bind",A],["bindKey",P],["curry",N],["curryRight",D],["flip",st],["partial",$],["partialRight",W],["rearg",et]],xe="[object Arguments]",Ai="[object Array]",ps="[object AsyncFunction]",cr="[object Boolean]",dr="[object Date]",Vm="[object DOMException]",gs="[object Error]",ms="[object Function]",pf="[object GeneratorFunction]",Ke="[object Map]",pr="[object Number]",Qm="[object Null]",Ti="[object Object]",gf="[object Promise]",Um="[object Proxy]",gr="[object RegExp]",Ge="[object Set]",mr="[object String]",ws="[object Symbol]",qm="[object Undefined]",wr="[object WeakMap]",Xm="[object WeakSet]",yr="[object ArrayBuffer]",_n="[object DataView]",fl="[object Float32Array]",ul="[object Float64Array]",cl="[object Int8Array]",dl="[object Int16Array]",pl="[object Int32Array]",gl="[object Uint8Array]",ml="[object Uint8ClampedArray]",wl="[object Uint16Array]",yl="[object Uint32Array]",Ym=/\b__p \+= '';/g,Km=/\b(__p \+=) '' \+/g,Gm=/(__e\(.*?\)|\b__t\)) \+\n'';/g,mf=/&(?:amp|lt|gt|quot|#39);/g,wf=/[&<>"']/g,Zm=RegExp(mf.source),jm=RegExp(wf.source),Jm=/<%-([\s\S]+?)%>/g,t0=/<%([\s\S]+?)%>/g,yf=/<%=([\s\S]+?)%>/g,e0=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i0=/^\w*$/,n0=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,vl=/[\\^$.*+?()[\]{}|]/g,r0=RegExp(vl.source),xl=/^\s+/,s0=/\s/,o0=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,l0=/\{\n\/\* \[wrapped with (.+)\] \*/,a0=/,? & /,h0=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,f0=/[()=,{}\[\]\/\s]/,u0=/\\(\\)?/g,c0=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,vf=/\w*$/,d0=/^[-+]0x[0-9a-f]+$/i,p0=/^0b[01]+$/i,g0=/^\[object .+?Constructor\]$/,m0=/^0o[0-7]+$/i,w0=/^(?:0|[1-9]\d*)$/,y0=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ys=/($^)/,v0=/['\n\r\u2028\u2029\\]/g,vs="\\ud800-\\udfff",x0="\\u0300-\\u036f",b0="\\ufe20-\\ufe2f",O0="\\u20d0-\\u20ff",xf=x0+b0+O0,bf="\\u2700-\\u27bf",Of="a-z\\xdf-\\xf6\\xf8-\\xff",S0="\\xac\\xb1\\xd7\\xf7",k0="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",C0="\\u2000-\\u206f",A0=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Sf="A-Z\\xc0-\\xd6\\xd8-\\xde",kf="\\ufe0e\\ufe0f",Cf=S0+k0+C0+A0,bl="[']",T0="["+vs+"]",Af="["+Cf+"]",xs="["+xf+"]",Tf="\\d+",P0="["+bf+"]",Pf="["+Of+"]",Mf="[^"+vs+Cf+Tf+bf+Of+Sf+"]",Ol="\\ud83c[\\udffb-\\udfff]",M0="(?:"+xs+"|"+Ol+")",Rf="[^"+vs+"]",Sl="(?:\\ud83c[\\udde6-\\uddff]){2}",kl="[\\ud800-\\udbff][\\udc00-\\udfff]",En="["+Sf+"]",_f="\\u200d",Ef="(?:"+Pf+"|"+Mf+")",R0="(?:"+En+"|"+Mf+")",Df="(?:"+bl+"(?:d|ll|m|re|s|t|ve))?",If="(?:"+bl+"(?:D|LL|M|RE|S|T|VE))?",Bf=M0+"?",Lf="["+kf+"]?",_0="(?:"+_f+"(?:"+[Rf,Sl,kl].join("|")+")"+Lf+Bf+")*",E0="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",D0="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Nf=Lf+Bf+_0,I0="(?:"+[P0,Sl,kl].join("|")+")"+Nf,B0="(?:"+[Rf+xs+"?",xs,Sl,kl,T0].join("|")+")",L0=RegExp(bl,"g"),N0=RegExp(xs,"g"),Cl=RegExp(Ol+"(?="+Ol+")|"+B0+Nf,"g"),$0=RegExp([En+"?"+Pf+"+"+Df+"(?="+[Af,En,"$"].join("|")+")",R0+"+"+If+"(?="+[Af,En+Ef,"$"].join("|")+")",En+"?"+Ef+"+"+Df,En+"+"+If,D0,E0,Tf,I0].join("|"),"g"),W0=RegExp("["+_f+vs+xf+kf+"]"),F0=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,H0=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],z0=-1,At={};At[fl]=At[ul]=At[cl]=At[dl]=At[pl]=At[gl]=At[ml]=At[wl]=At[yl]=!0,At[xe]=At[Ai]=At[yr]=At[cr]=At[_n]=At[dr]=At[gs]=At[ms]=At[Ke]=At[pr]=At[Ti]=At[gr]=At[Ge]=At[mr]=At[wr]=!1;var kt={};kt[xe]=kt[Ai]=kt[yr]=kt[_n]=kt[cr]=kt[dr]=kt[fl]=kt[ul]=kt[cl]=kt[dl]=kt[pl]=kt[Ke]=kt[pr]=kt[Ti]=kt[gr]=kt[Ge]=kt[mr]=kt[ws]=kt[gl]=kt[ml]=kt[wl]=kt[yl]=!0,kt[gs]=kt[ms]=kt[wr]=!1;var V0={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Q0={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},U0={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},q0={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},X0=parseFloat,Y0=parseInt,$f=typeof oo=="object"&&oo&&oo.Object===Object&&oo,K0=typeof self=="object"&&self&&self.Object===Object&&self,Yt=$f||K0||Function("return this")(),Al=t&&!t.nodeType&&t,cn=Al&&!0&&r&&!r.nodeType&&r,Wf=cn&&cn.exports===Al,Tl=Wf&&$f.process,Ee=function(){try{var C=cn&&cn.require&&cn.require("util").types;return C||Tl&&Tl.binding&&Tl.binding("util")}catch{}}(),Ff=Ee&&Ee.isArrayBuffer,Hf=Ee&&Ee.isDate,zf=Ee&&Ee.isMap,Vf=Ee&&Ee.isRegExp,Qf=Ee&&Ee.isSet,Uf=Ee&&Ee.isTypedArray;function be(C,R,M){switch(M.length){case 0:return C.call(R);case 1:return C.call(R,M[0]);case 2:return C.call(R,M[0],M[1]);case 3:return C.call(R,M[0],M[1],M[2])}return C.apply(R,M)}function G0(C,R,M,U){for(var J=-1,dt=C==null?0:C.length;++J<dt;){var Ft=C[J];R(U,Ft,M(Ft),C)}return U}function De(C,R){for(var M=-1,U=C==null?0:C.length;++M<U&&R(C[M],M,C)!==!1;);return C}function Z0(C,R){for(var M=C==null?0:C.length;M--&&R(C[M],M,C)!==!1;);return C}function qf(C,R){for(var M=-1,U=C==null?0:C.length;++M<U;)if(!R(C[M],M,C))return!1;return!0}function Qi(C,R){for(var M=-1,U=C==null?0:C.length,J=0,dt=[];++M<U;){var Ft=C[M];R(Ft,M,C)&&(dt[J++]=Ft)}return dt}function bs(C,R){var M=C==null?0:C.length;return!!M&&Dn(C,R,0)>-1}function Pl(C,R,M){for(var U=-1,J=C==null?0:C.length;++U<J;)if(M(R,C[U]))return!0;return!1}function Pt(C,R){for(var M=-1,U=C==null?0:C.length,J=Array(U);++M<U;)J[M]=R(C[M],M,C);return J}function Ui(C,R){for(var M=-1,U=R.length,J=C.length;++M<U;)C[J+M]=R[M];return C}function Ml(C,R,M,U){var J=-1,dt=C==null?0:C.length;for(U&&dt&&(M=C[++J]);++J<dt;)M=R(M,C[J],J,C);return M}function j0(C,R,M,U){var J=C==null?0:C.length;for(U&&J&&(M=C[--J]);J--;)M=R(M,C[J],J,C);return M}function Rl(C,R){for(var M=-1,U=C==null?0:C.length;++M<U;)if(R(C[M],M,C))return!0;return!1}var J0=_l("length");function t1(C){return C.split("")}function e1(C){return C.match(h0)||[]}function Xf(C,R,M){var U;return M(C,function(J,dt,Ft){if(R(J,dt,Ft))return U=dt,!1}),U}function Os(C,R,M,U){for(var J=C.length,dt=M+(U?1:-1);U?dt--:++dt<J;)if(R(C[dt],dt,C))return dt;return-1}function Dn(C,R,M){return R===R?d1(C,R,M):Os(C,Yf,M)}function i1(C,R,M,U){for(var J=M-1,dt=C.length;++J<dt;)if(U(C[J],R))return J;return-1}function Yf(C){return C!==C}function Kf(C,R){var M=C==null?0:C.length;return M?Dl(C,R)/M:un}function _l(C){return function(R){return R==null?e:R[C]}}function El(C){return function(R){return C==null?e:C[R]}}function Gf(C,R,M,U,J){return J(C,function(dt,Ft,yt){M=U?(U=!1,dt):R(M,dt,Ft,yt)}),M}function n1(C,R){var M=C.length;for(C.sort(R);M--;)C[M]=C[M].value;return C}function Dl(C,R){for(var M,U=-1,J=C.length;++U<J;){var dt=R(C[U]);dt!==e&&(M=M===e?dt:M+dt)}return M}function Il(C,R){for(var M=-1,U=Array(C);++M<C;)U[M]=R(M);return U}function r1(C,R){return Pt(R,function(M){return[M,C[M]]})}function Zf(C){return C&&C.slice(0,eu(C)+1).replace(xl,"")}function Oe(C){return function(R){return C(R)}}function Bl(C,R){return Pt(R,function(M){return C[M]})}function vr(C,R){return C.has(R)}function jf(C,R){for(var M=-1,U=C.length;++M<U&&Dn(R,C[M],0)>-1;);return M}function Jf(C,R){for(var M=C.length;M--&&Dn(R,C[M],0)>-1;);return M}function s1(C,R){for(var M=C.length,U=0;M--;)C[M]===R&&++U;return U}var o1=El(V0),l1=El(Q0);function a1(C){return"\\"+q0[C]}function h1(C,R){return C==null?e:C[R]}function In(C){return W0.test(C)}function f1(C){return F0.test(C)}function u1(C){for(var R,M=[];!(R=C.next()).done;)M.push(R.value);return M}function Ll(C){var R=-1,M=Array(C.size);return C.forEach(function(U,J){M[++R]=[J,U]}),M}function tu(C,R){return function(M){return C(R(M))}}function qi(C,R){for(var M=-1,U=C.length,J=0,dt=[];++M<U;){var Ft=C[M];(Ft===R||Ft===d)&&(C[M]=d,dt[J++]=M)}return dt}function Ss(C){var R=-1,M=Array(C.size);return C.forEach(function(U){M[++R]=U}),M}function c1(C){var R=-1,M=Array(C.size);return C.forEach(function(U){M[++R]=[U,U]}),M}function d1(C,R,M){for(var U=M-1,J=C.length;++U<J;)if(C[U]===R)return U;return-1}function p1(C,R,M){for(var U=M+1;U--;)if(C[U]===R)return U;return U}function Bn(C){return In(C)?m1(C):J0(C)}function Ze(C){return In(C)?w1(C):t1(C)}function eu(C){for(var R=C.length;R--&&s0.test(C.charAt(R)););return R}var g1=El(U0);function m1(C){for(var R=Cl.lastIndex=0;Cl.test(C);)++R;return R}function w1(C){return C.match(Cl)||[]}function y1(C){return C.match($0)||[]}var v1=function C(R){R=R==null?Yt:Ln.defaults(Yt.Object(),R,Ln.pick(Yt,H0));var M=R.Array,U=R.Date,J=R.Error,dt=R.Function,Ft=R.Math,yt=R.Object,Nl=R.RegExp,x1=R.String,Ie=R.TypeError,ks=M.prototype,b1=dt.prototype,Nn=yt.prototype,Cs=R["__core-js_shared__"],As=b1.toString,wt=Nn.hasOwnProperty,O1=0,iu=function(){var s=/[^.]+$/.exec(Cs&&Cs.keys&&Cs.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}(),Ts=Nn.toString,S1=As.call(yt),k1=Yt._,C1=Nl("^"+As.call(wt).replace(vl,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ps=Wf?R.Buffer:e,Xi=R.Symbol,Ms=R.Uint8Array,nu=Ps?Ps.allocUnsafe:e,Rs=tu(yt.getPrototypeOf,yt),ru=yt.create,su=Nn.propertyIsEnumerable,_s=ks.splice,ou=Xi?Xi.isConcatSpreadable:e,xr=Xi?Xi.iterator:e,dn=Xi?Xi.toStringTag:e,Es=function(){try{var s=yn(yt,"defineProperty");return s({},"",{}),s}catch{}}(),A1=R.clearTimeout!==Yt.clearTimeout&&R.clearTimeout,T1=U&&U.now!==Yt.Date.now&&U.now,P1=R.setTimeout!==Yt.setTimeout&&R.setTimeout,Ds=Ft.ceil,Is=Ft.floor,$l=yt.getOwnPropertySymbols,M1=Ps?Ps.isBuffer:e,lu=R.isFinite,R1=ks.join,_1=tu(yt.keys,yt),Ht=Ft.max,jt=Ft.min,E1=U.now,D1=R.parseInt,au=Ft.random,I1=ks.reverse,Wl=yn(R,"DataView"),br=yn(R,"Map"),Fl=yn(R,"Promise"),$n=yn(R,"Set"),Or=yn(R,"WeakMap"),Sr=yn(yt,"create"),Bs=Or&&new Or,Wn={},B1=vn(Wl),L1=vn(br),N1=vn(Fl),$1=vn($n),W1=vn(Or),Ls=Xi?Xi.prototype:e,kr=Ls?Ls.valueOf:e,hu=Ls?Ls.toString:e;function v(s){if(Et(s)&&!tt(s)&&!(s instanceof ht)){if(s instanceof Be)return s;if(wt.call(s,"__wrapped__"))return fc(s)}return new Be(s)}var Fn=function(){function s(){}return function(a){if(!Rt(a))return{};if(ru)return ru(a);s.prototype=a;var u=new s;return s.prototype=e,u}}();function Ns(){}function Be(s,a){this.__wrapped__=s,this.__actions__=[],this.__chain__=!!a,this.__index__=0,this.__values__=e}v.templateSettings={escape:Jm,evaluate:t0,interpolate:yf,variable:"",imports:{_:v}},v.prototype=Ns.prototype,v.prototype.constructor=v,Be.prototype=Fn(Ns.prototype),Be.prototype.constructor=Be;function ht(s){this.__wrapped__=s,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Lt,this.__views__=[]}function F1(){var s=new ht(this.__wrapped__);return s.__actions__=ue(this.__actions__),s.__dir__=this.__dir__,s.__filtered__=this.__filtered__,s.__iteratees__=ue(this.__iteratees__),s.__takeCount__=this.__takeCount__,s.__views__=ue(this.__views__),s}function H1(){if(this.__filtered__){var s=new ht(this);s.__dir__=-1,s.__filtered__=!0}else s=this.clone(),s.__dir__*=-1;return s}function z1(){var s=this.__wrapped__.value(),a=this.__dir__,u=tt(s),p=a<0,w=u?s.length:0,x=ty(0,w,this.__views__),O=x.start,k=x.end,T=k-O,_=p?k:O-1,E=this.__iteratees__,L=E.length,z=0,q=jt(T,this.__takeCount__);if(!u||!p&&w==T&&q==T)return Du(s,this.__actions__);var K=[];t:for(;T--&&z<q;){_+=a;for(var nt=-1,G=s[_];++nt<L;){var lt=E[nt],ut=lt.iteratee,Ce=lt.type,re=ut(G);if(Ce==Wt)G=re;else if(!re){if(Ce==St)continue t;break t}}K[z++]=G}return K}ht.prototype=Fn(Ns.prototype),ht.prototype.constructor=ht;function pn(s){var a=-1,u=s==null?0:s.length;for(this.clear();++a<u;){var p=s[a];this.set(p[0],p[1])}}function V1(){this.__data__=Sr?Sr(null):{},this.size=0}function Q1(s){var a=this.has(s)&&delete this.__data__[s];return this.size-=a?1:0,a}function U1(s){var a=this.__data__;if(Sr){var u=a[s];return u===f?e:u}return wt.call(a,s)?a[s]:e}function q1(s){var a=this.__data__;return Sr?a[s]!==e:wt.call(a,s)}function X1(s,a){var u=this.__data__;return this.size+=this.has(s)?0:1,u[s]=Sr&&a===e?f:a,this}pn.prototype.clear=V1,pn.prototype.delete=Q1,pn.prototype.get=U1,pn.prototype.has=q1,pn.prototype.set=X1;function Pi(s){var a=-1,u=s==null?0:s.length;for(this.clear();++a<u;){var p=s[a];this.set(p[0],p[1])}}function Y1(){this.__data__=[],this.size=0}function K1(s){var a=this.__data__,u=$s(a,s);if(u<0)return!1;var p=a.length-1;return u==p?a.pop():_s.call(a,u,1),--this.size,!0}function G1(s){var a=this.__data__,u=$s(a,s);return u<0?e:a[u][1]}function Z1(s){return $s(this.__data__,s)>-1}function j1(s,a){var u=this.__data__,p=$s(u,s);return p<0?(++this.size,u.push([s,a])):u[p][1]=a,this}Pi.prototype.clear=Y1,Pi.prototype.delete=K1,Pi.prototype.get=G1,Pi.prototype.has=Z1,Pi.prototype.set=j1;function Mi(s){var a=-1,u=s==null?0:s.length;for(this.clear();++a<u;){var p=s[a];this.set(p[0],p[1])}}function J1(){this.size=0,this.__data__={hash:new pn,map:new(br||Pi),string:new pn}}function tw(s){var a=Gs(this,s).delete(s);return this.size-=a?1:0,a}function ew(s){return Gs(this,s).get(s)}function iw(s){return Gs(this,s).has(s)}function nw(s,a){var u=Gs(this,s),p=u.size;return u.set(s,a),this.size+=u.size==p?0:1,this}Mi.prototype.clear=J1,Mi.prototype.delete=tw,Mi.prototype.get=ew,Mi.prototype.has=iw,Mi.prototype.set=nw;function gn(s){var a=-1,u=s==null?0:s.length;for(this.__data__=new Mi;++a<u;)this.add(s[a])}function rw(s){return this.__data__.set(s,f),this}function sw(s){return this.__data__.has(s)}gn.prototype.add=gn.prototype.push=rw,gn.prototype.has=sw;function je(s){var a=this.__data__=new Pi(s);this.size=a.size}function ow(){this.__data__=new Pi,this.size=0}function lw(s){var a=this.__data__,u=a.delete(s);return this.size=a.size,u}function aw(s){return this.__data__.get(s)}function hw(s){return this.__data__.has(s)}function fw(s,a){var u=this.__data__;if(u instanceof Pi){var p=u.__data__;if(!br||p.length<n-1)return p.push([s,a]),this.size=++u.size,this;u=this.__data__=new Mi(p)}return u.set(s,a),this.size=u.size,this}je.prototype.clear=ow,je.prototype.delete=lw,je.prototype.get=aw,je.prototype.has=hw,je.prototype.set=fw;function fu(s,a){var u=tt(s),p=!u&&xn(s),w=!u&&!p&&ji(s),x=!u&&!p&&!w&&Qn(s),O=u||p||w||x,k=O?Il(s.length,x1):[],T=k.length;for(var _ in s)(a||wt.call(s,_))&&!(O&&(_=="length"||w&&(_=="offset"||_=="parent")||x&&(_=="buffer"||_=="byteLength"||_=="byteOffset")||Di(_,T)))&&k.push(_);return k}function uu(s){var a=s.length;return a?s[Zl(0,a-1)]:e}function uw(s,a){return Zs(ue(s),mn(a,0,s.length))}function cw(s){return Zs(ue(s))}function Hl(s,a,u){(u!==e&&!Je(s[a],u)||u===e&&!(a in s))&&Ri(s,a,u)}function Cr(s,a,u){var p=s[a];(!(wt.call(s,a)&&Je(p,u))||u===e&&!(a in s))&&Ri(s,a,u)}function $s(s,a){for(var u=s.length;u--;)if(Je(s[u][0],a))return u;return-1}function dw(s,a,u,p){return Yi(s,function(w,x,O){a(p,w,u(w),O)}),p}function cu(s,a){return s&&ai(a,qt(a),s)}function pw(s,a){return s&&ai(a,de(a),s)}function Ri(s,a,u){a=="__proto__"&&Es?Es(s,a,{configurable:!0,enumerable:!0,value:u,writable:!0}):s[a]=u}function zl(s,a){for(var u=-1,p=a.length,w=M(p),x=s==null;++u<p;)w[u]=x?e:Oa(s,a[u]);return w}function mn(s,a,u){return s===s&&(u!==e&&(s=s<=u?s:u),a!==e&&(s=s>=a?s:a)),s}function Le(s,a,u,p,w,x){var O,k=a&g,T=a&m,_=a&y;if(u&&(O=w?u(s,p,w,x):u(s)),O!==e)return O;if(!Rt(s))return s;var E=tt(s);if(E){if(O=iy(s),!k)return ue(s,O)}else{var L=Jt(s),z=L==ms||L==pf;if(ji(s))return Lu(s,k);if(L==Ti||L==xe||z&&!w){if(O=T||z?{}:ec(s),!k)return T?Uw(s,pw(O,s)):Qw(s,cu(O,s))}else{if(!kt[L])return w?s:{};O=ny(s,L,k)}}x||(x=new je);var q=x.get(s);if(q)return q;x.set(s,O),Rc(s)?s.forEach(function(G){O.add(Le(G,a,u,G,s,x))}):Pc(s)&&s.forEach(function(G,lt){O.set(lt,Le(G,a,u,lt,s,x))});var K=_?T?aa:la:T?de:qt,nt=E?e:K(s);return De(nt||s,function(G,lt){nt&&(lt=G,G=s[lt]),Cr(O,lt,Le(G,a,u,lt,s,x))}),O}function gw(s){var a=qt(s);return function(u){return du(u,s,a)}}function du(s,a,u){var p=u.length;if(s==null)return!p;for(s=yt(s);p--;){var w=u[p],x=a[w],O=s[w];if(O===e&&!(w in s)||!x(O))return!1}return!0}function pu(s,a,u){if(typeof s!="function")throw new Ie(l);return Er(function(){s.apply(e,u)},a)}function Ar(s,a,u,p){var w=-1,x=bs,O=!0,k=s.length,T=[],_=a.length;if(!k)return T;u&&(a=Pt(a,Oe(u))),p?(x=Pl,O=!1):a.length>=n&&(x=vr,O=!1,a=new gn(a));t:for(;++w<k;){var E=s[w],L=u==null?E:u(E);if(E=p||E!==0?E:0,O&&L===L){for(var z=_;z--;)if(a[z]===L)continue t;T.push(E)}else x(a,L,p)||T.push(E)}return T}var Yi=Hu(li),gu=Hu(Ql,!0);function mw(s,a){var u=!0;return Yi(s,function(p,w,x){return u=!!a(p,w,x),u}),u}function Ws(s,a,u){for(var p=-1,w=s.length;++p<w;){var x=s[p],O=a(x);if(O!=null&&(k===e?O===O&&!ke(O):u(O,k)))var k=O,T=x}return T}function ww(s,a,u,p){var w=s.length;for(u=it(u),u<0&&(u=-u>w?0:w+u),p=p===e||p>w?w:it(p),p<0&&(p+=w),p=u>p?0:Ec(p);u<p;)s[u++]=a;return s}function mu(s,a){var u=[];return Yi(s,function(p,w,x){a(p,w,x)&&u.push(p)}),u}function Kt(s,a,u,p,w){var x=-1,O=s.length;for(u||(u=sy),w||(w=[]);++x<O;){var k=s[x];a>0&&u(k)?a>1?Kt(k,a-1,u,p,w):Ui(w,k):p||(w[w.length]=k)}return w}var Vl=zu(),wu=zu(!0);function li(s,a){return s&&Vl(s,a,qt)}function Ql(s,a){return s&&wu(s,a,qt)}function Fs(s,a){return Qi(a,function(u){return Ii(s[u])})}function wn(s,a){a=Gi(a,s);for(var u=0,p=a.length;s!=null&&u<p;)s=s[hi(a[u++])];return u&&u==p?s:e}function yu(s,a,u){var p=a(s);return tt(s)?p:Ui(p,u(s))}function ie(s){return s==null?s===e?qm:Qm:dn&&dn in yt(s)?Jw(s):cy(s)}function Ul(s,a){return s>a}function yw(s,a){return s!=null&&wt.call(s,a)}function vw(s,a){return s!=null&&a in yt(s)}function xw(s,a,u){return s>=jt(a,u)&&s<Ht(a,u)}function ql(s,a,u){for(var p=u?Pl:bs,w=s[0].length,x=s.length,O=x,k=M(x),T=1/0,_=[];O--;){var E=s[O];O&&a&&(E=Pt(E,Oe(a))),T=jt(E.length,T),k[O]=!u&&(a||w>=120&&E.length>=120)?new gn(O&&E):e}E=s[0];var L=-1,z=k[0];t:for(;++L<w&&_.length<T;){var q=E[L],K=a?a(q):q;if(q=u||q!==0?q:0,!(z?vr(z,K):p(_,K,u))){for(O=x;--O;){var nt=k[O];if(!(nt?vr(nt,K):p(s[O],K,u)))continue t}z&&z.push(K),_.push(q)}}return _}function bw(s,a,u,p){return li(s,function(w,x,O){a(p,u(w),x,O)}),p}function Tr(s,a,u){a=Gi(a,s),s=sc(s,a);var p=s==null?s:s[hi($e(a))];return p==null?e:be(p,s,u)}function vu(s){return Et(s)&&ie(s)==xe}function Ow(s){return Et(s)&&ie(s)==yr}function Sw(s){return Et(s)&&ie(s)==dr}function Pr(s,a,u,p,w){return s===a?!0:s==null||a==null||!Et(s)&&!Et(a)?s!==s&&a!==a:kw(s,a,u,p,Pr,w)}function kw(s,a,u,p,w,x){var O=tt(s),k=tt(a),T=O?Ai:Jt(s),_=k?Ai:Jt(a);T=T==xe?Ti:T,_=_==xe?Ti:_;var E=T==Ti,L=_==Ti,z=T==_;if(z&&ji(s)){if(!ji(a))return!1;O=!0,E=!1}if(z&&!E)return x||(x=new je),O||Qn(s)?ju(s,a,u,p,w,x):Zw(s,a,T,u,p,w,x);if(!(u&b)){var q=E&&wt.call(s,"__wrapped__"),K=L&&wt.call(a,"__wrapped__");if(q||K){var nt=q?s.value():s,G=K?a.value():a;return x||(x=new je),w(nt,G,u,p,x)}}return z?(x||(x=new je),jw(s,a,u,p,w,x)):!1}function Cw(s){return Et(s)&&Jt(s)==Ke}function Xl(s,a,u,p){var w=u.length,x=w,O=!p;if(s==null)return!x;for(s=yt(s);w--;){var k=u[w];if(O&&k[2]?k[1]!==s[k[0]]:!(k[0]in s))return!1}for(;++w<x;){k=u[w];var T=k[0],_=s[T],E=k[1];if(O&&k[2]){if(_===e&&!(T in s))return!1}else{var L=new je;if(p)var z=p(_,E,T,s,a,L);if(!(z===e?Pr(E,_,b|S,p,L):z))return!1}}return!0}function xu(s){if(!Rt(s)||ly(s))return!1;var a=Ii(s)?C1:g0;return a.test(vn(s))}function Aw(s){return Et(s)&&ie(s)==gr}function Tw(s){return Et(s)&&Jt(s)==Ge}function Pw(s){return Et(s)&&no(s.length)&&!!At[ie(s)]}function bu(s){return typeof s=="function"?s:s==null?pe:typeof s=="object"?tt(s)?ku(s[0],s[1]):Su(s):Vc(s)}function Yl(s){if(!_r(s))return _1(s);var a=[];for(var u in yt(s))wt.call(s,u)&&u!="constructor"&&a.push(u);return a}function Mw(s){if(!Rt(s))return uy(s);var a=_r(s),u=[];for(var p in s)p=="constructor"&&(a||!wt.call(s,p))||u.push(p);return u}function Kl(s,a){return s<a}function Ou(s,a){var u=-1,p=ce(s)?M(s.length):[];return Yi(s,function(w,x,O){p[++u]=a(w,x,O)}),p}function Su(s){var a=fa(s);return a.length==1&&a[0][2]?nc(a[0][0],a[0][1]):function(u){return u===s||Xl(u,s,a)}}function ku(s,a){return ca(s)&&ic(a)?nc(hi(s),a):function(u){var p=Oa(u,s);return p===e&&p===a?Sa(u,s):Pr(a,p,b|S)}}function Hs(s,a,u,p,w){s!==a&&Vl(a,function(x,O){if(w||(w=new je),Rt(x))Rw(s,a,O,u,Hs,p,w);else{var k=p?p(pa(s,O),x,O+"",s,a,w):e;k===e&&(k=x),Hl(s,O,k)}},de)}function Rw(s,a,u,p,w,x,O){var k=pa(s,u),T=pa(a,u),_=O.get(T);if(_){Hl(s,u,_);return}var E=x?x(k,T,u+"",s,a,O):e,L=E===e;if(L){var z=tt(T),q=!z&&ji(T),K=!z&&!q&&Qn(T);E=T,z||q||K?tt(k)?E=k:Dt(k)?E=ue(k):q?(L=!1,E=Lu(T,!0)):K?(L=!1,E=Nu(T,!0)):E=[]:Dr(T)||xn(T)?(E=k,xn(k)?E=Dc(k):(!Rt(k)||Ii(k))&&(E=ec(T))):L=!1}L&&(O.set(T,E),w(E,T,p,x,O),O.delete(T)),Hl(s,u,E)}function Cu(s,a){var u=s.length;if(u)return a+=a<0?u:0,Di(a,u)?s[a]:e}function Au(s,a,u){a.length?a=Pt(a,function(x){return tt(x)?function(O){return wn(O,x.length===1?x[0]:x)}:x}):a=[pe];var p=-1;a=Pt(a,Oe(Y()));var w=Ou(s,function(x,O,k){var T=Pt(a,function(_){return _(x)});return{criteria:T,index:++p,value:x}});return n1(w,function(x,O){return Vw(x,O,u)})}function _w(s,a){return Tu(s,a,function(u,p){return Sa(s,p)})}function Tu(s,a,u){for(var p=-1,w=a.length,x={};++p<w;){var O=a[p],k=wn(s,O);u(k,O)&&Mr(x,Gi(O,s),k)}return x}function Ew(s){return function(a){return wn(a,s)}}function Gl(s,a,u,p){var w=p?i1:Dn,x=-1,O=a.length,k=s;for(s===a&&(a=ue(a)),u&&(k=Pt(s,Oe(u)));++x<O;)for(var T=0,_=a[x],E=u?u(_):_;(T=w(k,E,T,p))>-1;)k!==s&&_s.call(k,T,1),_s.call(s,T,1);return s}function Pu(s,a){for(var u=s?a.length:0,p=u-1;u--;){var w=a[u];if(u==p||w!==x){var x=w;Di(w)?_s.call(s,w,1):ta(s,w)}}return s}function Zl(s,a){return s+Is(au()*(a-s+1))}function Dw(s,a,u,p){for(var w=-1,x=Ht(Ds((a-s)/(u||1)),0),O=M(x);x--;)O[p?x:++w]=s,s+=u;return O}function jl(s,a){var u="";if(!s||a<1||a>Ye)return u;do a%2&&(u+=s),a=Is(a/2),a&&(s+=s);while(a);return u}function rt(s,a){return ga(rc(s,a,pe),s+"")}function Iw(s){return uu(Un(s))}function Bw(s,a){var u=Un(s);return Zs(u,mn(a,0,u.length))}function Mr(s,a,u,p){if(!Rt(s))return s;a=Gi(a,s);for(var w=-1,x=a.length,O=x-1,k=s;k!=null&&++w<x;){var T=hi(a[w]),_=u;if(T==="__proto__"||T==="constructor"||T==="prototype")return s;if(w!=O){var E=k[T];_=p?p(E,T,k):e,_===e&&(_=Rt(E)?E:Di(a[w+1])?[]:{})}Cr(k,T,_),k=k[T]}return s}var Mu=Bs?function(s,a){return Bs.set(s,a),s}:pe,Lw=Es?function(s,a){return Es(s,"toString",{configurable:!0,enumerable:!1,value:Ca(a),writable:!0})}:pe;function Nw(s){return Zs(Un(s))}function Ne(s,a,u){var p=-1,w=s.length;a<0&&(a=-a>w?0:w+a),u=u>w?w:u,u<0&&(u+=w),w=a>u?0:u-a>>>0,a>>>=0;for(var x=M(w);++p<w;)x[p]=s[p+a];return x}function $w(s,a){var u;return Yi(s,function(p,w,x){return u=a(p,w,x),!u}),!!u}function zs(s,a,u){var p=0,w=s==null?p:s.length;if(typeof a=="number"&&a===a&&w<=_e){for(;p<w;){var x=p+w>>>1,O=s[x];O!==null&&!ke(O)&&(u?O<=a:O<a)?p=x+1:w=x}return w}return Jl(s,a,pe,u)}function Jl(s,a,u,p){var w=0,x=s==null?0:s.length;if(x===0)return 0;a=u(a);for(var O=a!==a,k=a===null,T=ke(a),_=a===e;w<x;){var E=Is((w+x)/2),L=u(s[E]),z=L!==e,q=L===null,K=L===L,nt=ke(L);if(O)var G=p||K;else _?G=K&&(p||z):k?G=K&&z&&(p||!q):T?G=K&&z&&!q&&(p||!nt):q||nt?G=!1:G=p?L<=a:L<a;G?w=E+1:x=E}return jt(x,fe)}function Ru(s,a){for(var u=-1,p=s.length,w=0,x=[];++u<p;){var O=s[u],k=a?a(O):O;if(!u||!Je(k,T)){var T=k;x[w++]=O===0?0:O}}return x}function _u(s){return typeof s=="number"?s:ke(s)?un:+s}function Se(s){if(typeof s=="string")return s;if(tt(s))return Pt(s,Se)+"";if(ke(s))return hu?hu.call(s):"";var a=s+"";return a=="0"&&1/s==-1/0?"-0":a}function Ki(s,a,u){var p=-1,w=bs,x=s.length,O=!0,k=[],T=k;if(u)O=!1,w=Pl;else if(x>=n){var _=a?null:Kw(s);if(_)return Ss(_);O=!1,w=vr,T=new gn}else T=a?[]:k;t:for(;++p<x;){var E=s[p],L=a?a(E):E;if(E=u||E!==0?E:0,O&&L===L){for(var z=T.length;z--;)if(T[z]===L)continue t;a&&T.push(L),k.push(E)}else w(T,L,u)||(T!==k&&T.push(L),k.push(E))}return k}function ta(s,a){return a=Gi(a,s),s=sc(s,a),s==null||delete s[hi($e(a))]}function Eu(s,a,u,p){return Mr(s,a,u(wn(s,a)),p)}function Vs(s,a,u,p){for(var w=s.length,x=p?w:-1;(p?x--:++x<w)&&a(s[x],x,s););return u?Ne(s,p?0:x,p?x+1:w):Ne(s,p?x+1:0,p?w:x)}function Du(s,a){var u=s;return u instanceof ht&&(u=u.value()),Ml(a,function(p,w){return w.func.apply(w.thisArg,Ui([p],w.args))},u)}function ea(s,a,u){var p=s.length;if(p<2)return p?Ki(s[0]):[];for(var w=-1,x=M(p);++w<p;)for(var O=s[w],k=-1;++k<p;)k!=w&&(x[w]=Ar(x[w]||O,s[k],a,u));return Ki(Kt(x,1),a,u)}function Iu(s,a,u){for(var p=-1,w=s.length,x=a.length,O={};++p<w;){var k=p<x?a[p]:e;u(O,s[p],k)}return O}function ia(s){return Dt(s)?s:[]}function na(s){return typeof s=="function"?s:pe}function Gi(s,a){return tt(s)?s:ca(s,a)?[s]:hc(gt(s))}var Ww=rt;function Zi(s,a,u){var p=s.length;return u=u===e?p:u,!a&&u>=p?s:Ne(s,a,u)}var Bu=A1||function(s){return Yt.clearTimeout(s)};function Lu(s,a){if(a)return s.slice();var u=s.length,p=nu?nu(u):new s.constructor(u);return s.copy(p),p}function ra(s){var a=new s.constructor(s.byteLength);return new Ms(a).set(new Ms(s)),a}function Fw(s,a){var u=a?ra(s.buffer):s.buffer;return new s.constructor(u,s.byteOffset,s.byteLength)}function Hw(s){var a=new s.constructor(s.source,vf.exec(s));return a.lastIndex=s.lastIndex,a}function zw(s){return kr?yt(kr.call(s)):{}}function Nu(s,a){var u=a?ra(s.buffer):s.buffer;return new s.constructor(u,s.byteOffset,s.length)}function $u(s,a){if(s!==a){var u=s!==e,p=s===null,w=s===s,x=ke(s),O=a!==e,k=a===null,T=a===a,_=ke(a);if(!k&&!_&&!x&&s>a||x&&O&&T&&!k&&!_||p&&O&&T||!u&&T||!w)return 1;if(!p&&!x&&!_&&s<a||_&&u&&w&&!p&&!x||k&&u&&w||!O&&w||!T)return-1}return 0}function Vw(s,a,u){for(var p=-1,w=s.criteria,x=a.criteria,O=w.length,k=u.length;++p<O;){var T=$u(w[p],x[p]);if(T){if(p>=k)return T;var _=u[p];return T*(_=="desc"?-1:1)}}return s.index-a.index}function Wu(s,a,u,p){for(var w=-1,x=s.length,O=u.length,k=-1,T=a.length,_=Ht(x-O,0),E=M(T+_),L=!p;++k<T;)E[k]=a[k];for(;++w<O;)(L||w<x)&&(E[u[w]]=s[w]);for(;_--;)E[k++]=s[w++];return E}function Fu(s,a,u,p){for(var w=-1,x=s.length,O=-1,k=u.length,T=-1,_=a.length,E=Ht(x-k,0),L=M(E+_),z=!p;++w<E;)L[w]=s[w];for(var q=w;++T<_;)L[q+T]=a[T];for(;++O<k;)(z||w<x)&&(L[q+u[O]]=s[w++]);return L}function ue(s,a){var u=-1,p=s.length;for(a||(a=M(p));++u<p;)a[u]=s[u];return a}function ai(s,a,u,p){var w=!u;u||(u={});for(var x=-1,O=a.length;++x<O;){var k=a[x],T=p?p(u[k],s[k],k,u,s):e;T===e&&(T=s[k]),w?Ri(u,k,T):Cr(u,k,T)}return u}function Qw(s,a){return ai(s,ua(s),a)}function Uw(s,a){return ai(s,Ju(s),a)}function Qs(s,a){return function(u,p){var w=tt(u)?G0:dw,x=a?a():{};return w(u,s,Y(p,2),x)}}function Hn(s){return rt(function(a,u){var p=-1,w=u.length,x=w>1?u[w-1]:e,O=w>2?u[2]:e;for(x=s.length>3&&typeof x=="function"?(w--,x):e,O&&ne(u[0],u[1],O)&&(x=w<3?e:x,w=1),a=yt(a);++p<w;){var k=u[p];k&&s(a,k,p,x)}return a})}function Hu(s,a){return function(u,p){if(u==null)return u;if(!ce(u))return s(u,p);for(var w=u.length,x=a?w:-1,O=yt(u);(a?x--:++x<w)&&p(O[x],x,O)!==!1;);return u}}function zu(s){return function(a,u,p){for(var w=-1,x=yt(a),O=p(a),k=O.length;k--;){var T=O[s?k:++w];if(u(x[T],T,x)===!1)break}return a}}function qw(s,a,u){var p=a&A,w=Rr(s);function x(){var O=this&&this!==Yt&&this instanceof x?w:s;return O.apply(p?u:this,arguments)}return x}function Vu(s){return function(a){a=gt(a);var u=In(a)?Ze(a):e,p=u?u[0]:a.charAt(0),w=u?Zi(u,1).join(""):a.slice(1);return p[s]()+w}}function zn(s){return function(a){return Ml(Hc(Fc(a).replace(L0,"")),s,"")}}function Rr(s){return function(){var a=arguments;switch(a.length){case 0:return new s;case 1:return new s(a[0]);case 2:return new s(a[0],a[1]);case 3:return new s(a[0],a[1],a[2]);case 4:return new s(a[0],a[1],a[2],a[3]);case 5:return new s(a[0],a[1],a[2],a[3],a[4]);case 6:return new s(a[0],a[1],a[2],a[3],a[4],a[5]);case 7:return new s(a[0],a[1],a[2],a[3],a[4],a[5],a[6])}var u=Fn(s.prototype),p=s.apply(u,a);return Rt(p)?p:u}}function Xw(s,a,u){var p=Rr(s);function w(){for(var x=arguments.length,O=M(x),k=x,T=Vn(w);k--;)O[k]=arguments[k];var _=x<3&&O[0]!==T&&O[x-1]!==T?[]:qi(O,T);if(x-=_.length,x<u)return Yu(s,a,Us,w.placeholder,e,O,_,e,e,u-x);var E=this&&this!==Yt&&this instanceof w?p:s;return be(E,this,O)}return w}function Qu(s){return function(a,u,p){var w=yt(a);if(!ce(a)){var x=Y(u,3);a=qt(a),u=function(k){return x(w[k],k,w)}}var O=s(a,u,p);return O>-1?w[x?a[O]:O]:e}}function Uu(s){return Ei(function(a){var u=a.length,p=u,w=Be.prototype.thru;for(s&&a.reverse();p--;){var x=a[p];if(typeof x!="function")throw new Ie(l);if(w&&!O&&Ks(x)=="wrapper")var O=new Be([],!0)}for(p=O?p:u;++p<u;){x=a[p];var k=Ks(x),T=k=="wrapper"?ha(x):e;T&&da(T[0])&&T[1]==(F|N|$|et)&&!T[4].length&&T[9]==1?O=O[Ks(T[0])].apply(O,T[3]):O=x.length==1&&da(x)?O[k]():O.thru(x)}return function(){var _=arguments,E=_[0];if(O&&_.length==1&&tt(E))return O.plant(E).value();for(var L=0,z=u?a[L].apply(this,_):E;++L<u;)z=a[L].call(this,z);return z}})}function Us(s,a,u,p,w,x,O,k,T,_){var E=a&F,L=a&A,z=a&P,q=a&(N|D),K=a&st,nt=z?e:Rr(s);function G(){for(var lt=arguments.length,ut=M(lt),Ce=lt;Ce--;)ut[Ce]=arguments[Ce];if(q)var re=Vn(G),Ae=s1(ut,re);if(p&&(ut=Wu(ut,p,w,q)),x&&(ut=Fu(ut,x,O,q)),lt-=Ae,q&&lt<_){var It=qi(ut,re);return Yu(s,a,Us,G.placeholder,u,ut,It,k,T,_-lt)}var ti=L?u:this,Li=z?ti[s]:s;return lt=ut.length,k?ut=dy(ut,k):K&&lt>1&&ut.reverse(),E&&T<lt&&(ut.length=T),this&&this!==Yt&&this instanceof G&&(Li=nt||Rr(Li)),Li.apply(ti,ut)}return G}function qu(s,a){return function(u,p){return bw(u,s,a(p),{})}}function qs(s,a){return function(u,p){var w;if(u===e&&p===e)return a;if(u!==e&&(w=u),p!==e){if(w===e)return p;typeof u=="string"||typeof p=="string"?(u=Se(u),p=Se(p)):(u=_u(u),p=_u(p)),w=s(u,p)}return w}}function sa(s){return Ei(function(a){return a=Pt(a,Oe(Y())),rt(function(u){var p=this;return s(a,function(w){return be(w,p,u)})})})}function Xs(s,a){a=a===e?" ":Se(a);var u=a.length;if(u<2)return u?jl(a,s):a;var p=jl(a,Ds(s/Bn(a)));return In(a)?Zi(Ze(p),0,s).join(""):p.slice(0,s)}function Yw(s,a,u,p){var w=a&A,x=Rr(s);function O(){for(var k=-1,T=arguments.length,_=-1,E=p.length,L=M(E+T),z=this&&this!==Yt&&this instanceof O?x:s;++_<E;)L[_]=p[_];for(;T--;)L[_++]=arguments[++k];return be(z,w?u:this,L)}return O}function Xu(s){return function(a,u,p){return p&&typeof p!="number"&&ne(a,u,p)&&(u=p=e),a=Bi(a),u===e?(u=a,a=0):u=Bi(u),p=p===e?a<u?1:-1:Bi(p),Dw(a,u,p,s)}}function Ys(s){return function(a,u){return typeof a=="string"&&typeof u=="string"||(a=We(a),u=We(u)),s(a,u)}}function Yu(s,a,u,p,w,x,O,k,T,_){var E=a&N,L=E?O:e,z=E?e:O,q=E?x:e,K=E?e:x;a|=E?$:W,a&=~(E?W:$),a&B||(a&=-4);var nt=[s,a,w,q,L,K,z,k,T,_],G=u.apply(e,nt);return da(s)&&oc(G,nt),G.placeholder=p,lc(G,s,a)}function oa(s){var a=Ft[s];return function(u,p){if(u=We(u),p=p==null?0:jt(it(p),292),p&&lu(u)){var w=(gt(u)+"e").split("e"),x=a(w[0]+"e"+(+w[1]+p));return w=(gt(x)+"e").split("e"),+(w[0]+"e"+(+w[1]-p))}return a(u)}}var Kw=$n&&1/Ss(new $n([,-0]))[1]==oi?function(s){return new $n(s)}:Pa;function Ku(s){return function(a){var u=Jt(a);return u==Ke?Ll(a):u==Ge?c1(a):r1(a,s(a))}}function _i(s,a,u,p,w,x,O,k){var T=a&P;if(!T&&typeof s!="function")throw new Ie(l);var _=p?p.length:0;if(_||(a&=-97,p=w=e),O=O===e?O:Ht(it(O),0),k=k===e?k:it(k),_-=w?w.length:0,a&W){var E=p,L=w;p=w=e}var z=T?e:ha(s),q=[s,a,u,p,w,E,L,x,O,k];if(z&&fy(q,z),s=q[0],a=q[1],u=q[2],p=q[3],w=q[4],k=q[9]=q[9]===e?T?0:s.length:Ht(q[9]-_,0),!k&&a&(N|D)&&(a&=-25),!a||a==A)var K=qw(s,a,u);else a==N||a==D?K=Xw(s,a,k):(a==$||a==(A|$))&&!w.length?K=Yw(s,a,u,p):K=Us.apply(e,q);var nt=z?Mu:oc;return lc(nt(K,q),s,a)}function Gu(s,a,u,p){return s===e||Je(s,Nn[u])&&!wt.call(p,u)?a:s}function Zu(s,a,u,p,w,x){return Rt(s)&&Rt(a)&&(x.set(a,s),Hs(s,a,e,Zu,x),x.delete(a)),s}function Gw(s){return Dr(s)?e:s}function ju(s,a,u,p,w,x){var O=u&b,k=s.length,T=a.length;if(k!=T&&!(O&&T>k))return!1;var _=x.get(s),E=x.get(a);if(_&&E)return _==a&&E==s;var L=-1,z=!0,q=u&S?new gn:e;for(x.set(s,a),x.set(a,s);++L<k;){var K=s[L],nt=a[L];if(p)var G=O?p(nt,K,L,a,s,x):p(K,nt,L,s,a,x);if(G!==e){if(G)continue;z=!1;break}if(q){if(!Rl(a,function(lt,ut){if(!vr(q,ut)&&(K===lt||w(K,lt,u,p,x)))return q.push(ut)})){z=!1;break}}else if(!(K===nt||w(K,nt,u,p,x))){z=!1;break}}return x.delete(s),x.delete(a),z}function Zw(s,a,u,p,w,x,O){switch(u){case _n:if(s.byteLength!=a.byteLength||s.byteOffset!=a.byteOffset)return!1;s=s.buffer,a=a.buffer;case yr:return!(s.byteLength!=a.byteLength||!x(new Ms(s),new Ms(a)));case cr:case dr:case pr:return Je(+s,+a);case gs:return s.name==a.name&&s.message==a.message;case gr:case mr:return s==a+"";case Ke:var k=Ll;case Ge:var T=p&b;if(k||(k=Ss),s.size!=a.size&&!T)return!1;var _=O.get(s);if(_)return _==a;p|=S,O.set(s,a);var E=ju(k(s),k(a),p,w,x,O);return O.delete(s),E;case ws:if(kr)return kr.call(s)==kr.call(a)}return!1}function jw(s,a,u,p,w,x){var O=u&b,k=la(s),T=k.length,_=la(a),E=_.length;if(T!=E&&!O)return!1;for(var L=T;L--;){var z=k[L];if(!(O?z in a:wt.call(a,z)))return!1}var q=x.get(s),K=x.get(a);if(q&&K)return q==a&&K==s;var nt=!0;x.set(s,a),x.set(a,s);for(var G=O;++L<T;){z=k[L];var lt=s[z],ut=a[z];if(p)var Ce=O?p(ut,lt,z,a,s,x):p(lt,ut,z,s,a,x);if(!(Ce===e?lt===ut||w(lt,ut,u,p,x):Ce)){nt=!1;break}G||(G=z=="constructor")}if(nt&&!G){var re=s.constructor,Ae=a.constructor;re!=Ae&&"constructor"in s&&"constructor"in a&&!(typeof re=="function"&&re instanceof re&&typeof Ae=="function"&&Ae instanceof Ae)&&(nt=!1)}return x.delete(s),x.delete(a),nt}function Ei(s){return ga(rc(s,e,dc),s+"")}function la(s){return yu(s,qt,ua)}function aa(s){return yu(s,de,Ju)}var ha=Bs?function(s){return Bs.get(s)}:Pa;function Ks(s){for(var a=s.name+"",u=Wn[a],p=wt.call(Wn,a)?u.length:0;p--;){var w=u[p],x=w.func;if(x==null||x==s)return w.name}return a}function Vn(s){var a=wt.call(v,"placeholder")?v:s;return a.placeholder}function Y(){var s=v.iteratee||Aa;return s=s===Aa?bu:s,arguments.length?s(arguments[0],arguments[1]):s}function Gs(s,a){var u=s.__data__;return oy(a)?u[typeof a=="string"?"string":"hash"]:u.map}function fa(s){for(var a=qt(s),u=a.length;u--;){var p=a[u],w=s[p];a[u]=[p,w,ic(w)]}return a}function yn(s,a){var u=h1(s,a);return xu(u)?u:e}function Jw(s){var a=wt.call(s,dn),u=s[dn];try{s[dn]=e;var p=!0}catch{}var w=Ts.call(s);return p&&(a?s[dn]=u:delete s[dn]),w}var ua=$l?function(s){return s==null?[]:(s=yt(s),Qi($l(s),function(a){return su.call(s,a)}))}:Ma,Ju=$l?function(s){for(var a=[];s;)Ui(a,ua(s)),s=Rs(s);return a}:Ma,Jt=ie;(Wl&&Jt(new Wl(new ArrayBuffer(1)))!=_n||br&&Jt(new br)!=Ke||Fl&&Jt(Fl.resolve())!=gf||$n&&Jt(new $n)!=Ge||Or&&Jt(new Or)!=wr)&&(Jt=function(s){var a=ie(s),u=a==Ti?s.constructor:e,p=u?vn(u):"";if(p)switch(p){case B1:return _n;case L1:return Ke;case N1:return gf;case $1:return Ge;case W1:return wr}return a});function ty(s,a,u){for(var p=-1,w=u.length;++p<w;){var x=u[p],O=x.size;switch(x.type){case"drop":s+=O;break;case"dropRight":a-=O;break;case"take":a=jt(a,s+O);break;case"takeRight":s=Ht(s,a-O);break}}return{start:s,end:a}}function ey(s){var a=s.match(l0);return a?a[1].split(a0):[]}function tc(s,a,u){a=Gi(a,s);for(var p=-1,w=a.length,x=!1;++p<w;){var O=hi(a[p]);if(!(x=s!=null&&u(s,O)))break;s=s[O]}return x||++p!=w?x:(w=s==null?0:s.length,!!w&&no(w)&&Di(O,w)&&(tt(s)||xn(s)))}function iy(s){var a=s.length,u=new s.constructor(a);return a&&typeof s[0]=="string"&&wt.call(s,"index")&&(u.index=s.index,u.input=s.input),u}function ec(s){return typeof s.constructor=="function"&&!_r(s)?Fn(Rs(s)):{}}function ny(s,a,u){var p=s.constructor;switch(a){case yr:return ra(s);case cr:case dr:return new p(+s);case _n:return Fw(s,u);case fl:case ul:case cl:case dl:case pl:case gl:case ml:case wl:case yl:return Nu(s,u);case Ke:return new p;case pr:case mr:return new p(s);case gr:return Hw(s);case Ge:return new p;case ws:return zw(s)}}function ry(s,a){var u=a.length;if(!u)return s;var p=u-1;return a[p]=(u>1?"& ":"")+a[p],a=a.join(u>2?", ":" "),s.replace(o0,`{
/* [wrapped with `+a+`] */
`)}function sy(s){return tt(s)||xn(s)||!!(ou&&s&&s[ou])}function Di(s,a){var u=typeof s;return a=a??Ye,!!a&&(u=="number"||u!="symbol"&&w0.test(s))&&s>-1&&s%1==0&&s<a}function ne(s,a,u){if(!Rt(u))return!1;var p=typeof a;return(p=="number"?ce(u)&&Di(a,u.length):p=="string"&&a in u)?Je(u[a],s):!1}function ca(s,a){if(tt(s))return!1;var u=typeof s;return u=="number"||u=="symbol"||u=="boolean"||s==null||ke(s)?!0:i0.test(s)||!e0.test(s)||a!=null&&s in yt(a)}function oy(s){var a=typeof s;return a=="string"||a=="number"||a=="symbol"||a=="boolean"?s!=="__proto__":s===null}function da(s){var a=Ks(s),u=v[a];if(typeof u!="function"||!(a in ht.prototype))return!1;if(s===u)return!0;var p=ha(u);return!!p&&s===p[0]}function ly(s){return!!iu&&iu in s}var ay=Cs?Ii:Ra;function _r(s){var a=s&&s.constructor,u=typeof a=="function"&&a.prototype||Nn;return s===u}function ic(s){return s===s&&!Rt(s)}function nc(s,a){return function(u){return u==null?!1:u[s]===a&&(a!==e||s in yt(u))}}function hy(s){var a=eo(s,function(p){return u.size===c&&u.clear(),p}),u=a.cache;return a}function fy(s,a){var u=s[1],p=a[1],w=u|p,x=w<(A|P|F),O=p==F&&u==N||p==F&&u==et&&s[7].length<=a[8]||p==(F|et)&&a[7].length<=a[8]&&u==N;if(!(x||O))return s;p&A&&(s[2]=a[2],w|=u&A?0:B);var k=a[3];if(k){var T=s[3];s[3]=T?Wu(T,k,a[4]):k,s[4]=T?qi(s[3],d):a[4]}return k=a[5],k&&(T=s[5],s[5]=T?Fu(T,k,a[6]):k,s[6]=T?qi(s[5],d):a[6]),k=a[7],k&&(s[7]=k),p&F&&(s[8]=s[8]==null?a[8]:jt(s[8],a[8])),s[9]==null&&(s[9]=a[9]),s[0]=a[0],s[1]=w,s}function uy(s){var a=[];if(s!=null)for(var u in yt(s))a.push(u);return a}function cy(s){return Ts.call(s)}function rc(s,a,u){return a=Ht(a===e?s.length-1:a,0),function(){for(var p=arguments,w=-1,x=Ht(p.length-a,0),O=M(x);++w<x;)O[w]=p[a+w];w=-1;for(var k=M(a+1);++w<a;)k[w]=p[w];return k[a]=u(O),be(s,this,k)}}function sc(s,a){return a.length<2?s:wn(s,Ne(a,0,-1))}function dy(s,a){for(var u=s.length,p=jt(a.length,u),w=ue(s);p--;){var x=a[p];s[p]=Di(x,u)?w[x]:e}return s}function pa(s,a){if(!(a==="constructor"&&typeof s[a]=="function")&&a!="__proto__")return s[a]}var oc=ac(Mu),Er=P1||function(s,a){return Yt.setTimeout(s,a)},ga=ac(Lw);function lc(s,a,u){var p=a+"";return ga(s,ry(p,py(ey(p),u)))}function ac(s){var a=0,u=0;return function(){var p=E1(),w=Ot-(p-u);if(u=p,w>0){if(++a>=j)return arguments[0]}else a=0;return s.apply(e,arguments)}}function Zs(s,a){var u=-1,p=s.length,w=p-1;for(a=a===e?p:a;++u<a;){var x=Zl(u,w),O=s[x];s[x]=s[u],s[u]=O}return s.length=a,s}var hc=hy(function(s){var a=[];return s.charCodeAt(0)===46&&a.push(""),s.replace(n0,function(u,p,w,x){a.push(w?x.replace(u0,"$1"):p||u)}),a});function hi(s){if(typeof s=="string"||ke(s))return s;var a=s+"";return a=="0"&&1/s==-1/0?"-0":a}function vn(s){if(s!=null){try{return As.call(s)}catch{}try{return s+""}catch{}}return""}function py(s,a){return De(Ci,function(u){var p="_."+u[0];a&u[1]&&!bs(s,p)&&s.push(p)}),s.sort()}function fc(s){if(s instanceof ht)return s.clone();var a=new Be(s.__wrapped__,s.__chain__);return a.__actions__=ue(s.__actions__),a.__index__=s.__index__,a.__values__=s.__values__,a}function gy(s,a,u){(u?ne(s,a,u):a===e)?a=1:a=Ht(it(a),0);var p=s==null?0:s.length;if(!p||a<1)return[];for(var w=0,x=0,O=M(Ds(p/a));w<p;)O[x++]=Ne(s,w,w+=a);return O}function my(s){for(var a=-1,u=s==null?0:s.length,p=0,w=[];++a<u;){var x=s[a];x&&(w[p++]=x)}return w}function wy(){var s=arguments.length;if(!s)return[];for(var a=M(s-1),u=arguments[0],p=s;p--;)a[p-1]=arguments[p];return Ui(tt(u)?ue(u):[u],Kt(a,1))}var yy=rt(function(s,a){return Dt(s)?Ar(s,Kt(a,1,Dt,!0)):[]}),vy=rt(function(s,a){var u=$e(a);return Dt(u)&&(u=e),Dt(s)?Ar(s,Kt(a,1,Dt,!0),Y(u,2)):[]}),xy=rt(function(s,a){var u=$e(a);return Dt(u)&&(u=e),Dt(s)?Ar(s,Kt(a,1,Dt,!0),e,u):[]});function by(s,a,u){var p=s==null?0:s.length;return p?(a=u||a===e?1:it(a),Ne(s,a<0?0:a,p)):[]}function Oy(s,a,u){var p=s==null?0:s.length;return p?(a=u||a===e?1:it(a),a=p-a,Ne(s,0,a<0?0:a)):[]}function Sy(s,a){return s&&s.length?Vs(s,Y(a,3),!0,!0):[]}function ky(s,a){return s&&s.length?Vs(s,Y(a,3),!0):[]}function Cy(s,a,u,p){var w=s==null?0:s.length;return w?(u&&typeof u!="number"&&ne(s,a,u)&&(u=0,p=w),ww(s,a,u,p)):[]}function uc(s,a,u){var p=s==null?0:s.length;if(!p)return-1;var w=u==null?0:it(u);return w<0&&(w=Ht(p+w,0)),Os(s,Y(a,3),w)}function cc(s,a,u){var p=s==null?0:s.length;if(!p)return-1;var w=p-1;return u!==e&&(w=it(u),w=u<0?Ht(p+w,0):jt(w,p-1)),Os(s,Y(a,3),w,!0)}function dc(s){var a=s==null?0:s.length;return a?Kt(s,1):[]}function Ay(s){var a=s==null?0:s.length;return a?Kt(s,oi):[]}function Ty(s,a){var u=s==null?0:s.length;return u?(a=a===e?1:it(a),Kt(s,a)):[]}function Py(s){for(var a=-1,u=s==null?0:s.length,p={};++a<u;){var w=s[a];p[w[0]]=w[1]}return p}function pc(s){return s&&s.length?s[0]:e}function My(s,a,u){var p=s==null?0:s.length;if(!p)return-1;var w=u==null?0:it(u);return w<0&&(w=Ht(p+w,0)),Dn(s,a,w)}function Ry(s){var a=s==null?0:s.length;return a?Ne(s,0,-1):[]}var _y=rt(function(s){var a=Pt(s,ia);return a.length&&a[0]===s[0]?ql(a):[]}),Ey=rt(function(s){var a=$e(s),u=Pt(s,ia);return a===$e(u)?a=e:u.pop(),u.length&&u[0]===s[0]?ql(u,Y(a,2)):[]}),Dy=rt(function(s){var a=$e(s),u=Pt(s,ia);return a=typeof a=="function"?a:e,a&&u.pop(),u.length&&u[0]===s[0]?ql(u,e,a):[]});function Iy(s,a){return s==null?"":R1.call(s,a)}function $e(s){var a=s==null?0:s.length;return a?s[a-1]:e}function By(s,a,u){var p=s==null?0:s.length;if(!p)return-1;var w=p;return u!==e&&(w=it(u),w=w<0?Ht(p+w,0):jt(w,p-1)),a===a?p1(s,a,w):Os(s,Yf,w,!0)}function Ly(s,a){return s&&s.length?Cu(s,it(a)):e}var Ny=rt(gc);function gc(s,a){return s&&s.length&&a&&a.length?Gl(s,a):s}function $y(s,a,u){return s&&s.length&&a&&a.length?Gl(s,a,Y(u,2)):s}function Wy(s,a,u){return s&&s.length&&a&&a.length?Gl(s,a,e,u):s}var Fy=Ei(function(s,a){var u=s==null?0:s.length,p=zl(s,a);return Pu(s,Pt(a,function(w){return Di(w,u)?+w:w}).sort($u)),p});function Hy(s,a){var u=[];if(!(s&&s.length))return u;var p=-1,w=[],x=s.length;for(a=Y(a,3);++p<x;){var O=s[p];a(O,p,s)&&(u.push(O),w.push(p))}return Pu(s,w),u}function ma(s){return s==null?s:I1.call(s)}function zy(s,a,u){var p=s==null?0:s.length;return p?(u&&typeof u!="number"&&ne(s,a,u)?(a=0,u=p):(a=a==null?0:it(a),u=u===e?p:it(u)),Ne(s,a,u)):[]}function Vy(s,a){return zs(s,a)}function Qy(s,a,u){return Jl(s,a,Y(u,2))}function Uy(s,a){var u=s==null?0:s.length;if(u){var p=zs(s,a);if(p<u&&Je(s[p],a))return p}return-1}function qy(s,a){return zs(s,a,!0)}function Xy(s,a,u){return Jl(s,a,Y(u,2),!0)}function Yy(s,a){var u=s==null?0:s.length;if(u){var p=zs(s,a,!0)-1;if(Je(s[p],a))return p}return-1}function Ky(s){return s&&s.length?Ru(s):[]}function Gy(s,a){return s&&s.length?Ru(s,Y(a,2)):[]}function Zy(s){var a=s==null?0:s.length;return a?Ne(s,1,a):[]}function jy(s,a,u){return s&&s.length?(a=u||a===e?1:it(a),Ne(s,0,a<0?0:a)):[]}function Jy(s,a,u){var p=s==null?0:s.length;return p?(a=u||a===e?1:it(a),a=p-a,Ne(s,a<0?0:a,p)):[]}function tv(s,a){return s&&s.length?Vs(s,Y(a,3),!1,!0):[]}function ev(s,a){return s&&s.length?Vs(s,Y(a,3)):[]}var iv=rt(function(s){return Ki(Kt(s,1,Dt,!0))}),nv=rt(function(s){var a=$e(s);return Dt(a)&&(a=e),Ki(Kt(s,1,Dt,!0),Y(a,2))}),rv=rt(function(s){var a=$e(s);return a=typeof a=="function"?a:e,Ki(Kt(s,1,Dt,!0),e,a)});function sv(s){return s&&s.length?Ki(s):[]}function ov(s,a){return s&&s.length?Ki(s,Y(a,2)):[]}function lv(s,a){return a=typeof a=="function"?a:e,s&&s.length?Ki(s,e,a):[]}function wa(s){if(!(s&&s.length))return[];var a=0;return s=Qi(s,function(u){if(Dt(u))return a=Ht(u.length,a),!0}),Il(a,function(u){return Pt(s,_l(u))})}function mc(s,a){if(!(s&&s.length))return[];var u=wa(s);return a==null?u:Pt(u,function(p){return be(a,e,p)})}var av=rt(function(s,a){return Dt(s)?Ar(s,a):[]}),hv=rt(function(s){return ea(Qi(s,Dt))}),fv=rt(function(s){var a=$e(s);return Dt(a)&&(a=e),ea(Qi(s,Dt),Y(a,2))}),uv=rt(function(s){var a=$e(s);return a=typeof a=="function"?a:e,ea(Qi(s,Dt),e,a)}),cv=rt(wa);function dv(s,a){return Iu(s||[],a||[],Cr)}function pv(s,a){return Iu(s||[],a||[],Mr)}var gv=rt(function(s){var a=s.length,u=a>1?s[a-1]:e;return u=typeof u=="function"?(s.pop(),u):e,mc(s,u)});function wc(s){var a=v(s);return a.__chain__=!0,a}function mv(s,a){return a(s),s}function js(s,a){return a(s)}var wv=Ei(function(s){var a=s.length,u=a?s[0]:0,p=this.__wrapped__,w=function(x){return zl(x,s)};return a>1||this.__actions__.length||!(p instanceof ht)||!Di(u)?this.thru(w):(p=p.slice(u,+u+(a?1:0)),p.__actions__.push({func:js,args:[w],thisArg:e}),new Be(p,this.__chain__).thru(function(x){return a&&!x.length&&x.push(e),x}))});function yv(){return wc(this)}function vv(){return new Be(this.value(),this.__chain__)}function xv(){this.__values__===e&&(this.__values__=_c(this.value()));var s=this.__index__>=this.__values__.length,a=s?e:this.__values__[this.__index__++];return{done:s,value:a}}function bv(){return this}function Ov(s){for(var a,u=this;u instanceof Ns;){var p=fc(u);p.__index__=0,p.__values__=e,a?w.__wrapped__=p:a=p;var w=p;u=u.__wrapped__}return w.__wrapped__=s,a}function Sv(){var s=this.__wrapped__;if(s instanceof ht){var a=s;return this.__actions__.length&&(a=new ht(this)),a=a.reverse(),a.__actions__.push({func:js,args:[ma],thisArg:e}),new Be(a,this.__chain__)}return this.thru(ma)}function kv(){return Du(this.__wrapped__,this.__actions__)}var Cv=Qs(function(s,a,u){wt.call(s,u)?++s[u]:Ri(s,u,1)});function Av(s,a,u){var p=tt(s)?qf:mw;return u&&ne(s,a,u)&&(a=e),p(s,Y(a,3))}function Tv(s,a){var u=tt(s)?Qi:mu;return u(s,Y(a,3))}var Pv=Qu(uc),Mv=Qu(cc);function Rv(s,a){return Kt(Js(s,a),1)}function _v(s,a){return Kt(Js(s,a),oi)}function Ev(s,a,u){return u=u===e?1:it(u),Kt(Js(s,a),u)}function yc(s,a){var u=tt(s)?De:Yi;return u(s,Y(a,3))}function vc(s,a){var u=tt(s)?Z0:gu;return u(s,Y(a,3))}var Dv=Qs(function(s,a,u){wt.call(s,u)?s[u].push(a):Ri(s,u,[a])});function Iv(s,a,u,p){s=ce(s)?s:Un(s),u=u&&!p?it(u):0;var w=s.length;return u<0&&(u=Ht(w+u,0)),ro(s)?u<=w&&s.indexOf(a,u)>-1:!!w&&Dn(s,a,u)>-1}var Bv=rt(function(s,a,u){var p=-1,w=typeof a=="function",x=ce(s)?M(s.length):[];return Yi(s,function(O){x[++p]=w?be(a,O,u):Tr(O,a,u)}),x}),Lv=Qs(function(s,a,u){Ri(s,u,a)});function Js(s,a){var u=tt(s)?Pt:Ou;return u(s,Y(a,3))}function Nv(s,a,u,p){return s==null?[]:(tt(a)||(a=a==null?[]:[a]),u=p?e:u,tt(u)||(u=u==null?[]:[u]),Au(s,a,u))}var $v=Qs(function(s,a,u){s[u?0:1].push(a)},function(){return[[],[]]});function Wv(s,a,u){var p=tt(s)?Ml:Gf,w=arguments.length<3;return p(s,Y(a,4),u,w,Yi)}function Fv(s,a,u){var p=tt(s)?j0:Gf,w=arguments.length<3;return p(s,Y(a,4),u,w,gu)}function Hv(s,a){var u=tt(s)?Qi:mu;return u(s,io(Y(a,3)))}function zv(s){var a=tt(s)?uu:Iw;return a(s)}function Vv(s,a,u){(u?ne(s,a,u):a===e)?a=1:a=it(a);var p=tt(s)?uw:Bw;return p(s,a)}function Qv(s){var a=tt(s)?cw:Nw;return a(s)}function Uv(s){if(s==null)return 0;if(ce(s))return ro(s)?Bn(s):s.length;var a=Jt(s);return a==Ke||a==Ge?s.size:Yl(s).length}function qv(s,a,u){var p=tt(s)?Rl:$w;return u&&ne(s,a,u)&&(a=e),p(s,Y(a,3))}var Xv=rt(function(s,a){if(s==null)return[];var u=a.length;return u>1&&ne(s,a[0],a[1])?a=[]:u>2&&ne(a[0],a[1],a[2])&&(a=[a[0]]),Au(s,Kt(a,1),[])}),to=T1||function(){return Yt.Date.now()};function Yv(s,a){if(typeof a!="function")throw new Ie(l);return s=it(s),function(){if(--s<1)return a.apply(this,arguments)}}function xc(s,a,u){return a=u?e:a,a=s&&a==null?s.length:a,_i(s,F,e,e,e,e,a)}function bc(s,a){var u;if(typeof a!="function")throw new Ie(l);return s=it(s),function(){return--s>0&&(u=a.apply(this,arguments)),s<=1&&(a=e),u}}var ya=rt(function(s,a,u){var p=A;if(u.length){var w=qi(u,Vn(ya));p|=$}return _i(s,p,a,u,w)}),Oc=rt(function(s,a,u){var p=A|P;if(u.length){var w=qi(u,Vn(Oc));p|=$}return _i(a,p,s,u,w)});function Sc(s,a,u){a=u?e:a;var p=_i(s,N,e,e,e,e,e,a);return p.placeholder=Sc.placeholder,p}function kc(s,a,u){a=u?e:a;var p=_i(s,D,e,e,e,e,e,a);return p.placeholder=kc.placeholder,p}function Cc(s,a,u){var p,w,x,O,k,T,_=0,E=!1,L=!1,z=!0;if(typeof s!="function")throw new Ie(l);a=We(a)||0,Rt(u)&&(E=!!u.leading,L="maxWait"in u,x=L?Ht(We(u.maxWait)||0,a):x,z="trailing"in u?!!u.trailing:z);function q(It){var ti=p,Li=w;return p=w=e,_=It,O=s.apply(Li,ti),O}function K(It){return _=It,k=Er(lt,a),E?q(It):O}function nt(It){var ti=It-T,Li=It-_,Qc=a-ti;return L?jt(Qc,x-Li):Qc}function G(It){var ti=It-T,Li=It-_;return T===e||ti>=a||ti<0||L&&Li>=x}function lt(){var It=to();if(G(It))return ut(It);k=Er(lt,nt(It))}function ut(It){return k=e,z&&p?q(It):(p=w=e,O)}function Ce(){k!==e&&Bu(k),_=0,p=T=w=k=e}function re(){return k===e?O:ut(to())}function Ae(){var It=to(),ti=G(It);if(p=arguments,w=this,T=It,ti){if(k===e)return K(T);if(L)return Bu(k),k=Er(lt,a),q(T)}return k===e&&(k=Er(lt,a)),O}return Ae.cancel=Ce,Ae.flush=re,Ae}var Kv=rt(function(s,a){return pu(s,1,a)}),Gv=rt(function(s,a,u){return pu(s,We(a)||0,u)});function Zv(s){return _i(s,st)}function eo(s,a){if(typeof s!="function"||a!=null&&typeof a!="function")throw new Ie(l);var u=function(){var p=arguments,w=a?a.apply(this,p):p[0],x=u.cache;if(x.has(w))return x.get(w);var O=s.apply(this,p);return u.cache=x.set(w,O)||x,O};return u.cache=new(eo.Cache||Mi),u}eo.Cache=Mi;function io(s){if(typeof s!="function")throw new Ie(l);return function(){var a=arguments;switch(a.length){case 0:return!s.call(this);case 1:return!s.call(this,a[0]);case 2:return!s.call(this,a[0],a[1]);case 3:return!s.call(this,a[0],a[1],a[2])}return!s.apply(this,a)}}function jv(s){return bc(2,s)}var Jv=Ww(function(s,a){a=a.length==1&&tt(a[0])?Pt(a[0],Oe(Y())):Pt(Kt(a,1),Oe(Y()));var u=a.length;return rt(function(p){for(var w=-1,x=jt(p.length,u);++w<x;)p[w]=a[w].call(this,p[w]);return be(s,this,p)})}),va=rt(function(s,a){var u=qi(a,Vn(va));return _i(s,$,e,a,u)}),Ac=rt(function(s,a){var u=qi(a,Vn(Ac));return _i(s,W,e,a,u)}),tx=Ei(function(s,a){return _i(s,et,e,e,e,a)});function ex(s,a){if(typeof s!="function")throw new Ie(l);return a=a===e?a:it(a),rt(s,a)}function ix(s,a){if(typeof s!="function")throw new Ie(l);return a=a==null?0:Ht(it(a),0),rt(function(u){var p=u[a],w=Zi(u,0,a);return p&&Ui(w,p),be(s,this,w)})}function nx(s,a,u){var p=!0,w=!0;if(typeof s!="function")throw new Ie(l);return Rt(u)&&(p="leading"in u?!!u.leading:p,w="trailing"in u?!!u.trailing:w),Cc(s,a,{leading:p,maxWait:a,trailing:w})}function rx(s){return xc(s,1)}function sx(s,a){return va(na(a),s)}function ox(){if(!arguments.length)return[];var s=arguments[0];return tt(s)?s:[s]}function lx(s){return Le(s,y)}function ax(s,a){return a=typeof a=="function"?a:e,Le(s,y,a)}function hx(s){return Le(s,g|y)}function fx(s,a){return a=typeof a=="function"?a:e,Le(s,g|y,a)}function ux(s,a){return a==null||du(s,a,qt(a))}function Je(s,a){return s===a||s!==s&&a!==a}var cx=Ys(Ul),dx=Ys(function(s,a){return s>=a}),xn=vu(function(){return arguments}())?vu:function(s){return Et(s)&&wt.call(s,"callee")&&!su.call(s,"callee")},tt=M.isArray,px=Ff?Oe(Ff):Ow;function ce(s){return s!=null&&no(s.length)&&!Ii(s)}function Dt(s){return Et(s)&&ce(s)}function gx(s){return s===!0||s===!1||Et(s)&&ie(s)==cr}var ji=M1||Ra,mx=Hf?Oe(Hf):Sw;function wx(s){return Et(s)&&s.nodeType===1&&!Dr(s)}function yx(s){if(s==null)return!0;if(ce(s)&&(tt(s)||typeof s=="string"||typeof s.splice=="function"||ji(s)||Qn(s)||xn(s)))return!s.length;var a=Jt(s);if(a==Ke||a==Ge)return!s.size;if(_r(s))return!Yl(s).length;for(var u in s)if(wt.call(s,u))return!1;return!0}function vx(s,a){return Pr(s,a)}function xx(s,a,u){u=typeof u=="function"?u:e;var p=u?u(s,a):e;return p===e?Pr(s,a,e,u):!!p}function xa(s){if(!Et(s))return!1;var a=ie(s);return a==gs||a==Vm||typeof s.message=="string"&&typeof s.name=="string"&&!Dr(s)}function bx(s){return typeof s=="number"&&lu(s)}function Ii(s){if(!Rt(s))return!1;var a=ie(s);return a==ms||a==pf||a==ps||a==Um}function Tc(s){return typeof s=="number"&&s==it(s)}function no(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=Ye}function Rt(s){var a=typeof s;return s!=null&&(a=="object"||a=="function")}function Et(s){return s!=null&&typeof s=="object"}var Pc=zf?Oe(zf):Cw;function Ox(s,a){return s===a||Xl(s,a,fa(a))}function Sx(s,a,u){return u=typeof u=="function"?u:e,Xl(s,a,fa(a),u)}function kx(s){return Mc(s)&&s!=+s}function Cx(s){if(ay(s))throw new J(o);return xu(s)}function Ax(s){return s===null}function Tx(s){return s==null}function Mc(s){return typeof s=="number"||Et(s)&&ie(s)==pr}function Dr(s){if(!Et(s)||ie(s)!=Ti)return!1;var a=Rs(s);if(a===null)return!0;var u=wt.call(a,"constructor")&&a.constructor;return typeof u=="function"&&u instanceof u&&As.call(u)==S1}var ba=Vf?Oe(Vf):Aw;function Px(s){return Tc(s)&&s>=-9007199254740991&&s<=Ye}var Rc=Qf?Oe(Qf):Tw;function ro(s){return typeof s=="string"||!tt(s)&&Et(s)&&ie(s)==mr}function ke(s){return typeof s=="symbol"||Et(s)&&ie(s)==ws}var Qn=Uf?Oe(Uf):Pw;function Mx(s){return s===e}function Rx(s){return Et(s)&&Jt(s)==wr}function _x(s){return Et(s)&&ie(s)==Xm}var Ex=Ys(Kl),Dx=Ys(function(s,a){return s<=a});function _c(s){if(!s)return[];if(ce(s))return ro(s)?Ze(s):ue(s);if(xr&&s[xr])return u1(s[xr]());var a=Jt(s),u=a==Ke?Ll:a==Ge?Ss:Un;return u(s)}function Bi(s){if(!s)return s===0?s:0;if(s=We(s),s===oi||s===-1/0){var a=s<0?-1:1;return a*ki}return s===s?s:0}function it(s){var a=Bi(s),u=a%1;return a===a?u?a-u:a:0}function Ec(s){return s?mn(it(s),0,Lt):0}function We(s){if(typeof s=="number")return s;if(ke(s))return un;if(Rt(s)){var a=typeof s.valueOf=="function"?s.valueOf():s;s=Rt(a)?a+"":a}if(typeof s!="string")return s===0?s:+s;s=Zf(s);var u=p0.test(s);return u||m0.test(s)?Y0(s.slice(2),u?2:8):d0.test(s)?un:+s}function Dc(s){return ai(s,de(s))}function Ix(s){return s?mn(it(s),-9007199254740991,Ye):s===0?s:0}function gt(s){return s==null?"":Se(s)}var Bx=Hn(function(s,a){if(_r(a)||ce(a)){ai(a,qt(a),s);return}for(var u in a)wt.call(a,u)&&Cr(s,u,a[u])}),Ic=Hn(function(s,a){ai(a,de(a),s)}),so=Hn(function(s,a,u,p){ai(a,de(a),s,p)}),Lx=Hn(function(s,a,u,p){ai(a,qt(a),s,p)}),Nx=Ei(zl);function $x(s,a){var u=Fn(s);return a==null?u:cu(u,a)}var Wx=rt(function(s,a){s=yt(s);var u=-1,p=a.length,w=p>2?a[2]:e;for(w&&ne(a[0],a[1],w)&&(p=1);++u<p;)for(var x=a[u],O=de(x),k=-1,T=O.length;++k<T;){var _=O[k],E=s[_];(E===e||Je(E,Nn[_])&&!wt.call(s,_))&&(s[_]=x[_])}return s}),Fx=rt(function(s){return s.push(e,Zu),be(Bc,e,s)});function Hx(s,a){return Xf(s,Y(a,3),li)}function zx(s,a){return Xf(s,Y(a,3),Ql)}function Vx(s,a){return s==null?s:Vl(s,Y(a,3),de)}function Qx(s,a){return s==null?s:wu(s,Y(a,3),de)}function Ux(s,a){return s&&li(s,Y(a,3))}function qx(s,a){return s&&Ql(s,Y(a,3))}function Xx(s){return s==null?[]:Fs(s,qt(s))}function Yx(s){return s==null?[]:Fs(s,de(s))}function Oa(s,a,u){var p=s==null?e:wn(s,a);return p===e?u:p}function Kx(s,a){return s!=null&&tc(s,a,yw)}function Sa(s,a){return s!=null&&tc(s,a,vw)}var Gx=qu(function(s,a,u){a!=null&&typeof a.toString!="function"&&(a=Ts.call(a)),s[a]=u},Ca(pe)),Zx=qu(function(s,a,u){a!=null&&typeof a.toString!="function"&&(a=Ts.call(a)),wt.call(s,a)?s[a].push(u):s[a]=[u]},Y),jx=rt(Tr);function qt(s){return ce(s)?fu(s):Yl(s)}function de(s){return ce(s)?fu(s,!0):Mw(s)}function Jx(s,a){var u={};return a=Y(a,3),li(s,function(p,w,x){Ri(u,a(p,w,x),p)}),u}function tb(s,a){var u={};return a=Y(a,3),li(s,function(p,w,x){Ri(u,w,a(p,w,x))}),u}var eb=Hn(function(s,a,u){Hs(s,a,u)}),Bc=Hn(function(s,a,u,p){Hs(s,a,u,p)}),ib=Ei(function(s,a){var u={};if(s==null)return u;var p=!1;a=Pt(a,function(x){return x=Gi(x,s),p||(p=x.length>1),x}),ai(s,aa(s),u),p&&(u=Le(u,g|m|y,Gw));for(var w=a.length;w--;)ta(u,a[w]);return u});function nb(s,a){return Lc(s,io(Y(a)))}var rb=Ei(function(s,a){return s==null?{}:_w(s,a)});function Lc(s,a){if(s==null)return{};var u=Pt(aa(s),function(p){return[p]});return a=Y(a),Tu(s,u,function(p,w){return a(p,w[0])})}function sb(s,a,u){a=Gi(a,s);var p=-1,w=a.length;for(w||(w=1,s=e);++p<w;){var x=s==null?e:s[hi(a[p])];x===e&&(p=w,x=u),s=Ii(x)?x.call(s):x}return s}function ob(s,a,u){return s==null?s:Mr(s,a,u)}function lb(s,a,u,p){return p=typeof p=="function"?p:e,s==null?s:Mr(s,a,u,p)}var Nc=Ku(qt),$c=Ku(de);function ab(s,a,u){var p=tt(s),w=p||ji(s)||Qn(s);if(a=Y(a,4),u==null){var x=s&&s.constructor;w?u=p?new x:[]:Rt(s)?u=Ii(x)?Fn(Rs(s)):{}:u={}}return(w?De:li)(s,function(O,k,T){return a(u,O,k,T)}),u}function hb(s,a){return s==null?!0:ta(s,a)}function fb(s,a,u){return s==null?s:Eu(s,a,na(u))}function ub(s,a,u,p){return p=typeof p=="function"?p:e,s==null?s:Eu(s,a,na(u),p)}function Un(s){return s==null?[]:Bl(s,qt(s))}function cb(s){return s==null?[]:Bl(s,de(s))}function db(s,a,u){return u===e&&(u=a,a=e),u!==e&&(u=We(u),u=u===u?u:0),a!==e&&(a=We(a),a=a===a?a:0),mn(We(s),a,u)}function pb(s,a,u){return a=Bi(a),u===e?(u=a,a=0):u=Bi(u),s=We(s),xw(s,a,u)}function gb(s,a,u){if(u&&typeof u!="boolean"&&ne(s,a,u)&&(a=u=e),u===e&&(typeof a=="boolean"?(u=a,a=e):typeof s=="boolean"&&(u=s,s=e)),s===e&&a===e?(s=0,a=1):(s=Bi(s),a===e?(a=s,s=0):a=Bi(a)),s>a){var p=s;s=a,a=p}if(u||s%1||a%1){var w=au();return jt(s+w*(a-s+X0("1e-"+((w+"").length-1))),a)}return Zl(s,a)}var mb=zn(function(s,a,u){return a=a.toLowerCase(),s+(u?Wc(a):a)});function Wc(s){return ka(gt(s).toLowerCase())}function Fc(s){return s=gt(s),s&&s.replace(y0,o1).replace(N0,"")}function wb(s,a,u){s=gt(s),a=Se(a);var p=s.length;u=u===e?p:mn(it(u),0,p);var w=u;return u-=a.length,u>=0&&s.slice(u,w)==a}function yb(s){return s=gt(s),s&&jm.test(s)?s.replace(wf,l1):s}function vb(s){return s=gt(s),s&&r0.test(s)?s.replace(vl,"\\$&"):s}var xb=zn(function(s,a,u){return s+(u?"-":"")+a.toLowerCase()}),bb=zn(function(s,a,u){return s+(u?" ":"")+a.toLowerCase()}),Ob=Vu("toLowerCase");function Sb(s,a,u){s=gt(s),a=it(a);var p=a?Bn(s):0;if(!a||p>=a)return s;var w=(a-p)/2;return Xs(Is(w),u)+s+Xs(Ds(w),u)}function kb(s,a,u){s=gt(s),a=it(a);var p=a?Bn(s):0;return a&&p<a?s+Xs(a-p,u):s}function Cb(s,a,u){s=gt(s),a=it(a);var p=a?Bn(s):0;return a&&p<a?Xs(a-p,u)+s:s}function Ab(s,a,u){return u||a==null?a=0:a&&(a=+a),D1(gt(s).replace(xl,""),a||0)}function Tb(s,a,u){return(u?ne(s,a,u):a===e)?a=1:a=it(a),jl(gt(s),a)}function Pb(){var s=arguments,a=gt(s[0]);return s.length<3?a:a.replace(s[1],s[2])}var Mb=zn(function(s,a,u){return s+(u?"_":"")+a.toLowerCase()});function Rb(s,a,u){return u&&typeof u!="number"&&ne(s,a,u)&&(a=u=e),u=u===e?Lt:u>>>0,u?(s=gt(s),s&&(typeof a=="string"||a!=null&&!ba(a))&&(a=Se(a),!a&&In(s))?Zi(Ze(s),0,u):s.split(a,u)):[]}var _b=zn(function(s,a,u){return s+(u?" ":"")+ka(a)});function Eb(s,a,u){return s=gt(s),u=u==null?0:mn(it(u),0,s.length),a=Se(a),s.slice(u,u+a.length)==a}function Db(s,a,u){var p=v.templateSettings;u&&ne(s,a,u)&&(a=e),s=gt(s),a=so({},a,p,Gu);var w=so({},a.imports,p.imports,Gu),x=qt(w),O=Bl(w,x),k,T,_=0,E=a.interpolate||ys,L="__p += '",z=Nl((a.escape||ys).source+"|"+E.source+"|"+(E===yf?c0:ys).source+"|"+(a.evaluate||ys).source+"|$","g"),q="//# sourceURL="+(wt.call(a,"sourceURL")?(a.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++z0+"]")+`
`;s.replace(z,function(G,lt,ut,Ce,re,Ae){return ut||(ut=Ce),L+=s.slice(_,Ae).replace(v0,a1),lt&&(k=!0,L+=`' +
__e(`+lt+`) +
'`),re&&(T=!0,L+=`';
`+re+`;
__p += '`),ut&&(L+=`' +
((__t = (`+ut+`)) == null ? '' : __t) +
'`),_=Ae+G.length,G}),L+=`';
`;var K=wt.call(a,"variable")&&a.variable;if(!K)L=`with (obj) {
`+L+`
}
`;else if(f0.test(K))throw new J(h);L=(T?L.replace(Ym,""):L).replace(Km,"$1").replace(Gm,"$1;"),L="function("+(K||"obj")+`) {
`+(K?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(k?", __e = _.escape":"")+(T?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+L+`return __p
}`;var nt=zc(function(){return dt(x,q+"return "+L).apply(e,O)});if(nt.source=L,xa(nt))throw nt;return nt}function Ib(s){return gt(s).toLowerCase()}function Bb(s){return gt(s).toUpperCase()}function Lb(s,a,u){if(s=gt(s),s&&(u||a===e))return Zf(s);if(!s||!(a=Se(a)))return s;var p=Ze(s),w=Ze(a),x=jf(p,w),O=Jf(p,w)+1;return Zi(p,x,O).join("")}function Nb(s,a,u){if(s=gt(s),s&&(u||a===e))return s.slice(0,eu(s)+1);if(!s||!(a=Se(a)))return s;var p=Ze(s),w=Jf(p,Ze(a))+1;return Zi(p,0,w).join("")}function $b(s,a,u){if(s=gt(s),s&&(u||a===e))return s.replace(xl,"");if(!s||!(a=Se(a)))return s;var p=Ze(s),w=jf(p,Ze(a));return Zi(p,w).join("")}function Wb(s,a){var u=bt,p=at;if(Rt(a)){var w="separator"in a?a.separator:w;u="length"in a?it(a.length):u,p="omission"in a?Se(a.omission):p}s=gt(s);var x=s.length;if(In(s)){var O=Ze(s);x=O.length}if(u>=x)return s;var k=u-Bn(p);if(k<1)return p;var T=O?Zi(O,0,k).join(""):s.slice(0,k);if(w===e)return T+p;if(O&&(k+=T.length-k),ba(w)){if(s.slice(k).search(w)){var _,E=T;for(w.global||(w=Nl(w.source,gt(vf.exec(w))+"g")),w.lastIndex=0;_=w.exec(E);)var L=_.index;T=T.slice(0,L===e?k:L)}}else if(s.indexOf(Se(w),k)!=k){var z=T.lastIndexOf(w);z>-1&&(T=T.slice(0,z))}return T+p}function Fb(s){return s=gt(s),s&&Zm.test(s)?s.replace(mf,g1):s}var Hb=zn(function(s,a,u){return s+(u?" ":"")+a.toUpperCase()}),ka=Vu("toUpperCase");function Hc(s,a,u){return s=gt(s),a=u?e:a,a===e?f1(s)?y1(s):e1(s):s.match(a)||[]}var zc=rt(function(s,a){try{return be(s,e,a)}catch(u){return xa(u)?u:new J(u)}}),zb=Ei(function(s,a){return De(a,function(u){u=hi(u),Ri(s,u,ya(s[u],s))}),s});function Vb(s){var a=s==null?0:s.length,u=Y();return s=a?Pt(s,function(p){if(typeof p[1]!="function")throw new Ie(l);return[u(p[0]),p[1]]}):[],rt(function(p){for(var w=-1;++w<a;){var x=s[w];if(be(x[0],this,p))return be(x[1],this,p)}})}function Qb(s){return gw(Le(s,g))}function Ca(s){return function(){return s}}function Ub(s,a){return s==null||s!==s?a:s}var qb=Uu(),Xb=Uu(!0);function pe(s){return s}function Aa(s){return bu(typeof s=="function"?s:Le(s,g))}function Yb(s){return Su(Le(s,g))}function Kb(s,a){return ku(s,Le(a,g))}var Gb=rt(function(s,a){return function(u){return Tr(u,s,a)}}),Zb=rt(function(s,a){return function(u){return Tr(s,u,a)}});function Ta(s,a,u){var p=qt(a),w=Fs(a,p);u==null&&!(Rt(a)&&(w.length||!p.length))&&(u=a,a=s,s=this,w=Fs(a,qt(a)));var x=!(Rt(u)&&"chain"in u)||!!u.chain,O=Ii(s);return De(w,function(k){var T=a[k];s[k]=T,O&&(s.prototype[k]=function(){var _=this.__chain__;if(x||_){var E=s(this.__wrapped__),L=E.__actions__=ue(this.__actions__);return L.push({func:T,args:arguments,thisArg:s}),E.__chain__=_,E}return T.apply(s,Ui([this.value()],arguments))})}),s}function jb(){return Yt._===this&&(Yt._=k1),this}function Pa(){}function Jb(s){return s=it(s),rt(function(a){return Cu(a,s)})}var tO=sa(Pt),eO=sa(qf),iO=sa(Rl);function Vc(s){return ca(s)?_l(hi(s)):Ew(s)}function nO(s){return function(a){return s==null?e:wn(s,a)}}var rO=Xu(),sO=Xu(!0);function Ma(){return[]}function Ra(){return!1}function oO(){return{}}function lO(){return""}function aO(){return!0}function hO(s,a){if(s=it(s),s<1||s>Ye)return[];var u=Lt,p=jt(s,Lt);a=Y(a),s-=Lt;for(var w=Il(p,a);++u<s;)a(u);return w}function fO(s){return tt(s)?Pt(s,hi):ke(s)?[s]:ue(hc(gt(s)))}function uO(s){var a=++O1;return gt(s)+a}var cO=qs(function(s,a){return s+a},0),dO=oa("ceil"),pO=qs(function(s,a){return s/a},1),gO=oa("floor");function mO(s){return s&&s.length?Ws(s,pe,Ul):e}function wO(s,a){return s&&s.length?Ws(s,Y(a,2),Ul):e}function yO(s){return Kf(s,pe)}function vO(s,a){return Kf(s,Y(a,2))}function xO(s){return s&&s.length?Ws(s,pe,Kl):e}function bO(s,a){return s&&s.length?Ws(s,Y(a,2),Kl):e}var OO=qs(function(s,a){return s*a},1),SO=oa("round"),kO=qs(function(s,a){return s-a},0);function CO(s){return s&&s.length?Dl(s,pe):0}function AO(s,a){return s&&s.length?Dl(s,Y(a,2)):0}return v.after=Yv,v.ary=xc,v.assign=Bx,v.assignIn=Ic,v.assignInWith=so,v.assignWith=Lx,v.at=Nx,v.before=bc,v.bind=ya,v.bindAll=zb,v.bindKey=Oc,v.castArray=ox,v.chain=wc,v.chunk=gy,v.compact=my,v.concat=wy,v.cond=Vb,v.conforms=Qb,v.constant=Ca,v.countBy=Cv,v.create=$x,v.curry=Sc,v.curryRight=kc,v.debounce=Cc,v.defaults=Wx,v.defaultsDeep=Fx,v.defer=Kv,v.delay=Gv,v.difference=yy,v.differenceBy=vy,v.differenceWith=xy,v.drop=by,v.dropRight=Oy,v.dropRightWhile=Sy,v.dropWhile=ky,v.fill=Cy,v.filter=Tv,v.flatMap=Rv,v.flatMapDeep=_v,v.flatMapDepth=Ev,v.flatten=dc,v.flattenDeep=Ay,v.flattenDepth=Ty,v.flip=Zv,v.flow=qb,v.flowRight=Xb,v.fromPairs=Py,v.functions=Xx,v.functionsIn=Yx,v.groupBy=Dv,v.initial=Ry,v.intersection=_y,v.intersectionBy=Ey,v.intersectionWith=Dy,v.invert=Gx,v.invertBy=Zx,v.invokeMap=Bv,v.iteratee=Aa,v.keyBy=Lv,v.keys=qt,v.keysIn=de,v.map=Js,v.mapKeys=Jx,v.mapValues=tb,v.matches=Yb,v.matchesProperty=Kb,v.memoize=eo,v.merge=eb,v.mergeWith=Bc,v.method=Gb,v.methodOf=Zb,v.mixin=Ta,v.negate=io,v.nthArg=Jb,v.omit=ib,v.omitBy=nb,v.once=jv,v.orderBy=Nv,v.over=tO,v.overArgs=Jv,v.overEvery=eO,v.overSome=iO,v.partial=va,v.partialRight=Ac,v.partition=$v,v.pick=rb,v.pickBy=Lc,v.property=Vc,v.propertyOf=nO,v.pull=Ny,v.pullAll=gc,v.pullAllBy=$y,v.pullAllWith=Wy,v.pullAt=Fy,v.range=rO,v.rangeRight=sO,v.rearg=tx,v.reject=Hv,v.remove=Hy,v.rest=ex,v.reverse=ma,v.sampleSize=Vv,v.set=ob,v.setWith=lb,v.shuffle=Qv,v.slice=zy,v.sortBy=Xv,v.sortedUniq=Ky,v.sortedUniqBy=Gy,v.split=Rb,v.spread=ix,v.tail=Zy,v.take=jy,v.takeRight=Jy,v.takeRightWhile=tv,v.takeWhile=ev,v.tap=mv,v.throttle=nx,v.thru=js,v.toArray=_c,v.toPairs=Nc,v.toPairsIn=$c,v.toPath=fO,v.toPlainObject=Dc,v.transform=ab,v.unary=rx,v.union=iv,v.unionBy=nv,v.unionWith=rv,v.uniq=sv,v.uniqBy=ov,v.uniqWith=lv,v.unset=hb,v.unzip=wa,v.unzipWith=mc,v.update=fb,v.updateWith=ub,v.values=Un,v.valuesIn=cb,v.without=av,v.words=Hc,v.wrap=sx,v.xor=hv,v.xorBy=fv,v.xorWith=uv,v.zip=cv,v.zipObject=dv,v.zipObjectDeep=pv,v.zipWith=gv,v.entries=Nc,v.entriesIn=$c,v.extend=Ic,v.extendWith=so,Ta(v,v),v.add=cO,v.attempt=zc,v.camelCase=mb,v.capitalize=Wc,v.ceil=dO,v.clamp=db,v.clone=lx,v.cloneDeep=hx,v.cloneDeepWith=fx,v.cloneWith=ax,v.conformsTo=ux,v.deburr=Fc,v.defaultTo=Ub,v.divide=pO,v.endsWith=wb,v.eq=Je,v.escape=yb,v.escapeRegExp=vb,v.every=Av,v.find=Pv,v.findIndex=uc,v.findKey=Hx,v.findLast=Mv,v.findLastIndex=cc,v.findLastKey=zx,v.floor=gO,v.forEach=yc,v.forEachRight=vc,v.forIn=Vx,v.forInRight=Qx,v.forOwn=Ux,v.forOwnRight=qx,v.get=Oa,v.gt=cx,v.gte=dx,v.has=Kx,v.hasIn=Sa,v.head=pc,v.identity=pe,v.includes=Iv,v.indexOf=My,v.inRange=pb,v.invoke=jx,v.isArguments=xn,v.isArray=tt,v.isArrayBuffer=px,v.isArrayLike=ce,v.isArrayLikeObject=Dt,v.isBoolean=gx,v.isBuffer=ji,v.isDate=mx,v.isElement=wx,v.isEmpty=yx,v.isEqual=vx,v.isEqualWith=xx,v.isError=xa,v.isFinite=bx,v.isFunction=Ii,v.isInteger=Tc,v.isLength=no,v.isMap=Pc,v.isMatch=Ox,v.isMatchWith=Sx,v.isNaN=kx,v.isNative=Cx,v.isNil=Tx,v.isNull=Ax,v.isNumber=Mc,v.isObject=Rt,v.isObjectLike=Et,v.isPlainObject=Dr,v.isRegExp=ba,v.isSafeInteger=Px,v.isSet=Rc,v.isString=ro,v.isSymbol=ke,v.isTypedArray=Qn,v.isUndefined=Mx,v.isWeakMap=Rx,v.isWeakSet=_x,v.join=Iy,v.kebabCase=xb,v.last=$e,v.lastIndexOf=By,v.lowerCase=bb,v.lowerFirst=Ob,v.lt=Ex,v.lte=Dx,v.max=mO,v.maxBy=wO,v.mean=yO,v.meanBy=vO,v.min=xO,v.minBy=bO,v.stubArray=Ma,v.stubFalse=Ra,v.stubObject=oO,v.stubString=lO,v.stubTrue=aO,v.multiply=OO,v.nth=Ly,v.noConflict=jb,v.noop=Pa,v.now=to,v.pad=Sb,v.padEnd=kb,v.padStart=Cb,v.parseInt=Ab,v.random=gb,v.reduce=Wv,v.reduceRight=Fv,v.repeat=Tb,v.replace=Pb,v.result=sb,v.round=SO,v.runInContext=C,v.sample=zv,v.size=Uv,v.snakeCase=Mb,v.some=qv,v.sortedIndex=Vy,v.sortedIndexBy=Qy,v.sortedIndexOf=Uy,v.sortedLastIndex=qy,v.sortedLastIndexBy=Xy,v.sortedLastIndexOf=Yy,v.startCase=_b,v.startsWith=Eb,v.subtract=kO,v.sum=CO,v.sumBy=AO,v.template=Db,v.times=hO,v.toFinite=Bi,v.toInteger=it,v.toLength=Ec,v.toLower=Ib,v.toNumber=We,v.toSafeInteger=Ix,v.toString=gt,v.toUpper=Bb,v.trim=Lb,v.trimEnd=Nb,v.trimStart=$b,v.truncate=Wb,v.unescape=Fb,v.uniqueId=uO,v.upperCase=Hb,v.upperFirst=ka,v.each=yc,v.eachRight=vc,v.first=pc,Ta(v,function(){var s={};return li(v,function(a,u){wt.call(v.prototype,u)||(s[u]=a)}),s}(),{chain:!1}),v.VERSION=i,De(["bind","bindKey","curry","curryRight","partial","partialRight"],function(s){v[s].placeholder=v}),De(["drop","take"],function(s,a){ht.prototype[s]=function(u){u=u===e?1:Ht(it(u),0);var p=this.__filtered__&&!a?new ht(this):this.clone();return p.__filtered__?p.__takeCount__=jt(u,p.__takeCount__):p.__views__.push({size:jt(u,Lt),type:s+(p.__dir__<0?"Right":"")}),p},ht.prototype[s+"Right"]=function(u){return this.reverse()[s](u).reverse()}}),De(["filter","map","takeWhile"],function(s,a){var u=a+1,p=u==St||u==si;ht.prototype[s]=function(w){var x=this.clone();return x.__iteratees__.push({iteratee:Y(w,3),type:u}),x.__filtered__=x.__filtered__||p,x}}),De(["head","last"],function(s,a){var u="take"+(a?"Right":"");ht.prototype[s]=function(){return this[u](1).value()[0]}}),De(["initial","tail"],function(s,a){var u="drop"+(a?"":"Right");ht.prototype[s]=function(){return this.__filtered__?new ht(this):this[u](1)}}),ht.prototype.compact=function(){return this.filter(pe)},ht.prototype.find=function(s){return this.filter(s).head()},ht.prototype.findLast=function(s){return this.reverse().find(s)},ht.prototype.invokeMap=rt(function(s,a){return typeof s=="function"?new ht(this):this.map(function(u){return Tr(u,s,a)})}),ht.prototype.reject=function(s){return this.filter(io(Y(s)))},ht.prototype.slice=function(s,a){s=it(s);var u=this;return u.__filtered__&&(s>0||a<0)?new ht(u):(s<0?u=u.takeRight(-s):s&&(u=u.drop(s)),a!==e&&(a=it(a),u=a<0?u.dropRight(-a):u.take(a-s)),u)},ht.prototype.takeRightWhile=function(s){return this.reverse().takeWhile(s).reverse()},ht.prototype.toArray=function(){return this.take(Lt)},li(ht.prototype,function(s,a){var u=/^(?:filter|find|map|reject)|While$/.test(a),p=/^(?:head|last)$/.test(a),w=v[p?"take"+(a=="last"?"Right":""):a],x=p||/^find/.test(a);w&&(v.prototype[a]=function(){var O=this.__wrapped__,k=p?[1]:arguments,T=O instanceof ht,_=k[0],E=T||tt(O),L=function(lt){var ut=w.apply(v,Ui([lt],k));return p&&z?ut[0]:ut};E&&u&&typeof _=="function"&&_.length!=1&&(T=E=!1);var z=this.__chain__,q=!!this.__actions__.length,K=x&&!z,nt=T&&!q;if(!x&&E){O=nt?O:new ht(this);var G=s.apply(O,k);return G.__actions__.push({func:js,args:[L],thisArg:e}),new Be(G,z)}return K&&nt?s.apply(this,k):(G=this.thru(L),K?p?G.value()[0]:G.value():G)})}),De(["pop","push","shift","sort","splice","unshift"],function(s){var a=ks[s],u=/^(?:push|sort|unshift)$/.test(s)?"tap":"thru",p=/^(?:pop|shift)$/.test(s);v.prototype[s]=function(){var w=arguments;if(p&&!this.__chain__){var x=this.value();return a.apply(tt(x)?x:[],w)}return this[u](function(O){return a.apply(tt(O)?O:[],w)})}}),li(ht.prototype,function(s,a){var u=v[a];if(u){var p=u.name+"";wt.call(Wn,p)||(Wn[p]=[]),Wn[p].push({name:a,func:u})}}),Wn[Us(e,P).name]=[{name:"wrapper",func:e}],ht.prototype.clone=F1,ht.prototype.reverse=H1,ht.prototype.value=z1,v.prototype.at=wv,v.prototype.chain=yv,v.prototype.commit=vv,v.prototype.next=xv,v.prototype.plant=Ov,v.prototype.reverse=Sv,v.prototype.toJSON=v.prototype.valueOf=v.prototype.value=kv,v.prototype.first=v.prototype.head,xr&&(v.prototype[xr]=bv),v},Ln=v1();cn?((cn.exports=Ln)._=Ln,Al._=Ln):Yt._=Ln}).call(tA)}(Vr,Vr.exports)),Vr.exports}var mm=eA();const e2=TO(mm);class wm{constructor(t,e,i,n){this.state=t,this.pos=e,this.explicit=i,this.view=n,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(t){let e=Re(this.state).resolveInner(this.pos,-1);for(;e&&t.indexOf(e.name)<0;)e=e.parent;return e?{from:e.from,to:this.pos,text:this.state.sliceDoc(e.from,this.pos),type:e.type}:null}matchBefore(t){let e=this.state.doc.lineAt(this.pos),i=Math.max(e.from,this.pos-250),n=e.text.slice(i-e.from,this.pos-e.from),o=n.search(ym(t,!1));return o<0?null:{from:i+o,to:this.pos,text:n.slice(o)}}get aborted(){return this.abortListeners==null}addEventListener(t,e,i){t=="abort"&&this.abortListeners&&(this.abortListeners.push(e),i&&i.onDocChange&&(this.abortOnDocChange=!0))}}function hp(r){let t=Object.keys(r).join(""),e=/\w/.test(t);return e&&(t=t.replace(/\w/g,"")),`[${e?"\\w":""}${t.replace(/[^\w\s]/g,"\\$&")}]`}function iA(r){let t=Object.create(null),e=Object.create(null);for(let{label:n}of r){t[n[0]]=!0;for(let o=1;o<n.length;o++)e[n[o]]=!0}let i=hp(t)+hp(e)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function nA(r){let t=r.map(n=>typeof n=="string"?{label:n}:n),[e,i]=t.every(n=>/^\w+$/.test(n.label))?[/\w*$/,/\w+$/]:iA(t);return n=>{let o=n.matchBefore(i);return o||n.explicit?{from:o?o.from:n.pos,options:t,validFor:e}:null}}class fp{constructor(t,e,i,n){this.completion=t,this.source=e,this.match=i,this.score=n}}function An(r){return r.selection.main.from}function ym(r,t){var e;let{source:i}=r,n=t&&i[0]!="^",o=i[i.length-1]!="$";return!n&&!o?r:new RegExp(`${n?"^":""}(?:${i})${o?"$":""}`,(e=r.flags)!==null&&e!==void 0?e:r.ignoreCase?"i":"")}const vm=Vi.define();function rA(r,t,e,i){let{main:n}=r.selection,o=e-n.from,l=i-n.from;return Object.assign(Object.assign({},r.changeByRange(h=>{if(h!=n&&e!=i&&r.sliceDoc(h.from+o,h.from+l)!=r.sliceDoc(e,i))return{range:h};let f=r.toText(t);return{changes:{from:h.from+o,to:i==n.from?h.to:h.from+l,insert:f},range:V.cursor(h.from+o+f.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const up=new WeakMap;function sA(r){if(!Array.isArray(r))return r;let t=up.get(r);return t||up.set(r,t=nA(r)),t}const Go=ft.define(),ss=ft.define();class oA{constructor(t){this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let e=0;e<t.length;){let i=Fe(t,e),n=$i(i);this.chars.push(i);let o=t.slice(e,e+n),l=o.toUpperCase();this.folded.push(Fe(l==o?o.toLowerCase():l,0)),e+=n}this.astral=t.length!=this.chars.length}ret(t,e){return this.score=t,this.matched=e,this}match(t){if(this.pattern.length==0)return this.ret(-100,[]);if(t.length<this.pattern.length)return null;let{chars:e,folded:i,any:n,precise:o,byWord:l}=this;if(e.length==1){let B=Fe(t,0),N=$i(B),D=N==t.length?0:-100;if(B!=e[0])if(B==i[0])D+=-200;else return null;return this.ret(D,[0,N])}let h=t.indexOf(this.pattern);if(h==0)return this.ret(t.length==this.pattern.length?0:-100,[0,this.pattern.length]);let f=e.length,c=0;if(h<0){for(let B=0,N=Math.min(t.length,200);B<N&&c<f;){let D=Fe(t,B);(D==e[c]||D==i[c])&&(n[c++]=B),B+=$i(D)}if(c<f)return null}let d=0,g=0,m=!1,y=0,b=-1,S=-1,A=/[a-z]/.test(t),P=!0;for(let B=0,N=Math.min(t.length,200),D=0;B<N&&g<f;){let $=Fe(t,B);h<0&&(d<f&&$==e[d]&&(o[d++]=B),y<f&&($==e[y]||$==i[y]?(y==0&&(b=B),S=B+1,y++):y=0));let W,F=$<255?$>=48&&$<=57||$>=97&&$<=122?2:$>=65&&$<=90?1:0:(W=Yp($))!=W.toLowerCase()?1:W!=W.toUpperCase()?2:0;(!B||F==1&&A||D==0&&F!=0)&&(e[g]==$||i[g]==$&&(m=!0)?l[g++]=B:l.length&&(P=!1)),D=F,B+=$i($)}return g==f&&l[0]==0&&P?this.result(-100+(m?-200:0),l,t):y==f&&b==0?this.ret(-200-t.length+(S==t.length?0:-100),[0,S]):h>-1?this.ret(-700-t.length,[h,h+this.pattern.length]):y==f?this.ret(-900-t.length,[b,S]):g==f?this.result(-100+(m?-200:0)+-700+(P?0:-1100),l,t):e.length==2?null:this.result((n[0]?-700:0)+-200+-1100,n,t)}result(t,e,i){let n=[],o=0;for(let l of e){let h=l+(this.astral?$i(Fe(i,l)):1);o&&n[o-1]==l?n[o-1]=h:(n[o++]=l,n[o++]=h)}return this.ret(t-i.length,n)}}class lA{constructor(t){this.pattern=t,this.matched=[],this.score=0,this.folded=t.toLowerCase()}match(t){if(t.length<this.pattern.length)return null;let e=t.slice(0,this.pattern.length),i=e==this.pattern?0:e.toLowerCase()==this.folded?-200:null;return i==null?null:(this.matched=[0,e.length],this.score=i+(t.length==this.pattern.length?0:-100),this)}}const Xt=X.define({combine(r){return rl(r,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:aA,filterStrict:!1,compareCompletions:(t,e)=>t.label.localeCompare(e.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(t,e)=>t&&e,closeOnBlur:(t,e)=>t&&e,icons:(t,e)=>t&&e,tooltipClass:(t,e)=>i=>cp(t(i),e(i)),optionClass:(t,e)=>i=>cp(t(i),e(i)),addToOptions:(t,e)=>t.concat(e),filterStrict:(t,e)=>t||e})}});function cp(r,t){return r?t?r+" "+t:r:t}function aA(r,t,e,i,n,o){let l=r.textDirection==$t.RTL,h=l,f=!1,c="top",d,g,m=t.left-n.left,y=n.right-t.right,b=i.right-i.left,S=i.bottom-i.top;if(h&&m<Math.min(b,y)?h=!1:!h&&y<Math.min(b,m)&&(h=!0),b<=(h?m:y))d=Math.max(n.top,Math.min(e.top,n.bottom-S))-t.top,g=Math.min(400,h?m:y);else{f=!0,g=Math.min(400,(l?t.right:n.right-t.left)-30);let B=n.bottom-t.bottom;B>=S||B>t.top?d=e.bottom-t.top:(c="bottom",d=t.bottom-e.top)}let A=(t.bottom-t.top)/o.offsetHeight,P=(t.right-t.left)/o.offsetWidth;return{style:`${c}: ${d/A}px; max-width: ${g/P}px`,class:"cm-completionInfo-"+(f?l?"left-narrow":"right-narrow":h?"left":"right")}}function hA(r){let t=r.addToOptions.slice();return r.icons&&t.push({render(e){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),e.type&&i.classList.add(...e.type.split(/\s+/g).map(n=>"cm-completionIcon-"+n)),i.setAttribute("aria-hidden","true"),i},position:20}),t.push({render(e,i,n,o){let l=document.createElement("span");l.className="cm-completionLabel";let h=e.displayLabel||e.label,f=0;for(let c=0;c<o.length;){let d=o[c++],g=o[c++];d>f&&l.appendChild(document.createTextNode(h.slice(f,d)));let m=l.appendChild(document.createElement("span"));m.appendChild(document.createTextNode(h.slice(d,g))),m.className="cm-completionMatchedText",f=g}return f<h.length&&l.appendChild(document.createTextNode(h.slice(f))),l},position:50},{render(e){if(!e.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=e.detail,i},position:80}),t.sort((e,i)=>e.position-i.position).map(e=>e.render)}function qa(r,t,e){if(r<=e)return{from:0,to:r};if(t<0&&(t=0),t<=r>>1){let n=Math.floor(t/e);return{from:n*e,to:(n+1)*e}}let i=Math.floor((r-t)/e);return{from:r-(i+1)*e,to:r-i*e}}class fA{constructor(t,e,i){this.view=t,this.stateField=e,this.applyCompletion=i,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:f=>this.placeInfo(f),key:this},this.space=null,this.currentClass="";let n=t.state.field(e),{options:o,selected:l}=n.open,h=t.state.facet(Xt);this.optionContent=hA(h),this.optionClass=h.optionClass,this.tooltipClass=h.tooltipClass,this.range=qa(o.length,l,h.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(t.state),this.dom.addEventListener("mousedown",f=>{let{options:c}=t.state.field(e).open;for(let d=f.target,g;d&&d!=this.dom;d=d.parentNode)if(d.nodeName=="LI"&&(g=/-(\d+)$/.exec(d.id))&&+g[1]<c.length){this.applyCompletion(t,c[+g[1]]),f.preventDefault();return}}),this.dom.addEventListener("focusout",f=>{let c=t.state.field(this.stateField,!1);c&&c.tooltip&&t.state.facet(Xt).closeOnBlur&&f.relatedTarget!=t.contentDOM&&t.dispatch({effects:ss.of(null)})}),this.showOptions(o,n.id)}mount(){this.updateSel()}showOptions(t,e){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(t,e,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(t){var e;let i=t.state.field(this.stateField),n=t.startState.field(this.stateField);if(this.updateTooltipClass(t.state),i!=n){let{options:o,selected:l,disabled:h}=i.open;(!n.open||n.open.options!=o)&&(this.range=qa(o.length,l,t.state.facet(Xt).maxRenderedOptions),this.showOptions(o,i.id)),this.updateSel(),h!=((e=n.open)===null||e===void 0?void 0:e.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!h)}}updateTooltipClass(t){let e=this.tooltipClass(t);if(e!=this.currentClass){for(let i of this.currentClass.split(" "))i&&this.dom.classList.remove(i);for(let i of e.split(" "))i&&this.dom.classList.add(i);this.currentClass=e}}positioned(t){this.space=t,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let t=this.view.state.field(this.stateField),e=t.open;if((e.selected>-1&&e.selected<this.range.from||e.selected>=this.range.to)&&(this.range=qa(e.options.length,e.selected,this.view.state.facet(Xt).maxRenderedOptions),this.showOptions(e.options,t.id)),this.updateSelectedOption(e.selected)){this.destroyInfo();let{completion:i}=e.options[e.selected],{info:n}=i;if(!n)return;let o=typeof n=="string"?document.createTextNode(n):n(i);if(!o)return;"then"in o?o.then(l=>{l&&this.view.state.field(this.stateField,!1)==t&&this.addInfoPane(l,i)}).catch(l=>le(this.view.state,l,"completion info")):this.addInfoPane(o,i)}}addInfoPane(t,e){this.destroyInfo();let i=this.info=document.createElement("div");if(i.className="cm-tooltip cm-completionInfo",t.nodeType!=null)i.appendChild(t),this.infoDestroy=null;else{let{dom:n,destroy:o}=t;i.appendChild(n),this.infoDestroy=o||null}this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(t){let e=null;for(let i=this.list.firstChild,n=this.range.from;i;i=i.nextSibling,n++)i.nodeName!="LI"||!i.id?n--:n==t?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),e=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return e&&cA(this.list,e),e}measureInfo(){let t=this.dom.querySelector("[aria-selected]");if(!t||!this.info)return null;let e=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),n=t.getBoundingClientRect(),o=this.space;if(!o){let l=this.dom.ownerDocument.documentElement;o={left:0,top:0,right:l.clientWidth,bottom:l.clientHeight}}return n.top>Math.min(o.bottom,e.bottom)-10||n.bottom<Math.max(o.top,e.top)+10?null:this.view.state.facet(Xt).positionInfo(this.view,e,n,i,o,this.dom)}placeInfo(t){this.info&&(t?(t.style&&(this.info.style.cssText=t.style),this.info.className="cm-tooltip cm-completionInfo "+(t.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(t,e,i){const n=document.createElement("ul");n.id=e,n.setAttribute("role","listbox"),n.setAttribute("aria-expanded","true"),n.setAttribute("aria-label",this.view.state.phrase("Completions")),n.addEventListener("mousedown",l=>{l.target==n&&l.preventDefault()});let o=null;for(let l=i.from;l<i.to;l++){let{completion:h,match:f}=t[l],{section:c}=h;if(c){let m=typeof c=="string"?c:c.name;if(m!=o&&(l>i.from||i.from==0))if(o=m,typeof c!="string"&&c.header)n.appendChild(c.header(c));else{let y=n.appendChild(document.createElement("completion-section"));y.textContent=m}}const d=n.appendChild(document.createElement("li"));d.id=e+"-"+l,d.setAttribute("role","option");let g=this.optionClass(h);g&&(d.className=g);for(let m of this.optionContent){let y=m(h,this.view.state,this.view,f);y&&d.appendChild(y)}}return i.from&&n.classList.add("cm-completionListIncompleteTop"),i.to<t.length&&n.classList.add("cm-completionListIncompleteBottom"),n}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function uA(r,t){return e=>new fA(e,r,t)}function cA(r,t){let e=r.getBoundingClientRect(),i=t.getBoundingClientRect(),n=e.height/r.offsetHeight;i.top<e.top?r.scrollTop-=(e.top-i.top)/n:i.bottom>e.bottom&&(r.scrollTop+=(i.bottom-e.bottom)/n)}function dp(r){return(r.boost||0)*100+(r.apply?10:0)+(r.info?5:0)+(r.type?1:0)}function dA(r,t){let e=[],i=null,n=c=>{e.push(c);let{section:d}=c.completion;if(d){i||(i=[]);let g=typeof d=="string"?d:d.name;i.some(m=>m.name==g)||i.push(typeof d=="string"?{name:g}:d)}},o=t.facet(Xt);for(let c of r)if(c.hasResult()){let d=c.result.getMatch;if(c.result.filter===!1)for(let g of c.result.options)n(new fp(g,c.source,d?d(g):[],1e9-e.length));else{let g=t.sliceDoc(c.from,c.to),m,y=o.filterStrict?new lA(g):new oA(g);for(let b of c.result.options)if(m=y.match(b.label)){let S=b.displayLabel?d?d(b,m.matched):[]:m.matched;n(new fp(b,c.source,S,m.score+(b.boost||0)))}}}if(i){let c=Object.create(null),d=0,g=(m,y)=>{var b,S;return((b=m.rank)!==null&&b!==void 0?b:1e9)-((S=y.rank)!==null&&S!==void 0?S:1e9)||(m.name<y.name?-1:1)};for(let m of i.sort(g))d-=1e5,c[m.name]=d;for(let m of e){let{section:y}=m.completion;y&&(m.score+=c[typeof y=="string"?y:y.name])}}let l=[],h=null,f=o.compareCompletions;for(let c of e.sort((d,g)=>g.score-d.score||f(d.completion,g.completion))){let d=c.completion;!h||h.label!=d.label||h.detail!=d.detail||h.type!=null&&d.type!=null&&h.type!=d.type||h.apply!=d.apply||h.boost!=d.boost?l.push(c):dp(c.completion)>dp(h)&&(l[l.length-1]=c),h=c.completion}return l}class Yn{constructor(t,e,i,n,o,l){this.options=t,this.attrs=e,this.tooltip=i,this.timestamp=n,this.selected=o,this.disabled=l}setSelected(t,e){return t==this.selected||t>=this.options.length?this:new Yn(this.options,pp(e,t),this.tooltip,this.timestamp,t,this.disabled)}static build(t,e,i,n,o,l){if(n&&!l&&t.some(c=>c.isPending))return n.setDisabled();let h=dA(t,e);if(!h.length)return n&&t.some(c=>c.isPending)?n.setDisabled():null;let f=e.facet(Xt).selectOnOpen?0:-1;if(n&&n.selected!=f&&n.selected!=-1){let c=n.options[n.selected].completion;for(let d=0;d<h.length;d++)if(h[d].completion==c){f=d;break}}return new Yn(h,pp(i,f),{pos:t.reduce((c,d)=>d.hasResult()?Math.min(c,d.from):c,1e8),create:vA,above:o.aboveCursor},n?n.timestamp:Date.now(),f,!1)}map(t){return new Yn(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:t.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new Yn(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class Zo{constructor(t,e,i){this.active=t,this.id=e,this.open=i}static start(){return new Zo(wA,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(t){let{state:e}=t,i=e.facet(Xt),o=(i.override||e.languageDataAt("autocomplete",An(e)).map(sA)).map(f=>(this.active.find(d=>d.source==f)||new Qe(f,this.active.some(d=>d.state!=0)?1:0)).update(t,i));o.length==this.active.length&&o.every((f,c)=>f==this.active[c])&&(o=this.active);let l=this.open,h=t.effects.some(f=>f.is(af));l&&t.docChanged&&(l=l.map(t.changes)),t.selection||o.some(f=>f.hasResult()&&t.changes.touchesRange(f.from,f.to))||!pA(o,this.active)||h?l=Yn.build(o,e,this.id,l,i,h):l&&l.disabled&&!o.some(f=>f.isPending)&&(l=null),!l&&o.every(f=>!f.isPending)&&o.some(f=>f.hasResult())&&(o=o.map(f=>f.hasResult()?new Qe(f.source,0):f));for(let f of t.effects)f.is(bm)&&(l=l&&l.setSelected(f.value,this.id));return o==this.active&&l==this.open?this:new Zo(o,this.id,l)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?gA:mA}}function pA(r,t){if(r==t)return!0;for(let e=0,i=0;;){for(;e<r.length&&!r[e].hasResult();)e++;for(;i<t.length&&!t[i].hasResult();)i++;let n=e==r.length,o=i==t.length;if(n||o)return n==o;if(r[e++].result!=t[i++].result)return!1}}const gA={"aria-autocomplete":"list"},mA={};function pp(r,t){let e={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":r};return t>-1&&(e["aria-activedescendant"]=r+"-"+t),e}const wA=[];function xm(r,t){if(r.isUserEvent("input.complete")){let i=r.annotation(vm);if(i&&t.activateOnCompletion(i))return 12}let e=r.isUserEvent("input.type");return e&&t.activateOnTyping?5:e?1:r.isUserEvent("delete.backward")?2:r.selection?8:r.docChanged?16:0}class Qe{constructor(t,e,i=!1){this.source=t,this.state=e,this.explicit=i}hasResult(){return!1}get isPending(){return this.state==1}update(t,e){let i=xm(t,e),n=this;(i&8||i&16&&this.touches(t))&&(n=new Qe(n.source,0)),i&4&&n.state==0&&(n=new Qe(this.source,1)),n=n.updateFor(t,i);for(let o of t.effects)if(o.is(Go))n=new Qe(n.source,1,o.value);else if(o.is(ss))n=new Qe(n.source,0);else if(o.is(af))for(let l of o.value)l.source==n.source&&(n=l);return n}updateFor(t,e){return this.map(t.changes)}map(t){return this}touches(t){return t.changes.touchesRange(An(t.state))}}class jn extends Qe{constructor(t,e,i,n,o,l){super(t,3,e),this.limit=i,this.result=n,this.from=o,this.to=l}hasResult(){return!0}updateFor(t,e){var i;if(!(e&3))return this.map(t.changes);let n=this.result;n.map&&!t.changes.empty&&(n=n.map(n,t.changes));let o=t.changes.mapPos(this.from),l=t.changes.mapPos(this.to,1),h=An(t.state);if(h>l||!n||e&2&&(An(t.startState)==this.from||h<this.limit))return new Qe(this.source,e&4?1:0);let f=t.changes.mapPos(this.limit);return yA(n.validFor,t.state,o,l)?new jn(this.source,this.explicit,f,n,o,l):n.update&&(n=n.update(n,o,l,new wm(t.state,h,!1)))?new jn(this.source,this.explicit,f,n,n.from,(i=n.to)!==null&&i!==void 0?i:An(t.state)):new Qe(this.source,1,this.explicit)}map(t){return t.empty?this:(this.result.map?this.result.map(this.result,t):this.result)?new jn(this.source,this.explicit,t.mapPos(this.limit),this.result,t.mapPos(this.from),t.mapPos(this.to,1)):new Qe(this.source,0)}touches(t){return t.changes.touchesRange(this.from,this.to)}}function yA(r,t,e,i){if(!r)return!1;let n=t.sliceDoc(e,i);return typeof r=="function"?r(n,e,i,t):ym(r,!0).test(n)}const af=ft.define({map(r,t){return r.map(e=>e.map(t))}}),bm=ft.define(),me=ve.define({create(){return Zo.start()},update(r,t){return r.update(t)},provide:r=>[rf.from(r,t=>t.tooltip),Z.contentAttributes.from(r,t=>t.attrs)]});function hf(r,t){const e=t.completion.apply||t.completion.label;let i=r.state.field(me).active.find(n=>n.source==t.source);return i instanceof jn?(typeof e=="string"?r.dispatch(Object.assign(Object.assign({},rA(r.state,e,i.from,i.to)),{annotations:vm.of(t.completion)})):e(r,t.completion,i.from,i.to),!0):!1}const vA=uA(me,hf);function To(r,t="option"){return e=>{let i=e.state.field(me,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<e.state.facet(Xt).interactionDelay)return!1;let n=1,o;t=="page"&&(o=rm(e,i.open.tooltip))&&(n=Math.max(2,Math.floor(o.dom.offsetHeight/o.dom.querySelector("li").offsetHeight)-1));let{length:l}=i.open.options,h=i.open.selected>-1?i.open.selected+n*(r?1:-1):r?0:l-1;return h<0?h=t=="page"?0:l-1:h>=l&&(h=t=="page"?l-1:0),e.dispatch({effects:bm.of(h)}),!0}}const xA=r=>{let t=r.state.field(me,!1);return r.state.readOnly||!t||!t.open||t.open.selected<0||t.open.disabled||Date.now()-t.open.timestamp<r.state.facet(Xt).interactionDelay?!1:hf(r,t.open.options[t.open.selected])},gp=r=>r.state.field(me,!1)?(r.dispatch({effects:Go.of(!0)}),!0):!1,bA=r=>{let t=r.state.field(me,!1);return!t||!t.active.some(e=>e.state!=0)?!1:(r.dispatch({effects:ss.of(null)}),!0)};class OA{constructor(t,e){this.active=t,this.context=e,this.time=Date.now(),this.updates=[],this.done=void 0}}const SA=50,kA=1e3,CA=Me.fromClass(class{constructor(r){this.view=r,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let t of r.state.field(me).active)t.isPending&&this.startQuery(t)}update(r){let t=r.state.field(me),e=r.state.facet(Xt);if(!r.selectionSet&&!r.docChanged&&r.startState.field(me)==t)return;let i=r.transactions.some(o=>{let l=xm(o,e);return l&8||(o.selection||o.docChanged)&&!(l&3)});for(let o=0;o<this.running.length;o++){let l=this.running[o];if(i||l.context.abortOnDocChange&&r.docChanged||l.updates.length+r.transactions.length>SA&&Date.now()-l.time>kA){for(let h of l.context.abortListeners)try{h()}catch(f){le(this.view.state,f)}l.context.abortListeners=null,this.running.splice(o--,1)}else l.updates.push(...r.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),r.transactions.some(o=>o.effects.some(l=>l.is(Go)))&&(this.pendingStart=!0);let n=this.pendingStart?50:e.activateOnTypingDelay;if(this.debounceUpdate=t.active.some(o=>o.isPending&&!this.running.some(l=>l.active.source==o.source))?setTimeout(()=>this.startUpdate(),n):-1,this.composing!=0)for(let o of r.transactions)o.isUserEvent("input.type")?this.composing=2:this.composing==2&&o.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:r}=this.view,t=r.field(me);for(let e of t.active)e.isPending&&!this.running.some(i=>i.active.source==e.source)&&this.startQuery(e);this.running.length&&t.open&&t.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Xt).updateSyncTime))}startQuery(r){let{state:t}=this.view,e=An(t),i=new wm(t,e,r.explicit,this.view),n=new OA(r,i);this.running.push(n),Promise.resolve(r.source(i)).then(o=>{n.context.aborted||(n.done=o||null,this.scheduleAccept())},o=>{this.view.dispatch({effects:ss.of(null)}),le(this.view.state,o)})}scheduleAccept(){this.running.every(r=>r.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Xt).updateSyncTime))}accept(){var r;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let t=[],e=this.view.state.facet(Xt),i=this.view.state.field(me);for(let n=0;n<this.running.length;n++){let o=this.running[n];if(o.done===void 0)continue;if(this.running.splice(n--,1),o.done){let h=An(o.updates.length?o.updates[0].startState:this.view.state),f=Math.min(h,o.done.from+(o.active.explicit?0:1)),c=new jn(o.active.source,o.active.explicit,f,o.done,o.done.from,(r=o.done.to)!==null&&r!==void 0?r:h);for(let d of o.updates)c=c.update(d,e);if(c.hasResult()){t.push(c);continue}}let l=i.active.find(h=>h.source==o.active.source);if(l&&l.isPending)if(o.done==null){let h=new Qe(o.active.source,0);for(let f of o.updates)h=h.update(f,e);h.isPending||t.push(h)}else this.startQuery(l)}(t.length||i.open&&i.open.disabled)&&this.view.dispatch({effects:af.of(t)})}},{eventHandlers:{blur(r){let t=this.view.state.field(me,!1);if(t&&t.tooltip&&this.view.state.facet(Xt).closeOnBlur){let e=t.open&&rm(this.view,t.open.tooltip);(!e||!e.dom.contains(r.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:ss.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Go.of(!1)}),20),this.composing=0}}}),AA=typeof navigator=="object"&&/Win/.test(navigator.platform),TA=as.highest(Z.domEventHandlers({keydown(r,t){let e=t.state.field(me,!1);if(!e||!e.open||e.open.disabled||e.open.selected<0||r.key.length>1||r.ctrlKey&&!(AA&&r.altKey)||r.metaKey)return!1;let i=e.open.options[e.open.selected],n=e.active.find(l=>l.source==i.source),o=i.completion.commitCharacters||n.result.commitCharacters;return o&&o.indexOf(r.key)>-1&&hf(t,i),!1}})),PA=Z.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),os={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Cn=ft.define({map(r,t){let e=t.mapPos(r,-1,oe.TrackAfter);return e??void 0}}),ff=new class extends Tn{};ff.startSide=1;ff.endSide=-1;const Om=ve.define({create(){return Ct.empty},update(r,t){if(r=r.map(t.changes),t.selection){let e=t.state.doc.lineAt(t.selection.main.head);r=r.update({filter:i=>i>=e.from&&i<=e.to})}for(let e of t.effects)e.is(Cn)&&(r=r.update({add:[ff.range(e.value,e.value+1)]}));return r}});function MA(){return[_A,Om]}const Xa="()[]{}<>";function Sm(r){for(let t=0;t<Xa.length;t+=2)if(Xa.charCodeAt(t)==r)return Xa.charAt(t+1);return Yp(r<128?r:r+1)}function km(r,t){return r.languageDataAt("closeBrackets",t)[0]||os}const RA=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),_A=Z.inputHandler.of((r,t,e,i)=>{if((RA?r.composing:r.compositionStarted)||r.state.readOnly)return!1;let n=r.state.selection.main;if(i.length>2||i.length==2&&$i(Fe(i,0))==1||t!=n.from||e!=n.to)return!1;let o=IA(r.state,i);return o?(r.dispatch(o),!0):!1}),EA=({state:r,dispatch:t})=>{if(r.readOnly)return!1;let i=km(r,r.selection.main.head).brackets||os.brackets,n=null,o=r.changeByRange(l=>{if(l.empty){let h=BA(r.doc,l.head);for(let f of i)if(f==h&&al(r.doc,l.head)==Sm(Fe(f,0)))return{changes:{from:l.head-f.length,to:l.head+f.length},range:V.cursor(l.head-f.length)}}return{range:n=l}});return n||t(r.update(o,{scrollIntoView:!0,userEvent:"delete.backward"})),!n},DA=[{key:"Backspace",run:EA}];function IA(r,t){let e=km(r,r.selection.main.head),i=e.brackets||os.brackets;for(let n of i){let o=Sm(Fe(n,0));if(t==n)return o==n?$A(r,n,i.indexOf(n+n+n)>-1,e):LA(r,n,o,e.before||os.before);if(t==o&&Cm(r,r.selection.main.from))return NA(r,n,o)}return null}function Cm(r,t){let e=!1;return r.field(Om).between(0,r.doc.length,i=>{i==t&&(e=!0)}),e}function al(r,t){let e=r.sliceString(t,t+2);return e.slice(0,$i(Fe(e,0)))}function BA(r,t){let e=r.sliceString(t-2,t);return $i(Fe(e,0))==e.length?e:e.slice(1)}function LA(r,t,e,i){let n=null,o=r.changeByRange(l=>{if(!l.empty)return{changes:[{insert:t,from:l.from},{insert:e,from:l.to}],effects:Cn.of(l.to+t.length),range:V.range(l.anchor+t.length,l.head+t.length)};let h=al(r.doc,l.head);return!h||/\s/.test(h)||i.indexOf(h)>-1?{changes:{insert:t+e,from:l.head},effects:Cn.of(l.head+t.length),range:V.cursor(l.head+t.length)}:{range:n=l}});return n?null:r.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function NA(r,t,e){let i=null,n=r.changeByRange(o=>o.empty&&al(r.doc,o.head)==e?{changes:{from:o.head,to:o.head+e.length,insert:e},range:V.cursor(o.head+e.length)}:i={range:o});return i?null:r.update(n,{scrollIntoView:!0,userEvent:"input.type"})}function $A(r,t,e,i){let n=i.stringPrefixes||os.stringPrefixes,o=null,l=r.changeByRange(h=>{if(!h.empty)return{changes:[{insert:t,from:h.from},{insert:t,from:h.to}],effects:Cn.of(h.to+t.length),range:V.range(h.anchor+t.length,h.head+t.length)};let f=h.head,c=al(r.doc,f),d;if(c==t){if(mp(r,f))return{changes:{insert:t+t,from:f},effects:Cn.of(f+t.length),range:V.cursor(f+t.length)};if(Cm(r,f)){let m=e&&r.sliceDoc(f,f+t.length*3)==t+t+t?t+t+t:t;return{changes:{from:f,to:f+m.length,insert:m},range:V.cursor(f+m.length)}}}else{if(e&&r.sliceDoc(f-2*t.length,f)==t+t&&(d=wp(r,f-2*t.length,n))>-1&&mp(r,d))return{changes:{insert:t+t+t+t,from:f},effects:Cn.of(f+t.length),range:V.cursor(f+t.length)};if(r.charCategorizer(f)(c)!=Ve.Word&&wp(r,f,n)>-1&&!WA(r,f,t,n))return{changes:{insert:t+t,from:f},effects:Cn.of(f+t.length),range:V.cursor(f+t.length)}}return{range:o=h}});return o?null:r.update(l,{scrollIntoView:!0,userEvent:"input.type"})}function mp(r,t){let e=Re(r).resolveInner(t+1);return e.parent&&e.from==t}function WA(r,t,e,i){let n=Re(r).resolveInner(t,-1),o=i.reduce((l,h)=>Math.max(l,h.length),0);for(let l=0;l<5;l++){let h=r.sliceDoc(n.from,Math.min(n.to,n.from+e.length+o)),f=h.indexOf(e);if(!f||f>-1&&i.indexOf(h.slice(0,f))>-1){let d=n.firstChild;for(;d&&d.from==n.from&&d.to-d.from>e.length+f;){if(r.sliceDoc(d.to-e.length,d.to)==e)return!1;d=d.firstChild}return!0}let c=n.to==t&&n.parent;if(!c)break;n=c}return!1}function wp(r,t,e){let i=r.charCategorizer(t);if(i(r.sliceDoc(t-1,t))!=Ve.Word)return t;for(let n of e){let o=t-n.length;if(r.sliceDoc(o,t)==n&&i(r.sliceDoc(o-1,o))!=Ve.Word)return o}return-1}function FA(r={}){return[TA,me,Xt.of(r),CA,zA,PA]}const HA=[{key:"Ctrl-Space",run:gp},{mac:"Alt-`",run:gp},{key:"Escape",run:bA},{key:"ArrowDown",run:To(!0)},{key:"ArrowUp",run:To(!1)},{key:"PageDown",run:To(!0,"page")},{key:"PageUp",run:To(!1,"page")},{key:"Enter",run:xA}],zA=as.highest(ef.computeN([Xt],r=>r.facet(Xt).defaultKeymap?[HA]:[])),Bh=Vi.define(),VA=Vi.define(),QA=X.define(),Am=X.define({combine(r){return rl(r,{minDepth:100,newGroupDelay:500,joinToEvent:(t,e)=>e},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(t,e)=>(i,n)=>t(i,n)||e(i,n)})}}),Tm=ve.define({create(){return vi.empty},update(r,t){let e=t.state.facet(Am),i=t.annotation(Bh);if(i){let f=we.fromTransaction(t,i.selection),c=i.side,d=c==0?r.undone:r.done;return f?d=jo(d,d.length,e.minDepth,f):d=Rm(d,t.startState.selection),new vi(c==0?i.rest:d,c==0?d:i.rest)}let n=t.annotation(VA);if((n=="full"||n=="before")&&(r=r.isolate()),t.annotation(Ut.addToHistory)===!1)return t.changes.empty?r:r.addMapping(t.changes.desc);let o=we.fromTransaction(t),l=t.annotation(Ut.time),h=t.annotation(Ut.userEvent);return o?r=r.addChanges(o,l,h,e,t):t.selection&&(r=r.addSelection(t.startState.selection,l,h,e.newGroupDelay)),(n=="full"||n=="after")&&(r=r.isolate()),r},toJSON(r){return{done:r.done.map(t=>t.toJSON()),undone:r.undone.map(t=>t.toJSON())}},fromJSON(r){return new vi(r.done.map(we.fromJSON),r.undone.map(we.fromJSON))}});function UA(r={}){return[Tm,Am.of(r),Z.domEventHandlers({beforeinput(t,e){let i=t.inputType=="historyUndo"?Pm:t.inputType=="historyRedo"?Lh:null;return i?(t.preventDefault(),i(e)):!1}})]}function hl(r,t){return function({state:e,dispatch:i}){if(!t&&e.readOnly)return!1;let n=e.field(Tm,!1);if(!n)return!1;let o=n.pop(r,e,t);return o?(i(o),!0):!1}}const Pm=hl(0,!1),Lh=hl(1,!1),qA=hl(0,!0),XA=hl(1,!0);class we{constructor(t,e,i,n,o){this.changes=t,this.effects=e,this.mapped=i,this.startSelection=n,this.selectionsAfter=o}setSelAfter(t){return new we(this.changes,this.effects,this.mapped,this.startSelection,t)}toJSON(){var t,e,i;return{changes:(t=this.changes)===null||t===void 0?void 0:t.toJSON(),mapped:(e=this.mapped)===null||e===void 0?void 0:e.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(n=>n.toJSON())}}static fromJSON(t){return new we(t.changes&&Vt.fromJSON(t.changes),[],t.mapped&&bi.fromJSON(t.mapped),t.startSelection&&V.fromJSON(t.startSelection),t.selectionsAfter.map(V.fromJSON))}static fromTransaction(t,e){let i=Ue;for(let n of t.startState.facet(QA)){let o=n(t);o.length&&(i=i.concat(o))}return!i.length&&t.changes.empty?null:new we(t.changes.invert(t.startState.doc),i,void 0,e||t.startState.selection,Ue)}static selection(t){return new we(void 0,Ue,void 0,void 0,t)}}function jo(r,t,e,i){let n=t+1>e+20?t-e-1:0,o=r.slice(n,t);return o.push(i),o}function YA(r,t){let e=[],i=!1;return r.iterChangedRanges((n,o)=>e.push(n,o)),t.iterChangedRanges((n,o,l,h)=>{for(let f=0;f<e.length;){let c=e[f++],d=e[f++];h>=c&&l<=d&&(i=!0)}}),i}function KA(r,t){return r.ranges.length==t.ranges.length&&r.ranges.filter((e,i)=>e.empty!=t.ranges[i].empty).length===0}function Mm(r,t){return r.length?t.length?r.concat(t):r:t}const Ue=[],GA=200;function Rm(r,t){if(r.length){let e=r[r.length-1],i=e.selectionsAfter.slice(Math.max(0,e.selectionsAfter.length-GA));return i.length&&i[i.length-1].eq(t)?r:(i.push(t),jo(r,r.length-1,1e9,e.setSelAfter(i)))}else return[we.selection([t])]}function ZA(r){let t=r[r.length-1],e=r.slice();return e[r.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1)),e}function Ya(r,t){if(!r.length)return r;let e=r.length,i=Ue;for(;e;){let n=jA(r[e-1],t,i);if(n.changes&&!n.changes.empty||n.effects.length){let o=r.slice(0,e);return o[e-1]=n,o}else t=n.mapped,e--,i=n.selectionsAfter}return i.length?[we.selection(i)]:Ue}function jA(r,t,e){let i=Mm(r.selectionsAfter.length?r.selectionsAfter.map(h=>h.map(t)):Ue,e);if(!r.changes)return we.selection(i);let n=r.changes.map(t),o=t.mapDesc(r.changes,!0),l=r.mapped?r.mapped.composeDesc(o):o;return new we(n,ft.mapEffects(r.effects,t),l,r.startSelection.map(o),i)}const JA=/^(input\.type|delete)($|\.)/;class vi{constructor(t,e,i=0,n=void 0){this.done=t,this.undone=e,this.prevTime=i,this.prevUserEvent=n}isolate(){return this.prevTime?new vi(this.done,this.undone):this}addChanges(t,e,i,n,o){let l=this.done,h=l[l.length-1];return h&&h.changes&&!h.changes.empty&&t.changes&&(!i||JA.test(i))&&(!h.selectionsAfter.length&&e-this.prevTime<n.newGroupDelay&&n.joinToEvent(o,YA(h.changes,t.changes))||i=="input.type.compose")?l=jo(l,l.length-1,n.minDepth,new we(t.changes.compose(h.changes),Mm(ft.mapEffects(t.effects,h.changes),h.effects),h.mapped,h.startSelection,Ue)):l=jo(l,l.length,n.minDepth,t),new vi(l,Ue,e,i)}addSelection(t,e,i,n){let o=this.done.length?this.done[this.done.length-1].selectionsAfter:Ue;return o.length>0&&e-this.prevTime<n&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&KA(o[o.length-1],t)?this:new vi(Rm(this.done,t),this.undone,e,i)}addMapping(t){return new vi(Ya(this.done,t),Ya(this.undone,t),this.prevTime,this.prevUserEvent)}pop(t,e,i){let n=t==0?this.done:this.undone;if(n.length==0)return null;let o=n[n.length-1],l=o.selectionsAfter[0]||e.selection;if(i&&o.selectionsAfter.length)return e.update({selection:o.selectionsAfter[o.selectionsAfter.length-1],annotations:Bh.of({side:t,rest:ZA(n),selection:l}),userEvent:t==0?"select.undo":"select.redo",scrollIntoView:!0});if(o.changes){let h=n.length==1?Ue:n.slice(0,n.length-1);return o.mapped&&(h=Ya(h,o.mapped)),e.update({changes:o.changes,selection:o.startSelection,effects:o.effects,annotations:Bh.of({side:t,rest:h,selection:l}),filter:!1,userEvent:t==0?"undo":"redo",scrollIntoView:!0})}else return null}}vi.empty=new vi(Ue,Ue);const tT=[{key:"Mod-z",run:Pm,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Lh,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Lh,preventDefault:!0},{key:"Mod-u",run:qA,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:XA,preventDefault:!0}];function eT(r,t){if(/\(\)|\[\]|\{\}/.test(r.sliceDoc(t-1,t+1)))return{from:t,to:t};let e=Re(r).resolveInner(t),i=e.childBefore(t),n=e.childAfter(t),o;return i&&n&&i.to<=t&&n.from>=t&&(o=i.type.prop(ot.closedBy))&&o.indexOf(n.name)>-1&&r.doc.lineAt(i.to).from==r.doc.lineAt(n.from).from&&!/\S/.test(r.sliceDoc(i.to,n.from))?{from:i.to,to:n.from}:null}const yp=iT(!1);function iT(r){return({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange(n=>{let{from:o,to:l}=n,h=t.doc.lineAt(o),f=!r&&o==l&&eT(t,o);r&&(o=l=(l<=h.to?h:t.doc.lineAt(l)).to);let c=new of(t,{simulateBreak:o,simulateDoubleBreak:!!f}),d=MC(c,o);for(d==null&&(d=lg(/^\s*/.exec(t.doc.lineAt(o).text)[0],t.tabSize));l<h.to&&/\s/.test(h.text[l-h.from]);)l++;f?{from:o,to:l}=f:o>h.from&&o<h.from+100&&!/\S/.test(h.text.slice(0,o))&&(o=h.from);let g=["",rp(t,d)];return f&&g.push(rp(t,c.lineIndent(h.from,-1))),{changes:{from:o,to:l,insert:ct.of(g)},range:V.cursor(o+1+g[1].length)}});return e(t.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}var vp={};class Jo{constructor(t,e,i,n,o,l,h,f,c,d=0,g){this.p=t,this.stack=e,this.state=i,this.reducePos=n,this.pos=o,this.score=l,this.buffer=h,this.bufferBase=f,this.curContext=c,this.lookAhead=d,this.parent=g}toString(){return`[${this.stack.filter((t,e)=>e%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(t,e,i=0){let n=t.parser.context;return new Jo(t,[],e,i,i,0,[],0,n?new xp(n,n.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(t,e){this.stack.push(this.state,e,this.bufferBase+this.buffer.length),this.state=t}reduce(t){var e;let i=t>>19,n=t&65535,{parser:o}=this.p,l=this.reducePos<this.pos-25;l&&this.setLookAhead(this.pos);let h=o.dynamicPrecedence(n);if(h&&(this.score+=h),i==0){this.pushState(o.getGoto(this.state,n,!0),this.reducePos),n<o.minRepeatTerm&&this.storeNode(n,this.reducePos,this.reducePos,l?8:4,!0),this.reduceContext(n,this.reducePos);return}let f=this.stack.length-(i-1)*3-(t&262144?6:0),c=f?this.stack[f-2]:this.p.ranges[0].from,d=this.reducePos-c;d>=2e3&&!(!((e=this.p.parser.nodeSet.types[n])===null||e===void 0)&&e.isAnonymous)&&(c==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=d):this.p.lastBigReductionSize<d&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=c,this.p.lastBigReductionSize=d));let g=f?this.stack[f-1]:0,m=this.bufferBase+this.buffer.length-g;if(n<o.minRepeatTerm||t&131072){let y=o.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(n,c,y,m+4,!0)}if(t&262144)this.state=this.stack[f];else{let y=this.stack[f-3];this.state=o.getGoto(y,n,!0)}for(;this.stack.length>f;)this.stack.pop();this.reduceContext(n,c)}storeNode(t,e,i,n=4,o=!1){if(t==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let l=this,h=this.buffer.length;if(h==0&&l.parent&&(h=l.bufferBase-l.parent.bufferBase,l=l.parent),h>0&&l.buffer[h-4]==0&&l.buffer[h-1]>-1){if(e==i)return;if(l.buffer[h-2]>=e){l.buffer[h-2]=i;return}}}if(!o||this.pos==i)this.buffer.push(t,e,i,n);else{let l=this.buffer.length;if(l>0&&this.buffer[l-4]!=0){let h=!1;for(let f=l;f>0&&this.buffer[f-2]>i;f-=4)if(this.buffer[f-1]>=0){h=!0;break}if(h)for(;l>0&&this.buffer[l-2]>i;)this.buffer[l]=this.buffer[l-4],this.buffer[l+1]=this.buffer[l-3],this.buffer[l+2]=this.buffer[l-2],this.buffer[l+3]=this.buffer[l-1],l-=4,n>4&&(n-=4)}this.buffer[l]=t,this.buffer[l+1]=e,this.buffer[l+2]=i,this.buffer[l+3]=n}}shift(t,e,i,n){if(t&131072)this.pushState(t&65535,this.pos);else if((t&262144)==0){let o=t,{parser:l}=this.p;(n>this.pos||e<=l.maxNode)&&(this.pos=n,l.stateFlag(o,1)||(this.reducePos=n)),this.pushState(o,i),this.shiftContext(e,i),e<=l.maxNode&&this.buffer.push(e,i,n,4)}else this.pos=n,this.shiftContext(e,i),e<=this.p.parser.maxNode&&this.buffer.push(e,i,n,4)}apply(t,e,i,n){t&65536?this.reduce(t):this.shift(t,e,i,n)}useNode(t,e){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=t)&&(this.p.reused.push(t),i++);let n=this.pos;this.reducePos=this.pos=n+t.length,this.pushState(e,n),this.buffer.push(i,n,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,t,this,this.p.stream.reset(this.pos-t.length)))}split(){let t=this,e=t.buffer.length;for(;e>0&&t.buffer[e-2]>t.reducePos;)e-=4;let i=t.buffer.slice(e),n=t.bufferBase+e;for(;t&&n==t.bufferBase;)t=t.parent;return new Jo(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,n,this.curContext,this.lookAhead,t)}recoverByDelete(t,e){let i=t<=this.p.parser.maxNode;i&&this.storeNode(t,this.pos,e,4),this.storeNode(0,this.pos,e,i?8:4),this.pos=this.reducePos=e,this.score-=190}canShift(t){for(let e=new nT(this);;){let i=this.p.parser.stateSlot(e.state,4)||this.p.parser.hasAction(e.state,t);if(i==0)return!1;if((i&65536)==0)return!0;e.reduce(i)}}recoverByInsert(t){if(this.stack.length>=300)return[];let e=this.p.parser.nextStates(this.state);if(e.length>8||this.stack.length>=120){let n=[];for(let o=0,l;o<e.length;o+=2)(l=e[o+1])!=this.state&&this.p.parser.hasAction(l,t)&&n.push(e[o],l);if(this.stack.length<120)for(let o=0;n.length<8&&o<e.length;o+=2){let l=e[o+1];n.some((h,f)=>f&1&&h==l)||n.push(e[o],l)}e=n}let i=[];for(let n=0;n<e.length&&i.length<4;n+=2){let o=e[n+1];if(o==this.state)continue;let l=this.split();l.pushState(o,this.pos),l.storeNode(0,l.pos,l.pos,4,!0),l.shiftContext(e[n],this.pos),l.reducePos=this.pos,l.score-=200,i.push(l)}return i}forceReduce(){let{parser:t}=this.p,e=t.stateSlot(this.state,5);if((e&65536)==0)return!1;if(!t.validAction(this.state,e)){let i=e>>19,n=e&65535,o=this.stack.length-i*3;if(o<0||t.getGoto(this.stack[o],n,!1)<0){let l=this.findForcedReduction();if(l==null)return!1;e=l}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(e),!0}findForcedReduction(){let{parser:t}=this.p,e=[],i=(n,o)=>{if(!e.includes(n))return e.push(n),t.allActions(n,l=>{if(!(l&393216))if(l&65536){let h=(l>>19)-o;if(h>1){let f=l&65535,c=this.stack.length-h*3;if(c>=0&&t.getGoto(this.stack[c],f,!1)>=0)return h<<19|65536|f}}else{let h=i(l,o+1);if(h!=null)return h}})};return i(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:t}=this.p;return t.data[t.stateSlot(this.state,1)]==65535&&!t.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(t){if(this.state!=t.state||this.stack.length!=t.stack.length)return!1;for(let e=0;e<this.stack.length;e+=3)if(this.stack[e]!=t.stack[e])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(t){return this.p.parser.dialect.flags[t]}shiftContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,t,this,this.p.stream.reset(e)))}reduceContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,t,this,this.p.stream.reset(e)))}emitContext(){let t=this.buffer.length-1;(t<0||this.buffer[t]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let t=this.buffer.length-1;(t<0||this.buffer[t]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(t){if(t!=this.curContext.context){let e=new xp(this.curContext.tracker,t);e.hash!=this.curContext.hash&&this.emitContext(),this.curContext=e}}setLookAhead(t){t>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=t)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class xp{constructor(t,e){this.tracker=t,this.context=e,this.hash=t.strict?t.hash(e):0}}class nT{constructor(t){this.start=t,this.state=t.state,this.stack=t.stack,this.base=this.stack.length}reduce(t){let e=t&65535,i=t>>19;i==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(i-1)*3;let n=this.start.p.parser.getGoto(this.stack[this.base-3],e,!0);this.state=n}}class tl{constructor(t,e,i){this.stack=t,this.pos=e,this.index=i,this.buffer=t.buffer,this.index==0&&this.maybeNext()}static create(t,e=t.bufferBase+t.buffer.length){return new tl(t,e,e-t.bufferBase)}maybeNext(){let t=this.stack.parent;t!=null&&(this.index=this.stack.bufferBase-t.bufferBase,this.stack=t,this.buffer=t.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new tl(this.stack,this.pos,this.index)}}function Qr(r,t=Uint16Array){if(typeof r!="string")return r;let e=null;for(let i=0,n=0;i<r.length;){let o=0;for(;;){let l=r.charCodeAt(i++),h=!1;if(l==126){o=65535;break}l>=92&&l--,l>=34&&l--;let f=l-32;if(f>=46&&(f-=46,h=!0),o+=f,h)break;o*=46}e?e[n++]=o:e=new t(o)}return e}class No{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const bp=new No;class rT{constructor(t,e){this.input=t,this.ranges=e,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=bp,this.rangeIndex=0,this.pos=this.chunkPos=e[0].from,this.range=e[0],this.end=e[e.length-1].to,this.readNext()}resolveOffset(t,e){let i=this.range,n=this.rangeIndex,o=this.pos+t;for(;o<i.from;){if(!n)return null;let l=this.ranges[--n];o-=i.from-l.to,i=l}for(;e<0?o>i.to:o>=i.to;){if(n==this.ranges.length-1)return null;let l=this.ranges[++n];o+=l.from-i.to,i=l}return o}clipPos(t){if(t>=this.range.from&&t<this.range.to)return t;for(let e of this.ranges)if(e.to>t)return Math.max(t,e.from);return this.end}peek(t){let e=this.chunkOff+t,i,n;if(e>=0&&e<this.chunk.length)i=this.pos+t,n=this.chunk.charCodeAt(e);else{let o=this.resolveOffset(t,1);if(o==null)return-1;if(i=o,i>=this.chunk2Pos&&i<this.chunk2Pos+this.chunk2.length)n=this.chunk2.charCodeAt(i-this.chunk2Pos);else{let l=this.rangeIndex,h=this.range;for(;h.to<=i;)h=this.ranges[++l];this.chunk2=this.input.chunk(this.chunk2Pos=i),i+this.chunk2.length>h.to&&(this.chunk2=this.chunk2.slice(0,h.to-i)),n=this.chunk2.charCodeAt(0)}}return i>=this.token.lookAhead&&(this.token.lookAhead=i+1),n}acceptToken(t,e=0){let i=e?this.resolveOffset(e,-1):this.pos;if(i==null||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=t,this.token.end=i}acceptTokenTo(t,e){this.token.value=t,this.token.end=e}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:t,chunkPos:e}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=t,this.chunk2Pos=e,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let t=this.input.chunk(this.pos),e=this.pos+t.length;this.chunk=e>this.range.to?t.slice(0,this.range.to-this.pos):t,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(t=1){for(this.chunkOff+=t;this.pos+t>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();t-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=t,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(t,e){if(e?(this.token=e,e.start=t,e.lookAhead=t+1,e.value=e.extended=-1):this.token=bp,this.pos!=t){if(this.pos=t,t==this.end)return this.setDone(),this;for(;t<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;t>=this.range.to;)this.range=this.ranges[++this.rangeIndex];t>=this.chunkPos&&t<this.chunkPos+this.chunk.length?this.chunkOff=t-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(t,e){if(t>=this.chunkPos&&e<=this.chunkPos+this.chunk.length)return this.chunk.slice(t-this.chunkPos,e-this.chunkPos);if(t>=this.chunk2Pos&&e<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(t-this.chunk2Pos,e-this.chunk2Pos);if(t>=this.range.from&&e<=this.range.to)return this.input.read(t,e);let i="";for(let n of this.ranges){if(n.from>=e)break;n.to>t&&(i+=this.input.read(Math.max(n.from,t),Math.min(n.to,e)))}return i}}class Jn{constructor(t,e){this.data=t,this.id=e}token(t,e){let{parser:i}=e.p;Em(this.data,t,e,this.id,i.data,i.tokenPrecTable)}}Jn.prototype.contextual=Jn.prototype.fallback=Jn.prototype.extend=!1;class _m{constructor(t,e,i){this.precTable=e,this.elseToken=i,this.data=typeof t=="string"?Qr(t):t}token(t,e){let i=t.pos,n=0;for(;;){let o=t.next<0,l=t.resolveOffset(1,1);if(Em(this.data,t,e,0,this.data,this.precTable),t.token.value>-1)break;if(this.elseToken==null)return;if(o||n++,l==null)break;t.reset(l,t.token)}n&&(t.reset(i,t.token),t.acceptToken(this.elseToken,n))}}_m.prototype.contextual=Jn.prototype.fallback=Jn.prototype.extend=!1;function Em(r,t,e,i,n,o){let l=0,h=1<<i,{dialect:f}=e.p.parser;t:for(;(h&r[l])!=0;){let c=r[l+1];for(let y=l+3;y<c;y+=2)if((r[y+1]&h)>0){let b=r[y];if(f.allows(b)&&(t.token.value==-1||t.token.value==b||sT(b,t.token.value,n,o))){t.acceptToken(b);break}}let d=t.next,g=0,m=r[l+2];if(t.next<0&&m>g&&r[c+m*3-3]==65535){l=r[c+m*3-1];continue t}for(;g<m;){let y=g+m>>1,b=c+y+(y<<1),S=r[b],A=r[b+1]||65536;if(d<S)m=y;else if(d>=A)g=y+1;else{l=r[b+2],t.advance();continue t}}break}}function Op(r,t,e){for(let i=t,n;(n=r[i])!=65535;i++)if(n==e)return i-t;return-1}function sT(r,t,e,i){let n=Op(e,i,t);return n<0||Op(e,i,r)<n}const Te=typeof process<"u"&&vp&&/\bparse\b/.test(vp.LOG);let Ka=null;function Sp(r,t,e){let i=r.cursor(Mt.IncludeAnonymous);for(i.moveTo(t);;)if(!(e<0?i.childBefore(t):i.childAfter(t)))for(;;){if((e<0?i.to<t:i.from>t)&&!i.type.isError)return e<0?Math.max(0,Math.min(i.to-1,t-25)):Math.min(r.length,Math.max(i.from+1,t+25));if(e<0?i.prevSibling():i.nextSibling())break;if(!i.parent())return e<0?0:r.length}}class oT{constructor(t,e){this.fragments=t,this.nodeSet=e,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let t=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(t){for(this.safeFrom=t.openStart?Sp(t.tree,t.from+t.offset,1)-t.offset:t.from,this.safeTo=t.openEnd?Sp(t.tree,t.to+t.offset,-1)-t.offset:t.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(t.tree),this.start.push(-t.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(t){if(t<this.nextStart)return null;for(;this.fragment&&this.safeTo<=t;)this.nextFragment();if(!this.fragment)return null;for(;;){let e=this.trees.length-1;if(e<0)return this.nextFragment(),null;let i=this.trees[e],n=this.index[e];if(n==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let o=i.children[n],l=this.start[e]+i.positions[n];if(l>t)return this.nextStart=l,null;if(o instanceof _t){if(l==t){if(l<this.safeFrom)return null;let h=l+o.length;if(h<=this.safeTo){let f=o.prop(ot.lookAhead);if(!f||h+f<this.fragment.to)return o}}this.index[e]++,l+o.length>=Math.max(this.safeFrom,t)&&(this.trees.push(o),this.start.push(l),this.index.push(0))}else this.index[e]++,this.nextStart=l+o.length}}}class lT{constructor(t,e){this.stream=e,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=t.tokenizers.map(i=>new No)}getActions(t){let e=0,i=null,{parser:n}=t.p,{tokenizers:o}=n,l=n.stateSlot(t.state,3),h=t.curContext?t.curContext.hash:0,f=0;for(let c=0;c<o.length;c++){if((1<<c&l)==0)continue;let d=o[c],g=this.tokens[c];if(!(i&&!d.fallback)&&((d.contextual||g.start!=t.pos||g.mask!=l||g.context!=h)&&(this.updateCachedToken(g,d,t),g.mask=l,g.context=h),g.lookAhead>g.end+25&&(f=Math.max(g.lookAhead,f)),g.value!=0)){let m=e;if(g.extended>-1&&(e=this.addActions(t,g.extended,g.end,e)),e=this.addActions(t,g.value,g.end,e),!d.extend&&(i=g,e>m))break}}for(;this.actions.length>e;)this.actions.pop();return f&&t.setLookAhead(f),!i&&t.pos==this.stream.end&&(i=new No,i.value=t.p.parser.eofTerm,i.start=i.end=t.pos,e=this.addActions(t,i.value,i.end,e)),this.mainToken=i,this.actions}getMainToken(t){if(this.mainToken)return this.mainToken;let e=new No,{pos:i,p:n}=t;return e.start=i,e.end=Math.min(i+1,n.stream.end),e.value=i==n.stream.end?n.parser.eofTerm:0,e}updateCachedToken(t,e,i){let n=this.stream.clipPos(i.pos);if(e.token(this.stream.reset(n,t),i),t.value>-1){let{parser:o}=i.p;for(let l=0;l<o.specialized.length;l++)if(o.specialized[l]==t.value){let h=o.specializers[l](this.stream.read(t.start,t.end),i);if(h>=0&&i.p.parser.dialect.allows(h>>1)){(h&1)==0?t.value=h>>1:t.extended=h>>1;break}}}else t.value=0,t.end=this.stream.clipPos(n+1)}putAction(t,e,i,n){for(let o=0;o<n;o+=3)if(this.actions[o]==t)return n;return this.actions[n++]=t,this.actions[n++]=e,this.actions[n++]=i,n}addActions(t,e,i,n){let{state:o}=t,{parser:l}=t.p,{data:h}=l;for(let f=0;f<2;f++)for(let c=l.stateSlot(o,f?2:1);;c+=3){if(h[c]==65535)if(h[c+1]==1)c=Ni(h,c+2);else{n==0&&h[c+1]==2&&(n=this.putAction(Ni(h,c+2),e,i,n));break}h[c]==e&&(n=this.putAction(Ni(h,c+1),e,i,n))}return n}}class aT{constructor(t,e,i,n){this.parser=t,this.input=e,this.ranges=n,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new rT(e,n),this.tokens=new lT(t,this.stream),this.topTerm=t.top[1];let{from:o}=n[0];this.stacks=[Jo.start(this,t.top[0],o)],this.fragments=i.length&&this.stream.end-o>t.bufferLength*4?new oT(i,t.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let t=this.stacks,e=this.minStackPos,i=this.stacks=[],n,o;if(this.bigReductionCount>300&&t.length==1){let[l]=t;for(;l.forceReduce()&&l.stack.length&&l.stack[l.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let l=0;l<t.length;l++){let h=t[l];for(;;){if(this.tokens.mainToken=null,h.pos>e)i.push(h);else{if(this.advanceStack(h,i,t))continue;{n||(n=[],o=[]),n.push(h);let f=this.tokens.getMainToken(h);o.push(f.value,f.end)}}break}}if(!i.length){let l=n&&fT(n);if(l)return Te&&console.log("Finish with "+this.stackID(l)),this.stackToTree(l);if(this.parser.strict)throw Te&&n&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+e);this.recovering||(this.recovering=5)}if(this.recovering&&n){let l=this.stoppedAt!=null&&n[0].pos>this.stoppedAt?n[0]:this.runRecovery(n,o,i);if(l)return Te&&console.log("Force-finish "+this.stackID(l)),this.stackToTree(l.forceAll())}if(this.recovering){let l=this.recovering==1?1:this.recovering*3;if(i.length>l)for(i.sort((h,f)=>f.score-h.score);i.length>l;)i.pop();i.some(h=>h.reducePos>e)&&this.recovering--}else if(i.length>1){t:for(let l=0;l<i.length-1;l++){let h=i[l];for(let f=l+1;f<i.length;f++){let c=i[f];if(h.sameState(c)||h.buffer.length>500&&c.buffer.length>500)if((h.score-c.score||h.buffer.length-c.buffer.length)>0)i.splice(f--,1);else{i.splice(l--,1);continue t}}}i.length>12&&i.splice(12,i.length-12)}this.minStackPos=i[0].pos;for(let l=1;l<i.length;l++)i[l].pos<this.minStackPos&&(this.minStackPos=i[l].pos);return null}stopAt(t){if(this.stoppedAt!=null&&this.stoppedAt<t)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=t}advanceStack(t,e,i){let n=t.pos,{parser:o}=this,l=Te?this.stackID(t)+" -> ":"";if(this.stoppedAt!=null&&n>this.stoppedAt)return t.forceReduce()?t:null;if(this.fragments){let c=t.curContext&&t.curContext.tracker.strict,d=c?t.curContext.hash:0;for(let g=this.fragments.nodeAt(n);g;){let m=this.parser.nodeSet.types[g.type.id]==g.type?o.getGoto(t.state,g.type.id):-1;if(m>-1&&g.length&&(!c||(g.prop(ot.contextHash)||0)==d))return t.useNode(g,m),Te&&console.log(l+this.stackID(t)+` (via reuse of ${o.getName(g.type.id)})`),!0;if(!(g instanceof _t)||g.children.length==0||g.positions[0]>0)break;let y=g.children[0];if(y instanceof _t&&g.positions[0]==0)g=y;else break}}let h=o.stateSlot(t.state,4);if(h>0)return t.reduce(h),Te&&console.log(l+this.stackID(t)+` (via always-reduce ${o.getName(h&65535)})`),!0;if(t.stack.length>=8400)for(;t.stack.length>6e3&&t.forceReduce(););let f=this.tokens.getActions(t);for(let c=0;c<f.length;){let d=f[c++],g=f[c++],m=f[c++],y=c==f.length||!i,b=y?t:t.split(),S=this.tokens.mainToken;if(b.apply(d,g,S?S.start:b.pos,m),Te&&console.log(l+this.stackID(b)+` (via ${(d&65536)==0?"shift":`reduce of ${o.getName(d&65535)}`} for ${o.getName(g)} @ ${n}${b==t?"":", split"})`),y)return!0;b.pos>n?e.push(b):i.push(b)}return!1}advanceFully(t,e){let i=t.pos;for(;;){if(!this.advanceStack(t,null,null))return!1;if(t.pos>i)return kp(t,e),!0}}runRecovery(t,e,i){let n=null,o=!1;for(let l=0;l<t.length;l++){let h=t[l],f=e[l<<1],c=e[(l<<1)+1],d=Te?this.stackID(h)+" -> ":"";if(h.deadEnd&&(o||(o=!0,h.restart(),Te&&console.log(d+this.stackID(h)+" (restarted)"),this.advanceFully(h,i))))continue;let g=h.split(),m=d;for(let y=0;g.forceReduce()&&y<10&&(Te&&console.log(m+this.stackID(g)+" (via force-reduce)"),!this.advanceFully(g,i));y++)Te&&(m=this.stackID(g)+" -> ");for(let y of h.recoverByInsert(f))Te&&console.log(d+this.stackID(y)+" (via recover-insert)"),this.advanceFully(y,i);this.stream.end>h.pos?(c==h.pos&&(c++,f=0),h.recoverByDelete(f,c),Te&&console.log(d+this.stackID(h)+` (via recover-delete ${this.parser.getName(f)})`),kp(h,i)):(!n||n.score<h.score)&&(n=h)}return n}stackToTree(t){return t.close(),_t.build({buffer:tl.create(t),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:t.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(t){let e=(Ka||(Ka=new WeakMap)).get(t);return e||Ka.set(t,e=String.fromCodePoint(this.nextStackID++)),e+t}}function kp(r,t){for(let e=0;e<t.length;e++){let i=t[e];if(i.pos==r.pos&&i.sameState(r)){t[e].score<r.score&&(t[e]=r);return}}t.push(r)}class hT{constructor(t,e,i){this.source=t,this.flags=e,this.disabled=i}allows(t){return!this.disabled||this.disabled[t]==0}}class ls extends Hp{constructor(t){if(super(),this.wrappers=[],t.version!=14)throw new RangeError(`Parser version (${t.version}) doesn't match runtime version (14)`);let e=t.nodeNames.split(" ");this.minRepeatTerm=e.length;for(let h=0;h<t.repeatNodeCount;h++)e.push("");let i=Object.keys(t.topRules).map(h=>t.topRules[h][1]),n=[];for(let h=0;h<e.length;h++)n.push([]);function o(h,f,c){n[h].push([f,f.deserialize(String(c))])}if(t.nodeProps)for(let h of t.nodeProps){let f=h[0];typeof f=="string"&&(f=ot[f]);for(let c=1;c<h.length;){let d=h[c++];if(d>=0)o(d,f,h[c++]);else{let g=h[c+-d];for(let m=-d;m>0;m--)o(h[c++],f,g);c++}}}this.nodeSet=new $h(e.map((h,f)=>he.define({name:f>=this.minRepeatTerm?void 0:h,id:f,props:n[f],top:i.indexOf(f)>-1,error:f==0,skipped:t.skippedNodes&&t.skippedNodes.indexOf(f)>-1}))),t.propSources&&(this.nodeSet=this.nodeSet.extend(...t.propSources)),this.strict=!1,this.bufferLength=Np;let l=Qr(t.tokenData);this.context=t.context,this.specializerSpecs=t.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let h=0;h<this.specializerSpecs.length;h++)this.specialized[h]=this.specializerSpecs[h].term;this.specializers=this.specializerSpecs.map(Cp),this.states=Qr(t.states,Uint32Array),this.data=Qr(t.stateData),this.goto=Qr(t.goto),this.maxTerm=t.maxTerm,this.tokenizers=t.tokenizers.map(h=>typeof h=="number"?new Jn(l,h):h),this.topRules=t.topRules,this.dialects=t.dialects||{},this.dynamicPrecedences=t.dynamicPrecedences||null,this.tokenPrecTable=t.tokenPrec,this.termNames=t.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(t,e,i){let n=new aT(this,t,e,i);for(let o of this.wrappers)n=o(n,t,e,i);return n}getGoto(t,e,i=!1){let n=this.goto;if(e>=n[0])return-1;for(let o=n[e+1];;){let l=n[o++],h=l&1,f=n[o++];if(h&&i)return f;for(let c=o+(l>>1);o<c;o++)if(n[o]==t)return f;if(h)return-1}}hasAction(t,e){let i=this.data;for(let n=0;n<2;n++)for(let o=this.stateSlot(t,n?2:1),l;;o+=3){if((l=i[o])==65535)if(i[o+1]==1)l=i[o=Ni(i,o+2)];else{if(i[o+1]==2)return Ni(i,o+2);break}if(l==e||l==0)return Ni(i,o+1)}return 0}stateSlot(t,e){return this.states[t*6+e]}stateFlag(t,e){return(this.stateSlot(t,0)&e)>0}validAction(t,e){return!!this.allActions(t,i=>i==e?!0:null)}allActions(t,e){let i=this.stateSlot(t,4),n=i?e(i):void 0;for(let o=this.stateSlot(t,1);n==null;o+=3){if(this.data[o]==65535)if(this.data[o+1]==1)o=Ni(this.data,o+2);else break;n=e(Ni(this.data,o+1))}return n}nextStates(t){let e=[];for(let i=this.stateSlot(t,1);;i+=3){if(this.data[i]==65535)if(this.data[i+1]==1)i=Ni(this.data,i+2);else break;if((this.data[i+2]&1)==0){let n=this.data[i+1];e.some((o,l)=>l&1&&o==n)||e.push(this.data[i],n)}}return e}configure(t){let e=Object.assign(Object.create(ls.prototype),this);if(t.props&&(e.nodeSet=this.nodeSet.extend(...t.props)),t.top){let i=this.topRules[t.top];if(!i)throw new RangeError(`Invalid top rule name ${t.top}`);e.top=i}return t.tokenizers&&(e.tokenizers=this.tokenizers.map(i=>{let n=t.tokenizers.find(o=>o.from==i);return n?n.to:i})),t.specializers&&(e.specializers=this.specializers.slice(),e.specializerSpecs=this.specializerSpecs.map((i,n)=>{let o=t.specializers.find(h=>h.from==i.external);if(!o)return i;let l=Object.assign(Object.assign({},i),{external:o.to});return e.specializers[n]=Cp(l),l})),t.contextTracker&&(e.context=t.contextTracker),t.dialect&&(e.dialect=this.parseDialect(t.dialect)),t.strict!=null&&(e.strict=t.strict),t.wrap&&(e.wrappers=e.wrappers.concat(t.wrap)),t.bufferLength!=null&&(e.bufferLength=t.bufferLength),e}hasWrappers(){return this.wrappers.length>0}getName(t){return this.termNames?this.termNames[t]:String(t<=this.maxNode&&this.nodeSet.types[t].name||t)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(t){let e=this.dynamicPrecedences;return e==null?0:e[t]||0}parseDialect(t){let e=Object.keys(this.dialects),i=e.map(()=>!1);if(t)for(let o of t.split(" ")){let l=e.indexOf(o);l>=0&&(i[l]=!0)}let n=null;for(let o=0;o<e.length;o++)if(!i[o])for(let l=this.dialects[e[o]],h;(h=this.data[l++])!=65535;)(n||(n=new Uint8Array(this.maxTerm+1)))[h]=1;return new hT(t,i,n)}static deserialize(t){return new ls(t)}}function Ni(r,t){return r[t]|r[t+1]<<16}function fT(r){let t=null;for(let e of r){let i=e.p.stoppedAt;(e.pos==e.p.stream.end||i!=null&&e.pos>i)&&e.p.parser.stateFlag(e.state,2)&&(!t||t.score<e.score)&&(t=e)}return t}function Cp(r){if(r.external){let t=r.extend?1:0;return(e,i)=>r.external(e,i)<<1|t}return r.get}const uT=sf({TemplateString:I.special(I.string),BooleanLiteral:I.bool,null:I.null,VariableName:I.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":I.function(I.variableName),PropertyName:I.propertyName,"CallExpression/MemberExpression/PropertyName":I.function(I.propertyName),PropertyDefinition:I.definition(I.propertyName),Number:I.number,String:I.string,Escape:I.escape,ArithOp:I.arithmeticOperator,LogicOp:I.logicOperator,"and or":I.logicOperator,as:I.keyword,CallbackReference:I.self,CompareOp:I.compareOperator,":":I.punctuation,"( )":I.paren,"[ ]":I.squareBracket,"{ }":I.brace,"InterpolationStart InterpolationEnd":I.brace,".":I.derefOperator,", ;":I.separator}),cT={__proto__:null,true:20,false:20,null:22,as:68,and:90,or:92},Dm=ls.deserialize({version:14,states:"2`QVQPOOO!QOQO'#C_O!]OSO'#C_O!hOpO'#C`OOQO'#Ce'#CeO!sQPO'#CjO#`QWO'#CnOVQPO'#CrOVQPO'#CwO$nQPO'#DtOOQO'#Du'#DuO%nQPO'#DuOOQO'#Dt'#DtO'kQPO'#DsOOQO'#Ds'#DsOOQO'#Dh'#DhQVQPOOOOOO'#Di'#DiO(lOQO,58yOOQO,58y,58yOOOO'#Dj'#DjO(wOSO,58yO)SQPO'#CbOOOO'#Dk'#DkO)ZOpO,58zOOQO,58z,58zO)fQPO'#DlO)pQPO'#EPO)xQPO'#EPO*SQPO,59UOOQO'#Cp'#CpOOQO'#ER'#EROVQPO'#ERO*XQWO'#CoO*dQWO'#EQO*lQWO,59YO+xQPO,59^O-OQPO,59cO-TQPO'#C|O-[QWO'#DPO-aQPO'#DQOOQO,59d,59dOVQPO,59mOVQPO,59mOVQPO,59mOVQPO,59mOVQPO,59mOOQO'#D_'#D_OVQPO,59xOOQO,59{,59{OOQO,59|,59|OOQO,59},59}OVQPO'#DoO-hQPO,5:OOVQPO,59mOVQPO,59mOVQPO,5:QOOQO,5:_,5:_OOQO-E7f-E7fOOOO-E7g-E7gOOQO1G.e1G.eOOOO-E7h-E7hOOOO,58|,58|O.uQPO,58|OOOO-E7i-E7iOOQO1G.f1G.fO.zQPO,5:WOOQO-E7j-E7jO/UQPO,5:kOOQO1G.p1G.pO/^QPO,5:mO/cQPO,59ZO0^QWO'#DmO0hQWO,5:lOOQO1G.t1G.tOOQO1G.}1G.}O0pQPO'#C}O0}QPO'#ETO1VQPO,59hOOQO'#C{'#C{O2fQPO,59kOOQO,59l,59lO3iQPO,59lO5kQPO1G/XO5{QPO1G/XO8`QPO1G/XO8jQPO1G/XO:zQPO1G/XO;RQPO1G/dO;YQPO,5:ZOOQO-E7m-E7mO>`QPO1G/XO>gQPO1G/XO>nQPO1G/lOOOO1G.h1G.hOOQO1G0X1G0XO@vQ`O1G.uOOQO,5:X,5:XOOQO-E7k-E7kO{QPO,59iOAQQPO'#DnOA[QPO,5:oOOQO1G/S1G/SOOQO1G/P1G/POOQO1G/W1G/WOVQPO7+%OOOQO7+%W7+%WOAdQ`O,59^OOQO1G/T1G/TOOQO,5:Y,5:YOOQO-E7l-E7lOAnQPO<<HjOBtQ`O,59kOC|Q`O1G/XOD^Q`O1G/XOEuQ`O1G/XOFPQ`O1G/XOGeQ`O1G/XOHvQ`O1G/XOH}Q`O1G/XOIUQ`O<<HjO/cQPO'#CrO-[QWO'#DPO/cQPO,59mO/cQPO,59mO/cQPO,59mO/cQPO,59mO/cQPO,59mO/cQPO,59mO/cQPO,59mO/cQPO7+%OOI`QPO1G/dOVQPO,59x",stateData:"Im~O!fOS~OQYOWYOYYOZYO]TOaUOgVOhVOjWO!jPO!mQO!oRO!rSO~O!jcO!kaO!lcO~O!lcO!mcO!ndO~OVfO!pgO!qiO~O_jO[!sP~PVOQoO]pO!jPO!mQO!vnO~O`!tP~P!}O]xOg!ROh{OjvOnwOvzOwzOxzOyzOz|O{|O|}O}!WO!O!XO!P!OO!oRO!x!PO~O_!UOQ!hXW!hXY!hXZ!hXa!hX!X!hX!d!hX!j!hX!m!hX!r!hXi!hXT!hX[!hX~P#gO!Z!YOQ!iXW!iXY!iXZ!iX]!iX_!iXa!iXg!iXh!iXj!iXn!iXv!iXw!iXx!iXy!iXz!iX{!iX|!iX}!iX!O!iX!P!iX!X!iX!d!iX!j!iX!m!iX!o!iX!r!iX!x!iX~O!X!ZOQ!gXW!gXY!gXZ!gX]!gXa!gXg!gXh!gXj!gX!d!gX!j!gX!m!gX!o!gX!r!gX~O!j!^O!kaO!l!^O~O!l!^O!m!^O!ndO~OT!`O~PVOVfO!pgO!q!cO~O[!`X_!`X~PVO_jO[!sX~O_jO[!sX~P#gO[!gO~Oe!iO_cX`cX~O_!jO`!tX~O`!lO~O]xOjvO!oRO_fagfahfavfawfaxfayfazfa{fa|fa}fa!Ofa!Pfa!xfa~OnwOQfaWfaYfaZfaafa!Xfa!dfa!jfa!mfa!rfa[faifaTfarfa!Sfa~P*qOi!mO~Oi!wP~PVO!v!qO~O[!sO~PVO_!UOQ!WaW!WaY!WaZ!Wa]!Waa!Wag!Wah!Waj!Wa!X!Wa!d!Wa!j!Wa!m!Wa!o!Wa!r!Wai!WaT!Wa[!Wa~OT#QO~O[!`a_!`a~P#gO_jO[!sa~O[#RO~OQYOWYOYYOZYO]TOaUOg#mOh#mOjWO!jPO!mQO!oRO!rSO~O_!aX`!aX~P!}O_!jO`!ta~Or#VO_qXiqX~P#gO_#WOi!wX~Oi#YO~OjvO]sa_sagsahsansavsawsaxsaysazsa{sa|sa}sa!Osa!Psa!osa!xsa~OQsaWsaYsaZsaasa!Xsa!dsa!jsa!msa!rsa[saisaTsarsa!Ssa~P1[O[#[O~O]xOg!ROjvOnwO!oROQuiWuiYuiZui_uiauihuizui{ui|ui}ui!Oui!Pui!Xui!dui!jui!mui!rui!xui[uiiuiTuirui!Sui~Ovuiwuixuiyui~P3nOvzOwzOxzOyzO~P3nO]xOg!ROh{OjvOnwOvzOwzOxzOyzO!oROQuiWuiYuiZui_uiaui|ui}ui!Oui!Pui!Xui!dui!jui!mui!rui!xui[uiiuiTuirui!Sui~Ozui{ui~P6]Oz|O{|O~P6]O]xOg!ROh{OjvOnwOvzOwzOxzOyzOz|O{|O|}O}!WO!oROQuiWuiYuiZui_uiaui!Pui!Xui!dui!jui!mui!rui!xui[uiiuiTuirui!Sui~O!O!XO~P8tO!S#]O~P#gOQ!caW!caY!caZ!ca_!caa!ca!X!ca!d!ca!j!ca!m!ca!r!cai!caT!ca[!ca~P#gO]xOg!ROh{OjvOnwOvzOwzOxzOyzOz|O{|O|}O!oROQuiWuiYuiZui_uiaui!Oui!Pui!Xui!dui!jui!mui!rui!xui[uiiuiTuirui!Sui~O}ui~P<YO!Oui~P8tO!X#^OQ!YiW!YiY!YiZ!Yi]!Yia!Yig!Yih!Yij!Yi!d!Yi!j!Yi!m!Yi!o!Yi!r!Yi~O]xOg!ROh#pOjvOn#nOv#oOw#oOx#oOy#oOz#qO{#qO|#rO}#tO!O#uO!P#sO!oRO!x!PO~O_ci`ci~P?oO_!bXi!bX~PVO_#WOi!wa~On#nO`fa~P*qOQ!QyW!QyY!QyZ!Qy_!Qya!Qy!X!Qy!d!Qy!j!Qy!m!Qy!r!Qy[!Qyi!QyT!Qyr!Qy!S!Qy~P#gO`sa~P1[O]xOg!ROjvOn#nO!oRO_ui`uihuizui{ui|ui}ui!Oui!Pui!xui~Ovuiwuixuiyui~PB{Ov#oOw#oOx#oOy#oO~PB{O]xOg!ROh#pOjvOn#nOv#oOw#oOx#oOy#oO!oRO_ui`ui|ui}ui!Oui!Pui!xui~Ozui{ui~PDnOz#qO{#qO~PDnO]xOg!ROh#pOjvOn#nOv#oOw#oOx#oOy#oOz#qO{#qO|#rO}#tO!oRO_ui`ui!Pui!xui~O!O#uO~PFZO]xOg!ROh#pOjvOn#nOv#oOw#oOx#oOy#oOz#qO{#qO|#rO!oRO_ui`ui!Oui!Pui!xui~O}ui~PGlO!Oui~PFZO_!Qy`!Qy~P?oO!S#vO~P#gO!f!rQn!v~",goto:",x!xPPP!y#rP%TPP%XPPPP&RPPP&R&v#nP&RPPPP&R&R&|P'j'p(bP&|&|&RPPPPPPPPPP&R(hP&R&R&R(vP)PP)T)Z)a)g)m)w)}*TPPP*Z*_*rPPPPPPPPP,k,n,qP,u!dYOTVW`fjpvxz{|}!O!Q!U!W!X!Y!i#W#]#m#o#p#q#r#s#t#u#v#xToU!j!dYOTVW`fjpvxz{|}!O!Q!U!W!X!Y!i#W#]#m#o#p#q#r#s#t#u#v#x!V!TXlt!d!n!u!v!w!x!y!z!{!}#O#S#_#c#e#f#g#h#i#j#k#l#wTgRh!`YTVWfjpvxz{|}!O!Q!U!W!X!Y!i#W#]#m#o#p#q#r#s#t#u#v#xSZO`R#`#V!eYOTVW`fjpvxz{|}!O!Q!U!W!X!Y!i#W#]#m#o#p#q#r#s#t#u#v#xQrUR#T!j!VyXlt!d!n!u!v!w!x!y!z!{!}#O#S#_#c#e#f#g#h#i#j#k#l#wQ!rwR#d#n!U!SXlt!d!n!u!v!w!x!y!z!{!}#O#S#_#c#e#f#g#h#i#j#k#l#wT#Z!r#dQ!ovR#a#W`!QXl!d!n!z!{#c#wT#x#S#l_[OW`fpx!YT^O`Q`OR![`QbPR!]bQeQR!_eQhRR!bhQkTS!ek!fR!flQ!krR#U!kQ#X!oR#b#XQ!VXR!|!VT_O`S]O`QuWQ!afQ!hpQ!txR#P!Y^XOW`fpx!YQlTQtVQ!djS!nv#WQ!uzQ!v{Q!w|Q!x}Q!y!OQ!z!QQ!{!UQ!}!WQ#O!XQ#S!iQ#_#mQ#c#]Q#e#oQ#f#pQ#g#qQ#h#rQ#i#sQ#j#tQ#k#uQ#l#vR#w#xRmTRsUTqU!jR!pv",nodeNames:" Standard Number String TemplateString InterpolationEnd Interpolation InterpolationStart CallbackReference VariableName BooleanLiteral null ] [ ArrayExpression , } { ObjectExpression Property PropertyDefinition : UnaryExpression LogicOp ArithOp ) ( ParenthesizedExpression MemberExpression MethodExpression . PropertyName ArgList Argument as PropertyAccess PropertyExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp CompareOp CompareOp CompareOp and or LogicOp ConditionalExpression LogicOp LogicOp PostfixExpression CallExpression TaggedTemplateExpression SequenceExpression ; AssignmentStatement =",maxTerm:86,nodeProps:[["group",1,"autoComplete",-18,2,3,4,8,9,10,11,14,18,22,27,28,37,48,51,52,53,54,"Expression"],["isolate",-3,3,4,6,""],["openedBy",5,"InterpolationStart",12,"[",16,"{",25,"("],["closedBy",7,"InterpolationEnd",13,"]",17,"}",26,")"]],propSources:[uT],skippedNodes:[0],repeatNodeCount:8,tokenData:"Gy!`R!ZOX$tXY&qYZ)gZ[&q[p$tpq&qqr*ars+{st,ctu-Uuv.rvw$twx/exy/{yz0nz{1a{|2S|}2u}!O2S!O!P3h!P!Q8e!Q![9W![!]:i!]!^;^!^!_<P!_!`=k!`!a>d!a!b?]!b!c$t!c!}-U!}#O@w#O#P$t#P#QAj#Q#RB]#R#S-U#S#TCO#T#o-U#o#pCq#p#q$t#q#rDd#r$f$t$f$g&q$g#BY-U#BY#BZEX#BZ$IS-U$IS$I_EX$I_$JT-U$JT$JUEX$JU$KV-U$KV$KWEX$KW&FU-U&FU&FVEX&FV;'S-U;'S;=`.l<%l?HT-U?HT?HUEX?HUO-U[${W!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$tW%jT!nWOY%eZw%ex;'S%e;'S;=`%y<%lO%eW%|P;=`<%l%eS&UT!kSOY&PZr&Ps;'S&P;'S;=`&e<%lO&PS&hP;=`<%l&P[&nP;=`<%l$t!`&zk!kS!nW!f!SOX$tXY&qYZ(oZ[&q[p$tpq&qqr$trs%esw$twx&Px$f$t$f$g&q$g#BY$t#BY#BZ&q#BZ$IS$t$IS$I_&q$I_$JT$t$JT$JU&q$JU$KV$t$KV$KW&q$KW&FU$t&FU&FV&q&FV;'S$t;'S;=`&k<%l?HT$t?HT?HU&q?HUO$t!S(tZ!f!SXY(oYZ(oZ[(opq(o$f$g(o#BY#BZ(o$IS$I_(o$JT$JU(o$KV$KW(o&FU&FV(o?HT?HU(o!`)nZ!l[!f!SXY(oYZ(oZ[(opq(o$f$g(o#BY#BZ(o$IS$I_(o$JT$JU(o$KV$KW(o&FU&FV(o?HT?HU(o!O*jYgr!kS!nWOY$tZr$trs%esw$twx&Px!_$t!_!`+Y!`;'S$t;'S;=`&k<%lO$t!O+cW|r!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$tn,ST!jf!nWOY%eZw%ex;'S%e;'S;=`%y<%lO%e^,lWWQ!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!`-ac!kS!nW!rr!v`OY$tZr$trs%est$ttu-Uuw$twx&Px!Q$t!Q![-U![!c$t!c!}-U!}#R$t#R#S-U#S#T$t#T#o-U#o$g$t$g;'S-U;'S;=`.l<%lO-U!`.oP;=`<%l-U!O.{Wwr!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$tn/lT!mj!kSOY&PZr&Ps;'S&P;'S;=`&e<%lO&P!O0UWjr!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t^0wWiQ!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!O1jWxr!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!O2]Whr!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!`3OW_!S!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!`3qY!kS!nWnrOY$tZr$trs%esw$twx&Px!Q$t!Q![4a![;'S$t;'S;=`&k<%lO$tn4j`!kS!nWQbOY$tZr$trs%esw$twx&Px!Q$t!Q![4a![!g$t!g!h5l!h#R$t#R#S4a#S#X$t#X#Y5l#Y;'S$t;'S;=`&k<%lO$tn5s^!kS!nWOY$tZr$trs%esw$twx&Px{$t{|6o|}$t}!O6o!O!Q$t!Q![7f![;'S$t;'S;=`&k<%lO$tn6vY!kS!nWOY$tZr$trs%esw$twx&Px!Q$t!Q![7f![;'S$t;'S;=`&k<%lO$tn7o[!kS!nWQbOY$tZr$trs%esw$twx&Px!Q$t!Q![7f![#R$t#R#S7f#S;'S$t;'S;=`&k<%lO$t!O8nWvr!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$tn9ab!kS!nWQbOY$tZr$trs%esw$twx&Px!O$t!O!P4a!P!Q$t!Q![9W![!g$t!g!h5l!h#R$t#R#S9W#S#X$t#X#Y5l#Y;'S$t;'S;=`&k<%lO$tn:tWe`!SQ!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t^;gW!XQ!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!O<YYzr!kS!nWOY$tZr$trs%esw$twx&Px!_$t!_!`<x!`;'S$t;'S;=`&k<%lO$t!O=RW{r!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!O=tY!ZQ!kS!nWOY$tZr$trs%esw$twx&Px!_$t!_!`+Y!`;'S$t;'S;=`&k<%lO$t!O>mY{r!kS!nWOY$tZr$trs%esw$twx&Px!_$t!_!`<x!`;'S$t;'S;=`&k<%lO$t!O?fY!xr!kS!nWOY$tZr$trs%esw$twx&Px!a$t!a!b@U!b;'S$t;'S;=`&k<%lO$t!O@_W!Pr!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!`AQW]!S!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t^AsW[Q!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!OBfWyr!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!OCXW!kS!nW!orOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t^CzWaQ!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!`DoW`!QTQ!kS!nWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!`Efu!kS!nW!f!S!rr!v`OX$tXY&qYZ(oZ[&q[p$tpq&qqr$trs%est$ttu-Uuw$twx&Px!Q$t!Q![-U![!c$t!c!}-U!}#R$t#R#S-U#S#T$t#T#o-U#o$f$t$f$g&q$g#BY-U#BY#BZEX#BZ$IS-U$IS$I_EX$I_$JT-U$JT$JUEX$JU$KV-U$KV$KWEX$KW&FU-U&FU&FVEX&FV;'S-U;'S;=`.l<%l?HT-U?HT?HUEX?HUO-U",tokenizers:[1,2,3,4,5,new _m("j~RQtuX#S#Td~[P#o#p_~dOV~~iO!q~~",25,78)],topRules:{Standard:[0,1]},specialized:[{term:80,get:r=>cT[r]||-1}],tokenPrec:1863}),dT=sf({Text:I.content,"ExpressionOpen ExpressionClose":I.special(I.brace)}),pT=ls.deserialize({version:14,states:"!dOQOPOOOOOO'#C_'#C_OYOPO'#C^OOOO'#Cb'#CbOOOO'#Cc'#CcQQOPOOOOOO'#C`'#C`O_OPO,58xOOOO-E6a-E6aOOOO'#Ca'#CaOOOO1G.d1G.d",stateData:"i~OXPOYRO~OYUO~OZXO~OXZYZ~",goto:"mWPPX]adXgTSOTTQOTRVQRYVQTORWT",nodeNames:" Template Expression ExpressionOpen ExpressionInner ExpressionClose Text",maxTerm:11,nodeProps:[["closedBy",3,"ExpressionClose"],["openedBy",5,"ExpressionOpen"]],propSources:[dT],skippedNodes:[0],repeatNodeCount:1,tokenData:"!j~RVO#oh#o#p!S#p#qh#q#r!_#r;'Sh;'S;=`|<%lOh~mTY~O#oh#p#qh#r;'Sh;'S;=`|<%lOh~!PP;=`<%lh~!VP#o#p!Y~!_OX~~!bP#q#r!e~!jOZ~",tokenizers:[0],topRules:{Template:[0,1]},tokenPrec:20});let Po=[];const Im=()=>(!Kr()||Po.length>0||(Po=RO()),Po),Nh=({text:r,className:t})=>r.replace(/`([^`]+)`/g,(e,i)=>{let n;return/^["'].*["']$/.test(i)?n="#6aab73":/^\d+$/.test(i)?n="#57a8f5":n="#CE8E6D",`<span class="${t}" style="color: ${n};">${gT(i)}</span>`}),gT=r=>r.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;");function wi(){var r=arguments[0];typeof r=="string"&&(r=document.createElement(r));var t=1,e=arguments[1];if(e&&typeof e=="object"&&e.nodeType==null&&!Array.isArray(e)){for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var n=e[i];typeof n=="string"?r.setAttribute(i,n):n!=null&&(r[i]=n)}t++}for(;t<arguments.length;t++)Bm(r,arguments[t]);return r}function Bm(r,t){if(typeof t=="string")r.appendChild(document.createTextNode(t));else if(t!=null)if(t.nodeType!=null)r.appendChild(t);else if(Array.isArray(t))for(var e=0;e<t.length;e++)Bm(r,t[e]);else throw new RangeError("Unsupported child node: "+t)}class Ap{constructor(t,e,i){this.from=t,this.to=e,this.diagnostic=i}}class Sn{constructor(t,e,i){this.diagnostics=t,this.panel=e,this.selected=i}static init(t,e,i){let n=i.facet(xi).markerFilter;n&&(t=n(t,i));let o=t.slice().sort((d,g)=>d.from-g.from||d.to-g.to),l=new nr,h=[],f=0;for(let d=0;;){let g=d==o.length?null:o[d];if(!g&&!h.length)break;let m,y;for(h.length?(m=f,y=h.reduce((S,A)=>Math.min(S,A.to),g&&g.from>m?g.from:1e8)):(m=g.from,y=g.to,h.push(g),d++);d<o.length;){let S=o[d];if(S.from==m&&(S.to>S.from||S.to==m))h.push(S),d++,y=Math.min(S.to,y);else{y=Math.min(S.from,y);break}}let b=MT(h);if(h.some(S=>S.from==S.to||S.from==S.to-1&&i.doc.lineAt(S.from).to==S.from))l.add(m,m,pt.widget({widget:new CT(b),diagnostics:h.slice()}));else{let S=h.reduce((A,P)=>P.markClass?A+" "+P.markClass:A,"");l.add(m,y,pt.mark({class:"cm-lintRange cm-lintRange-"+b+S,diagnostics:h.slice(),inclusiveEnd:h.some(A=>A.to>y)}))}f=y;for(let S=0;S<h.length;S++)h[S].to<=f&&h.splice(S--,1)}let c=l.finish();return new Sn(c,e,ur(c))}}function ur(r,t=null,e=0){let i=null;return r.between(e,1e9,(n,o,{spec:l})=>{if(!(t&&l.diagnostics.indexOf(t)<0))if(!i)i=new Ap(n,o,t||l.diagnostics[0]);else{if(l.diagnostics.indexOf(i.diagnostic)<0)return!1;i=new Ap(i.from,o,i.diagnostic)}}),i}function mT(r,t){let e=t.pos,i=t.end||e,n=r.state.facet(xi).hideOn(r,e,i);if(n!=null)return n;let o=r.startState.doc.lineAt(t.pos);return!!(r.effects.some(l=>l.is(uf))||r.changes.touchesRange(o.from,Math.max(o.to,i)))}function wT(r,t){return r.field(ii,!1)?t:t.concat(ft.appendConfig.of(Fm))}function yT(r,t){return{effects:wT(r,[uf.of(t)])}}const uf=ft.define(),Lm=ft.define(),Nm=ft.define(),ii=ve.define({create(){return new Sn(pt.none,null,null)},update(r,t){if(t.docChanged&&r.diagnostics.size){let e=r.diagnostics.map(t.changes),i=null,n=r.panel;if(r.selected){let o=t.changes.mapPos(r.selected.from,1);i=ur(e,r.selected.diagnostic,o)||ur(e,null,o)}!e.size&&n&&t.state.facet(xi).autoPanel&&(n=null),r=new Sn(e,n,i)}for(let e of t.effects)if(e.is(uf)){let i=t.state.facet(xi).autoPanel?e.value.length?el.open:null:r.panel;r=Sn.init(e.value,i,t.state)}else e.is(Lm)?r=new Sn(r.diagnostics,e.value?el.open:null,r.selected):e.is(Nm)&&(r=new Sn(r.diagnostics,r.panel,e.value));return r},provide:r=>[Rh.from(r,t=>t.panel),Z.decorations.from(r,t=>t.diagnostics)]}),vT=pt.mark({class:"cm-lintRange cm-lintRange-active"});function xT(r,t,e){let{diagnostics:i}=r.state.field(ii),n,o=-1,l=-1;i.between(t-(e<0?1:0),t+(e>0?1:0),(f,c,{spec:d})=>{if(t>=f&&t<=c&&(f==c||(t>f||e>0)&&(t<c||e<0)))return n=d.diagnostics,o=f,l=c,!1});let h=r.state.facet(xi).tooltipFilter;return n&&h&&(n=h(n,r.state)),n?{pos:o,end:l,above:r.state.doc.lineAt(o).to<l,create(){return{dom:bT(r,n)}}}:null}function bT(r,t){return wi("ul",{class:"cm-tooltip-lint"},t.map(e=>Wm(r,e,!1)))}const Tp=r=>{let t=r.state.field(ii,!1);return!t||!t.panel?!1:(r.dispatch({effects:Lm.of(!1)}),!0)},OT=Me.fromClass(class{constructor(r){this.view=r,this.timeout=-1,this.set=!0;let{delay:t}=r.state.facet(xi);this.lintTime=Date.now()+t,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,t)}run(){clearTimeout(this.timeout);let r=Date.now();if(r<this.lintTime-10)this.timeout=setTimeout(this.run,this.lintTime-r);else{this.set=!1;let{state:t}=this.view,{sources:e}=t.facet(xi);e.length&&ST(e.map(i=>Promise.resolve(i(this.view))),i=>{this.view.state.doc==t.doc&&this.view.dispatch(yT(this.view.state,i.reduce((n,o)=>n.concat(o))))},i=>{le(this.view.state,i)})}}update(r){let t=r.state.facet(xi);(r.docChanged||t!=r.startState.facet(xi)||t.needsRefresh&&t.needsRefresh(r))&&(this.lintTime=Date.now()+t.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,t.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}});function ST(r,t,e){let i=[],n=-1;for(let o of r)o.then(l=>{i.push(l),clearTimeout(n),i.length==r.length?t(i):n=setTimeout(()=>t(i),200)},e)}const xi=X.define({combine(r){return Object.assign({sources:r.map(t=>t.source).filter(t=>t!=null)},rl(r.map(t=>t.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(t,e)=>t?e?i=>t(i)||e(i):t:e}))}});function kT(r,t={}){return[xi.of({source:r,config:t}),OT,Fm]}function $m(r){let t=[];if(r)t:for(let{name:e}of r){for(let i=0;i<e.length;i++){let n=e[i];if(/[a-zA-Z]/.test(n)&&!t.some(o=>o.toLowerCase()==n.toLowerCase())){t.push(n);continue t}}t.push("")}return t}function Wm(r,t,e){var i;let n=e?$m(t.actions):[];return wi("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},wi("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage(r):t.message),(i=t.actions)===null||i===void 0?void 0:i.map((o,l)=>{let h=!1,f=m=>{if(m.preventDefault(),h)return;h=!0;let y=ur(r.state.field(ii).diagnostics,t);y&&o.apply(r,y.from,y.to)},{name:c}=o,d=n[l]?c.indexOf(n[l]):-1,g=d<0?c:[c.slice(0,d),wi("u",c.slice(d,d+1)),c.slice(d+1)];return wi("button",{type:"button",class:"cm-diagnosticAction",onclick:f,onmousedown:f,"aria-label":` Action: ${c}${d<0?"":` (access key "${n[l]})"`}.`},g)}),t.source&&wi("div",{class:"cm-diagnosticSource"},t.source))}class CT extends fs{constructor(t){super(),this.sev=t}eq(t){return t.sev==this.sev}toDOM(){return wi("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class Pp{constructor(t,e){this.diagnostic=e,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=Wm(t,e,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class el{constructor(t){this.view=t,this.items=[];let e=n=>{if(n.keyCode==27)Tp(this.view),this.view.focus();else if(n.keyCode==38||n.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(n.keyCode==40||n.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(n.keyCode==36)this.moveSelection(0);else if(n.keyCode==35)this.moveSelection(this.items.length-1);else if(n.keyCode==13)this.view.focus();else if(n.keyCode>=65&&n.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:o}=this.items[this.selectedIndex],l=$m(o.actions);for(let h=0;h<l.length;h++)if(l[h].toUpperCase().charCodeAt(0)==n.keyCode){let f=ur(this.view.state.field(ii).diagnostics,o);f&&o.actions[h].apply(t,f.from,f.to)}}else return;n.preventDefault()},i=n=>{for(let o=0;o<this.items.length;o++)this.items[o].dom.contains(n.target)&&this.moveSelection(o)};this.list=wi("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:e,onclick:i}),this.dom=wi("div",{class:"cm-panel-lint"},this.list,wi("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Tp(this.view)},"")),this.update()}get selectedIndex(){let t=this.view.state.field(ii).selected;if(!t)return-1;for(let e=0;e<this.items.length;e++)if(this.items[e].diagnostic==t.diagnostic)return e;return-1}update(){let{diagnostics:t,selected:e}=this.view.state.field(ii),i=0,n=!1,o=null,l=new Set;for(t.between(0,this.view.state.doc.length,(h,f,{spec:c})=>{for(let d of c.diagnostics){if(l.has(d))continue;l.add(d);let g=-1,m;for(let y=i;y<this.items.length;y++)if(this.items[y].diagnostic==d){g=y;break}g<0?(m=new Pp(this.view,d),this.items.splice(i,0,m),n=!0):(m=this.items[g],g>i&&(this.items.splice(i,g-i),n=!0)),e&&m.diagnostic==e.diagnostic?m.dom.hasAttribute("aria-selected")||(m.dom.setAttribute("aria-selected","true"),o=m):m.dom.hasAttribute("aria-selected")&&m.dom.removeAttribute("aria-selected"),i++}});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)n=!0,this.items.pop();this.items.length==0&&(this.items.push(new Pp(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),n=!0),o?(this.list.setAttribute("aria-activedescendant",o.id),this.view.requestMeasure({key:this,read:()=>({sel:o.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:h,panel:f})=>{let c=f.height/this.list.offsetHeight;h.top<f.top?this.list.scrollTop-=(f.top-h.top)/c:h.bottom>f.bottom&&(this.list.scrollTop+=(h.bottom-f.bottom)/c)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),n&&this.sync()}sync(){let t=this.list.firstChild;function e(){let i=t;t=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;t!=i.dom;)e();t=i.dom.nextSibling}else this.list.insertBefore(i.dom,t);for(;t;)e()}moveSelection(t){if(this.selectedIndex<0)return;let e=this.view.state.field(ii),i=ur(e.diagnostics,this.items[t].diagnostic);i&&this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:Nm.of(i)})}static open(t){return new el(t)}}function AT(r,t='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(r)}</svg>')`}function Mo(r){return AT(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${r}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const TT=Z.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Mo("#d11")},".cm-lintRange-warning":{backgroundImage:Mo("orange")},".cm-lintRange-info":{backgroundImage:Mo("#999")},".cm-lintRange-hint":{backgroundImage:Mo("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function PT(r){return r=="error"?4:r=="warning"?3:r=="info"?2:1}function MT(r){let t="hint",e=1;for(let i of r){let n=PT(i.severity);n>e&&(e=n,t=i.severity)}return t}const Fm=[ii,Z.decorations.compute([ii],r=>{let{selected:t,panel:e}=r.field(ii);return!t||!e||t.from==t.to?pt.none:pt.set([vT.range(t.from,t.to)])}),nm(xT,{hideOn:mT}),TT],RT={linter:kT},_T=r=>{try{const t=r.split(" at ");if(t.length<=1)return null;const i=t.pop().replace("(","").replace(")",""),[n,o]=i.split(", ");return o?[parseInt(n),parseInt(o)]:parseInt(n)}catch{return null}},ET=(r,t)=>{try{if(!Kr())return[];const e=se(r).with("standard",()=>EO(t)).with("unary",()=>DO(t)).otherwise(()=>null);if(!e)return[];const i=se(_T(e.source)).with(Qt.number,o=>({from:o,to:o})).with([Qt.number,Qt.number],([o,l])=>({from:o,to:l})).otherwise(()=>({from:0,to:t.length})),n=se(e.type).with("parserError",()=>"Parser error").with("lexerError",()=>"Lexer error").with("compilerError",()=>"Compiler error").with("vmError",()=>"VM error").otherwise(o=>o);return[{from:i.from,to:i.to,message:e.source,source:n,severity:"error"}]}catch(e){return[{from:0,to:t.length,message:String(e),severity:"error"}]}},DT=r=>Kr()?RT.linter(t=>{t.dom.setAttribute("data-severity","none");const e=t.state.field(tr),i=t.state.doc.toString(),n=IT({source:i,expressionType:r,strict:e.strict,types:e.types,expectedVariableType:e.expectedVariableType});return n.some(o=>o.severity==="error")?t.dom.setAttribute("data-severity","error"):n.some(o=>o.severity==="warning")?t.dom.setAttribute("data-severity","warning"):n.some(o=>o.severity==="info")?t.dom.setAttribute("data-severity","info"):n.some(o=>o.severity==="hint")&&t.dom.setAttribute("data-severity","hint"),n},{needsRefresh:t=>t.transactions.some(e=>e.effects.some(i=>i.is(cf)||i.is(il)||i.is(nl)||i.is(df)))}):[],IT=({source:r,expressionType:t="standard",strict:e=!1,types:i,expectedVariableType:n})=>{if(r.trim().length===0)return[];const o=r?ET(t,r):[],l=i.filter(f=>!!f.error).map(f=>Ga({from:f.span[0],to:f.span[1],severity:se(f.error).with(Qt.string.startsWith("Hint:"),()=>"hint").with(Qt.string.startsWith("Info:"),()=>"info").otherwise(()=>"warning"),message:f.error,source:"Type check"})),h=[...o,...l];if(t==="unary"&&i.length>0){const f=i[0].kind;f!=="Bool"&&h.push(Ga({from:0,to:r.length,severity:e?"error":"warning",message:`Expected unary expression to evaluate to type \`bool\`, received \`${er(f)}\` instead.`,source:"Type check"}))}else if(n&&i.length>0){const f=i[0].kind,c=_O.fromJson(f);se([e,f]).with([!0,"Any"],()=>!1).otherwise(()=>c.satisfies(n))||h.push(Ga({from:0,to:r.length,severity:e?"error":"warning",message:`Expected expression to evaluate to type \`${er(n.toJson())}\`, received \`${er(f)}\` instead.`,source:"Type check"}))}return h},Ga=r=>(r.renderMessage=t=>{const e=document.createElement("div");return e.innerHTML=Nh({text:r.message,className:"cm-diagnosticMessageToken"}),e},r),Hm=(r,t,e,i)=>{const n=se(t.type).with(Qt.union("function","method"),()=>{const o=`${t.label}()`;return r.state.update({changes:{from:e,to:i,insert:o},selection:{anchor:e+o.length-1}})}).otherwise(()=>r.state.update({changes:{from:e,to:i,insert:t.label},selection:{anchor:e+t.label.length}}));r.dispatch(n)},BT=()=>Im().map(r=>({...r,detail:r.detail.replaceAll("`",""),apply:Hm})),zm=r=>r?r?.type.prop(ot.group)?.includes("autoComplete")||!1||zm(r?.parent):!1,LT=()=>{const r=BT(),t=r.filter(i=>i.type&&["variable","function"].includes(i.type)),e=i=>r.filter(n=>n.type==="method"&&se(n).with({methodFor:Qt._},({methodFor:o})=>o===i.kind).otherwise(()=>!1));return i=>{const n=Re(i.state),o=i.state.wordAt(i.pos),l=n.resolveInner(i.pos,-1);if(!zm(l)||!i.explicit&&i.pos===0||!i.explicit&&!o&&l.name!==".")return null;const h=o?.from??i.pos;switch(l.name){case"Standard":case"VariableName":case"[":{const f=i.state.field(tr);return{from:h,options:[...Za({type:"variable",kind:f.rootKind}),...t],validFor:/\w*/}}case"String":{const f=i.state.field(tr),c=Mp(l),d=(f.types??[]).find(g=>g.span[0]===c?.[0]&&g.span[1]===c[1]);return d?{from:l.from+1,options:Za({kind:d.kind}),validFor:/\w*/}:null}case".":case"PropertyName":{const f=i.state.field(tr),c=Mp(l),d=(f.types??[]).find(g=>g.span[0]===c?.[0]&&g.span[1]===c[1]);return d?{from:h,options:[...Za({kind:d.kind}),...e(d)],validFor:/\w*/}:null}default:return null}}},Mp=r=>{let t=r;["PropertyExpression","PropertyAccess"].includes(t.parent?.name??"")&&t.parent?.prevSibling&&(t=t.parent.prevSibling);let e=t;for(;e.prevSibling;)e=e.prevSibling;return[e.from,t.to]},NT=r=>{let t=r;t.parent&&["PropertyExpression","PropertyAccess"].includes(t.parent.name)&&(t=t.parent);let e=t;for(;e.prevSibling;)e=e.prevSibling;return[e.from,t.to]},$T=()=>FA({override:[LT()]}),WT=()=>{const r=Im();return nm((t,e)=>{const i=t.state.wordAt(e);if(!i)return null;const n=t.state.doc.sliceString(i.from,i.to),o=r.find(g=>g.label===n);if(o)return{pos:i.from,end:i.to,above:!0,create(){const g=document.createElement("div");return g.classList.add("grl-ce-hover-tooltip"),g.style.whiteSpace="pre",g.innerHTML=Nh({text:`<span style="font-size: 12px">${o.info}</span>
${o.label}: ${o.detail}
`,className:"cm-hoverTooltipMessageToken"}),{dom:g}}};const h=Re(t.state).resolveInner(e,-1),f=t.state.field(tr),c=NT(h),d=(f.types??[]).find(g=>g.span[0]===c?.[0]&&g.span[1]===c[1]);if(d&&c){const g=t.state.doc.toString();return{pos:c[0],end:c[1],above:!0,create(){const m=document.createElement("div");return m.classList.add("grl-ce-hover-tooltip"),m.style.whiteSpace="pre",m.innerHTML=Nh({text:`${g.slice(c[0],c[1])}: \`${er(d.kind)}\``,className:"cm-hoverTooltipMessageToken"}),{dom:m}}}}return null},{hoverTime:700,hideOnChange:!0})},FT=ds.define([{tag:[I.bracket,I.operator,I.variableName,I.propertyName,I.content,I.punctuation],color:"#080808"},{tag:[I.number,I.bool],color:"#015cc5"},{tag:[I.function(I.variableName),I.keyword,I.self,I.special(I.brace),I.logicOperator],color:"#6f42c1"},{tag:[I.string,I.meta,I.name,I.quote],color:"#077d16"},{tag:I.invalid,color:"#cb2431"}]),HT=ds.define([{tag:[I.bracket,I.operator,I.variableName,I.propertyName,I.content,I.punctuation],color:"#bdbec4"},{tag:[I.number,I.bool],color:"#57a8f5"},{tag:[I.function(I.variableName),I.keyword,I.self,I.special(I.brace),I.logicOperator],color:"#c87dbb"},{tag:[I.string,I.meta,I.name,I.quote],color:"#6aab73"},{tag:I.invalid,color:"#cb2431"}]),Rp=new hm(rs.define({parser:Dm,name:"zen",languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},wordChars:"$"}})),_p=new hm(rs.define({parser:pT.configure({wrap:YO(r=>r.name==="ExpressionInner"?{parser:Dm}:null)}),name:"zenTemplate",languageData:{closeBrackets:{brackets:["(","[","'",'"',"{","`"]},wordChars:"$"}})),Ep=({type:r,lint:t=!0,lazy:e=!1})=>e?[r!=="template"?Rp:_p]:[r!=="template"?Rp:_p,$T(),WT(),MA(),t&&DT(r),tr,UA(),ef.of([...DA,...tT,{key:"Enter",run:yp,shift:yp}])].filter(i=>!!i),zT={types:[],rootKind:"Any",expressionType:"standard",strict:!1},il=ft.define(),cf=ft.define(),nl=ft.define(),df=ft.define(),tr=ve.define({create(){return zT},update(r,t){try{const e=t.effects.find(g=>g.is(cf)),i=se(e).with({value:Qt.string},g=>g.value).otherwise(()=>r.expressionType),n=t.effects.find(g=>g.is(nl)),o=se(n).with({value:Qt.nonNullable},({value:g})=>g).with({value:Qt.nullish},()=>{}).otherwise(()=>r.expectedVariableType),l=t.effects.find(g=>g.is(il)),h=se(l).with({value:Qt._},g=>g.value).otherwise(()=>r.root||null),f=t.effects.find(g=>g.is(df)),c=se(f).with({value:Qt.boolean},({value:g})=>g).otherwise(()=>r.strict);if(!h)return{...r,expressionType:i,expectedVariableType:o,strict:c};if(!t.docChanged&&!e&&!l)return{...r,expressionType:i,expectedVariableType:o,strict:c};const d=t.newDoc.toString();return{source:d,expressionType:i,expectedVariableType:o,strict:c,root:h,rootKind:h.toJson(),types:se(i).with("unary",()=>h.typeCheckUnary(d)).otherwise(()=>h.typeCheck(d))}}catch{return r}},compare(r,t){return r.source===t.source&&r.expressionType===t.expressionType&&r.root===t.root&&r.expectedVariableType===t.expectedVariableType&&r.strict===t.strict}}),Za=({kind:r,type:t="property"})=>se(r).with({Object:Qt._},e=>Object.entries(e.Object).map(([i,n])=>({label:i,type:t,boost:50,detail:er(n),apply:Hm}))).otherwise(()=>[]),er=r=>se(r).with(Qt.string,t=>t.toLowerCase()).with({Object:Qt._},()=>"object").with({Array:Qt._},t=>`${er(t.Array)}[]`).with({Const:Qt.string},t=>`"${t.Const}"`).with({Enum:Qt.array(Qt.string)},t=>t.Enum.map(e=>`"${e}"`).join(" | ")).otherwise(()=>"unknown"),VT=cm(HT),QT=cm(FT),Dp=(r=!1)=>r?VT:QT,Ip=(r,t)=>Z.updateListener.of(e=>{t?.(e.state),e.docChanged&&r?.(e.state.doc.toString())}),UT=PO.forwardRef(({noStyle:r=!1,fullHeight:t=!1,strict:e=!1,maxRows:i,disabled:n,value:o,onChange:l,placeholder:h,className:f,onStateChange:c,type:d="standard",extension:g,variableType:m,expectedVariableType:y,lint:b=!0,initialSelection:S,style:A={},...P},B)=>{const N=zt.useRef(null),D=zt.useRef(null),{token:$}=IO.useToken(),W=zt.useMemo(()=>({zenExtension:new pi,theme:new pi,placeholder:new pi,readOnly:new pi,updateListener:new pi,userProvided:new pi}),[]);return zt.useEffect(()=>{if(!N.current||D.current)return;let F=!1;queueMicrotask(()=>{F=!0});const et=bt=>mm.clamp(bt,0,o?.length??0),st=new Z({parent:N.current,state:mt.create({doc:o,selection:S?{head:S.head?et(S.head):void 0,anchor:et(S.anchor)}:void 0,extensions:[Z.lineWrapping,XC(),W.zenExtension.of(Ep({type:d,lint:b})),W.updateListener.of(Ip(l,c)),W.theme.of(Dp($.mode==="dark")),W.placeholder.of(h?Kd(h):[]),W.readOnly.of(Z.editable.of(!n)),W.userProvided.of(g?.({type:d})??[])]})});return S&&st.focus(),D.current=st,N.current&&(N.current.codeMirror=st),()=>{F&&(st.destroy(),D.current=null)}},[]),zt.useEffect(()=>{if(!D.current||o===void 0)return;const F=D.current;if(F.state.doc.eq(ct.of(o.split(`
`))))return;const et=F.state.selection.main.head,st=o.length;F.dispatch({changes:{from:0,to:F.state.doc.length,insert:o},...et>st&&{selection:{anchor:st}}})},[o]),zt.useEffect(()=>{D.current&&D.current.dispatch({effects:W.theme.reconfigure(Dp($.mode==="dark"))})},[$.mode]),zt.useEffect(()=>{D.current&&D.current.dispatch({effects:W.placeholder.reconfigure(h?Kd(h):[])})},[h]),zt.useEffect(()=>{D.current&&D.current.dispatch({effects:W.readOnly.reconfigure(Z.editable.of(!n))})},[n]),zt.useEffect(()=>{D.current&&D.current.dispatch({effects:W.updateListener.reconfigure(Ip(l,c))})},[l,c]),zt.useEffect(()=>{D.current&&D.current.dispatch({effects:[W.zenExtension.reconfigure(Ep({type:d,lint:b})),cf.of(se(d).with("unary",()=>"unary").otherwise(()=>"standard"))]})},[d,b]),zt.useEffect(()=>{D.current&&D.current.dispatch({effects:W.userProvided.reconfigure(g?.({type:d})??[])})},[g,d]),zt.useEffect(()=>{if(!(!D.current||!Kr())){if(m==null){D.current.dispatch({effects:il.of(null)});return}D.current.dispatch({effects:il.of(Uc(m))})}},[m]),zt.useEffect(()=>{if(!(!D.current||!Kr())){if(y==null){D.current.dispatch({effects:nl.of(null)});return}D.current.dispatch({effects:nl.of(Uc(y))})}},[y]),zt.useEffect(()=>{D.current&&D.current.dispatch({effects:df.of(e)})},[e]),MO.jsx("div",{ref:FO(N,B),className:BO("grl-ce",i&&!t&&"max-rows",t&&"full-height",r&&"no-style",f),style:{"--editorMaxRows":i,...A},"data-type":d,...P})});UT.__docgenInfo={description:"",methods:[],displayName:"CodeEditorBase",props:{maxRows:{required:!1,tsType:{name:"number"},description:""},value:{required:!1,tsType:{name:"string"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},onStateChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(state: EditorState) => void",signature:{arguments:[{type:{name:"EditorState"},name:"state"}],return:{name:"void"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},type:{required:!1,tsType:{name:"union",raw:"'unary' | 'standard' | 'template'",elements:[{name:"literal",value:"'unary'"},{name:"literal",value:"'standard'"},{name:"literal",value:"'template'"}]},description:"",defaultValue:{value:"'standard'",computed:!1}},lint:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},strict:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},fullHeight:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},noStyle:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},extension:{required:!1,tsType:{name:"signature",type:"function",raw:"(params: ExtensionParams) => Extension",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  type?: 'standard' | 'unary' | 'template';
}`,signature:{properties:[{key:"type",value:{name:"union",raw:"'standard' | 'unary' | 'template'",elements:[{name:"literal",value:"'standard'"},{name:"literal",value:"'unary'"},{name:"literal",value:"'template'"}],required:!1}}]}},name:"params"}],return:{name:"Extension"}}},description:""},livePreview:{required:!1,tsType:{name:"signature",type:"object",raw:"{ input: unknown; fromSimulation: boolean; result?: unknown }",signature:{properties:[{key:"input",value:{name:"unknown",required:!0}},{key:"fromSimulation",value:{name:"boolean",required:!0}},{key:"result",value:{name:"unknown",required:!1}}]}},description:""},variableType:{required:!1,tsType:{name:"any"},description:""},expectedVariableType:{required:!1,tsType:{name:"any"},description:""},lazy:{required:!1,tsType:{name:"boolean"},description:""},initialSelection:{required:!1,tsType:{name:"signature",type:"object",raw:"{ anchor: number; head?: number }",signature:{properties:[{key:"anchor",value:{name:"number",required:!0}},{key:"head",value:{name:"number",required:!1}}]}},description:""},style:{defaultValue:{value:"{}",computed:!1},required:!1}}};export{UT as C,mt as E,e2 as _,BO as a,FT as b,KT as c,Ep as d,gT as e,FO as f,JT as h,mm as l,Nh as r,Re as s,IT as v,HT as z};
