import{j as l}from"./index-CQHSiloJ.js";import{u as E,f as w,S as C,d as c,C as M,L as A,A as I,a as f,T as V,D as z}from"./focus-helper-BEl8uRV3.js";import{R as Y,r as u}from"./index-DQDNmYQF.js";import{c as x,C as _}from"./ce-base-WZGwKeKc.js";import{p as D}from"./index-BPZMdQjL.js";/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],L=x("hash",O);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]],R=x("toggle-left",q);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]],B=x("type",$),F={string:B,"string-array":A,number:L,boolean:R,date:M},h=(s,r)=>{const t=s.toLowerCase();return(r?.label?.toLowerCase().includes(t)||r?.value?.toLowerCase().includes(t))??!1},S=s=>`d('${s}')`,y=s=>`"${s}"`,H=s=>s.length?`[${s.map(r=>`"${r.replace(/"/g,'\\"')}"`).join(", ")}]`:"[]",W=s=>{if(!s?.trim())return[];try{const r=JSON.parse(s);if(Array.isArray(r))return r.map(String)}catch{}return[]},J=s=>{if(!s?.trim()||s.trim()==="[]")return!0;try{return Array.isArray(JSON.parse(s))}catch{}return!1},P=(s,r)=>{if(!s||s.type!=="string"&&s.type!=="string-array")return null;const t=s.enum;if(!t)return null;if(t.type==="inline")return t.values.length?{values:t.values,loose:t.loose??!1}:null;const i=r?.[t.ref];return i?.length?{values:i,loose:t.loose??!1}:null},G=Y.forwardRef(({value:s,onChange:r,disabled:t=!1,fieldType:i,maxRows:p=3},k)=>{const d=u.useRef(null),N=E(),a=i?.type??"auto",g={"--b-max-rows":p};u.useImperativeHandle(k,()=>({focus:()=>w(d.current)}));const n=u.useMemo(()=>D(s),[s]),v=()=>a==="string-array"?!J(s):n.kind==="expression"?!0:a==="auto"?!1:n.kind!==a,[j,m]=u.useState(v);u.useEffect(()=>{m(v())},[a]);const T=a!=="auto"&&a!=="string-array"&&n.kind!=="expression"&&n.kind!==a,b=a!=="auto"?F[a]:null,o=P(i,N);return a==="auto"||j||T?l.jsxs("div",{ref:d,className:"seb",style:g,children:[a!=="auto"&&l.jsx("button",{className:"seb-mode-btn",onClick:()=>{if(n.kind!==a){const e=a;e==="string"?r(y("")):e==="number"?r("0"):e==="boolean"?r("true"):e==="date"&&r(S(c().format("YYYY-MM-DD")))}m(!1)},disabled:t,title:"Currently: Expression. Click for value mode.",children:l.jsx(C,{size:14})}),l.jsx(_,{className:"seb-code",value:s,onChange:r,type:"standard",disabled:t,noStyle:!0,maxRows:p})]}):l.jsxs("div",{ref:d,className:"seb",style:g,children:[l.jsx("button",{className:"seb-mode-btn",onClick:()=>m(!0),disabled:t,title:"Currently: Value. Click for expression mode.",children:b&&l.jsx(b,{size:14})}),a==="string"&&!o&&l.jsx(I,{className:"seb-input",value:n.kind==="string"?n.value:"",maxRows:p,onChange:e=>r(y(e.target.value)),disabled:t}),a==="string"&&o&&l.jsx(f,{className:"seb-select",value:n.kind==="string"?n.value:void 0,onChange:e=>r(y(e)),disabled:t,variant:"borderless",size:"small",suffixIcon:null,showSearch:!0,filterOption:h,popupMatchSelectWidth:!1,options:o.values.map(e=>({label:e.label,value:e.value}))}),a==="string-array"&&l.jsx(f,{className:"seb-select-multi",mode:o&&!o.loose?"multiple":"tags",value:W(s),onChange:e=>r(H(e)),disabled:t,variant:"borderless",size:"small",suffixIcon:null,showSearch:!0,filterOption:h,popupMatchSelectWidth:!1,options:o?.values.map(e=>({label:e.label,value:e.value}))}),a==="number"&&l.jsx(V,{className:"seb-number",value:n.kind==="number"?n.value:0,onChange:e=>r(String(e??0)),disabled:t,variant:"borderless",controls:!1}),a==="boolean"&&l.jsx(f,{className:"seb-select",value:n.kind==="boolean"?n.value:!0,onChange:e=>r(String(e)),disabled:t,variant:"borderless",size:"small",suffixIcon:null,popupMatchSelectWidth:80,options:[{value:!0,label:"true"},{value:!1,label:"false"}]}),a==="date"&&l.jsx(z,{className:"seb-date",value:(()=>{const e=n.kind==="date"?n.value:null;return e&&c(e).isValid()?c(e):c()})(),onChange:e=>e&&r(S(e.format("YYYY-MM-DD"))),disabled:t,variant:"borderless",size:"small",allowClear:!1})]})});G.__docgenInfo={description:"",methods:[{name:"focus",docblock:null,modifiers:[],params:[],returns:null}],displayName:"StandardExpressionBuilder",props:{value:{required:!0,tsType:{name:"string"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},fieldType:{required:!1,tsType:{name:"z.infer",elements:[{name:"outputFieldTypeSchema"}],raw:"z.infer<typeof outputFieldTypeSchema>"},description:""},maxRows:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"3",computed:!1}}}};export{L as H,G as S};
