import{j as Bt}from"./index-CQHSiloJ.js";import{c as fo,g as VO,R as qh,r as at}from"./index-DQDNmYQF.js";import{i as Pn,d as HO,z as ie,N as Wt,b as zO,v as qO,e as UO,t as zp,c as Ho,T as Lr}from"./wasm-D0W8t0uD.js";const qp=1024;let QO=0,ze=class{constructor(t,e){this.from=t,this.to=e}};class ht{constructor(t={}){this.id=QO++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof t!="function"&&(t=fe.match(t)),e=>{let i=t(e);return i===void 0?null:[this,i]}}}ht.closedBy=new ht({deserialize:r=>r.split(" ")});ht.openedBy=new ht({deserialize:r=>r.split(" ")});ht.group=new ht({deserialize:r=>r.split(" ")});ht.isolate=new ht({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});ht.contextHash=new ht({perNode:!0});ht.lookAhead=new ht({perNode:!0});ht.mounted=new ht({perNode:!0});class ts{constructor(t,e,i){this.tree=t,this.overlay=e,this.parser=i}static get(t){return t&&t.props&&t.props[ht.mounted.id]}}const YO=Object.create(null);class fe{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):YO,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(t.name==null?8:0),n=new fe(t.name||"",e,t.id,i);if(t.props){for(let o of t.props)if(Array.isArray(o)||(o=o(n)),o){if(o[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[o[0].id]=o[1]}}return n}prop(t){return this.props[t.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(t){if(typeof t=="string"){if(this.name==t)return!0;let e=this.prop(ht.group);return e?e.indexOf(t)>-1:!1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return i=>{for(let n=i.prop(ht.group),o=-1;o<(n?n.length:0);o++){let l=e[o<0?i.name:n[o]];if(l)return l}}}}fe.none=new fe("",Object.create(null),0,8);class Uh{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let i of this.types){let n=null;for(let o of t){let l=o(i);l&&(n||(n=Object.assign({},i.props)),n[l[0].id]=l[1])}e.push(n?new fe(i.name,n,i.id,i.flags):i)}return new Uh(e)}}const uo=new WeakMap,td=new WeakMap;var Rt;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(Rt||(Rt={}));class Et{constructor(t,e,i,n,o){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,o&&o.length){this.props=Object.create(null);for(let[l,h]of o)this.props[typeof l=="number"?l:l.id]=h}}toString(){let t=ts.get(this);if(t&&!t.overlay)return t.tree.toString();let e="";for(let i of this.children){let n=i.toString();n&&(e&&(e+=","),e+=n)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new zo(this.topNode,t)}cursorAt(t,e=0,i=0){let n=uo.get(this)||this.topNode,o=new zo(n);return o.moveTo(t,e),uo.set(this,o._tree),o}get topNode(){return new ve(this,0,0,null)}resolve(t,e=0){let i=es(uo.get(this)||this.topNode,t,e,!1);return uo.set(this,i),i}resolveInner(t,e=0){let i=es(td.get(this)||this.topNode,t,e,!0);return td.set(this,i),i}resolveStack(t,e=0){return GO(this,t,e)}iterate(t){let{enter:e,leave:i,from:n=0,to:o=this.length}=t,l=t.mode||0,h=(l&Rt.IncludeAnonymous)>0;for(let f=this.cursor(l|Rt.IncludeAnonymous);;){let c=!1;if(f.from<=o&&f.to>=n&&(!h&&f.type.isAnonymous||e(f)!==!1)){if(f.firstChild())continue;c=!0}for(;c&&i&&(h||!f.type.isAnonymous)&&i(f),!f.nextSibling();){if(!f.parent())return;c=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:Xh(fe.none,this.children,this.positions,0,this.children.length,0,this.length,(e,i,n)=>new Et(this.type,e,i,n,this.propValues),t.makeTree||((e,i,n)=>new Et(fe.none,e,i,n)))}static build(t){return ZO(t)}}Et.empty=new Et(fe.none,[],[],0);class Qh{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Qh(this.buffer,this.index)}}class an{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return fe.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],o=n.name;if(/\W/.test(o)&&!n.isError&&(o=JSON.stringify(o)),t+=4,i==t)return o;let l=[];for(;t<i;)l.push(this.childString(t)),t=this.buffer[t+3];return o+"("+l.join(",")+")"}findChild(t,e,i,n,o){let{buffer:l}=this,h=-1;for(let f=t;f!=e&&!(Up(o,n,l[f+1],l[f+2])&&(h=f,i>0));f=l[f+3]);return h}slice(t,e,i){let n=this.buffer,o=new Uint16Array(e-t),l=0;for(let h=t,f=0;h<e;){o[f++]=n[h++],o[f++]=n[h++]-i;let c=o[f++]=n[h++]-i;o[f++]=n[h++]-t,l=Math.max(l,c)}return new an(o,l,this.set)}}function Up(r,t,e,i){switch(r){case-2:return e<t;case-1:return i>=t&&e<t;case 0:return e<t&&i>t;case 1:return e<=t&&i>t;case 2:return i>t;case 4:return!0}}function es(r,t,e,i){for(var n;r.from==r.to||(e<1?r.from>=t:r.from>t)||(e>-1?r.to<=t:r.to<t);){let l=!i&&r instanceof ve&&r.index<0?null:r.parent;if(!l)return r;r=l}let o=i?0:Rt.IgnoreOverlays;if(i)for(let l=r,h=l.parent;h;l=h,h=l.parent)l instanceof ve&&l.index<0&&((n=h.enter(t,e,o))===null||n===void 0?void 0:n.from)!=l.from&&(r=h);for(;;){let l=r.enter(t,e,o);if(!l)return r;r=l}}class Qp{cursor(t=0){return new zo(this,t)}getChild(t,e=null,i=null){let n=ed(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return ed(this,t,e,i)}resolve(t,e=0){return es(this,t,e,!1)}resolveInner(t,e=0){return es(this,t,e,!0)}matchContext(t){return rh(this.parent,t)}enterUnfinishedNodesBefore(t){let e=this.childBefore(t),i=this;for(;e;){let n=e.lastChild;if(!n||n.to!=e.to)break;n.type.isError&&n.from==n.to?(i=e,e=n.prevSibling):e=n}return i}get node(){return this}get next(){return this.parent}}class ve extends Qp{constructor(t,e,i,n){super(),this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,o=0){for(let l=this;;){for(let{children:h,positions:f}=l._tree,c=e>0?h.length:-1;t!=c;t+=e){let d=h[t],g=f[t]+l.from;if(Up(n,i,g,g+d.length)){if(d instanceof an){if(o&Rt.ExcludeBuffers)continue;let m=d.findChild(0,d.buffer.length,e,i-g,n);if(m>-1)return new rn(new XO(l,d,t,g),null,m)}else if(o&Rt.IncludeAnonymous||!d.type.isAnonymous||Yh(d)){let m;if(!(o&Rt.IgnoreMounts)&&(m=ts.get(d))&&!m.overlay)return new ve(m.tree,g,t,l);let w=new ve(d,g,t,l);return o&Rt.IncludeAnonymous||!w.type.isAnonymous?w:w.nextChild(e<0?d.children.length-1:0,e,i,n)}}}if(o&Rt.IncludeAnonymous||!l.type.isAnonymous||(l.index>=0?t=l.index+e:t=e<0?-1:l._parent._tree.children.length,l=l._parent,!l))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&Rt.IgnoreOverlays)&&(n=ts.get(this._tree))&&n.overlay){let o=t-this.from;for(let{from:l,to:h}of n.overlay)if((e>0?l<=o:l<o)&&(e<0?h>=o:h>o))return new ve(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function ed(r,t,e,i){let n=r.cursor(),o=[];if(!n.firstChild())return o;if(e!=null){for(let l=!1;!l;)if(l=n.type.is(e),!n.nextSibling())return o}for(;;){if(i!=null&&n.type.is(i))return o;if(n.type.is(t)&&o.push(n.node),!n.nextSibling())return i==null?o:[]}}function rh(r,t,e=t.length-1){for(let i=r;e>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(t[e]&&t[e]!=i.name)return!1;e--}}return!0}class XO{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}}class rn extends Qp{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,i){super(),this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}child(t,e,i){let{buffer:n}=this.context,o=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return o<0?null:new rn(this.context,this,o)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&Rt.ExcludeBuffers)return null;let{buffer:n}=this.context,o=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return o<0?null:new rn(this.context,this,o)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new rn(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new rn(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,o=i.buffer[this.index+3];if(o>n){let l=i.buffer[this.index+1];t.push(i.slice(n,o,l)),e.push(0)}return new Et(this.type,t,e,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Yp(r){if(!r.length)return null;let t=0,e=r[0];for(let o=1;o<r.length;o++){let l=r[o];(l.from>e.from||l.to<e.to)&&(e=l,t=o)}let i=e instanceof ve&&e.index<0?null:e.parent,n=r.slice();return i?n[t]=i:n.splice(t,1),new KO(n,e)}class KO{constructor(t,e){this.heads=t,this.node=e}get next(){return Yp(this.heads)}}function GO(r,t,e){let i=r.resolveInner(t,e),n=null;for(let o=i instanceof ve?i:i.context.parent;o;o=o.parent)if(o.index<0){let l=o.parent;(n||(n=[i])).push(l.resolve(t,e)),o=l}else{let l=ts.get(o.tree);if(l&&l.overlay&&l.overlay[0].from<=t&&l.overlay[l.overlay.length-1].to>=t){let h=new ve(l.tree,l.overlay[0].from+o.from,-1,o);(n||(n=[i])).push(es(h,t,e,!1))}}return n?Yp(n):i}class zo{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof ve)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let i=t._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return t?(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0):!1}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return t?t instanceof ve?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,o=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return o<0?!1:(this.stack.push(this.index),this.yieldBuf(o))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?i&Rt.ExcludeBuffers?!1:this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Rt.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&Rt.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode)):!1;let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let n=i<0?0:this.stack[i]+4;if(this.index!=n)return this.yieldBuf(e.findChild(n,this.index,-1,0,4))}else{let n=e.buffer[this.index+3];if(n<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(n)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let o=0;o<this.index;o++)if(n.buffer.buffer[o+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;{index:e,_parent:i}=i)if(e>-1)for(let o=e+t,l=t<0?-1:i._tree.children.length;o!=l;o+=t){let h=i._tree.children[o];if(this.mode&Rt.IncludeAnonymous||h instanceof an||!h.type.isAnonymous||Yh(h))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let n=this.index,o=this.stack.length;o>=0;){for(let l=t;l;l=l._parent)if(l.index==n){if(n==this.index)return l;e=l,i=o+1;break t}n=this.stack[--o]}for(let n=i;n<this.stack.length;n++)e=new rn(this.buffer,e,this.stack[n]);return this.bufferNode=new rn(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||t(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;;){if(n&&e&&e(this),n=this.type.isAnonymous,!i)return;if(this.nextSibling())break;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return rh(this.node.parent,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,o=this.stack.length-1;n>=0;o--){if(o<0)return rh(this._tree,t,n);let l=i[e.buffer[this.stack[o]]];if(!l.isAnonymous){if(t[n]&&t[n]!=l.name)return!1;n--}}return!0}}function Yh(r){return r.children.some(t=>t instanceof an||!t.type.isAnonymous||Yh(t))}function ZO(r){var t;let{buffer:e,nodeSet:i,maxBufferLength:n=qp,reused:o=[],minRepeatType:l=i.types.length}=r,h=Array.isArray(e)?new Qh(e,e.length):e,f=i.types,c=0,d=0;function g($,W,F,J,rt,bt){let{id:lt,start:j,end:et,size:vt}=h,Dt=d,oi=c;for(;vt<0;)if(h.next(),vt==-1){let Ft=o[lt];F.push(Ft),J.push(j-$);return}else if(vt==-3){c=lt;return}else if(vt==-4){d=lt;return}else throw new RangeError(`Unrecognized record size: ${vt}`);let li=f[lt],Ke,Ci,cn=j-$;if(et-j<=n&&(Ci=C(h.pos-W,rt))){let Ft=new Uint16Array(Ci.size-Ci.skip),ue=h.pos-Ci.size,Ee=Ft.length;for(;h.pos>ue;)Ee=P(Ci.start,Ft,Ee);Ke=new an(Ft,et-Ci.start,i),cn=Ci.start-$}else{let Ft=h.pos-vt;h.next();let ue=[],Ee=[],Ai=lt>=l?lt:-1,Oe=0,Ti=et;for(;h.pos>Ft;)Ai>=0&&h.id==Ai&&h.size>=0?(h.end<=Ti-n&&(b(ue,Ee,j,Oe,h.end,Ti,Ai,Dt,oi),Oe=ue.length,Ti=h.end),h.next()):bt>2500?m(j,Ft,ue,Ee):g(j,Ft,ue,Ee,Ai,bt+1);if(Ai>=0&&Oe>0&&Oe<ue.length&&b(ue,Ee,j,Oe,j,Ti,Ai,Dt,oi),ue.reverse(),Ee.reverse(),Ai>-1&&Oe>0){let ws=w(li,oi);Ke=Xh(li,ue,Ee,0,ue.length,0,et-j,ws,ws)}else Ke=S(li,ue,Ee,et-j,Dt-et,oi)}F.push(Ke),J.push(cn)}function m($,W,F,J){let rt=[],bt=0,lt=-1;for(;h.pos>W;){let{id:j,start:et,end:vt,size:Dt}=h;if(Dt>4)h.next();else{if(lt>-1&&et<lt)break;lt<0&&(lt=vt-n),rt.push(j,et,vt),bt++,h.next()}}if(bt){let j=new Uint16Array(bt*4),et=rt[rt.length-2];for(let vt=rt.length-3,Dt=0;vt>=0;vt-=3)j[Dt++]=rt[vt],j[Dt++]=rt[vt+1]-et,j[Dt++]=rt[vt+2]-et,j[Dt++]=Dt;F.push(new an(j,rt[2]-et,i)),J.push(et-$)}}function w($,W){return(F,J,rt)=>{let bt=0,lt=F.length-1,j,et;if(lt>=0&&(j=F[lt])instanceof Et){if(!lt&&j.type==$&&j.length==rt)return j;(et=j.prop(ht.lookAhead))&&(bt=J[lt]+j.length+et)}return S($,F,J,rt,bt,W)}}function b($,W,F,J,rt,bt,lt,j,et){let vt=[],Dt=[];for(;$.length>J;)vt.push($.pop()),Dt.push(W.pop()+F-rt);$.push(S(i.types[lt],vt,Dt,bt-rt,j-bt,et)),W.push(rt-F)}function S($,W,F,J,rt,bt,lt){if(bt){let j=[ht.contextHash,bt];lt=lt?[j].concat(lt):[j]}if(rt>25){let j=[ht.lookAhead,rt];lt=lt?[j].concat(lt):[j]}return new Et($,W,F,J,lt)}function C($,W){let F=h.fork(),J=0,rt=0,bt=0,lt=F.end-n,j={size:0,start:0,skip:0};t:for(let et=F.pos-$;F.pos>et;){let vt=F.size;if(F.id==W&&vt>=0){j.size=J,j.start=rt,j.skip=bt,bt+=4,J+=4,F.next();continue}let Dt=F.pos-vt;if(vt<0||Dt<et||F.start<lt)break;let oi=F.id>=l?4:0,li=F.start;for(F.next();F.pos>Dt;){if(F.size<0)if(F.size==-3)oi+=4;else break t;else F.id>=l&&(oi+=4);F.next()}rt=li,J+=vt,bt+=oi}return(W<0||J==$)&&(j.size=J,j.start=rt,j.skip=bt),j.size>4?j:void 0}function P($,W,F){let{id:J,start:rt,end:bt,size:lt}=h;if(h.next(),lt>=0&&J<l){let j=F;if(lt>4){let et=h.pos-(lt-4);for(;h.pos>et;)F=P($,W,F)}W[--F]=j,W[--F]=bt-$,W[--F]=rt-$,W[--F]=J}else lt==-3?c=J:lt==-4&&(d=J);return F}let B=[],L=[];for(;h.pos>0;)g(r.start||0,r.bufferStart||0,B,L,-1,0);let _=(t=r.length)!==null&&t!==void 0?t:B.length?L[0]+B[0].length:0;return new Et(f[r.topID],B.reverse(),L.reverse(),_)}const id=new WeakMap;function Io(r,t){if(!r.isAnonymous||t instanceof an||t.type!=r)return 1;let e=id.get(t);if(e==null){e=1;for(let i of t.children){if(i.type!=r||!(i instanceof Et)){e=1;break}e+=Io(r,i)}id.set(t,e)}return e}function Xh(r,t,e,i,n,o,l,h,f){let c=0;for(let b=i;b<n;b++)c+=Io(r,t[b]);let d=Math.ceil(c*1.5/8),g=[],m=[];function w(b,S,C,P,B){for(let L=C;L<P;){let _=L,$=S[L],W=Io(r,b[L]);for(L++;L<P;L++){let F=Io(r,b[L]);if(W+F>=d)break;W+=F}if(L==_+1){if(W>d){let F=b[_];w(F.children,F.positions,0,F.children.length,S[_]+B);continue}g.push(b[_])}else{let F=S[L-1]+b[L-1].length-$;g.push(Xh(r,b,S,_,L,$,F,null,f))}m.push($+B-o)}}return w(t,e,i,n,0),(h||f)(g,m,l)}class Vi{constructor(t,e,i,n,o=!1,l=!1){this.from=t,this.to=e,this.tree=i,this.offset=n,this.open=(o?1:0)|(l?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(t,e=[],i=!1){let n=[new Vi(0,t.length,t,0,!1,i)];for(let o of e)o.to>t.length&&n.push(o);return n}static applyChanges(t,e,i=128){if(!e.length)return t;let n=[],o=1,l=t.length?t[0]:null;for(let h=0,f=0,c=0;;h++){let d=h<e.length?e[h]:null,g=d?d.fromA:1e9;if(g-f>=i)for(;l&&l.from<g;){let m=l;if(f>=m.from||g<=m.to||c){let w=Math.max(m.from,f)-c,b=Math.min(m.to,g)-c;m=w>=b?null:new Vi(w,b,m.tree,m.offset+c,h>0,!!d)}if(m&&n.push(m),l.to>g)break;l=o<t.length?t[o++]:null}if(!d)break;f=d.toA,c=d.toA-d.toB}return n}}class Xp{startParse(t,e,i){return typeof t=="string"&&(t=new jO(t)),i=i?i.length?i.map(n=>new ze(n.from,n.to)):[new ze(0,0)]:[new ze(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let o=n.advance();if(o)return o}}}class jO{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}function JO(r){return(t,e,i,n)=>new eS(t,r,e,i,n)}class nd{constructor(t,e,i,n,o){this.parser=t,this.parse=e,this.overlay=i,this.target=n,this.from=o}}function rd(r){if(!r.length||r.some(t=>t.from>=t.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(r))}class tS{constructor(t,e,i,n,o,l,h){this.parser=t,this.predicate=e,this.mounts=i,this.index=n,this.start=o,this.target=l,this.prev=h,this.depth=0,this.ranges=[]}}const sh=new ht({perNode:!0});class eS{constructor(t,e,i,n,o){this.nest=e,this.input=i,this.fragments=n,this.ranges=o,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=t}advance(){if(this.baseParse){let i=this.baseParse.advance();if(!i)return null;if(this.baseParse=null,this.baseTree=i,this.startInner(),this.stoppedAt!=null)for(let n of this.inner)n.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let i=this.baseTree;return this.stoppedAt!=null&&(i=new Et(i.type,i.children,i.positions,i.length,i.propValues.concat([[sh,this.stoppedAt]]))),i}let t=this.inner[this.innerDone],e=t.parse.advance();if(e){this.innerDone++;let i=Object.assign(Object.create(null),t.target.props);i[ht.mounted.id]=new ts(e,t.overlay,t.parser),t.target.props=i}return null}get parsedPos(){if(this.baseParse)return 0;let t=this.input.length;for(let e=this.innerDone;e<this.inner.length;e++)this.inner[e].from<t&&(t=Math.min(t,this.inner[e].parse.parsedPos));return t}stopAt(t){if(this.stoppedAt=t,this.baseParse)this.baseParse.stopAt(t);else for(let e=this.innerDone;e<this.inner.length;e++)this.inner[e].parse.stopAt(t)}startInner(){let t=new rS(this.fragments),e=null,i=null,n=new zo(new ve(this.baseTree,this.ranges[0].from,0,null),Rt.IncludeAnonymous|Rt.IgnoreMounts);t:for(let o,l;;){let h=!0,f;if(this.stoppedAt!=null&&n.from>=this.stoppedAt)h=!1;else if(t.hasNode(n)){if(e){let c=e.mounts.find(d=>d.frag.from<=n.from&&d.frag.to>=n.to&&d.mount.overlay);if(c)for(let d of c.mount.overlay){let g=d.from+c.pos,m=d.to+c.pos;g>=n.from&&m<=n.to&&!e.ranges.some(w=>w.from<m&&w.to>g)&&e.ranges.push({from:g,to:m})}}h=!1}else if(i&&(l=iS(i.ranges,n.from,n.to)))h=l!=2;else if(!n.type.isAnonymous&&(o=this.nest(n,this.input))&&(n.from<n.to||!o.overlay)){n.tree||nS(n);let c=t.findMounts(n.from,o.parser);if(typeof o.overlay=="function")e=new tS(o.parser,o.overlay,c,this.inner.length,n.from,n.tree,e);else{let d=ld(this.ranges,o.overlay||(n.from<n.to?[new ze(n.from,n.to)]:[]));d.length&&rd(d),(d.length||!o.overlay)&&this.inner.push(new nd(o.parser,d.length?o.parser.startParse(this.input,ad(c,d),d):o.parser.startParse(""),o.overlay?o.overlay.map(g=>new ze(g.from-n.from,g.to-n.from)):null,n.tree,d.length?d[0].from:n.from)),o.overlay?d.length&&(i={ranges:d,depth:0,prev:i}):h=!1}}else if(e&&(f=e.predicate(n))&&(f===!0&&(f=new ze(n.from,n.to)),f.from<f.to)){let c=e.ranges.length-1;c>=0&&e.ranges[c].to==f.from?e.ranges[c]={from:e.ranges[c].from,to:f.to}:e.ranges.push(f)}if(h&&n.firstChild())e&&e.depth++,i&&i.depth++;else for(;!n.nextSibling();){if(!n.parent())break t;if(e&&!--e.depth){let c=ld(this.ranges,e.ranges);c.length&&(rd(c),this.inner.splice(e.index,0,new nd(e.parser,e.parser.startParse(this.input,ad(e.mounts,c),c),e.ranges.map(d=>new ze(d.from-e.start,d.to-e.start)),e.target,c[0].from))),e=e.prev}i&&!--i.depth&&(i=i.prev)}}}}function iS(r,t,e){for(let i of r){if(i.from>=e)break;if(i.to>t)return i.from<=t&&i.to>=e?2:1}return 0}function sd(r,t,e,i,n,o){if(t<e){let l=r.buffer[t+1];i.push(r.slice(t,e,l)),n.push(l-o)}}function nS(r){let{node:t}=r,e=[],i=t.context.buffer;do e.push(r.index),r.parent();while(!r.tree);let n=r.tree,o=n.children.indexOf(i),l=n.children[o],h=l.buffer,f=[o];function c(d,g,m,w,b,S){let C=e[S],P=[],B=[];sd(l,d,C,P,B,w);let L=h[C+1],_=h[C+2];f.push(P.length);let $=S?c(C+4,h[C+3],l.set.types[h[C]],L,_-L,S-1):t.toTree();return P.push($),B.push(L-w),sd(l,h[C+3],g,P,B,w),new Et(m,P,B,b)}n.children[o]=c(0,h.length,fe.none,0,l.length,e.length-1);for(let d of f){let g=r.tree.children[d],m=r.tree.positions[d];r.yield(new ve(g,m+r.from,d,r._tree))}}class od{constructor(t,e){this.offset=e,this.done=!1,this.cursor=t.cursor(Rt.IncludeAnonymous|Rt.IgnoreMounts)}moveTo(t){let{cursor:e}=this,i=t-this.offset;for(;!this.done&&e.from<i;)e.to>=t&&e.enter(i,1,Rt.IgnoreOverlays|Rt.ExcludeBuffers)||e.next(!1)||(this.done=!0)}hasNode(t){if(this.moveTo(t.from),!this.done&&this.cursor.from+this.offset==t.from&&this.cursor.tree)for(let e=this.cursor.tree;;){if(e==t.tree)return!0;if(e.children.length&&e.positions[0]==0&&e.children[0]instanceof Et)e=e.children[0];else break}return!1}}let rS=class{constructor(t){var e;if(this.fragments=t,this.curTo=0,this.fragI=0,t.length){let i=this.curFrag=t[0];this.curTo=(e=i.tree.prop(sh))!==null&&e!==void 0?e:i.to,this.inner=new od(i.tree,-i.offset)}else this.curFrag=this.inner=null}hasNode(t){for(;this.curFrag&&t.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=t.from&&this.curTo>=t.to&&this.inner.hasNode(t)}nextFrag(){var t;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let e=this.curFrag=this.fragments[this.fragI];this.curTo=(t=e.tree.prop(sh))!==null&&t!==void 0?t:e.to,this.inner=new od(e.tree,-e.offset)}}findMounts(t,e){var i;let n=[];if(this.inner){this.inner.cursor.moveTo(t,1);for(let o=this.inner.cursor.node;o;o=o.parent){let l=(i=o.tree)===null||i===void 0?void 0:i.prop(ht.mounted);if(l&&l.parser==e)for(let h=this.fragI;h<this.fragments.length;h++){let f=this.fragments[h];if(f.from>=o.to)break;f.tree==this.curFrag.tree&&n.push({frag:f,pos:o.from-f.offset,mount:l})}}}return n}};function ld(r,t){let e=null,i=t;for(let n=1,o=0;n<r.length;n++){let l=r[n-1].to,h=r[n].from;for(;o<i.length;o++){let f=i[o];if(f.from>=h)break;f.to<=l||(e||(i=e=t.slice()),f.from<l?(e[o]=new ze(f.from,l),f.to>h&&e.splice(o+1,0,new ze(h,f.to))):f.to>h?e[o--]=new ze(h,f.to):e.splice(o--,1))}}return i}function sS(r,t,e,i){let n=0,o=0,l=!1,h=!1,f=-1e9,c=[];for(;;){let d=n==r.length?1e9:l?r[n].to:r[n].from,g=o==t.length?1e9:h?t[o].to:t[o].from;if(l!=h){let m=Math.max(f,e),w=Math.min(d,g,i);m<w&&c.push(new ze(m,w))}if(f=Math.min(d,g),f==1e9)break;d==f&&(l?(l=!1,n++):l=!0),g==f&&(h?(h=!1,o++):h=!0)}return c}function ad(r,t){let e=[];for(let{pos:i,mount:n,frag:o}of r){let l=i+(n.overlay?n.overlay[0].from:0),h=l+n.tree.length,f=Math.max(o.from,l),c=Math.min(o.to,h);if(n.overlay){let d=n.overlay.map(m=>new ze(m.from+i,m.to+i)),g=sS(t,d,f,c);for(let m=0,w=f;;m++){let b=m==g.length,S=b?c:g[m].from;if(S>w&&e.push(new Vi(w,S,n.tree,-l,o.from>=w||o.openStart,o.to<=S||o.openEnd)),b)break;w=g[m].to}}else e.push(new Vi(f,c,n.tree,-l,o.from>=l||o.openStart,o.to<=h||o.openEnd))}return e}let oh=[],Kp=[];(()=>{let r="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(t=>t?parseInt(t,36):1);for(let t=0,e=0;t<r.length;t++)(t%2?Kp:oh).push(e=e+r[t])})();function oS(r){if(r<768)return!1;for(let t=0,e=oh.length;;){let i=t+e>>1;if(r<oh[i])e=i;else if(r>=Kp[i])t=i+1;else return!0;if(t==e)return!1}}function hd(r){return r>=127462&&r<=127487}const fd=8205;function lS(r,t,e=!0,i=!0){return(e?Gp:aS)(r,t,i)}function Gp(r,t,e){if(t==r.length)return t;t&&Zp(r.charCodeAt(t))&&jp(r.charCodeAt(t-1))&&t--;let i=Na(r,t);for(t+=ud(i);t<r.length;){let n=Na(r,t);if(i==fd||n==fd||e&&oS(n))t+=ud(n),i=n;else if(hd(n)){let o=0,l=t-2;for(;l>=0&&hd(Na(r,l));)o++,l-=2;if(o%2==0)break;t+=2}else break}return t}function aS(r,t,e){for(;t>0;){let i=Gp(r,t-2,e);if(i<t)return i;t--}return 0}function Na(r,t){let e=r.charCodeAt(t);if(!jp(e)||t+1==r.length)return e;let i=r.charCodeAt(t+1);return Zp(i)?(e-55296<<10)+(i-56320)+65536:e}function Zp(r){return r>=56320&&r<57344}function jp(r){return r>=55296&&r<56320}function ud(r){return r<65536?1:2}class pt{lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,i){[t,e]=rr(this,t,e);let n=[];return this.decompose(0,t,n,2),i.length&&i.decompose(0,i.length,n,3),this.decompose(e,this.length,n,1),mi.from(n,this.length-(e-t)+i.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){[t,e]=rr(this,t,e);let i=[];return this.decompose(t,e,i,0),mi.from(i,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),i=this.length-this.scanIdentical(t,-1),n=new Gr(this),o=new Gr(t);for(let l=e,h=e;;){if(n.next(l),o.next(l),l=0,n.lineBreak!=o.lineBreak||n.done!=o.done||n.value!=o.value)return!1;if(h+=n.value.length,n.done||h>=i)return!0}}iter(t=1){return new Gr(this,t)}iterRange(t,e=this.length){return new Jp(this,t,e)}iterLines(t,e){let i;if(t==null)i=this.iter();else{e==null&&(e=this.lines+1);let n=this.line(t).from;i=this.iterRange(n,Math.max(n,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new tg(i)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}constructor(){}static of(t){if(t.length==0)throw new RangeError("A document must have at least one line");return t.length==1&&!t[0]?pt.empty:t.length<=32?new $t(t):mi.from($t.split(t,[]))}}class $t extends pt{constructor(t,e=hS(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,i,n){for(let o=0;;o++){let l=this.text[o],h=n+l.length;if((e?i:h)>=t)return new fS(n,h,i,l);n=h+1,i++}}decompose(t,e,i,n){let o=t<=0&&e>=this.length?this:new $t(cd(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(n&1){let l=i.pop(),h=Bo(o.text,l.text.slice(),0,o.length);if(h.length<=32)i.push(new $t(h,l.length+o.length));else{let f=h.length>>1;i.push(new $t(h.slice(0,f)),new $t(h.slice(f)))}}else i.push(o)}replace(t,e,i){if(!(i instanceof $t))return super.replace(t,e,i);[t,e]=rr(this,t,e);let n=Bo(this.text,Bo(i.text,cd(this.text,0,t)),e),o=this.length+i.length-(e-t);return n.length<=32?new $t(n,o):mi.from($t.split(n,[]),o)}sliceString(t,e=this.length,i=`
`){[t,e]=rr(this,t,e);let n="";for(let o=0,l=0;o<=e&&l<this.text.length;l++){let h=this.text[l],f=o+h.length;o>t&&l&&(n+=i),t<f&&e>o&&(n+=h.slice(Math.max(0,t-o),e-o)),o=f+1}return n}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let i=[],n=-1;for(let o of t)i.push(o),n+=o.length+1,i.length==32&&(e.push(new $t(i,n)),i=[],n=-1);return n>-1&&e.push(new $t(i,n)),e}}class mi extends pt{constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let i of t)this.lines+=i.lines}lineInner(t,e,i,n){for(let o=0;;o++){let l=this.children[o],h=n+l.length,f=i+l.lines-1;if((e?f:h)>=t)return l.lineInner(t,e,i,n);n=h+1,i=f+1}}decompose(t,e,i,n){for(let o=0,l=0;l<=e&&o<this.children.length;o++){let h=this.children[o],f=l+h.length;if(t<=f&&e>=l){let c=n&((l<=t?1:0)|(f>=e?2:0));l>=t&&f<=e&&!c?i.push(h):h.decompose(t-l,e-l,i,c)}l=f+1}}replace(t,e,i){if([t,e]=rr(this,t,e),i.lines<this.lines)for(let n=0,o=0;n<this.children.length;n++){let l=this.children[n],h=o+l.length;if(t>=o&&e<=h){let f=l.replace(t-o,e-o,i),c=this.lines-l.lines+f.lines;if(f.lines<c>>4&&f.lines>c>>6){let d=this.children.slice();return d[n]=f,new mi(d,this.length-(e-t)+i.length)}return super.replace(o,h,f)}o=h+1}return super.replace(t,e,i)}sliceString(t,e=this.length,i=`
`){[t,e]=rr(this,t,e);let n="";for(let o=0,l=0;o<this.children.length&&l<=e;o++){let h=this.children[o],f=l+h.length;l>t&&o&&(n+=i),t<f&&e>l&&(n+=h.sliceString(t-l,e-l,i)),l=f+1}return n}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof mi))return 0;let i=0,[n,o,l,h]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;n+=e,o+=e){if(n==l||o==h)return i;let f=this.children[n],c=t.children[o];if(f!=c)return i+f.scanIdentical(c,e);i+=f.length+1}}static from(t,e=t.reduce((i,n)=>i+n.length+1,-1)){let i=0;for(let w of t)i+=w.lines;if(i<32){let w=[];for(let b of t)b.flatten(w);return new $t(w,e)}let n=Math.max(32,i>>5),o=n<<1,l=n>>1,h=[],f=0,c=-1,d=[];function g(w){let b;if(w.lines>o&&w instanceof mi)for(let S of w.children)g(S);else w.lines>l&&(f>l||!f)?(m(),h.push(w)):w instanceof $t&&f&&(b=d[d.length-1])instanceof $t&&w.lines+b.lines<=32?(f+=w.lines,c+=w.length+1,d[d.length-1]=new $t(b.text.concat(w.text),b.length+1+w.length)):(f+w.lines>n&&m(),f+=w.lines,c+=w.length+1,d.push(w))}function m(){f!=0&&(h.push(d.length==1?d[0]:mi.from(d,c)),c=-1,f=d.length=0)}for(let w of t)g(w);return m(),h.length==1?h[0]:new mi(h,e)}}pt.empty=new $t([""],0);function hS(r){let t=-1;for(let e of r)t+=e.length+1;return t}function Bo(r,t,e=0,i=1e9){for(let n=0,o=0,l=!0;o<r.length&&n<=i;o++){let h=r[o],f=n+h.length;f>=e&&(f>i&&(h=h.slice(0,i-n)),n<e&&(h=h.slice(e-n)),l?(t[t.length-1]+=h,l=!1):t.push(h)),n=f+1}return t}function cd(r,t,e){return Bo(r,[""],t,e)}class Gr{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof $t?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,n=this.nodes[i],o=this.offsets[i],l=o>>1,h=n instanceof $t?n.text.length:n.children.length;if(l==(e>0?h:0)){if(i==0)return this.done=!0,this.value="",this;e>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((o&1)==(e>0?0:1)){if(this.offsets[i]+=e,t==0)return this.lineBreak=!0,this.value=`
`,this;t--}else if(n instanceof $t){let f=n.text[l+(e<0?-1:0)];if(this.offsets[i]+=e,f.length>Math.max(0,t))return this.value=t==0?f:e>0?f.slice(t):f.slice(0,f.length-t),this;t-=f.length}else{let f=n.children[l+(e<0?-1:0)];t>f.length?(t-=f.length,this.offsets[i]+=e):(e<0&&this.offsets[i]--,this.nodes.push(f),this.offsets.push(e>0?1:(f instanceof $t?f.text.length:f.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class Jp{constructor(t,e,i){this.value="",this.done=!1,this.cursor=new Gr(t,e>i?-1:1),this.pos=e>i?t.length:0,this.from=Math.min(e,i),this.to=Math.max(e,i)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let i=e<0?this.pos-this.from:this.to-this.pos;t>i&&(t=i),i-=t;let{value:n}=this.cursor.next(t);return this.pos+=(n.length+t)*e,this.value=n.length<=i?n:e<0?n.slice(n.length-i):n.slice(0,i),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class tg{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:i,value:n}=this.inner.next(t);return e&&this.afterBreak?(this.value="",this.afterBreak=!1):e?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(pt.prototype[Symbol.iterator]=function(){return this.iter()},Gr.prototype[Symbol.iterator]=Jp.prototype[Symbol.iterator]=tg.prototype[Symbol.iterator]=function(){return this});class fS{constructor(t,e,i,n){this.from=t,this.to=e,this.number=i,this.text=n}get length(){return this.to-this.from}}function rr(r,t,e){return t=Math.max(0,Math.min(r.length,t)),[t,Math.max(t,Math.min(r.length,e))]}function vi(r,t,e=!0,i=!0){return lS(r,t,e,i)}function uS(r){return r>=56320&&r<57344}function cS(r){return r>=55296&&r<56320}function Ve(r,t){let e=r.charCodeAt(t);if(!cS(e)||t+1==r.length)return e;let i=r.charCodeAt(t+1);return uS(i)?(e-55296<<10)+(i-56320)+65536:e}function eg(r){return r<=65535?String.fromCharCode(r):(r-=65536,String.fromCharCode((r>>10)+55296,(r&1023)+56320))}function Wi(r){return r<65536?1:2}const lh=/\r\n?|\n/;var le=function(r){return r[r.Simple=0]="Simple",r[r.TrackDel=1]="TrackDel",r[r.TrackBefore=2]="TrackBefore",r[r.TrackAfter=3]="TrackAfter",r}(le||(le={}));class Oi{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e+1];t+=i<0?this.sections[e]:i}return t}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(t){for(let e=0,i=0,n=0;e<this.sections.length;){let o=this.sections[e++],l=this.sections[e++];l<0?(t(i,n,o),n+=o):n+=l,i+=o}}iterChangedRanges(t,e=!1){ah(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];n<0?t.push(i,n):t.push(n,i)}return new Oi(t)}composeDesc(t){return this.empty?t:t.empty?this:ig(this,t)}mapDesc(t,e=!1){return t.empty?this:hh(this,t,e)}mapPos(t,e=-1,i=le.Simple){let n=0,o=0;for(let l=0;l<this.sections.length;){let h=this.sections[l++],f=this.sections[l++],c=n+h;if(f<0){if(c>t)return o+(t-n);o+=h}else{if(i!=le.Simple&&c>=t&&(i==le.TrackDel&&n<t&&c>t||i==le.TrackBefore&&n<t||i==le.TrackAfter&&c>t))return null;if(c>t||c==t&&e<0&&!h)return t==n||e<0?o:o+f;o+=f}n=c}if(t>n)throw new RangeError(`Position ${t} is out of range for changeset of length ${n}`);return o}touchesRange(t,e=t){for(let i=0,n=0;i<this.sections.length&&n<=e;){let o=this.sections[i++],l=this.sections[i++],h=n+o;if(l>=0&&n<=e&&h>=t)return n<t&&h>e?"cover":!0;n=h}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];t+=(t?" ":"")+i+(n>=0?":"+n:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some(e=>typeof e!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Oi(t)}static create(t){return new Oi(t)}}class Ut extends Oi{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return ah(this,(e,i,n,o,l)=>t=t.replace(n,n+(i-e),l),!1),t}mapDesc(t,e=!1){return hh(this,t,e,!0)}invert(t){let e=this.sections.slice(),i=[];for(let n=0,o=0;n<e.length;n+=2){let l=e[n],h=e[n+1];if(h>=0){e[n]=h,e[n+1]=l;let f=n>>1;for(;i.length<f;)i.push(pt.empty);i.push(l?t.slice(o,o+l):pt.empty)}o+=l}return new Ut(e,i)}compose(t){return this.empty?t:t.empty?this:ig(this,t,!0)}map(t,e=!1){return t.empty?this:hh(this,t,e,!0)}iterChanges(t,e=!1){ah(this,t,e)}get desc(){return Oi.create(this.sections)}filter(t){let e=[],i=[],n=[],o=new is(this);t:for(let l=0,h=0;;){let f=l==t.length?1e9:t[l++];for(;h<f||h==f&&o.len==0;){if(o.done)break t;let d=Math.min(o.len,f-h);ee(n,d,-1);let g=o.ins==-1?-1:o.off==0?o.ins:0;ee(e,d,g),g>0&&sn(i,e,o.text),o.forward(d),h+=d}let c=t[l++];for(;h<c;){if(o.done)break t;let d=Math.min(o.len,c-h);ee(e,d,-1),ee(n,d,o.ins==-1?-1:o.off==0?o.ins:0),o.forward(d),h+=d}}return{changes:new Ut(e,i),filtered:Oi.create(n)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e],n=this.sections[e+1];n<0?t.push(i):n==0?t.push([i]):t.push([i].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,i){let n=[],o=[],l=0,h=null;function f(d=!1){if(!d&&!n.length)return;l<e&&ee(n,e-l,-1);let g=new Ut(n,o);h=h?h.compose(g.map(h)):g,n=[],o=[],l=0}function c(d){if(Array.isArray(d))for(let g of d)c(g);else if(d instanceof Ut){if(d.length!=e)throw new RangeError(`Mismatched change set length (got ${d.length}, expected ${e})`);f(),h=h?h.compose(d.map(h)):d}else{let{from:g,to:m=g,insert:w}=d;if(g>m||g<0||m>e)throw new RangeError(`Invalid change range ${g} to ${m} (in doc of length ${e})`);let b=w?typeof w=="string"?pt.of(w.split(i||lh)):w:pt.empty,S=b.length;if(g==m&&S==0)return;g<l&&f(),g>l&&ee(n,g-l,-1),ee(n,m-g,S),sn(o,n,b),l=m}}return c(t),f(!h),h}static empty(t){return new Ut(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let e=[],i=[];for(let n=0;n<t.length;n++){let o=t[n];if(typeof o=="number")e.push(o,-1);else{if(!Array.isArray(o)||typeof o[0]!="number"||o.some((l,h)=>h&&typeof l!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(o.length==1)e.push(o[0],0);else{for(;i.length<n;)i.push(pt.empty);i[n]=pt.of(o.slice(1)),e.push(o[0],i[n].length)}}}return new Ut(e,i)}static createSet(t,e){return new Ut(t,e)}}function ee(r,t,e,i=!1){if(t==0&&e<=0)return;let n=r.length-2;n>=0&&e<=0&&e==r[n+1]?r[n]+=t:n>=0&&t==0&&r[n]==0?r[n+1]+=e:i?(r[n]+=t,r[n+1]+=e):r.push(t,e)}function sn(r,t,e){if(e.length==0)return;let i=t.length-2>>1;if(i<r.length)r[r.length-1]=r[r.length-1].append(e);else{for(;r.length<i;)r.push(pt.empty);r.push(e)}}function ah(r,t,e){let i=r.inserted;for(let n=0,o=0,l=0;l<r.sections.length;){let h=r.sections[l++],f=r.sections[l++];if(f<0)n+=h,o+=h;else{let c=n,d=o,g=pt.empty;for(;c+=h,d+=f,f&&i&&(g=g.append(i[l-2>>1])),!(e||l==r.sections.length||r.sections[l+1]<0);)h=r.sections[l++],f=r.sections[l++];t(n,c,o,d,g),n=c,o=d}}}function hh(r,t,e,i=!1){let n=[],o=i?[]:null,l=new is(r),h=new is(t);for(let f=-1;;){if(l.done&&h.len||h.done&&l.len)throw new Error("Mismatched change set lengths");if(l.ins==-1&&h.ins==-1){let c=Math.min(l.len,h.len);ee(n,c,-1),l.forward(c),h.forward(c)}else if(h.ins>=0&&(l.ins<0||f==l.i||l.off==0&&(h.len<l.len||h.len==l.len&&!e))){let c=h.len;for(ee(n,h.ins,-1);c;){let d=Math.min(l.len,c);l.ins>=0&&f<l.i&&l.len<=d&&(ee(n,0,l.ins),o&&sn(o,n,l.text),f=l.i),l.forward(d),c-=d}h.next()}else if(l.ins>=0){let c=0,d=l.len;for(;d;)if(h.ins==-1){let g=Math.min(d,h.len);c+=g,d-=g,h.forward(g)}else if(h.ins==0&&h.len<d)d-=h.len,h.next();else break;ee(n,c,f<l.i?l.ins:0),o&&f<l.i&&sn(o,n,l.text),f=l.i,l.forward(l.len-d)}else{if(l.done&&h.done)return o?Ut.createSet(n,o):Oi.create(n);throw new Error("Mismatched change set lengths")}}}function ig(r,t,e=!1){let i=[],n=e?[]:null,o=new is(r),l=new is(t);for(let h=!1;;){if(o.done&&l.done)return n?Ut.createSet(i,n):Oi.create(i);if(o.ins==0)ee(i,o.len,0,h),o.next();else if(l.len==0&&!l.done)ee(i,0,l.ins,h),n&&sn(n,i,l.text),l.next();else{if(o.done||l.done)throw new Error("Mismatched change set lengths");{let f=Math.min(o.len2,l.len),c=i.length;if(o.ins==-1){let d=l.ins==-1?-1:l.off?0:l.ins;ee(i,f,d,h),n&&d&&sn(n,i,l.text)}else l.ins==-1?(ee(i,o.off?0:o.len,f,h),n&&sn(n,i,o.textBit(f))):(ee(i,o.off?0:o.len,l.off?0:l.ins,h),n&&!l.off&&sn(n,i,l.text));h=(o.ins>f||l.ins>=0&&l.len>f)&&(h||i.length>c),o.forward2(f),l.forward(f)}}}}class is{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?pt.empty:t[e]}textBit(t){let{inserted:e}=this.set,i=this.i-2>>1;return i>=e.length&&!t?pt.empty:e[i].slice(this.off,t==null?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){this.ins==-1?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class Cn{constructor(t,e,i){this.from=t,this.to=e,this.flags=i}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let t=this.flags&7;return t==7?null:t}get goalColumn(){let t=this.flags>>6;return t==16777215?void 0:t}map(t,e=-1){let i,n;return this.empty?i=n=t.mapPos(this.from,e):(i=t.mapPos(this.from,1),n=t.mapPos(this.to,-1)),i==this.from&&n==this.to?this:new Cn(i,n,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return z.range(t,e);let i=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return z.range(this.anchor,i)}eq(t,e=!1){return this.anchor==t.anchor&&this.head==t.head&&(!e||!this.empty||this.assoc==t.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return z.range(t.anchor,t.head)}static create(t,e,i){return new Cn(t,e,i)}}class z{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:z.create(this.ranges.map(i=>i.map(t,e)),this.mainIndex)}eq(t,e=!1){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(t.ranges[i],e))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new z([this.main],0)}addRange(t,e=!0){return z.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let i=this.ranges.slice();return i[e]=t,z.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(t=>t.toJSON()),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||typeof t.main!="number"||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new z(t.ranges.map(e=>Cn.fromJSON(e)),t.main)}static single(t,e=t){return new z([z.range(t,e)],0)}static create(t,e=0){if(t.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,n=0;n<t.length;n++){let o=t[n];if(o.empty?o.from<=i:o.from<i)return z.normalized(t.slice(),e);i=o.to}return new z(t,e)}static cursor(t,e=0,i,n){return Cn.create(t,t,(e==0?0:e<0?8:16)|(i==null?7:Math.min(6,i))|(n??16777215)<<6)}static range(t,e,i,n){let o=(i??16777215)<<6|(n==null?7:Math.min(6,n));return e<t?Cn.create(e,t,48|o):Cn.create(t,e,(e>t?8:0)|o)}static normalized(t,e=0){let i=t[e];t.sort((n,o)=>n.from-o.from),e=t.indexOf(i);for(let n=1;n<t.length;n++){let o=t[n],l=t[n-1];if(o.empty?o.from<=l.to:o.from<l.to){let h=l.from,f=Math.max(o.to,l.to);n<=e&&e--,t.splice(--n,2,o.anchor>o.head?z.range(f,h):z.range(h,f))}}return new z(t,e)}}function ng(r,t){for(let e of r.ranges)if(e.to>t)throw new RangeError("Selection points outside of document")}let Kh=0;class Y{constructor(t,e,i,n,o){this.combine=t,this.compareInput=e,this.compare=i,this.isStatic=n,this.id=Kh++,this.default=t([]),this.extensions=typeof o=="function"?o(this):o}get reader(){return this}static define(t={}){return new Y(t.combine||(e=>e),t.compareInput||((e,i)=>e===i),t.compare||(t.combine?(e,i)=>e===i:Gh),!!t.static,t.enables)}of(t){return new Lo([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Lo(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Lo(t,this,2,e)}from(t,e){return e||(e=i=>i),this.compute([t],i=>e(i.field(t)))}}function Gh(r,t){return r==t||r.length==t.length&&r.every((e,i)=>e===t[i])}class Lo{constructor(t,e,i,n){this.dependencies=t,this.facet=e,this.type=i,this.value=n,this.id=Kh++}dynamicSlot(t){var e;let i=this.value,n=this.facet.compareInput,o=this.id,l=t[o]>>1,h=this.type==2,f=!1,c=!1,d=[];for(let g of this.dependencies)g=="doc"?f=!0:g=="selection"?c=!0:(((e=t[g.id])!==null&&e!==void 0?e:1)&1)==0&&d.push(t[g.id]);return{create(g){return g.values[l]=i(g),1},update(g,m){if(f&&m.docChanged||c&&(m.docChanged||m.selection)||fh(g,d)){let w=i(g);if(h?!dd(w,g.values[l],n):!n(w,g.values[l]))return g.values[l]=w,1}return 0},reconfigure:(g,m)=>{let w,b=m.config.address[o];if(b!=null){let S=Uo(m,b);if(this.dependencies.every(C=>C instanceof Y?m.facet(C)===g.facet(C):C instanceof be?m.field(C,!1)==g.field(C,!1):!0)||(h?dd(w=i(g),S,n):n(w=i(g),S)))return g.values[l]=S,0}else w=i(g);return g.values[l]=w,1}}}}function dd(r,t,e){if(r.length!=t.length)return!1;for(let i=0;i<r.length;i++)if(!e(r[i],t[i]))return!1;return!0}function fh(r,t){let e=!1;for(let i of t)Zr(r,i)&1&&(e=!0);return e}function dS(r,t,e){let i=e.map(f=>r[f.id]),n=e.map(f=>f.type),o=i.filter(f=>!(f&1)),l=r[t.id]>>1;function h(f){let c=[];for(let d=0;d<i.length;d++){let g=Uo(f,i[d]);if(n[d]==2)for(let m of g)c.push(m);else c.push(g)}return t.combine(c)}return{create(f){for(let c of i)Zr(f,c);return f.values[l]=h(f),1},update(f,c){if(!fh(f,o))return 0;let d=h(f);return t.compare(d,f.values[l])?0:(f.values[l]=d,1)},reconfigure(f,c){let d=fh(f,i),g=c.config.facets[t.id],m=c.facet(t);if(g&&!d&&Gh(e,g))return f.values[l]=m,0;let w=h(f);return t.compare(w,m)?(f.values[l]=m,0):(f.values[l]=w,1)}}}const co=Y.define({static:!0});class be{constructor(t,e,i,n,o){this.id=t,this.createF=e,this.updateF=i,this.compareF=n,this.spec=o,this.provides=void 0}static define(t){let e=new be(Kh++,t.create,t.update,t.compare||((i,n)=>i===n),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet(co).find(i=>i.field==this);return(e?.create||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:i=>(i.values[e]=this.create(i),1),update:(i,n)=>{let o=i.values[e],l=this.updateF(o,n);return this.compareF(o,l)?0:(i.values[e]=l,1)},reconfigure:(i,n)=>{let o=i.facet(co),l=n.facet(co),h;return(h=o.find(f=>f.field==this))&&h!=l.find(f=>f.field==this)?(i.values[e]=h.create(i),1):n.config.address[this.id]!=null?(i.values[e]=n.field(this),0):(i.values[e]=this.create(i),1)}}}init(t){return[this,co.of({field:this,create:t})]}get extension(){return this}}const Sn={lowest:4,low:3,default:2,high:1,highest:0};function Nr(r){return t=>new rg(t,r)}const cs={highest:Nr(Sn.highest),high:Nr(Sn.high),default:Nr(Sn.default),low:Nr(Sn.low),lowest:Nr(Sn.lowest)};class rg{constructor(t,e){this.inner=t,this.prec=e}}class gi{of(t){return new uh(this,t)}reconfigure(t){return gi.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class uh{constructor(t,e){this.compartment=t,this.inner=e}}class qo{constructor(t,e,i,n,o,l){for(this.base=t,this.compartments=e,this.dynamicSlots=i,this.address=n,this.staticValues=o,this.facets=l,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return e==null?t.default:this.staticValues[e>>1]}static resolve(t,e,i){let n=[],o=Object.create(null),l=new Map;for(let m of pS(t,e,l))m instanceof be?n.push(m):(o[m.facet.id]||(o[m.facet.id]=[])).push(m);let h=Object.create(null),f=[],c=[];for(let m of n)h[m.id]=c.length<<1,c.push(w=>m.slot(w));let d=i?.config.facets;for(let m in o){let w=o[m],b=w[0].facet,S=d&&d[m]||[];if(w.every(C=>C.type==0))if(h[b.id]=f.length<<1|1,Gh(S,w))f.push(i.facet(b));else{let C=b.combine(w.map(P=>P.value));f.push(i&&b.compare(C,i.facet(b))?i.facet(b):C)}else{for(let C of w)C.type==0?(h[C.id]=f.length<<1|1,f.push(C.value)):(h[C.id]=c.length<<1,c.push(P=>C.dynamicSlot(P)));h[b.id]=c.length<<1,c.push(C=>dS(C,b,w))}}let g=c.map(m=>m(h));return new qo(t,l,g,h,f,o)}}function pS(r,t,e){let i=[[],[],[],[],[]],n=new Map;function o(l,h){let f=n.get(l);if(f!=null){if(f<=h)return;let c=i[f].indexOf(l);c>-1&&i[f].splice(c,1),l instanceof uh&&e.delete(l.compartment)}if(n.set(l,h),Array.isArray(l))for(let c of l)o(c,h);else if(l instanceof uh){if(e.has(l.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=t.get(l.compartment)||l.inner;e.set(l.compartment,c),o(c,h)}else if(l instanceof rg)o(l.inner,l.prec);else if(l instanceof be)i[h].push(l),l.provides&&o(l.provides,h);else if(l instanceof Lo)i[h].push(l),l.facet.extensions&&o(l.facet.extensions,Sn.default);else{let c=l.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${l}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);o(c,h)}}return o(r,Sn.default),i.reduce((l,h)=>l.concat(h))}function Zr(r,t){if(t&1)return 2;let e=t>>1,i=r.status[e];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;r.status[e]=4;let n=r.computeSlot(r,r.config.dynamicSlots[e]);return r.status[e]=2|n}function Uo(r,t){return t&1?r.config.staticValues[t>>1]:r.values[t>>1]}const sg=Y.define(),ch=Y.define({combine:r=>r.some(t=>t),static:!0}),og=Y.define({combine:r=>r.length?r[0]:void 0,static:!0}),lg=Y.define(),ag=Y.define(),hg=Y.define(),fg=Y.define({combine:r=>r.length?r[0]:!1});class qi{constructor(t,e){this.type=t,this.value=e}static define(){return new gS}}class gS{of(t){return new qi(this,t)}}class mS{constructor(t){this.map=t}of(t){return new ct(this,t)}}class ct{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return e===void 0?void 0:e==this.value?this:new ct(this.type,e)}is(t){return this.type==t}static define(t={}){return new mS(t.map||(e=>e))}static mapEffects(t,e){if(!t.length)return t;let i=[];for(let n of t){let o=n.map(e);o&&i.push(o)}return i}}ct.reconfigure=ct.define();ct.appendConfig=ct.define();class Qt{constructor(t,e,i,n,o,l){this.startState=t,this.changes=e,this.selection=i,this.effects=n,this.annotations=o,this.scrollIntoView=l,this._doc=null,this._state=null,i&&ng(i,e.newLength),o.some(h=>h.type==Qt.time)||(this.annotations=o.concat(Qt.time.of(Date.now())))}static create(t,e,i,n,o,l){return new Qt(t,e,i,n,o,l)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(Qt.userEvent);return!!(e&&(e==t||e.length>t.length&&e.slice(0,t.length)==t&&e[t.length]=="."))}}Qt.time=qi.define();Qt.userEvent=qi.define();Qt.addToHistory=qi.define();Qt.remote=qi.define();function yS(r,t){let e=[];for(let i=0,n=0;;){let o,l;if(i<r.length&&(n==t.length||t[n]>=r[i]))o=r[i++],l=r[i++];else if(n<t.length)o=t[n++],l=t[n++];else return e;!e.length||e[e.length-1]<o?e.push(o,l):e[e.length-1]<l&&(e[e.length-1]=l)}}function ug(r,t,e){var i;let n,o,l;return e?(n=t.changes,o=Ut.empty(t.changes.length),l=r.changes.compose(t.changes)):(n=t.changes.map(r.changes),o=r.changes.mapDesc(t.changes,!0),l=r.changes.compose(n)),{changes:l,selection:t.selection?t.selection.map(o):(i=r.selection)===null||i===void 0?void 0:i.map(n),effects:ct.mapEffects(r.effects,n).concat(ct.mapEffects(t.effects,o)),annotations:r.annotations.length?r.annotations.concat(t.annotations):t.annotations,scrollIntoView:r.scrollIntoView||t.scrollIntoView}}function dh(r,t,e){let i=t.selection,n=Zn(t.annotations);return t.userEvent&&(n=n.concat(Qt.userEvent.of(t.userEvent))),{changes:t.changes instanceof Ut?t.changes:Ut.of(t.changes||[],e,r.facet(og)),selection:i&&(i instanceof z?i:z.single(i.anchor,i.head)),effects:Zn(t.effects),annotations:n,scrollIntoView:!!t.scrollIntoView}}function cg(r,t,e){let i=dh(r,t.length?t[0]:{},r.doc.length);t.length&&t[0].filter===!1&&(e=!1);for(let o=1;o<t.length;o++){t[o].filter===!1&&(e=!1);let l=!!t[o].sequential;i=ug(i,dh(r,t[o],l?i.changes.newLength:r.doc.length),l)}let n=Qt.create(r,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return vS(e?wS(n):n)}function wS(r){let t=r.startState,e=!0;for(let n of t.facet(lg)){let o=n(r);if(o===!1){e=!1;break}Array.isArray(o)&&(e=e===!0?o:yS(e,o))}if(e!==!0){let n,o;if(e===!1)o=r.changes.invertedDesc,n=Ut.empty(t.doc.length);else{let l=r.changes.filter(e);n=l.changes,o=l.filtered.mapDesc(l.changes).invertedDesc}r=Qt.create(t,n,r.selection&&r.selection.map(o),ct.mapEffects(r.effects,o),r.annotations,r.scrollIntoView)}let i=t.facet(ag);for(let n=i.length-1;n>=0;n--){let o=i[n](r);o instanceof Qt?r=o:Array.isArray(o)&&o.length==1&&o[0]instanceof Qt?r=o[0]:r=cg(t,Zn(o),!1)}return r}function vS(r){let t=r.startState,e=t.facet(hg),i=r;for(let n=e.length-1;n>=0;n--){let o=e[n](r);o&&Object.keys(o).length&&(i=ug(i,dh(t,o,r.changes.newLength),!0))}return i==r?r:Qt.create(t,r.changes,r.selection,i.effects,i.annotations,i.scrollIntoView)}const xS=[];function Zn(r){return r==null?xS:Array.isArray(r)?r:[r]}var qe=function(r){return r[r.Word=0]="Word",r[r.Space=1]="Space",r[r.Other=2]="Other",r}(qe||(qe={}));const bS=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let ph;try{ph=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function OS(r){if(ph)return ph.test(r);for(let t=0;t<r.length;t++){let e=r[t];if(/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||bS.test(e)))return!0}return!1}function SS(r){return t=>{if(!/\S/.test(t))return qe.Space;if(OS(t))return qe.Word;for(let e=0;e<r.length;e++)if(t.indexOf(r[e])>-1)return qe.Word;return qe.Other}}class mt{constructor(t,e,i,n,o,l){this.config=t,this.doc=e,this.selection=i,this.values=n,this.status=t.statusTemplate.slice(),this.computeSlot=o,l&&(l._state=this);for(let h=0;h<this.config.dynamicSlots.length;h++)Zr(this,h<<1);this.computeSlot=null}field(t,e=!0){let i=this.config.address[t.id];if(i==null){if(e)throw new RangeError("Field is not present in this state");return}return Zr(this,i),Uo(this,i)}update(...t){return cg(this,t,!0)}applyTransaction(t){let e=this.config,{base:i,compartments:n}=e;for(let h of t.effects)h.is(gi.reconfigure)?(e&&(n=new Map,e.compartments.forEach((f,c)=>n.set(c,f)),e=null),n.set(h.value.compartment,h.value.extension)):h.is(ct.reconfigure)?(e=null,i=h.value):h.is(ct.appendConfig)&&(e=null,i=Zn(i).concat(h.value));let o;e?o=t.startState.values.slice():(e=qo.resolve(i,n,this),o=new mt(e,this.doc,this.selection,e.dynamicSlots.map(()=>null),(f,c)=>c.reconfigure(f,this),null).values);let l=t.startState.facet(ch)?t.newSelection:t.newSelection.asSingle();new mt(e,t.newDoc,l,o,(h,f)=>f.update(h,t),t)}replaceSelection(t){return typeof t=="string"&&(t=this.toText(t)),this.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:t},range:z.cursor(e.from+t.length)}))}changeByRange(t){let e=this.selection,i=t(e.ranges[0]),n=this.changes(i.changes),o=[i.range],l=Zn(i.effects);for(let h=1;h<e.ranges.length;h++){let f=t(e.ranges[h]),c=this.changes(f.changes),d=c.map(n);for(let m=0;m<h;m++)o[m]=o[m].map(d);let g=n.mapDesc(c,!0);o.push(f.range.map(g)),n=n.compose(d),l=ct.mapEffects(l,d).concat(ct.mapEffects(Zn(f.effects),g))}return{changes:n,selection:z.create(o,e.mainIndex),effects:l}}changes(t=[]){return t instanceof Ut?t:Ut.of(t,this.doc.length,this.facet(mt.lineSeparator))}toText(t){return pt.of(t.split(this.facet(mt.lineSeparator)||lh))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return e==null?t.default:(Zr(this,e),Uo(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let i in t){let n=t[i];n instanceof be&&this.config.address[n.id]!=null&&(e[i]=n.spec.toJSON(this.field(t[i]),this))}return e}static fromJSON(t,e={},i){if(!t||typeof t.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(i){for(let o in i)if(Object.prototype.hasOwnProperty.call(t,o)){let l=i[o],h=t[o];n.push(l.init(f=>l.spec.fromJSON(h,f)))}}return mt.create({doc:t.doc,selection:z.fromJSON(t.selection),extensions:e.extensions?n.concat([e.extensions]):n})}static create(t={}){let e=qo.resolve(t.extensions||[],new Map),i=t.doc instanceof pt?t.doc:pt.of((t.doc||"").split(e.staticFacet(mt.lineSeparator)||lh)),n=t.selection?t.selection instanceof z?t.selection:z.single(t.selection.anchor,t.selection.head):z.single(0);return ng(n,i.length),e.staticFacet(ch)||(n=n.asSingle()),new mt(e,i,n,e.dynamicSlots.map(()=>null),(o,l)=>l.create(o),null)}get tabSize(){return this.facet(mt.tabSize)}get lineBreak(){return this.facet(mt.lineSeparator)||`
`}get readOnly(){return this.facet(fg)}phrase(t,...e){for(let i of this.facet(mt.phrases))if(Object.prototype.hasOwnProperty.call(i,t)){t=i[t];break}return e.length&&(t=t.replace(/\$(\$|\d*)/g,(i,n)=>{if(n=="$")return"$";let o=+(n||1);return!o||o>e.length?i:e[o-1]})),t}languageDataAt(t,e,i=-1){let n=[];for(let o of this.facet(sg))for(let l of o(this,e,i))Object.prototype.hasOwnProperty.call(l,t)&&n.push(l[t]);return n}charCategorizer(t){return SS(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:e,from:i,length:n}=this.doc.lineAt(t),o=this.charCategorizer(t),l=t-i,h=t-i;for(;l>0;){let f=vi(e,l,!1);if(o(e.slice(f,l))!=qe.Word)break;l=f}for(;h<n;){let f=vi(e,h);if(o(e.slice(h,f))!=qe.Word)break;h=f}return l==h?null:z.range(l+i,h+i)}}mt.allowMultipleSelections=ch;mt.tabSize=Y.define({combine:r=>r.length?r[0]:4});mt.lineSeparator=og;mt.readOnly=fg;mt.phrases=Y.define({compare(r,t){let e=Object.keys(r),i=Object.keys(t);return e.length==i.length&&e.every(n=>r[n]==t[n])}});mt.languageData=sg;mt.changeFilter=lg;mt.transactionFilter=ag;mt.transactionExtender=hg;gi.reconfigure=ct.define();function fl(r,t,e={}){let i={};for(let n of r)for(let o of Object.keys(n)){let l=n[o],h=i[o];if(h===void 0)i[o]=l;else if(!(h===l||l===void 0))if(Object.hasOwnProperty.call(e,o))i[o]=e[o](h,l);else throw new Error("Config merge conflict for field "+o)}for(let n in t)i[n]===void 0&&(i[n]=t[n]);return i}class Mn{eq(t){return this==t}range(t,e=t){return ns.create(t,e,this)}}Mn.prototype.startSide=Mn.prototype.endSide=0;Mn.prototype.point=!1;Mn.prototype.mapMode=le.TrackDel;class ns{constructor(t,e,i){this.from=t,this.to=e,this.value=i}static create(t,e,i){return new ns(t,e,i)}}function gh(r,t){return r.from-t.from||r.value.startSide-t.value.startSide}class Zh{constructor(t,e,i,n){this.from=t,this.to=e,this.value=i,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(t,e,i,n=0){let o=i?this.to:this.from;for(let l=n,h=o.length;;){if(l==h)return l;let f=l+h>>1,c=o[f]-t||(i?this.value[f].endSide:this.value[f].startSide)-e;if(f==l)return c>=0?l:h;c>=0?h=f:l=f+1}}between(t,e,i,n){for(let o=this.findIndex(e,-1e9,!0),l=this.findIndex(i,1e9,!1,o);o<l;o++)if(n(this.from[o]+t,this.to[o]+t,this.value[o])===!1)return!1}map(t,e){let i=[],n=[],o=[],l=-1,h=-1;for(let f=0;f<this.value.length;f++){let c=this.value[f],d=this.from[f]+t,g=this.to[f]+t,m,w;if(d==g){let b=e.mapPos(d,c.startSide,c.mapMode);if(b==null||(m=w=b,c.startSide!=c.endSide&&(w=e.mapPos(d,c.endSide),w<m)))continue}else if(m=e.mapPos(d,c.startSide),w=e.mapPos(g,c.endSide),m>w||m==w&&c.startSide>0&&c.endSide<=0)continue;(w-m||c.endSide-c.startSide)<0||(l<0&&(l=m),c.point&&(h=Math.max(h,w-m)),i.push(c),n.push(m-l),o.push(w-l))}return{mapped:i.length?new Zh(n,o,i,h):null,pos:l}}}class At{constructor(t,e,i,n){this.chunkPos=t,this.chunk=e,this.nextLayer=i,this.maxPoint=n}static create(t,e,i,n){return new At(t,e,i,n)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:i=!1,filterFrom:n=0,filterTo:o=this.length}=t,l=t.filter;if(e.length==0&&!l)return this;if(i&&(e=e.slice().sort(gh)),this.isEmpty)return e.length?At.of(e):this;let h=new dg(this,null,-1).goto(0),f=0,c=[],d=new sr;for(;h.value||f<e.length;)if(f<e.length&&(h.from-e[f].from||h.startSide-e[f].value.startSide)>=0){let g=e[f++];d.addInner(g.from,g.to,g.value)||c.push(g)}else h.rangeIndex==1&&h.chunkIndex<this.chunk.length&&(f==e.length||this.chunkEnd(h.chunkIndex)<e[f].from)&&(!l||n>this.chunkEnd(h.chunkIndex)||o<this.chunkPos[h.chunkIndex])&&d.addChunk(this.chunkPos[h.chunkIndex],this.chunk[h.chunkIndex])?h.nextChunk():((!l||n>h.to||o<h.from||l(h.from,h.to,h.value))&&(d.addInner(h.from,h.to,h.value)||c.push(ns.create(h.from,h.to,h.value))),h.next());return d.finishInner(this.nextLayer.isEmpty&&!c.length?At.empty:this.nextLayer.update({add:c,filter:l,filterFrom:n,filterTo:o}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],i=[],n=-1;for(let l=0;l<this.chunk.length;l++){let h=this.chunkPos[l],f=this.chunk[l],c=t.touchesRange(h,h+f.length);if(c===!1)n=Math.max(n,f.maxPoint),e.push(f),i.push(t.mapPos(h));else if(c===!0){let{mapped:d,pos:g}=f.map(h,t);d&&(n=Math.max(n,d.maxPoint),e.push(d),i.push(g))}}let o=this.nextLayer.map(t);return e.length==0?o:new At(i,e,o||At.empty,n)}between(t,e,i){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let o=this.chunkPos[n],l=this.chunk[n];if(e>=o&&t<=o+l.length&&l.between(o,t-o,e-o,i)===!1)return}this.nextLayer.between(t,e,i)}}iter(t=0){return rs.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return rs.from(t).goto(e)}static compare(t,e,i,n,o=-1){let l=t.filter(g=>g.maxPoint>0||!g.isEmpty&&g.maxPoint>=o),h=e.filter(g=>g.maxPoint>0||!g.isEmpty&&g.maxPoint>=o),f=pd(l,h,i),c=new $r(l,f,o),d=new $r(h,f,o);i.iterGaps((g,m,w)=>gd(c,g,d,m,w,n)),i.empty&&i.length==0&&gd(c,0,d,0,0,n)}static eq(t,e,i=0,n){n==null&&(n=999999999);let o=t.filter(d=>!d.isEmpty&&e.indexOf(d)<0),l=e.filter(d=>!d.isEmpty&&t.indexOf(d)<0);if(o.length!=l.length)return!1;if(!o.length)return!0;let h=pd(o,l),f=new $r(o,h,0).goto(i),c=new $r(l,h,0).goto(i);for(;;){if(f.to!=c.to||!mh(f.active,c.active)||f.point&&(!c.point||!f.point.eq(c.point)))return!1;if(f.to>n)return!0;f.next(),c.next()}}static spans(t,e,i,n,o=-1){let l=new $r(t,null,o).goto(e),h=e,f=l.openStart;for(;;){let c=Math.min(l.to,i);if(l.point){let d=l.activeForPoint(l.to),g=l.pointFrom<e?d.length+1:l.point.startSide<0?d.length:Math.min(d.length,f);n.point(h,c,l.point,d,g,l.pointRank),f=Math.min(l.openEnd(c),d.length)}else c>h&&(n.span(h,c,l.active,f),f=l.openEnd(c));if(l.to>i)return f+(l.point&&l.to>i?1:0);h=l.to,l.next()}}static of(t,e=!1){let i=new sr;for(let n of t instanceof ns?[t]:e?kS(t):t)i.add(n.from,n.to,n.value);return i.finish()}static join(t){if(!t.length)return At.empty;let e=t[t.length-1];for(let i=t.length-2;i>=0;i--)for(let n=t[i];n!=At.empty;n=n.nextLayer)e=new At(n.chunkPos,n.chunk,e,Math.max(n.maxPoint,e.maxPoint));return e}}At.empty=new At([],[],null,-1);function kS(r){if(r.length>1)for(let t=r[0],e=1;e<r.length;e++){let i=r[e];if(gh(t,i)>0)return r.slice().sort(gh);t=i}return r}At.empty.nextLayer=At.empty;class sr{finishChunk(t){this.chunks.push(new Zh(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(t,e,i){this.addInner(t,e,i)||(this.nextLayer||(this.nextLayer=new sr)).add(t,e,i)}addInner(t,e,i){let n=t-this.lastTo||i.startSide-this.last.endSide;if(n<=0&&(t-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return n<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=i,this.lastFrom=t,this.lastTo=e,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let i=e.value.length-1;return this.last=e.value[i],this.lastFrom=e.from[i]+t,this.lastTo=e.to[i]+t,!0}finish(){return this.finishInner(At.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return t;let e=At.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}}function pd(r,t,e){let i=new Map;for(let o of r)for(let l=0;l<o.chunk.length;l++)o.chunk[l].maxPoint<=0&&i.set(o.chunk[l],o.chunkPos[l]);let n=new Set;for(let o of t)for(let l=0;l<o.chunk.length;l++){let h=i.get(o.chunk[l]);h!=null&&(e?e.mapPos(h):h)==o.chunkPos[l]&&!e?.touchesRange(h,h+o.chunk[l].length)&&n.add(o.chunk[l])}return n}class dg{constructor(t,e,i,n=0){this.layer=t,this.skip=e,this.minPoint=i,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,i){for(;this.chunkIndex<this.layer.chunk.length;){let n=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(n)||this.layer.chunkEnd(this.chunkIndex)<t||n.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!i||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],i=t+e.from[this.rangeIndex];if(this.from=i,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class rs{constructor(t){this.heap=t}static from(t,e=null,i=-1){let n=[];for(let o=0;o<t.length;o++)for(let l=t[o];!l.isEmpty;l=l.nextLayer)l.maxPoint>=i&&n.push(new dg(l,e,i,o));return n.length==1?n[0]:new rs(n)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let i of this.heap)i.goto(t,e);for(let i=this.heap.length>>1;i>=0;i--)$a(this.heap,i);return this.next(),this}forward(t,e){for(let i of this.heap)i.forward(t,e);for(let i=this.heap.length>>1;i>=0;i--)$a(this.heap,i);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),$a(this.heap,0)}}}function $a(r,t){for(let e=r[t];;){let i=(t<<1)+1;if(i>=r.length)break;let n=r[i];if(i+1<r.length&&n.compare(r[i+1])>=0&&(n=r[i+1],i++),e.compare(n)<0)break;r[i]=e,r[t]=n,t=i}}class $r{constructor(t,e,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=rs.from(t,e,i)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){po(this.active,t),po(this.activeTo,t),po(this.activeRank,t),this.minActive=md(this.active,this.activeTo)}addActive(t){let e=0,{value:i,to:n,rank:o}=this.cursor;for(;e<this.activeRank.length&&(o-this.activeRank[e]||n-this.activeTo[e])>0;)e++;go(this.active,e,i),go(this.activeTo,e,n),go(this.activeRank,e,o),t&&go(t,e,this.cursor.from),this.minActive=md(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let n=this.minActive;if(n>-1&&(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)<0){if(this.activeTo[n]>t){this.to=this.activeTo[n],this.endSide=this.active[n].endSide;break}this.removeActive(n),i&&po(i,n)}else if(this.cursor.value)if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let o=this.cursor.value;if(!o.point)this.addActive(i),this.cursor.next();else if(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=o,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=o.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let n=i.length-1;n>=0&&i[n]<t;n--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>t||this.activeTo[i]==t&&this.active[i].endSide>=this.point.endSide)&&e.push(this.active[i]);return e.reverse()}openEnd(t){let e=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>t;i--)e++;return e}}function gd(r,t,e,i,n,o){r.goto(t),e.goto(i);let l=i+n,h=i,f=i-t;for(;;){let c=r.to+f-e.to,d=c||r.endSide-e.endSide,g=d<0?r.to+f:e.to,m=Math.min(g,l);if(r.point||e.point?r.point&&e.point&&(r.point==e.point||r.point.eq(e.point))&&mh(r.activeForPoint(r.to),e.activeForPoint(e.to))||o.comparePoint(h,m,r.point,e.point):m>h&&!mh(r.active,e.active)&&o.compareRange(h,m,r.active,e.active),g>l)break;(c||r.openEnd!=e.openEnd)&&o.boundChange&&o.boundChange(g),h=g,d<=0&&r.next(),d>=0&&e.next()}}function mh(r,t){if(r.length!=t.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!=t[e]&&!r[e].eq(t[e]))return!1;return!0}function po(r,t){for(let e=t,i=r.length-1;e<i;e++)r[e]=r[e+1];r.pop()}function go(r,t,e){for(let i=r.length-1;i>=t;i--)r[i+1]=r[i];r[t]=e}function md(r,t){let e=-1,i=1e9;for(let n=0;n<t.length;n++)(t[n]-i||r[n].endSide-r[e].endSide)<0&&(e=n,i=t[n]);return e}function pg(r,t,e=r.length){let i=0;for(let n=0;n<e&&n<r.length;)r.charCodeAt(n)==9?(i+=t-i%t,n++):(i++,n=vi(r,n));return i}function CS(r,t,e,i){for(let n=0,o=0;;){if(o>=t)return n;if(n==r.length)break;o+=r.charCodeAt(n)==9?e-o%e:1,n=vi(r,n)}return r.length}const yh="",yd=typeof Symbol>"u"?"__"+yh:Symbol.for(yh),wh=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),wd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class hn{constructor(t,e){this.rules=[];let{finish:i}=e||{};function n(l){return/^@/.test(l)?[l]:l.split(/,\s*/)}function o(l,h,f,c){let d=[],g=/^@(\w+)\b/.exec(l[0]),m=g&&g[1]=="keyframes";if(g&&h==null)return f.push(l[0]+";");for(let w in h){let b=h[w];if(/&/.test(w))o(w.split(/,\s*/).map(S=>l.map(C=>S.replace(/&/,C))).reduce((S,C)=>S.concat(C)),b,f);else if(b&&typeof b=="object"){if(!g)throw new RangeError("The value of a property ("+w+") should be a primitive value.");o(n(w),b,d,m)}else b!=null&&d.push(w.replace(/_.*/,"").replace(/[A-Z]/g,S=>"-"+S.toLowerCase())+": "+b+";")}(d.length||m)&&f.push((i&&!g&&!c?l.map(i):l).join(", ")+" {"+d.join(" ")+"}")}for(let l in t)o(n(l),t[l],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let t=wd[yd]||1;return wd[yd]=t+1,yh+t.toString(36)}static mount(t,e,i){let n=t[wh],o=i&&i.nonce;n?o&&n.setNonce(o):n=new AS(t,o),n.mount(Array.isArray(e)?e:[e],t)}}let vd=new Map;class AS{constructor(t,e){let i=t.ownerDocument||t,n=i.defaultView;if(!t.head&&t.adoptedStyleSheets&&n.CSSStyleSheet){let o=vd.get(i);if(o)return t[wh]=o;this.sheet=new n.CSSStyleSheet,vd.set(i,this)}else this.styleTag=i.createElement("style"),e&&this.styleTag.setAttribute("nonce",e);this.modules=[],t[wh]=this}mount(t,e){let i=this.sheet,n=0,o=0;for(let l=0;l<t.length;l++){let h=t[l],f=this.modules.indexOf(h);if(f<o&&f>-1&&(this.modules.splice(f,1),o--,f=-1),f==-1){if(this.modules.splice(o++,0,h),i)for(let c=0;c<h.rules.length;c++)i.insertRule(h.rules[c],n++)}else{for(;o<f;)n+=this.modules[o++].rules.length;n+=h.rules.length,o++}}if(i)e.adoptedStyleSheets.indexOf(this.sheet)<0&&(e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets]);else{let l="";for(let f=0;f<this.modules.length;f++)l+=this.modules[f].getRules()+`
`;this.styleTag.textContent=l;let h=e.head||e;this.styleTag.parentNode!=h&&h.insertBefore(this.styleTag,h.firstChild)}}setNonce(t){this.styleTag&&this.styleTag.getAttribute("nonce")!=t&&this.styleTag.setAttribute("nonce",t)}}var fn={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},ss={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},TS=typeof navigator<"u"&&/Mac/.test(navigator.platform),PS=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var jt=0;jt<10;jt++)fn[48+jt]=fn[96+jt]=String(jt);for(var jt=1;jt<=24;jt++)fn[jt+111]="F"+jt;for(var jt=65;jt<=90;jt++)fn[jt]=String.fromCharCode(jt+32),ss[jt]=String.fromCharCode(jt);for(var Wa in fn)ss.hasOwnProperty(Wa)||(ss[Wa]=fn[Wa]);function MS(r){var t=TS&&r.metaKey&&r.shiftKey&&!r.ctrlKey&&!r.altKey||PS&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",e=!t&&r.key||(r.shiftKey?ss:fn)[r.keyCode]||r.key||"Unidentified";return e=="Esc"&&(e="Escape"),e=="Del"&&(e="Delete"),e=="Left"&&(e="ArrowLeft"),e=="Up"&&(e="ArrowUp"),e=="Right"&&(e="ArrowRight"),e=="Down"&&(e="ArrowDown"),e}function os(r){let t;return r.nodeType==11?t=r.getSelection?r:r.ownerDocument:t=r,t.getSelection()}function vh(r,t){return t?r==t||r.contains(t.nodeType!=1?t.parentNode:t):!1}function No(r,t){if(!t.anchorNode)return!1;try{return vh(r,t.anchorNode)}catch{return!1}}function or(r){return r.nodeType==3?_n(r,0,r.nodeValue.length).getClientRects():r.nodeType==1?r.getClientRects():[]}function jr(r,t,e,i){return e?xd(r,t,e,i,-1)||xd(r,t,e,i,1):!1}function Rn(r){for(var t=0;;t++)if(r=r.previousSibling,!r)return t}function Qo(r){return r.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(r.nodeName)}function xd(r,t,e,i,n){for(;;){if(r==e&&t==i)return!0;if(t==(n<0?0:ki(r))){if(r.nodeName=="DIV")return!1;let o=r.parentNode;if(!o||o.nodeType!=1)return!1;t=Rn(r)+(n<0?0:1),r=o}else if(r.nodeType==1){if(r=r.childNodes[t+(n<0?-1:0)],r.nodeType==1&&r.contentEditable=="false")return!1;t=n<0?ki(r):0}else return!1}}function ki(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function ds(r,t){let e=t?r.left:r.right;return{left:e,right:e,top:r.top,bottom:r.bottom}}function RS(r){let t=r.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:r.innerWidth,top:0,bottom:r.innerHeight}}function gg(r,t){let e=t.width/r.offsetWidth,i=t.height/r.offsetHeight;return(e>.995&&e<1.005||!isFinite(e)||Math.abs(t.width-r.offsetWidth)<1)&&(e=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(t.height-r.offsetHeight)<1)&&(i=1),{scaleX:e,scaleY:i}}function _S(r,t,e,i,n,o,l,h){let f=r.ownerDocument,c=f.defaultView||window;for(let d=r,g=!1;d&&!g;)if(d.nodeType==1){let m,w=d==f.body,b=1,S=1;if(w)m=RS(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(d).position)&&(g=!0),d.scrollHeight<=d.clientHeight&&d.scrollWidth<=d.clientWidth){d=d.assignedSlot||d.parentNode;continue}let B=d.getBoundingClientRect();({scaleX:b,scaleY:S}=gg(d,B)),m={left:B.left,right:B.left+d.clientWidth*b,top:B.top,bottom:B.top+d.clientHeight*S}}let C=0,P=0;if(n=="nearest")t.top<m.top?(P=t.top-(m.top+l),e>0&&t.bottom>m.bottom+P&&(P=t.bottom-m.bottom+l)):t.bottom>m.bottom&&(P=t.bottom-m.bottom+l,e<0&&t.top-P<m.top&&(P=t.top-(m.top+l)));else{let B=t.bottom-t.top,L=m.bottom-m.top;P=(n=="center"&&B<=L?t.top+B/2-L/2:n=="start"||n=="center"&&e<0?t.top-l:t.bottom-L+l)-m.top}if(i=="nearest"?t.left<m.left?(C=t.left-(m.left+o),e>0&&t.right>m.right+C&&(C=t.right-m.right+o)):t.right>m.right&&(C=t.right-m.right+o,e<0&&t.left<m.left+C&&(C=t.left-(m.left+o))):C=(i=="center"?t.left+(t.right-t.left)/2-(m.right-m.left)/2:i=="start"==h?t.left-o:t.right-(m.right-m.left)+o)-m.left,C||P)if(w)c.scrollBy(C,P);else{let B=0,L=0;if(P){let _=d.scrollTop;d.scrollTop+=P/S,L=(d.scrollTop-_)*S}if(C){let _=d.scrollLeft;d.scrollLeft+=C/b,B=(d.scrollLeft-_)*b}t={left:t.left-B,top:t.top-L,right:t.right-B,bottom:t.bottom-L},B&&Math.abs(B-C)<1&&(i="nearest"),L&&Math.abs(L-P)<1&&(n="nearest")}if(w)break;(t.top<m.top||t.bottom>m.bottom||t.left<m.left||t.right>m.right)&&(t={left:Math.max(t.left,m.left),right:Math.min(t.right,m.right),top:Math.max(t.top,m.top),bottom:Math.min(t.bottom,m.bottom)}),d=d.assignedSlot||d.parentNode}else if(d.nodeType==11)d=d.host;else break}function ES(r){let t=r.ownerDocument,e,i;for(let n=r.parentNode;n&&!(n==t.body||e&&i);)if(n.nodeType==1)!i&&n.scrollHeight>n.clientHeight&&(i=n),!e&&n.scrollWidth>n.clientWidth&&(e=n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;return{x:e,y:i}}class DS{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:i}=t;this.set(e,Math.min(t.anchorOffset,e?ki(e):0),i,Math.min(t.focusOffset,i?ki(i):0))}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let Xn=null;function mg(r){if(r.setActive)return r.setActive();if(Xn)return r.focus(Xn);let t=[];for(let e=r;e&&(t.push(e,e.scrollTop,e.scrollLeft),e!=e.ownerDocument);e=e.parentNode);if(r.focus(Xn==null?{get preventScroll(){return Xn={preventScroll:!0},!0}}:void 0),!Xn){Xn=!1;for(let e=0;e<t.length;){let i=t[e++],n=t[e++],o=t[e++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=o&&(i.scrollLeft=o)}}}let bd;function _n(r,t,e=t){let i=bd||(bd=document.createRange());return i.setEnd(r,e),i.setStart(r,t),i}function jn(r,t,e,i){let n={key:t,code:t,keyCode:e,which:e,cancelable:!0};i&&({altKey:n.altKey,ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,metaKey:n.metaKey}=i);let o=new KeyboardEvent("keydown",n);o.synthetic=!0,r.dispatchEvent(o);let l=new KeyboardEvent("keyup",n);return l.synthetic=!0,r.dispatchEvent(l),o.defaultPrevented||l.defaultPrevented}function IS(r){for(;r;){if(r&&(r.nodeType==9||r.nodeType==11&&r.host))return r;r=r.assignedSlot||r.parentNode}return null}function yg(r){for(;r.attributes.length;)r.removeAttributeNode(r.attributes[0])}function BS(r,t){let e=t.focusNode,i=t.focusOffset;if(!e||t.anchorNode!=e||t.anchorOffset!=i)return!1;for(i=Math.min(i,ki(e));;)if(i){if(e.nodeType!=1)return!1;let n=e.childNodes[i-1];n.contentEditable=="false"?i--:(e=n,i=ki(e))}else{if(e==r)return!0;i=Rn(e),e=e.parentNode}}function wg(r){return r.scrollTop>Math.max(1,r.scrollHeight-r.clientHeight-4)}function vg(r,t){for(let e=r,i=t;;){if(e.nodeType==3&&i>0)return{node:e,offset:i};if(e.nodeType==1&&i>0){if(e.contentEditable=="false")return null;e=e.childNodes[i-1],i=ki(e)}else if(e.parentNode&&!Qo(e))i=Rn(e),e=e.parentNode;else return null}}function xg(r,t){for(let e=r,i=t;;){if(e.nodeType==3&&i<e.nodeValue.length)return{node:e,offset:i};if(e.nodeType==1&&i<e.childNodes.length){if(e.contentEditable=="false")return null;e=e.childNodes[i],i=0}else if(e.parentNode&&!Qo(e))i=Rn(e)+1,e=e.parentNode;else return null}}class ne{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new ne(t.parentNode,Rn(t),e)}static after(t,e){return new ne(t.parentNode,Rn(t)+1,e)}}const jh=[];class kt{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(this.flags&2){let i=this.dom,n=null,o;for(let l of this.children){if(l.flags&7){if(!l.dom&&(o=n?n.nextSibling:i.firstChild)){let h=kt.get(o);(!h||!h.parent&&h.canReuseDOM(l))&&l.reuseDOM(o)}l.sync(t,e),l.flags&=-8}if(o=n?n.nextSibling:i.firstChild,e&&!e.written&&e.node==i&&o!=l.dom&&(e.written=!0),l.dom.parentNode==i)for(;o&&o!=l.dom;)o=Od(o);else i.insertBefore(l.dom,o);n=l.dom}for(o=n?n.nextSibling:i.firstChild,o&&e&&e.node==i&&(e.written=!0);o;)o=Od(o)}else if(this.flags&1)for(let i of this.children)i.flags&7&&(i.sync(t,e),i.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=ki(t)==0?0:e==0?-1:1;for(;;){let o=t.parentNode;if(o==this.dom)break;n==0&&o.firstChild!=o.lastChild&&(t==o.firstChild?n=-1:n=1),t=o}n<0?i=t:i=t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!kt.get(i);)i=i.nextSibling;if(!i)return this.length;for(let n=0,o=0;;n++){let l=this.children[n];if(l.dom==i)return o;o+=l.length+l.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,o=-1,l=-1,h=-1;for(let f=0,c=i,d=i;f<this.children.length;f++){let g=this.children[f],m=c+g.length;if(c<t&&m>e)return g.domBoundsAround(t,e,c);if(m>=t&&n==-1&&(n=f,o=c),c>e&&g.dom.parentNode==this.dom){l=f,h=d;break}d=m,c=m+g.breakAfter}return{from:o,to:h<0?i+this.length:h,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:l<this.children.length&&l>=0?this.children[l].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),e.flags&1)return;e.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.flags&7&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=jh){this.markDirty();for(let n=t;n<e;n++){let o=this.children[n];o.parent==this&&i.indexOf(o)<0&&o.destroy()}i.length<250?this.children.splice(t,e-t,...i):this.children=[].concat(this.children.slice(0,t),i,this.children.slice(e));for(let n=0;n<i.length;n++)i[n].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new bg(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+(t=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,i,n,o,l){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!((this.flags|t.flags)&8)}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}kt.prototype.breakAfter=0;function Od(r){let t=r.nextSibling;return r.parentNode.removeChild(r),t}class bg{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function Og(r,t,e,i,n,o,l,h,f){let{children:c}=r,d=c.length?c[t]:null,g=o.length?o[o.length-1]:null,m=g?g.breakAfter:l;if(!(t==i&&d&&!l&&!m&&o.length<2&&d.merge(e,n,o.length?g:null,e==0,h,f))){if(i<c.length){let w=c[i];w&&(n<w.length||w.breakAfter&&g?.breakAfter)?(t==i&&(w=w.split(n),n=0),!m&&g&&w.merge(0,n,g,!0,0,f)?o[o.length-1]=w:((n||w.children.length&&!w.children[0].length)&&w.merge(0,n,null,!1,0,f),o.push(w))):w?.breakAfter&&(g?g.breakAfter=1:l=1),i++}for(d&&(d.breakAfter=l,e>0&&(!l&&o.length&&d.merge(e,d.length,o[0],!1,h,0)?d.breakAfter=o.shift().breakAfter:(e<d.length||d.children.length&&d.children[d.children.length-1].length==0)&&d.merge(e,d.length,null,!1,h,0),t++));t<i&&o.length;)if(c[i-1].become(o[o.length-1]))i--,o.pop(),f=o.length?0:h;else if(c[t].become(o[0]))t++,o.shift(),h=o.length?0:f;else break;!o.length&&t&&i<c.length&&!c[t-1].breakAfter&&c[i].merge(0,0,c[t-1],!1,h,f)&&t--,(t<i||o.length)&&r.replaceChildren(t,i,o)}}function Sg(r,t,e,i,n,o){let l=r.childCursor(),{i:h,off:f}=l.findPos(e,1),{i:c,off:d}=l.findPos(t,-1),g=t-e;for(let m of i)g+=m.length;r.length+=g,Og(r,c,d,h,f,i,0,n,o)}let me=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},xh=typeof document<"u"?document:{documentElement:{style:{}}};const bh=/Edge\/(\d+)/.exec(me.userAgent),kg=/MSIE \d/.test(me.userAgent),Oh=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(me.userAgent),ul=!!(kg||Oh||bh),Sd=!ul&&/gecko\/(\d+)/i.test(me.userAgent),Fa=!ul&&/Chrome\/(\d+)/.exec(me.userAgent),LS="webkitFontSmoothing"in xh.documentElement.style,Cg=!ul&&/Apple Computer/.test(me.vendor),kd=Cg&&(/Mobile\/\w+/.test(me.userAgent)||me.maxTouchPoints>2);var q={mac:kd||/Mac/.test(me.platform),windows:/Win/.test(me.platform),linux:/Linux|X11/.test(me.platform),ie:ul,ie_version:kg?xh.documentMode||6:Oh?+Oh[1]:bh?+bh[1]:0,gecko:Sd,gecko_version:Sd?+(/Firefox\/(\d+)/.exec(me.userAgent)||[0,0])[1]:0,chrome:!!Fa,chrome_version:Fa?+Fa[1]:0,ios:kd,android:/Android\b/.test(me.userAgent),safari:Cg,webkit_version:LS?+(/\bAppleWebKit\/(\d+)/.exec(me.userAgent)||[0,0])[1]:0,tabSize:xh.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const NS=256;class ri extends kt{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){t.nodeType==3&&this.createDOM(t)}merge(t,e,i){return this.flags&8||i&&(!(i instanceof ri)||this.length-(e-t)+i.length>NS||i.flags&8)?!1:(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),!0)}split(t){let e=new ri(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e.flags|=this.flags&8,e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new ne(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return $S(this.dom,t,e)}}class zi extends kt{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let n of e)n.setParent(this)}setAttrs(t){if(yg(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!((this.flags|t.flags)&8)}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,e){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,i,n,o,l){return i&&(!(i instanceof zi&&i.mark.eq(this.mark))||t&&o<=0||e<this.length&&l<=0)?!1:(Sg(this,t,e,i?i.children.slice():[],o-1,l-1),this.markDirty(),!0)}split(t){let e=[],i=0,n=-1,o=0;for(let h of this.children){let f=i+h.length;f>t&&e.push(i<t?h.split(t-i):h),n<0&&i>=t&&(n=o),i=f,o++}let l=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new zi(this.mark,e,l)}domAtPos(t){return Ag(this,t)}coordsAt(t,e){return Pg(this,t,e)}}function $S(r,t,e){let i=r.nodeValue.length;t>i&&(t=i);let n=t,o=t,l=0;t==0&&e<0||t==i&&e>=0?q.chrome||q.gecko||(t?(n--,l=1):o<i&&(o++,l=-1)):e<0?n--:o<i&&o++;let h=_n(r,n,o).getClientRects();if(!h.length)return null;let f=h[(l?l<0:e>=0)?0:h.length-1];return q.safari&&!l&&f.width==0&&(f=Array.prototype.find.call(h,c=>c.width)||f),l?ds(f,l<0):f||null}class on extends kt{static create(t,e,i){return new on(t,e,i)}constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}split(t){let e=on.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,e,i,n,o,l){return i&&(!(i instanceof on)||!this.widget.compare(i.widget)||t>0&&o<=0||e<this.length&&l<=0)?!1:(this.length=t+(i?i.length:0)+(this.length-e),!0)}become(t){return t instanceof on&&t.side==this.side&&this.widget.constructor==t.widget.constructor?(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(this.length==0)return pt.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):pt.empty}domAtPos(t){return(this.length?t==0:this.side>0)?ne.before(this.dom):ne.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.widget.coordsAt(this.dom,t,e);if(i)return i;let n=this.dom.getClientRects(),o=null;if(!n.length)return null;let l=this.side?this.side<0:t>0;for(let h=l?n.length-1:0;o=n[h],!(t>0?h==0:h==n.length-1||o.top<o.bottom);h+=l?-1:1);return ds(o,!l)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class lr extends kt{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof lr&&t.side==this.side}split(){return new lr(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?ne.before(this.dom):ne.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return pt.empty}get isHidden(){return!0}}ri.prototype.children=on.prototype.children=lr.prototype.children=jh;function Ag(r,t){let e=r.dom,{children:i}=r,n=0;for(let o=0;n<i.length;n++){let l=i[n],h=o+l.length;if(!(h==o&&l.getSide()<=0)){if(t>o&&t<h&&l.dom.parentNode==e)return l.domAtPos(t-o);if(t<=o)break;o=h}}for(let o=n;o>0;o--){let l=i[o-1];if(l.dom.parentNode==e)return l.domAtPos(l.length)}for(let o=n;o<i.length;o++){let l=i[o];if(l.dom.parentNode==e)return l.domAtPos(0)}return new ne(e,0)}function Tg(r,t,e){let i,{children:n}=r;e>0&&t instanceof zi&&n.length&&(i=n[n.length-1])instanceof zi&&i.mark.eq(t.mark)?Tg(i,t.children[0],e-1):(n.push(t),t.setParent(r)),r.length+=t.length}function Pg(r,t,e){let i=null,n=-1,o=null,l=-1;function h(c,d){for(let g=0,m=0;g<c.children.length&&m<=d;g++){let w=c.children[g],b=m+w.length;b>=d&&(w.children.length?h(w,d-m):(!o||o.isHidden&&(e>0||FS(o,w)))&&(b>d||m==b&&w.getSide()>0)?(o=w,l=d-m):(m<d||m==b&&w.getSide()<0&&!w.isHidden)&&(i=w,n=d-m)),m=b}}h(r,t);let f=(e<0?i:o)||i||o;return f?f.coordsAt(Math.max(0,f==i?n:l),e):WS(r)}function WS(r){let t=r.dom.lastChild;if(!t)return r.dom.getBoundingClientRect();let e=or(t);return e[e.length-1]||null}function FS(r,t){let e=r.coordsAt(0,1),i=t.coordsAt(0,1);return e&&i&&i.top<e.bottom}function Sh(r,t){for(let e in r)e=="class"&&t.class?t.class+=" "+r.class:e=="style"&&t.style?t.style+=";"+r.style:t[e]=r[e];return t}const Cd=Object.create(null);function Yo(r,t,e){if(r==t)return!0;r||(r=Cd),t||(t=Cd);let i=Object.keys(r),n=Object.keys(t);if(i.length-(e&&i.indexOf(e)>-1?1:0)!=n.length-(e&&n.indexOf(e)>-1?1:0))return!1;for(let o of i)if(o!=e&&(n.indexOf(o)==-1||r[o]!==t[o]))return!1;return!0}function kh(r,t,e){let i=!1;if(t)for(let n in t)e&&n in e||(i=!0,n=="style"?r.style.cssText="":r.removeAttribute(n));if(e)for(let n in e)t&&t[n]==e[n]||(i=!0,n=="style"?r.style.cssText=e[n]:r.setAttribute(n,e[n]));return i}function VS(r){let t=Object.create(null);for(let e=0;e<r.attributes.length;e++){let i=r.attributes[e];t[i.name]=i.value}return t}class ps{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,e,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var Si=function(r){return r[r.Text=0]="Text",r[r.WidgetBefore=1]="WidgetBefore",r[r.WidgetAfter=2]="WidgetAfter",r[r.WidgetRange=3]="WidgetRange",r}(Si||(Si={}));class yt extends Mn{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new gs(t)}static widget(t){let e=Math.max(-1e4,Math.min(1e4,t.side||0)),i=!!t.block;return e+=i&&!t.inlineOrder?e>0?3e8:-4e8:e>0?1e8:-1e8,new un(t,e,e,i,t.widget||null,!1)}static replace(t){let e=!!t.block,i,n;if(t.isBlockGap)i=-5e8,n=4e8;else{let{start:o,end:l}=Mg(t,e);i=(o?e?-3e8:-1:5e8)-1,n=(l?e?2e8:1:-6e8)+1}return new un(t,i,n,e,t.widget||null,!0)}static line(t){return new ms(t)}static set(t,e=!1){return At.of(t,e)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}yt.none=At.empty;class gs extends yt{constructor(t){let{start:e,end:i}=Mg(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var e,i;return this==t||t instanceof gs&&this.tagName==t.tagName&&(this.class||((e=this.attrs)===null||e===void 0?void 0:e.class))==(t.class||((i=t.attrs)===null||i===void 0?void 0:i.class))&&Yo(this.attrs,t.attrs,"class")}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}gs.prototype.point=!1;class ms extends yt{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof ms&&this.spec.class==t.spec.class&&Yo(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}ms.prototype.mapMode=le.TrackBefore;ms.prototype.point=!0;class un extends yt{constructor(t,e,i,n,o,l){super(e,i,o,t),this.block=n,this.isReplace=l,this.mapMode=n?e<=0?le.TrackBefore:le.TrackAfter:le.TrackDel}get type(){return this.startSide!=this.endSide?Si.WidgetRange:this.startSide<=0?Si.WidgetBefore:Si.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof un&&HS(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}un.prototype.point=!0;function Mg(r,t=!1){let{inclusiveStart:e,inclusiveEnd:i}=r;return e==null&&(e=r.inclusive),i==null&&(i=r.inclusive),{start:e??t,end:i??t}}function HS(r,t){return r==t||!!(r&&t&&r.compare(t))}function $o(r,t,e,i=0){let n=e.length-1;n>=0&&e[n]+i>=r?e[n]=Math.max(e[n],t):e.push(r,t)}class Vt extends kt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,o,l){if(i){if(!(i instanceof Vt))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),Sg(this,t,e,i?i.children.slice():[],o,l),!0}split(t){let e=new Vt;if(e.breakAfter=this.breakAfter,this.length==0)return e;let{i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let o=i;o<this.children.length;o++)e.append(this.children[o],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){Yo(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){Tg(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=Sh(e,this.attrs||{})),i&&(this.attrs=Sh({class:i},this.attrs||{}))}domAtPos(t){return Ag(this,t)}reuseDOM(t){t.nodeName=="DIV"&&(this.setDOM(t),this.flags|=6)}sync(t,e){var i;this.dom?this.flags&4&&(yg(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(kh(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let n=this.dom.lastChild;for(;n&&kt.get(n)instanceof zi;)n=n.lastChild;if(!n||!this.length||n.nodeName!="BR"&&((i=kt.get(n))===null||i===void 0?void 0:i.isEditable)==!1&&(!q.ios||!this.children.some(o=>o instanceof ri))){let o=document.createElement("BR");o.cmIgnore=!0,this.dom.appendChild(o)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let t=0,e;for(let i of this.children){if(!(i instanceof ri)||/[^ -~]/.test(i.text))return null;let n=or(i.dom);if(n.length!=1)return null;t+=n[0].width,e=n[0].height}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length,textHeight:e}:null}coordsAt(t,e){let i=Pg(this,t,e);if(!this.children.length&&i&&this.parent){let{heightOracle:n}=this.parent.view.viewState,o=i.bottom-i.top;if(Math.abs(o-n.lineHeight)<2&&n.textHeight<o){let l=(o-n.textHeight)/2;return{top:i.top+l,bottom:i.bottom-l,left:i.left,right:i.left}}}return i}become(t){return t instanceof Vt&&this.children.length==0&&t.children.length==0&&Yo(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let o=t.children[i],l=n+o.length;if(l>=e){if(o instanceof Vt)return o;if(l>e)break}n=l+o.breakAfter}return null}}class Hi extends kt{constructor(t,e,i){super(),this.widget=t,this.length=e,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,o,l){return i&&(!(i instanceof Hi)||!this.widget.compare(i.widget)||t>0&&o<=0||e<this.length&&l<=0)?!1:(this.length=t+(i?i.length:0)+(this.length-e),!0)}domAtPos(t){return t==0?ne.before(this.dom):ne.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new Hi(this.widget,e,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return jh}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):pt.empty}domBoundsAround(){return null}become(t){return t instanceof Hi&&t.widget.constructor==this.widget.constructor?(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){let i=this.widget.coordsAt(this.dom,t,e);return i||(this.widget instanceof Ch?null:ds(this.dom.getBoundingClientRect(),this.length?t==0:e<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:e,endSide:i}=this.deco;return e==i?!1:t<0?e<0:i>0}}class Ch extends ps{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class Jr{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof Hi&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Vt),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(mo(new lr(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(t&&this.content.length&&this.content[this.content.length-1]instanceof Hi)&&this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:o,lineBreak:l,done:h}=this.cursor.next(this.skip);if(this.skip=0,h)throw new Error("Ran out of text content when drawing inline views");if(l){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}else this.text=o,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-i)),this.getLine().append(mo(new ri(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,o,l){if(this.disallowBlockEffectsFor[l]&&i instanceof un){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let h=e-t;if(i instanceof un)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Hi(i.widget||ar.block,h,i));else{let f=on.create(i.widget||ar.inline,h,h?0:i.startSide),c=this.atCursorPos&&!f.isEditable&&o<=n.length&&(t<e||i.startSide>0),d=!f.isEditable&&(t<e||o>n.length||i.startSide<=0),g=this.getLine();this.pendingBuffer==2&&!c&&!f.isEditable&&(this.pendingBuffer=0),this.flushBuffer(n),c&&(g.append(mo(new lr(1),n),o),o=n.length+Math.max(0,o-n.length)),g.append(mo(f,n),o),this.atCursorPos=d,this.pendingBuffer=d?t<e||o>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);h&&(this.textOff+h<=this.text.length?this.textOff+=h:(this.skip+=h-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=o)}static build(t,e,i,n,o){let l=new Jr(t,e,i,o);return l.openEnd=At.spans(n,e,i,l),l.openStart<0&&(l.openStart=l.openEnd),l.finish(l.openEnd),l}}function mo(r,t){for(let e of t)r=new zi(e,[r],r.length);return r}class ar extends ps{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}ar.inline=new ar("span");ar.block=new ar("div");var Ht=function(r){return r[r.LTR=0]="LTR",r[r.RTL=1]="RTL",r}(Ht||(Ht={}));const En=Ht.LTR,Jh=Ht.RTL;function Rg(r){let t=[];for(let e=0;e<r.length;e++)t.push(1<<+r[e]);return t}const zS=Rg("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),qS=Rg("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Ah=Object.create(null),ui=[];for(let r of["()","[]","{}"]){let t=r.charCodeAt(0),e=r.charCodeAt(1);Ah[t]=e,Ah[e]=-t}function _g(r){return r<=247?zS[r]:1424<=r&&r<=1524?2:1536<=r&&r<=1785?qS[r-1536]:1774<=r&&r<=2220?4:8192<=r&&r<=8204?256:64336<=r&&r<=65023?4:1}const US=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class ln{get dir(){return this.level%2?Jh:En}constructor(t,e,i){this.from=t,this.to=e,this.level=i}side(t,e){return this.dir==e==t?this.to:this.from}forward(t,e){return t==(this.dir==e)}static find(t,e,i,n){let o=-1;for(let l=0;l<t.length;l++){let h=t[l];if(h.from<=e&&h.to>=e){if(h.level==i)return l;(o<0||(n!=0?n<0?h.from<e:h.to>e:t[o].level>h.level))&&(o=l)}}if(o<0)throw new RangeError("Index out of range");return o}}function Eg(r,t){if(r.length!=t.length)return!1;for(let e=0;e<r.length;e++){let i=r[e],n=t[e];if(i.from!=n.from||i.to!=n.to||i.direction!=n.direction||!Eg(i.inner,n.inner))return!1}return!0}const St=[];function QS(r,t,e,i,n){for(let o=0;o<=i.length;o++){let l=o?i[o-1].to:t,h=o<i.length?i[o].from:e,f=o?256:n;for(let c=l,d=f,g=f;c<h;c++){let m=_g(r.charCodeAt(c));m==512?m=d:m==8&&g==4&&(m=16),St[c]=m==4?2:m,m&7&&(g=m),d=m}for(let c=l,d=f,g=f;c<h;c++){let m=St[c];if(m==128)c<h-1&&d==St[c+1]&&d&24?m=St[c]=d:St[c]=256;else if(m==64){let w=c+1;for(;w<h&&St[w]==64;)w++;let b=c&&d==8||w<e&&St[w]==8?g==1?1:8:256;for(let S=c;S<w;S++)St[S]=b;c=w-1}else m==8&&g==1&&(St[c]=1);d=m,m&7&&(g=m)}}}function YS(r,t,e,i,n){let o=n==1?2:1;for(let l=0,h=0,f=0;l<=i.length;l++){let c=l?i[l-1].to:t,d=l<i.length?i[l].from:e;for(let g=c,m,w,b;g<d;g++)if(w=Ah[m=r.charCodeAt(g)])if(w<0){for(let S=h-3;S>=0;S-=3)if(ui[S+1]==-w){let C=ui[S+2],P=C&2?n:C&4?C&1?o:n:0;P&&(St[g]=St[ui[S]]=P),h=S;break}}else{if(ui.length==189)break;ui[h++]=g,ui[h++]=m,ui[h++]=f}else if((b=St[g])==2||b==1){let S=b==n;f=S?0:1;for(let C=h-3;C>=0;C-=3){let P=ui[C+2];if(P&2)break;if(S)ui[C+2]|=2;else{if(P&4)break;ui[C+2]|=4}}}}}function XS(r,t,e,i){for(let n=0,o=i;n<=e.length;n++){let l=n?e[n-1].to:r,h=n<e.length?e[n].from:t;for(let f=l;f<h;){let c=St[f];if(c==256){let d=f+1;for(;;)if(d==h){if(n==e.length)break;d=e[n++].to,h=n<e.length?e[n].from:t}else if(St[d]==256)d++;else break;let g=o==1,m=(d<t?St[d]:i)==1,w=g==m?g?1:2:i;for(let b=d,S=n,C=S?e[S-1].to:r;b>f;)b==C&&(b=e[--S].from,C=S?e[S-1].to:r),St[--b]=w;f=d}else o=c,f++}}}function Th(r,t,e,i,n,o,l){let h=i%2?2:1;if(i%2==n%2)for(let f=t,c=0;f<e;){let d=!0,g=!1;if(c==o.length||f<o[c].from){let S=St[f];S!=h&&(d=!1,g=S==16)}let m=!d&&h==1?[]:null,w=d?i:i+1,b=f;t:for(;;)if(c<o.length&&b==o[c].from){if(g)break t;let S=o[c];if(!d)for(let C=S.to,P=c+1;;){if(C==e)break t;if(P<o.length&&o[P].from==C)C=o[P++].to;else{if(St[C]==h)break t;break}}if(c++,m)m.push(S);else{S.from>f&&l.push(new ln(f,S.from,w));let C=S.direction==En!=!(w%2);Ph(r,C?i+1:i,n,S.inner,S.from,S.to,l),f=S.to}b=S.to}else{if(b==e||(d?St[b]!=h:St[b]==h))break;b++}m?Th(r,f,b,i+1,n,m,l):f<b&&l.push(new ln(f,b,w)),f=b}else for(let f=e,c=o.length;f>t;){let d=!0,g=!1;if(!c||f>o[c-1].to){let S=St[f-1];S!=h&&(d=!1,g=S==16)}let m=!d&&h==1?[]:null,w=d?i:i+1,b=f;t:for(;;)if(c&&b==o[c-1].to){if(g)break t;let S=o[--c];if(!d)for(let C=S.from,P=c;;){if(C==t)break t;if(P&&o[P-1].to==C)C=o[--P].from;else{if(St[C-1]==h)break t;break}}if(m)m.push(S);else{S.to<f&&l.push(new ln(S.to,f,w));let C=S.direction==En!=!(w%2);Ph(r,C?i+1:i,n,S.inner,S.from,S.to,l),f=S.from}b=S.from}else{if(b==t||(d?St[b-1]!=h:St[b-1]==h))break;b--}m?Th(r,b,f,i+1,n,m,l):b<f&&l.push(new ln(b,f,w)),f=b}}function Ph(r,t,e,i,n,o,l){let h=t%2?2:1;QS(r,n,o,i,h),YS(r,n,o,i,h),XS(n,o,i,h),Th(r,n,o,t,e,i,l)}function KS(r,t,e){if(!r)return[new ln(0,0,t==Jh?1:0)];if(t==En&&!e.length&&!US.test(r))return Dg(r.length);if(e.length)for(;r.length>St.length;)St[St.length]=256;let i=[],n=t==En?0:1;return Ph(r,n,n,e,0,r.length,i),i}function Dg(r){return[new ln(0,r,0)]}let Ig="";function GS(r,t,e,i,n){var o;let l=i.head-r.from,h=ln.find(t,l,(o=i.bidiLevel)!==null&&o!==void 0?o:-1,i.assoc),f=t[h],c=f.side(n,e);if(l==c){let m=h+=n?1:-1;if(m<0||m>=t.length)return null;f=t[h=m],l=f.side(!n,e),c=f.side(n,e)}let d=vi(r.text,l,f.forward(n,e));(d<f.from||d>f.to)&&(d=c),Ig=r.text.slice(Math.min(l,d),Math.max(l,d));let g=h==(n?t.length-1:0)?null:t[h+(n?1:-1)];return g&&d==c&&g.level+(n?0:1)<f.level?z.cursor(g.side(!n,e)+r.from,g.forward(n,e)?1:-1,g.level):z.cursor(d+r.from,f.forward(n,e)?-1:1,f.level)}function ZS(r,t,e){for(let i=t;i<e;i++){let n=_g(r.charCodeAt(i));if(n==1)return En;if(n==2||n==4)return Jh}return En}const Bg=Y.define(),Lg=Y.define(),Ng=Y.define(),$g=Y.define(),Mh=Y.define(),Wg=Y.define(),Fg=Y.define(),tf=Y.define(),ef=Y.define(),Vg=Y.define({combine:r=>r.some(t=>t)}),jS=Y.define({combine:r=>r.some(t=>t)}),Hg=Y.define();class Jn{constructor(t,e="nearest",i="nearest",n=5,o=5,l=!1){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=o,this.isSnapshot=l}map(t){return t.empty?this:new Jn(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new Jn(z.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const yo=ct.define({map:(r,t)=>r.map(t)}),zg=ct.define();function ae(r,t,e){let i=r.facet($g);i.length?i[0](t):window.onerror?window.onerror(String(t),e,void 0,void 0,t):e?console.error(e+":",t):console.error(t)}const Fi=Y.define({combine:r=>r.length?r[0]:!0});let JS=0;const Hr=Y.define();class _e{constructor(t,e,i,n,o){this.id=t,this.create=e,this.domEventHandlers=i,this.domEventObservers=n,this.extension=o(this)}static define(t,e){const{eventHandlers:i,eventObservers:n,provide:o,decorations:l}=e||{};return new _e(JS++,t,i,n,h=>{let f=[Hr.of(h)];return l&&f.push(ls.of(c=>{let d=c.plugin(h);return d?l(d):yt.none})),o&&f.push(o(h)),f})}static fromClass(t,e){return _e.define(i=>new t(i),e)}}class Va{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let e=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(e)}catch(i){if(ae(e.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){ae(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(!((e=this.value)===null||e===void 0)&&e.destroy)try{this.value.destroy()}catch(i){ae(t.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const qg=Y.define(),nf=Y.define(),ls=Y.define(),Ug=Y.define(),rf=Y.define(),Qg=Y.define();function Ad(r,t){let e=r.state.facet(Qg);if(!e.length)return e;let i=e.map(o=>o instanceof Function?o(r):o),n=[];return At.spans(i,t.from,t.to,{point(){},span(o,l,h,f){let c=o-t.from,d=l-t.from,g=n;for(let m=h.length-1;m>=0;m--,f--){let w=h[m].spec.bidiIsolate,b;if(w==null&&(w=ZS(t.text,c,d)),f>0&&g.length&&(b=g[g.length-1]).to==c&&b.direction==w)b.to=d,g=b.inner;else{let S={from:c,to:d,direction:w,inner:[]};g.push(S),g=S.inner}}}}),n}const Yg=Y.define();function sf(r){let t=0,e=0,i=0,n=0;for(let o of r.state.facet(Yg)){let l=o(r);l&&(l.left!=null&&(t=Math.max(t,l.left)),l.right!=null&&(e=Math.max(e,l.right)),l.top!=null&&(i=Math.max(i,l.top)),l.bottom!=null&&(n=Math.max(n,l.bottom)))}return{left:t,right:e,top:i,bottom:n}}const zr=Y.define();class Ye{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new Ye(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(e.length==0)return t;let i=[];for(let n=0,o=0,l=0,h=0;;n++){let f=n==t.length?null:t[n],c=l-h,d=f?f.fromB:1e9;for(;o<e.length&&e[o]<d;){let g=e[o],m=e[o+1],w=Math.max(h,g),b=Math.min(d,m);if(w<=b&&new Ye(w+c,b+c,w,b).addToSet(i),m>d)break;o+=2}if(!f)return i;new Ye(f.fromA,f.toA,f.fromB,f.toB).addToSet(i),l=f.toA,h=f.toB}}}class Xo{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=Ut.empty(this.startState.doc.length);for(let o of i)this.changes=this.changes.compose(o.changes);let n=[];this.changes.iterChangedRanges((o,l,h,f)=>n.push(new Ye(o,l,h,f))),this.changedRanges=n}static create(t,e,i){return new Xo(t,e,i)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(t=>t.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class Td extends kt{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=yt.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new Vt],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Ye(0,0,0,t.state.doc.length)],0,null)}update(t){var e;let i=t.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:c,toA:d})=>d<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let n=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((e=this.domChanged)===null||e===void 0)&&e.newSel?n=this.domChanged.newSel.head:!ok(t.changes,this.hasComposition)&&!t.selectionSet&&(n=t.state.selection.main.head));let o=n>-1?ek(this.view,t.changes,n):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:d}=this.hasComposition;i=new Ye(c,d,t.changes.mapPos(c,-1),t.changes.mapPos(d,1)).addToSet(i.slice())}this.hasComposition=o?{from:o.range.fromB,to:o.range.toB}:null,(q.ie||q.chrome)&&!o&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let l=this.decorations,h=this.updateDeco(),f=rk(l,h,t.changes);return i=Ye.extendWithRanges(i,f),!(this.flags&7)&&i.length==0?!1:(this.updateInner(i,t.startState.doc.length,o),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e,i);let{observer:n}=this.view;n.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let l=q.chrome||q.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,l),this.flags&=-8,l&&(l.written||n.selectionRange.focusNode!=l.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(l=>l.flags&=-9);let o=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let l of this.children)l instanceof Hi&&l.widget instanceof Ch&&o.push(l.dom);n.updateGaps(o)}updateChildren(t,e,i){let n=i?i.range.addToSet(t.slice()):t,o=this.childCursor(e);for(let l=n.length-1;;l--){let h=l>=0?n[l]:null;if(!h)break;let{fromA:f,toA:c,fromB:d,toB:g}=h,m,w,b,S;if(i&&i.range.fromB<g&&i.range.toB>d){let _=Jr.build(this.view.state.doc,d,i.range.fromB,this.decorations,this.dynamicDecorationMap),$=Jr.build(this.view.state.doc,i.range.toB,g,this.decorations,this.dynamicDecorationMap);w=_.breakAtStart,b=_.openStart,S=$.openEnd;let W=this.compositionView(i);$.breakAtStart?W.breakAfter=1:$.content.length&&W.merge(W.length,W.length,$.content[0],!1,$.openStart,0)&&(W.breakAfter=$.content[0].breakAfter,$.content.shift()),_.content.length&&W.merge(0,0,_.content[_.content.length-1],!0,0,_.openEnd)&&_.content.pop(),m=_.content.concat(W).concat($.content)}else({content:m,breakAtStart:w,openStart:b,openEnd:S}=Jr.build(this.view.state.doc,d,g,this.decorations,this.dynamicDecorationMap));let{i:C,off:P}=o.findPos(c,1),{i:B,off:L}=o.findPos(f,-1);Og(this,B,L,C,P,m,w,b,S)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let e of t.transactions)for(let i of e.effects)i.is(zg)&&(this.editContextFormatting=i.value)}compositionView(t){let e=new ri(t.text.nodeValue);e.flags|=8;for(let{deco:n}of t.marks)e=new zi(n,[e],e.length);let i=new Vt;return i.append(e,0),i}fixCompositionDOM(t){let e=(o,l)=>{l.flags|=8|(l.children.some(f=>f.flags&7)?1:0),this.markedForComposition.add(l);let h=kt.get(o);h&&h!=l&&(h.dom=null),l.setDOM(o)},i=this.childPos(t.range.fromB,1),n=this.children[i.i];e(t.line,n);for(let o=t.marks.length-1;o>=-1;o--)i=n.childPos(i.off,1),n=n.children[i.i],e(o>=0?t.marks[o].node:t.text,n)}updateSelection(t=!1,e=!1){(t||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let i=this.view.root.activeElement,n=i==this.dom,o=!n&&!(this.view.state.facet(Fi)||this.dom.tabIndex>-1)&&No(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(n||e||o))return;let l=this.forceSelection;this.forceSelection=!1;let h=this.view.state.selection.main,f=this.moveToLine(this.domAtPos(h.anchor)),c=h.empty?f:this.moveToLine(this.domAtPos(h.head));if(q.gecko&&h.empty&&!this.hasComposition&&tk(f)){let g=document.createTextNode("");this.view.observer.ignore(()=>f.node.insertBefore(g,f.node.childNodes[f.offset]||null)),f=c=new ne(g,0),l=!0}let d=this.view.observer.selectionRange;(l||!d.focusNode||(!jr(f.node,f.offset,d.anchorNode,d.anchorOffset)||!jr(c.node,c.offset,d.focusNode,d.focusOffset))&&!this.suppressWidgetCursorChange(d,h))&&(this.view.observer.ignore(()=>{q.android&&q.chrome&&this.dom.contains(d.focusNode)&&sk(d.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let g=os(this.view.root);if(g)if(h.empty){if(q.gecko){let m=ik(f.node,f.offset);if(m&&m!=3){let w=(m==1?vg:xg)(f.node,f.offset);w&&(f=new ne(w.node,w.offset))}}g.collapse(f.node,f.offset),h.bidiLevel!=null&&g.caretBidiLevel!==void 0&&(g.caretBidiLevel=h.bidiLevel)}else if(g.extend){g.collapse(f.node,f.offset);try{g.extend(c.node,c.offset)}catch{}}else{let m=document.createRange();h.anchor>h.head&&([f,c]=[c,f]),m.setEnd(c.node,c.offset),m.setStart(f.node,f.offset),g.removeAllRanges(),g.addRange(m)}o&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(f,c)),this.impreciseAnchor=f.precise?null:new ne(d.anchorNode,d.anchorOffset),this.impreciseHead=c.precise?null:new ne(d.focusNode,d.focusOffset)}suppressWidgetCursorChange(t,e){return this.hasComposition&&e.empty&&jr(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==e.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,e=t.state.selection.main,i=os(t.root),{anchorNode:n,anchorOffset:o}=t.observer.selectionRange;if(!i||!e.empty||!e.assoc||!i.modify)return;let l=Vt.find(this,e.head);if(!l)return;let h=l.posAtStart;if(e.head==h||e.head==h+l.length)return;let f=this.coordsAt(e.head,-1),c=this.coordsAt(e.head,1);if(!f||!c||f.bottom>c.top)return;let d=this.domAtPos(e.head+e.assoc);i.collapse(d.node,d.offset),i.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let g=t.observer.selectionRange;t.docView.posFromDOM(g.anchorNode,g.anchorOffset)!=e.from&&i.collapse(n,o)}moveToLine(t){let e=this.dom,i;if(t.node!=e)return t;for(let n=t.offset;!i&&n<e.childNodes.length;n++){let o=kt.get(e.childNodes[n]);o instanceof Vt&&(i=o.domAtPos(0))}for(let n=t.offset-1;!i&&n>=0;n--){let o=kt.get(e.childNodes[n]);o instanceof Vt&&(i=o.domAtPos(o.length))}return i?new ne(i.node,i.offset,!0):t}nearest(t){for(let e=t;e;){let i=kt.get(e);if(i&&i.rootView==this)return i;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let n=this.children[e];if(i<n.length||n instanceof Vt)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){let i=null,n=0;for(let o=this.length,l=this.children.length-1;l>=0;l--){let h=this.children[l],f=o-h.breakAfter,c=f-h.length;if(f<t)break;if(c<=t&&(c<t||h.covers(-1))&&(f>t||h.covers(1))&&(!i||h instanceof Vt&&!(i instanceof Vt&&e>=0)))i=h,n=c;else if(i&&c==t&&f==t&&h instanceof Hi&&Math.abs(e)<2){if(h.deco.startSide<0)break;l&&(i=null)}o=c}return i?i.coordsAt(t-n,e):null}coordsForChar(t){let{i:e,off:i}=this.childPos(t,1),n=this.children[e];if(!(n instanceof Vt))return null;for(;n.children.length;){let{i:h,off:f}=n.childPos(i,1);for(;;h++){if(h==n.children.length)return null;if((n=n.children[h]).length)break}i=f}if(!(n instanceof ri))return null;let o=vi(n.text,i);if(o==i)return null;let l=_n(n.dom,i,o).getClientRects();for(let h=0;h<l.length;h++){let f=l[h];if(h==l.length-1||f.top<f.bottom&&f.left<f.right)return f}return null}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,o=this.view.contentDOM.clientWidth,l=o>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,h=-1,f=this.view.textDirection==Ht.LTR;for(let c=0,d=0;d<this.children.length;d++){let g=this.children[d],m=c+g.length;if(m>n)break;if(c>=i){let w=g.dom.getBoundingClientRect();if(e.push(w.height),l){let b=g.dom.lastChild,S=b?or(b):[];if(S.length){let C=S[S.length-1],P=f?C.right-w.left:w.right-C.left;P>h&&(h=P,this.minWidth=o,this.minWidthFrom=c,this.minWidthTo=m)}}}c=m+g.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return getComputedStyle(this.children[e].dom).direction=="rtl"?Ht.RTL:Ht.LTR}measureTextSize(){for(let o of this.children)if(o instanceof Vt){let l=o.measureTextSize();if(l)return l}let t=document.createElement("div"),e,i,n;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(t);let o=or(t.firstChild)[0];e=t.getBoundingClientRect().height,i=o?o.width/27:7,n=o?o.height:e,t.remove()}),{lineHeight:e,charWidth:i,textHeight:n}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new bg(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let o=n==e.viewports.length?null:e.viewports[n],l=o?o.from-1:this.length;if(l>i){let h=(e.lineBlockAt(l).bottom-e.lineBlockAt(i).top)/this.view.scaleY;t.push(yt.replace({widget:new Ch(h),block:!0,inclusive:!0,isBlockGap:!0}).range(i,l))}if(!o)break;i=o.to+1}return yt.set(t)}updateDeco(){let t=1,e=this.view.state.facet(ls).map(o=>(this.dynamicDecorationMap[t++]=typeof o=="function")?o(this.view):o),i=!1,n=this.view.state.facet(Ug).map((o,l)=>{let h=typeof o=="function";return h&&(i=!0),h?o(this.view):o});for(n.length&&(this.dynamicDecorationMap[t++]=i,e.push(At.join(n))),this.decorations=[this.editContextFormatting,...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let c=this.view.viewState.lineBlockAt(t.range.head);this.view.scrollDOM.scrollTop=c.top-t.yMargin,this.view.scrollDOM.scrollLeft=t.xMargin;return}for(let c of this.view.state.facet(Hg))try{if(c(this.view,t.range,t))return!0}catch(d){ae(this.view.state,d,"scroll handler")}let{range:e}=t,i=this.coordsAt(e.head,e.empty?e.assoc:e.head>e.anchor?-1:1),n;if(!i)return;!e.empty&&(n=this.coordsAt(e.anchor,e.anchor>e.head?-1:1))&&(i={left:Math.min(i.left,n.left),top:Math.min(i.top,n.top),right:Math.max(i.right,n.right),bottom:Math.max(i.bottom,n.bottom)});let o=sf(this.view),l={left:i.left-o.left,top:i.top-o.top,right:i.right+o.right,bottom:i.bottom+o.bottom},{offsetWidth:h,offsetHeight:f}=this.view.scrollDOM;_S(this.view.scrollDOM,l,e.head<e.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,h),-h),Math.max(Math.min(t.yMargin,f),-f),this.view.textDirection==Ht.LTR)}}function tk(r){return r.node.nodeType==1&&r.node.firstChild&&(r.offset==0||r.node.childNodes[r.offset-1].contentEditable=="false")&&(r.offset==r.node.childNodes.length||r.node.childNodes[r.offset].contentEditable=="false")}function Xg(r,t){let e=r.observer.selectionRange;if(!e.focusNode)return null;let i=vg(e.focusNode,e.focusOffset),n=xg(e.focusNode,e.focusOffset),o=i||n;if(n&&i&&n.node!=i.node){let h=kt.get(n.node);if(!h||h instanceof ri&&h.text!=n.node.nodeValue)o=n;else if(r.docView.lastCompositionAfterCursor){let f=kt.get(i.node);!f||f instanceof ri&&f.text!=i.node.nodeValue||(o=n)}}if(r.docView.lastCompositionAfterCursor=o!=i,!o)return null;let l=t-o.offset;return{from:l,to:l+o.node.nodeValue.length,node:o.node}}function ek(r,t,e){let i=Xg(r,e);if(!i)return null;let{node:n,from:o,to:l}=i,h=n.nodeValue;if(/[\n\r]/.test(h)||r.state.doc.sliceString(i.from,i.to)!=h)return null;let f=t.invertedDesc,c=new Ye(f.mapPos(o),f.mapPos(l),o,l),d=[];for(let g=n.parentNode;;g=g.parentNode){let m=kt.get(g);if(m instanceof zi)d.push({node:g,deco:m.mark});else{if(m instanceof Vt||g.nodeName=="DIV"&&g.parentNode==r.contentDOM)return{range:c,text:n,marks:d,line:g};if(g!=r.contentDOM)d.push({node:g,deco:new gs({inclusive:!0,attributes:VS(g),tagName:g.tagName.toLowerCase()})});else return null}}}function ik(r,t){return r.nodeType!=1?0:(t&&r.childNodes[t-1].contentEditable=="false"?1:0)|(t<r.childNodes.length&&r.childNodes[t].contentEditable=="false"?2:0)}let nk=class{constructor(){this.changes=[]}compareRange(t,e){$o(t,e,this.changes)}comparePoint(t,e){$o(t,e,this.changes)}boundChange(t){$o(t,t,this.changes)}};function rk(r,t,e){let i=new nk;return At.compare(r,t,e,i),i.changes}function sk(r,t){for(let e=r;e&&e!=t;e=e.assignedSlot||e.parentNode)if(e.nodeType==1&&e.contentEditable=="false")return!0;return!1}function ok(r,t){let e=!1;return t&&r.iterChangedRanges((i,n)=>{i<t.to&&n>t.from&&(e=!0)}),e}function lk(r,t,e=1){let i=r.charCategorizer(t),n=r.doc.lineAt(t),o=t-n.from;if(n.length==0)return z.cursor(t);o==0?e=1:o==n.length&&(e=-1);let l=o,h=o;e<0?l=vi(n.text,o,!1):h=vi(n.text,o);let f=i(n.text.slice(l,h));for(;l>0;){let c=vi(n.text,l,!1);if(i(n.text.slice(c,l))!=f)break;l=c}for(;h<n.length;){let c=vi(n.text,h);if(i(n.text.slice(h,c))!=f)break;h=c}return z.range(l+n.from,h+n.from)}function ak(r,t){return t.left>r?t.left-r:Math.max(0,r-t.right)}function hk(r,t){return t.top>r?t.top-r:Math.max(0,r-t.bottom)}function Ha(r,t){return r.top<t.bottom-1&&r.bottom>t.top+1}function Pd(r,t){return t<r.top?{top:t,left:r.left,right:r.right,bottom:r.bottom}:r}function Md(r,t){return t>r.bottom?{top:r.top,left:r.left,right:r.right,bottom:t}:r}function Rh(r,t,e){let i,n,o,l,h=!1,f,c,d,g;for(let b=r.firstChild;b;b=b.nextSibling){let S=or(b);for(let C=0;C<S.length;C++){let P=S[C];n&&Ha(n,P)&&(P=Pd(Md(P,n.bottom),n.top));let B=ak(t,P),L=hk(e,P);if(B==0&&L==0)return b.nodeType==3?Rd(b,t,e):Rh(b,t,e);if(!i||l>L||l==L&&o>B){i=b,n=P,o=B,l=L;let _=L?e<P.top?-1:1:B?t<P.left?-1:1:0;h=!_||(_>0?C<S.length-1:C>0)}B==0?e>P.bottom&&(!d||d.bottom<P.bottom)?(f=b,d=P):e<P.top&&(!g||g.top>P.top)&&(c=b,g=P):d&&Ha(d,P)?d=Md(d,P.bottom):g&&Ha(g,P)&&(g=Pd(g,P.top))}}if(d&&d.bottom>=e?(i=f,n=d):g&&g.top<=e&&(i=c,n=g),!i)return{node:r,offset:0};let m=Math.max(n.left,Math.min(n.right,t));if(i.nodeType==3)return Rd(i,m,e);if(h&&i.contentEditable!="false")return Rh(i,m,e);let w=Array.prototype.indexOf.call(r.childNodes,i)+(t>=(n.left+n.right)/2?1:0);return{node:r,offset:w}}function Rd(r,t,e){let i=r.nodeValue.length,n=-1,o=1e9,l=0;for(let h=0;h<i;h++){let f=_n(r,h,h+1).getClientRects();for(let c=0;c<f.length;c++){let d=f[c];if(d.top==d.bottom)continue;l||(l=t-d.left);let g=(d.top>e?d.top-e:e-d.bottom)-1;if(d.left-1<=t&&d.right+1>=t&&g<o){let m=t>=(d.left+d.right)/2,w=m;if((q.chrome||q.gecko)&&_n(r,h).getBoundingClientRect().left==d.right&&(w=!m),g<=0)return{node:r,offset:h+(w?1:0)};n=h+(w?1:0),o=g}}}return{node:r,offset:n>-1?n:l>0?r.nodeValue.length:0}}function Kg(r,t,e,i=-1){var n,o;let l=r.contentDOM.getBoundingClientRect(),h=l.top+r.viewState.paddingTop,f,{docHeight:c}=r.viewState,{x:d,y:g}=t,m=g-h;if(m<0)return 0;if(m>c)return r.state.doc.length;for(let _=r.viewState.heightOracle.textHeight/2,$=!1;f=r.elementAtHeight(m),f.type!=Si.Text;)for(;m=i>0?f.bottom+_:f.top-_,!(m>=0&&m<=c);){if($)return e?null:0;$=!0,i=-i}g=h+m;let w=f.from;if(w<r.viewport.from)return r.viewport.from==0?0:e?null:_d(r,l,f,d,g);if(w>r.viewport.to)return r.viewport.to==r.state.doc.length?r.state.doc.length:e?null:_d(r,l,f,d,g);let b=r.dom.ownerDocument,S=r.root.elementFromPoint?r.root:b,C=S.elementFromPoint(d,g);C&&!r.contentDOM.contains(C)&&(C=null),C||(d=Math.max(l.left+1,Math.min(l.right-1,d)),C=S.elementFromPoint(d,g),C&&!r.contentDOM.contains(C)&&(C=null));let P,B=-1;if(C&&((n=r.docView.nearest(C))===null||n===void 0?void 0:n.isEditable)!=!1){if(b.caretPositionFromPoint){let _=b.caretPositionFromPoint(d,g);_&&({offsetNode:P,offset:B}=_)}else if(b.caretRangeFromPoint){let _=b.caretRangeFromPoint(d,g);_&&({startContainer:P,startOffset:B}=_,(!r.contentDOM.contains(P)||q.safari&&fk(P,B,d)||q.chrome&&uk(P,B,d))&&(P=void 0))}P&&(B=Math.min(ki(P),B))}if(!P||!r.docView.dom.contains(P)){let _=Vt.find(r.docView,w);if(!_)return m>f.top+f.height/2?f.to:f.from;({node:P,offset:B}=Rh(_.dom,d,g))}let L=r.docView.nearest(P);if(!L)return null;if(L.isWidget&&((o=L.dom)===null||o===void 0?void 0:o.nodeType)==1){let _=L.dom.getBoundingClientRect();return t.y<_.top||t.y<=_.bottom&&t.x<=(_.left+_.right)/2?L.posAtStart:L.posAtEnd}else return L.localPosFromDOM(P,B)+L.posAtStart}function _d(r,t,e,i,n){let o=Math.round((i-t.left)*r.defaultCharacterWidth);if(r.lineWrapping&&e.height>r.defaultLineHeight*1.5){let h=r.viewState.heightOracle.textHeight,f=Math.floor((n-e.top-(r.defaultLineHeight-h)*.5)/h);o+=f*r.viewState.heightOracle.lineLength}let l=r.state.sliceDoc(e.from,e.to);return e.from+CS(l,o,r.state.tabSize)}function fk(r,t,e){let i;if(r.nodeType!=3||t!=(i=r.nodeValue.length))return!1;for(let n=r.nextSibling;n;n=n.nextSibling)if(n.nodeType!=1||n.nodeName!="BR")return!1;return _n(r,i-1,i).getBoundingClientRect().left>e}function uk(r,t,e){if(t!=0)return!1;for(let n=r;;){let o=n.parentNode;if(!o||o.nodeType!=1||o.firstChild!=n)return!1;if(o.classList.contains("cm-line"))break;n=o}let i=r.nodeType==1?r.getBoundingClientRect():_n(r,0,Math.max(r.nodeValue.length,1)).getBoundingClientRect();return e-i.left>5}function ck(r,t){let e=r.lineBlockAt(t);if(Array.isArray(e.type)){for(let i of e.type)if(i.to>t||i.to==t&&(i.to==e.to||i.type==Si.Text))return i}return e}function dk(r,t,e,i){let n=ck(r,t.head),o=!i||n.type!=Si.Text||!(r.lineWrapping||n.widgetLineBreaks)?null:r.coordsAtPos(t.assoc<0&&t.head>n.from?t.head-1:t.head);if(o){let l=r.dom.getBoundingClientRect(),h=r.textDirectionAt(n.from),f=r.posAtCoords({x:e==(h==Ht.LTR)?l.right-1:l.left+1,y:(o.top+o.bottom)/2});if(f!=null)return z.cursor(f,e?-1:1)}return z.cursor(e?n.to:n.from,e?-1:1)}function Ed(r,t,e,i){let n=r.state.doc.lineAt(t.head),o=r.bidiSpans(n),l=r.textDirectionAt(n.from);for(let h=t,f=null;;){let c=GS(n,o,l,h,e),d=Ig;if(!c){if(n.number==(e?r.state.doc.lines:1))return h;d=`
`,n=r.state.doc.line(n.number+(e?1:-1)),o=r.bidiSpans(n),c=r.visualLineSide(n,!e)}if(f){if(!f(d))return h}else{if(!i)return c;f=i(d)}h=c}}function pk(r,t,e){let i=r.state.charCategorizer(t),n=i(e);return o=>{let l=i(o);return n==qe.Space&&(n=l),n==l}}function gk(r,t,e,i){let n=t.head,o=e?1:-1;if(n==(e?r.state.doc.length:0))return z.cursor(n,t.assoc);let l=t.goalColumn,h,f=r.contentDOM.getBoundingClientRect(),c=r.coordsAtPos(n,t.assoc||-1),d=r.documentTop;if(c)l==null&&(l=c.left-f.left),h=o<0?c.top:c.bottom;else{let w=r.viewState.lineBlockAt(n);l==null&&(l=Math.min(f.right-f.left,r.defaultCharacterWidth*(n-w.from))),h=(o<0?w.top:w.bottom)+d}let g=f.left+l,m=i??r.viewState.heightOracle.textHeight>>1;for(let w=0;;w+=10){let b=h+(m+w)*o,S=Kg(r,{x:g,y:b},!1,o);if(b<f.top||b>f.bottom||(o<0?S<n:S>n)){let C=r.docView.coordsForChar(S),P=!C||b<C.top?-1:1;return z.cursor(S,P,void 0,l)}}}function Wo(r,t,e){for(;;){let i=0;for(let n of r)n.between(t-1,t+1,(o,l,h)=>{if(t>o&&t<l){let f=i||e||(t-o<l-t?-1:1);t=f<0?o:l,i=f}});if(!i)return t}}function za(r,t,e){let i=Wo(r.state.facet(rf).map(n=>n(r)),e.from,t.head>e.from?-1:1);return i==e.from?e:z.cursor(i,i<e.from?1:-1)}const qr="";class mk{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(mt.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=qr}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n);let o=this.text.length;this.readNode(n);let l=n.nextSibling;if(l==e)break;let h=kt.get(n),f=kt.get(l);(h&&f?h.breakAfter:(h?h.breakAfter:Qo(n))||Qo(l)&&(n.nodeName!="BR"||n.cmIgnore)&&this.text.length>o)&&this.lineBreak(),n=l}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let o=-1,l=1,h;if(this.lineSeparator?(o=e.indexOf(this.lineSeparator,i),l=this.lineSeparator.length):(h=n.exec(e))&&(o=h.index,l=h[0].length),this.append(e.slice(i,o<0?e.length:o)),o<0)break;if(this.lineBreak(),l>1)for(let f of this.points)f.node==t&&f.pos>this.text.length&&(f.pos-=l-1);i=o+l}}readNode(t){if(t.cmIgnore)return;let e=kt.get(t),i=e&&e.overrideDOMText;if(i!=null){this.findPointInside(t,i.length);for(let n=i.iter();!n.next().done;)n.lineBreak?this.lineBreak():this.append(n.value)}else t.nodeType==3?this.readTextNode(t):t.nodeName=="BR"?t.nextSibling&&this.lineBreak():t.nodeType==1&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(t.nodeType==3?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+(yk(t,i.node,i.offset)?e:0))}}function yk(r,t,e){for(;;){if(!t||e<ki(t))return!1;if(t==r)return!0;e=Rn(t)+1,t=t.parentNode}}class Dd{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class wk{constructor(t,e,i,n){this.typeOver=n,this.bounds=null,this.text="",this.domChanged=e>-1;let{impreciseHead:o,impreciseAnchor:l}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,i,0))){let h=o||l?[]:bk(t),f=new mk(h,t.state);f.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=f.text,this.newSel=Ok(h,this.bounds.from)}else{let h=t.observer.selectionRange,f=o&&o.node==h.focusNode&&o.offset==h.focusOffset||!vh(t.contentDOM,h.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(h.focusNode,h.focusOffset),c=l&&l.node==h.anchorNode&&l.offset==h.anchorOffset||!vh(t.contentDOM,h.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(h.anchorNode,h.anchorOffset),d=t.viewport;if((q.ios||q.chrome)&&t.state.selection.main.empty&&f!=c&&(d.from>0||d.to<t.state.doc.length)){let g=Math.min(f,c),m=Math.max(f,c),w=d.from-g,b=d.to-m;(w==0||w==1||g==0)&&(b==0||b==-1||m==t.state.doc.length)&&(f=0,c=t.state.doc.length)}this.newSel=z.single(c,f)}}}function Gg(r,t){let e,{newSel:i}=t,n=r.state.selection.main,o=r.inputState.lastKeyTime>Date.now()-100?r.inputState.lastKeyCode:-1;if(t.bounds){let{from:l,to:h}=t.bounds,f=n.from,c=null;(o===8||q.android&&t.text.length<h-l)&&(f=n.to,c="end");let d=xk(r.state.doc.sliceString(l,h,qr),t.text,f-l,c);d&&(q.chrome&&o==13&&d.toB==d.from+2&&t.text.slice(d.from,d.toB)==qr+qr&&d.toB--,e={from:l+d.from,to:l+d.toA,insert:pt.of(t.text.slice(d.from,d.toB).split(qr))})}else i&&(!r.hasFocus&&r.state.facet(Fi)||i.main.eq(n))&&(i=null);if(!e&&!i)return!1;if(!e&&t.typeOver&&!n.empty&&i&&i.main.empty?e={from:n.from,to:n.to,insert:r.state.doc.slice(n.from,n.to)}:(q.mac||q.android)&&e&&e.from==e.to&&e.from==n.head-1&&/^\. ?$/.test(e.insert.toString())&&r.contentDOM.getAttribute("autocorrect")=="off"?(i&&e.insert.length==2&&(i=z.single(i.main.anchor-1,i.main.head-1)),e={from:e.from,to:e.to,insert:pt.of([e.insert.toString().replace("."," ")])}):e&&e.from>=n.from&&e.to<=n.to&&(e.from!=n.from||e.to!=n.to)&&n.to-n.from-(e.to-e.from)<=4?e={from:n.from,to:n.to,insert:r.state.doc.slice(n.from,e.from).append(e.insert).append(r.state.doc.slice(e.to,n.to))}:q.chrome&&e&&e.from==e.to&&e.from==n.head&&e.insert.toString()==`
 `&&r.lineWrapping&&(i&&(i=z.single(i.main.anchor-1,i.main.head-1)),e={from:n.from,to:n.to,insert:pt.of([" "])}),e)return of(r,e,i,o);if(i&&!i.main.eq(n)){let l=!1,h="select";return r.inputState.lastSelectionTime>Date.now()-50&&(r.inputState.lastSelectionOrigin=="select"&&(l=!0),h=r.inputState.lastSelectionOrigin),r.dispatch({selection:i,scrollIntoView:l,userEvent:h}),!0}else return!1}function of(r,t,e,i=-1){if(q.ios&&r.inputState.flushIOSKey(t))return!0;let n=r.state.selection.main;if(q.android&&(t.to==n.to&&(t.from==n.from||t.from==n.from-1&&r.state.sliceDoc(t.from,n.from)==" ")&&t.insert.length==1&&t.insert.lines==2&&jn(r.contentDOM,"Enter",13)||(t.from==n.from-1&&t.to==n.to&&t.insert.length==0||i==8&&t.insert.length<t.to-t.from&&t.to>n.head)&&jn(r.contentDOM,"Backspace",8)||t.from==n.from&&t.to==n.to+1&&t.insert.length==0&&jn(r.contentDOM,"Delete",46)))return!0;let o=t.insert.toString();r.inputState.composing>=0&&r.inputState.composing++;let l,h=()=>l||(l=vk(r,t,e));return r.state.facet(Wg).some(f=>f(r,t.from,t.to,o,h))||r.dispatch(h()),!0}function vk(r,t,e){let i,n=r.state,o=n.selection.main;if(t.from>=o.from&&t.to<=o.to&&t.to-t.from>=(o.to-o.from)/3&&(!e||e.main.empty&&e.main.from==t.from+t.insert.length)&&r.inputState.composing<0){let h=o.from<t.from?n.sliceDoc(o.from,t.from):"",f=o.to>t.to?n.sliceDoc(t.to,o.to):"";i=n.replaceSelection(r.state.toText(h+t.insert.sliceString(0,void 0,r.state.lineBreak)+f))}else{let h=n.changes(t),f=e&&e.main.to<=h.newLength?e.main:void 0;if(n.selection.ranges.length>1&&r.inputState.composing>=0&&t.to<=o.to&&t.to>=o.to-10){let c=r.state.sliceDoc(t.from,t.to),d,g=e&&Xg(r,e.main.head);if(g){let b=t.insert.length-(t.to-t.from);d={from:g.from,to:g.to-b}}else d=r.state.doc.lineAt(o.head);let m=o.to-t.to,w=o.to-o.from;i=n.changeByRange(b=>{if(b.from==o.from&&b.to==o.to)return{changes:h,range:f||b.map(h)};let S=b.to-m,C=S-c.length;if(b.to-b.from!=w||r.state.sliceDoc(C,S)!=c||b.to>=d.from&&b.from<=d.to)return{range:b};let P=n.changes({from:C,to:S,insert:t.insert}),B=b.to-o.to;return{changes:P,range:f?z.range(Math.max(0,f.anchor+B),Math.max(0,f.head+B)):b.map(P)}})}else i={changes:h,selection:f&&n.selection.replaceRange(f)}}let l="input.type";return(r.composing||r.inputState.compositionPendingChange&&r.inputState.compositionEndedAt>Date.now()-50)&&(r.inputState.compositionPendingChange=!1,l+=".compose",r.inputState.compositionFirstChange&&(l+=".start",r.inputState.compositionFirstChange=!1)),n.update(i,{userEvent:l,scrollIntoView:!0})}function xk(r,t,e,i){let n=Math.min(r.length,t.length),o=0;for(;o<n&&r.charCodeAt(o)==t.charCodeAt(o);)o++;if(o==n&&r.length==t.length)return null;let l=r.length,h=t.length;for(;l>0&&h>0&&r.charCodeAt(l-1)==t.charCodeAt(h-1);)l--,h--;if(i=="end"){let f=Math.max(0,o-Math.min(l,h));e-=l+f-o}if(l<o&&r.length<t.length){let f=e<=o&&e>=l?o-e:0;o-=f,h=o+(h-l),l=o}else if(h<o){let f=e<=o&&e>=h?o-e:0;o-=f,l=o+(l-h),h=o}return{from:o,toA:l,toB:h}}function bk(r){let t=[];if(r.root.activeElement!=r.contentDOM)return t;let{anchorNode:e,anchorOffset:i,focusNode:n,focusOffset:o}=r.observer.selectionRange;return e&&(t.push(new Dd(e,i)),(n!=e||o!=i)&&t.push(new Dd(n,o))),t}function Ok(r,t){if(r.length==0)return null;let e=r[0].pos,i=r.length==2?r[1].pos:e;return e>-1&&i>-1?z.single(e+t,i+t):null}class Sk{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,q.safari&&t.contentDOM.addEventListener("input",()=>null),q.gecko&&Wk(t.contentDOM.ownerDocument)}handleEvent(t){!_k(this.view,t)||this.ignoreDuringComposition(t)||t.type=="keydown"&&this.keydown(t)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(t.type,t)):this.runHandlers(t.type,t))}runHandlers(t,e){let i=this.handlers[t];if(i){for(let n of i.observers)n(this.view,e);for(let n of i.handlers){if(e.defaultPrevented)break;if(n(this.view,e)){e.preventDefault();break}}}}ensureHandlers(t){let e=kk(t),i=this.handlers,n=this.view.contentDOM;for(let o in e)if(o!="scroll"){let l=!e[o].handlers.length,h=i[o];h&&l!=!h.handlers.length&&(n.removeEventListener(o,this.handleEvent),h=null),h||n.addEventListener(o,this.handleEvent,{passive:l})}for(let o in i)o!="scroll"&&!e[o]&&n.removeEventListener(o,this.handleEvent);this.handlers=e}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&t.keyCode!=27&&jg.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),q.android&&q.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let e;return q.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((e=Zg.find(i=>i.keyCode==t.keyCode))&&!t.ctrlKey||Ck.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=e||t,setTimeout(()=>this.flushIOSKey(),250),!0):(t.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(t){let e=this.pendingIOSKey;return!e||e.key=="Enter"&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString())?!1:(this.pendingIOSKey=void 0,jn(this.view.contentDOM,e.key,e.keyCode,e instanceof KeyboardEvent?e:void 0))}ignoreDuringComposition(t){return/^key/.test(t.type)?this.composing>0?!0:q.safari&&!q.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Id(r,t){return(e,i)=>{try{return t.call(r,i,e)}catch(n){ae(e.state,n)}}}function kk(r){let t=Object.create(null);function e(i){return t[i]||(t[i]={observers:[],handlers:[]})}for(let i of r){let n=i.spec;if(n&&n.domEventHandlers)for(let o in n.domEventHandlers){let l=n.domEventHandlers[o];l&&e(o).handlers.push(Id(i.value,l))}if(n&&n.domEventObservers)for(let o in n.domEventObservers){let l=n.domEventObservers[o];l&&e(o).observers.push(Id(i.value,l))}}for(let i in si)e(i).handlers.push(si[i]);for(let i in Xe)e(i).observers.push(Xe[i]);return t}const Zg=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Ck="dthko",jg=[16,17,18,20,91,92,224,225],wo=6;function vo(r){return Math.max(0,r)*.7+8}function Ak(r,t){return Math.max(Math.abs(r.clientX-t.clientX),Math.abs(r.clientY-t.clientY))}class Tk{constructor(t,e,i,n){this.view=t,this.startEvent=e,this.style=i,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParents=ES(t.contentDOM),this.atoms=t.state.facet(rf).map(l=>l(t));let o=t.contentDOM.ownerDocument;o.addEventListener("mousemove",this.move=this.move.bind(this)),o.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(mt.allowMultipleSelections)&&Pk(t,e),this.dragging=Rk(t,e)&&em(e)==1?null:!1}start(t){this.dragging===!1&&this.select(t)}move(t){if(t.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Ak(this.startEvent,t)<10)return;this.select(this.lastEvent=t);let e=0,i=0,n=0,o=0,l=this.view.win.innerWidth,h=this.view.win.innerHeight;this.scrollParents.x&&({left:n,right:l}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:o,bottom:h}=this.scrollParents.y.getBoundingClientRect());let f=sf(this.view);t.clientX-f.left<=n+wo?e=-vo(n-t.clientX):t.clientX+f.right>=l-wo&&(e=vo(t.clientX-l)),t.clientY-f.top<=o+wo?i=-vo(o-t.clientY):t.clientY+f.bottom>=h-wo&&(i=vo(t.clientY-h)),this.setScrollSpeed(e,i)}up(t){this.dragging==null&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:e}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),e&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=e,e=0),(t||e)&&this.view.win.scrollBy(t,e),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(t){let e=null;for(let i=0;i<t.ranges.length;i++){let n=t.ranges[i],o=null;if(n.empty){let l=Wo(this.atoms,n.from,0);l!=n.from&&(o=z.cursor(l,-1))}else{let l=Wo(this.atoms,n.from,-1),h=Wo(this.atoms,n.to,1);(l!=n.from||h!=n.to)&&(o=z.range(n.from==n.anchor?l:h,n.from==n.head?l:h))}o&&(e||(e=t.ranges.slice()),e[i]=o)}return e?z.create(e,t.mainIndex):t}select(t){let{view:e}=this,i=this.skipAtoms(this.style.get(t,this.extend,this.multiple));(this.mustSelect||!i.eq(e.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some(e=>e.isUserEvent("input.type"))?this.destroy():this.style.update(t)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Pk(r,t){let e=r.state.facet(Bg);return e.length?e[0](t):q.mac?t.metaKey:t.ctrlKey}function Mk(r,t){let e=r.state.facet(Lg);return e.length?e[0](t):q.mac?!t.altKey:!t.ctrlKey}function Rk(r,t){let{main:e}=r.state.selection;if(e.empty)return!1;let i=os(r.root);if(!i||i.rangeCount==0)return!0;let n=i.getRangeAt(0).getClientRects();for(let o=0;o<n.length;o++){let l=n[o];if(l.left<=t.clientX&&l.right>=t.clientX&&l.top<=t.clientY&&l.bottom>=t.clientY)return!0}return!1}function _k(r,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target,i;e!=r.contentDOM;e=e.parentNode)if(!e||e.nodeType==11||(i=kt.get(e))&&i.ignoreEvent(t))return!1;return!0}const si=Object.create(null),Xe=Object.create(null),Jg=q.ie&&q.ie_version<15||q.ios&&q.webkit_version<604;function Ek(r){let t=r.dom.parentNode;if(!t)return;let e=t.appendChild(document.createElement("textarea"));e.style.cssText="position: fixed; left: -10000px; top: 10px",e.focus(),setTimeout(()=>{r.focus(),e.remove(),tm(r,e.value)},50)}function cl(r,t,e){for(let i of r.facet(t))e=i(e,r);return e}function tm(r,t){t=cl(r.state,tf,t);let{state:e}=r,i,n=1,o=e.toText(t),l=o.lines==e.selection.ranges.length;if(_h!=null&&e.selection.ranges.every(f=>f.empty)&&_h==o.toString()){let f=-1;i=e.changeByRange(c=>{let d=e.doc.lineAt(c.from);if(d.from==f)return{range:c};f=d.from;let g=e.toText((l?o.line(n++).text:t)+e.lineBreak);return{changes:{from:d.from,insert:g},range:z.cursor(c.from+g.length)}})}else l?i=e.changeByRange(f=>{let c=o.line(n++);return{changes:{from:f.from,to:f.to,insert:c.text},range:z.cursor(f.from+c.length)}}):i=e.replaceSelection(o);r.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}Xe.scroll=r=>{r.inputState.lastScrollTop=r.scrollDOM.scrollTop,r.inputState.lastScrollLeft=r.scrollDOM.scrollLeft};si.keydown=(r,t)=>(r.inputState.setSelectionOrigin("select"),t.keyCode==27&&r.inputState.tabFocusMode!=0&&(r.inputState.tabFocusMode=Date.now()+2e3),!1);Xe.touchstart=(r,t)=>{r.inputState.lastTouchTime=Date.now(),r.inputState.setSelectionOrigin("select.pointer")};Xe.touchmove=r=>{r.inputState.setSelectionOrigin("select.pointer")};si.mousedown=(r,t)=>{if(r.observer.flush(),r.inputState.lastTouchTime>Date.now()-2e3)return!1;let e=null;for(let i of r.state.facet(Ng))if(e=i(r,t),e)break;if(!e&&t.button==0&&(e=Bk(r,t)),e){let i=!r.hasFocus;r.inputState.startMouseSelection(new Tk(r,t,e,i)),i&&r.observer.ignore(()=>{mg(r.contentDOM);let o=r.root.activeElement;o&&!o.contains(r.contentDOM)&&o.blur()});let n=r.inputState.mouseSelection;if(n)return n.start(t),n.dragging===!1}return!1};function Bd(r,t,e,i){if(i==1)return z.cursor(t,e);if(i==2)return lk(r.state,t,e);{let n=Vt.find(r.docView,t),o=r.state.doc.lineAt(n?n.posAtEnd:t),l=n?n.posAtStart:o.from,h=n?n.posAtEnd:o.to;return h<r.state.doc.length&&h==o.to&&h++,z.range(l,h)}}let Ld=(r,t,e)=>t>=e.top&&t<=e.bottom&&r>=e.left&&r<=e.right;function Dk(r,t,e,i){let n=Vt.find(r.docView,t);if(!n)return 1;let o=t-n.posAtStart;if(o==0)return 1;if(o==n.length)return-1;let l=n.coordsAt(o,-1);if(l&&Ld(e,i,l))return-1;let h=n.coordsAt(o,1);return h&&Ld(e,i,h)?1:l&&l.bottom>=i?-1:1}function Nd(r,t){let e=r.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:e,bias:Dk(r,e,t.clientX,t.clientY)}}const Ik=q.ie&&q.ie_version<=11;let $d=null,Wd=0,Fd=0;function em(r){if(!Ik)return r.detail;let t=$d,e=Fd;return $d=r,Fd=Date.now(),Wd=!t||e>Date.now()-400&&Math.abs(t.clientX-r.clientX)<2&&Math.abs(t.clientY-r.clientY)<2?(Wd+1)%3:1}function Bk(r,t){let e=Nd(r,t),i=em(t),n=r.state.selection;return{update(o){o.docChanged&&(e.pos=o.changes.mapPos(e.pos),n=n.map(o.changes))},get(o,l,h){let f=Nd(r,o),c,d=Bd(r,f.pos,f.bias,i);if(e.pos!=f.pos&&!l){let g=Bd(r,e.pos,e.bias,i),m=Math.min(g.from,d.from),w=Math.max(g.to,d.to);d=m<d.from?z.range(m,w):z.range(w,m)}return l?n.replaceRange(n.main.extend(d.from,d.to)):h&&i==1&&n.ranges.length>1&&(c=Lk(n,f.pos))?c:h?n.addRange(d):z.create([d])}}}function Lk(r,t){for(let e=0;e<r.ranges.length;e++){let{from:i,to:n}=r.ranges[e];if(i<=t&&n>=t)return z.create(r.ranges.slice(0,e).concat(r.ranges.slice(e+1)),r.mainIndex==e?0:r.mainIndex-(r.mainIndex>e?1:0))}return null}si.dragstart=(r,t)=>{let{selection:{main:e}}=r.state;if(t.target.draggable){let n=r.docView.nearest(t.target);if(n&&n.isWidget){let o=n.posAtStart,l=o+n.length;(o>=e.to||l<=e.from)&&(e=z.range(o,l))}}let{inputState:i}=r;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=e,t.dataTransfer&&(t.dataTransfer.setData("Text",cl(r.state,ef,r.state.sliceDoc(e.from,e.to))),t.dataTransfer.effectAllowed="copyMove"),!1};si.dragend=r=>(r.inputState.draggedContent=null,!1);function Vd(r,t,e,i){if(e=cl(r.state,tf,e),!e)return;let n=r.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:o}=r.inputState,l=i&&o&&Mk(r,t)?{from:o.from,to:o.to}:null,h={from:n,insert:e},f=r.state.changes(l?[l,h]:h);r.focus(),r.dispatch({changes:f,selection:{anchor:f.mapPos(n,-1),head:f.mapPos(n,1)},userEvent:l?"move.drop":"input.drop"}),r.inputState.draggedContent=null}si.drop=(r,t)=>{if(!t.dataTransfer)return!1;if(r.state.readOnly)return!0;let e=t.dataTransfer.files;if(e&&e.length){let i=Array(e.length),n=0,o=()=>{++n==e.length&&Vd(r,t,i.filter(l=>l!=null).join(r.state.lineBreak),!1)};for(let l=0;l<e.length;l++){let h=new FileReader;h.onerror=o,h.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(h.result)||(i[l]=h.result),o()},h.readAsText(e[l])}return!0}else{let i=t.dataTransfer.getData("Text");if(i)return Vd(r,t,i,!0),!0}return!1};si.paste=(r,t)=>{if(r.state.readOnly)return!0;r.observer.flush();let e=Jg?null:t.clipboardData;return e?(tm(r,e.getData("text/plain")||e.getData("text/uri-list")),!0):(Ek(r),!1)};function Nk(r,t){let e=r.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=t,i.focus(),i.selectionEnd=t.length,i.selectionStart=0,setTimeout(()=>{i.remove(),r.focus()},50)}function $k(r){let t=[],e=[],i=!1;for(let n of r.selection.ranges)n.empty||(t.push(r.sliceDoc(n.from,n.to)),e.push(n));if(!t.length){let n=-1;for(let{from:o}of r.selection.ranges){let l=r.doc.lineAt(o);l.number>n&&(t.push(l.text),e.push({from:l.from,to:Math.min(r.doc.length,l.to+1)})),n=l.number}i=!0}return{text:cl(r,ef,t.join(r.lineBreak)),ranges:e,linewise:i}}let _h=null;si.copy=si.cut=(r,t)=>{let{text:e,ranges:i,linewise:n}=$k(r.state);if(!e&&!n)return!1;_h=n?e:null,t.type=="cut"&&!r.state.readOnly&&r.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let o=Jg?null:t.clipboardData;return o?(o.clearData(),o.setData("text/plain",e),!0):(Nk(r,e),!1)};const im=qi.define();function nm(r,t){let e=[];for(let i of r.facet(Fg)){let n=i(r,t);n&&e.push(n)}return e?r.update({effects:e,annotations:im.of(!0)}):null}function rm(r){setTimeout(()=>{let t=r.hasFocus;if(t!=r.inputState.notifiedFocused){let e=nm(r.state,t);e?r.dispatch(e):r.update([])}},10)}Xe.focus=r=>{r.inputState.lastFocusTime=Date.now(),!r.scrollDOM.scrollTop&&(r.inputState.lastScrollTop||r.inputState.lastScrollLeft)&&(r.scrollDOM.scrollTop=r.inputState.lastScrollTop,r.scrollDOM.scrollLeft=r.inputState.lastScrollLeft),rm(r)};Xe.blur=r=>{r.observer.clearSelectionRange(),rm(r)};Xe.compositionstart=Xe.compositionupdate=r=>{r.observer.editContext||(r.inputState.compositionFirstChange==null&&(r.inputState.compositionFirstChange=!0),r.inputState.composing<0&&(r.inputState.composing=0))};Xe.compositionend=r=>{r.observer.editContext||(r.inputState.composing=-1,r.inputState.compositionEndedAt=Date.now(),r.inputState.compositionPendingKey=!0,r.inputState.compositionPendingChange=r.observer.pendingRecords().length>0,r.inputState.compositionFirstChange=null,q.chrome&&q.android?r.observer.flushSoon():r.inputState.compositionPendingChange?Promise.resolve().then(()=>r.observer.flush()):setTimeout(()=>{r.inputState.composing<0&&r.docView.hasComposition&&r.update([])},50))};Xe.contextmenu=r=>{r.inputState.lastContextMenu=Date.now()};si.beforeinput=(r,t)=>{var e,i;if(t.inputType=="insertReplacementText"&&r.observer.editContext){let o=(e=t.dataTransfer)===null||e===void 0?void 0:e.getData("text/plain"),l=t.getTargetRanges();if(o&&l.length){let h=l[0],f=r.posAtDOM(h.startContainer,h.startOffset),c=r.posAtDOM(h.endContainer,h.endOffset);return of(r,{from:f,to:c,insert:r.state.toText(o)},null),!0}}let n;if(q.chrome&&q.android&&(n=Zg.find(o=>o.inputType==t.inputType))&&(r.observer.delayAndroidKey(n.key,n.keyCode),n.key=="Backspace"||n.key=="Delete")){let o=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var l;(((l=window.visualViewport)===null||l===void 0?void 0:l.height)||0)>o+10&&r.hasFocus&&(r.contentDOM.blur(),r.focus())},100)}return q.ios&&t.inputType=="deleteContentForward"&&r.observer.flushSoon(),q.safari&&t.inputType=="insertText"&&r.inputState.composing>=0&&setTimeout(()=>Xe.compositionend(r,t),20),!1};const Hd=new Set;function Wk(r){Hd.has(r)||(Hd.add(r),r.addEventListener("copy",()=>{}),r.addEventListener("cut",()=>{}))}const zd=["pre-wrap","normal","pre-line","break-spaces"];let hr=!1;function qd(){hr=!1}class Fk{constructor(t){this.lineWrapping=t,this.doc=pt.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return zd.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(n*10)]||(e=!0,this.heightSamples[Math.floor(n*10)]=!0)}return e}refresh(t,e,i,n,o,l){let h=zd.indexOf(t)>-1,f=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=h;if(this.lineWrapping=h,this.lineHeight=e,this.charWidth=i,this.textHeight=n,this.lineLength=o,f){this.heightSamples={};for(let c=0;c<l.length;c++){let d=l[c];d<0?c++:this.heightSamples[Math.floor(d*10)]=!0}}return f}}class Vk{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class yi{constructor(t,e,i,n,o){this.from=t,this.length=e,this.top=i,this.height=n,this._content=o}get type(){return typeof this._content=="number"?Si.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof un?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(t){let e=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new yi(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var Pt=function(r){return r[r.ByPos=0]="ByPos",r[r.ByHeight=1]="ByHeight",r[r.ByPosNoHeight=2]="ByPosNoHeight",r}(Pt||(Pt={}));const Fo=.001;class he{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(t){this.flags=(t?2:0)|this.flags&-3}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>Fo&&(hr=!0),this.height=t)}replace(t,e,i){return he.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let o=this,l=i.doc;for(let h=n.length-1;h>=0;h--){let{fromA:f,toA:c,fromB:d,toB:g}=n[h],m=o.lineAt(f,Pt.ByPosNoHeight,i.setDoc(e),0,0),w=m.to>=c?m:o.lineAt(c,Pt.ByPosNoHeight,i,0,0);for(g+=w.to-c,c=w.to;h>0&&m.from<=n[h-1].toA;)f=n[h-1].fromA,d=n[h-1].fromB,h--,f<m.from&&(m=o.lineAt(f,Pt.ByPosNoHeight,i,0,0));d+=m.from-f,f=m.from;let b=lf.build(i.setDoc(l),t,d,g);o=Ko(o,o.replace(f,c,b))}return o.updateHeight(i,0)}static empty(){return new Re(0,0)}static of(t){if(t.length==1)return t[0];let e=0,i=t.length,n=0,o=0;for(;;)if(e==i)if(n>o*2){let h=t[e-1];h.break?t.splice(--e,1,h.left,null,h.right):t.splice(--e,1,h.left,h.right),i+=1+h.break,n-=h.size}else if(o>n*2){let h=t[i];h.break?t.splice(i,1,h.left,null,h.right):t.splice(i,1,h.left,h.right),i+=2+h.break,o-=h.size}else break;else if(n<o){let h=t[e++];h&&(n+=h.size)}else{let h=t[--i];h&&(o+=h.size)}let l=0;return t[e-1]==null?(l=1,e--):t[e]==null&&(l=1,i++),new Hk(he.of(t.slice(0,e)),l,he.of(t.slice(i)))}}function Ko(r,t){return r==t?r:(r.constructor!=t.constructor&&(hr=!0),t)}he.prototype.size=1;class sm extends he{constructor(t,e,i){super(t,e),this.deco=i}blockAt(t,e,i,n){return new yi(n,this.length,i,this.height,this.deco||0)}lineAt(t,e,i,n,o){return this.blockAt(0,i,n,o)}forEachLine(t,e,i,n,o,l){t<=o+this.length&&e>=o&&l(this.blockAt(0,i,n,o))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Re extends sm{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,e,i,n){return new yi(n,this.length,i,this.height,this.breaks)}replace(t,e,i){let n=i[0];return i.length==1&&(n instanceof Re||n instanceof Zt&&n.flags&4)&&Math.abs(this.length-n.length)<10?(n instanceof Zt?n=new Re(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):he.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(n.heights[n.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Zt extends he{constructor(t){super(t,0)}heightMetrics(t,e){let i=t.doc.lineAt(e).number,n=t.doc.lineAt(e+this.length).number,o=n-i+1,l,h=0;if(t.lineWrapping){let f=Math.min(this.height,t.lineHeight*o);l=f/o,this.length>o+1&&(h=(this.height-f)/(this.length-o-1))}else l=this.height/o;return{firstLine:i,lastLine:n,perLine:l,perChar:h}}blockAt(t,e,i,n){let{firstLine:o,lastLine:l,perLine:h,perChar:f}=this.heightMetrics(e,n);if(e.lineWrapping){let c=n+(t<e.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-i)/this.height))*this.length)),d=e.doc.lineAt(c),g=h+d.length*f,m=Math.max(i,t-g/2);return new yi(d.from,d.length,m,g,0)}else{let c=Math.max(0,Math.min(l-o,Math.floor((t-i)/h))),{from:d,length:g}=e.doc.line(o+c);return new yi(d,g,i+h*c,h,0)}}lineAt(t,e,i,n,o){if(e==Pt.ByHeight)return this.blockAt(t,i,n,o);if(e==Pt.ByPosNoHeight){let{from:w,to:b}=i.doc.lineAt(t);return new yi(w,b-w,0,0,0)}let{firstLine:l,perLine:h,perChar:f}=this.heightMetrics(i,o),c=i.doc.lineAt(t),d=h+c.length*f,g=c.number-l,m=n+h*g+f*(c.from-o-g);return new yi(c.from,c.length,Math.max(n,Math.min(m,n+this.height-d)),d,0)}forEachLine(t,e,i,n,o,l){t=Math.max(t,o),e=Math.min(e,o+this.length);let{firstLine:h,perLine:f,perChar:c}=this.heightMetrics(i,o);for(let d=t,g=n;d<=e;){let m=i.doc.lineAt(d);if(d==t){let b=m.number-h;g+=f*b+c*(t-o-b)}let w=f+c*m.length;l(new yi(m.from,m.length,g,w,0)),g+=w,d=m.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let o=i[i.length-1];o instanceof Zt?i[i.length-1]=new Zt(o.length+n):i.push(null,new Zt(n-1))}if(t>0){let o=i[0];o instanceof Zt?i[0]=new Zt(t+o.length):i.unshift(new Zt(t-1),null)}return he.of(i)}decomposeLeft(t,e){e.push(new Zt(t-1),null)}decomposeRight(t,e){e.push(null,new Zt(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let o=e+this.length;if(n&&n.from<=e+this.length&&n.more){let l=[],h=Math.max(e,n.from),f=-1;for(n.from>e&&l.push(new Zt(n.from-e-1).updateHeight(t,e));h<=o&&n.more;){let d=t.doc.lineAt(h).length;l.length&&l.push(null);let g=n.heights[n.index++];f==-1?f=g:Math.abs(g-f)>=Fo&&(f=-2);let m=new Re(d,g);m.outdated=!1,l.push(m),h+=d+1}h<=o&&l.push(null,new Zt(o-h).updateHeight(t,h));let c=he.of(l);return(f<0||Math.abs(c.height-this.height)>=Fo||Math.abs(f-this.heightMetrics(t,e).perLine)>=Fo)&&(hr=!0),Ko(this,c)}else(i||this.outdated)&&(this.setHeight(t.heightForGap(e,e+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Hk extends he{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return this.flags&1}blockAt(t,e,i,n){let o=i+this.left.height;return t<o?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,o,n+this.left.length+this.break)}lineAt(t,e,i,n,o){let l=n+this.left.height,h=o+this.left.length+this.break,f=e==Pt.ByHeight?t<l:t<h,c=f?this.left.lineAt(t,e,i,n,o):this.right.lineAt(t,e,i,l,h);if(this.break||(f?c.to<h:c.from>h))return c;let d=e==Pt.ByPosNoHeight?Pt.ByPosNoHeight:Pt.ByPos;return f?c.join(this.right.lineAt(h,d,i,l,h)):this.left.lineAt(h,d,i,n,o).join(c)}forEachLine(t,e,i,n,o,l){let h=n+this.left.height,f=o+this.left.length+this.break;if(this.break)t<f&&this.left.forEachLine(t,e,i,n,o,l),e>=f&&this.right.forEachLine(t,e,i,h,f,l);else{let c=this.lineAt(f,Pt.ByPos,i,n,o);t<c.from&&this.left.forEachLine(t,c.from-1,i,n,o,l),c.to>=t&&c.from<=e&&l(c),e>c.to&&this.right.forEachLine(c.to+1,e,i,h,f,l)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let o=[];t>0&&this.decomposeLeft(t,o);let l=o.length;for(let h of i)o.push(h);if(t>0&&Ud(o,l-1),e<this.length){let h=o.length;this.decomposeRight(e,o),Ud(o,h)}return he.of(o)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?he.of(this.break?[t,null,e]:[t,e]):(this.left=Ko(this.left,t),this.right=Ko(this.right,e),this.setHeight(t.height+e.height),this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:o,right:l}=this,h=e+o.length+this.break,f=null;return n&&n.from<=e+o.length&&n.more?f=o=o.updateHeight(t,e,i,n):o.updateHeight(t,e,i),n&&n.from<=h+l.length&&n.more?f=l=l.updateHeight(t,h,i,n):l.updateHeight(t,h,i),f?this.balanced(o,l):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Ud(r,t){let e,i;r[t]==null&&(e=r[t-1])instanceof Zt&&(i=r[t+1])instanceof Zt&&r.splice(t-1,3,new Zt(e.length+1+i.length))}const zk=5;class lf{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let i=Math.min(e,this.lineEnd),n=this.nodes[this.nodes.length-1];n instanceof Re?n.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new Re(i-this.pos,-1)),this.writtenTo=i,e>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0,o=i.widget?i.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let l=e-t;i.block?this.addBlock(new sm(l,n,i)):(l||o||n>=zk)&&this.addLineDeco(n,o,l)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new Re(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new Zt(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof Re)return t;let e=new Re(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine();let e=t.deco;e&&e.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,e&&e.endSide>0&&(this.covering=t)}addLineDeco(t,e,i){let n=this.ensureLine();n.length+=i,n.collapsed+=i,n.widgetHeight=Math.max(n.widgetHeight,t),n.breaks+=e,this.writtenTo=this.pos=this.pos+i}finish(t){let e=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(e instanceof Re)&&!this.isCovered?this.nodes.push(new Re(0,-1)):(this.writtenTo<this.pos||e==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=t;for(let n of this.nodes)n instanceof Re&&n.updateHeight(this.oracle,i),i+=n?n.length:1;return this.nodes}static build(t,e,i,n){let o=new lf(i,t);return At.spans(e,i,n,o,0),o.finish(i)}}function qk(r,t,e){let i=new Uk;return At.compare(r,t,e,i,0),i.changes}class Uk{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&$o(t,e,this.changes,5)}}function Qk(r,t){let e=r.getBoundingClientRect(),i=r.ownerDocument,n=i.defaultView||window,o=Math.max(0,e.left),l=Math.min(n.innerWidth,e.right),h=Math.max(0,e.top),f=Math.min(n.innerHeight,e.bottom);for(let c=r.parentNode;c&&c!=i.body;)if(c.nodeType==1){let d=c,g=window.getComputedStyle(d);if((d.scrollHeight>d.clientHeight||d.scrollWidth>d.clientWidth)&&g.overflow!="visible"){let m=d.getBoundingClientRect();o=Math.max(o,m.left),l=Math.min(l,m.right),h=Math.max(h,m.top),f=Math.min(c==r.parentNode?n.innerHeight:f,m.bottom)}c=g.position=="absolute"||g.position=="fixed"?d.offsetParent:d.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:o-e.left,right:Math.max(o,l)-e.left,top:h-(e.top+t),bottom:Math.max(h,f)-(e.top+t)}}function Yk(r){let t=r.getBoundingClientRect(),e=r.ownerDocument.defaultView||window;return t.left<e.innerWidth&&t.right>0&&t.top<e.innerHeight&&t.bottom>0}function Xk(r,t){let e=r.getBoundingClientRect();return{left:0,right:e.right-e.left,top:t,bottom:e.bottom-(e.top+t)}}class qa{constructor(t,e,i,n){this.from=t,this.to=e,this.size=i,this.displaySize=n}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],o=e[i];if(n.from!=o.from||n.to!=o.to||n.size!=o.size)return!1}return!0}draw(t,e){return yt.replace({widget:new Kk(this.displaySize*(e?t.scaleY:t.scaleX),e)}).range(this.from,this.to)}}class Kk extends ps{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class Qd{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Yd,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Ht.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(nf).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new Fk(e),this.stateDeco=t.facet(ls).filter(i=>typeof i!="function"),this.heightMap=he.empty().applyChanges(this.stateDeco,pt.empty,this.heightOracle.setDoc(t.doc),[new Ye(0,0,0,t.doc.length)]);for(let i=0;i<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());i++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=yt.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some(({from:o,to:l})=>n>=o&&n<=l)){let{from:o,to:l}=this.lineBlockAt(n);t.push(new xo(o,l))}}return this.viewports=t.sort((i,n)=>i.from-n.from),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?Yd:new af(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,t=>{this.viewportLines.push(Ur(t,this.scaler))})}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(ls).filter(d=>typeof d!="function");let n=t.changedRanges,o=Ye.extendWithRanges(n,qk(i,this.stateDeco,t?t.changes:Ut.empty(this.state.doc.length))),l=this.heightMap.height,h=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);qd(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),o),(this.heightMap.height!=l||hr)&&(t.flags|=2),h?(this.scrollAnchorPos=t.changes.mapPos(h.from,-1),this.scrollAnchorHeight=h.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let f=o.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<f.from||e.range.head>f.to)||!this.viewportIsAppropriate(f))&&(f=this.getViewport(0,e));let c=f.from!=this.viewport.from||f.to!=this.viewport.to;this.viewport=f,t.flags|=this.updateForViewport(),(c||!t.changes.empty||t.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(t.changes),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(jS)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,o=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?Ht.RTL:Ht.LTR;let l=this.heightOracle.mustRefreshForWrapping(o),h=e.getBoundingClientRect(),f=l||this.mustMeasureContent||this.contentDOMHeight!=h.height;this.contentDOMHeight=h.height,this.mustMeasureContent=!1;let c=0,d=0;if(h.width&&h.height){let{scaleX:_,scaleY:$}=gg(e,h);(_>.005&&Math.abs(this.scaleX-_)>.005||$>.005&&Math.abs(this.scaleY-$)>.005)&&(this.scaleX=_,this.scaleY=$,c|=16,l=f=!0)}let g=(parseInt(i.paddingTop)||0)*this.scaleY,m=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=g||this.paddingBottom!=m)&&(this.paddingTop=g,this.paddingBottom=m,c|=18),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(f=!0),this.editorWidth=t.scrollDOM.clientWidth,c|=16);let w=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=w&&(this.scrollAnchorHeight=-1,this.scrollTop=w),this.scrolledToBottom=wg(t.scrollDOM);let b=(this.printing?Xk:Qk)(e,this.paddingTop),S=b.top-this.pixelViewport.top,C=b.bottom-this.pixelViewport.bottom;this.pixelViewport=b;let P=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(P!=this.inView&&(this.inView=P,P&&(f=!0)),!this.inView&&!this.scrollTarget&&!Yk(t.dom))return 0;let B=h.width;if((this.contentDOMWidth!=B||this.editorHeight!=t.scrollDOM.clientHeight)&&(this.contentDOMWidth=h.width,this.editorHeight=t.scrollDOM.clientHeight,c|=16),f){let _=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(_)&&(l=!0),l||n.lineWrapping&&Math.abs(B-this.contentDOMWidth)>n.charWidth){let{lineHeight:$,charWidth:W,textHeight:F}=t.docView.measureTextSize();l=$>0&&n.refresh(o,$,W,F,B/W,_),l&&(t.docView.minWidth=0,c|=16)}S>0&&C>0?d=Math.max(S,C):S<0&&C<0&&(d=Math.min(S,C)),qd();for(let $ of this.viewports){let W=$.from==this.viewport.from?_:t.docView.measureVisibleLineHeights($);this.heightMap=(l?he.empty().applyChanges(this.stateDeco,pt.empty,this.heightOracle,[new Ye(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(n,0,l,new Vk($.from,W))}hr&&(c|=2)}let L=!this.viewportIsAppropriate(this.viewport,d)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return L&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(d,this.scrollTarget),c|=this.updateForViewport()),(c&2||L)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(l?[]:this.lineGaps,t)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,o=this.heightOracle,{visibleTop:l,visibleBottom:h}=this,f=new xo(n.lineAt(l-i*1e3,Pt.ByHeight,o,0,0).from,n.lineAt(h+(1-i)*1e3,Pt.ByHeight,o,0,0).to);if(e){let{head:c}=e.range;if(c<f.from||c>f.to){let d=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),g=n.lineAt(c,Pt.ByPos,o,0,0),m;e.y=="center"?m=(g.top+g.bottom)/2-d/2:e.y=="start"||e.y=="nearest"&&c<f.from?m=g.top:m=g.bottom-d,f=new xo(n.lineAt(m-1e3/2,Pt.ByHeight,o,0,0).from,n.lineAt(m+d+1e3/2,Pt.ByHeight,o,0,0).to)}}return f}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new xo(this.heightMap.lineAt(i,Pt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,Pt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,Pt.ByPos,this.heightOracle,0,0),{bottom:o}=this.heightMap.lineAt(e,Pt.ByPos,this.heightOracle,0,0),{visibleTop:l,visibleBottom:h}=this;return(t==0||n<=l-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||o>=h+Math.max(10,Math.min(i,250)))&&n>l-2*1e3&&o<h+2*1e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new qa(e.mapPos(n.from),e.mapPos(n.to),n.size,n.displaySize));return i}ensureLineGaps(t,e){let i=this.heightOracle.lineWrapping,n=i?1e4:2e3,o=n>>1,l=n<<1;if(this.defaultTextDirection!=Ht.LTR&&!i)return[];let h=[],f=(d,g,m,w)=>{if(g-d<o)return;let b=this.state.selection.main,S=[b.from];b.empty||S.push(b.to);for(let P of S)if(P>d&&P<g){f(d,P-10,m,w),f(P+10,g,m,w);return}let C=Zk(t,P=>P.from>=m.from&&P.to<=m.to&&Math.abs(P.from-d)<o&&Math.abs(P.to-g)<o&&!S.some(B=>P.from<B&&P.to>B));if(!C){if(g<m.to&&e&&i&&e.visibleRanges.some(L=>L.from<=g&&L.to>=g)){let L=e.moveToLineBoundary(z.cursor(g),!1,!0).head;L>d&&(g=L)}let P=this.gapSize(m,d,g,w),B=i||P<2e6?P:2e6;C=new qa(d,g,P,B)}h.push(C)},c=d=>{if(d.length<l||d.type!=Si.Text)return;let g=Gk(d.from,d.to,this.stateDeco);if(g.total<l)return;let m=this.scrollTarget?this.scrollTarget.range.head:null,w,b;if(i){let S=n/this.heightOracle.lineLength*this.heightOracle.lineHeight,C,P;if(m!=null){let B=Oo(g,m),L=((this.visibleBottom-this.visibleTop)/2+S)/d.height;C=B-L,P=B+L}else C=(this.visibleTop-d.top-S)/d.height,P=(this.visibleBottom-d.top+S)/d.height;w=bo(g,C),b=bo(g,P)}else{let S=g.total*this.heightOracle.charWidth,C=n*this.heightOracle.charWidth,P=0;if(S>2e6)for(let W of t)W.from>=d.from&&W.from<d.to&&W.size!=W.displaySize&&W.from*this.heightOracle.charWidth+P<this.pixelViewport.left&&(P=W.size-W.displaySize);let B=this.pixelViewport.left+P,L=this.pixelViewport.right+P,_,$;if(m!=null){let W=Oo(g,m),F=((L-B)/2+C)/S;_=W-F,$=W+F}else _=(B-C)/S,$=(L+C)/S;w=bo(g,_),b=bo(g,$)}w>d.from&&f(d.from,w,d,g),b<d.to&&f(b,d.to,d,g)};for(let d of this.viewportLines)Array.isArray(d.type)?d.type.forEach(c):c(d);return h}gapSize(t,e,i,n){let o=Oo(n,i)-Oo(n,e);return this.heightOracle.lineWrapping?t.height*o:n.total*this.heightOracle.charWidth*o}updateLineGaps(t){qa.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=yt.set(t.map(e=>e.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(t){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let i=[];At.spans(e,this.viewport.from,this.viewport.to,{span(o,l){i.push({from:o,to:l})},point(){}},20);let n=0;if(i.length!=this.visibleRanges.length)n=12;else for(let o=0;o<i.length&&!(n&8);o++){let l=this.visibleRanges[o],h=i[o];(l.from!=h.from||l.to!=h.to)&&(n|=4,t&&t.mapPos(l.from,-1)==h.from&&t.mapPos(l.to,1)==h.to||(n|=8))}return this.visibleRanges=i,n}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(e=>e.from<=t&&e.to>=t)||Ur(this.heightMap.lineAt(t,Pt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(e=>e.top<=t&&e.bottom>=t)||Ur(this.heightMap.lineAt(this.scaler.fromDOM(t),Pt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let e=this.lineBlockAtHeight(t+8);return e.from>=this.viewport.from||this.viewportLines[0].top-t>200?e:this.viewportLines[0]}elementAtHeight(t){return Ur(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class xo{constructor(t,e){this.from=t,this.to=e}}function Gk(r,t,e){let i=[],n=r,o=0;return At.spans(e,r,t,{span(){},point(l,h){l>n&&(i.push({from:n,to:l}),o+=l-n),n=h}},20),n<t&&(i.push({from:n,to:t}),o+=t-n),{total:o,ranges:i}}function bo({total:r,ranges:t},e){if(e<=0)return t[0].from;if(e>=1)return t[t.length-1].to;let i=Math.floor(r*e);for(let n=0;;n++){let{from:o,to:l}=t[n],h=l-o;if(i<=h)return o+i;i-=h}}function Oo(r,t){let e=0;for(let{from:i,to:n}of r.ranges){if(t<=n){e+=t-i;break}e+=n-i}return e/r.total}function Zk(r,t){for(let e of r)if(t(e))return e}const Yd={toDOM(r){return r},fromDOM(r){return r},scale:1,eq(r){return r==this}};class af{constructor(t,e,i){let n=0,o=0,l=0;this.viewports=i.map(({from:h,to:f})=>{let c=e.lineAt(h,Pt.ByPos,t,0,0).top,d=e.lineAt(f,Pt.ByPos,t,0,0).bottom;return n+=d-c,{from:h,to:f,top:c,bottom:d,domTop:0,domBottom:0}}),this.scale=(7e6-n)/(e.height-n);for(let h of this.viewports)h.domTop=l+(h.top-o)*this.scale,l=h.domBottom=h.domTop+(h.bottom-h.top),o=h.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let o=e<this.viewports.length?this.viewports[e]:null;if(!o||t<o.top)return n+(t-i)*this.scale;if(t<=o.bottom)return o.domTop+(t-o.top);i=o.bottom,n=o.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let o=e<this.viewports.length?this.viewports[e]:null;if(!o||t<o.domTop)return i+(t-n)/this.scale;if(t<=o.domBottom)return o.top+(t-o.domTop);i=o.bottom,n=o.domBottom}}eq(t){return t instanceof af?this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every((e,i)=>e.from==t.viewports[i].from&&e.to==t.viewports[i].to):!1}}function Ur(r,t){if(t.scale==1)return r;let e=t.toDOM(r.top),i=t.toDOM(r.bottom);return new yi(r.from,r.length,e,i-e,Array.isArray(r._content)?r._content.map(n=>Ur(n,t)):r._content)}const So=Y.define({combine:r=>r.join(" ")}),Eh=Y.define({combine:r=>r.indexOf(!0)>-1}),Dh=hn.newName(),om=hn.newName(),lm=hn.newName(),am={"&light":"."+om,"&dark":"."+lm};function Ih(r,t,e){return new hn(t,{finish(i){return/&/.test(i)?i.replace(/&\w*/,n=>{if(n=="&")return r;if(!e||!e[n])throw new RangeError(`Unsupported selector: ${n}`);return e[n]}):r+" "+i}})}const jk=Ih("."+Dh,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},am),Jk={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Ua=q.ie&&q.ie_version<=11;class tC{constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new DS,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver(e=>{for(let i of e)this.queue.push(i);(q.ie&&q.ie_version<=11||q.ios&&t.composing)&&e.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&t.constructor.EDIT_CONTEXT!==!1&&!(q.chrome&&q.chrome_version<126)&&(this.editContext=new iC(t),t.state.facet(Fi)&&(t.contentDOM.editContext=this.editContext.editContext)),Ua&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var e;((e=this.view.docView)===null||e===void 0?void 0:e.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(e=>{e.length>0&&e[e.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(t){(t.type=="change"||!t.type)&&!t.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some((e,i)=>e!=t[i]))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,n=this.selectionRange;if(i.state.facet(Fi)?i.root.activeElement!=this.dom:!No(this.dom,n))return;let o=n.anchorNode&&i.docView.nearest(n.anchorNode);if(o&&o.ignoreEvent(t)){e||(this.selectionChanged=!1);return}(q.ie&&q.ie_version<=11||q.android&&q.chrome)&&!i.state.selection.main.empty&&n.focusNode&&jr(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=os(t.root);if(!e)return!1;let i=q.safari&&t.root.nodeType==11&&t.root.activeElement==this.dom&&eC(this.view,e)||e;if(!i||this.selectionRange.eq(i))return!1;let n=No(this.dom,i);return n&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&BS(this.dom,i)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(i),n&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(i.nodeType==1)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=e)i.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Jk),Ua&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Ua&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var i;if(!this.delayedAndroidKey){let n=()=>{let o=this.delayedAndroidKey;o&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=o.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&o.force&&jn(this.dom,o.key,o.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(n)}(!this.delayedAndroidKey||t=="Enter")&&(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let o of t){let l=this.readMutation(o);l&&(l.typeOver&&(n=!0),e==-1?{from:e,to:i}=l:(e=Math.min(l.from,e),i=Math.max(l.to,i)))}return{from:e,to:i,typeOver:n}}readChange(){let{from:t,to:e,typeOver:i}=this.processRecords(),n=this.selectionChanged&&No(this.dom,this.selectionRange);if(t<0&&!n)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let o=new wk(this.view,t,e,i);return this.view.docView.domChanged={newSel:o.newSel?o.newSel.main:null},o}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return this.view.requestMeasure(),!1;let i=this.view.state,n=Gg(this.view,e);return this.view.state==i&&(e.domChanged||e.newSel&&!e.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),n}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty(t.type=="attributes"),t.type=="attributes"&&(e.flags|=4),t.type=="childList"){let i=Xd(e,t.previousSibling||t.target.previousSibling,-1),n=Xd(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}else return t.type=="characterData"?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(Fi)!=t.state.facet(Fi)&&(t.view.contentDOM.editContext=t.state.facet(Fi)?this.editContext.editContext:null))}destroy(){var t,e,i;this.stop(),(t=this.intersection)===null||t===void 0||t.disconnect(),(e=this.gapIntersection)===null||e===void 0||e.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function Xd(r,t,e){for(;t;){let i=kt.get(t);if(i&&i.parent==r)return i;let n=t.parentNode;t=n!=r.dom?n:e>0?t.nextSibling:t.previousSibling}return null}function Kd(r,t){let e=t.startContainer,i=t.startOffset,n=t.endContainer,o=t.endOffset,l=r.docView.domAtPos(r.state.selection.main.anchor);return jr(l.node,l.offset,n,o)&&([e,i,n,o]=[n,o,e,i]),{anchorNode:e,anchorOffset:i,focusNode:n,focusOffset:o}}function eC(r,t){if(t.getComposedRanges){let n=t.getComposedRanges(r.root)[0];if(n)return Kd(r,n)}let e=null;function i(n){n.preventDefault(),n.stopImmediatePropagation(),e=n.getTargetRanges()[0]}return r.contentDOM.addEventListener("beforeinput",i,!0),r.dom.ownerDocument.execCommand("indent"),r.contentDOM.removeEventListener("beforeinput",i,!0),e?Kd(r,e):null}class iC{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(t.state);let e=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=i=>{let n=t.state.selection.main,{anchor:o,head:l}=n,h=this.toEditorPos(i.updateRangeStart),f=this.toEditorPos(i.updateRangeEnd);t.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:i.updateRangeStart,editorBase:h,drifted:!1});let c={from:h,to:f,insert:pt.of(i.text.split(`
`))};if(c.from==this.from&&o<this.from?c.from=o:c.to==this.to&&o>this.to&&(c.to=o),c.from==c.to&&!c.insert.length){let d=z.single(this.toEditorPos(i.selectionStart),this.toEditorPos(i.selectionEnd));d.main.eq(n)||t.dispatch({selection:d,userEvent:"select"});return}if((q.mac||q.android)&&c.from==l-1&&/^\. ?$/.test(i.text)&&t.contentDOM.getAttribute("autocorrect")=="off"&&(c={from:h,to:f,insert:pt.of([i.text.replace("."," ")])}),this.pendingContextChange=c,!t.state.readOnly){let d=this.to-this.from+(c.to-c.from+c.insert.length);of(t,c,z.single(this.toEditorPos(i.selectionStart,d),this.toEditorPos(i.selectionEnd,d)))}this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state))},this.handlers.characterboundsupdate=i=>{let n=[],o=null;for(let l=this.toEditorPos(i.rangeStart),h=this.toEditorPos(i.rangeEnd);l<h;l++){let f=t.coordsForChar(l);o=f&&new DOMRect(f.left,f.top,f.right-f.left,f.bottom-f.top)||o||new DOMRect,n.push(o)}e.updateCharacterBounds(i.rangeStart,n)},this.handlers.textformatupdate=i=>{let n=[];for(let o of i.getTextFormats()){let l=o.underlineStyle,h=o.underlineThickness;if(l!="None"&&h!="None"){let f=this.toEditorPos(o.rangeStart),c=this.toEditorPos(o.rangeEnd);if(f<c){let d=`text-decoration: underline ${l=="Dashed"?"dashed ":l=="Squiggle"?"wavy ":""}${h=="Thin"?1:2}px`;n.push(yt.mark({attributes:{style:d}}).range(f,c))}}}t.dispatch({effects:zg.of(yt.set(n))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(t.inputState.composing=-1,t.inputState.compositionFirstChange=null,this.composing){let{drifted:i}=this.composing;this.composing=null,i&&this.reset(t.state)}};for(let i in this.handlers)e.addEventListener(i,this.handlers[i]);this.measureReq={read:i=>{this.editContext.updateControlBounds(i.contentDOM.getBoundingClientRect());let n=os(i.root);n&&n.rangeCount&&this.editContext.updateSelectionBounds(n.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let e=0,i=!1,n=this.pendingContextChange;return t.changes.iterChanges((o,l,h,f,c)=>{if(i)return;let d=c.length-(l-o);if(n&&l>=n.to)if(n.from==o&&n.to==l&&n.insert.eq(c)){n=this.pendingContextChange=null,e+=d,this.to+=d;return}else n=null,this.revertPending(t.state);if(o+=e,l+=e,l<=this.from)this.from+=d,this.to+=d;else if(o<this.to){if(o<this.from||l>this.to||this.to-this.from+c.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(o),this.toContextPos(l),c.toString()),this.to+=d}e+=d}),n&&!i&&this.revertPending(t.state),!i}update(t){let e=this.pendingContextChange,i=t.startState.selection.main;this.composing&&(this.composing.drifted||!t.changes.touchesRange(i.from,i.to)&&t.transactions.some(n=>!n.isUserEvent("input.type")&&n.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=t.changes.mapPos(this.composing.editorBase)):!this.applyEdits(t)||!this.rangeIsValid(t.state)?(this.pendingContextChange=null,this.reset(t.state)):(t.docChanged||t.selectionSet||e)&&this.setSelection(t.state),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:e}=t.selection.main;this.from=Math.max(0,e-1e4),this.to=Math.min(t.doc.length,e+1e4)}reset(t){this.resetRange(t),this.editContext.updateText(0,this.editContext.text.length,t.doc.sliceString(this.from,this.to)),this.setSelection(t)}revertPending(t){let e=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(e.from),this.toContextPos(e.from+e.insert.length),t.doc.sliceString(e.from,e.to))}setSelection(t){let{main:e}=t.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,e.anchor))),n=this.toContextPos(e.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=n)&&this.editContext.updateSelection(i,n)}rangeIsValid(t){let{head:e}=t.selection.main;return!(this.from>0&&e-this.from<500||this.to<t.doc.length&&this.to-e<500||this.to-this.from>1e4*3)}toEditorPos(t,e=this.to-this.from){t=Math.min(t,e);let i=this.composing;return i&&i.drifted?i.editorBase+(t-i.contextBase):t+this.from}toContextPos(t){let e=this.composing;return e&&e.drifted?e.contextBase+(t-e.editorBase):t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class Z{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var e;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:i}=t;this.dispatchTransactions=t.dispatchTransactions||i&&(n=>n.forEach(o=>i(o,this)))||(n=>this.update(n)),this.dispatch=this.dispatch.bind(this),this._root=t.root||IS(t.parent)||document,this.viewState=new Qd(t.state||mt.create(t)),t.scrollTo&&t.scrollTo.is(yo)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Hr).map(n=>new Va(n));for(let n of this.plugins)n.update(this);this.observer=new tC(this),this.inputState=new Sk(this),this.inputState.ensureHandlers(this.plugins),this.docView=new Td(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((e=document.fonts)===null||e===void 0)&&e.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...t){let e=t.length==1&&t[0]instanceof Qt?t:t.length==1&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(e,this)}update(t){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e=!1,i=!1,n,o=this.state;for(let m of t){if(m.startState!=o)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");o=m.state}if(this.destroyed){this.viewState.state=o;return}let l=this.hasFocus,h=0,f=null;t.some(m=>m.annotation(im))?(this.inputState.notifiedFocused=l,h=1):l!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=l,f=nm(o,l),f||(h=1));let c=this.observer.delayedAndroidKey,d=null;if(c?(this.observer.clearDelayedAndroidKey(),d=this.observer.readChange(),(d&&!this.state.doc.eq(o.doc)||!this.state.selection.eq(o.selection))&&(d=null)):this.observer.clear(),o.facet(mt.phrases)!=this.state.facet(mt.phrases))return this.setState(o);n=Xo.create(this,o,t),n.flags|=h;let g=this.viewState.scrollTarget;try{this.updateState=2;for(let m of t){if(g&&(g=g.map(m.changes)),m.scrollIntoView){let{main:w}=m.state.selection;g=new Jn(w.empty?w:z.cursor(w.head,w.head>w.anchor?-1:1))}for(let w of m.effects)w.is(yo)&&(g=w.value.clip(this.state))}this.viewState.update(n,g),this.bidiCache=Go.update(this.bidiCache,n.changes),n.empty||(this.updatePlugins(n),this.inputState.update(n)),e=this.docView.update(n),this.state.facet(zr)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(e,t.some(m=>m.isUserEvent("select.pointer")))}finally{this.updateState=0}if(n.startState.facet(So)!=n.state.facet(So)&&(this.viewState.mustMeasureContent=!0),(e||i||g||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),e&&this.docViewUpdate(),!n.empty)for(let m of this.state.facet(Mh))try{m(n)}catch(w){ae(this.state,w,"update listener")}(f||d)&&Promise.resolve().then(()=>{f&&this.state==f.startState&&this.dispatch(f),d&&!Gg(this,d)&&c.force&&jn(this.contentDOM,c.key,c.keyCode)})}setState(t){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=t;return}this.updateState=2;let e=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new Qd(t),this.plugins=t.facet(Hr).map(i=>new Va(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new Td(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(Hr),i=t.state.facet(Hr);if(e!=i){let n=[];for(let o of i){let l=e.indexOf(o);if(l<0)n.push(new Va(o));else{let h=this.plugins[l];h.mustUpdate=t,n.push(h)}}for(let o of this.plugins)o.mustUpdate!=t&&o.destroy(this);this.plugins=n,this.pluginMap.clear()}else for(let n of this.plugins)n.mustUpdate=t;for(let n=0;n<this.plugins.length;n++)this.plugins[n].update(this);e!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let e=t.value;if(e&&e.docViewUpdate)try{e.docViewUpdate(this)}catch(i){ae(this.state,i,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,i=this.scrollDOM,n=i.scrollTop*this.scaleY,{scrollAnchorPos:o,scrollAnchorHeight:l}=this.viewState;Math.abs(n-this.viewState.scrollTop)>1&&(l=-1),this.viewState.scrollAnchorHeight=-1;try{for(let h=0;;h++){if(l<0)if(wg(i))o=-1,l=this.viewState.heightMap.height;else{let w=this.viewState.scrollAnchorAt(n);o=w.from,l=w.top}this.updateState=1;let f=this.viewState.measure(this);if(!f&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(h>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];f&4||([this.measureRequests,c]=[c,this.measureRequests]);let d=c.map(w=>{try{return w.read(this)}catch(b){return ae(this.state,b),Gd}}),g=Xo.create(this,this.state,[]),m=!1;g.flags|=f,e?e.flags|=f:e=g,this.updateState=2,g.empty||(this.updatePlugins(g),this.inputState.update(g),this.updateAttrs(),m=this.docView.update(g),m&&this.docViewUpdate());for(let w=0;w<c.length;w++)if(d[w]!=Gd)try{let b=c[w];b.write&&b.write(d[w],this)}catch(b){ae(this.state,b)}if(m&&this.docView.updateSelection(!0),!g.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,l=-1;continue}else{let b=(o<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(o).top)-l;if(b>1||b<-1){n=n+b,i.scrollTop=n/this.scaleY,l=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let h of this.state.facet(Mh))h(e)}get themeClasses(){return Dh+" "+(this.state.facet(Eh)?lm:om)+" "+this.state.facet(So)}updateAttrs(){let t=Zd(this,qg,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Fi)?"true":"false",class:"cm-content",style:`${q.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),Zd(this,nf,e);let i=this.observer.ignore(()=>{let n=kh(this.contentDOM,this.contentAttrs,e),o=kh(this.dom,this.editorAttrs,t);return n||o});return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let n of i.effects)if(n.is(Z.announce)){e&&(this.announceDOM.textContent=""),e=!1;let o=this.announceDOM.appendChild(document.createElement("div"));o.textContent=n.value}}mountStyles(){this.styleModules=this.state.facet(zr);let t=this.state.facet(Z.cspNonce);hn.mount(this.root,this.styleModules.concat(jk).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t){if(this.measureRequests.indexOf(t)>-1)return;if(t.key!=null){for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key){this.measureRequests[e]=t;return}}this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(e===void 0||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find(i=>i.spec==t)||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return za(this,t,Ed(this,t,e,i))}moveByGroup(t,e){return za(this,t,Ed(this,t,e,i=>pk(this,t.head,i)))}visualLineSide(t,e){let i=this.bidiSpans(t),n=this.textDirectionAt(t.from),o=i[e?i.length-1:0];return z.cursor(o.side(e,n)+t.from,o.forward(!e,n)?1:-1)}moveToLineBoundary(t,e,i=!0){return dk(this,t,e,i)}moveVertically(t,e,i){return za(this,t,gk(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),Kg(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),o=this.bidiSpans(n),l=o[ln.find(o,t-n.from,-1,e)];return ds(i,l.dir==Ht.LTR==e>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(Vg)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>nC)return Dg(t.length);let e=this.textDirectionAt(t.from),i;for(let o of this.bidiCache)if(o.from==t.from&&o.dir==e&&(o.fresh||Eg(o.isolates,i=Ad(this,t))))return o.order;i||(i=Ad(this,t));let n=KS(t.text,e,i);return this.bidiCache.push(new Go(t.from,t.to,e,i,!0,n)),n}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||q.safari&&((t=this.inputState)===null||t===void 0?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{mg(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((t.nodeType==9?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return yo.of(new Jn(typeof t=="number"?z.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:e}=this.scrollDOM,i=this.viewState.scrollAnchorAt(t);return yo.of(new Jn(z.cursor(i.from),"start","start",i.top-t,e,!0))}setTabFocusMode(t){t==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof t=="boolean"?this.inputState.tabFocusMode=t?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return _e.define(()=>({}),{eventHandlers:t})}static domEventObservers(t){return _e.define(()=>({}),{eventObservers:t})}static theme(t,e){let i=hn.newName(),n=[So.of(i),zr.of(Ih(`.${i}`,t))];return e&&e.dark&&n.push(Eh.of(!0)),n}static baseTheme(t){return cs.lowest(zr.of(Ih("."+Dh,t,am)))}static findFromDOM(t){var e;let i=t.querySelector(".cm-content"),n=i&&kt.get(i)||kt.get(t);return((e=n?.rootView)===null||e===void 0?void 0:e.view)||null}}Z.styleModule=zr;Z.inputHandler=Wg;Z.clipboardInputFilter=tf;Z.clipboardOutputFilter=ef;Z.scrollHandler=Hg;Z.focusChangeEffect=Fg;Z.perLineTextDirection=Vg;Z.exceptionSink=$g;Z.updateListener=Mh;Z.editable=Fi;Z.mouseSelectionStyle=Ng;Z.dragMovesSelection=Lg;Z.clickAddsSelectionRange=Bg;Z.decorations=ls;Z.outerDecorations=Ug;Z.atomicRanges=rf;Z.bidiIsolatedRanges=Qg;Z.scrollMargins=Yg;Z.darkTheme=Eh;Z.cspNonce=Y.define({combine:r=>r.length?r[0]:""});Z.contentAttributes=nf;Z.editorAttributes=qg;Z.lineWrapping=Z.contentAttributes.of({class:"cm-lineWrapping"});Z.announce=ct.define();const nC=4096,Gd={};class Go{constructor(t,e,i,n,o,l){this.from=t,this.to=e,this.dir=i,this.isolates=n,this.fresh=o,this.order=l}static update(t,e){if(e.empty&&!t.some(o=>o.fresh))return t;let i=[],n=t.length?t[t.length-1].dir:Ht.LTR;for(let o=Math.max(0,t.length-10);o<t.length;o++){let l=t[o];l.dir==n&&!e.touchesRange(l.from,l.to)&&i.push(new Go(e.mapPos(l.from,1),e.mapPos(l.to,-1),l.dir,l.isolates,!1,l.order))}return i}}function Zd(r,t,e){for(let i=r.state.facet(t),n=i.length-1;n>=0;n--){let o=i[n],l=typeof o=="function"?o(r):o;l&&Sh(l,e)}return e}const rC=q.mac?"mac":q.windows?"win":q.linux?"linux":"key";function sC(r,t){const e=r.split(/-(?!$)/);let i=e[e.length-1];i=="Space"&&(i=" ");let n,o,l,h;for(let f=0;f<e.length-1;++f){const c=e[f];if(/^(cmd|meta|m)$/i.test(c))h=!0;else if(/^a(lt)?$/i.test(c))n=!0;else if(/^(c|ctrl|control)$/i.test(c))o=!0;else if(/^s(hift)?$/i.test(c))l=!0;else if(/^mod$/i.test(c))t=="mac"?h=!0:o=!0;else throw new Error("Unrecognized modifier name: "+c)}return n&&(i="Alt-"+i),o&&(i="Ctrl-"+i),h&&(i="Meta-"+i),l&&(i="Shift-"+i),i}function ko(r,t,e){return t.altKey&&(r="Alt-"+r),t.ctrlKey&&(r="Ctrl-"+r),t.metaKey&&(r="Meta-"+r),e!==!1&&t.shiftKey&&(r="Shift-"+r),r}const oC=cs.default(Z.domEventHandlers({keydown(r,t){return fC(lC(t.state),r,t,"editor")}})),hf=Y.define({enables:oC}),jd=new WeakMap;function lC(r){let t=r.facet(hf),e=jd.get(t);return e||jd.set(t,e=hC(t.reduce((i,n)=>i.concat(n),[]))),e}let nn=null;const aC=4e3;function hC(r,t=rC){let e=Object.create(null),i=Object.create(null),n=(l,h)=>{let f=i[l];if(f==null)i[l]=h;else if(f!=h)throw new Error("Key binding "+l+" is used both as a regular binding and as a multi-stroke prefix")},o=(l,h,f,c,d)=>{var g,m;let w=e[l]||(e[l]=Object.create(null)),b=h.split(/ (?!$)/).map(P=>sC(P,t));for(let P=1;P<b.length;P++){let B=b.slice(0,P).join(" ");n(B,!0),w[B]||(w[B]={preventDefault:!0,stopPropagation:!1,run:[L=>{let _=nn={view:L,prefix:B,scope:l};return setTimeout(()=>{nn==_&&(nn=null)},aC),!0}]})}let S=b.join(" ");n(S,!1);let C=w[S]||(w[S]={preventDefault:!1,stopPropagation:!1,run:((m=(g=w._any)===null||g===void 0?void 0:g.run)===null||m===void 0?void 0:m.slice())||[]});f&&C.run.push(f),c&&(C.preventDefault=!0),d&&(C.stopPropagation=!0)};for(let l of r){let h=l.scope?l.scope.split(" "):["editor"];if(l.any)for(let c of h){let d=e[c]||(e[c]=Object.create(null));d._any||(d._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:g}=l;for(let m in d)d[m].run.push(w=>g(w,Bh))}let f=l[t]||l.key;if(f)for(let c of h)o(c,f,l.run,l.preventDefault,l.stopPropagation),l.shift&&o(c,"Shift-"+f,l.shift,l.preventDefault,l.stopPropagation)}return e}let Bh=null;function fC(r,t,e,i){Bh=t;let n=MS(t),o=Ve(n,0),l=Wi(o)==n.length&&n!=" ",h="",f=!1,c=!1,d=!1;nn&&nn.view==e&&nn.scope==i&&(h=nn.prefix+" ",jg.indexOf(t.keyCode)<0&&(c=!0,nn=null));let g=new Set,m=C=>{if(C){for(let P of C.run)if(!g.has(P)&&(g.add(P),P(e)))return C.stopPropagation&&(d=!0),!0;C.preventDefault&&(C.stopPropagation&&(d=!0),c=!0)}return!1},w=r[i],b,S;return w&&(m(w[h+ko(n,t,!l)])?f=!0:l&&(t.altKey||t.metaKey||t.ctrlKey)&&!(q.windows&&t.ctrlKey&&t.altKey)&&(b=fn[t.keyCode])&&b!=n?(m(w[h+ko(b,t,!0)])||t.shiftKey&&(S=ss[t.keyCode])!=n&&S!=b&&m(w[h+ko(S,t,!1)]))&&(f=!0):l&&t.shiftKey&&m(w[h+ko(n,t,!0)])&&(f=!0),!f&&m(w._any)&&(f=!0)),c&&(f=!0),f&&d&&t.stopPropagation(),Bh=null,f}class uC extends ps{constructor(t){super(),this.content=t}toDOM(t){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(t):this.content.cloneNode(!0)),typeof this.content=="string"?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}coordsAt(t){let e=t.firstChild?or(t.firstChild):[];if(!e.length)return null;let i=window.getComputedStyle(t.parentNode),n=ds(e[0],i.direction!="rtl"),o=parseInt(i.lineHeight);return n.bottom-n.top>o*1.5?{left:n.left,right:n.right,top:n.top,bottom:n.top+o}:n}ignoreEvent(){return!1}}function Jd(r){return _e.fromClass(class{constructor(t){this.view=t,this.placeholder=r?yt.set([yt.widget({widget:new uC(r),side:1}).range(0)]):yt.none}get decorations(){return this.view.state.doc.length?yt.none:this.placeholder}},{decorations:t=>t.decorations})}const Wr="-10000px";class hm{constructor(t,e,i,n){this.facet=e,this.createTooltipView=i,this.removeTooltipView=n,this.input=t.state.facet(e),this.tooltips=this.input.filter(l=>l);let o=null;this.tooltipViews=this.tooltips.map(l=>o=i(l,o))}update(t,e){var i;let n=t.state.facet(this.facet),o=n.filter(f=>f);if(n===this.input){for(let f of this.tooltipViews)f.update&&f.update(t);return!1}let l=[],h=e?[]:null;for(let f=0;f<o.length;f++){let c=o[f],d=-1;if(c){for(let g=0;g<this.tooltips.length;g++){let m=this.tooltips[g];m&&m.create==c.create&&(d=g)}if(d<0)l[f]=this.createTooltipView(c,f?l[f-1]:null),h&&(h[f]=!!c.above);else{let g=l[f]=this.tooltipViews[d];h&&(h[f]=e[d]),g.update&&g.update(t)}}}for(let f of this.tooltipViews)l.indexOf(f)<0&&(this.removeTooltipView(f),(i=f.destroy)===null||i===void 0||i.call(f));return e&&(h.forEach((f,c)=>e[c]=f),e.length=h.length),this.input=n,this.tooltips=o,this.tooltipViews=l,!0}}function cC(r){let t=r.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:t.clientHeight,right:t.clientWidth}}const Qa=Y.define({combine:r=>{var t,e,i;return{position:q.ios?"absolute":((t=r.find(n=>n.position))===null||t===void 0?void 0:t.position)||"fixed",parent:((e=r.find(n=>n.parent))===null||e===void 0?void 0:e.parent)||null,tooltipSpace:((i=r.find(n=>n.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||cC}}}),tp=new WeakMap,ff=_e.fromClass(class{constructor(r){this.view=r,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let t=r.state.facet(Qa);this.position=t.position,this.parent=t.parent,this.classes=r.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new hm(r,uf,(e,i)=>this.createTooltip(e,i),e=>{this.resizeObserver&&this.resizeObserver.unobserve(e.dom),e.dom.remove()}),this.above=this.manager.tooltips.map(e=>!!e.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(e=>{Date.now()>this.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),r.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let r of this.manager.tooltipViews)this.intersectionObserver.observe(r.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(r){r.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(r,this.above);t&&this.observeIntersection();let e=t||r.geometryChanged,i=r.state.facet(Qa);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let n of this.manager.tooltipViews)n.dom.style.position=this.position;e=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let n of this.manager.tooltipViews)this.container.appendChild(n.dom);e=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);e&&this.maybeMeasure()}createTooltip(r,t){let e=r.create(this.view),i=t?t.dom:null;if(e.dom.classList.add("cm-tooltip"),r.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let n=document.createElement("div");n.className="cm-tooltip-arrow",e.dom.appendChild(n)}return e.dom.style.position=this.position,e.dom.style.top=Wr,e.dom.style.left="0px",this.container.insertBefore(e.dom,i),e.mount&&e.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(e.dom),e}destroy(){var r,t,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),(r=i.destroy)===null||r===void 0||r.call(i);this.parent&&this.container.remove(),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let r=1,t=1,e=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:o}=this.manager.tooltipViews[0];if(q.gecko)e=o.offsetParent!=this.container.ownerDocument.body;else if(o.style.top==Wr&&o.style.left=="0px"){let l=o.getBoundingClientRect();e=Math.abs(l.top+1e4)>1||Math.abs(l.left)>1}}if(e||this.position=="absolute")if(this.parent){let o=this.parent.getBoundingClientRect();o.width&&o.height&&(r=o.width/this.parent.offsetWidth,t=o.height/this.parent.offsetHeight)}else({scaleX:r,scaleY:t}=this.view.viewState);let i=this.view.scrollDOM.getBoundingClientRect(),n=sf(this.view);return{visible:{left:i.left+n.left,top:i.top+n.top,right:i.right-n.right,bottom:i.bottom-n.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((o,l)=>{let h=this.manager.tooltipViews[l];return h.getCoords?h.getCoords(o.pos):this.view.coordsAtPos(o.pos)}),size:this.manager.tooltipViews.map(({dom:o})=>o.getBoundingClientRect()),space:this.view.state.facet(Qa).tooltipSpace(this.view),scaleX:r,scaleY:t,makeAbsolute:e}}writeMeasure(r){var t;if(r.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let h of this.manager.tooltipViews)h.dom.style.position="absolute"}let{visible:e,space:i,scaleX:n,scaleY:o}=r,l=[];for(let h=0;h<this.manager.tooltips.length;h++){let f=this.manager.tooltips[h],c=this.manager.tooltipViews[h],{dom:d}=c,g=r.pos[h],m=r.size[h];if(!g||f.clip!==!1&&(g.bottom<=Math.max(e.top,i.top)||g.top>=Math.min(e.bottom,i.bottom)||g.right<Math.max(e.left,i.left)-.1||g.left>Math.min(e.right,i.right)+.1)){d.style.top=Wr;continue}let w=f.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,b=w?7:0,S=m.right-m.left,C=(t=tp.get(c))!==null&&t!==void 0?t:m.bottom-m.top,P=c.offset||pC,B=this.view.textDirection==Ht.LTR,L=m.width>i.right-i.left?B?i.left:i.right-m.width:B?Math.max(i.left,Math.min(g.left-(w?14:0)+P.x,i.right-S)):Math.min(Math.max(i.left,g.left-S+(w?14:0)-P.x),i.right-S),_=this.above[h];!f.strictSide&&(_?g.top-C-b-P.y<i.top:g.bottom+C+b+P.y>i.bottom)&&_==i.bottom-g.bottom>g.top-i.top&&(_=this.above[h]=!_);let $=(_?g.top-i.top:i.bottom-g.bottom)-b;if($<C&&c.resize!==!1){if($<this.view.defaultLineHeight){d.style.top=Wr;continue}tp.set(c,C),d.style.height=(C=$)/o+"px"}else d.style.height&&(d.style.height="");let W=_?g.top-C-b-P.y:g.bottom+b+P.y,F=L+S;if(c.overlap!==!0)for(let J of l)J.left<F&&J.right>L&&J.top<W+C&&J.bottom>W&&(W=_?J.top-C-2-b:J.bottom+b+2);if(this.position=="absolute"?(d.style.top=(W-r.parent.top)/o+"px",ep(d,(L-r.parent.left)/n)):(d.style.top=W/o+"px",ep(d,L/n)),w){let J=g.left+(B?P.x:-P.x)-(L+14-7);w.style.left=J/n+"px"}c.overlap!==!0&&l.push({left:L,top:W,right:F,bottom:W+C}),d.classList.toggle("cm-tooltip-above",_),d.classList.toggle("cm-tooltip-below",!_),c.positioned&&c.positioned(r.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let r of this.manager.tooltipViews)r.dom.style.top=Wr}},{eventObservers:{scroll(){this.maybeMeasure()}}});function ep(r,t){let e=parseInt(r.style.left,10);(isNaN(e)||Math.abs(t-e)>1)&&(r.style.left=t+"px")}const dC=Z.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),pC={x:0,y:0},uf=Y.define({enables:[ff,dC]}),Zo=Y.define({combine:r=>r.reduce((t,e)=>t.concat(e),[])});class dl{static create(t){return new dl(t)}constructor(t){this.view=t,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new hm(t,Zo,(e,i)=>this.createHostedView(e,i),e=>e.dom.remove())}createHostedView(t,e){let i=t.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(i.dom,e?e.dom.nextSibling:this.dom.firstChild),this.mounted&&i.mount&&i.mount(this.view),i}mount(t){for(let e of this.manager.tooltipViews)e.mount&&e.mount(t);this.mounted=!0}positioned(t){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned(t)}update(t){this.manager.update(t)}destroy(){var t;for(let e of this.manager.tooltipViews)(t=e.destroy)===null||t===void 0||t.call(e)}passProp(t){let e;for(let i of this.manager.tooltipViews){let n=i[t];if(n!==void 0){if(e===void 0)e=n;else if(e!==n)return}}return e}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const gC=uf.compute([Zo],r=>{let t=r.facet(Zo);return t.length===0?null:{pos:Math.min(...t.map(e=>e.pos)),end:Math.max(...t.map(e=>{var i;return(i=e.end)!==null&&i!==void 0?i:e.pos})),create:dl.create,above:t[0].above,arrow:t.some(e=>e.arrow)}});class mC{constructor(t,e,i,n,o){this.view=t,this.source=e,this.field=i,this.setHover=n,this.hoverTime=o,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:t.dom,time:0},this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let t=Date.now()-this.lastMove.time;t<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-t):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:t,lastMove:e}=this,i=t.docView.nearest(e.target);if(!i)return;let n,o=1;if(i instanceof on)n=i.posAtStart;else{if(n=t.posAtCoords(e),n==null)return;let h=t.coordsAtPos(n);if(!h||e.y<h.top||e.y>h.bottom||e.x<h.left-t.defaultCharacterWidth||e.x>h.right+t.defaultCharacterWidth)return;let f=t.bidiSpans(t.state.doc.lineAt(n)).find(d=>d.from<=n&&d.to>=n),c=f&&f.dir==Ht.RTL?-1:1;o=e.x<h.left?-c:c}let l=this.source(t,n,o);if(l?.then){let h=this.pending={pos:n};l.then(f=>{this.pending==h&&(this.pending=null,f&&!(Array.isArray(f)&&!f.length)&&t.dispatch({effects:this.setHover.of(Array.isArray(f)?f:[f])}))},f=>ae(t.state,f,"hover tooltip"))}else l&&!(Array.isArray(l)&&!l.length)&&t.dispatch({effects:this.setHover.of(Array.isArray(l)?l:[l])})}get tooltip(){let t=this.view.plugin(ff),e=t?t.manager.tooltips.findIndex(i=>i.create==dl.create):-1;return e>-1?t.manager.tooltipViews[e]:null}mousemove(t){var e,i;this.lastMove={x:t.clientX,y:t.clientY,target:t.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:n,tooltip:o}=this;if(n.length&&o&&!yC(o.dom,t)||this.pending){let{pos:l}=n[0]||this.pending,h=(i=(e=n[0])===null||e===void 0?void 0:e.end)!==null&&i!==void 0?i:l;(l==h?this.view.posAtCoords(this.lastMove)!=l:!wC(this.view,l,h,t.clientX,t.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(t){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:e}=this;if(e.length){let{tooltip:i}=this;i&&i.dom.contains(t.relatedTarget)?this.watchTooltipLeave(i.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(t){let e=i=>{t.removeEventListener("mouseleave",e),this.active.length&&!this.view.dom.contains(i.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};t.addEventListener("mouseleave",e)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Co=4;function yC(r,t){let{left:e,right:i,top:n,bottom:o}=r.getBoundingClientRect(),l;if(l=r.querySelector(".cm-tooltip-arrow")){let h=l.getBoundingClientRect();n=Math.min(h.top,n),o=Math.max(h.bottom,o)}return t.clientX>=e-Co&&t.clientX<=i+Co&&t.clientY>=n-Co&&t.clientY<=o+Co}function wC(r,t,e,i,n,o){let l=r.scrollDOM.getBoundingClientRect(),h=r.documentTop+r.documentPadding.top+r.contentHeight;if(l.left>i||l.right<i||l.top>n||Math.min(l.bottom,h)<n)return!1;let f=r.posAtCoords({x:i,y:n},!1);return f>=t&&f<=e}function fm(r,t={}){let e=ct.define(),i=be.define({create(){return[]},update(n,o){if(n.length&&(t.hideOnChange&&(o.docChanged||o.selection)?n=[]:t.hideOn&&(n=n.filter(l=>!t.hideOn(o,l))),o.docChanged)){let l=[];for(let h of n){let f=o.changes.mapPos(h.pos,-1,le.TrackDel);if(f!=null){let c=Object.assign(Object.create(null),h);c.pos=f,c.end!=null&&(c.end=o.changes.mapPos(c.end)),l.push(c)}}n=l}for(let l of o.effects)l.is(e)&&(n=l.value),l.is(vC)&&(n=[]);return n},provide:n=>Zo.from(n)});return{active:i,extension:[i,_e.define(n=>new mC(n,r,i,e,t.hoverTime||300)),gC]}}function um(r,t){let e=r.plugin(ff);if(!e)return null;let i=e.manager.tooltips.indexOf(t);return i<0?null:e.manager.tooltipViews[i]}const vC=ct.define(),ip=Y.define({combine(r){let t,e;for(let i of r)t=t||i.topContainer,e=e||i.bottomContainer;return{topContainer:t,bottomContainer:e}}}),xC=_e.fromClass(class{constructor(r){this.input=r.state.facet(Lh),this.specs=this.input.filter(e=>e),this.panels=this.specs.map(e=>e(r));let t=r.state.facet(ip);this.top=new Ao(r,!0,t.topContainer),this.bottom=new Ao(r,!1,t.bottomContainer),this.top.sync(this.panels.filter(e=>e.top)),this.bottom.sync(this.panels.filter(e=>!e.top));for(let e of this.panels)e.dom.classList.add("cm-panel"),e.mount&&e.mount()}update(r){let t=r.state.facet(ip);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new Ao(r.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new Ao(r.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let e=r.state.facet(Lh);if(e!=this.input){let i=e.filter(f=>f),n=[],o=[],l=[],h=[];for(let f of i){let c=this.specs.indexOf(f),d;c<0?(d=f(r.view),h.push(d)):(d=this.panels[c],d.update&&d.update(r)),n.push(d),(d.top?o:l).push(d)}this.specs=i,this.panels=n,this.top.sync(o),this.bottom.sync(l);for(let f of h)f.dom.classList.add("cm-panel"),f.mount&&f.mount()}else for(let i of this.panels)i.update&&i.update(r)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:r=>Z.scrollMargins.of(t=>{let e=t.plugin(r);return e&&{top:e.top.scrollMargin(),bottom:e.bottom.scrollMargin()}})});class Ao{constructor(t,e,i){this.view=t,this.top=e,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){for(let e of this.panels)e.destroy&&t.indexOf(e)<0&&e.destroy();this.panels=t,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let e=this.container||this.view.dom;e.insertBefore(this.dom,this.top?e.firstChild:null)}let t=this.dom.firstChild;for(let e of this.panels)if(e.dom.parentNode==this.dom){for(;t!=e.dom;)t=np(t);t=t.nextSibling}else this.dom.insertBefore(e.dom,t);for(;t;)t=np(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function np(r){let t=r.nextSibling;return r.remove(),t}const Lh=Y.define({enables:xC});class fr extends Mn{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}fr.prototype.elementClass="";fr.prototype.toDOM=void 0;fr.prototype.mapMode=le.TrackBefore;fr.prototype.startSide=fr.prototype.endSide=-1;fr.prototype.point=!0;let bC=0;class He{constructor(t,e,i,n){this.name=t,this.set=e,this.base=i,this.modified=n,this.id=bC++}toString(){let{name:t}=this;for(let e of this.modified)e.name&&(t=`${e.name}(${t})`);return t}static define(t,e){let i=typeof t=="string"?t:"?";if(t instanceof He&&(e=t),e?.base)throw new Error("Can not derive from a modified tag");let n=new He(i,[],null,[]);if(n.set.push(n),e)for(let o of e.set)n.set.push(o);return n}static defineModifier(t){let e=new jo(t);return i=>i.modified.indexOf(e)>-1?i:jo.get(i.base||i,i.modified.concat(e).sort((n,o)=>n.id-o.id))}}let OC=0;class jo{constructor(t){this.name=t,this.instances=[],this.id=OC++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find(h=>h.base==t&&SC(e,h.modified));if(i)return i;let n=[],o=new He(t.name,n,t,e);for(let h of e)h.instances.push(o);let l=kC(e);for(let h of t.set)if(!h.modified.length)for(let f of l)n.push(jo.get(h,f));return o}}function SC(r,t){return r.length==t.length&&r.every((e,i)=>e==t[i])}function kC(r){let t=[[]];for(let e=0;e<r.length;e++)for(let i=0,n=t.length;i<n;i++)t.push(t[i].concat(r[e]));return t.sort((e,i)=>i.length-e.length)}function cf(r){let t=Object.create(null);for(let e in r){let i=r[e];Array.isArray(i)||(i=[i]);for(let n of e.split(" "))if(n){let o=[],l=2,h=n;for(let g=0;;){if(h=="..."&&g>0&&g+3==n.length){l=1;break}let m=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(h);if(!m)throw new RangeError("Invalid path: "+n);if(o.push(m[0]=="*"?"":m[0][0]=='"'?JSON.parse(m[0]):m[0]),g+=m[0].length,g==n.length)break;let w=n[g++];if(g==n.length&&w=="!"){l=0;break}if(w!="/")throw new RangeError("Invalid path: "+n);h=n.slice(g)}let f=o.length-1,c=o[f];if(!c)throw new RangeError("Invalid path: "+n);let d=new Jo(i,l,f>0?o.slice(0,f):null);t[c]=d.sort(t[c])}}return cm.add(t)}const cm=new ht;class Jo{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}Jo.empty=new Jo([],2,null);function dm(r,t){let e=Object.create(null);for(let o of r)if(!Array.isArray(o.tag))e[o.tag.id]=o.class;else for(let l of o.tag)e[l.id]=o.class;let{scope:i,all:n=null}=t||{};return{style:o=>{let l=n;for(let h of o)for(let f of h.set){let c=e[f.id];if(c){l=l?l+" "+c:c;break}}return l},scope:i}}function CC(r,t){let e=null;for(let i of r){let n=i.style(t);n&&(e=e?e+" "+n:n)}return e}function pm(r,t,e,i=0,n=r.length){let o=new TC(i,Array.isArray(t)?t:[t],e);o.highlightRange(r.cursor(),i,n,"",o.highlighters),o.flush(n)}function AC(r,t,e,i,n,o=0,l=r.length){let h=o;function f(c,d){if(!(c<=h)){for(let g=r.slice(h,c),m=0;;){let w=g.indexOf(`
`,m),b=w<0?g.length:w;if(b>m&&i(g.slice(m,b),d),w<0)break;n(),m=w+1}h=c}}pm(t,e,(c,d,g)=>{f(c,""),f(d,g)},o,l),f(l,"")}class TC{constructor(t,e,i){this.at=t,this.highlighters=e,this.span=i,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,i,n,o){let{type:l,from:h,to:f}=t;if(h>=i||f<=e)return;l.isTop&&(o=this.highlighters.filter(w=>!w.scope||w.scope(l)));let c=n,d=PC(t)||Jo.empty,g=CC(o,d.tags);if(g&&(c&&(c+=" "),c+=g,d.mode==1&&(n+=(n?" ":"")+g)),this.startSpan(Math.max(e,h),c),d.opaque)return;let m=t.tree&&t.tree.prop(ht.mounted);if(m&&m.overlay){let w=t.node.enter(m.overlay[0].from+h,1),b=this.highlighters.filter(C=>!C.scope||C.scope(m.tree.type)),S=t.firstChild();for(let C=0,P=h;;C++){let B=C<m.overlay.length?m.overlay[C]:null,L=B?B.from+h:f,_=Math.max(e,P),$=Math.min(i,L);if(_<$&&S)for(;t.from<$&&(this.highlightRange(t,_,$,n,o),this.startSpan(Math.min($,t.to),c),!(t.to>=L||!t.nextSibling())););if(!B||L>i)break;P=B.to+h,P>e&&(this.highlightRange(w.cursor(),Math.max(e,B.from+h),Math.min(i,P),"",b),this.startSpan(Math.min(i,P),c))}S&&t.parent()}else if(t.firstChild()){m&&(n="");do if(!(t.to<=e)){if(t.from>=i)break;this.highlightRange(t,e,i,n,o),this.startSpan(Math.min(i,t.to),c)}while(t.nextSibling());t.parent()}}}function PC(r){let t=r.type.prop(cm);for(;t&&t.context&&!r.matchContext(t.context);)t=t.next;return t||null}const V=He.define,To=V(),tn=V(),rp=V(tn),sp=V(tn),en=V(),Po=V(en),Ya=V(en),pi=V(),On=V(pi),ci=V(),di=V(),Nh=V(),Fr=V(Nh),Mo=V(),I={comment:To,lineComment:V(To),blockComment:V(To),docComment:V(To),name:tn,variableName:V(tn),typeName:rp,tagName:V(rp),propertyName:sp,attributeName:V(sp),className:V(tn),labelName:V(tn),namespace:V(tn),macroName:V(tn),literal:en,string:Po,docString:V(Po),character:V(Po),attributeValue:V(Po),number:Ya,integer:V(Ya),float:V(Ya),bool:V(en),regexp:V(en),escape:V(en),color:V(en),url:V(en),keyword:ci,self:V(ci),null:V(ci),atom:V(ci),unit:V(ci),modifier:V(ci),operatorKeyword:V(ci),controlKeyword:V(ci),definitionKeyword:V(ci),moduleKeyword:V(ci),operator:di,derefOperator:V(di),arithmeticOperator:V(di),logicOperator:V(di),bitwiseOperator:V(di),compareOperator:V(di),updateOperator:V(di),definitionOperator:V(di),typeOperator:V(di),controlOperator:V(di),punctuation:Nh,separator:V(Nh),bracket:Fr,angleBracket:V(Fr),squareBracket:V(Fr),paren:V(Fr),brace:V(Fr),content:pi,heading:On,heading1:V(On),heading2:V(On),heading3:V(On),heading4:V(On),heading5:V(On),heading6:V(On),contentSeparator:V(pi),list:V(pi),quote:V(pi),emphasis:V(pi),strong:V(pi),link:V(pi),monospace:V(pi),strikethrough:V(pi),inserted:V(),deleted:V(),changed:V(),invalid:V(),meta:Mo,documentMeta:V(Mo),annotation:V(Mo),processingInstruction:V(Mo),definition:He.defineModifier("definition"),constant:He.defineModifier("constant"),function:He.defineModifier("function"),standard:He.defineModifier("standard"),local:He.defineModifier("local"),special:He.defineModifier("special")};for(let r in I){let t=I[r];t instanceof He&&(t.name=r)}dm([{tag:I.link,class:"tok-link"},{tag:I.heading,class:"tok-heading"},{tag:I.emphasis,class:"tok-emphasis"},{tag:I.strong,class:"tok-strong"},{tag:I.keyword,class:"tok-keyword"},{tag:I.atom,class:"tok-atom"},{tag:I.bool,class:"tok-bool"},{tag:I.url,class:"tok-url"},{tag:I.labelName,class:"tok-labelName"},{tag:I.inserted,class:"tok-inserted"},{tag:I.deleted,class:"tok-deleted"},{tag:I.literal,class:"tok-literal"},{tag:I.string,class:"tok-string"},{tag:I.number,class:"tok-number"},{tag:[I.regexp,I.escape,I.special(I.string)],class:"tok-string2"},{tag:I.variableName,class:"tok-variableName"},{tag:I.local(I.variableName),class:"tok-variableName tok-local"},{tag:I.definition(I.variableName),class:"tok-variableName tok-definition"},{tag:I.special(I.variableName),class:"tok-variableName2"},{tag:I.definition(I.propertyName),class:"tok-propertyName tok-definition"},{tag:I.typeName,class:"tok-typeName"},{tag:I.namespace,class:"tok-namespace"},{tag:I.className,class:"tok-className"},{tag:I.macroName,class:"tok-macroName"},{tag:I.propertyName,class:"tok-propertyName"},{tag:I.operator,class:"tok-operator"},{tag:I.comment,class:"tok-comment"},{tag:I.meta,class:"tok-meta"},{tag:I.invalid,class:"tok-invalid"},{tag:I.punctuation,class:"tok-punctuation"}]);var Xa;const Kn=new ht;function MC(r){return Y.define({combine:r?t=>t.concat(r):void 0})}const RC=new ht;class ii{constructor(t,e,i=[],n=""){this.data=t,this.name=n,mt.prototype.hasOwnProperty("tree")||Object.defineProperty(mt.prototype,"tree",{get(){return xe(this)}}),this.parser=e,this.extension=[cr.of(this),mt.languageData.of((o,l,h)=>{let f=op(o,l,h),c=f.type.prop(Kn);if(!c)return[];let d=o.facet(c),g=f.type.prop(RC);if(g){let m=f.resolve(l-f.from,h);for(let w of g)if(w.test(m,o)){let b=o.facet(w.facet);return w.type=="replace"?b:b.concat(d)}}return d})].concat(i)}isActiveAt(t,e,i=-1){return op(t,e,i).type.prop(Kn)==this.data}findRegions(t){let e=t.facet(cr);if(e?.data==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let i=[],n=(o,l)=>{if(o.prop(Kn)==this.data){i.push({from:l,to:l+o.length});return}let h=o.prop(ht.mounted);if(h){if(h.tree.prop(Kn)==this.data){if(h.overlay)for(let f of h.overlay)i.push({from:f.from+l,to:f.to+l});else i.push({from:l,to:l+o.length});return}else if(h.overlay){let f=i.length;if(n(h.tree,h.overlay[0].from+l),i.length>f)return}}for(let f=0;f<o.children.length;f++){let c=o.children[f];c instanceof Et&&n(c,o.positions[f]+l)}};return n(xe(t),0),i}get allowsNesting(){return!0}}ii.setState=ct.define();function op(r,t,e){let i=r.facet(cr),n=xe(r).topNode;if(!i||i.allowsNesting)for(let o=n;o;o=o.enter(t,e,Rt.ExcludeBuffers))o.type.isTop&&(n=o);return n}class as extends ii{constructor(t,e,i){super(t,e,[],i),this.parser=e}static define(t){let e=MC(t.languageData);return new as(e,t.parser.configure({props:[Kn.add(i=>i.isTop?e:void 0)]}),t.name)}configure(t,e){return new as(this.data,this.parser.configure(t),e||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function xe(r){let t=r.field(ii.state,!1);return t?t.tree:Et.empty}class _C{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let i=this.cursorPos-this.string.length;return t<i||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-i,e-i)}}let Vr=null;class tl{constructor(t,e,i=[],n,o,l,h,f){this.parser=t,this.state=e,this.fragments=i,this.tree=n,this.treeLen=o,this.viewport=l,this.skipped=h,this.scheduleOn=f,this.parse=null,this.tempSkipped=[]}static create(t,e,i){return new tl(t,e,[],Et.empty,0,i,[],null)}startParse(){return this.parser.startParse(new _C(this.state.doc),this.fragments)}work(t,e){return e!=null&&e>=this.state.doc.length&&(e=void 0),this.tree!=Et.empty&&this.isDone(e??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof t=="number"){let n=Date.now()+t;t=()=>Date.now()>n}for(this.parse||(this.parse=this.startParse()),e!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let n=this.parse.advance();if(n)if(this.fragments=this.withoutTempSkipped(Vi.addTree(n,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=n,this.parse=null,this.treeLen<(e??this.state.doc.length))this.parse=this.startParse();else return!0;if(t())return!1}})}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(e=this.parse.advance()););}),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(Vi.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=Vr;Vr=this;try{return t()}finally{Vr=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=lp(t,e.from,e.to);return t}changes(t,e){let{fragments:i,tree:n,treeLen:o,viewport:l,skipped:h}=this;if(this.takeTree(),!t.empty){let f=[];if(t.iterChangedRanges((c,d,g,m)=>f.push({fromA:c,toA:d,fromB:g,toB:m})),i=Vi.applyChanges(i,f),n=Et.empty,o=0,l={from:t.mapPos(l.from,-1),to:t.mapPos(l.to,1)},this.skipped.length){h=[];for(let c of this.skipped){let d=t.mapPos(c.from,1),g=t.mapPos(c.to,-1);d<g&&h.push({from:d,to:g})}}}return new tl(this.parser,e,i,n,o,l,h,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:n,to:o}=this.skipped[i];n<t.to&&o>t.from&&(this.fragments=lp(this.fragments,n,o),this.skipped.splice(i--,1))}return this.skipped.length>=e?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends Xp{createParse(e,i,n){let o=n[0].from,l=n[n.length-1].to;return{parsedPos:o,advance(){let f=Vr;if(f){for(let c of n)f.tempSkipped.push(c);t&&(f.scheduleOn=f.scheduleOn?Promise.all([f.scheduleOn,t]):t)}return this.parsedPos=l,new Et(fe.none,[],[],l-o)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&e[0].from==0&&e[0].to>=t}static get(){return Vr}}function lp(r,t,e){return Vi.applyChanges(r,[{fromA:t,toA:e,fromB:t,toB:e}])}class ur{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),i=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,i)||e.takeTree(),new ur(e)}static init(t){let e=Math.min(3e3,t.doc.length),i=tl.create(t.facet(cr).parser,t,{from:0,to:e});return i.work(20,e)||i.takeTree(),new ur(i)}}ii.state=be.define({create:ur.init,update(r,t){for(let e of t.effects)if(e.is(ii.setState))return e.value;return t.startState.facet(cr)!=t.state.facet(cr)?ur.init(t.state):r.apply(t)}});let gm=r=>{let t=setTimeout(()=>r(),500);return()=>clearTimeout(t)};typeof requestIdleCallback<"u"&&(gm=r=>{let t=-1,e=setTimeout(()=>{t=requestIdleCallback(r,{timeout:400})},100);return()=>t<0?clearTimeout(e):cancelIdleCallback(t)});const Ka=typeof navigator<"u"&&(!((Xa=navigator.scheduling)===null||Xa===void 0)&&Xa.isInputPending)?()=>navigator.scheduling.isInputPending():null,EC=_e.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(ii.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),(t.docChanged||t.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(ii.state);(e.tree!=e.context.tree||!e.context.isDone(t.doc.length))&&(this.working=gm(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,o=i.field(ii.state);if(o.tree==o.context.tree&&o.context.isDone(n+1e5))return;let l=Date.now()+Math.min(this.chunkBudget,100,t&&!Ka?Math.max(25,t.timeRemaining()-5):1e9),h=o.context.treeLen<n&&i.doc.length>n+1e3,f=o.context.work(()=>Ka&&Ka()||Date.now()>l,n+(h?0:1e5));this.chunkBudget-=Date.now()-e,(f||this.chunkBudget<=0)&&(o.context.takeTree(),this.view.dispatch({effects:ii.setState.of(new ur(o.context))})),this.chunkBudget>0&&!(f&&!h)&&this.scheduleWork(),this.checkAsyncSchedule(o.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then(()=>this.scheduleWork()).catch(e=>ae(this.view.state,e)).then(()=>this.workScheduled--),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),cr=Y.define({combine(r){return r.length?r[0]:null},enables:r=>[ii.state,EC,Z.contentAttributes.compute([r],t=>{let e=t.facet(r);return e&&e.name?{"data-language":e.name}:{}})]});class mm{constructor(t,e=[]){this.language=t,this.support=e,this.extension=[t,e]}}const DC=Y.define(),ym=Y.define({combine:r=>{if(!r.length)return"  ";let t=r[0];if(!t||/\S/.test(t)||Array.from(t).some(e=>e!=t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(r[0]));return t}});function IC(r){let t=r.facet(ym);return t.charCodeAt(0)==9?r.tabSize*t.length:t.length}function ap(r,t){let e="",i=r.tabSize,n=r.facet(ym)[0];if(n=="	"){for(;t>=i;)e+="	",t-=i;n=" "}for(let o=0;o<t;o++)e+=n;return e}function BC(r,t){r instanceof mt&&(r=new df(r));for(let i of r.state.facet(DC)){let n=i(r,t);if(n!==void 0)return n}let e=xe(r.state);return e.length>=t?NC(r,e,t):null}class df{constructor(t,e={}){this.state=t,this.options=e,this.unit=IC(t)}lineAt(t,e=1){let i=this.state.doc.lineAt(t),{simulateBreak:n,simulateDoubleBreak:o}=this.options;return n!=null&&n>=i.from&&n<=i.to?o&&n==t?{text:"",from:t}:(e<0?n<t:n<=t)?{text:i.text.slice(n-i.from),from:n}:{text:i.text.slice(0,n-i.from),from:i.from}:i}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:i,from:n}=this.lineAt(t,e);return i.slice(t-n,Math.min(i.length,t+100-n))}column(t,e=1){let{text:i,from:n}=this.lineAt(t,e),o=this.countColumn(i,t-n),l=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return l>-1&&(o+=l-this.countColumn(i,i.search(/\S|$/))),o}countColumn(t,e=t.length){return pg(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:i,from:n}=this.lineAt(t,e),o=this.options.overrideIndentation;if(o){let l=o(n);if(l>-1)return l}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const LC=new ht;function NC(r,t,e){let i=t.resolveStack(e),n=t.resolveInner(e,-1).resolve(e,0).enterUnfinishedNodesBefore(e);if(n!=i.node){let o=[];for(let l=n;l&&!(l.from==i.node.from&&l.type==i.node.type);l=l.parent)o.push(l);for(let l=o.length-1;l>=0;l--)i={node:o[l],next:i}}return wm(i,r,e)}function wm(r,t,e){for(let i=r;i;i=i.next){let n=WC(i.node);if(n)return n(pf.create(t,e,i))}return 0}function $C(r){return r.pos==r.options.simulateBreak&&r.options.simulateDoubleBreak}function WC(r){let t=r.type.prop(LC);if(t)return t;let e=r.firstChild,i;if(e&&(i=e.type.prop(ht.closedBy))){let n=r.lastChild,o=n&&i.indexOf(n.name)>-1;return l=>zC(l,!0,1,void 0,o&&!$C(l)?n.from:void 0)}return r.parent==null?FC:null}function FC(){return 0}class pf extends df{constructor(t,e,i){super(t.state,t.options),this.base=t,this.pos=e,this.context=i}get node(){return this.context.node}static create(t,e,i){return new pf(t,e,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(t){let e=this.state.doc.lineAt(t.from);for(;;){let i=t.resolve(e.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if(VC(i,t))break;e=this.state.doc.lineAt(i.from)}return this.lineIndent(e.from)}continue(){return wm(this.context.next,this.base,this.pos)}}function VC(r,t){for(let e=t;e;e=e.parent)if(r==e)return!0;return!1}function HC(r){let t=r.node,e=t.childAfter(t.from),i=t.lastChild;if(!e)return null;let n=r.options.simulateBreak,o=r.state.doc.lineAt(e.from),l=n==null||n<=o.from?o.to:Math.min(o.to,n);for(let h=e.to;;){let f=t.childAfter(h);if(!f||f==i)return null;if(!f.type.isSkipped){if(f.from>=l)return null;let c=/^ */.exec(o.text.slice(e.to-o.from))[0].length;return{from:e.from,to:e.to+c}}h=f.to}}function zC(r,t,e,i,n){let o=r.textAfter,l=o.match(/^\s*/)[0].length,h=i&&o.slice(l,l+i.length)==i||n==r.pos+l,f=HC(r);return f?h?r.column(f.from):r.column(f.to):r.baseIndent+(h?0:r.unit*e)}class ys{constructor(t,e){this.specs=t;let i;function n(h){let f=hn.newName();return(i||(i=Object.create(null)))["."+f]=h,f}const o=typeof e.all=="string"?e.all:e.all?n(e.all):void 0,l=e.scope;this.scope=l instanceof ii?h=>h.prop(Kn)==l.data:l?h=>h==l:void 0,this.style=dm(t.map(h=>({tag:h.tag,class:h.class||n(Object.assign({},h,{tag:null}))})),{all:o}).style,this.module=i?new hn(i):null,this.themeType=e.themeType}static define(t,e){return new ys(t,e||{})}}const $h=Y.define(),qC=Y.define({combine(r){return r.length?[r[0]]:null}});function Ga(r){let t=r.facet($h);return t.length?t:r.facet(qC)}function vm(r,t){let e=[QC],i;return r instanceof ys&&(r.module&&e.push(Z.styleModule.of(r.module)),i=r.themeType),i?e.push($h.computeN([Z.darkTheme],n=>n.facet(Z.darkTheme)==(i=="dark")?[r]:[])):e.push($h.of(r)),e}class UC{constructor(t){this.markCache=Object.create(null),this.tree=xe(t.state),this.decorations=this.buildDeco(t,Ga(t.state)),this.decoratedTo=t.viewport.to}update(t){let e=xe(t.state),i=Ga(t.state),n=i!=Ga(t.startState),{viewport:o}=t.view,l=t.changes.mapPos(this.decoratedTo,1);e.length<o.to&&!n&&e.type==this.tree.type&&l>=o.to?(this.decorations=this.decorations.map(t.changes),this.decoratedTo=l):(e!=this.tree||t.viewportChanged||n)&&(this.tree=e,this.decorations=this.buildDeco(t.view,i),this.decoratedTo=o.to)}buildDeco(t,e){if(!e||!this.tree.length)return yt.none;let i=new sr;for(let{from:n,to:o}of t.visibleRanges)pm(this.tree,e,(l,h,f)=>{i.add(l,h,this.markCache[f]||(this.markCache[f]=yt.mark({class:f})))},n,o);return i.finish()}}const QC=cs.high(_e.fromClass(UC,{decorations:r=>r.decorations})),YC=Z.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),xm=1e4,bm="()[]{}",Om=Y.define({combine(r){return fl(r,{afterCursor:!0,brackets:bm,maxScanDistance:xm,renderMatch:GC})}}),XC=yt.mark({class:"cm-matchingBracket"}),KC=yt.mark({class:"cm-nonmatchingBracket"});function GC(r){let t=[],e=r.matched?XC:KC;return t.push(e.range(r.start.from,r.start.to)),r.end&&t.push(e.range(r.end.from,r.end.to)),t}const ZC=be.define({create(){return yt.none},update(r,t){if(!t.docChanged&&!t.selection)return r;let e=[],i=t.state.facet(Om);for(let n of t.state.selection.ranges){if(!n.empty)continue;let o=Ro(t.state,n.head,-1,i)||n.head>0&&Ro(t.state,n.head-1,1,i)||i.afterCursor&&(Ro(t.state,n.head,1,i)||n.head<t.state.doc.length&&Ro(t.state,n.head+1,-1,i));o&&(e=e.concat(i.renderMatch(o,t.state)))}return yt.set(e,!0)},provide:r=>Z.decorations.from(r)}),jC=[ZC,YC];function JC(r={}){return[Om.of(r),jC]}const tA=new ht;function Wh(r,t,e){let i=r.prop(t<0?ht.openedBy:ht.closedBy);if(i)return i;if(r.name.length==1){let n=e.indexOf(r.name);if(n>-1&&n%2==(t<0?1:0))return[e[n+t]]}return null}function Fh(r){let t=r.type.prop(tA);return t?t(r.node):r}function Ro(r,t,e,i={}){let n=i.maxScanDistance||xm,o=i.brackets||bm,l=xe(r),h=l.resolveInner(t,e);for(let f=h;f;f=f.parent){let c=Wh(f.type,e,o);if(c&&f.from<f.to){let d=Fh(f);if(d&&(e>0?t>=d.from&&t<d.to:t>d.from&&t<=d.to))return eA(r,t,e,f,d,c,o)}}return iA(r,t,e,l,h.type,n,o)}function eA(r,t,e,i,n,o,l){let h=i.parent,f={from:n.from,to:n.to},c=0,d=h?.cursor();if(d&&(e<0?d.childBefore(i.from):d.childAfter(i.to)))do if(e<0?d.to<=i.from:d.from>=i.to){if(c==0&&o.indexOf(d.type.name)>-1&&d.from<d.to){let g=Fh(d);return{start:f,end:g?{from:g.from,to:g.to}:void 0,matched:!0}}else if(Wh(d.type,e,l))c++;else if(Wh(d.type,-e,l)){if(c==0){let g=Fh(d);return{start:f,end:g&&g.from<g.to?{from:g.from,to:g.to}:void 0,matched:!1}}c--}}while(e<0?d.prevSibling():d.nextSibling());return{start:f,matched:!1}}function iA(r,t,e,i,n,o,l){let h=e<0?r.sliceDoc(t-1,t):r.sliceDoc(t,t+1),f=l.indexOf(h);if(f<0||f%2==0!=e>0)return null;let c={from:e<0?t-1:t,to:e>0?t+1:t},d=r.doc.iterRange(t,e>0?r.doc.length:0),g=0;for(let m=0;!d.next().done&&m<=o;){let w=d.value;e<0&&(m+=w.length);let b=t+m*e;for(let S=e>0?0:w.length-1,C=e>0?w.length:-1;S!=C;S+=e){let P=l.indexOf(w[S]);if(!(P<0||i.resolveInner(b+S,1).type!=n))if(P%2==0==e>0)g++;else{if(g==1)return{start:c,end:{from:b+S,to:b+S+1},matched:P>>1==f>>1};g--}}e>0&&(m+=w.length)}return d.done?{start:c,matched:!1}:null}const nA=Object.create(null),hp=[fe.none],fp=[],up=Object.create(null),rA=Object.create(null);for(let[r,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])rA[r]=sA(nA,t);function Za(r,t){fp.indexOf(r)>-1||(fp.push(r),console.warn(t))}function sA(r,t){let e=[];for(let h of t.split(" ")){let f=[];for(let c of h.split(".")){let d=r[c]||I[c];d?typeof d=="function"?f.length?f=f.map(d):Za(c,`Modifier ${c} used at start of tag`):f.length?Za(c,`Tag ${c} used as modifier`):f=Array.isArray(d)?d:[d]:Za(c,`Unknown highlighting tag ${c}`)}for(let c of f)e.push(c)}if(!e.length)return 0;let i=t.replace(/ /g,"_"),n=i+" "+e.map(h=>h.id),o=up[n];if(o)return o.id;let l=up[n]=fe.define({id:hp.length,name:i,props:[cf({[i]:e})]});return hp.push(l),l.id}Ht.RTL,Ht.LTR;function Sm(...r){return r.length===2?dp(r[0],r[1])||null:r.slice(1).reduce((e,i)=>dp(e,i),r[0])||null}const cp=new WeakMap;function dp(r,t){if(r&&t){const e=cp.get(r)||new WeakMap;cp.set(r,e);const i=e.get(t)||(n=>{pp(r,n),pp(t,n)});return e.set(t,i),i}return r||t}function pp(r,t){typeof r=="function"?r(t):r.current=t}function km(r){var t,e,i="";if(typeof r=="string"||typeof r=="number")i+=r;else if(typeof r=="object")if(Array.isArray(r)){var n=r.length;for(t=0;t<n;t++)r[t]&&(e=km(r[t]))&&(i&&(i+=" "),i+=e)}else for(e in r)r[e]&&(i&&(i+=" "),i+=e);return i}function Qr(){for(var r,t,e=0,i="",n=arguments.length;e<n;e++)(r=arguments[e])&&(t=km(r))&&(i&&(i+=" "),i+=t);return i}var Yr={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var oA=Yr.exports,gp;function lA(){return gp||(gp=1,function(r,t){(function(){var e,i="4.17.21",n=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",h="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",c=500,d="__lodash_placeholder__",g=1,m=2,w=4,b=1,S=2,C=1,P=2,B=4,L=8,_=16,$=32,W=64,F=128,J=256,rt=512,bt=30,lt="...",j=800,et=16,vt=1,Dt=2,oi=3,li=1/0,Ke=9007199254740991,Ci=17976931348623157e292,cn=NaN,Ft=4294967295,ue=Ft-1,Ee=Ft>>>1,Ai=[["ary",F],["bind",C],["bindKey",P],["curry",L],["curryRight",_],["flip",rt],["partial",$],["partialRight",W],["rearg",J]],Oe="[object Arguments]",Ti="[object Array]",ws="[object AsyncFunction]",pr="[object Boolean]",gr="[object Date]",n0="[object DOMException]",vs="[object Error]",xs="[object Function]",Sf="[object GeneratorFunction]",Ge="[object Map]",mr="[object Number]",r0="[object Null]",Pi="[object Object]",kf="[object Promise]",s0="[object Proxy]",yr="[object RegExp]",Ze="[object Set]",wr="[object String]",bs="[object Symbol]",o0="[object Undefined]",vr="[object WeakMap]",l0="[object WeakSet]",xr="[object ArrayBuffer]",Dn="[object DataView]",ml="[object Float32Array]",yl="[object Float64Array]",wl="[object Int8Array]",vl="[object Int16Array]",xl="[object Int32Array]",bl="[object Uint8Array]",Ol="[object Uint8ClampedArray]",Sl="[object Uint16Array]",kl="[object Uint32Array]",a0=/\b__p \+= '';/g,h0=/\b(__p \+=) '' \+/g,f0=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Cf=/&(?:amp|lt|gt|quot|#39);/g,Af=/[&<>"']/g,u0=RegExp(Cf.source),c0=RegExp(Af.source),d0=/<%-([\s\S]+?)%>/g,p0=/<%([\s\S]+?)%>/g,Tf=/<%=([\s\S]+?)%>/g,g0=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,m0=/^\w*$/,y0=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Cl=/[\\^$.*+?()[\]{}|]/g,w0=RegExp(Cl.source),Al=/^\s+/,v0=/\s/,x0=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,b0=/\{\n\/\* \[wrapped with (.+)\] \*/,O0=/,? & /,S0=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,k0=/[()=,{}\[\]\/\s]/,C0=/\\(\\)?/g,A0=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Pf=/\w*$/,T0=/^[-+]0x[0-9a-f]+$/i,P0=/^0b[01]+$/i,M0=/^\[object .+?Constructor\]$/,R0=/^0o[0-7]+$/i,_0=/^(?:0|[1-9]\d*)$/,E0=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Os=/($^)/,D0=/['\n\r\u2028\u2029\\]/g,Ss="\\ud800-\\udfff",I0="\\u0300-\\u036f",B0="\\ufe20-\\ufe2f",L0="\\u20d0-\\u20ff",Mf=I0+B0+L0,Rf="\\u2700-\\u27bf",_f="a-z\\xdf-\\xf6\\xf8-\\xff",N0="\\xac\\xb1\\xd7\\xf7",$0="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",W0="\\u2000-\\u206f",F0=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ef="A-Z\\xc0-\\xd6\\xd8-\\xde",Df="\\ufe0e\\ufe0f",If=N0+$0+W0+F0,Tl="[']",V0="["+Ss+"]",Bf="["+If+"]",ks="["+Mf+"]",Lf="\\d+",H0="["+Rf+"]",Nf="["+_f+"]",$f="[^"+Ss+If+Lf+Rf+_f+Ef+"]",Pl="\\ud83c[\\udffb-\\udfff]",z0="(?:"+ks+"|"+Pl+")",Wf="[^"+Ss+"]",Ml="(?:\\ud83c[\\udde6-\\uddff]){2}",Rl="[\\ud800-\\udbff][\\udc00-\\udfff]",In="["+Ef+"]",Ff="\\u200d",Vf="(?:"+Nf+"|"+$f+")",q0="(?:"+In+"|"+$f+")",Hf="(?:"+Tl+"(?:d|ll|m|re|s|t|ve))?",zf="(?:"+Tl+"(?:D|LL|M|RE|S|T|VE))?",qf=z0+"?",Uf="["+Df+"]?",U0="(?:"+Ff+"(?:"+[Wf,Ml,Rl].join("|")+")"+Uf+qf+")*",Q0="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Y0="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Qf=Uf+qf+U0,X0="(?:"+[H0,Ml,Rl].join("|")+")"+Qf,K0="(?:"+[Wf+ks+"?",ks,Ml,Rl,V0].join("|")+")",G0=RegExp(Tl,"g"),Z0=RegExp(ks,"g"),_l=RegExp(Pl+"(?="+Pl+")|"+K0+Qf,"g"),j0=RegExp([In+"?"+Nf+"+"+Hf+"(?="+[Bf,In,"$"].join("|")+")",q0+"+"+zf+"(?="+[Bf,In+Vf,"$"].join("|")+")",In+"?"+Vf+"+"+Hf,In+"+"+zf,Y0,Q0,Lf,X0].join("|"),"g"),J0=RegExp("["+Ff+Ss+Mf+Df+"]"),t1=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,e1=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],i1=-1,Tt={};Tt[ml]=Tt[yl]=Tt[wl]=Tt[vl]=Tt[xl]=Tt[bl]=Tt[Ol]=Tt[Sl]=Tt[kl]=!0,Tt[Oe]=Tt[Ti]=Tt[xr]=Tt[pr]=Tt[Dn]=Tt[gr]=Tt[vs]=Tt[xs]=Tt[Ge]=Tt[mr]=Tt[Pi]=Tt[yr]=Tt[Ze]=Tt[wr]=Tt[vr]=!1;var Ct={};Ct[Oe]=Ct[Ti]=Ct[xr]=Ct[Dn]=Ct[pr]=Ct[gr]=Ct[ml]=Ct[yl]=Ct[wl]=Ct[vl]=Ct[xl]=Ct[Ge]=Ct[mr]=Ct[Pi]=Ct[yr]=Ct[Ze]=Ct[wr]=Ct[bs]=Ct[bl]=Ct[Ol]=Ct[Sl]=Ct[kl]=!0,Ct[vs]=Ct[xs]=Ct[vr]=!1;var n1={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},r1={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},s1={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},o1={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},l1=parseFloat,a1=parseInt,Yf=typeof fo=="object"&&fo&&fo.Object===Object&&fo,h1=typeof self=="object"&&self&&self.Object===Object&&self,Kt=Yf||h1||Function("return this")(),El=t&&!t.nodeType&&t,dn=El&&!0&&r&&!r.nodeType&&r,Xf=dn&&dn.exports===El,Dl=Xf&&Yf.process,De=function(){try{var A=dn&&dn.require&&dn.require("util").types;return A||Dl&&Dl.binding&&Dl.binding("util")}catch{}}(),Kf=De&&De.isArrayBuffer,Gf=De&&De.isDate,Zf=De&&De.isMap,jf=De&&De.isRegExp,Jf=De&&De.isSet,tu=De&&De.isTypedArray;function Se(A,R,M){switch(M.length){case 0:return A.call(R);case 1:return A.call(R,M[0]);case 2:return A.call(R,M[0],M[1]);case 3:return A.call(R,M[0],M[1],M[2])}return A.apply(R,M)}function f1(A,R,M,U){for(var tt=-1,gt=A==null?0:A.length;++tt<gt;){var zt=A[tt];R(U,zt,M(zt),A)}return U}function Ie(A,R){for(var M=-1,U=A==null?0:A.length;++M<U&&R(A[M],M,A)!==!1;);return A}function u1(A,R){for(var M=A==null?0:A.length;M--&&R(A[M],M,A)!==!1;);return A}function eu(A,R){for(var M=-1,U=A==null?0:A.length;++M<U;)if(!R(A[M],M,A))return!1;return!0}function Ui(A,R){for(var M=-1,U=A==null?0:A.length,tt=0,gt=[];++M<U;){var zt=A[M];R(zt,M,A)&&(gt[tt++]=zt)}return gt}function Cs(A,R){var M=A==null?0:A.length;return!!M&&Bn(A,R,0)>-1}function Il(A,R,M){for(var U=-1,tt=A==null?0:A.length;++U<tt;)if(M(R,A[U]))return!0;return!1}function Mt(A,R){for(var M=-1,U=A==null?0:A.length,tt=Array(U);++M<U;)tt[M]=R(A[M],M,A);return tt}function Qi(A,R){for(var M=-1,U=R.length,tt=A.length;++M<U;)A[tt+M]=R[M];return A}function Bl(A,R,M,U){var tt=-1,gt=A==null?0:A.length;for(U&&gt&&(M=A[++tt]);++tt<gt;)M=R(M,A[tt],tt,A);return M}function c1(A,R,M,U){var tt=A==null?0:A.length;for(U&&tt&&(M=A[--tt]);tt--;)M=R(M,A[tt],tt,A);return M}function Ll(A,R){for(var M=-1,U=A==null?0:A.length;++M<U;)if(R(A[M],M,A))return!0;return!1}var d1=Nl("length");function p1(A){return A.split("")}function g1(A){return A.match(S0)||[]}function iu(A,R,M){var U;return M(A,function(tt,gt,zt){if(R(tt,gt,zt))return U=gt,!1}),U}function As(A,R,M,U){for(var tt=A.length,gt=M+(U?1:-1);U?gt--:++gt<tt;)if(R(A[gt],gt,A))return gt;return-1}function Bn(A,R,M){return R===R?T1(A,R,M):As(A,nu,M)}function m1(A,R,M,U){for(var tt=M-1,gt=A.length;++tt<gt;)if(U(A[tt],R))return tt;return-1}function nu(A){return A!==A}function ru(A,R){var M=A==null?0:A.length;return M?Wl(A,R)/M:cn}function Nl(A){return function(R){return R==null?e:R[A]}}function $l(A){return function(R){return A==null?e:A[R]}}function su(A,R,M,U,tt){return tt(A,function(gt,zt,Ot){M=U?(U=!1,gt):R(M,gt,zt,Ot)}),M}function y1(A,R){var M=A.length;for(A.sort(R);M--;)A[M]=A[M].value;return A}function Wl(A,R){for(var M,U=-1,tt=A.length;++U<tt;){var gt=R(A[U]);gt!==e&&(M=M===e?gt:M+gt)}return M}function Fl(A,R){for(var M=-1,U=Array(A);++M<A;)U[M]=R(M);return U}function w1(A,R){return Mt(R,function(M){return[M,A[M]]})}function ou(A){return A&&A.slice(0,fu(A)+1).replace(Al,"")}function ke(A){return function(R){return A(R)}}function Vl(A,R){return Mt(R,function(M){return A[M]})}function br(A,R){return A.has(R)}function lu(A,R){for(var M=-1,U=A.length;++M<U&&Bn(R,A[M],0)>-1;);return M}function au(A,R){for(var M=A.length;M--&&Bn(R,A[M],0)>-1;);return M}function v1(A,R){for(var M=A.length,U=0;M--;)A[M]===R&&++U;return U}var x1=$l(n1),b1=$l(r1);function O1(A){return"\\"+o1[A]}function S1(A,R){return A==null?e:A[R]}function Ln(A){return J0.test(A)}function k1(A){return t1.test(A)}function C1(A){for(var R,M=[];!(R=A.next()).done;)M.push(R.value);return M}function Hl(A){var R=-1,M=Array(A.size);return A.forEach(function(U,tt){M[++R]=[tt,U]}),M}function hu(A,R){return function(M){return A(R(M))}}function Yi(A,R){for(var M=-1,U=A.length,tt=0,gt=[];++M<U;){var zt=A[M];(zt===R||zt===d)&&(A[M]=d,gt[tt++]=M)}return gt}function Ts(A){var R=-1,M=Array(A.size);return A.forEach(function(U){M[++R]=U}),M}function A1(A){var R=-1,M=Array(A.size);return A.forEach(function(U){M[++R]=[U,U]}),M}function T1(A,R,M){for(var U=M-1,tt=A.length;++U<tt;)if(A[U]===R)return U;return-1}function P1(A,R,M){for(var U=M+1;U--;)if(A[U]===R)return U;return U}function Nn(A){return Ln(A)?R1(A):d1(A)}function je(A){return Ln(A)?_1(A):p1(A)}function fu(A){for(var R=A.length;R--&&v0.test(A.charAt(R)););return R}var M1=$l(s1);function R1(A){for(var R=_l.lastIndex=0;_l.test(A);)++R;return R}function _1(A){return A.match(_l)||[]}function E1(A){return A.match(j0)||[]}var D1=function A(R){R=R==null?Kt:$n.defaults(Kt.Object(),R,$n.pick(Kt,e1));var M=R.Array,U=R.Date,tt=R.Error,gt=R.Function,zt=R.Math,Ot=R.Object,zl=R.RegExp,I1=R.String,Be=R.TypeError,Ps=M.prototype,B1=gt.prototype,Wn=Ot.prototype,Ms=R["__core-js_shared__"],Rs=B1.toString,xt=Wn.hasOwnProperty,L1=0,uu=function(){var s=/[^.]+$/.exec(Ms&&Ms.keys&&Ms.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}(),_s=Wn.toString,N1=Rs.call(Ot),$1=Kt._,W1=zl("^"+Rs.call(xt).replace(Cl,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Es=Xf?R.Buffer:e,Xi=R.Symbol,Ds=R.Uint8Array,cu=Es?Es.allocUnsafe:e,Is=hu(Ot.getPrototypeOf,Ot),du=Ot.create,pu=Wn.propertyIsEnumerable,Bs=Ps.splice,gu=Xi?Xi.isConcatSpreadable:e,Or=Xi?Xi.iterator:e,pn=Xi?Xi.toStringTag:e,Ls=function(){try{var s=vn(Ot,"defineProperty");return s({},"",{}),s}catch{}}(),F1=R.clearTimeout!==Kt.clearTimeout&&R.clearTimeout,V1=U&&U.now!==Kt.Date.now&&U.now,H1=R.setTimeout!==Kt.setTimeout&&R.setTimeout,Ns=zt.ceil,$s=zt.floor,ql=Ot.getOwnPropertySymbols,z1=Es?Es.isBuffer:e,mu=R.isFinite,q1=Ps.join,U1=hu(Ot.keys,Ot),qt=zt.max,Jt=zt.min,Q1=U.now,Y1=R.parseInt,yu=zt.random,X1=Ps.reverse,Ul=vn(R,"DataView"),Sr=vn(R,"Map"),Ql=vn(R,"Promise"),Fn=vn(R,"Set"),kr=vn(R,"WeakMap"),Cr=vn(Ot,"create"),Ws=kr&&new kr,Vn={},K1=xn(Ul),G1=xn(Sr),Z1=xn(Ql),j1=xn(Fn),J1=xn(kr),Fs=Xi?Xi.prototype:e,Ar=Fs?Fs.valueOf:e,wu=Fs?Fs.toString:e;function v(s){if(It(s)&&!it(s)&&!(s instanceof ut)){if(s instanceof Le)return s;if(xt.call(s,"__wrapped__"))return vc(s)}return new Le(s)}var Hn=function(){function s(){}return function(a){if(!_t(a))return{};if(du)return du(a);s.prototype=a;var u=new s;return s.prototype=e,u}}();function Vs(){}function Le(s,a){this.__wrapped__=s,this.__actions__=[],this.__chain__=!!a,this.__index__=0,this.__values__=e}v.templateSettings={escape:d0,evaluate:p0,interpolate:Tf,variable:"",imports:{_:v}},v.prototype=Vs.prototype,v.prototype.constructor=v,Le.prototype=Hn(Vs.prototype),Le.prototype.constructor=Le;function ut(s){this.__wrapped__=s,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ft,this.__views__=[]}function ty(){var s=new ut(this.__wrapped__);return s.__actions__=ce(this.__actions__),s.__dir__=this.__dir__,s.__filtered__=this.__filtered__,s.__iteratees__=ce(this.__iteratees__),s.__takeCount__=this.__takeCount__,s.__views__=ce(this.__views__),s}function ey(){if(this.__filtered__){var s=new ut(this);s.__dir__=-1,s.__filtered__=!0}else s=this.clone(),s.__dir__*=-1;return s}function iy(){var s=this.__wrapped__.value(),a=this.__dir__,u=it(s),p=a<0,y=u?s.length:0,x=pw(0,y,this.__views__),O=x.start,k=x.end,T=k-O,E=p?k:O-1,D=this.__iteratees__,N=D.length,H=0,Q=Jt(T,this.__takeCount__);if(!u||!p&&y==T&&Q==T)return Hu(s,this.__actions__);var K=[];t:for(;T--&&H<Q;){E+=a;for(var st=-1,G=s[E];++st<N;){var ft=D[st],dt=ft.iteratee,Te=ft.type,oe=dt(G);if(Te==Dt)G=oe;else if(!oe){if(Te==vt)continue t;break t}}K[H++]=G}return K}ut.prototype=Hn(Vs.prototype),ut.prototype.constructor=ut;function gn(s){var a=-1,u=s==null?0:s.length;for(this.clear();++a<u;){var p=s[a];this.set(p[0],p[1])}}function ny(){this.__data__=Cr?Cr(null):{},this.size=0}function ry(s){var a=this.has(s)&&delete this.__data__[s];return this.size-=a?1:0,a}function sy(s){var a=this.__data__;if(Cr){var u=a[s];return u===f?e:u}return xt.call(a,s)?a[s]:e}function oy(s){var a=this.__data__;return Cr?a[s]!==e:xt.call(a,s)}function ly(s,a){var u=this.__data__;return this.size+=this.has(s)?0:1,u[s]=Cr&&a===e?f:a,this}gn.prototype.clear=ny,gn.prototype.delete=ry,gn.prototype.get=sy,gn.prototype.has=oy,gn.prototype.set=ly;function Mi(s){var a=-1,u=s==null?0:s.length;for(this.clear();++a<u;){var p=s[a];this.set(p[0],p[1])}}function ay(){this.__data__=[],this.size=0}function hy(s){var a=this.__data__,u=Hs(a,s);if(u<0)return!1;var p=a.length-1;return u==p?a.pop():Bs.call(a,u,1),--this.size,!0}function fy(s){var a=this.__data__,u=Hs(a,s);return u<0?e:a[u][1]}function uy(s){return Hs(this.__data__,s)>-1}function cy(s,a){var u=this.__data__,p=Hs(u,s);return p<0?(++this.size,u.push([s,a])):u[p][1]=a,this}Mi.prototype.clear=ay,Mi.prototype.delete=hy,Mi.prototype.get=fy,Mi.prototype.has=uy,Mi.prototype.set=cy;function Ri(s){var a=-1,u=s==null?0:s.length;for(this.clear();++a<u;){var p=s[a];this.set(p[0],p[1])}}function dy(){this.size=0,this.__data__={hash:new gn,map:new(Sr||Mi),string:new gn}}function py(s){var a=to(this,s).delete(s);return this.size-=a?1:0,a}function gy(s){return to(this,s).get(s)}function my(s){return to(this,s).has(s)}function yy(s,a){var u=to(this,s),p=u.size;return u.set(s,a),this.size+=u.size==p?0:1,this}Ri.prototype.clear=dy,Ri.prototype.delete=py,Ri.prototype.get=gy,Ri.prototype.has=my,Ri.prototype.set=yy;function mn(s){var a=-1,u=s==null?0:s.length;for(this.__data__=new Ri;++a<u;)this.add(s[a])}function wy(s){return this.__data__.set(s,f),this}function vy(s){return this.__data__.has(s)}mn.prototype.add=mn.prototype.push=wy,mn.prototype.has=vy;function Je(s){var a=this.__data__=new Mi(s);this.size=a.size}function xy(){this.__data__=new Mi,this.size=0}function by(s){var a=this.__data__,u=a.delete(s);return this.size=a.size,u}function Oy(s){return this.__data__.get(s)}function Sy(s){return this.__data__.has(s)}function ky(s,a){var u=this.__data__;if(u instanceof Mi){var p=u.__data__;if(!Sr||p.length<n-1)return p.push([s,a]),this.size=++u.size,this;u=this.__data__=new Ri(p)}return u.set(s,a),this.size=u.size,this}Je.prototype.clear=xy,Je.prototype.delete=by,Je.prototype.get=Oy,Je.prototype.has=Sy,Je.prototype.set=ky;function vu(s,a){var u=it(s),p=!u&&bn(s),y=!u&&!p&&Ji(s),x=!u&&!p&&!y&&Qn(s),O=u||p||y||x,k=O?Fl(s.length,I1):[],T=k.length;for(var E in s)(a||xt.call(s,E))&&!(O&&(E=="length"||y&&(E=="offset"||E=="parent")||x&&(E=="buffer"||E=="byteLength"||E=="byteOffset")||Ii(E,T)))&&k.push(E);return k}function xu(s){var a=s.length;return a?s[na(0,a-1)]:e}function Cy(s,a){return eo(ce(s),yn(a,0,s.length))}function Ay(s){return eo(ce(s))}function Yl(s,a,u){(u!==e&&!ti(s[a],u)||u===e&&!(a in s))&&_i(s,a,u)}function Tr(s,a,u){var p=s[a];(!(xt.call(s,a)&&ti(p,u))||u===e&&!(a in s))&&_i(s,a,u)}function Hs(s,a){for(var u=s.length;u--;)if(ti(s[u][0],a))return u;return-1}function Ty(s,a,u,p){return Ki(s,function(y,x,O){a(p,y,u(y),O)}),p}function bu(s,a){return s&&hi(a,Yt(a),s)}function Py(s,a){return s&&hi(a,pe(a),s)}function _i(s,a,u){a=="__proto__"&&Ls?Ls(s,a,{configurable:!0,enumerable:!0,value:u,writable:!0}):s[a]=u}function Xl(s,a){for(var u=-1,p=a.length,y=M(p),x=s==null;++u<p;)y[u]=x?e:Pa(s,a[u]);return y}function yn(s,a,u){return s===s&&(u!==e&&(s=s<=u?s:u),a!==e&&(s=s>=a?s:a)),s}function Ne(s,a,u,p,y,x){var O,k=a&g,T=a&m,E=a&w;if(u&&(O=y?u(s,p,y,x):u(s)),O!==e)return O;if(!_t(s))return s;var D=it(s);if(D){if(O=mw(s),!k)return ce(s,O)}else{var N=te(s),H=N==xs||N==Sf;if(Ji(s))return Uu(s,k);if(N==Pi||N==Oe||H&&!y){if(O=T||H?{}:fc(s),!k)return T?sw(s,Py(O,s)):rw(s,bu(O,s))}else{if(!Ct[N])return y?s:{};O=yw(s,N,k)}}x||(x=new Je);var Q=x.get(s);if(Q)return Q;x.set(s,O),Wc(s)?s.forEach(function(G){O.add(Ne(G,a,u,G,s,x))}):Nc(s)&&s.forEach(function(G,ft){O.set(ft,Ne(G,a,u,ft,s,x))});var K=E?T?pa:da:T?pe:Yt,st=D?e:K(s);return Ie(st||s,function(G,ft){st&&(ft=G,G=s[ft]),Tr(O,ft,Ne(G,a,u,ft,s,x))}),O}function My(s){var a=Yt(s);return function(u){return Ou(u,s,a)}}function Ou(s,a,u){var p=u.length;if(s==null)return!p;for(s=Ot(s);p--;){var y=u[p],x=a[y],O=s[y];if(O===e&&!(y in s)||!x(O))return!1}return!0}function Su(s,a,u){if(typeof s!="function")throw new Be(l);return Ir(function(){s.apply(e,u)},a)}function Pr(s,a,u,p){var y=-1,x=Cs,O=!0,k=s.length,T=[],E=a.length;if(!k)return T;u&&(a=Mt(a,ke(u))),p?(x=Il,O=!1):a.length>=n&&(x=br,O=!1,a=new mn(a));t:for(;++y<k;){var D=s[y],N=u==null?D:u(D);if(D=p||D!==0?D:0,O&&N===N){for(var H=E;H--;)if(a[H]===N)continue t;T.push(D)}else x(a,N,p)||T.push(D)}return T}var Ki=Gu(ai),ku=Gu(Gl,!0);function Ry(s,a){var u=!0;return Ki(s,function(p,y,x){return u=!!a(p,y,x),u}),u}function zs(s,a,u){for(var p=-1,y=s.length;++p<y;){var x=s[p],O=a(x);if(O!=null&&(k===e?O===O&&!Ae(O):u(O,k)))var k=O,T=x}return T}function _y(s,a,u,p){var y=s.length;for(u=nt(u),u<0&&(u=-u>y?0:y+u),p=p===e||p>y?y:nt(p),p<0&&(p+=y),p=u>p?0:Vc(p);u<p;)s[u++]=a;return s}function Cu(s,a){var u=[];return Ki(s,function(p,y,x){a(p,y,x)&&u.push(p)}),u}function Gt(s,a,u,p,y){var x=-1,O=s.length;for(u||(u=vw),y||(y=[]);++x<O;){var k=s[x];a>0&&u(k)?a>1?Gt(k,a-1,u,p,y):Qi(y,k):p||(y[y.length]=k)}return y}var Kl=Zu(),Au=Zu(!0);function ai(s,a){return s&&Kl(s,a,Yt)}function Gl(s,a){return s&&Au(s,a,Yt)}function qs(s,a){return Ui(a,function(u){return Bi(s[u])})}function wn(s,a){a=Zi(a,s);for(var u=0,p=a.length;s!=null&&u<p;)s=s[fi(a[u++])];return u&&u==p?s:e}function Tu(s,a,u){var p=a(s);return it(s)?p:Qi(p,u(s))}function re(s){return s==null?s===e?o0:r0:pn&&pn in Ot(s)?dw(s):Aw(s)}function Zl(s,a){return s>a}function Ey(s,a){return s!=null&&xt.call(s,a)}function Dy(s,a){return s!=null&&a in Ot(s)}function Iy(s,a,u){return s>=Jt(a,u)&&s<qt(a,u)}function jl(s,a,u){for(var p=u?Il:Cs,y=s[0].length,x=s.length,O=x,k=M(x),T=1/0,E=[];O--;){var D=s[O];O&&a&&(D=Mt(D,ke(a))),T=Jt(D.length,T),k[O]=!u&&(a||y>=120&&D.length>=120)?new mn(O&&D):e}D=s[0];var N=-1,H=k[0];t:for(;++N<y&&E.length<T;){var Q=D[N],K=a?a(Q):Q;if(Q=u||Q!==0?Q:0,!(H?br(H,K):p(E,K,u))){for(O=x;--O;){var st=k[O];if(!(st?br(st,K):p(s[O],K,u)))continue t}H&&H.push(K),E.push(Q)}}return E}function By(s,a,u,p){return ai(s,function(y,x,O){a(p,u(y),x,O)}),p}function Mr(s,a,u){a=Zi(a,s),s=pc(s,a);var p=s==null?s:s[fi(We(a))];return p==null?e:Se(p,s,u)}function Pu(s){return It(s)&&re(s)==Oe}function Ly(s){return It(s)&&re(s)==xr}function Ny(s){return It(s)&&re(s)==gr}function Rr(s,a,u,p,y){return s===a?!0:s==null||a==null||!It(s)&&!It(a)?s!==s&&a!==a:$y(s,a,u,p,Rr,y)}function $y(s,a,u,p,y,x){var O=it(s),k=it(a),T=O?Ti:te(s),E=k?Ti:te(a);T=T==Oe?Pi:T,E=E==Oe?Pi:E;var D=T==Pi,N=E==Pi,H=T==E;if(H&&Ji(s)){if(!Ji(a))return!1;O=!0,D=!1}if(H&&!D)return x||(x=new Je),O||Qn(s)?lc(s,a,u,p,y,x):uw(s,a,T,u,p,y,x);if(!(u&b)){var Q=D&&xt.call(s,"__wrapped__"),K=N&&xt.call(a,"__wrapped__");if(Q||K){var st=Q?s.value():s,G=K?a.value():a;return x||(x=new Je),y(st,G,u,p,x)}}return H?(x||(x=new Je),cw(s,a,u,p,y,x)):!1}function Wy(s){return It(s)&&te(s)==Ge}function Jl(s,a,u,p){var y=u.length,x=y,O=!p;if(s==null)return!x;for(s=Ot(s);y--;){var k=u[y];if(O&&k[2]?k[1]!==s[k[0]]:!(k[0]in s))return!1}for(;++y<x;){k=u[y];var T=k[0],E=s[T],D=k[1];if(O&&k[2]){if(E===e&&!(T in s))return!1}else{var N=new Je;if(p)var H=p(E,D,T,s,a,N);if(!(H===e?Rr(D,E,b|S,p,N):H))return!1}}return!0}function Mu(s){if(!_t(s)||bw(s))return!1;var a=Bi(s)?W1:M0;return a.test(xn(s))}function Fy(s){return It(s)&&re(s)==yr}function Vy(s){return It(s)&&te(s)==Ze}function Hy(s){return It(s)&&lo(s.length)&&!!Tt[re(s)]}function Ru(s){return typeof s=="function"?s:s==null?ge:typeof s=="object"?it(s)?Du(s[0],s[1]):Eu(s):jc(s)}function ta(s){if(!Dr(s))return U1(s);var a=[];for(var u in Ot(s))xt.call(s,u)&&u!="constructor"&&a.push(u);return a}function zy(s){if(!_t(s))return Cw(s);var a=Dr(s),u=[];for(var p in s)p=="constructor"&&(a||!xt.call(s,p))||u.push(p);return u}function ea(s,a){return s<a}function _u(s,a){var u=-1,p=de(s)?M(s.length):[];return Ki(s,function(y,x,O){p[++u]=a(y,x,O)}),p}function Eu(s){var a=ma(s);return a.length==1&&a[0][2]?cc(a[0][0],a[0][1]):function(u){return u===s||Jl(u,s,a)}}function Du(s,a){return wa(s)&&uc(a)?cc(fi(s),a):function(u){var p=Pa(u,s);return p===e&&p===a?Ma(u,s):Rr(a,p,b|S)}}function Us(s,a,u,p,y){s!==a&&Kl(a,function(x,O){if(y||(y=new Je),_t(x))qy(s,a,O,u,Us,p,y);else{var k=p?p(xa(s,O),x,O+"",s,a,y):e;k===e&&(k=x),Yl(s,O,k)}},pe)}function qy(s,a,u,p,y,x,O){var k=xa(s,u),T=xa(a,u),E=O.get(T);if(E){Yl(s,u,E);return}var D=x?x(k,T,u+"",s,a,O):e,N=D===e;if(N){var H=it(T),Q=!H&&Ji(T),K=!H&&!Q&&Qn(T);D=T,H||Q||K?it(k)?D=k:Lt(k)?D=ce(k):Q?(N=!1,D=Uu(T,!0)):K?(N=!1,D=Qu(T,!0)):D=[]:Br(T)||bn(T)?(D=k,bn(k)?D=Hc(k):(!_t(k)||Bi(k))&&(D=fc(T))):N=!1}N&&(O.set(T,D),y(D,T,p,x,O),O.delete(T)),Yl(s,u,D)}function Iu(s,a){var u=s.length;if(u)return a+=a<0?u:0,Ii(a,u)?s[a]:e}function Bu(s,a,u){a.length?a=Mt(a,function(x){return it(x)?function(O){return wn(O,x.length===1?x[0]:x)}:x}):a=[ge];var p=-1;a=Mt(a,ke(X()));var y=_u(s,function(x,O,k){var T=Mt(a,function(E){return E(x)});return{criteria:T,index:++p,value:x}});return y1(y,function(x,O){return nw(x,O,u)})}function Uy(s,a){return Lu(s,a,function(u,p){return Ma(s,p)})}function Lu(s,a,u){for(var p=-1,y=a.length,x={};++p<y;){var O=a[p],k=wn(s,O);u(k,O)&&_r(x,Zi(O,s),k)}return x}function Qy(s){return function(a){return wn(a,s)}}function ia(s,a,u,p){var y=p?m1:Bn,x=-1,O=a.length,k=s;for(s===a&&(a=ce(a)),u&&(k=Mt(s,ke(u)));++x<O;)for(var T=0,E=a[x],D=u?u(E):E;(T=y(k,D,T,p))>-1;)k!==s&&Bs.call(k,T,1),Bs.call(s,T,1);return s}function Nu(s,a){for(var u=s?a.length:0,p=u-1;u--;){var y=a[u];if(u==p||y!==x){var x=y;Ii(y)?Bs.call(s,y,1):oa(s,y)}}return s}function na(s,a){return s+$s(yu()*(a-s+1))}function Yy(s,a,u,p){for(var y=-1,x=qt(Ns((a-s)/(u||1)),0),O=M(x);x--;)O[p?x:++y]=s,s+=u;return O}function ra(s,a){var u="";if(!s||a<1||a>Ke)return u;do a%2&&(u+=s),a=$s(a/2),a&&(s+=s);while(a);return u}function ot(s,a){return ba(dc(s,a,ge),s+"")}function Xy(s){return xu(Yn(s))}function Ky(s,a){var u=Yn(s);return eo(u,yn(a,0,u.length))}function _r(s,a,u,p){if(!_t(s))return s;a=Zi(a,s);for(var y=-1,x=a.length,O=x-1,k=s;k!=null&&++y<x;){var T=fi(a[y]),E=u;if(T==="__proto__"||T==="constructor"||T==="prototype")return s;if(y!=O){var D=k[T];E=p?p(D,T,k):e,E===e&&(E=_t(D)?D:Ii(a[y+1])?[]:{})}Tr(k,T,E),k=k[T]}return s}var $u=Ws?function(s,a){return Ws.set(s,a),s}:ge,Gy=Ls?function(s,a){return Ls(s,"toString",{configurable:!0,enumerable:!1,value:_a(a),writable:!0})}:ge;function Zy(s){return eo(Yn(s))}function $e(s,a,u){var p=-1,y=s.length;a<0&&(a=-a>y?0:y+a),u=u>y?y:u,u<0&&(u+=y),y=a>u?0:u-a>>>0,a>>>=0;for(var x=M(y);++p<y;)x[p]=s[p+a];return x}function jy(s,a){var u;return Ki(s,function(p,y,x){return u=a(p,y,x),!u}),!!u}function Qs(s,a,u){var p=0,y=s==null?p:s.length;if(typeof a=="number"&&a===a&&y<=Ee){for(;p<y;){var x=p+y>>>1,O=s[x];O!==null&&!Ae(O)&&(u?O<=a:O<a)?p=x+1:y=x}return y}return sa(s,a,ge,u)}function sa(s,a,u,p){var y=0,x=s==null?0:s.length;if(x===0)return 0;a=u(a);for(var O=a!==a,k=a===null,T=Ae(a),E=a===e;y<x;){var D=$s((y+x)/2),N=u(s[D]),H=N!==e,Q=N===null,K=N===N,st=Ae(N);if(O)var G=p||K;else E?G=K&&(p||H):k?G=K&&H&&(p||!Q):T?G=K&&H&&!Q&&(p||!st):Q||st?G=!1:G=p?N<=a:N<a;G?y=D+1:x=D}return Jt(x,ue)}function Wu(s,a){for(var u=-1,p=s.length,y=0,x=[];++u<p;){var O=s[u],k=a?a(O):O;if(!u||!ti(k,T)){var T=k;x[y++]=O===0?0:O}}return x}function Fu(s){return typeof s=="number"?s:Ae(s)?cn:+s}function Ce(s){if(typeof s=="string")return s;if(it(s))return Mt(s,Ce)+"";if(Ae(s))return wu?wu.call(s):"";var a=s+"";return a=="0"&&1/s==-1/0?"-0":a}function Gi(s,a,u){var p=-1,y=Cs,x=s.length,O=!0,k=[],T=k;if(u)O=!1,y=Il;else if(x>=n){var E=a?null:hw(s);if(E)return Ts(E);O=!1,y=br,T=new mn}else T=a?[]:k;t:for(;++p<x;){var D=s[p],N=a?a(D):D;if(D=u||D!==0?D:0,O&&N===N){for(var H=T.length;H--;)if(T[H]===N)continue t;a&&T.push(N),k.push(D)}else y(T,N,u)||(T!==k&&T.push(N),k.push(D))}return k}function oa(s,a){return a=Zi(a,s),s=pc(s,a),s==null||delete s[fi(We(a))]}function Vu(s,a,u,p){return _r(s,a,u(wn(s,a)),p)}function Ys(s,a,u,p){for(var y=s.length,x=p?y:-1;(p?x--:++x<y)&&a(s[x],x,s););return u?$e(s,p?0:x,p?x+1:y):$e(s,p?x+1:0,p?y:x)}function Hu(s,a){var u=s;return u instanceof ut&&(u=u.value()),Bl(a,function(p,y){return y.func.apply(y.thisArg,Qi([p],y.args))},u)}function la(s,a,u){var p=s.length;if(p<2)return p?Gi(s[0]):[];for(var y=-1,x=M(p);++y<p;)for(var O=s[y],k=-1;++k<p;)k!=y&&(x[y]=Pr(x[y]||O,s[k],a,u));return Gi(Gt(x,1),a,u)}function zu(s,a,u){for(var p=-1,y=s.length,x=a.length,O={};++p<y;){var k=p<x?a[p]:e;u(O,s[p],k)}return O}function aa(s){return Lt(s)?s:[]}function ha(s){return typeof s=="function"?s:ge}function Zi(s,a){return it(s)?s:wa(s,a)?[s]:wc(wt(s))}var Jy=ot;function ji(s,a,u){var p=s.length;return u=u===e?p:u,!a&&u>=p?s:$e(s,a,u)}var qu=F1||function(s){return Kt.clearTimeout(s)};function Uu(s,a){if(a)return s.slice();var u=s.length,p=cu?cu(u):new s.constructor(u);return s.copy(p),p}function fa(s){var a=new s.constructor(s.byteLength);return new Ds(a).set(new Ds(s)),a}function tw(s,a){var u=a?fa(s.buffer):s.buffer;return new s.constructor(u,s.byteOffset,s.byteLength)}function ew(s){var a=new s.constructor(s.source,Pf.exec(s));return a.lastIndex=s.lastIndex,a}function iw(s){return Ar?Ot(Ar.call(s)):{}}function Qu(s,a){var u=a?fa(s.buffer):s.buffer;return new s.constructor(u,s.byteOffset,s.length)}function Yu(s,a){if(s!==a){var u=s!==e,p=s===null,y=s===s,x=Ae(s),O=a!==e,k=a===null,T=a===a,E=Ae(a);if(!k&&!E&&!x&&s>a||x&&O&&T&&!k&&!E||p&&O&&T||!u&&T||!y)return 1;if(!p&&!x&&!E&&s<a||E&&u&&y&&!p&&!x||k&&u&&y||!O&&y||!T)return-1}return 0}function nw(s,a,u){for(var p=-1,y=s.criteria,x=a.criteria,O=y.length,k=u.length;++p<O;){var T=Yu(y[p],x[p]);if(T){if(p>=k)return T;var E=u[p];return T*(E=="desc"?-1:1)}}return s.index-a.index}function Xu(s,a,u,p){for(var y=-1,x=s.length,O=u.length,k=-1,T=a.length,E=qt(x-O,0),D=M(T+E),N=!p;++k<T;)D[k]=a[k];for(;++y<O;)(N||y<x)&&(D[u[y]]=s[y]);for(;E--;)D[k++]=s[y++];return D}function Ku(s,a,u,p){for(var y=-1,x=s.length,O=-1,k=u.length,T=-1,E=a.length,D=qt(x-k,0),N=M(D+E),H=!p;++y<D;)N[y]=s[y];for(var Q=y;++T<E;)N[Q+T]=a[T];for(;++O<k;)(H||y<x)&&(N[Q+u[O]]=s[y++]);return N}function ce(s,a){var u=-1,p=s.length;for(a||(a=M(p));++u<p;)a[u]=s[u];return a}function hi(s,a,u,p){var y=!u;u||(u={});for(var x=-1,O=a.length;++x<O;){var k=a[x],T=p?p(u[k],s[k],k,u,s):e;T===e&&(T=s[k]),y?_i(u,k,T):Tr(u,k,T)}return u}function rw(s,a){return hi(s,ya(s),a)}function sw(s,a){return hi(s,ac(s),a)}function Xs(s,a){return function(u,p){var y=it(u)?f1:Ty,x=a?a():{};return y(u,s,X(p,2),x)}}function zn(s){return ot(function(a,u){var p=-1,y=u.length,x=y>1?u[y-1]:e,O=y>2?u[2]:e;for(x=s.length>3&&typeof x=="function"?(y--,x):e,O&&se(u[0],u[1],O)&&(x=y<3?e:x,y=1),a=Ot(a);++p<y;){var k=u[p];k&&s(a,k,p,x)}return a})}function Gu(s,a){return function(u,p){if(u==null)return u;if(!de(u))return s(u,p);for(var y=u.length,x=a?y:-1,O=Ot(u);(a?x--:++x<y)&&p(O[x],x,O)!==!1;);return u}}function Zu(s){return function(a,u,p){for(var y=-1,x=Ot(a),O=p(a),k=O.length;k--;){var T=O[s?k:++y];if(u(x[T],T,x)===!1)break}return a}}function ow(s,a,u){var p=a&C,y=Er(s);function x(){var O=this&&this!==Kt&&this instanceof x?y:s;return O.apply(p?u:this,arguments)}return x}function ju(s){return function(a){a=wt(a);var u=Ln(a)?je(a):e,p=u?u[0]:a.charAt(0),y=u?ji(u,1).join(""):a.slice(1);return p[s]()+y}}function qn(s){return function(a){return Bl(Gc(Kc(a).replace(G0,"")),s,"")}}function Er(s){return function(){var a=arguments;switch(a.length){case 0:return new s;case 1:return new s(a[0]);case 2:return new s(a[0],a[1]);case 3:return new s(a[0],a[1],a[2]);case 4:return new s(a[0],a[1],a[2],a[3]);case 5:return new s(a[0],a[1],a[2],a[3],a[4]);case 6:return new s(a[0],a[1],a[2],a[3],a[4],a[5]);case 7:return new s(a[0],a[1],a[2],a[3],a[4],a[5],a[6])}var u=Hn(s.prototype),p=s.apply(u,a);return _t(p)?p:u}}function lw(s,a,u){var p=Er(s);function y(){for(var x=arguments.length,O=M(x),k=x,T=Un(y);k--;)O[k]=arguments[k];var E=x<3&&O[0]!==T&&O[x-1]!==T?[]:Yi(O,T);if(x-=E.length,x<u)return nc(s,a,Ks,y.placeholder,e,O,E,e,e,u-x);var D=this&&this!==Kt&&this instanceof y?p:s;return Se(D,this,O)}return y}function Ju(s){return function(a,u,p){var y=Ot(a);if(!de(a)){var x=X(u,3);a=Yt(a),u=function(k){return x(y[k],k,y)}}var O=s(a,u,p);return O>-1?y[x?a[O]:O]:e}}function tc(s){return Di(function(a){var u=a.length,p=u,y=Le.prototype.thru;for(s&&a.reverse();p--;){var x=a[p];if(typeof x!="function")throw new Be(l);if(y&&!O&&Js(x)=="wrapper")var O=new Le([],!0)}for(p=O?p:u;++p<u;){x=a[p];var k=Js(x),T=k=="wrapper"?ga(x):e;T&&va(T[0])&&T[1]==(F|L|$|J)&&!T[4].length&&T[9]==1?O=O[Js(T[0])].apply(O,T[3]):O=x.length==1&&va(x)?O[k]():O.thru(x)}return function(){var E=arguments,D=E[0];if(O&&E.length==1&&it(D))return O.plant(D).value();for(var N=0,H=u?a[N].apply(this,E):D;++N<u;)H=a[N].call(this,H);return H}})}function Ks(s,a,u,p,y,x,O,k,T,E){var D=a&F,N=a&C,H=a&P,Q=a&(L|_),K=a&rt,st=H?e:Er(s);function G(){for(var ft=arguments.length,dt=M(ft),Te=ft;Te--;)dt[Te]=arguments[Te];if(Q)var oe=Un(G),Pe=v1(dt,oe);if(p&&(dt=Xu(dt,p,y,Q)),x&&(dt=Ku(dt,x,O,Q)),ft-=Pe,Q&&ft<E){var Nt=Yi(dt,oe);return nc(s,a,Ks,G.placeholder,u,dt,Nt,k,T,E-ft)}var ei=N?u:this,Ni=H?ei[s]:s;return ft=dt.length,k?dt=Tw(dt,k):K&&ft>1&&dt.reverse(),D&&T<ft&&(dt.length=T),this&&this!==Kt&&this instanceof G&&(Ni=st||Er(Ni)),Ni.apply(ei,dt)}return G}function ec(s,a){return function(u,p){return By(u,s,a(p),{})}}function Gs(s,a){return function(u,p){var y;if(u===e&&p===e)return a;if(u!==e&&(y=u),p!==e){if(y===e)return p;typeof u=="string"||typeof p=="string"?(u=Ce(u),p=Ce(p)):(u=Fu(u),p=Fu(p)),y=s(u,p)}return y}}function ua(s){return Di(function(a){return a=Mt(a,ke(X())),ot(function(u){var p=this;return s(a,function(y){return Se(y,p,u)})})})}function Zs(s,a){a=a===e?" ":Ce(a);var u=a.length;if(u<2)return u?ra(a,s):a;var p=ra(a,Ns(s/Nn(a)));return Ln(a)?ji(je(p),0,s).join(""):p.slice(0,s)}function aw(s,a,u,p){var y=a&C,x=Er(s);function O(){for(var k=-1,T=arguments.length,E=-1,D=p.length,N=M(D+T),H=this&&this!==Kt&&this instanceof O?x:s;++E<D;)N[E]=p[E];for(;T--;)N[E++]=arguments[++k];return Se(H,y?u:this,N)}return O}function ic(s){return function(a,u,p){return p&&typeof p!="number"&&se(a,u,p)&&(u=p=e),a=Li(a),u===e?(u=a,a=0):u=Li(u),p=p===e?a<u?1:-1:Li(p),Yy(a,u,p,s)}}function js(s){return function(a,u){return typeof a=="string"&&typeof u=="string"||(a=Fe(a),u=Fe(u)),s(a,u)}}function nc(s,a,u,p,y,x,O,k,T,E){var D=a&L,N=D?O:e,H=D?e:O,Q=D?x:e,K=D?e:x;a|=D?$:W,a&=~(D?W:$),a&B||(a&=-4);var st=[s,a,y,Q,N,K,H,k,T,E],G=u.apply(e,st);return va(s)&&gc(G,st),G.placeholder=p,mc(G,s,a)}function ca(s){var a=zt[s];return function(u,p){if(u=Fe(u),p=p==null?0:Jt(nt(p),292),p&&mu(u)){var y=(wt(u)+"e").split("e"),x=a(y[0]+"e"+(+y[1]+p));return y=(wt(x)+"e").split("e"),+(y[0]+"e"+(+y[1]-p))}return a(u)}}var hw=Fn&&1/Ts(new Fn([,-0]))[1]==li?function(s){return new Fn(s)}:Ia;function rc(s){return function(a){var u=te(a);return u==Ge?Hl(a):u==Ze?A1(a):w1(a,s(a))}}function Ei(s,a,u,p,y,x,O,k){var T=a&P;if(!T&&typeof s!="function")throw new Be(l);var E=p?p.length:0;if(E||(a&=-97,p=y=e),O=O===e?O:qt(nt(O),0),k=k===e?k:nt(k),E-=y?y.length:0,a&W){var D=p,N=y;p=y=e}var H=T?e:ga(s),Q=[s,a,u,p,y,D,N,x,O,k];if(H&&kw(Q,H),s=Q[0],a=Q[1],u=Q[2],p=Q[3],y=Q[4],k=Q[9]=Q[9]===e?T?0:s.length:qt(Q[9]-E,0),!k&&a&(L|_)&&(a&=-25),!a||a==C)var K=ow(s,a,u);else a==L||a==_?K=lw(s,a,k):(a==$||a==(C|$))&&!y.length?K=aw(s,a,u,p):K=Ks.apply(e,Q);var st=H?$u:gc;return mc(st(K,Q),s,a)}function sc(s,a,u,p){return s===e||ti(s,Wn[u])&&!xt.call(p,u)?a:s}function oc(s,a,u,p,y,x){return _t(s)&&_t(a)&&(x.set(a,s),Us(s,a,e,oc,x),x.delete(a)),s}function fw(s){return Br(s)?e:s}function lc(s,a,u,p,y,x){var O=u&b,k=s.length,T=a.length;if(k!=T&&!(O&&T>k))return!1;var E=x.get(s),D=x.get(a);if(E&&D)return E==a&&D==s;var N=-1,H=!0,Q=u&S?new mn:e;for(x.set(s,a),x.set(a,s);++N<k;){var K=s[N],st=a[N];if(p)var G=O?p(st,K,N,a,s,x):p(K,st,N,s,a,x);if(G!==e){if(G)continue;H=!1;break}if(Q){if(!Ll(a,function(ft,dt){if(!br(Q,dt)&&(K===ft||y(K,ft,u,p,x)))return Q.push(dt)})){H=!1;break}}else if(!(K===st||y(K,st,u,p,x))){H=!1;break}}return x.delete(s),x.delete(a),H}function uw(s,a,u,p,y,x,O){switch(u){case Dn:if(s.byteLength!=a.byteLength||s.byteOffset!=a.byteOffset)return!1;s=s.buffer,a=a.buffer;case xr:return!(s.byteLength!=a.byteLength||!x(new Ds(s),new Ds(a)));case pr:case gr:case mr:return ti(+s,+a);case vs:return s.name==a.name&&s.message==a.message;case yr:case wr:return s==a+"";case Ge:var k=Hl;case Ze:var T=p&b;if(k||(k=Ts),s.size!=a.size&&!T)return!1;var E=O.get(s);if(E)return E==a;p|=S,O.set(s,a);var D=lc(k(s),k(a),p,y,x,O);return O.delete(s),D;case bs:if(Ar)return Ar.call(s)==Ar.call(a)}return!1}function cw(s,a,u,p,y,x){var O=u&b,k=da(s),T=k.length,E=da(a),D=E.length;if(T!=D&&!O)return!1;for(var N=T;N--;){var H=k[N];if(!(O?H in a:xt.call(a,H)))return!1}var Q=x.get(s),K=x.get(a);if(Q&&K)return Q==a&&K==s;var st=!0;x.set(s,a),x.set(a,s);for(var G=O;++N<T;){H=k[N];var ft=s[H],dt=a[H];if(p)var Te=O?p(dt,ft,H,a,s,x):p(ft,dt,H,s,a,x);if(!(Te===e?ft===dt||y(ft,dt,u,p,x):Te)){st=!1;break}G||(G=H=="constructor")}if(st&&!G){var oe=s.constructor,Pe=a.constructor;oe!=Pe&&"constructor"in s&&"constructor"in a&&!(typeof oe=="function"&&oe instanceof oe&&typeof Pe=="function"&&Pe instanceof Pe)&&(st=!1)}return x.delete(s),x.delete(a),st}function Di(s){return ba(dc(s,e,Oc),s+"")}function da(s){return Tu(s,Yt,ya)}function pa(s){return Tu(s,pe,ac)}var ga=Ws?function(s){return Ws.get(s)}:Ia;function Js(s){for(var a=s.name+"",u=Vn[a],p=xt.call(Vn,a)?u.length:0;p--;){var y=u[p],x=y.func;if(x==null||x==s)return y.name}return a}function Un(s){var a=xt.call(v,"placeholder")?v:s;return a.placeholder}function X(){var s=v.iteratee||Ea;return s=s===Ea?Ru:s,arguments.length?s(arguments[0],arguments[1]):s}function to(s,a){var u=s.__data__;return xw(a)?u[typeof a=="string"?"string":"hash"]:u.map}function ma(s){for(var a=Yt(s),u=a.length;u--;){var p=a[u],y=s[p];a[u]=[p,y,uc(y)]}return a}function vn(s,a){var u=S1(s,a);return Mu(u)?u:e}function dw(s){var a=xt.call(s,pn),u=s[pn];try{s[pn]=e;var p=!0}catch{}var y=_s.call(s);return p&&(a?s[pn]=u:delete s[pn]),y}var ya=ql?function(s){return s==null?[]:(s=Ot(s),Ui(ql(s),function(a){return pu.call(s,a)}))}:Ba,ac=ql?function(s){for(var a=[];s;)Qi(a,ya(s)),s=Is(s);return a}:Ba,te=re;(Ul&&te(new Ul(new ArrayBuffer(1)))!=Dn||Sr&&te(new Sr)!=Ge||Ql&&te(Ql.resolve())!=kf||Fn&&te(new Fn)!=Ze||kr&&te(new kr)!=vr)&&(te=function(s){var a=re(s),u=a==Pi?s.constructor:e,p=u?xn(u):"";if(p)switch(p){case K1:return Dn;case G1:return Ge;case Z1:return kf;case j1:return Ze;case J1:return vr}return a});function pw(s,a,u){for(var p=-1,y=u.length;++p<y;){var x=u[p],O=x.size;switch(x.type){case"drop":s+=O;break;case"dropRight":a-=O;break;case"take":a=Jt(a,s+O);break;case"takeRight":s=qt(s,a-O);break}}return{start:s,end:a}}function gw(s){var a=s.match(b0);return a?a[1].split(O0):[]}function hc(s,a,u){a=Zi(a,s);for(var p=-1,y=a.length,x=!1;++p<y;){var O=fi(a[p]);if(!(x=s!=null&&u(s,O)))break;s=s[O]}return x||++p!=y?x:(y=s==null?0:s.length,!!y&&lo(y)&&Ii(O,y)&&(it(s)||bn(s)))}function mw(s){var a=s.length,u=new s.constructor(a);return a&&typeof s[0]=="string"&&xt.call(s,"index")&&(u.index=s.index,u.input=s.input),u}function fc(s){return typeof s.constructor=="function"&&!Dr(s)?Hn(Is(s)):{}}function yw(s,a,u){var p=s.constructor;switch(a){case xr:return fa(s);case pr:case gr:return new p(+s);case Dn:return tw(s,u);case ml:case yl:case wl:case vl:case xl:case bl:case Ol:case Sl:case kl:return Qu(s,u);case Ge:return new p;case mr:case wr:return new p(s);case yr:return ew(s);case Ze:return new p;case bs:return iw(s)}}function ww(s,a){var u=a.length;if(!u)return s;var p=u-1;return a[p]=(u>1?"& ":"")+a[p],a=a.join(u>2?", ":" "),s.replace(x0,`{
/* [wrapped with `+a+`] */
`)}function vw(s){return it(s)||bn(s)||!!(gu&&s&&s[gu])}function Ii(s,a){var u=typeof s;return a=a??Ke,!!a&&(u=="number"||u!="symbol"&&_0.test(s))&&s>-1&&s%1==0&&s<a}function se(s,a,u){if(!_t(u))return!1;var p=typeof a;return(p=="number"?de(u)&&Ii(a,u.length):p=="string"&&a in u)?ti(u[a],s):!1}function wa(s,a){if(it(s))return!1;var u=typeof s;return u=="number"||u=="symbol"||u=="boolean"||s==null||Ae(s)?!0:m0.test(s)||!g0.test(s)||a!=null&&s in Ot(a)}function xw(s){var a=typeof s;return a=="string"||a=="number"||a=="symbol"||a=="boolean"?s!=="__proto__":s===null}function va(s){var a=Js(s),u=v[a];if(typeof u!="function"||!(a in ut.prototype))return!1;if(s===u)return!0;var p=ga(u);return!!p&&s===p[0]}function bw(s){return!!uu&&uu in s}var Ow=Ms?Bi:La;function Dr(s){var a=s&&s.constructor,u=typeof a=="function"&&a.prototype||Wn;return s===u}function uc(s){return s===s&&!_t(s)}function cc(s,a){return function(u){return u==null?!1:u[s]===a&&(a!==e||s in Ot(u))}}function Sw(s){var a=so(s,function(p){return u.size===c&&u.clear(),p}),u=a.cache;return a}function kw(s,a){var u=s[1],p=a[1],y=u|p,x=y<(C|P|F),O=p==F&&u==L||p==F&&u==J&&s[7].length<=a[8]||p==(F|J)&&a[7].length<=a[8]&&u==L;if(!(x||O))return s;p&C&&(s[2]=a[2],y|=u&C?0:B);var k=a[3];if(k){var T=s[3];s[3]=T?Xu(T,k,a[4]):k,s[4]=T?Yi(s[3],d):a[4]}return k=a[5],k&&(T=s[5],s[5]=T?Ku(T,k,a[6]):k,s[6]=T?Yi(s[5],d):a[6]),k=a[7],k&&(s[7]=k),p&F&&(s[8]=s[8]==null?a[8]:Jt(s[8],a[8])),s[9]==null&&(s[9]=a[9]),s[0]=a[0],s[1]=y,s}function Cw(s){var a=[];if(s!=null)for(var u in Ot(s))a.push(u);return a}function Aw(s){return _s.call(s)}function dc(s,a,u){return a=qt(a===e?s.length-1:a,0),function(){for(var p=arguments,y=-1,x=qt(p.length-a,0),O=M(x);++y<x;)O[y]=p[a+y];y=-1;for(var k=M(a+1);++y<a;)k[y]=p[y];return k[a]=u(O),Se(s,this,k)}}function pc(s,a){return a.length<2?s:wn(s,$e(a,0,-1))}function Tw(s,a){for(var u=s.length,p=Jt(a.length,u),y=ce(s);p--;){var x=a[p];s[p]=Ii(x,u)?y[x]:e}return s}function xa(s,a){if(!(a==="constructor"&&typeof s[a]=="function")&&a!="__proto__")return s[a]}var gc=yc($u),Ir=H1||function(s,a){return Kt.setTimeout(s,a)},ba=yc(Gy);function mc(s,a,u){var p=a+"";return ba(s,ww(p,Pw(gw(p),u)))}function yc(s){var a=0,u=0;return function(){var p=Q1(),y=et-(p-u);if(u=p,y>0){if(++a>=j)return arguments[0]}else a=0;return s.apply(e,arguments)}}function eo(s,a){var u=-1,p=s.length,y=p-1;for(a=a===e?p:a;++u<a;){var x=na(u,y),O=s[x];s[x]=s[u],s[u]=O}return s.length=a,s}var wc=Sw(function(s){var a=[];return s.charCodeAt(0)===46&&a.push(""),s.replace(y0,function(u,p,y,x){a.push(y?x.replace(C0,"$1"):p||u)}),a});function fi(s){if(typeof s=="string"||Ae(s))return s;var a=s+"";return a=="0"&&1/s==-1/0?"-0":a}function xn(s){if(s!=null){try{return Rs.call(s)}catch{}try{return s+""}catch{}}return""}function Pw(s,a){return Ie(Ai,function(u){var p="_."+u[0];a&u[1]&&!Cs(s,p)&&s.push(p)}),s.sort()}function vc(s){if(s instanceof ut)return s.clone();var a=new Le(s.__wrapped__,s.__chain__);return a.__actions__=ce(s.__actions__),a.__index__=s.__index__,a.__values__=s.__values__,a}function Mw(s,a,u){(u?se(s,a,u):a===e)?a=1:a=qt(nt(a),0);var p=s==null?0:s.length;if(!p||a<1)return[];for(var y=0,x=0,O=M(Ns(p/a));y<p;)O[x++]=$e(s,y,y+=a);return O}function Rw(s){for(var a=-1,u=s==null?0:s.length,p=0,y=[];++a<u;){var x=s[a];x&&(y[p++]=x)}return y}function _w(){var s=arguments.length;if(!s)return[];for(var a=M(s-1),u=arguments[0],p=s;p--;)a[p-1]=arguments[p];return Qi(it(u)?ce(u):[u],Gt(a,1))}var Ew=ot(function(s,a){return Lt(s)?Pr(s,Gt(a,1,Lt,!0)):[]}),Dw=ot(function(s,a){var u=We(a);return Lt(u)&&(u=e),Lt(s)?Pr(s,Gt(a,1,Lt,!0),X(u,2)):[]}),Iw=ot(function(s,a){var u=We(a);return Lt(u)&&(u=e),Lt(s)?Pr(s,Gt(a,1,Lt,!0),e,u):[]});function Bw(s,a,u){var p=s==null?0:s.length;return p?(a=u||a===e?1:nt(a),$e(s,a<0?0:a,p)):[]}function Lw(s,a,u){var p=s==null?0:s.length;return p?(a=u||a===e?1:nt(a),a=p-a,$e(s,0,a<0?0:a)):[]}function Nw(s,a){return s&&s.length?Ys(s,X(a,3),!0,!0):[]}function $w(s,a){return s&&s.length?Ys(s,X(a,3),!0):[]}function Ww(s,a,u,p){var y=s==null?0:s.length;return y?(u&&typeof u!="number"&&se(s,a,u)&&(u=0,p=y),_y(s,a,u,p)):[]}function xc(s,a,u){var p=s==null?0:s.length;if(!p)return-1;var y=u==null?0:nt(u);return y<0&&(y=qt(p+y,0)),As(s,X(a,3),y)}function bc(s,a,u){var p=s==null?0:s.length;if(!p)return-1;var y=p-1;return u!==e&&(y=nt(u),y=u<0?qt(p+y,0):Jt(y,p-1)),As(s,X(a,3),y,!0)}function Oc(s){var a=s==null?0:s.length;return a?Gt(s,1):[]}function Fw(s){var a=s==null?0:s.length;return a?Gt(s,li):[]}function Vw(s,a){var u=s==null?0:s.length;return u?(a=a===e?1:nt(a),Gt(s,a)):[]}function Hw(s){for(var a=-1,u=s==null?0:s.length,p={};++a<u;){var y=s[a];p[y[0]]=y[1]}return p}function Sc(s){return s&&s.length?s[0]:e}function zw(s,a,u){var p=s==null?0:s.length;if(!p)return-1;var y=u==null?0:nt(u);return y<0&&(y=qt(p+y,0)),Bn(s,a,y)}function qw(s){var a=s==null?0:s.length;return a?$e(s,0,-1):[]}var Uw=ot(function(s){var a=Mt(s,aa);return a.length&&a[0]===s[0]?jl(a):[]}),Qw=ot(function(s){var a=We(s),u=Mt(s,aa);return a===We(u)?a=e:u.pop(),u.length&&u[0]===s[0]?jl(u,X(a,2)):[]}),Yw=ot(function(s){var a=We(s),u=Mt(s,aa);return a=typeof a=="function"?a:e,a&&u.pop(),u.length&&u[0]===s[0]?jl(u,e,a):[]});function Xw(s,a){return s==null?"":q1.call(s,a)}function We(s){var a=s==null?0:s.length;return a?s[a-1]:e}function Kw(s,a,u){var p=s==null?0:s.length;if(!p)return-1;var y=p;return u!==e&&(y=nt(u),y=y<0?qt(p+y,0):Jt(y,p-1)),a===a?P1(s,a,y):As(s,nu,y,!0)}function Gw(s,a){return s&&s.length?Iu(s,nt(a)):e}var Zw=ot(kc);function kc(s,a){return s&&s.length&&a&&a.length?ia(s,a):s}function jw(s,a,u){return s&&s.length&&a&&a.length?ia(s,a,X(u,2)):s}function Jw(s,a,u){return s&&s.length&&a&&a.length?ia(s,a,e,u):s}var tv=Di(function(s,a){var u=s==null?0:s.length,p=Xl(s,a);return Nu(s,Mt(a,function(y){return Ii(y,u)?+y:y}).sort(Yu)),p});function ev(s,a){var u=[];if(!(s&&s.length))return u;var p=-1,y=[],x=s.length;for(a=X(a,3);++p<x;){var O=s[p];a(O,p,s)&&(u.push(O),y.push(p))}return Nu(s,y),u}function Oa(s){return s==null?s:X1.call(s)}function iv(s,a,u){var p=s==null?0:s.length;return p?(u&&typeof u!="number"&&se(s,a,u)?(a=0,u=p):(a=a==null?0:nt(a),u=u===e?p:nt(u)),$e(s,a,u)):[]}function nv(s,a){return Qs(s,a)}function rv(s,a,u){return sa(s,a,X(u,2))}function sv(s,a){var u=s==null?0:s.length;if(u){var p=Qs(s,a);if(p<u&&ti(s[p],a))return p}return-1}function ov(s,a){return Qs(s,a,!0)}function lv(s,a,u){return sa(s,a,X(u,2),!0)}function av(s,a){var u=s==null?0:s.length;if(u){var p=Qs(s,a,!0)-1;if(ti(s[p],a))return p}return-1}function hv(s){return s&&s.length?Wu(s):[]}function fv(s,a){return s&&s.length?Wu(s,X(a,2)):[]}function uv(s){var a=s==null?0:s.length;return a?$e(s,1,a):[]}function cv(s,a,u){return s&&s.length?(a=u||a===e?1:nt(a),$e(s,0,a<0?0:a)):[]}function dv(s,a,u){var p=s==null?0:s.length;return p?(a=u||a===e?1:nt(a),a=p-a,$e(s,a<0?0:a,p)):[]}function pv(s,a){return s&&s.length?Ys(s,X(a,3),!1,!0):[]}function gv(s,a){return s&&s.length?Ys(s,X(a,3)):[]}var mv=ot(function(s){return Gi(Gt(s,1,Lt,!0))}),yv=ot(function(s){var a=We(s);return Lt(a)&&(a=e),Gi(Gt(s,1,Lt,!0),X(a,2))}),wv=ot(function(s){var a=We(s);return a=typeof a=="function"?a:e,Gi(Gt(s,1,Lt,!0),e,a)});function vv(s){return s&&s.length?Gi(s):[]}function xv(s,a){return s&&s.length?Gi(s,X(a,2)):[]}function bv(s,a){return a=typeof a=="function"?a:e,s&&s.length?Gi(s,e,a):[]}function Sa(s){if(!(s&&s.length))return[];var a=0;return s=Ui(s,function(u){if(Lt(u))return a=qt(u.length,a),!0}),Fl(a,function(u){return Mt(s,Nl(u))})}function Cc(s,a){if(!(s&&s.length))return[];var u=Sa(s);return a==null?u:Mt(u,function(p){return Se(a,e,p)})}var Ov=ot(function(s,a){return Lt(s)?Pr(s,a):[]}),Sv=ot(function(s){return la(Ui(s,Lt))}),kv=ot(function(s){var a=We(s);return Lt(a)&&(a=e),la(Ui(s,Lt),X(a,2))}),Cv=ot(function(s){var a=We(s);return a=typeof a=="function"?a:e,la(Ui(s,Lt),e,a)}),Av=ot(Sa);function Tv(s,a){return zu(s||[],a||[],Tr)}function Pv(s,a){return zu(s||[],a||[],_r)}var Mv=ot(function(s){var a=s.length,u=a>1?s[a-1]:e;return u=typeof u=="function"?(s.pop(),u):e,Cc(s,u)});function Ac(s){var a=v(s);return a.__chain__=!0,a}function Rv(s,a){return a(s),s}function io(s,a){return a(s)}var _v=Di(function(s){var a=s.length,u=a?s[0]:0,p=this.__wrapped__,y=function(x){return Xl(x,s)};return a>1||this.__actions__.length||!(p instanceof ut)||!Ii(u)?this.thru(y):(p=p.slice(u,+u+(a?1:0)),p.__actions__.push({func:io,args:[y],thisArg:e}),new Le(p,this.__chain__).thru(function(x){return a&&!x.length&&x.push(e),x}))});function Ev(){return Ac(this)}function Dv(){return new Le(this.value(),this.__chain__)}function Iv(){this.__values__===e&&(this.__values__=Fc(this.value()));var s=this.__index__>=this.__values__.length,a=s?e:this.__values__[this.__index__++];return{done:s,value:a}}function Bv(){return this}function Lv(s){for(var a,u=this;u instanceof Vs;){var p=vc(u);p.__index__=0,p.__values__=e,a?y.__wrapped__=p:a=p;var y=p;u=u.__wrapped__}return y.__wrapped__=s,a}function Nv(){var s=this.__wrapped__;if(s instanceof ut){var a=s;return this.__actions__.length&&(a=new ut(this)),a=a.reverse(),a.__actions__.push({func:io,args:[Oa],thisArg:e}),new Le(a,this.__chain__)}return this.thru(Oa)}function $v(){return Hu(this.__wrapped__,this.__actions__)}var Wv=Xs(function(s,a,u){xt.call(s,u)?++s[u]:_i(s,u,1)});function Fv(s,a,u){var p=it(s)?eu:Ry;return u&&se(s,a,u)&&(a=e),p(s,X(a,3))}function Vv(s,a){var u=it(s)?Ui:Cu;return u(s,X(a,3))}var Hv=Ju(xc),zv=Ju(bc);function qv(s,a){return Gt(no(s,a),1)}function Uv(s,a){return Gt(no(s,a),li)}function Qv(s,a,u){return u=u===e?1:nt(u),Gt(no(s,a),u)}function Tc(s,a){var u=it(s)?Ie:Ki;return u(s,X(a,3))}function Pc(s,a){var u=it(s)?u1:ku;return u(s,X(a,3))}var Yv=Xs(function(s,a,u){xt.call(s,u)?s[u].push(a):_i(s,u,[a])});function Xv(s,a,u,p){s=de(s)?s:Yn(s),u=u&&!p?nt(u):0;var y=s.length;return u<0&&(u=qt(y+u,0)),ao(s)?u<=y&&s.indexOf(a,u)>-1:!!y&&Bn(s,a,u)>-1}var Kv=ot(function(s,a,u){var p=-1,y=typeof a=="function",x=de(s)?M(s.length):[];return Ki(s,function(O){x[++p]=y?Se(a,O,u):Mr(O,a,u)}),x}),Gv=Xs(function(s,a,u){_i(s,u,a)});function no(s,a){var u=it(s)?Mt:_u;return u(s,X(a,3))}function Zv(s,a,u,p){return s==null?[]:(it(a)||(a=a==null?[]:[a]),u=p?e:u,it(u)||(u=u==null?[]:[u]),Bu(s,a,u))}var jv=Xs(function(s,a,u){s[u?0:1].push(a)},function(){return[[],[]]});function Jv(s,a,u){var p=it(s)?Bl:su,y=arguments.length<3;return p(s,X(a,4),u,y,Ki)}function tx(s,a,u){var p=it(s)?c1:su,y=arguments.length<3;return p(s,X(a,4),u,y,ku)}function ex(s,a){var u=it(s)?Ui:Cu;return u(s,oo(X(a,3)))}function ix(s){var a=it(s)?xu:Xy;return a(s)}function nx(s,a,u){(u?se(s,a,u):a===e)?a=1:a=nt(a);var p=it(s)?Cy:Ky;return p(s,a)}function rx(s){var a=it(s)?Ay:Zy;return a(s)}function sx(s){if(s==null)return 0;if(de(s))return ao(s)?Nn(s):s.length;var a=te(s);return a==Ge||a==Ze?s.size:ta(s).length}function ox(s,a,u){var p=it(s)?Ll:jy;return u&&se(s,a,u)&&(a=e),p(s,X(a,3))}var lx=ot(function(s,a){if(s==null)return[];var u=a.length;return u>1&&se(s,a[0],a[1])?a=[]:u>2&&se(a[0],a[1],a[2])&&(a=[a[0]]),Bu(s,Gt(a,1),[])}),ro=V1||function(){return Kt.Date.now()};function ax(s,a){if(typeof a!="function")throw new Be(l);return s=nt(s),function(){if(--s<1)return a.apply(this,arguments)}}function Mc(s,a,u){return a=u?e:a,a=s&&a==null?s.length:a,Ei(s,F,e,e,e,e,a)}function Rc(s,a){var u;if(typeof a!="function")throw new Be(l);return s=nt(s),function(){return--s>0&&(u=a.apply(this,arguments)),s<=1&&(a=e),u}}var ka=ot(function(s,a,u){var p=C;if(u.length){var y=Yi(u,Un(ka));p|=$}return Ei(s,p,a,u,y)}),_c=ot(function(s,a,u){var p=C|P;if(u.length){var y=Yi(u,Un(_c));p|=$}return Ei(a,p,s,u,y)});function Ec(s,a,u){a=u?e:a;var p=Ei(s,L,e,e,e,e,e,a);return p.placeholder=Ec.placeholder,p}function Dc(s,a,u){a=u?e:a;var p=Ei(s,_,e,e,e,e,e,a);return p.placeholder=Dc.placeholder,p}function Ic(s,a,u){var p,y,x,O,k,T,E=0,D=!1,N=!1,H=!0;if(typeof s!="function")throw new Be(l);a=Fe(a)||0,_t(u)&&(D=!!u.leading,N="maxWait"in u,x=N?qt(Fe(u.maxWait)||0,a):x,H="trailing"in u?!!u.trailing:H);function Q(Nt){var ei=p,Ni=y;return p=y=e,E=Nt,O=s.apply(Ni,ei),O}function K(Nt){return E=Nt,k=Ir(ft,a),D?Q(Nt):O}function st(Nt){var ei=Nt-T,Ni=Nt-E,Jc=a-ei;return N?Jt(Jc,x-Ni):Jc}function G(Nt){var ei=Nt-T,Ni=Nt-E;return T===e||ei>=a||ei<0||N&&Ni>=x}function ft(){var Nt=ro();if(G(Nt))return dt(Nt);k=Ir(ft,st(Nt))}function dt(Nt){return k=e,H&&p?Q(Nt):(p=y=e,O)}function Te(){k!==e&&qu(k),E=0,p=T=y=k=e}function oe(){return k===e?O:dt(ro())}function Pe(){var Nt=ro(),ei=G(Nt);if(p=arguments,y=this,T=Nt,ei){if(k===e)return K(T);if(N)return qu(k),k=Ir(ft,a),Q(T)}return k===e&&(k=Ir(ft,a)),O}return Pe.cancel=Te,Pe.flush=oe,Pe}var hx=ot(function(s,a){return Su(s,1,a)}),fx=ot(function(s,a,u){return Su(s,Fe(a)||0,u)});function ux(s){return Ei(s,rt)}function so(s,a){if(typeof s!="function"||a!=null&&typeof a!="function")throw new Be(l);var u=function(){var p=arguments,y=a?a.apply(this,p):p[0],x=u.cache;if(x.has(y))return x.get(y);var O=s.apply(this,p);return u.cache=x.set(y,O)||x,O};return u.cache=new(so.Cache||Ri),u}so.Cache=Ri;function oo(s){if(typeof s!="function")throw new Be(l);return function(){var a=arguments;switch(a.length){case 0:return!s.call(this);case 1:return!s.call(this,a[0]);case 2:return!s.call(this,a[0],a[1]);case 3:return!s.call(this,a[0],a[1],a[2])}return!s.apply(this,a)}}function cx(s){return Rc(2,s)}var dx=Jy(function(s,a){a=a.length==1&&it(a[0])?Mt(a[0],ke(X())):Mt(Gt(a,1),ke(X()));var u=a.length;return ot(function(p){for(var y=-1,x=Jt(p.length,u);++y<x;)p[y]=a[y].call(this,p[y]);return Se(s,this,p)})}),Ca=ot(function(s,a){var u=Yi(a,Un(Ca));return Ei(s,$,e,a,u)}),Bc=ot(function(s,a){var u=Yi(a,Un(Bc));return Ei(s,W,e,a,u)}),px=Di(function(s,a){return Ei(s,J,e,e,e,a)});function gx(s,a){if(typeof s!="function")throw new Be(l);return a=a===e?a:nt(a),ot(s,a)}function mx(s,a){if(typeof s!="function")throw new Be(l);return a=a==null?0:qt(nt(a),0),ot(function(u){var p=u[a],y=ji(u,0,a);return p&&Qi(y,p),Se(s,this,y)})}function yx(s,a,u){var p=!0,y=!0;if(typeof s!="function")throw new Be(l);return _t(u)&&(p="leading"in u?!!u.leading:p,y="trailing"in u?!!u.trailing:y),Ic(s,a,{leading:p,maxWait:a,trailing:y})}function wx(s){return Mc(s,1)}function vx(s,a){return Ca(ha(a),s)}function xx(){if(!arguments.length)return[];var s=arguments[0];return it(s)?s:[s]}function bx(s){return Ne(s,w)}function Ox(s,a){return a=typeof a=="function"?a:e,Ne(s,w,a)}function Sx(s){return Ne(s,g|w)}function kx(s,a){return a=typeof a=="function"?a:e,Ne(s,g|w,a)}function Cx(s,a){return a==null||Ou(s,a,Yt(a))}function ti(s,a){return s===a||s!==s&&a!==a}var Ax=js(Zl),Tx=js(function(s,a){return s>=a}),bn=Pu(function(){return arguments}())?Pu:function(s){return It(s)&&xt.call(s,"callee")&&!pu.call(s,"callee")},it=M.isArray,Px=Kf?ke(Kf):Ly;function de(s){return s!=null&&lo(s.length)&&!Bi(s)}function Lt(s){return It(s)&&de(s)}function Mx(s){return s===!0||s===!1||It(s)&&re(s)==pr}var Ji=z1||La,Rx=Gf?ke(Gf):Ny;function _x(s){return It(s)&&s.nodeType===1&&!Br(s)}function Ex(s){if(s==null)return!0;if(de(s)&&(it(s)||typeof s=="string"||typeof s.splice=="function"||Ji(s)||Qn(s)||bn(s)))return!s.length;var a=te(s);if(a==Ge||a==Ze)return!s.size;if(Dr(s))return!ta(s).length;for(var u in s)if(xt.call(s,u))return!1;return!0}function Dx(s,a){return Rr(s,a)}function Ix(s,a,u){u=typeof u=="function"?u:e;var p=u?u(s,a):e;return p===e?Rr(s,a,e,u):!!p}function Aa(s){if(!It(s))return!1;var a=re(s);return a==vs||a==n0||typeof s.message=="string"&&typeof s.name=="string"&&!Br(s)}function Bx(s){return typeof s=="number"&&mu(s)}function Bi(s){if(!_t(s))return!1;var a=re(s);return a==xs||a==Sf||a==ws||a==s0}function Lc(s){return typeof s=="number"&&s==nt(s)}function lo(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=Ke}function _t(s){var a=typeof s;return s!=null&&(a=="object"||a=="function")}function It(s){return s!=null&&typeof s=="object"}var Nc=Zf?ke(Zf):Wy;function Lx(s,a){return s===a||Jl(s,a,ma(a))}function Nx(s,a,u){return u=typeof u=="function"?u:e,Jl(s,a,ma(a),u)}function $x(s){return $c(s)&&s!=+s}function Wx(s){if(Ow(s))throw new tt(o);return Mu(s)}function Fx(s){return s===null}function Vx(s){return s==null}function $c(s){return typeof s=="number"||It(s)&&re(s)==mr}function Br(s){if(!It(s)||re(s)!=Pi)return!1;var a=Is(s);if(a===null)return!0;var u=xt.call(a,"constructor")&&a.constructor;return typeof u=="function"&&u instanceof u&&Rs.call(u)==N1}var Ta=jf?ke(jf):Fy;function Hx(s){return Lc(s)&&s>=-9007199254740991&&s<=Ke}var Wc=Jf?ke(Jf):Vy;function ao(s){return typeof s=="string"||!it(s)&&It(s)&&re(s)==wr}function Ae(s){return typeof s=="symbol"||It(s)&&re(s)==bs}var Qn=tu?ke(tu):Hy;function zx(s){return s===e}function qx(s){return It(s)&&te(s)==vr}function Ux(s){return It(s)&&re(s)==l0}var Qx=js(ea),Yx=js(function(s,a){return s<=a});function Fc(s){if(!s)return[];if(de(s))return ao(s)?je(s):ce(s);if(Or&&s[Or])return C1(s[Or]());var a=te(s),u=a==Ge?Hl:a==Ze?Ts:Yn;return u(s)}function Li(s){if(!s)return s===0?s:0;if(s=Fe(s),s===li||s===-1/0){var a=s<0?-1:1;return a*Ci}return s===s?s:0}function nt(s){var a=Li(s),u=a%1;return a===a?u?a-u:a:0}function Vc(s){return s?yn(nt(s),0,Ft):0}function Fe(s){if(typeof s=="number")return s;if(Ae(s))return cn;if(_t(s)){var a=typeof s.valueOf=="function"?s.valueOf():s;s=_t(a)?a+"":a}if(typeof s!="string")return s===0?s:+s;s=ou(s);var u=P0.test(s);return u||R0.test(s)?a1(s.slice(2),u?2:8):T0.test(s)?cn:+s}function Hc(s){return hi(s,pe(s))}function Xx(s){return s?yn(nt(s),-9007199254740991,Ke):s===0?s:0}function wt(s){return s==null?"":Ce(s)}var Kx=zn(function(s,a){if(Dr(a)||de(a)){hi(a,Yt(a),s);return}for(var u in a)xt.call(a,u)&&Tr(s,u,a[u])}),zc=zn(function(s,a){hi(a,pe(a),s)}),ho=zn(function(s,a,u,p){hi(a,pe(a),s,p)}),Gx=zn(function(s,a,u,p){hi(a,Yt(a),s,p)}),Zx=Di(Xl);function jx(s,a){var u=Hn(s);return a==null?u:bu(u,a)}var Jx=ot(function(s,a){s=Ot(s);var u=-1,p=a.length,y=p>2?a[2]:e;for(y&&se(a[0],a[1],y)&&(p=1);++u<p;)for(var x=a[u],O=pe(x),k=-1,T=O.length;++k<T;){var E=O[k],D=s[E];(D===e||ti(D,Wn[E])&&!xt.call(s,E))&&(s[E]=x[E])}return s}),tb=ot(function(s){return s.push(e,oc),Se(qc,e,s)});function eb(s,a){return iu(s,X(a,3),ai)}function ib(s,a){return iu(s,X(a,3),Gl)}function nb(s,a){return s==null?s:Kl(s,X(a,3),pe)}function rb(s,a){return s==null?s:Au(s,X(a,3),pe)}function sb(s,a){return s&&ai(s,X(a,3))}function ob(s,a){return s&&Gl(s,X(a,3))}function lb(s){return s==null?[]:qs(s,Yt(s))}function ab(s){return s==null?[]:qs(s,pe(s))}function Pa(s,a,u){var p=s==null?e:wn(s,a);return p===e?u:p}function hb(s,a){return s!=null&&hc(s,a,Ey)}function Ma(s,a){return s!=null&&hc(s,a,Dy)}var fb=ec(function(s,a,u){a!=null&&typeof a.toString!="function"&&(a=_s.call(a)),s[a]=u},_a(ge)),ub=ec(function(s,a,u){a!=null&&typeof a.toString!="function"&&(a=_s.call(a)),xt.call(s,a)?s[a].push(u):s[a]=[u]},X),cb=ot(Mr);function Yt(s){return de(s)?vu(s):ta(s)}function pe(s){return de(s)?vu(s,!0):zy(s)}function db(s,a){var u={};return a=X(a,3),ai(s,function(p,y,x){_i(u,a(p,y,x),p)}),u}function pb(s,a){var u={};return a=X(a,3),ai(s,function(p,y,x){_i(u,y,a(p,y,x))}),u}var gb=zn(function(s,a,u){Us(s,a,u)}),qc=zn(function(s,a,u,p){Us(s,a,u,p)}),mb=Di(function(s,a){var u={};if(s==null)return u;var p=!1;a=Mt(a,function(x){return x=Zi(x,s),p||(p=x.length>1),x}),hi(s,pa(s),u),p&&(u=Ne(u,g|m|w,fw));for(var y=a.length;y--;)oa(u,a[y]);return u});function yb(s,a){return Uc(s,oo(X(a)))}var wb=Di(function(s,a){return s==null?{}:Uy(s,a)});function Uc(s,a){if(s==null)return{};var u=Mt(pa(s),function(p){return[p]});return a=X(a),Lu(s,u,function(p,y){return a(p,y[0])})}function vb(s,a,u){a=Zi(a,s);var p=-1,y=a.length;for(y||(y=1,s=e);++p<y;){var x=s==null?e:s[fi(a[p])];x===e&&(p=y,x=u),s=Bi(x)?x.call(s):x}return s}function xb(s,a,u){return s==null?s:_r(s,a,u)}function bb(s,a,u,p){return p=typeof p=="function"?p:e,s==null?s:_r(s,a,u,p)}var Qc=rc(Yt),Yc=rc(pe);function Ob(s,a,u){var p=it(s),y=p||Ji(s)||Qn(s);if(a=X(a,4),u==null){var x=s&&s.constructor;y?u=p?new x:[]:_t(s)?u=Bi(x)?Hn(Is(s)):{}:u={}}return(y?Ie:ai)(s,function(O,k,T){return a(u,O,k,T)}),u}function Sb(s,a){return s==null?!0:oa(s,a)}function kb(s,a,u){return s==null?s:Vu(s,a,ha(u))}function Cb(s,a,u,p){return p=typeof p=="function"?p:e,s==null?s:Vu(s,a,ha(u),p)}function Yn(s){return s==null?[]:Vl(s,Yt(s))}function Ab(s){return s==null?[]:Vl(s,pe(s))}function Tb(s,a,u){return u===e&&(u=a,a=e),u!==e&&(u=Fe(u),u=u===u?u:0),a!==e&&(a=Fe(a),a=a===a?a:0),yn(Fe(s),a,u)}function Pb(s,a,u){return a=Li(a),u===e?(u=a,a=0):u=Li(u),s=Fe(s),Iy(s,a,u)}function Mb(s,a,u){if(u&&typeof u!="boolean"&&se(s,a,u)&&(a=u=e),u===e&&(typeof a=="boolean"?(u=a,a=e):typeof s=="boolean"&&(u=s,s=e)),s===e&&a===e?(s=0,a=1):(s=Li(s),a===e?(a=s,s=0):a=Li(a)),s>a){var p=s;s=a,a=p}if(u||s%1||a%1){var y=yu();return Jt(s+y*(a-s+l1("1e-"+((y+"").length-1))),a)}return na(s,a)}var Rb=qn(function(s,a,u){return a=a.toLowerCase(),s+(u?Xc(a):a)});function Xc(s){return Ra(wt(s).toLowerCase())}function Kc(s){return s=wt(s),s&&s.replace(E0,x1).replace(Z0,"")}function _b(s,a,u){s=wt(s),a=Ce(a);var p=s.length;u=u===e?p:yn(nt(u),0,p);var y=u;return u-=a.length,u>=0&&s.slice(u,y)==a}function Eb(s){return s=wt(s),s&&c0.test(s)?s.replace(Af,b1):s}function Db(s){return s=wt(s),s&&w0.test(s)?s.replace(Cl,"\\$&"):s}var Ib=qn(function(s,a,u){return s+(u?"-":"")+a.toLowerCase()}),Bb=qn(function(s,a,u){return s+(u?" ":"")+a.toLowerCase()}),Lb=ju("toLowerCase");function Nb(s,a,u){s=wt(s),a=nt(a);var p=a?Nn(s):0;if(!a||p>=a)return s;var y=(a-p)/2;return Zs($s(y),u)+s+Zs(Ns(y),u)}function $b(s,a,u){s=wt(s),a=nt(a);var p=a?Nn(s):0;return a&&p<a?s+Zs(a-p,u):s}function Wb(s,a,u){s=wt(s),a=nt(a);var p=a?Nn(s):0;return a&&p<a?Zs(a-p,u)+s:s}function Fb(s,a,u){return u||a==null?a=0:a&&(a=+a),Y1(wt(s).replace(Al,""),a||0)}function Vb(s,a,u){return(u?se(s,a,u):a===e)?a=1:a=nt(a),ra(wt(s),a)}function Hb(){var s=arguments,a=wt(s[0]);return s.length<3?a:a.replace(s[1],s[2])}var zb=qn(function(s,a,u){return s+(u?"_":"")+a.toLowerCase()});function qb(s,a,u){return u&&typeof u!="number"&&se(s,a,u)&&(a=u=e),u=u===e?Ft:u>>>0,u?(s=wt(s),s&&(typeof a=="string"||a!=null&&!Ta(a))&&(a=Ce(a),!a&&Ln(s))?ji(je(s),0,u):s.split(a,u)):[]}var Ub=qn(function(s,a,u){return s+(u?" ":"")+Ra(a)});function Qb(s,a,u){return s=wt(s),u=u==null?0:yn(nt(u),0,s.length),a=Ce(a),s.slice(u,u+a.length)==a}function Yb(s,a,u){var p=v.templateSettings;u&&se(s,a,u)&&(a=e),s=wt(s),a=ho({},a,p,sc);var y=ho({},a.imports,p.imports,sc),x=Yt(y),O=Vl(y,x),k,T,E=0,D=a.interpolate||Os,N="__p += '",H=zl((a.escape||Os).source+"|"+D.source+"|"+(D===Tf?A0:Os).source+"|"+(a.evaluate||Os).source+"|$","g"),Q="//# sourceURL="+(xt.call(a,"sourceURL")?(a.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++i1+"]")+`
`;s.replace(H,function(G,ft,dt,Te,oe,Pe){return dt||(dt=Te),N+=s.slice(E,Pe).replace(D0,O1),ft&&(k=!0,N+=`' +
__e(`+ft+`) +
'`),oe&&(T=!0,N+=`';
`+oe+`;
__p += '`),dt&&(N+=`' +
((__t = (`+dt+`)) == null ? '' : __t) +
'`),E=Pe+G.length,G}),N+=`';
`;var K=xt.call(a,"variable")&&a.variable;if(!K)N=`with (obj) {
`+N+`
}
`;else if(k0.test(K))throw new tt(h);N=(T?N.replace(a0,""):N).replace(h0,"$1").replace(f0,"$1;"),N="function("+(K||"obj")+`) {
`+(K?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(k?", __e = _.escape":"")+(T?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+N+`return __p
}`;var st=Zc(function(){return gt(x,Q+"return "+N).apply(e,O)});if(st.source=N,Aa(st))throw st;return st}function Xb(s){return wt(s).toLowerCase()}function Kb(s){return wt(s).toUpperCase()}function Gb(s,a,u){if(s=wt(s),s&&(u||a===e))return ou(s);if(!s||!(a=Ce(a)))return s;var p=je(s),y=je(a),x=lu(p,y),O=au(p,y)+1;return ji(p,x,O).join("")}function Zb(s,a,u){if(s=wt(s),s&&(u||a===e))return s.slice(0,fu(s)+1);if(!s||!(a=Ce(a)))return s;var p=je(s),y=au(p,je(a))+1;return ji(p,0,y).join("")}function jb(s,a,u){if(s=wt(s),s&&(u||a===e))return s.replace(Al,"");if(!s||!(a=Ce(a)))return s;var p=je(s),y=lu(p,je(a));return ji(p,y).join("")}function Jb(s,a){var u=bt,p=lt;if(_t(a)){var y="separator"in a?a.separator:y;u="length"in a?nt(a.length):u,p="omission"in a?Ce(a.omission):p}s=wt(s);var x=s.length;if(Ln(s)){var O=je(s);x=O.length}if(u>=x)return s;var k=u-Nn(p);if(k<1)return p;var T=O?ji(O,0,k).join(""):s.slice(0,k);if(y===e)return T+p;if(O&&(k+=T.length-k),Ta(y)){if(s.slice(k).search(y)){var E,D=T;for(y.global||(y=zl(y.source,wt(Pf.exec(y))+"g")),y.lastIndex=0;E=y.exec(D);)var N=E.index;T=T.slice(0,N===e?k:N)}}else if(s.indexOf(Ce(y),k)!=k){var H=T.lastIndexOf(y);H>-1&&(T=T.slice(0,H))}return T+p}function tO(s){return s=wt(s),s&&u0.test(s)?s.replace(Cf,M1):s}var eO=qn(function(s,a,u){return s+(u?" ":"")+a.toUpperCase()}),Ra=ju("toUpperCase");function Gc(s,a,u){return s=wt(s),a=u?e:a,a===e?k1(s)?E1(s):g1(s):s.match(a)||[]}var Zc=ot(function(s,a){try{return Se(s,e,a)}catch(u){return Aa(u)?u:new tt(u)}}),iO=Di(function(s,a){return Ie(a,function(u){u=fi(u),_i(s,u,ka(s[u],s))}),s});function nO(s){var a=s==null?0:s.length,u=X();return s=a?Mt(s,function(p){if(typeof p[1]!="function")throw new Be(l);return[u(p[0]),p[1]]}):[],ot(function(p){for(var y=-1;++y<a;){var x=s[y];if(Se(x[0],this,p))return Se(x[1],this,p)}})}function rO(s){return My(Ne(s,g))}function _a(s){return function(){return s}}function sO(s,a){return s==null||s!==s?a:s}var oO=tc(),lO=tc(!0);function ge(s){return s}function Ea(s){return Ru(typeof s=="function"?s:Ne(s,g))}function aO(s){return Eu(Ne(s,g))}function hO(s,a){return Du(s,Ne(a,g))}var fO=ot(function(s,a){return function(u){return Mr(u,s,a)}}),uO=ot(function(s,a){return function(u){return Mr(s,u,a)}});function Da(s,a,u){var p=Yt(a),y=qs(a,p);u==null&&!(_t(a)&&(y.length||!p.length))&&(u=a,a=s,s=this,y=qs(a,Yt(a)));var x=!(_t(u)&&"chain"in u)||!!u.chain,O=Bi(s);return Ie(y,function(k){var T=a[k];s[k]=T,O&&(s.prototype[k]=function(){var E=this.__chain__;if(x||E){var D=s(this.__wrapped__),N=D.__actions__=ce(this.__actions__);return N.push({func:T,args:arguments,thisArg:s}),D.__chain__=E,D}return T.apply(s,Qi([this.value()],arguments))})}),s}function cO(){return Kt._===this&&(Kt._=$1),this}function Ia(){}function dO(s){return s=nt(s),ot(function(a){return Iu(a,s)})}var pO=ua(Mt),gO=ua(eu),mO=ua(Ll);function jc(s){return wa(s)?Nl(fi(s)):Qy(s)}function yO(s){return function(a){return s==null?e:wn(s,a)}}var wO=ic(),vO=ic(!0);function Ba(){return[]}function La(){return!1}function xO(){return{}}function bO(){return""}function OO(){return!0}function SO(s,a){if(s=nt(s),s<1||s>Ke)return[];var u=Ft,p=Jt(s,Ft);a=X(a),s-=Ft;for(var y=Fl(p,a);++u<s;)a(u);return y}function kO(s){return it(s)?Mt(s,fi):Ae(s)?[s]:ce(wc(wt(s)))}function CO(s){var a=++L1;return wt(s)+a}var AO=Gs(function(s,a){return s+a},0),TO=ca("ceil"),PO=Gs(function(s,a){return s/a},1),MO=ca("floor");function RO(s){return s&&s.length?zs(s,ge,Zl):e}function _O(s,a){return s&&s.length?zs(s,X(a,2),Zl):e}function EO(s){return ru(s,ge)}function DO(s,a){return ru(s,X(a,2))}function IO(s){return s&&s.length?zs(s,ge,ea):e}function BO(s,a){return s&&s.length?zs(s,X(a,2),ea):e}var LO=Gs(function(s,a){return s*a},1),NO=ca("round"),$O=Gs(function(s,a){return s-a},0);function WO(s){return s&&s.length?Wl(s,ge):0}function FO(s,a){return s&&s.length?Wl(s,X(a,2)):0}return v.after=ax,v.ary=Mc,v.assign=Kx,v.assignIn=zc,v.assignInWith=ho,v.assignWith=Gx,v.at=Zx,v.before=Rc,v.bind=ka,v.bindAll=iO,v.bindKey=_c,v.castArray=xx,v.chain=Ac,v.chunk=Mw,v.compact=Rw,v.concat=_w,v.cond=nO,v.conforms=rO,v.constant=_a,v.countBy=Wv,v.create=jx,v.curry=Ec,v.curryRight=Dc,v.debounce=Ic,v.defaults=Jx,v.defaultsDeep=tb,v.defer=hx,v.delay=fx,v.difference=Ew,v.differenceBy=Dw,v.differenceWith=Iw,v.drop=Bw,v.dropRight=Lw,v.dropRightWhile=Nw,v.dropWhile=$w,v.fill=Ww,v.filter=Vv,v.flatMap=qv,v.flatMapDeep=Uv,v.flatMapDepth=Qv,v.flatten=Oc,v.flattenDeep=Fw,v.flattenDepth=Vw,v.flip=ux,v.flow=oO,v.flowRight=lO,v.fromPairs=Hw,v.functions=lb,v.functionsIn=ab,v.groupBy=Yv,v.initial=qw,v.intersection=Uw,v.intersectionBy=Qw,v.intersectionWith=Yw,v.invert=fb,v.invertBy=ub,v.invokeMap=Kv,v.iteratee=Ea,v.keyBy=Gv,v.keys=Yt,v.keysIn=pe,v.map=no,v.mapKeys=db,v.mapValues=pb,v.matches=aO,v.matchesProperty=hO,v.memoize=so,v.merge=gb,v.mergeWith=qc,v.method=fO,v.methodOf=uO,v.mixin=Da,v.negate=oo,v.nthArg=dO,v.omit=mb,v.omitBy=yb,v.once=cx,v.orderBy=Zv,v.over=pO,v.overArgs=dx,v.overEvery=gO,v.overSome=mO,v.partial=Ca,v.partialRight=Bc,v.partition=jv,v.pick=wb,v.pickBy=Uc,v.property=jc,v.propertyOf=yO,v.pull=Zw,v.pullAll=kc,v.pullAllBy=jw,v.pullAllWith=Jw,v.pullAt=tv,v.range=wO,v.rangeRight=vO,v.rearg=px,v.reject=ex,v.remove=ev,v.rest=gx,v.reverse=Oa,v.sampleSize=nx,v.set=xb,v.setWith=bb,v.shuffle=rx,v.slice=iv,v.sortBy=lx,v.sortedUniq=hv,v.sortedUniqBy=fv,v.split=qb,v.spread=mx,v.tail=uv,v.take=cv,v.takeRight=dv,v.takeRightWhile=pv,v.takeWhile=gv,v.tap=Rv,v.throttle=yx,v.thru=io,v.toArray=Fc,v.toPairs=Qc,v.toPairsIn=Yc,v.toPath=kO,v.toPlainObject=Hc,v.transform=Ob,v.unary=wx,v.union=mv,v.unionBy=yv,v.unionWith=wv,v.uniq=vv,v.uniqBy=xv,v.uniqWith=bv,v.unset=Sb,v.unzip=Sa,v.unzipWith=Cc,v.update=kb,v.updateWith=Cb,v.values=Yn,v.valuesIn=Ab,v.without=Ov,v.words=Gc,v.wrap=vx,v.xor=Sv,v.xorBy=kv,v.xorWith=Cv,v.zip=Av,v.zipObject=Tv,v.zipObjectDeep=Pv,v.zipWith=Mv,v.entries=Qc,v.entriesIn=Yc,v.extend=zc,v.extendWith=ho,Da(v,v),v.add=AO,v.attempt=Zc,v.camelCase=Rb,v.capitalize=Xc,v.ceil=TO,v.clamp=Tb,v.clone=bx,v.cloneDeep=Sx,v.cloneDeepWith=kx,v.cloneWith=Ox,v.conformsTo=Cx,v.deburr=Kc,v.defaultTo=sO,v.divide=PO,v.endsWith=_b,v.eq=ti,v.escape=Eb,v.escapeRegExp=Db,v.every=Fv,v.find=Hv,v.findIndex=xc,v.findKey=eb,v.findLast=zv,v.findLastIndex=bc,v.findLastKey=ib,v.floor=MO,v.forEach=Tc,v.forEachRight=Pc,v.forIn=nb,v.forInRight=rb,v.forOwn=sb,v.forOwnRight=ob,v.get=Pa,v.gt=Ax,v.gte=Tx,v.has=hb,v.hasIn=Ma,v.head=Sc,v.identity=ge,v.includes=Xv,v.indexOf=zw,v.inRange=Pb,v.invoke=cb,v.isArguments=bn,v.isArray=it,v.isArrayBuffer=Px,v.isArrayLike=de,v.isArrayLikeObject=Lt,v.isBoolean=Mx,v.isBuffer=Ji,v.isDate=Rx,v.isElement=_x,v.isEmpty=Ex,v.isEqual=Dx,v.isEqualWith=Ix,v.isError=Aa,v.isFinite=Bx,v.isFunction=Bi,v.isInteger=Lc,v.isLength=lo,v.isMap=Nc,v.isMatch=Lx,v.isMatchWith=Nx,v.isNaN=$x,v.isNative=Wx,v.isNil=Vx,v.isNull=Fx,v.isNumber=$c,v.isObject=_t,v.isObjectLike=It,v.isPlainObject=Br,v.isRegExp=Ta,v.isSafeInteger=Hx,v.isSet=Wc,v.isString=ao,v.isSymbol=Ae,v.isTypedArray=Qn,v.isUndefined=zx,v.isWeakMap=qx,v.isWeakSet=Ux,v.join=Xw,v.kebabCase=Ib,v.last=We,v.lastIndexOf=Kw,v.lowerCase=Bb,v.lowerFirst=Lb,v.lt=Qx,v.lte=Yx,v.max=RO,v.maxBy=_O,v.mean=EO,v.meanBy=DO,v.min=IO,v.minBy=BO,v.stubArray=Ba,v.stubFalse=La,v.stubObject=xO,v.stubString=bO,v.stubTrue=OO,v.multiply=LO,v.nth=Gw,v.noConflict=cO,v.noop=Ia,v.now=ro,v.pad=Nb,v.padEnd=$b,v.padStart=Wb,v.parseInt=Fb,v.random=Mb,v.reduce=Jv,v.reduceRight=tx,v.repeat=Vb,v.replace=Hb,v.result=vb,v.round=NO,v.runInContext=A,v.sample=ix,v.size=sx,v.snakeCase=zb,v.some=ox,v.sortedIndex=nv,v.sortedIndexBy=rv,v.sortedIndexOf=sv,v.sortedLastIndex=ov,v.sortedLastIndexBy=lv,v.sortedLastIndexOf=av,v.startCase=Ub,v.startsWith=Qb,v.subtract=$O,v.sum=WO,v.sumBy=FO,v.template=Yb,v.times=SO,v.toFinite=Li,v.toInteger=nt,v.toLength=Vc,v.toLower=Xb,v.toNumber=Fe,v.toSafeInteger=Xx,v.toString=wt,v.toUpper=Kb,v.trim=Gb,v.trimEnd=Zb,v.trimStart=jb,v.truncate=Jb,v.unescape=tO,v.uniqueId=CO,v.upperCase=eO,v.upperFirst=Ra,v.each=Tc,v.eachRight=Pc,v.first=Sc,Da(v,function(){var s={};return ai(v,function(a,u){xt.call(v.prototype,u)||(s[u]=a)}),s}(),{chain:!1}),v.VERSION=i,Ie(["bind","bindKey","curry","curryRight","partial","partialRight"],function(s){v[s].placeholder=v}),Ie(["drop","take"],function(s,a){ut.prototype[s]=function(u){u=u===e?1:qt(nt(u),0);var p=this.__filtered__&&!a?new ut(this):this.clone();return p.__filtered__?p.__takeCount__=Jt(u,p.__takeCount__):p.__views__.push({size:Jt(u,Ft),type:s+(p.__dir__<0?"Right":"")}),p},ut.prototype[s+"Right"]=function(u){return this.reverse()[s](u).reverse()}}),Ie(["filter","map","takeWhile"],function(s,a){var u=a+1,p=u==vt||u==oi;ut.prototype[s]=function(y){var x=this.clone();return x.__iteratees__.push({iteratee:X(y,3),type:u}),x.__filtered__=x.__filtered__||p,x}}),Ie(["head","last"],function(s,a){var u="take"+(a?"Right":"");ut.prototype[s]=function(){return this[u](1).value()[0]}}),Ie(["initial","tail"],function(s,a){var u="drop"+(a?"":"Right");ut.prototype[s]=function(){return this.__filtered__?new ut(this):this[u](1)}}),ut.prototype.compact=function(){return this.filter(ge)},ut.prototype.find=function(s){return this.filter(s).head()},ut.prototype.findLast=function(s){return this.reverse().find(s)},ut.prototype.invokeMap=ot(function(s,a){return typeof s=="function"?new ut(this):this.map(function(u){return Mr(u,s,a)})}),ut.prototype.reject=function(s){return this.filter(oo(X(s)))},ut.prototype.slice=function(s,a){s=nt(s);var u=this;return u.__filtered__&&(s>0||a<0)?new ut(u):(s<0?u=u.takeRight(-s):s&&(u=u.drop(s)),a!==e&&(a=nt(a),u=a<0?u.dropRight(-a):u.take(a-s)),u)},ut.prototype.takeRightWhile=function(s){return this.reverse().takeWhile(s).reverse()},ut.prototype.toArray=function(){return this.take(Ft)},ai(ut.prototype,function(s,a){var u=/^(?:filter|find|map|reject)|While$/.test(a),p=/^(?:head|last)$/.test(a),y=v[p?"take"+(a=="last"?"Right":""):a],x=p||/^find/.test(a);y&&(v.prototype[a]=function(){var O=this.__wrapped__,k=p?[1]:arguments,T=O instanceof ut,E=k[0],D=T||it(O),N=function(ft){var dt=y.apply(v,Qi([ft],k));return p&&H?dt[0]:dt};D&&u&&typeof E=="function"&&E.length!=1&&(T=D=!1);var H=this.__chain__,Q=!!this.__actions__.length,K=x&&!H,st=T&&!Q;if(!x&&D){O=st?O:new ut(this);var G=s.apply(O,k);return G.__actions__.push({func:io,args:[N],thisArg:e}),new Le(G,H)}return K&&st?s.apply(this,k):(G=this.thru(N),K?p?G.value()[0]:G.value():G)})}),Ie(["pop","push","shift","sort","splice","unshift"],function(s){var a=Ps[s],u=/^(?:push|sort|unshift)$/.test(s)?"tap":"thru",p=/^(?:pop|shift)$/.test(s);v.prototype[s]=function(){var y=arguments;if(p&&!this.__chain__){var x=this.value();return a.apply(it(x)?x:[],y)}return this[u](function(O){return a.apply(it(O)?O:[],y)})}}),ai(ut.prototype,function(s,a){var u=v[a];if(u){var p=u.name+"";xt.call(Vn,p)||(Vn[p]=[]),Vn[p].push({name:a,func:u})}}),Vn[Ks(e,P).name]=[{name:"wrapper",func:e}],ut.prototype.clone=ty,ut.prototype.reverse=ey,ut.prototype.value=iy,v.prototype.at=_v,v.prototype.chain=Ev,v.prototype.commit=Dv,v.prototype.next=Iv,v.prototype.plant=Lv,v.prototype.reverse=Nv,v.prototype.toJSON=v.prototype.valueOf=v.prototype.value=$v,v.prototype.first=v.prototype.head,Or&&(v.prototype[Or]=Bv),v},$n=D1();dn?((dn.exports=$n)._=$n,El._=$n):Kt._=$n}).call(oA)}(Yr,Yr.exports)),Yr.exports}var Cm=lA();const d2=VO(Cm);class Am{constructor(t,e,i,n){this.state=t,this.pos=e,this.explicit=i,this.view=n,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(t){let e=xe(this.state).resolveInner(this.pos,-1);for(;e&&t.indexOf(e.name)<0;)e=e.parent;return e?{from:e.from,to:this.pos,text:this.state.sliceDoc(e.from,this.pos),type:e.type}:null}matchBefore(t){let e=this.state.doc.lineAt(this.pos),i=Math.max(e.from,this.pos-250),n=e.text.slice(i-e.from,this.pos-e.from),o=n.search(Tm(t,!1));return o<0?null:{from:i+o,to:this.pos,text:n.slice(o)}}get aborted(){return this.abortListeners==null}addEventListener(t,e,i){t=="abort"&&this.abortListeners&&(this.abortListeners.push(e),i&&i.onDocChange&&(this.abortOnDocChange=!0))}}function mp(r){let t=Object.keys(r).join(""),e=/\w/.test(t);return e&&(t=t.replace(/\w/g,"")),`[${e?"\\w":""}${t.replace(/[^\w\s]/g,"\\$&")}]`}function aA(r){let t=Object.create(null),e=Object.create(null);for(let{label:n}of r){t[n[0]]=!0;for(let o=1;o<n.length;o++)e[n[o]]=!0}let i=mp(t)+mp(e)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function hA(r){let t=r.map(n=>typeof n=="string"?{label:n}:n),[e,i]=t.every(n=>/^\w+$/.test(n.label))?[/\w*$/,/\w+$/]:aA(t);return n=>{let o=n.matchBefore(i);return o||n.explicit?{from:o?o.from:n.pos,options:t,validFor:e}:null}}class yp{constructor(t,e,i,n){this.completion=t,this.source=e,this.match=i,this.score=n}}function Tn(r){return r.selection.main.from}function Tm(r,t){var e;let{source:i}=r,n=t&&i[0]!="^",o=i[i.length-1]!="$";return!n&&!o?r:new RegExp(`${n?"^":""}(?:${i})${o?"$":""}`,(e=r.flags)!==null&&e!==void 0?e:r.ignoreCase?"i":"")}const Pm=qi.define();function fA(r,t,e,i){let{main:n}=r.selection,o=e-n.from,l=i-n.from;return Object.assign(Object.assign({},r.changeByRange(h=>{if(h!=n&&e!=i&&r.sliceDoc(h.from+o,h.from+l)!=r.sliceDoc(e,i))return{range:h};let f=r.toText(t);return{changes:{from:h.from+o,to:i==n.from?h.to:h.from+l,insert:f},range:z.cursor(h.from+o+f.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const wp=new WeakMap;function uA(r){if(!Array.isArray(r))return r;let t=wp.get(r);return t||wp.set(r,t=hA(r)),t}const el=ct.define(),hs=ct.define();class cA{constructor(t){this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let e=0;e<t.length;){let i=Ve(t,e),n=Wi(i);this.chars.push(i);let o=t.slice(e,e+n),l=o.toUpperCase();this.folded.push(Ve(l==o?o.toLowerCase():l,0)),e+=n}this.astral=t.length!=this.chars.length}ret(t,e){return this.score=t,this.matched=e,this}match(t){if(this.pattern.length==0)return this.ret(-100,[]);if(t.length<this.pattern.length)return null;let{chars:e,folded:i,any:n,precise:o,byWord:l}=this;if(e.length==1){let B=Ve(t,0),L=Wi(B),_=L==t.length?0:-100;if(B!=e[0])if(B==i[0])_+=-200;else return null;return this.ret(_,[0,L])}let h=t.indexOf(this.pattern);if(h==0)return this.ret(t.length==this.pattern.length?0:-100,[0,this.pattern.length]);let f=e.length,c=0;if(h<0){for(let B=0,L=Math.min(t.length,200);B<L&&c<f;){let _=Ve(t,B);(_==e[c]||_==i[c])&&(n[c++]=B),B+=Wi(_)}if(c<f)return null}let d=0,g=0,m=!1,w=0,b=-1,S=-1,C=/[a-z]/.test(t),P=!0;for(let B=0,L=Math.min(t.length,200),_=0;B<L&&g<f;){let $=Ve(t,B);h<0&&(d<f&&$==e[d]&&(o[d++]=B),w<f&&($==e[w]||$==i[w]?(w==0&&(b=B),S=B+1,w++):w=0));let W,F=$<255?$>=48&&$<=57||$>=97&&$<=122?2:$>=65&&$<=90?1:0:(W=eg($))!=W.toLowerCase()?1:W!=W.toUpperCase()?2:0;(!B||F==1&&C||_==0&&F!=0)&&(e[g]==$||i[g]==$&&(m=!0)?l[g++]=B:l.length&&(P=!1)),_=F,B+=Wi($)}return g==f&&l[0]==0&&P?this.result(-100+(m?-200:0),l,t):w==f&&b==0?this.ret(-200-t.length+(S==t.length?0:-100),[0,S]):h>-1?this.ret(-700-t.length,[h,h+this.pattern.length]):w==f?this.ret(-900-t.length,[b,S]):g==f?this.result(-100+(m?-200:0)+-700+(P?0:-1100),l,t):e.length==2?null:this.result((n[0]?-700:0)+-200+-1100,n,t)}result(t,e,i){let n=[],o=0;for(let l of e){let h=l+(this.astral?Wi(Ve(i,l)):1);o&&n[o-1]==l?n[o-1]=h:(n[o++]=l,n[o++]=h)}return this.ret(t-i.length,n)}}class dA{constructor(t){this.pattern=t,this.matched=[],this.score=0,this.folded=t.toLowerCase()}match(t){if(t.length<this.pattern.length)return null;let e=t.slice(0,this.pattern.length),i=e==this.pattern?0:e.toLowerCase()==this.folded?-200:null;return i==null?null:(this.matched=[0,e.length],this.score=i+(t.length==this.pattern.length?0:-100),this)}}const Xt=Y.define({combine(r){return fl(r,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:pA,filterStrict:!1,compareCompletions:(t,e)=>t.label.localeCompare(e.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(t,e)=>t&&e,closeOnBlur:(t,e)=>t&&e,icons:(t,e)=>t&&e,tooltipClass:(t,e)=>i=>vp(t(i),e(i)),optionClass:(t,e)=>i=>vp(t(i),e(i)),addToOptions:(t,e)=>t.concat(e),filterStrict:(t,e)=>t||e})}});function vp(r,t){return r?t?r+" "+t:r:t}function pA(r,t,e,i,n,o){let l=r.textDirection==Ht.RTL,h=l,f=!1,c="top",d,g,m=t.left-n.left,w=n.right-t.right,b=i.right-i.left,S=i.bottom-i.top;if(h&&m<Math.min(b,w)?h=!1:!h&&w<Math.min(b,m)&&(h=!0),b<=(h?m:w))d=Math.max(n.top,Math.min(e.top,n.bottom-S))-t.top,g=Math.min(400,h?m:w);else{f=!0,g=Math.min(400,(l?t.right:n.right-t.left)-30);let B=n.bottom-t.bottom;B>=S||B>t.top?d=e.bottom-t.top:(c="bottom",d=t.bottom-e.top)}let C=(t.bottom-t.top)/o.offsetHeight,P=(t.right-t.left)/o.offsetWidth;return{style:`${c}: ${d/C}px; max-width: ${g/P}px`,class:"cm-completionInfo-"+(f?l?"left-narrow":"right-narrow":h?"left":"right")}}function gA(r){let t=r.addToOptions.slice();return r.icons&&t.push({render(e){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),e.type&&i.classList.add(...e.type.split(/\s+/g).map(n=>"cm-completionIcon-"+n)),i.setAttribute("aria-hidden","true"),i},position:20}),t.push({render(e,i,n,o){let l=document.createElement("span");l.className="cm-completionLabel";let h=e.displayLabel||e.label,f=0;for(let c=0;c<o.length;){let d=o[c++],g=o[c++];d>f&&l.appendChild(document.createTextNode(h.slice(f,d)));let m=l.appendChild(document.createElement("span"));m.appendChild(document.createTextNode(h.slice(d,g))),m.className="cm-completionMatchedText",f=g}return f<h.length&&l.appendChild(document.createTextNode(h.slice(f))),l},position:50},{render(e){if(!e.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=e.detail,i},position:80}),t.sort((e,i)=>e.position-i.position).map(e=>e.render)}function ja(r,t,e){if(r<=e)return{from:0,to:r};if(t<0&&(t=0),t<=r>>1){let n=Math.floor(t/e);return{from:n*e,to:(n+1)*e}}let i=Math.floor((r-t)/e);return{from:r-(i+1)*e,to:r-i*e}}class mA{constructor(t,e,i){this.view=t,this.stateField=e,this.applyCompletion=i,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:f=>this.placeInfo(f),key:this},this.space=null,this.currentClass="";let n=t.state.field(e),{options:o,selected:l}=n.open,h=t.state.facet(Xt);this.optionContent=gA(h),this.optionClass=h.optionClass,this.tooltipClass=h.tooltipClass,this.range=ja(o.length,l,h.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(t.state),this.dom.addEventListener("mousedown",f=>{let{options:c}=t.state.field(e).open;for(let d=f.target,g;d&&d!=this.dom;d=d.parentNode)if(d.nodeName=="LI"&&(g=/-(\d+)$/.exec(d.id))&&+g[1]<c.length){this.applyCompletion(t,c[+g[1]]),f.preventDefault();return}}),this.dom.addEventListener("focusout",f=>{let c=t.state.field(this.stateField,!1);c&&c.tooltip&&t.state.facet(Xt).closeOnBlur&&f.relatedTarget!=t.contentDOM&&t.dispatch({effects:hs.of(null)})}),this.showOptions(o,n.id)}mount(){this.updateSel()}showOptions(t,e){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(t,e,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(t){var e;let i=t.state.field(this.stateField),n=t.startState.field(this.stateField);if(this.updateTooltipClass(t.state),i!=n){let{options:o,selected:l,disabled:h}=i.open;(!n.open||n.open.options!=o)&&(this.range=ja(o.length,l,t.state.facet(Xt).maxRenderedOptions),this.showOptions(o,i.id)),this.updateSel(),h!=((e=n.open)===null||e===void 0?void 0:e.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!h)}}updateTooltipClass(t){let e=this.tooltipClass(t);if(e!=this.currentClass){for(let i of this.currentClass.split(" "))i&&this.dom.classList.remove(i);for(let i of e.split(" "))i&&this.dom.classList.add(i);this.currentClass=e}}positioned(t){this.space=t,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let t=this.view.state.field(this.stateField),e=t.open;if((e.selected>-1&&e.selected<this.range.from||e.selected>=this.range.to)&&(this.range=ja(e.options.length,e.selected,this.view.state.facet(Xt).maxRenderedOptions),this.showOptions(e.options,t.id)),this.updateSelectedOption(e.selected)){this.destroyInfo();let{completion:i}=e.options[e.selected],{info:n}=i;if(!n)return;let o=typeof n=="string"?document.createTextNode(n):n(i);if(!o)return;"then"in o?o.then(l=>{l&&this.view.state.field(this.stateField,!1)==t&&this.addInfoPane(l,i)}).catch(l=>ae(this.view.state,l,"completion info")):this.addInfoPane(o,i)}}addInfoPane(t,e){this.destroyInfo();let i=this.info=document.createElement("div");if(i.className="cm-tooltip cm-completionInfo",t.nodeType!=null)i.appendChild(t),this.infoDestroy=null;else{let{dom:n,destroy:o}=t;i.appendChild(n),this.infoDestroy=o||null}this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(t){let e=null;for(let i=this.list.firstChild,n=this.range.from;i;i=i.nextSibling,n++)i.nodeName!="LI"||!i.id?n--:n==t?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),e=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return e&&wA(this.list,e),e}measureInfo(){let t=this.dom.querySelector("[aria-selected]");if(!t||!this.info)return null;let e=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),n=t.getBoundingClientRect(),o=this.space;if(!o){let l=this.dom.ownerDocument.documentElement;o={left:0,top:0,right:l.clientWidth,bottom:l.clientHeight}}return n.top>Math.min(o.bottom,e.bottom)-10||n.bottom<Math.max(o.top,e.top)+10?null:this.view.state.facet(Xt).positionInfo(this.view,e,n,i,o,this.dom)}placeInfo(t){this.info&&(t?(t.style&&(this.info.style.cssText=t.style),this.info.className="cm-tooltip cm-completionInfo "+(t.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(t,e,i){const n=document.createElement("ul");n.id=e,n.setAttribute("role","listbox"),n.setAttribute("aria-expanded","true"),n.setAttribute("aria-label",this.view.state.phrase("Completions")),n.addEventListener("mousedown",l=>{l.target==n&&l.preventDefault()});let o=null;for(let l=i.from;l<i.to;l++){let{completion:h,match:f}=t[l],{section:c}=h;if(c){let m=typeof c=="string"?c:c.name;if(m!=o&&(l>i.from||i.from==0))if(o=m,typeof c!="string"&&c.header)n.appendChild(c.header(c));else{let w=n.appendChild(document.createElement("completion-section"));w.textContent=m}}const d=n.appendChild(document.createElement("li"));d.id=e+"-"+l,d.setAttribute("role","option");let g=this.optionClass(h);g&&(d.className=g);for(let m of this.optionContent){let w=m(h,this.view.state,this.view,f);w&&d.appendChild(w)}}return i.from&&n.classList.add("cm-completionListIncompleteTop"),i.to<t.length&&n.classList.add("cm-completionListIncompleteBottom"),n}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function yA(r,t){return e=>new mA(e,r,t)}function wA(r,t){let e=r.getBoundingClientRect(),i=t.getBoundingClientRect(),n=e.height/r.offsetHeight;i.top<e.top?r.scrollTop-=(e.top-i.top)/n:i.bottom>e.bottom&&(r.scrollTop+=(i.bottom-e.bottom)/n)}function xp(r){return(r.boost||0)*100+(r.apply?10:0)+(r.info?5:0)+(r.type?1:0)}function vA(r,t){let e=[],i=null,n=c=>{e.push(c);let{section:d}=c.completion;if(d){i||(i=[]);let g=typeof d=="string"?d:d.name;i.some(m=>m.name==g)||i.push(typeof d=="string"?{name:g}:d)}},o=t.facet(Xt);for(let c of r)if(c.hasResult()){let d=c.result.getMatch;if(c.result.filter===!1)for(let g of c.result.options)n(new yp(g,c.source,d?d(g):[],1e9-e.length));else{let g=t.sliceDoc(c.from,c.to),m,w=o.filterStrict?new dA(g):new cA(g);for(let b of c.result.options)if(m=w.match(b.label)){let S=b.displayLabel?d?d(b,m.matched):[]:m.matched;n(new yp(b,c.source,S,m.score+(b.boost||0)))}}}if(i){let c=Object.create(null),d=0,g=(m,w)=>{var b,S;return((b=m.rank)!==null&&b!==void 0?b:1e9)-((S=w.rank)!==null&&S!==void 0?S:1e9)||(m.name<w.name?-1:1)};for(let m of i.sort(g))d-=1e5,c[m.name]=d;for(let m of e){let{section:w}=m.completion;w&&(m.score+=c[typeof w=="string"?w:w.name])}}let l=[],h=null,f=o.compareCompletions;for(let c of e.sort((d,g)=>g.score-d.score||f(d.completion,g.completion))){let d=c.completion;!h||h.label!=d.label||h.detail!=d.detail||h.type!=null&&d.type!=null&&h.type!=d.type||h.apply!=d.apply||h.boost!=d.boost?l.push(c):xp(c.completion)>xp(h)&&(l[l.length-1]=c),h=c.completion}return l}class Gn{constructor(t,e,i,n,o,l){this.options=t,this.attrs=e,this.tooltip=i,this.timestamp=n,this.selected=o,this.disabled=l}setSelected(t,e){return t==this.selected||t>=this.options.length?this:new Gn(this.options,bp(e,t),this.tooltip,this.timestamp,t,this.disabled)}static build(t,e,i,n,o,l){if(n&&!l&&t.some(c=>c.isPending))return n.setDisabled();let h=vA(t,e);if(!h.length)return n&&t.some(c=>c.isPending)?n.setDisabled():null;let f=e.facet(Xt).selectOnOpen?0:-1;if(n&&n.selected!=f&&n.selected!=-1){let c=n.options[n.selected].completion;for(let d=0;d<h.length;d++)if(h[d].completion==c){f=d;break}}return new Gn(h,bp(i,f),{pos:t.reduce((c,d)=>d.hasResult()?Math.min(c,d.from):c,1e8),create:CA,above:o.aboveCursor},n?n.timestamp:Date.now(),f,!1)}map(t){return new Gn(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:t.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new Gn(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class il{constructor(t,e,i){this.active=t,this.id=e,this.open=i}static start(){return new il(SA,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(t){let{state:e}=t,i=e.facet(Xt),o=(i.override||e.languageDataAt("autocomplete",Tn(e)).map(uA)).map(f=>(this.active.find(d=>d.source==f)||new Ue(f,this.active.some(d=>d.state!=0)?1:0)).update(t,i));o.length==this.active.length&&o.every((f,c)=>f==this.active[c])&&(o=this.active);let l=this.open,h=t.effects.some(f=>f.is(gf));l&&t.docChanged&&(l=l.map(t.changes)),t.selection||o.some(f=>f.hasResult()&&t.changes.touchesRange(f.from,f.to))||!xA(o,this.active)||h?l=Gn.build(o,e,this.id,l,i,h):l&&l.disabled&&!o.some(f=>f.isPending)&&(l=null),!l&&o.every(f=>!f.isPending)&&o.some(f=>f.hasResult())&&(o=o.map(f=>f.hasResult()?new Ue(f.source,0):f));for(let f of t.effects)f.is(Rm)&&(l=l&&l.setSelected(f.value,this.id));return o==this.active&&l==this.open?this:new il(o,this.id,l)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?bA:OA}}function xA(r,t){if(r==t)return!0;for(let e=0,i=0;;){for(;e<r.length&&!r[e].hasResult();)e++;for(;i<t.length&&!t[i].hasResult();)i++;let n=e==r.length,o=i==t.length;if(n||o)return n==o;if(r[e++].result!=t[i++].result)return!1}}const bA={"aria-autocomplete":"list"},OA={};function bp(r,t){let e={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":r};return t>-1&&(e["aria-activedescendant"]=r+"-"+t),e}const SA=[];function Mm(r,t){if(r.isUserEvent("input.complete")){let i=r.annotation(Pm);if(i&&t.activateOnCompletion(i))return 12}let e=r.isUserEvent("input.type");return e&&t.activateOnTyping?5:e?1:r.isUserEvent("delete.backward")?2:r.selection?8:r.docChanged?16:0}class Ue{constructor(t,e,i=!1){this.source=t,this.state=e,this.explicit=i}hasResult(){return!1}get isPending(){return this.state==1}update(t,e){let i=Mm(t,e),n=this;(i&8||i&16&&this.touches(t))&&(n=new Ue(n.source,0)),i&4&&n.state==0&&(n=new Ue(this.source,1)),n=n.updateFor(t,i);for(let o of t.effects)if(o.is(el))n=new Ue(n.source,1,o.value);else if(o.is(hs))n=new Ue(n.source,0);else if(o.is(gf))for(let l of o.value)l.source==n.source&&(n=l);return n}updateFor(t,e){return this.map(t.changes)}map(t){return this}touches(t){return t.changes.touchesRange(Tn(t.state))}}class tr extends Ue{constructor(t,e,i,n,o,l){super(t,3,e),this.limit=i,this.result=n,this.from=o,this.to=l}hasResult(){return!0}updateFor(t,e){var i;if(!(e&3))return this.map(t.changes);let n=this.result;n.map&&!t.changes.empty&&(n=n.map(n,t.changes));let o=t.changes.mapPos(this.from),l=t.changes.mapPos(this.to,1),h=Tn(t.state);if(h>l||!n||e&2&&(Tn(t.startState)==this.from||h<this.limit))return new Ue(this.source,e&4?1:0);let f=t.changes.mapPos(this.limit);return kA(n.validFor,t.state,o,l)?new tr(this.source,this.explicit,f,n,o,l):n.update&&(n=n.update(n,o,l,new Am(t.state,h,!1)))?new tr(this.source,this.explicit,f,n,n.from,(i=n.to)!==null&&i!==void 0?i:Tn(t.state)):new Ue(this.source,1,this.explicit)}map(t){return t.empty?this:(this.result.map?this.result.map(this.result,t):this.result)?new tr(this.source,this.explicit,t.mapPos(this.limit),this.result,t.mapPos(this.from),t.mapPos(this.to,1)):new Ue(this.source,0)}touches(t){return t.changes.touchesRange(this.from,this.to)}}function kA(r,t,e,i){if(!r)return!1;let n=t.sliceDoc(e,i);return typeof r=="function"?r(n,e,i,t):Tm(r,!0).test(n)}const gf=ct.define({map(r,t){return r.map(e=>e.map(t))}}),Rm=ct.define(),ye=be.define({create(){return il.start()},update(r,t){return r.update(t)},provide:r=>[uf.from(r,t=>t.tooltip),Z.contentAttributes.from(r,t=>t.attrs)]});function mf(r,t){const e=t.completion.apply||t.completion.label;let i=r.state.field(ye).active.find(n=>n.source==t.source);return i instanceof tr?(typeof e=="string"?r.dispatch(Object.assign(Object.assign({},fA(r.state,e,i.from,i.to)),{annotations:Pm.of(t.completion)})):e(r,t.completion,i.from,i.to),!0):!1}const CA=yA(ye,mf);function _o(r,t="option"){return e=>{let i=e.state.field(ye,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<e.state.facet(Xt).interactionDelay)return!1;let n=1,o;t=="page"&&(o=um(e,i.open.tooltip))&&(n=Math.max(2,Math.floor(o.dom.offsetHeight/o.dom.querySelector("li").offsetHeight)-1));let{length:l}=i.open.options,h=i.open.selected>-1?i.open.selected+n*(r?1:-1):r?0:l-1;return h<0?h=t=="page"?0:l-1:h>=l&&(h=t=="page"?l-1:0),e.dispatch({effects:Rm.of(h)}),!0}}const AA=r=>{let t=r.state.field(ye,!1);return r.state.readOnly||!t||!t.open||t.open.selected<0||t.open.disabled||Date.now()-t.open.timestamp<r.state.facet(Xt).interactionDelay?!1:mf(r,t.open.options[t.open.selected])},Op=r=>r.state.field(ye,!1)?(r.dispatch({effects:el.of(!0)}),!0):!1,TA=r=>{let t=r.state.field(ye,!1);return!t||!t.active.some(e=>e.state!=0)?!1:(r.dispatch({effects:hs.of(null)}),!0)};class PA{constructor(t,e){this.active=t,this.context=e,this.time=Date.now(),this.updates=[],this.done=void 0}}const MA=50,RA=1e3,_A=_e.fromClass(class{constructor(r){this.view=r,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let t of r.state.field(ye).active)t.isPending&&this.startQuery(t)}update(r){let t=r.state.field(ye),e=r.state.facet(Xt);if(!r.selectionSet&&!r.docChanged&&r.startState.field(ye)==t)return;let i=r.transactions.some(o=>{let l=Mm(o,e);return l&8||(o.selection||o.docChanged)&&!(l&3)});for(let o=0;o<this.running.length;o++){let l=this.running[o];if(i||l.context.abortOnDocChange&&r.docChanged||l.updates.length+r.transactions.length>MA&&Date.now()-l.time>RA){for(let h of l.context.abortListeners)try{h()}catch(f){ae(this.view.state,f)}l.context.abortListeners=null,this.running.splice(o--,1)}else l.updates.push(...r.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),r.transactions.some(o=>o.effects.some(l=>l.is(el)))&&(this.pendingStart=!0);let n=this.pendingStart?50:e.activateOnTypingDelay;if(this.debounceUpdate=t.active.some(o=>o.isPending&&!this.running.some(l=>l.active.source==o.source))?setTimeout(()=>this.startUpdate(),n):-1,this.composing!=0)for(let o of r.transactions)o.isUserEvent("input.type")?this.composing=2:this.composing==2&&o.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:r}=this.view,t=r.field(ye);for(let e of t.active)e.isPending&&!this.running.some(i=>i.active.source==e.source)&&this.startQuery(e);this.running.length&&t.open&&t.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Xt).updateSyncTime))}startQuery(r){let{state:t}=this.view,e=Tn(t),i=new Am(t,e,r.explicit,this.view),n=new PA(r,i);this.running.push(n),Promise.resolve(r.source(i)).then(o=>{n.context.aborted||(n.done=o||null,this.scheduleAccept())},o=>{this.view.dispatch({effects:hs.of(null)}),ae(this.view.state,o)})}scheduleAccept(){this.running.every(r=>r.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Xt).updateSyncTime))}accept(){var r;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let t=[],e=this.view.state.facet(Xt),i=this.view.state.field(ye);for(let n=0;n<this.running.length;n++){let o=this.running[n];if(o.done===void 0)continue;if(this.running.splice(n--,1),o.done){let h=Tn(o.updates.length?o.updates[0].startState:this.view.state),f=Math.min(h,o.done.from+(o.active.explicit?0:1)),c=new tr(o.active.source,o.active.explicit,f,o.done,o.done.from,(r=o.done.to)!==null&&r!==void 0?r:h);for(let d of o.updates)c=c.update(d,e);if(c.hasResult()){t.push(c);continue}}let l=i.active.find(h=>h.source==o.active.source);if(l&&l.isPending)if(o.done==null){let h=new Ue(o.active.source,0);for(let f of o.updates)h=h.update(f,e);h.isPending||t.push(h)}else this.startQuery(l)}(t.length||i.open&&i.open.disabled)&&this.view.dispatch({effects:gf.of(t)})}},{eventHandlers:{blur(r){let t=this.view.state.field(ye,!1);if(t&&t.tooltip&&this.view.state.facet(Xt).closeOnBlur){let e=t.open&&um(this.view,t.open.tooltip);(!e||!e.dom.contains(r.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:hs.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:el.of(!1)}),20),this.composing=0}}}),EA=typeof navigator=="object"&&/Win/.test(navigator.platform),DA=cs.highest(Z.domEventHandlers({keydown(r,t){let e=t.state.field(ye,!1);if(!e||!e.open||e.open.disabled||e.open.selected<0||r.key.length>1||r.ctrlKey&&!(EA&&r.altKey)||r.metaKey)return!1;let i=e.open.options[e.open.selected],n=e.active.find(l=>l.source==i.source),o=i.completion.commitCharacters||n.result.commitCharacters;return o&&o.indexOf(r.key)>-1&&mf(t,i),!1}})),IA=Z.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),fs={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},An=ct.define({map(r,t){let e=t.mapPos(r,-1,le.TrackAfter);return e??void 0}}),yf=new class extends Mn{};yf.startSide=1;yf.endSide=-1;const _m=be.define({create(){return At.empty},update(r,t){if(r=r.map(t.changes),t.selection){let e=t.state.doc.lineAt(t.selection.main.head);r=r.update({filter:i=>i>=e.from&&i<=e.to})}for(let e of t.effects)e.is(An)&&(r=r.update({add:[yf.range(e.value,e.value+1)]}));return r}});function BA(){return[NA,_m]}const Ja="()[]{}<>";function Em(r){for(let t=0;t<Ja.length;t+=2)if(Ja.charCodeAt(t)==r)return Ja.charAt(t+1);return eg(r<128?r:r+1)}function Dm(r,t){return r.languageDataAt("closeBrackets",t)[0]||fs}const LA=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),NA=Z.inputHandler.of((r,t,e,i)=>{if((LA?r.composing:r.compositionStarted)||r.state.readOnly)return!1;let n=r.state.selection.main;if(i.length>2||i.length==2&&Wi(Ve(i,0))==1||t!=n.from||e!=n.to)return!1;let o=FA(r.state,i);return o?(r.dispatch(o),!0):!1}),$A=({state:r,dispatch:t})=>{if(r.readOnly)return!1;let i=Dm(r,r.selection.main.head).brackets||fs.brackets,n=null,o=r.changeByRange(l=>{if(l.empty){let h=VA(r.doc,l.head);for(let f of i)if(f==h&&pl(r.doc,l.head)==Em(Ve(f,0)))return{changes:{from:l.head-f.length,to:l.head+f.length},range:z.cursor(l.head-f.length)}}return{range:n=l}});return n||t(r.update(o,{scrollIntoView:!0,userEvent:"delete.backward"})),!n},WA=[{key:"Backspace",run:$A}];function FA(r,t){let e=Dm(r,r.selection.main.head),i=e.brackets||fs.brackets;for(let n of i){let o=Em(Ve(n,0));if(t==n)return o==n?qA(r,n,i.indexOf(n+n+n)>-1,e):HA(r,n,o,e.before||fs.before);if(t==o&&Im(r,r.selection.main.from))return zA(r,n,o)}return null}function Im(r,t){let e=!1;return r.field(_m).between(0,r.doc.length,i=>{i==t&&(e=!0)}),e}function pl(r,t){let e=r.sliceString(t,t+2);return e.slice(0,Wi(Ve(e,0)))}function VA(r,t){let e=r.sliceString(t-2,t);return Wi(Ve(e,0))==e.length?e:e.slice(1)}function HA(r,t,e,i){let n=null,o=r.changeByRange(l=>{if(!l.empty)return{changes:[{insert:t,from:l.from},{insert:e,from:l.to}],effects:An.of(l.to+t.length),range:z.range(l.anchor+t.length,l.head+t.length)};let h=pl(r.doc,l.head);return!h||/\s/.test(h)||i.indexOf(h)>-1?{changes:{insert:t+e,from:l.head},effects:An.of(l.head+t.length),range:z.cursor(l.head+t.length)}:{range:n=l}});return n?null:r.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function zA(r,t,e){let i=null,n=r.changeByRange(o=>o.empty&&pl(r.doc,o.head)==e?{changes:{from:o.head,to:o.head+e.length,insert:e},range:z.cursor(o.head+e.length)}:i={range:o});return i?null:r.update(n,{scrollIntoView:!0,userEvent:"input.type"})}function qA(r,t,e,i){let n=i.stringPrefixes||fs.stringPrefixes,o=null,l=r.changeByRange(h=>{if(!h.empty)return{changes:[{insert:t,from:h.from},{insert:t,from:h.to}],effects:An.of(h.to+t.length),range:z.range(h.anchor+t.length,h.head+t.length)};let f=h.head,c=pl(r.doc,f),d;if(c==t){if(Sp(r,f))return{changes:{insert:t+t,from:f},effects:An.of(f+t.length),range:z.cursor(f+t.length)};if(Im(r,f)){let m=e&&r.sliceDoc(f,f+t.length*3)==t+t+t?t+t+t:t;return{changes:{from:f,to:f+m.length,insert:m},range:z.cursor(f+m.length)}}}else{if(e&&r.sliceDoc(f-2*t.length,f)==t+t&&(d=kp(r,f-2*t.length,n))>-1&&Sp(r,d))return{changes:{insert:t+t+t+t,from:f},effects:An.of(f+t.length),range:z.cursor(f+t.length)};if(r.charCategorizer(f)(c)!=qe.Word&&kp(r,f,n)>-1&&!UA(r,f,t,n))return{changes:{insert:t+t,from:f},effects:An.of(f+t.length),range:z.cursor(f+t.length)}}return{range:o=h}});return o?null:r.update(l,{scrollIntoView:!0,userEvent:"input.type"})}function Sp(r,t){let e=xe(r).resolveInner(t+1);return e.parent&&e.from==t}function UA(r,t,e,i){let n=xe(r).resolveInner(t,-1),o=i.reduce((l,h)=>Math.max(l,h.length),0);for(let l=0;l<5;l++){let h=r.sliceDoc(n.from,Math.min(n.to,n.from+e.length+o)),f=h.indexOf(e);if(!f||f>-1&&i.indexOf(h.slice(0,f))>-1){let d=n.firstChild;for(;d&&d.from==n.from&&d.to-d.from>e.length+f;){if(r.sliceDoc(d.to-e.length,d.to)==e)return!1;d=d.firstChild}return!0}let c=n.to==t&&n.parent;if(!c)break;n=c}return!1}function kp(r,t,e){let i=r.charCategorizer(t);if(i(r.sliceDoc(t-1,t))!=qe.Word)return t;for(let n of e){let o=t-n.length;if(r.sliceDoc(o,t)==n&&i(r.sliceDoc(o-1,o))!=qe.Word)return o}return-1}function QA(r={}){return[DA,ye,Xt.of(r),_A,XA,IA]}const YA=[{key:"Ctrl-Space",run:Op},{mac:"Alt-`",run:Op},{key:"Escape",run:TA},{key:"ArrowDown",run:_o(!0)},{key:"ArrowUp",run:_o(!1)},{key:"PageDown",run:_o(!0,"page")},{key:"PageUp",run:_o(!1,"page")},{key:"Enter",run:AA}],XA=cs.highest(hf.computeN([Xt],r=>r.facet(Xt).defaultKeymap?[YA]:[])),Vh=qi.define(),KA=qi.define(),GA=Y.define(),Bm=Y.define({combine(r){return fl(r,{minDepth:100,newGroupDelay:500,joinToEvent:(t,e)=>e},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(t,e)=>(i,n)=>t(i,n)||e(i,n)})}}),Lm=be.define({create(){return xi.empty},update(r,t){let e=t.state.facet(Bm),i=t.annotation(Vh);if(i){let f=we.fromTransaction(t,i.selection),c=i.side,d=c==0?r.undone:r.done;return f?d=nl(d,d.length,e.minDepth,f):d=Wm(d,t.startState.selection),new xi(c==0?i.rest:d,c==0?d:i.rest)}let n=t.annotation(KA);if((n=="full"||n=="before")&&(r=r.isolate()),t.annotation(Qt.addToHistory)===!1)return t.changes.empty?r:r.addMapping(t.changes.desc);let o=we.fromTransaction(t),l=t.annotation(Qt.time),h=t.annotation(Qt.userEvent);return o?r=r.addChanges(o,l,h,e,t):t.selection&&(r=r.addSelection(t.startState.selection,l,h,e.newGroupDelay)),(n=="full"||n=="after")&&(r=r.isolate()),r},toJSON(r){return{done:r.done.map(t=>t.toJSON()),undone:r.undone.map(t=>t.toJSON())}},fromJSON(r){return new xi(r.done.map(we.fromJSON),r.undone.map(we.fromJSON))}});function ZA(r={}){return[Lm,Bm.of(r),Z.domEventHandlers({beforeinput(t,e){let i=t.inputType=="historyUndo"?Nm:t.inputType=="historyRedo"?Hh:null;return i?(t.preventDefault(),i(e)):!1}})]}function gl(r,t){return function({state:e,dispatch:i}){if(!t&&e.readOnly)return!1;let n=e.field(Lm,!1);if(!n)return!1;let o=n.pop(r,e,t);return o?(i(o),!0):!1}}const Nm=gl(0,!1),Hh=gl(1,!1),jA=gl(0,!0),JA=gl(1,!0);class we{constructor(t,e,i,n,o){this.changes=t,this.effects=e,this.mapped=i,this.startSelection=n,this.selectionsAfter=o}setSelAfter(t){return new we(this.changes,this.effects,this.mapped,this.startSelection,t)}toJSON(){var t,e,i;return{changes:(t=this.changes)===null||t===void 0?void 0:t.toJSON(),mapped:(e=this.mapped)===null||e===void 0?void 0:e.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(n=>n.toJSON())}}static fromJSON(t){return new we(t.changes&&Ut.fromJSON(t.changes),[],t.mapped&&Oi.fromJSON(t.mapped),t.startSelection&&z.fromJSON(t.startSelection),t.selectionsAfter.map(z.fromJSON))}static fromTransaction(t,e){let i=Qe;for(let n of t.startState.facet(GA)){let o=n(t);o.length&&(i=i.concat(o))}return!i.length&&t.changes.empty?null:new we(t.changes.invert(t.startState.doc),i,void 0,e||t.startState.selection,Qe)}static selection(t){return new we(void 0,Qe,void 0,void 0,t)}}function nl(r,t,e,i){let n=t+1>e+20?t-e-1:0,o=r.slice(n,t);return o.push(i),o}function tT(r,t){let e=[],i=!1;return r.iterChangedRanges((n,o)=>e.push(n,o)),t.iterChangedRanges((n,o,l,h)=>{for(let f=0;f<e.length;){let c=e[f++],d=e[f++];h>=c&&l<=d&&(i=!0)}}),i}function eT(r,t){return r.ranges.length==t.ranges.length&&r.ranges.filter((e,i)=>e.empty!=t.ranges[i].empty).length===0}function $m(r,t){return r.length?t.length?r.concat(t):r:t}const Qe=[],iT=200;function Wm(r,t){if(r.length){let e=r[r.length-1],i=e.selectionsAfter.slice(Math.max(0,e.selectionsAfter.length-iT));return i.length&&i[i.length-1].eq(t)?r:(i.push(t),nl(r,r.length-1,1e9,e.setSelAfter(i)))}else return[we.selection([t])]}function nT(r){let t=r[r.length-1],e=r.slice();return e[r.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1)),e}function th(r,t){if(!r.length)return r;let e=r.length,i=Qe;for(;e;){let n=rT(r[e-1],t,i);if(n.changes&&!n.changes.empty||n.effects.length){let o=r.slice(0,e);return o[e-1]=n,o}else t=n.mapped,e--,i=n.selectionsAfter}return i.length?[we.selection(i)]:Qe}function rT(r,t,e){let i=$m(r.selectionsAfter.length?r.selectionsAfter.map(h=>h.map(t)):Qe,e);if(!r.changes)return we.selection(i);let n=r.changes.map(t),o=t.mapDesc(r.changes,!0),l=r.mapped?r.mapped.composeDesc(o):o;return new we(n,ct.mapEffects(r.effects,t),l,r.startSelection.map(o),i)}const sT=/^(input\.type|delete)($|\.)/;class xi{constructor(t,e,i=0,n=void 0){this.done=t,this.undone=e,this.prevTime=i,this.prevUserEvent=n}isolate(){return this.prevTime?new xi(this.done,this.undone):this}addChanges(t,e,i,n,o){let l=this.done,h=l[l.length-1];return h&&h.changes&&!h.changes.empty&&t.changes&&(!i||sT.test(i))&&(!h.selectionsAfter.length&&e-this.prevTime<n.newGroupDelay&&n.joinToEvent(o,tT(h.changes,t.changes))||i=="input.type.compose")?l=nl(l,l.length-1,n.minDepth,new we(t.changes.compose(h.changes),$m(ct.mapEffects(t.effects,h.changes),h.effects),h.mapped,h.startSelection,Qe)):l=nl(l,l.length,n.minDepth,t),new xi(l,Qe,e,i)}addSelection(t,e,i,n){let o=this.done.length?this.done[this.done.length-1].selectionsAfter:Qe;return o.length>0&&e-this.prevTime<n&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&eT(o[o.length-1],t)?this:new xi(Wm(this.done,t),this.undone,e,i)}addMapping(t){return new xi(th(this.done,t),th(this.undone,t),this.prevTime,this.prevUserEvent)}pop(t,e,i){let n=t==0?this.done:this.undone;if(n.length==0)return null;let o=n[n.length-1],l=o.selectionsAfter[0]||e.selection;if(i&&o.selectionsAfter.length)return e.update({selection:o.selectionsAfter[o.selectionsAfter.length-1],annotations:Vh.of({side:t,rest:nT(n),selection:l}),userEvent:t==0?"select.undo":"select.redo",scrollIntoView:!0});if(o.changes){let h=n.length==1?Qe:n.slice(0,n.length-1);return o.mapped&&(h=th(h,o.mapped)),e.update({changes:o.changes,selection:o.startSelection,effects:o.effects,annotations:Vh.of({side:t,rest:h,selection:l}),filter:!1,userEvent:t==0?"undo":"redo",scrollIntoView:!0})}else return null}}xi.empty=new xi(Qe,Qe);const oT=[{key:"Mod-z",run:Nm,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Hh,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Hh,preventDefault:!0},{key:"Mod-u",run:jA,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:JA,preventDefault:!0}];function lT(r,t){if(/\(\)|\[\]|\{\}/.test(r.sliceDoc(t-1,t+1)))return{from:t,to:t};let e=xe(r).resolveInner(t),i=e.childBefore(t),n=e.childAfter(t),o;return i&&n&&i.to<=t&&n.from>=t&&(o=i.type.prop(ht.closedBy))&&o.indexOf(n.name)>-1&&r.doc.lineAt(i.to).from==r.doc.lineAt(n.from).from&&!/\S/.test(r.sliceDoc(i.to,n.from))?{from:i.to,to:n.from}:null}const Cp=aT(!1);function aT(r){return({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange(n=>{let{from:o,to:l}=n,h=t.doc.lineAt(o),f=!r&&o==l&&lT(t,o);r&&(o=l=(l<=h.to?h:t.doc.lineAt(l)).to);let c=new df(t,{simulateBreak:o,simulateDoubleBreak:!!f}),d=BC(c,o);for(d==null&&(d=pg(/^\s*/.exec(t.doc.lineAt(o).text)[0],t.tabSize));l<h.to&&/\s/.test(h.text[l-h.from]);)l++;f?{from:o,to:l}=f:o>h.from&&o<h.from+100&&!/\S/.test(h.text.slice(0,o))&&(o=h.from);let g=["",ap(t,d)];return f&&g.push(ap(t,c.lineIndent(h.from,-1))),{changes:{from:o,to:l,insert:pt.of(g)},range:z.cursor(o+1+g[1].length)}});return e(t.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}var Ap={};class rl{constructor(t,e,i,n,o,l,h,f,c,d=0,g){this.p=t,this.stack=e,this.state=i,this.reducePos=n,this.pos=o,this.score=l,this.buffer=h,this.bufferBase=f,this.curContext=c,this.lookAhead=d,this.parent=g}toString(){return`[${this.stack.filter((t,e)=>e%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(t,e,i=0){let n=t.parser.context;return new rl(t,[],e,i,i,0,[],0,n?new Tp(n,n.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(t,e){this.stack.push(this.state,e,this.bufferBase+this.buffer.length),this.state=t}reduce(t){var e;let i=t>>19,n=t&65535,{parser:o}=this.p,l=this.reducePos<this.pos-25;l&&this.setLookAhead(this.pos);let h=o.dynamicPrecedence(n);if(h&&(this.score+=h),i==0){this.pushState(o.getGoto(this.state,n,!0),this.reducePos),n<o.minRepeatTerm&&this.storeNode(n,this.reducePos,this.reducePos,l?8:4,!0),this.reduceContext(n,this.reducePos);return}let f=this.stack.length-(i-1)*3-(t&262144?6:0),c=f?this.stack[f-2]:this.p.ranges[0].from,d=this.reducePos-c;d>=2e3&&!(!((e=this.p.parser.nodeSet.types[n])===null||e===void 0)&&e.isAnonymous)&&(c==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=d):this.p.lastBigReductionSize<d&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=c,this.p.lastBigReductionSize=d));let g=f?this.stack[f-1]:0,m=this.bufferBase+this.buffer.length-g;if(n<o.minRepeatTerm||t&131072){let w=o.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(n,c,w,m+4,!0)}if(t&262144)this.state=this.stack[f];else{let w=this.stack[f-3];this.state=o.getGoto(w,n,!0)}for(;this.stack.length>f;)this.stack.pop();this.reduceContext(n,c)}storeNode(t,e,i,n=4,o=!1){if(t==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let l=this,h=this.buffer.length;if(h==0&&l.parent&&(h=l.bufferBase-l.parent.bufferBase,l=l.parent),h>0&&l.buffer[h-4]==0&&l.buffer[h-1]>-1){if(e==i)return;if(l.buffer[h-2]>=e){l.buffer[h-2]=i;return}}}if(!o||this.pos==i)this.buffer.push(t,e,i,n);else{let l=this.buffer.length;if(l>0&&this.buffer[l-4]!=0){let h=!1;for(let f=l;f>0&&this.buffer[f-2]>i;f-=4)if(this.buffer[f-1]>=0){h=!0;break}if(h)for(;l>0&&this.buffer[l-2]>i;)this.buffer[l]=this.buffer[l-4],this.buffer[l+1]=this.buffer[l-3],this.buffer[l+2]=this.buffer[l-2],this.buffer[l+3]=this.buffer[l-1],l-=4,n>4&&(n-=4)}this.buffer[l]=t,this.buffer[l+1]=e,this.buffer[l+2]=i,this.buffer[l+3]=n}}shift(t,e,i,n){if(t&131072)this.pushState(t&65535,this.pos);else if((t&262144)==0){let o=t,{parser:l}=this.p;(n>this.pos||e<=l.maxNode)&&(this.pos=n,l.stateFlag(o,1)||(this.reducePos=n)),this.pushState(o,i),this.shiftContext(e,i),e<=l.maxNode&&this.buffer.push(e,i,n,4)}else this.pos=n,this.shiftContext(e,i),e<=this.p.parser.maxNode&&this.buffer.push(e,i,n,4)}apply(t,e,i,n){t&65536?this.reduce(t):this.shift(t,e,i,n)}useNode(t,e){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=t)&&(this.p.reused.push(t),i++);let n=this.pos;this.reducePos=this.pos=n+t.length,this.pushState(e,n),this.buffer.push(i,n,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,t,this,this.p.stream.reset(this.pos-t.length)))}split(){let t=this,e=t.buffer.length;for(;e>0&&t.buffer[e-2]>t.reducePos;)e-=4;let i=t.buffer.slice(e),n=t.bufferBase+e;for(;t&&n==t.bufferBase;)t=t.parent;return new rl(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,n,this.curContext,this.lookAhead,t)}recoverByDelete(t,e){let i=t<=this.p.parser.maxNode;i&&this.storeNode(t,this.pos,e,4),this.storeNode(0,this.pos,e,i?8:4),this.pos=this.reducePos=e,this.score-=190}canShift(t){for(let e=new hT(this);;){let i=this.p.parser.stateSlot(e.state,4)||this.p.parser.hasAction(e.state,t);if(i==0)return!1;if((i&65536)==0)return!0;e.reduce(i)}}recoverByInsert(t){if(this.stack.length>=300)return[];let e=this.p.parser.nextStates(this.state);if(e.length>8||this.stack.length>=120){let n=[];for(let o=0,l;o<e.length;o+=2)(l=e[o+1])!=this.state&&this.p.parser.hasAction(l,t)&&n.push(e[o],l);if(this.stack.length<120)for(let o=0;n.length<8&&o<e.length;o+=2){let l=e[o+1];n.some((h,f)=>f&1&&h==l)||n.push(e[o],l)}e=n}let i=[];for(let n=0;n<e.length&&i.length<4;n+=2){let o=e[n+1];if(o==this.state)continue;let l=this.split();l.pushState(o,this.pos),l.storeNode(0,l.pos,l.pos,4,!0),l.shiftContext(e[n],this.pos),l.reducePos=this.pos,l.score-=200,i.push(l)}return i}forceReduce(){let{parser:t}=this.p,e=t.stateSlot(this.state,5);if((e&65536)==0)return!1;if(!t.validAction(this.state,e)){let i=e>>19,n=e&65535,o=this.stack.length-i*3;if(o<0||t.getGoto(this.stack[o],n,!1)<0){let l=this.findForcedReduction();if(l==null)return!1;e=l}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(e),!0}findForcedReduction(){let{parser:t}=this.p,e=[],i=(n,o)=>{if(!e.includes(n))return e.push(n),t.allActions(n,l=>{if(!(l&393216))if(l&65536){let h=(l>>19)-o;if(h>1){let f=l&65535,c=this.stack.length-h*3;if(c>=0&&t.getGoto(this.stack[c],f,!1)>=0)return h<<19|65536|f}}else{let h=i(l,o+1);if(h!=null)return h}})};return i(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:t}=this.p;return t.data[t.stateSlot(this.state,1)]==65535&&!t.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(t){if(this.state!=t.state||this.stack.length!=t.stack.length)return!1;for(let e=0;e<this.stack.length;e+=3)if(this.stack[e]!=t.stack[e])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(t){return this.p.parser.dialect.flags[t]}shiftContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,t,this,this.p.stream.reset(e)))}reduceContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,t,this,this.p.stream.reset(e)))}emitContext(){let t=this.buffer.length-1;(t<0||this.buffer[t]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let t=this.buffer.length-1;(t<0||this.buffer[t]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(t){if(t!=this.curContext.context){let e=new Tp(this.curContext.tracker,t);e.hash!=this.curContext.hash&&this.emitContext(),this.curContext=e}}setLookAhead(t){t>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=t)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class Tp{constructor(t,e){this.tracker=t,this.context=e,this.hash=t.strict?t.hash(e):0}}class hT{constructor(t){this.start=t,this.state=t.state,this.stack=t.stack,this.base=this.stack.length}reduce(t){let e=t&65535,i=t>>19;i==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(i-1)*3;let n=this.start.p.parser.getGoto(this.stack[this.base-3],e,!0);this.state=n}}class sl{constructor(t,e,i){this.stack=t,this.pos=e,this.index=i,this.buffer=t.buffer,this.index==0&&this.maybeNext()}static create(t,e=t.bufferBase+t.buffer.length){return new sl(t,e,e-t.bufferBase)}maybeNext(){let t=this.stack.parent;t!=null&&(this.index=this.stack.bufferBase-t.bufferBase,this.stack=t,this.buffer=t.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new sl(this.stack,this.pos,this.index)}}function Xr(r,t=Uint16Array){if(typeof r!="string")return r;let e=null;for(let i=0,n=0;i<r.length;){let o=0;for(;;){let l=r.charCodeAt(i++),h=!1;if(l==126){o=65535;break}l>=92&&l--,l>=34&&l--;let f=l-32;if(f>=46&&(f-=46,h=!0),o+=f,h)break;o*=46}e?e[n++]=o:e=new t(o)}return e}class Vo{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const Pp=new Vo;class fT{constructor(t,e){this.input=t,this.ranges=e,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=Pp,this.rangeIndex=0,this.pos=this.chunkPos=e[0].from,this.range=e[0],this.end=e[e.length-1].to,this.readNext()}resolveOffset(t,e){let i=this.range,n=this.rangeIndex,o=this.pos+t;for(;o<i.from;){if(!n)return null;let l=this.ranges[--n];o-=i.from-l.to,i=l}for(;e<0?o>i.to:o>=i.to;){if(n==this.ranges.length-1)return null;let l=this.ranges[++n];o+=l.from-i.to,i=l}return o}clipPos(t){if(t>=this.range.from&&t<this.range.to)return t;for(let e of this.ranges)if(e.to>t)return Math.max(t,e.from);return this.end}peek(t){let e=this.chunkOff+t,i,n;if(e>=0&&e<this.chunk.length)i=this.pos+t,n=this.chunk.charCodeAt(e);else{let o=this.resolveOffset(t,1);if(o==null)return-1;if(i=o,i>=this.chunk2Pos&&i<this.chunk2Pos+this.chunk2.length)n=this.chunk2.charCodeAt(i-this.chunk2Pos);else{let l=this.rangeIndex,h=this.range;for(;h.to<=i;)h=this.ranges[++l];this.chunk2=this.input.chunk(this.chunk2Pos=i),i+this.chunk2.length>h.to&&(this.chunk2=this.chunk2.slice(0,h.to-i)),n=this.chunk2.charCodeAt(0)}}return i>=this.token.lookAhead&&(this.token.lookAhead=i+1),n}acceptToken(t,e=0){let i=e?this.resolveOffset(e,-1):this.pos;if(i==null||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=t,this.token.end=i}acceptTokenTo(t,e){this.token.value=t,this.token.end=e}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:t,chunkPos:e}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=t,this.chunk2Pos=e,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let t=this.input.chunk(this.pos),e=this.pos+t.length;this.chunk=e>this.range.to?t.slice(0,this.range.to-this.pos):t,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(t=1){for(this.chunkOff+=t;this.pos+t>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();t-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=t,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(t,e){if(e?(this.token=e,e.start=t,e.lookAhead=t+1,e.value=e.extended=-1):this.token=Pp,this.pos!=t){if(this.pos=t,t==this.end)return this.setDone(),this;for(;t<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;t>=this.range.to;)this.range=this.ranges[++this.rangeIndex];t>=this.chunkPos&&t<this.chunkPos+this.chunk.length?this.chunkOff=t-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(t,e){if(t>=this.chunkPos&&e<=this.chunkPos+this.chunk.length)return this.chunk.slice(t-this.chunkPos,e-this.chunkPos);if(t>=this.chunk2Pos&&e<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(t-this.chunk2Pos,e-this.chunk2Pos);if(t>=this.range.from&&e<=this.range.to)return this.input.read(t,e);let i="";for(let n of this.ranges){if(n.from>=e)break;n.to>t&&(i+=this.input.read(Math.max(n.from,t),Math.min(n.to,e)))}return i}}class er{constructor(t,e){this.data=t,this.id=e}token(t,e){let{parser:i}=e.p;Vm(this.data,t,e,this.id,i.data,i.tokenPrecTable)}}er.prototype.contextual=er.prototype.fallback=er.prototype.extend=!1;class Fm{constructor(t,e,i){this.precTable=e,this.elseToken=i,this.data=typeof t=="string"?Xr(t):t}token(t,e){let i=t.pos,n=0;for(;;){let o=t.next<0,l=t.resolveOffset(1,1);if(Vm(this.data,t,e,0,this.data,this.precTable),t.token.value>-1)break;if(this.elseToken==null)return;if(o||n++,l==null)break;t.reset(l,t.token)}n&&(t.reset(i,t.token),t.acceptToken(this.elseToken,n))}}Fm.prototype.contextual=er.prototype.fallback=er.prototype.extend=!1;function Vm(r,t,e,i,n,o){let l=0,h=1<<i,{dialect:f}=e.p.parser;t:for(;(h&r[l])!=0;){let c=r[l+1];for(let w=l+3;w<c;w+=2)if((r[w+1]&h)>0){let b=r[w];if(f.allows(b)&&(t.token.value==-1||t.token.value==b||uT(b,t.token.value,n,o))){t.acceptToken(b);break}}let d=t.next,g=0,m=r[l+2];if(t.next<0&&m>g&&r[c+m*3-3]==65535){l=r[c+m*3-1];continue t}for(;g<m;){let w=g+m>>1,b=c+w+(w<<1),S=r[b],C=r[b+1]||65536;if(d<S)m=w;else if(d>=C)g=w+1;else{l=r[b+2],t.advance();continue t}}break}}function Mp(r,t,e){for(let i=t,n;(n=r[i])!=65535;i++)if(n==e)return i-t;return-1}function uT(r,t,e,i){let n=Mp(e,i,t);return n<0||Mp(e,i,r)<n}const Me=typeof process<"u"&&Ap&&/\bparse\b/.test(Ap.LOG);let eh=null;function Rp(r,t,e){let i=r.cursor(Rt.IncludeAnonymous);for(i.moveTo(t);;)if(!(e<0?i.childBefore(t):i.childAfter(t)))for(;;){if((e<0?i.to<t:i.from>t)&&!i.type.isError)return e<0?Math.max(0,Math.min(i.to-1,t-25)):Math.min(r.length,Math.max(i.from+1,t+25));if(e<0?i.prevSibling():i.nextSibling())break;if(!i.parent())return e<0?0:r.length}}class cT{constructor(t,e){this.fragments=t,this.nodeSet=e,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let t=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(t){for(this.safeFrom=t.openStart?Rp(t.tree,t.from+t.offset,1)-t.offset:t.from,this.safeTo=t.openEnd?Rp(t.tree,t.to+t.offset,-1)-t.offset:t.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(t.tree),this.start.push(-t.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(t){if(t<this.nextStart)return null;for(;this.fragment&&this.safeTo<=t;)this.nextFragment();if(!this.fragment)return null;for(;;){let e=this.trees.length-1;if(e<0)return this.nextFragment(),null;let i=this.trees[e],n=this.index[e];if(n==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let o=i.children[n],l=this.start[e]+i.positions[n];if(l>t)return this.nextStart=l,null;if(o instanceof Et){if(l==t){if(l<this.safeFrom)return null;let h=l+o.length;if(h<=this.safeTo){let f=o.prop(ht.lookAhead);if(!f||h+f<this.fragment.to)return o}}this.index[e]++,l+o.length>=Math.max(this.safeFrom,t)&&(this.trees.push(o),this.start.push(l),this.index.push(0))}else this.index[e]++,this.nextStart=l+o.length}}}class dT{constructor(t,e){this.stream=e,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=t.tokenizers.map(i=>new Vo)}getActions(t){let e=0,i=null,{parser:n}=t.p,{tokenizers:o}=n,l=n.stateSlot(t.state,3),h=t.curContext?t.curContext.hash:0,f=0;for(let c=0;c<o.length;c++){if((1<<c&l)==0)continue;let d=o[c],g=this.tokens[c];if(!(i&&!d.fallback)&&((d.contextual||g.start!=t.pos||g.mask!=l||g.context!=h)&&(this.updateCachedToken(g,d,t),g.mask=l,g.context=h),g.lookAhead>g.end+25&&(f=Math.max(g.lookAhead,f)),g.value!=0)){let m=e;if(g.extended>-1&&(e=this.addActions(t,g.extended,g.end,e)),e=this.addActions(t,g.value,g.end,e),!d.extend&&(i=g,e>m))break}}for(;this.actions.length>e;)this.actions.pop();return f&&t.setLookAhead(f),!i&&t.pos==this.stream.end&&(i=new Vo,i.value=t.p.parser.eofTerm,i.start=i.end=t.pos,e=this.addActions(t,i.value,i.end,e)),this.mainToken=i,this.actions}getMainToken(t){if(this.mainToken)return this.mainToken;let e=new Vo,{pos:i,p:n}=t;return e.start=i,e.end=Math.min(i+1,n.stream.end),e.value=i==n.stream.end?n.parser.eofTerm:0,e}updateCachedToken(t,e,i){let n=this.stream.clipPos(i.pos);if(e.token(this.stream.reset(n,t),i),t.value>-1){let{parser:o}=i.p;for(let l=0;l<o.specialized.length;l++)if(o.specialized[l]==t.value){let h=o.specializers[l](this.stream.read(t.start,t.end),i);if(h>=0&&i.p.parser.dialect.allows(h>>1)){(h&1)==0?t.value=h>>1:t.extended=h>>1;break}}}else t.value=0,t.end=this.stream.clipPos(n+1)}putAction(t,e,i,n){for(let o=0;o<n;o+=3)if(this.actions[o]==t)return n;return this.actions[n++]=t,this.actions[n++]=e,this.actions[n++]=i,n}addActions(t,e,i,n){let{state:o}=t,{parser:l}=t.p,{data:h}=l;for(let f=0;f<2;f++)for(let c=l.stateSlot(o,f?2:1);;c+=3){if(h[c]==65535)if(h[c+1]==1)c=$i(h,c+2);else{n==0&&h[c+1]==2&&(n=this.putAction($i(h,c+2),e,i,n));break}h[c]==e&&(n=this.putAction($i(h,c+1),e,i,n))}return n}}class pT{constructor(t,e,i,n){this.parser=t,this.input=e,this.ranges=n,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new fT(e,n),this.tokens=new dT(t,this.stream),this.topTerm=t.top[1];let{from:o}=n[0];this.stacks=[rl.start(this,t.top[0],o)],this.fragments=i.length&&this.stream.end-o>t.bufferLength*4?new cT(i,t.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let t=this.stacks,e=this.minStackPos,i=this.stacks=[],n,o;if(this.bigReductionCount>300&&t.length==1){let[l]=t;for(;l.forceReduce()&&l.stack.length&&l.stack[l.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let l=0;l<t.length;l++){let h=t[l];for(;;){if(this.tokens.mainToken=null,h.pos>e)i.push(h);else{if(this.advanceStack(h,i,t))continue;{n||(n=[],o=[]),n.push(h);let f=this.tokens.getMainToken(h);o.push(f.value,f.end)}}break}}if(!i.length){let l=n&&mT(n);if(l)return Me&&console.log("Finish with "+this.stackID(l)),this.stackToTree(l);if(this.parser.strict)throw Me&&n&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+e);this.recovering||(this.recovering=5)}if(this.recovering&&n){let l=this.stoppedAt!=null&&n[0].pos>this.stoppedAt?n[0]:this.runRecovery(n,o,i);if(l)return Me&&console.log("Force-finish "+this.stackID(l)),this.stackToTree(l.forceAll())}if(this.recovering){let l=this.recovering==1?1:this.recovering*3;if(i.length>l)for(i.sort((h,f)=>f.score-h.score);i.length>l;)i.pop();i.some(h=>h.reducePos>e)&&this.recovering--}else if(i.length>1){t:for(let l=0;l<i.length-1;l++){let h=i[l];for(let f=l+1;f<i.length;f++){let c=i[f];if(h.sameState(c)||h.buffer.length>500&&c.buffer.length>500)if((h.score-c.score||h.buffer.length-c.buffer.length)>0)i.splice(f--,1);else{i.splice(l--,1);continue t}}}i.length>12&&i.splice(12,i.length-12)}this.minStackPos=i[0].pos;for(let l=1;l<i.length;l++)i[l].pos<this.minStackPos&&(this.minStackPos=i[l].pos);return null}stopAt(t){if(this.stoppedAt!=null&&this.stoppedAt<t)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=t}advanceStack(t,e,i){let n=t.pos,{parser:o}=this,l=Me?this.stackID(t)+" -> ":"";if(this.stoppedAt!=null&&n>this.stoppedAt)return t.forceReduce()?t:null;if(this.fragments){let c=t.curContext&&t.curContext.tracker.strict,d=c?t.curContext.hash:0;for(let g=this.fragments.nodeAt(n);g;){let m=this.parser.nodeSet.types[g.type.id]==g.type?o.getGoto(t.state,g.type.id):-1;if(m>-1&&g.length&&(!c||(g.prop(ht.contextHash)||0)==d))return t.useNode(g,m),Me&&console.log(l+this.stackID(t)+` (via reuse of ${o.getName(g.type.id)})`),!0;if(!(g instanceof Et)||g.children.length==0||g.positions[0]>0)break;let w=g.children[0];if(w instanceof Et&&g.positions[0]==0)g=w;else break}}let h=o.stateSlot(t.state,4);if(h>0)return t.reduce(h),Me&&console.log(l+this.stackID(t)+` (via always-reduce ${o.getName(h&65535)})`),!0;if(t.stack.length>=8400)for(;t.stack.length>6e3&&t.forceReduce(););let f=this.tokens.getActions(t);for(let c=0;c<f.length;){let d=f[c++],g=f[c++],m=f[c++],w=c==f.length||!i,b=w?t:t.split(),S=this.tokens.mainToken;if(b.apply(d,g,S?S.start:b.pos,m),Me&&console.log(l+this.stackID(b)+` (via ${(d&65536)==0?"shift":`reduce of ${o.getName(d&65535)}`} for ${o.getName(g)} @ ${n}${b==t?"":", split"})`),w)return!0;b.pos>n?e.push(b):i.push(b)}return!1}advanceFully(t,e){let i=t.pos;for(;;){if(!this.advanceStack(t,null,null))return!1;if(t.pos>i)return _p(t,e),!0}}runRecovery(t,e,i){let n=null,o=!1;for(let l=0;l<t.length;l++){let h=t[l],f=e[l<<1],c=e[(l<<1)+1],d=Me?this.stackID(h)+" -> ":"";if(h.deadEnd&&(o||(o=!0,h.restart(),Me&&console.log(d+this.stackID(h)+" (restarted)"),this.advanceFully(h,i))))continue;let g=h.split(),m=d;for(let w=0;g.forceReduce()&&w<10&&(Me&&console.log(m+this.stackID(g)+" (via force-reduce)"),!this.advanceFully(g,i));w++)Me&&(m=this.stackID(g)+" -> ");for(let w of h.recoverByInsert(f))Me&&console.log(d+this.stackID(w)+" (via recover-insert)"),this.advanceFully(w,i);this.stream.end>h.pos?(c==h.pos&&(c++,f=0),h.recoverByDelete(f,c),Me&&console.log(d+this.stackID(h)+` (via recover-delete ${this.parser.getName(f)})`),_p(h,i)):(!n||n.score<h.score)&&(n=h)}return n}stackToTree(t){return t.close(),Et.build({buffer:sl.create(t),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:t.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(t){let e=(eh||(eh=new WeakMap)).get(t);return e||eh.set(t,e=String.fromCodePoint(this.nextStackID++)),e+t}}function _p(r,t){for(let e=0;e<t.length;e++){let i=t[e];if(i.pos==r.pos&&i.sameState(r)){t[e].score<r.score&&(t[e]=r);return}}t.push(r)}class gT{constructor(t,e,i){this.source=t,this.flags=e,this.disabled=i}allows(t){return!this.disabled||this.disabled[t]==0}}class us extends Xp{constructor(t){if(super(),this.wrappers=[],t.version!=14)throw new RangeError(`Parser version (${t.version}) doesn't match runtime version (14)`);let e=t.nodeNames.split(" ");this.minRepeatTerm=e.length;for(let h=0;h<t.repeatNodeCount;h++)e.push("");let i=Object.keys(t.topRules).map(h=>t.topRules[h][1]),n=[];for(let h=0;h<e.length;h++)n.push([]);function o(h,f,c){n[h].push([f,f.deserialize(String(c))])}if(t.nodeProps)for(let h of t.nodeProps){let f=h[0];typeof f=="string"&&(f=ht[f]);for(let c=1;c<h.length;){let d=h[c++];if(d>=0)o(d,f,h[c++]);else{let g=h[c+-d];for(let m=-d;m>0;m--)o(h[c++],f,g);c++}}}this.nodeSet=new Uh(e.map((h,f)=>fe.define({name:f>=this.minRepeatTerm?void 0:h,id:f,props:n[f],top:i.indexOf(f)>-1,error:f==0,skipped:t.skippedNodes&&t.skippedNodes.indexOf(f)>-1}))),t.propSources&&(this.nodeSet=this.nodeSet.extend(...t.propSources)),this.strict=!1,this.bufferLength=qp;let l=Xr(t.tokenData);this.context=t.context,this.specializerSpecs=t.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let h=0;h<this.specializerSpecs.length;h++)this.specialized[h]=this.specializerSpecs[h].term;this.specializers=this.specializerSpecs.map(Ep),this.states=Xr(t.states,Uint32Array),this.data=Xr(t.stateData),this.goto=Xr(t.goto),this.maxTerm=t.maxTerm,this.tokenizers=t.tokenizers.map(h=>typeof h=="number"?new er(l,h):h),this.topRules=t.topRules,this.dialects=t.dialects||{},this.dynamicPrecedences=t.dynamicPrecedences||null,this.tokenPrecTable=t.tokenPrec,this.termNames=t.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(t,e,i){let n=new pT(this,t,e,i);for(let o of this.wrappers)n=o(n,t,e,i);return n}getGoto(t,e,i=!1){let n=this.goto;if(e>=n[0])return-1;for(let o=n[e+1];;){let l=n[o++],h=l&1,f=n[o++];if(h&&i)return f;for(let c=o+(l>>1);o<c;o++)if(n[o]==t)return f;if(h)return-1}}hasAction(t,e){let i=this.data;for(let n=0;n<2;n++)for(let o=this.stateSlot(t,n?2:1),l;;o+=3){if((l=i[o])==65535)if(i[o+1]==1)l=i[o=$i(i,o+2)];else{if(i[o+1]==2)return $i(i,o+2);break}if(l==e||l==0)return $i(i,o+1)}return 0}stateSlot(t,e){return this.states[t*6+e]}stateFlag(t,e){return(this.stateSlot(t,0)&e)>0}validAction(t,e){return!!this.allActions(t,i=>i==e?!0:null)}allActions(t,e){let i=this.stateSlot(t,4),n=i?e(i):void 0;for(let o=this.stateSlot(t,1);n==null;o+=3){if(this.data[o]==65535)if(this.data[o+1]==1)o=$i(this.data,o+2);else break;n=e($i(this.data,o+1))}return n}nextStates(t){let e=[];for(let i=this.stateSlot(t,1);;i+=3){if(this.data[i]==65535)if(this.data[i+1]==1)i=$i(this.data,i+2);else break;if((this.data[i+2]&1)==0){let n=this.data[i+1];e.some((o,l)=>l&1&&o==n)||e.push(this.data[i],n)}}return e}configure(t){let e=Object.assign(Object.create(us.prototype),this);if(t.props&&(e.nodeSet=this.nodeSet.extend(...t.props)),t.top){let i=this.topRules[t.top];if(!i)throw new RangeError(`Invalid top rule name ${t.top}`);e.top=i}return t.tokenizers&&(e.tokenizers=this.tokenizers.map(i=>{let n=t.tokenizers.find(o=>o.from==i);return n?n.to:i})),t.specializers&&(e.specializers=this.specializers.slice(),e.specializerSpecs=this.specializerSpecs.map((i,n)=>{let o=t.specializers.find(h=>h.from==i.external);if(!o)return i;let l=Object.assign(Object.assign({},i),{external:o.to});return e.specializers[n]=Ep(l),l})),t.contextTracker&&(e.context=t.contextTracker),t.dialect&&(e.dialect=this.parseDialect(t.dialect)),t.strict!=null&&(e.strict=t.strict),t.wrap&&(e.wrappers=e.wrappers.concat(t.wrap)),t.bufferLength!=null&&(e.bufferLength=t.bufferLength),e}hasWrappers(){return this.wrappers.length>0}getName(t){return this.termNames?this.termNames[t]:String(t<=this.maxNode&&this.nodeSet.types[t].name||t)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(t){let e=this.dynamicPrecedences;return e==null?0:e[t]||0}parseDialect(t){let e=Object.keys(this.dialects),i=e.map(()=>!1);if(t)for(let o of t.split(" ")){let l=e.indexOf(o);l>=0&&(i[l]=!0)}let n=null;for(let o=0;o<e.length;o++)if(!i[o])for(let l=this.dialects[e[o]],h;(h=this.data[l++])!=65535;)(n||(n=new Uint8Array(this.maxTerm+1)))[h]=1;return new gT(t,i,n)}static deserialize(t){return new us(t)}}function $i(r,t){return r[t]|r[t+1]<<16}function mT(r){let t=null;for(let e of r){let i=e.p.stoppedAt;(e.pos==e.p.stream.end||i!=null&&e.pos>i)&&e.p.parser.stateFlag(e.state,2)&&(!t||t.score<e.score)&&(t=e)}return t}function Ep(r){if(r.external){let t=r.extend?1:0;return(e,i)=>r.external(e,i)<<1|t}return r.get}const yT=cf({TemplateString:I.special(I.string),BooleanLiteral:I.bool,null:I.null,VariableName:I.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":I.function(I.variableName),PropertyName:I.propertyName,"CallExpression/MemberExpression/PropertyName":I.function(I.propertyName),PropertyDefinition:I.definition(I.propertyName),Number:I.number,String:I.string,Escape:I.escape,ArithOp:I.arithmeticOperator,LogicOp:I.logicOperator,"and or":I.logicOperator,CallbackReference:I.self,CompareOp:I.compareOperator,":":I.punctuation,"( )":I.paren,"[ ]":I.squareBracket,"{ }":I.brace,"InterpolationStart InterpolationEnd":I.brace,".":I.derefOperator,", ;":I.separator}),wT={__proto__:null,true:20,false:20,null:22,and:86,or:88},Hm=us.deserialize({version:14,states:"1|QVQPOOO!QOQO'#C_O!]OSO'#C_O!hOpO'#C`OOQO'#Ce'#CeO!sQPO'#CjO#`QWO'#CnOVQPO'#CrOVQPO'#CwO$nQPO'#DrOOQO'#Ds'#DsO%nQPO'#DsOOQO'#Dr'#DrO'kQPO'#DqOOQO'#Dq'#DqOOQO'#Df'#DfQVQPOOOOOO'#Dg'#DgO(lOQO,58yOOQO,58y,58yOOOO'#Dh'#DhO(wOSO,58yO)SQPO'#CbOOOO'#Di'#DiO)ZOpO,58zOOQO,58z,58zO)fQPO'#DjO)pQPO'#D}O)xQPO'#D}O*SQPO,59UOOQO'#Cp'#CpOOQO'#EP'#EPOVQPO'#EPO*XQWO'#CoO*dQWO'#EOO*lQWO,59YO+xQPO,59^O,{QPO,59cO-QQPO'#C|O-XQWO'#C}O-^QPO'#DOOOQO,59d,59dOVQPO,59kOVQPO,59kOVQPO,59kOVQPO,59kOVQPO,59kOOQO'#D]'#D]OVQPO,59vOOQO,59y,59yOOQO,59z,59zOOQO,59{,59{OVQPO'#DmO-eQPO,59|OVQPO,59kOVQPO,59kOVQPO,5:OOOQO,5:],5:]OOQO-E7d-E7dOOOO-E7e-E7eOOQO1G.e1G.eOOOO-E7f-E7fOOOO,58|,58|O.rQPO,58|OOOO-E7g-E7gOOQO1G.f1G.fO.wQPO,5:UOOQO-E7h-E7hO/RQPO,5:iOOQO1G.p1G.pO/ZQPO,5:kO/`QPO,59ZO0ZQWO'#DkO0eQWO,5:jOOQO1G.t1G.tOOQO1G.}1G.}O0mQPO'#ERO0wQPO,59hOOQO'#C{'#C{O2WQPO,59iOOQO,59j,59jO3WQPO,59jO5VQPO1G/VO5gQPO1G/VO7wQPO1G/VO8RQPO1G/VO:`QPO1G/VO:gQPO1G/bO:nQPO,5:XOOQO-E7k-E7kO=qQPO1G/VO=xQPO1G/VO>PQPO1G/jOOOO1G.h1G.hOOQO1G0V1G0VO@XQ`O1G.uOOQO,5:V,5:VOOQO-E7i-E7iO@cQPO'#DlO@mQPO,5:mOOQO1G/S1G/SOOQO1G/P1G/POOQO1G/U1G/UOVQPO7+$|OOQO7+%U7+%UO@uQ`O,59^OAPQPO,5:WOOQO-E7j-E7jOAZQPO<<HhOB^Q`O,59iOCfQ`O1G/VOCvQ`O1G/VOE_Q`O1G/VOEiQ`O1G/VOF}Q`O1G/VOH`Q`O1G/VOHgQ`O1G/VOHnQ`O<<HhO/`QPO'#CrO-XQWO'#C}O/`QPO,59kO/`QPO,59kO/`QPO,59kO/`QPO,59kO/`QPO,59kO/`QPO,59kO/`QPO,59kO/`QPO7+$|OHxQPO1G/bOVQPO,59v",stateData:"IV~O!dOS~OQYOWYOYYOZYO]TOaUOgVOhVOjWO!hPO!kQO!mRO!pSO~O!hcO!iaO!jcO~O!jcO!kcO!ldO~OVfO!ngO!oiO~O_jO[!qP~PVOQoO]pO!hPO!kQO!tnO~O`!rP~P!}O]xOg!ROh{OjvOnwOtzOuzOvzOwzOx|Oy|Oz}O{!WO|!XO}!OO!mRO!v!PO~O_!UOQ!fXW!fXY!fXZ!fXa!fX!V!fX!b!fX!h!fX!k!fX!p!fXi!fXT!fX[!fX~P#gO!X!YOQ!gXW!gXY!gXZ!gX]!gX_!gXa!gXg!gXh!gXj!gXn!gXt!gXu!gXv!gXw!gXx!gXy!gXz!gX{!gX|!gX}!gX!V!gX!b!gX!h!gX!k!gX!m!gX!p!gX!v!gX~O!V!ZOQ!eXW!eXY!eXZ!eX]!eXa!eXg!eXh!eXj!eX!b!eX!h!eX!k!eX!m!eX!p!eX~O!h!^O!iaO!j!^O~O!j!^O!k!^O!ldO~OT!`O~PVOVfO!ngO!o!cO~O[!^X_!^X~PVO_jO[!qX~O_jO[!qX~P#gO[!gO~Oe!iO_cX`cX~O_!jO`!rX~O`!lO~O]xOjvO!mRO_fagfahfatfaufavfawfaxfayfazfa{fa|fa}fa!vfa~OnwOQfaWfaYfaZfaafa!Vfa!bfa!hfa!kfa!pfa[faifaTfa!Qfa~P*qOi!mO~Oi!uP~PVO!t!pO~O[!rO~PVO_!UOQ!UaW!UaY!UaZ!Ua]!Uaa!Uag!Uah!Uaj!Ua!V!Ua!b!Ua!h!Ua!k!Ua!m!Ua!p!Uai!UaT!Ua[!Ua~OT#PO~O[!^a_!^a~P#gO_jO[!qa~O[#QO~OQYOWYOYYOZYO]TOaUOg#jOh#jOjWO!hPO!kQO!mRO!pSO~O_!_X`!_X~P!}O_!jO`!ra~O_#UOi!uX~P#gOi#WO~OjvO]qa_qagqahqanqatqauqavqawqaxqayqazqa{qa|qa}qa!mqa!vqa~OQqaWqaYqaZqaaqa!Vqa!bqa!hqa!kqa!pqa[qaiqaTqa!Qqa~P0|O[#YO~O]xOg!ROjvOnwO!mROQsiWsiYsiZsi_siasihsixsiysizsi{si|si}si!Vsi!bsi!hsi!ksi!psi!vsi[siisiTsi!Qsi~Otsiusivsiwsi~P3]OtzOuzOvzOwzO~P3]O]xOg!ROh{OjvOnwOtzOuzOvzOwzO!mROQsiWsiYsiZsi_siasizsi{si|si}si!Vsi!bsi!hsi!ksi!psi!vsi[siisiTsi!Qsi~Oxsiysi~P5wOx|Oy|O~P5wO]xOg!ROh{OjvOnwOtzOuzOvzOwzOx|Oy|Oz}O{!WO!mROQsiWsiYsiZsi_siasi}si!Vsi!bsi!hsi!ksi!psi!vsi[siisiTsi!Qsi~O|!XO~P8]O!Q#ZO~P#gOQ!aaW!aaY!aaZ!aa_!aaa!aa!V!aa!b!aa!h!aa!k!aa!p!aai!aaT!aa[!aa~P#gO]xOg!ROh{OjvOnwOtzOuzOvzOwzOx|Oy|Oz}O!mROQsiWsiYsiZsi_siasi|si}si!Vsi!bsi!hsi!ksi!psi!vsi[siisiTsi!Qsi~O{si~P;nO|si~P8]O!V#[OQ!WiW!WiY!WiZ!Wi]!Wia!Wig!Wih!Wij!Wi!b!Wi!h!Wi!k!Wi!m!Wi!p!Wi~O]xOg!ROh#mOjvOn#kOt#lOu#lOv#lOw#lOx#nOy#nOz#oO{#qO|#rO}#pO!mRO!v!PO~O_ci`ci~P?QO_!`Xi!`X~PVO_#UOi!ua~On#kO`fa~P*qO_!`ai!`a~P#gOQ!OyW!OyY!OyZ!Oy_!Oya!Oy!V!Oy!b!Oy!h!Oy!k!Oy!p!Oy[!Oyi!OyT!Oy!Q!Oy~P#gO`qa~P0|O]xOg!ROjvOn#kO!mRO_si`sihsixsiysizsi{si|si}si!vsi~Otsiusivsiwsi~PBeOt#lOu#lOv#lOw#lO~PBeO]xOg!ROh#mOjvOn#kOt#lOu#lOv#lOw#lO!mRO_si`sizsi{si|si}si!vsi~Oxsiysi~PDWOx#nOy#nO~PDWO]xOg!ROh#mOjvOn#kOt#lOu#lOv#lOw#lOx#nOy#nOz#oO{#qO!mRO_si`si}si!vsi~O|#rO~PEsO]xOg!ROh#mOjvOn#kOt#lOu#lOv#lOw#lOx#nOy#nOz#oO!mRO_si`si|si}si!vsi~O{si~PGUO|si~PEsO_!Oy`!Oy~P?QO!Q#sO~P#gO!d!pQn!t~",goto:",s!vPPP!w#pP%SPP%WPPPP%}PPP%}&r#lP%}PPPP%}%}&xP'g'm&x&x%}PPPPPPPPPP%}(`P%}%}%}(oP(xP(|)S)Y)`)f)p)v)|PPP*S*W*kPPPPPPPPP,f,i,lP,p!dYOTVW`fjpvxz{|}!O!Q!U!W!X!Y!i#U#Z#j#l#m#n#o#p#q#r#s#uToU!j!dYOTVW`fjpvxz{|}!O!Q!U!W!X!Y!i#U#Z#j#l#m#n#o#p#q#r#s#u!X!TXlt!d!n!t!u!v!w!x!y!z!|!}#R#]#^#`#b#c#d#e#f#g#h#i#tTgRh!`YTVWfjpvxz{|}!O!Q!U!W!X!Y!i#U#Z#j#l#m#n#o#p#q#r#s#uTZO`!eYOTVW`fjpvxz{|}!O!Q!U!W!X!Y!i#U#Z#j#l#m#n#o#p#q#r#s#uQrUR#S!j!XyXlt!d!n!t!u!v!w!x!y!z!|!}#R#]#^#`#b#c#d#e#f#g#h#i#tQ!qwR#a#k!W!SXlt!d!n!t!u!v!w!x!y!z!|!}#R#]#^#`#b#c#d#e#f#g#h#i#tT#X!q#ab!QXl!d!n!y!z#^#`#tT#u#R#i_[OW`fpx!YT^O`Q`OR![`QbPR!]bQeQR!_eQhRR!bhQkTS!ek!fR!flQ!krR#T!kQ#V!nR#_#VQ!VXR!{!VT_O`S]O`QuWQ!afQ!hpQ!sxR#O!Y^XOW`fpx!YQlTQtVQ!djQ!nvQ!tzQ!u{Q!v|Q!w}Q!x!OQ!y!QQ!z!UQ!|!WQ!}!XQ#R!iQ#]#jQ#^#UQ#`#ZQ#b#lQ#c#mQ#d#nQ#e#oQ#f#pQ#g#qQ#h#rQ#i#sR#t#uRmTRsUTqU!jR!ov",nodeNames:" Standard Number String TemplateString InterpolationEnd Interpolation InterpolationStart CallbackReference VariableName BooleanLiteral null ] [ ArrayExpression , } { ObjectExpression Property PropertyDefinition : UnaryExpression LogicOp ArithOp ) ( ParenthesizedExpression MemberExpression MethodExpression . PropertyName ArgList PropertyAccess PropertyExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp CompareOp CompareOp CompareOp and or LogicOp ConditionalExpression LogicOp LogicOp PostfixExpression CallExpression TaggedTemplateExpression SequenceExpression ; AssignmentStatement =",maxTerm:84,nodeProps:[["group",1,"autoComplete",-18,2,3,4,8,9,10,11,14,18,22,27,28,35,46,49,50,51,52,"Expression"],["isolate",-3,3,4,6,""],["openedBy",5,"InterpolationStart",12,"[",16,"{",25,"("],["closedBy",7,"InterpolationEnd",13,"]",17,"}",26,")"]],propSources:[yT],skippedNodes:[0],repeatNodeCount:8,tokenData:"Gy!`R!ZOX$tXY&qYZ)gZ[&q[p$tpq&qqr*ars+{st,ctu-Uuv.rvw$twx/exy/{yz0nz{1a{|2S|}2u}!O2S!O!P3h!P!Q8e!Q![9W![!]:i!]!^;^!^!_<P!_!`=k!`!a>d!a!b?]!b!c$t!c!}-U!}#O@w#O#P$t#P#QAj#Q#RB]#R#S-U#S#TCO#T#o-U#o#pCq#p#q$t#q#rDd#r$f$t$f$g&q$g#BY-U#BY#BZEX#BZ$IS-U$IS$I_EX$I_$JT-U$JT$JUEX$JU$KV-U$KV$KWEX$KW&FU-U&FU&FVEX&FV;'S-U;'S;=`.l<%l?HT-U?HT?HUEX?HUO-U[${W!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$tW%jT!lWOY%eZw%ex;'S%e;'S;=`%y<%lO%eW%|P;=`<%l%eS&UT!iSOY&PZr&Ps;'S&P;'S;=`&e<%lO&PS&hP;=`<%l&P[&nP;=`<%l$t!`&zk!iS!lW!d!SOX$tXY&qYZ(oZ[&q[p$tpq&qqr$trs%esw$twx&Px$f$t$f$g&q$g#BY$t#BY#BZ&q#BZ$IS$t$IS$I_&q$I_$JT$t$JT$JU&q$JU$KV$t$KV$KW&q$KW&FU$t&FU&FV&q&FV;'S$t;'S;=`&k<%l?HT$t?HT?HU&q?HUO$t!S(tZ!d!SXY(oYZ(oZ[(opq(o$f$g(o#BY#BZ(o$IS$I_(o$JT$JU(o$KV$KW(o&FU&FV(o?HT?HU(o!`)nZ!j[!d!SXY(oYZ(oZ[(opq(o$f$g(o#BY#BZ(o$IS$I_(o$JT$JU(o$KV$KW(o&FU&FV(o?HT?HU(o!O*jYgr!iS!lWOY$tZr$trs%esw$twx&Px!_$t!_!`+Y!`;'S$t;'S;=`&k<%lO$t!O+cWzr!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$tn,ST!hf!lWOY%eZw%ex;'S%e;'S;=`%y<%lO%e^,lWWQ!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!`-ac!iS!lW!pr!t`OY$tZr$trs%est$ttu-Uuw$twx&Px!Q$t!Q![-U![!c$t!c!}-U!}#R$t#R#S-U#S#T$t#T#o-U#o$g$t$g;'S-U;'S;=`.l<%lO-U!`.oP;=`<%l-U!O.{Wur!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$tn/lT!kj!iSOY&PZr&Ps;'S&P;'S;=`&e<%lO&P!O0UWjr!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t^0wWiQ!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!O1jWvr!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!O2]Whr!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!`3OW_!S!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!`3qY!iS!lWnrOY$tZr$trs%esw$twx&Px!Q$t!Q![4a![;'S$t;'S;=`&k<%lO$tn4j`!iS!lWQbOY$tZr$trs%esw$twx&Px!Q$t!Q![4a![!g$t!g!h5l!h#R$t#R#S4a#S#X$t#X#Y5l#Y;'S$t;'S;=`&k<%lO$tn5s^!iS!lWOY$tZr$trs%esw$twx&Px{$t{|6o|}$t}!O6o!O!Q$t!Q![7f![;'S$t;'S;=`&k<%lO$tn6vY!iS!lWOY$tZr$trs%esw$twx&Px!Q$t!Q![7f![;'S$t;'S;=`&k<%lO$tn7o[!iS!lWQbOY$tZr$trs%esw$twx&Px!Q$t!Q![7f![#R$t#R#S7f#S;'S$t;'S;=`&k<%lO$t!O8nWtr!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$tn9ab!iS!lWQbOY$tZr$trs%esw$twx&Px!O$t!O!P4a!P!Q$t!Q![9W![!g$t!g!h5l!h#R$t#R#S9W#S#X$t#X#Y5l#Y;'S$t;'S;=`&k<%lO$tn:tWe`!QQ!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t^;gW!VQ!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!O<YYxr!iS!lWOY$tZr$trs%esw$twx&Px!_$t!_!`<x!`;'S$t;'S;=`&k<%lO$t!O=RWyr!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!O=tY!XQ!iS!lWOY$tZr$trs%esw$twx&Px!_$t!_!`+Y!`;'S$t;'S;=`&k<%lO$t!O>mYyr!iS!lWOY$tZr$trs%esw$twx&Px!_$t!_!`<x!`;'S$t;'S;=`&k<%lO$t!O?fY!vr!iS!lWOY$tZr$trs%esw$twx&Px!a$t!a!b@U!b;'S$t;'S;=`&k<%lO$t!O@_W}r!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!`AQW]!S!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t^AsW[Q!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!OBfWwr!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!OCXW!iS!lW!mrOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t^CzWaQ!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!`DoW`!QTQ!iS!lWOY$tZr$trs%esw$twx&Px;'S$t;'S;=`&k<%lO$t!`Efu!iS!lW!d!S!pr!t`OX$tXY&qYZ(oZ[&q[p$tpq&qqr$trs%est$ttu-Uuw$twx&Px!Q$t!Q![-U![!c$t!c!}-U!}#R$t#R#S-U#S#T$t#T#o-U#o$f$t$f$g&q$g#BY-U#BY#BZEX#BZ$IS-U$IS$I_EX$I_$JT-U$JT$JUEX$JU$KV-U$KV$KWEX$KW&FU-U&FU&FVEX&FV;'S-U;'S;=`.l<%l?HT-U?HT?HUEX?HUO-U",tokenizers:[1,2,3,4,5,new Fm("j~RQtuX#S#Td~[P#o#p_~dOV~~iO!o~~",25,76)],topRules:{Standard:[0,1]},specialized:[{term:78,get:r=>wT[r]||-1}],tokenPrec:1841}),vT=cf({Text:I.content,"ExpressionOpen ExpressionClose":I.special(I.brace)}),xT=us.deserialize({version:14,states:"!dOQOPOOOOOO'#C_'#C_OYOPO'#C^OOOO'#Cb'#CbOOOO'#Cc'#CcQQOPOOOOOO'#C`'#C`O_OPO,58xOOOO-E6a-E6aOOOO'#Ca'#CaOOOO1G.d1G.d",stateData:"i~OXPOYRO~OYUO~OZXO~OXZYZ~",goto:"mWPPX]adXgTSOTTQOTRVQRYVQTORWT",nodeNames:" Template Expression ExpressionOpen ExpressionInner ExpressionClose Text",maxTerm:11,nodeProps:[["closedBy",3,"ExpressionClose"],["openedBy",5,"ExpressionOpen"]],propSources:[vT],skippedNodes:[0],repeatNodeCount:1,tokenData:"!j~RVO#oh#o#p!S#p#qh#q#r!_#r;'Sh;'S;=`|<%lOh~mTY~O#oh#p#qh#r;'Sh;'S;=`|<%lOh~!PP;=`<%lh~!VP#o#p!Y~!_OX~~!bP#q#r!e~!jOZ~",tokenizers:[0],topRules:{Template:[0,1]},tokenPrec:20});let Eo=[];const zm=()=>(!Pn()||Eo.length>0||(Eo=HO()),Eo),ol=({text:r,className:t})=>r.replace(/`([^`]+)`/g,(e,i)=>{let n;return/^["'].*["']$/.test(i)?n="#6aab73":/^\d+$/.test(i)?n="#57a8f5":n="#CE8E6D",`<span class="${t}" style="color: ${n};">${Kr(i)}</span>`}),Kr=r=>r.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;").replaceAll(" ","&nbsp;");function wi(){var r=arguments[0];typeof r=="string"&&(r=document.createElement(r));var t=1,e=arguments[1];if(e&&typeof e=="object"&&e.nodeType==null&&!Array.isArray(e)){for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var n=e[i];typeof n=="string"?r.setAttribute(i,n):n!=null&&(r[i]=n)}t++}for(;t<arguments.length;t++)qm(r,arguments[t]);return r}function qm(r,t){if(typeof t=="string")r.appendChild(document.createTextNode(t));else if(t!=null)if(t.nodeType!=null)r.appendChild(t);else if(Array.isArray(t))for(var e=0;e<t.length;e++)qm(r,t[e]);else throw new RangeError("Unsupported child node: "+t)}class Dp{constructor(t,e,i){this.from=t,this.to=e,this.diagnostic=i}}class kn{constructor(t,e,i){this.diagnostics=t,this.panel=e,this.selected=i}static init(t,e,i){let n=i.facet(bi).markerFilter;n&&(t=n(t,i));let o=t.slice().sort((d,g)=>d.from-g.from||d.to-g.to),l=new sr,h=[],f=0;for(let d=0;;){let g=d==o.length?null:o[d];if(!g&&!h.length)break;let m,w;for(h.length?(m=f,w=h.reduce((S,C)=>Math.min(S,C.to),g&&g.from>m?g.from:1e8)):(m=g.from,w=g.to,h.push(g),d++);d<o.length;){let S=o[d];if(S.from==m&&(S.to>S.from||S.to==m))h.push(S),d++,w=Math.min(S.to,w);else{w=Math.min(S.from,w);break}}let b=IT(h);if(h.some(S=>S.from==S.to||S.from==S.to-1&&i.doc.lineAt(S.from).to==S.from))l.add(m,m,yt.widget({widget:new RT(b),diagnostics:h.slice()}));else{let S=h.reduce((C,P)=>P.markClass?C+" "+P.markClass:C,"");l.add(m,w,yt.mark({class:"cm-lintRange cm-lintRange-"+b+S,diagnostics:h.slice(),inclusiveEnd:h.some(C=>C.to>w)}))}f=w;for(let S=0;S<h.length;S++)h[S].to<=f&&h.splice(S--,1)}let c=l.finish();return new kn(c,e,dr(c))}}function dr(r,t=null,e=0){let i=null;return r.between(e,1e9,(n,o,{spec:l})=>{if(!(t&&l.diagnostics.indexOf(t)<0))if(!i)i=new Dp(n,o,t||l.diagnostics[0]);else{if(l.diagnostics.indexOf(i.diagnostic)<0)return!1;i=new Dp(i.from,o,i.diagnostic)}}),i}function bT(r,t){let e=t.pos,i=t.end||e,n=r.state.facet(bi).hideOn(r,e,i);if(n!=null)return n;let o=r.startState.doc.lineAt(t.pos);return!!(r.effects.some(l=>l.is(wf))||r.changes.touchesRange(o.from,Math.max(o.to,i)))}function OT(r,t){return r.field(ni,!1)?t:t.concat(ct.appendConfig.of(Km))}function ST(r,t){return{effects:OT(r,[wf.of(t)])}}const wf=ct.define(),Um=ct.define(),Qm=ct.define(),ni=be.define({create(){return new kn(yt.none,null,null)},update(r,t){if(t.docChanged&&r.diagnostics.size){let e=r.diagnostics.map(t.changes),i=null,n=r.panel;if(r.selected){let o=t.changes.mapPos(r.selected.from,1);i=dr(e,r.selected.diagnostic,o)||dr(e,null,o)}!e.size&&n&&t.state.facet(bi).autoPanel&&(n=null),r=new kn(e,n,i)}for(let e of t.effects)if(e.is(wf)){let i=t.state.facet(bi).autoPanel?e.value.length?ll.open:null:r.panel;r=kn.init(e.value,i,t.state)}else e.is(Um)?r=new kn(r.diagnostics,e.value?ll.open:null,r.selected):e.is(Qm)&&(r=new kn(r.diagnostics,r.panel,e.value));return r},provide:r=>[Lh.from(r,t=>t.panel),Z.decorations.from(r,t=>t.diagnostics)]}),kT=yt.mark({class:"cm-lintRange cm-lintRange-active"});function CT(r,t,e){let{diagnostics:i}=r.state.field(ni),n,o=-1,l=-1;i.between(t-(e<0?1:0),t+(e>0?1:0),(f,c,{spec:d})=>{if(t>=f&&t<=c&&(f==c||(t>f||e>0)&&(t<c||e<0)))return n=d.diagnostics,o=f,l=c,!1});let h=r.state.facet(bi).tooltipFilter;return n&&h&&(n=h(n,r.state)),n?{pos:o,end:l,above:r.state.doc.lineAt(o).to<l,create(){return{dom:AT(r,n)}}}:null}function AT(r,t){return wi("ul",{class:"cm-tooltip-lint"},t.map(e=>Xm(r,e,!1)))}const Ip=r=>{let t=r.state.field(ni,!1);return!t||!t.panel?!1:(r.dispatch({effects:Um.of(!1)}),!0)},TT=_e.fromClass(class{constructor(r){this.view=r,this.timeout=-1,this.set=!0;let{delay:t}=r.state.facet(bi);this.lintTime=Date.now()+t,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,t)}run(){clearTimeout(this.timeout);let r=Date.now();if(r<this.lintTime-10)this.timeout=setTimeout(this.run,this.lintTime-r);else{this.set=!1;let{state:t}=this.view,{sources:e}=t.facet(bi);e.length&&PT(e.map(i=>Promise.resolve(i(this.view))),i=>{this.view.state.doc==t.doc&&this.view.dispatch(ST(this.view.state,i.reduce((n,o)=>n.concat(o))))},i=>{ae(this.view.state,i)})}}update(r){let t=r.state.facet(bi);(r.docChanged||t!=r.startState.facet(bi)||t.needsRefresh&&t.needsRefresh(r))&&(this.lintTime=Date.now()+t.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,t.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}});function PT(r,t,e){let i=[],n=-1;for(let o of r)o.then(l=>{i.push(l),clearTimeout(n),i.length==r.length?t(i):n=setTimeout(()=>t(i),200)},e)}const bi=Y.define({combine(r){return Object.assign({sources:r.map(t=>t.source).filter(t=>t!=null)},fl(r.map(t=>t.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(t,e)=>t?e?i=>t(i)||e(i):t:e}))}});function MT(r,t={}){return[bi.of({source:r,config:t}),TT,Km]}function Ym(r){let t=[];if(r)t:for(let{name:e}of r){for(let i=0;i<e.length;i++){let n=e[i];if(/[a-zA-Z]/.test(n)&&!t.some(o=>o.toLowerCase()==n.toLowerCase())){t.push(n);continue t}}t.push("")}return t}function Xm(r,t,e){var i;let n=e?Ym(t.actions):[];return wi("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},wi("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage(r):t.message),(i=t.actions)===null||i===void 0?void 0:i.map((o,l)=>{let h=!1,f=m=>{if(m.preventDefault(),h)return;h=!0;let w=dr(r.state.field(ni).diagnostics,t);w&&o.apply(r,w.from,w.to)},{name:c}=o,d=n[l]?c.indexOf(n[l]):-1,g=d<0?c:[c.slice(0,d),wi("u",c.slice(d,d+1)),c.slice(d+1)];return wi("button",{type:"button",class:"cm-diagnosticAction",onclick:f,onmousedown:f,"aria-label":` Action: ${c}${d<0?"":` (access key "${n[l]})"`}.`},g)}),t.source&&wi("div",{class:"cm-diagnosticSource"},t.source))}class RT extends ps{constructor(t){super(),this.sev=t}eq(t){return t.sev==this.sev}toDOM(){return wi("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class Bp{constructor(t,e){this.diagnostic=e,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=Xm(t,e,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class ll{constructor(t){this.view=t,this.items=[];let e=n=>{if(n.keyCode==27)Ip(this.view),this.view.focus();else if(n.keyCode==38||n.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(n.keyCode==40||n.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(n.keyCode==36)this.moveSelection(0);else if(n.keyCode==35)this.moveSelection(this.items.length-1);else if(n.keyCode==13)this.view.focus();else if(n.keyCode>=65&&n.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:o}=this.items[this.selectedIndex],l=Ym(o.actions);for(let h=0;h<l.length;h++)if(l[h].toUpperCase().charCodeAt(0)==n.keyCode){let f=dr(this.view.state.field(ni).diagnostics,o);f&&o.actions[h].apply(t,f.from,f.to)}}else return;n.preventDefault()},i=n=>{for(let o=0;o<this.items.length;o++)this.items[o].dom.contains(n.target)&&this.moveSelection(o)};this.list=wi("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:e,onclick:i}),this.dom=wi("div",{class:"cm-panel-lint"},this.list,wi("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Ip(this.view)},"")),this.update()}get selectedIndex(){let t=this.view.state.field(ni).selected;if(!t)return-1;for(let e=0;e<this.items.length;e++)if(this.items[e].diagnostic==t.diagnostic)return e;return-1}update(){let{diagnostics:t,selected:e}=this.view.state.field(ni),i=0,n=!1,o=null,l=new Set;for(t.between(0,this.view.state.doc.length,(h,f,{spec:c})=>{for(let d of c.diagnostics){if(l.has(d))continue;l.add(d);let g=-1,m;for(let w=i;w<this.items.length;w++)if(this.items[w].diagnostic==d){g=w;break}g<0?(m=new Bp(this.view,d),this.items.splice(i,0,m),n=!0):(m=this.items[g],g>i&&(this.items.splice(i,g-i),n=!0)),e&&m.diagnostic==e.diagnostic?m.dom.hasAttribute("aria-selected")||(m.dom.setAttribute("aria-selected","true"),o=m):m.dom.hasAttribute("aria-selected")&&m.dom.removeAttribute("aria-selected"),i++}});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)n=!0,this.items.pop();this.items.length==0&&(this.items.push(new Bp(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),n=!0),o?(this.list.setAttribute("aria-activedescendant",o.id),this.view.requestMeasure({key:this,read:()=>({sel:o.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:h,panel:f})=>{let c=f.height/this.list.offsetHeight;h.top<f.top?this.list.scrollTop-=(f.top-h.top)/c:h.bottom>f.bottom&&(this.list.scrollTop+=(h.bottom-f.bottom)/c)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),n&&this.sync()}sync(){let t=this.list.firstChild;function e(){let i=t;t=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;t!=i.dom;)e();t=i.dom.nextSibling}else this.list.insertBefore(i.dom,t);for(;t;)e()}moveSelection(t){if(this.selectedIndex<0)return;let e=this.view.state.field(ni),i=dr(e.diagnostics,this.items[t].diagnostic);i&&this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:Qm.of(i)})}static open(t){return new ll(t)}}function _T(r,t='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(r)}</svg>')`}function Do(r){return _T(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${r}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const ET=Z.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Do("#d11")},".cm-lintRange-warning":{backgroundImage:Do("orange")},".cm-lintRange-info":{backgroundImage:Do("#999")},".cm-lintRange-hint":{backgroundImage:Do("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function DT(r){return r=="error"?4:r=="warning"?3:r=="info"?2:1}function IT(r){let t="hint",e=1;for(let i of r){let n=DT(i.severity);n>e&&(e=n,t=i.severity)}return t}const Km=[ni,Z.decorations.compute([ni],r=>{let{selected:t,panel:e}=r.field(ni);return!t||!e||t.from==t.to?yt.none:yt.set([kT.range(t.from,t.to)])}),fm(CT,{hideOn:bT}),ET],BT={linter:MT},LT=r=>{try{const t=r.split(" at ");if(t.length<=1)return null;const i=t.pop().replace("(","").replace(")",""),[n,o]=i.split(", ");return o?[parseInt(n),parseInt(o)]:parseInt(n)}catch{return null}},NT=(r,t)=>{try{if(!Pn())return[];const e=ie(r).with("standard",()=>qO(t)).with("unary",()=>UO(t)).otherwise(()=>null);if(!e)return[];const i=ie(LT(e.source)).with(Wt.number,o=>({from:o,to:o})).with([Wt.number,Wt.number],([o,l])=>({from:o,to:l})).otherwise(()=>({from:0,to:t.length})),n=ie(e.type).with("parserError",()=>"Parser error").with("lexerError",()=>"Lexer error").with("compilerError",()=>"Compiler error").with("vmError",()=>"VM error").otherwise(o=>o);return[{from:i.from,to:i.to,message:e.source,source:n,severity:"error"}]}catch(e){return[{from:0,to:t.length,message:String(e),severity:"error"}]}},$T=r=>Pn()?BT.linter(t=>{t.dom.setAttribute("data-severity","none");const e=t.state.field(ir),i=t.state.doc.toString(),n=Gm({source:i,expressionType:r,strict:e.strict,types:e.types,expectedVariableType:e.expectedVariableType});return n.some(o=>o.severity==="error")?t.dom.setAttribute("data-severity","error"):n.some(o=>o.severity==="warning")?t.dom.setAttribute("data-severity","warning"):n.some(o=>o.severity==="info")?t.dom.setAttribute("data-severity","info"):n.some(o=>o.severity==="hint")&&t.dom.setAttribute("data-severity","hint"),n},{needsRefresh:t=>t.transactions.some(e=>e.effects.some(i=>i.is(bf)||i.is(al)||i.is(hl)||i.is(Of)))}):[],Gm=({source:r,expressionType:t="standard",strict:e=!1,types:i,expectedVariableType:n})=>{if(r.trim().length===0)return[];const o=r?NT(t,r):[],l=i.filter(f=>!!f.error).map(f=>ih({from:f.span[0],to:f.span[1],severity:ie(f.error).with(Wt.string.startsWith("Hint:"),()=>"hint").with(Wt.string.startsWith("Info:"),()=>"info").otherwise(()=>"warning"),message:f.error,source:"Type check"})),h=[...o,...l];if(t==="unary"&&i.length>0){const f=i[0].kind;f!=="Bool"&&h.push(ih({from:0,to:r.length,severity:e?"error":"warning",message:`Expected unary expression to evaluate to type \`bool\`, received \`${nr(f)}\` instead.`,source:"Type check"}))}else if(n&&i.length>0){const f=i[0].kind,c=zO.fromJson(f);ie([e,f]).with([!0,"Any"],()=>!1).otherwise(()=>c.satisfies(n))||h.push(ih({from:0,to:r.length,severity:e?"error":"warning",message:`Expected expression to evaluate to type \`${nr(n.toJson())}\`, received \`${nr(f)}\` instead.`,source:"Type check"}))}return h},ih=r=>(r.renderMessage=t=>{const e=document.createElement("div");return e.innerHTML=ol({text:r.message,className:"cm-diagnosticMessageToken"}),e},r),Zm=(r,t,e,i)=>{const n=ie(t.type).with(Wt.union("function","method"),()=>{const o=`${t.label}()`;return r.state.update({changes:{from:e,to:i,insert:o},selection:{anchor:e+o.length-1}})}).otherwise(()=>r.state.update({changes:{from:e,to:i,insert:t.label},selection:{anchor:e+t.label.length}}));r.dispatch(n)},WT=()=>zm().map(r=>({...r,detail:r.detail.replaceAll("`",""),apply:Zm})),jm=r=>r?r?.type.prop(ht.group)?.includes("autoComplete")||!1||jm(r?.parent):!1,FT=()=>{const r=WT(),t=r.filter(i=>i.type&&["variable","function"].includes(i.type)),e=i=>r.filter(n=>n.type==="method"&&ie(n).with({methodFor:Wt._},({methodFor:o})=>o===i.kind).otherwise(()=>!1));return i=>{const n=xe(i.state),o=i.state.wordAt(i.pos),l=n.resolveInner(i.pos,-1);if(!jm(l)||!i.explicit&&i.pos===0||!i.explicit&&!o&&l.name!==".")return null;const h=o?.from??i.pos;switch(l.name){case"Standard":case"VariableName":case"[":{const f=i.state.field(ir);return{from:h,options:[...nh({type:"variable",kind:f.rootKind}),...t],validFor:/\w*/}}case"String":{const f=i.state.field(ir),c=Lp(l),d=(f.types??[]).find(g=>g.span[0]===c?.[0]&&g.span[1]===c[1]);return d?{from:l.from+1,options:nh({kind:d.kind}),validFor:/\w*/}:null}case".":case"PropertyName":{const f=i.state.field(ir),c=Lp(l),d=(f.types??[]).find(g=>g.span[0]===c?.[0]&&g.span[1]===c[1]);return d?{from:h,options:[...nh({kind:d.kind}),...e(d)],validFor:/\w*/}:null}default:return null}}},Lp=r=>{let t=r;["PropertyExpression","PropertyAccess"].includes(t.parent?.name??"")&&t.parent?.prevSibling&&(t=t.parent.prevSibling);let e=t;for(;e.prevSibling;)e=e.prevSibling;return[e.from,t.to]},VT=r=>{let t=r;t.parent&&["PropertyExpression","PropertyAccess"].includes(t.parent.name)&&(t=t.parent);let e=t;for(;e.prevSibling;)e=e.prevSibling;return[e.from,t.to]},HT=()=>QA({override:[FT()]}),zT=()=>{const r=zm();return fm((t,e)=>{const i=t.state.wordAt(e);if(!i)return null;const n=t.state.doc.sliceString(i.from,i.to),o=r.find(g=>g.label===n);if(o)return{pos:i.from,end:i.to,above:!0,create(){const g=document.createElement("div");return g.classList.add("grl-ce-hover-tooltip"),g.style.whiteSpace="pre",g.innerHTML=ol({text:`<span style="font-size: 12px">${o.info}</span>
${o.label}: ${o.detail}
`,className:"cm-hoverTooltipMessageToken"}),{dom:g}}};const h=xe(t.state).resolveInner(e,-1),f=t.state.field(ir),c=VT(h),d=(f.types??[]).find(g=>g.span[0]===c?.[0]&&g.span[1]===c[1]);if(d&&c){const g=t.state.doc.toString();return{pos:c[0],end:c[1],above:!0,create(){const m=document.createElement("div");return m.classList.add("grl-ce-hover-tooltip"),m.style.whiteSpace="pre",m.innerHTML=ol({text:`${g.slice(c[0],c[1])}: \`${nr(d.kind)}\``,className:"cm-hoverTooltipMessageToken"}),{dom:m}}}}return null},{hoverTime:700,hideOnChange:!0})},vf=ys.define([{tag:[I.bracket,I.operator,I.variableName,I.propertyName,I.content,I.punctuation],color:"#080808"},{tag:[I.number,I.bool],color:"#015cc5"},{tag:[I.function(I.variableName),I.keyword,I.self,I.special(I.brace),I.logicOperator],color:"#6f42c1"},{tag:[I.string,I.meta,I.name,I.quote],color:"#077d16"},{tag:I.invalid,color:"#cb2431"}]),xf=ys.define([{tag:[I.bracket,I.operator,I.variableName,I.propertyName,I.content,I.punctuation],color:"#bdbec4"},{tag:[I.number,I.bool],color:"#57a8f5"},{tag:[I.function(I.variableName),I.keyword,I.self,I.special(I.brace),I.logicOperator],color:"#c87dbb"},{tag:[I.string,I.meta,I.name,I.quote],color:"#6aab73"},{tag:I.invalid,color:"#cb2431"}]),Np=new mm(as.define({parser:Hm,name:"zen",languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},wordChars:"$"}})),$p=new mm(as.define({parser:xT.configure({wrap:JO(r=>r.name==="ExpressionInner"?{parser:Hm}:null)}),name:"zenTemplate",languageData:{closeBrackets:{brackets:["(","[","'",'"',"{","`"]},wordChars:"$"}})),zh=({type:r,lint:t=!0,lazy:e=!1})=>e?[r!=="template"?Np:$p]:[r!=="template"?Np:$p,HT(),zT(),BA(),t&&$T(r),ir,ZA(),hf.of([...WA,...oT,{key:"Enter",run:Cp,shift:Cp}])].filter(i=>!!i),qT={types:[],rootKind:"Any",expressionType:"standard",strict:!1},al=ct.define(),bf=ct.define(),hl=ct.define(),Of=ct.define(),ir=be.define({create(){return qT},update(r,t){try{const e=t.effects.find(g=>g.is(bf)),i=ie(e).with({value:Wt.string},g=>g.value).otherwise(()=>r.expressionType),n=t.effects.find(g=>g.is(hl)),o=ie(n).with({value:Wt.nonNullable},({value:g})=>g).with({value:Wt.nullish},()=>{}).otherwise(()=>r.expectedVariableType),l=t.effects.find(g=>g.is(al)),h=ie(l).with({value:Wt._},g=>g.value).otherwise(()=>r.root||null),f=t.effects.find(g=>g.is(Of)),c=ie(f).with({value:Wt.boolean},({value:g})=>g).otherwise(()=>r.strict);if(!h)return{...r,expressionType:i,expectedVariableType:o,strict:c};if(!t.docChanged&&!e&&!l)return{...r,expressionType:i,expectedVariableType:o,strict:c};const d=t.newDoc.toString();return{source:d,expressionType:i,expectedVariableType:o,strict:c,root:h,rootKind:h.toJson(),types:ie(i).with("unary",()=>h.typeCheckUnary(d)).otherwise(()=>h.typeCheck(d))}}catch{return r}},compare(r,t){return r.source===t.source&&r.expressionType===t.expressionType&&r.root===t.root&&r.expectedVariableType===t.expectedVariableType&&r.strict===t.strict}}),nh=({kind:r,type:t="property"})=>ie(r).with({Object:Wt._},e=>Object.entries(e.Object).map(([i,n])=>({label:i,type:t,boost:50,detail:nr(n),apply:Zm}))).otherwise(()=>[]),nr=r=>ie(r).with(Wt.string,t=>t.toLowerCase()).with({Object:Wt._},()=>"object").with({Array:Wt._},t=>`${nr(t.Array)}[]`).with({Const:Wt.string},t=>`"${t.Const}"`).with({Enum:Wt.array(Wt.string)},t=>t.Enum.map(e=>`"${e}"`).join(" | ")).otherwise(()=>"unknown"),UT=vm(xf),QT=vm(vf),Wp=(r=!1)=>r?UT:QT,Fp=(r,t)=>Z.updateListener.of(e=>{t?.(e.state),e.docChanged&&r?.(e.state.doc.toString())}),Jm=qh.forwardRef(({noStyle:r=!1,fullHeight:t=!1,strict:e=!1,maxRows:i,disabled:n,value:o,onChange:l,placeholder:h,className:f,onStateChange:c,type:d="standard",extension:g,variableType:m,expectedVariableType:w,lint:b=!0,initialSelection:S,style:C={},...P},B)=>{const L=at.useRef(null),_=at.useRef(null),{token:$}=zp.useToken(),W=at.useMemo(()=>({zenExtension:new gi,theme:new gi,placeholder:new gi,readOnly:new gi,updateListener:new gi,userProvided:new gi}),[]);return at.useEffect(()=>{if(!L.current||_.current)return;let F=!1;queueMicrotask(()=>{F=!0});const J=bt=>Cm.clamp(bt,0,o?.length??0),rt=new Z({parent:L.current,state:mt.create({doc:o,selection:S?{head:S.head?J(S.head):void 0,anchor:J(S.anchor)}:void 0,extensions:[Z.lineWrapping,JC(),W.zenExtension.of(zh({type:d,lint:b})),W.updateListener.of(Fp(l,c)),W.theme.of(Wp($.mode==="dark")),W.placeholder.of(h?Jd(h):[]),W.readOnly.of(Z.editable.of(!n)),W.userProvided.of(g?.({type:d})??[])]})});return S&&rt.focus(),_.current=rt,L.current&&(L.current.codeMirror=rt),()=>{F&&(rt.destroy(),_.current=null)}},[]),at.useEffect(()=>{if(!_.current||o===void 0)return;const F=_.current;if(F.state.doc.eq(pt.of(o.split(`
`))))return;const J=F.state.selection.main.head,rt=o.length;F.dispatch({changes:{from:0,to:F.state.doc.length,insert:o},...J>rt&&{selection:{anchor:rt}}})},[o]),at.useEffect(()=>{_.current&&_.current.dispatch({effects:W.theme.reconfigure(Wp($.mode==="dark"))})},[$.mode]),at.useEffect(()=>{_.current&&_.current.dispatch({effects:W.placeholder.reconfigure(h?Jd(h):[])})},[h]),at.useEffect(()=>{_.current&&_.current.dispatch({effects:W.readOnly.reconfigure(Z.editable.of(!n))})},[n]),at.useEffect(()=>{_.current&&_.current.dispatch({effects:W.updateListener.reconfigure(Fp(l,c))})},[l,c]),at.useEffect(()=>{_.current&&_.current.dispatch({effects:[W.zenExtension.reconfigure(zh({type:d,lint:b})),bf.of(ie(d).with("unary",()=>"unary").otherwise(()=>"standard"))]})},[d,b]),at.useEffect(()=>{_.current&&_.current.dispatch({effects:W.userProvided.reconfigure(g?.({type:d})??[])})},[g,d]),at.useEffect(()=>{if(!(!_.current||!Pn())){if(m==null){_.current.dispatch({effects:al.of(null)});return}_.current.dispatch({effects:al.of(Ho(m))})}},[m]),at.useEffect(()=>{if(!(!_.current||!Pn())){if(w==null){_.current.dispatch({effects:hl.of(null)});return}_.current.dispatch({effects:hl.of(Ho(w))})}},[w]),at.useEffect(()=>{_.current&&_.current.dispatch({effects:Of.of(e)})},[e]),Bt.jsx("div",{ref:Sm(L,B),className:Qr("grl-ce",i&&!t&&"max-rows",t&&"full-height",r&&"no-style",f),style:{"--editorMaxRows":i,...C},"data-type":d,...P})});Jm.__docgenInfo={description:"",methods:[],displayName:"CodeEditorBase",props:{maxRows:{required:!1,tsType:{name:"number"},description:""},value:{required:!1,tsType:{name:"string"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},onStateChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(state: EditorState) => void",signature:{arguments:[{type:{name:"EditorState"},name:"state"}],return:{name:"void"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},type:{required:!1,tsType:{name:"union",raw:"'unary' | 'standard' | 'template'",elements:[{name:"literal",value:"'unary'"},{name:"literal",value:"'standard'"},{name:"literal",value:"'template'"}]},description:"",defaultValue:{value:"'standard'",computed:!1}},lint:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},strict:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},fullHeight:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},noStyle:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},extension:{required:!1,tsType:{name:"signature",type:"function",raw:"(params: ExtensionParams) => Extension",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  type?: 'standard' | 'unary' | 'template';
}`,signature:{properties:[{key:"type",value:{name:"union",raw:"'standard' | 'unary' | 'template'",elements:[{name:"literal",value:"'standard'"},{name:"literal",value:"'unary'"},{name:"literal",value:"'template'"}],required:!1}}]}},name:"params"}],return:{name:"Extension"}}},description:""},livePreview:{required:!1,tsType:{name:"signature",type:"object",raw:"{ input: unknown; fromSimulation: boolean; result?: unknown }",signature:{properties:[{key:"input",value:{name:"unknown",required:!0}},{key:"fromSimulation",value:{name:"boolean",required:!0}},{key:"result",value:{name:"unknown",required:!1}}]}},description:""},variableType:{required:!1,tsType:{name:"any"},description:""},expectedVariableType:{required:!1,tsType:{name:"any"},description:""},lazy:{required:!1,tsType:{name:"boolean"},description:""},initialSelection:{required:!1,tsType:{name:"signature",type:"object",raw:"{ anchor: number; head?: number }",signature:{properties:[{key:"anchor",value:{name:"number",required:!0}},{key:"head",value:{name:"number",required:!1}}]}},description:""},style:{defaultValue:{value:"{}",computed:!1},required:!1}}};const YT="zen-highlight-styles",XT=r=>{const t=r==="dark"?xf:vf,e=`${YT}-${r}`;if(!(typeof document>"u"||document.getElementById(e))&&t.module){const i=document.createElement("style");i.id=e,i.textContent=t.module.getRules(),document.head.appendChild(i)}},KT=({code:r,theme:t="light",type:e="standard",placeholder:i})=>{if(!r.trim())return`<span class="cm-line">${i?`<span class="cm-placeholder">${i}</span>`:"<br />"}</span>`;try{const n=t==="dark"?xf:vf,o=mt.create({doc:r,extensions:[zh({type:e,lazy:!0})]}),l=xe(o);if(!l||l.length===0)return Kr(r);let h='<span class="cm-line"><span class="cm-lintRange">';return AC(r,l,n,(f,c)=>{c?h+=`<span class="${c}">${Kr(f)}</span>`:h+=Kr(f)},()=>{h+=`
</span></span><span class="cm-line"><span class="cm-lintRange">`}),h+="</span></span>",h}catch(n){return console.warn("Syntax highlighting failed:",n),Kr(r)}},t0=qh.forwardRef(({noStyle:r=!1,fullHeight:t=!1,strict:e=!1,maxRows:i,value:n,className:o,type:l="standard",variableType:h,expectedVariableType:f,lint:c=!0,placeholder:d,extension:g,initialSelection:m,onStateChange:w,disabled:b,onChange:S,style:C={},...P},B)=>{const{token:L}=zp.useToken(),[_,$]=at.useState(null),[W,F]=at.useState(null),[,J]=at.useTransition();at.useEffect(()=>{XT(L.mode)},[L.mode]),at.useEffect(()=>{W?.length||$(null)},[W]);const rt=at.useMemo(()=>KT({code:n??"",type:l,theme:L.mode,placeholder:d}),[n,l,L.mode,d]);at.useEffect(()=>{if(!n||!n.trim()||!c||!Pn()){F(null);return}J(()=>{const et=ie([l,h]).with(["unary",Wt.nonNullable],()=>Ho(h).typeCheckUnary(n)).with(["standard",Wt.nonNullable],()=>Ho(h).typeCheck(n)).otherwise(()=>[]);F(Gm({source:n,expectedVariableType:f,expressionType:l,strict:e,types:et}))})},[n,c,h,f,l,e]);const bt=at.useMemo(()=>{if(W){if(W.some(et=>et.severity==="error"))return"error";if(W.some(et=>et.severity==="warning"))return"warning";if(W.some(et=>et.severity==="info"))return"info";if(W.some(et=>et.severity==="hint"))return"hint"}},[W]),lt=at.useCallback(et=>{if(!W?.length)return;const Dt=et.currentTarget.getBoundingClientRect();$({x:Dt.left,y:Dt.bottom,diagnostics:W})},[W]),j=at.useCallback(()=>{$(null)},[]);return Bt.jsx("div",{ref:B,tabIndex:0,className:Qr("grl-ce","grl-ce-highlighter",r&&"no-style",i&&!t&&"max-rows",t&&"full-height",o),style:{"--editorMaxRows":i,...C},...P,children:Bt.jsxs("div",{className:Qr("cm-editor"),"data-severity":bt,children:[Bt.jsx("div",{className:Qr("cm-scroller"),children:Bt.jsx("div",{className:Qr("cm-content","cm-lineWrapping"),onMouseEnter:lt,onMouseLeave:j,dangerouslySetInnerHTML:{__html:rt}})}),_&&Bt.jsx("div",{className:"cm-tooltip-hover cm-tooltip cm-tooltip-below",style:{position:"fixed",top:`${_.y}px`,left:`${_.x}px`},children:Bt.jsx("ul",{className:"cm-tooltip-lint cm-tooltip-section",children:_.diagnostics.map((et,vt)=>Bt.jsxs("li",{className:`cm-diagnostic cm-diagnostic-${et.severity}`,children:[Bt.jsx("span",{className:"cm-diagnosticText",children:Bt.jsx("div",{dangerouslySetInnerHTML:{__html:ol({text:et.message,className:"cm-diagnosticMessageToken"})}})}),et.source&&Bt.jsx("div",{className:"cm-diagnosticSource",children:et.source})]},vt))})})]})})});t0.__docgenInfo={description:"",methods:[],displayName:"CodeHighlighter",props:{maxRows:{required:!1,tsType:{name:"number"},description:""},value:{required:!1,tsType:{name:"string"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},onStateChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(state: EditorState) => void",signature:{arguments:[{type:{name:"EditorState"},name:"state"}],return:{name:"void"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},type:{required:!1,tsType:{name:"union",raw:"'unary' | 'standard' | 'template'",elements:[{name:"literal",value:"'unary'"},{name:"literal",value:"'standard'"},{name:"literal",value:"'template'"}]},description:"",defaultValue:{value:"'standard'",computed:!1}},lint:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},strict:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},fullHeight:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},noStyle:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},extension:{required:!1,tsType:{name:"signature",type:"function",raw:"(params: ExtensionParams) => Extension",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  type?: 'standard' | 'unary' | 'template';
}`,signature:{properties:[{key:"type",value:{name:"union",raw:"'standard' | 'unary' | 'template'",elements:[{name:"literal",value:"'standard'"},{name:"literal",value:"'unary'"},{name:"literal",value:"'template'"}],required:!1}}]}},name:"params"}],return:{name:"Extension"}}},description:""},livePreview:{required:!1,tsType:{name:"signature",type:"object",raw:"{ input: unknown; fromSimulation: boolean; result?: unknown }",signature:{properties:[{key:"input",value:{name:"unknown",required:!0}},{key:"fromSimulation",value:{name:"boolean",required:!0}},{key:"result",value:{name:"unknown",required:!1}}]}},description:""},variableType:{required:!1,tsType:{name:"any"},description:""},expectedVariableType:{required:!1,tsType:{name:"any"},description:""},lazy:{required:!1,tsType:{name:"boolean"},description:""},initialSelection:{required:!1,tsType:{name:"signature",type:"object",raw:"{ anchor: number; head?: number }",signature:{properties:[{key:"anchor",value:{name:"number",required:!0}},{key:"head",value:{name:"number",required:!1}}]}},description:""},style:{defaultValue:{value:"{}",computed:!1},required:!1}}};const GT=(r,t)=>{const e=document.getSelection();if(e&&e.rangeCount>0){const o=e.getRangeAt(0),l=document.createRange();l.selectNodeContents(t),l.setEnd(o.startContainer,o.startOffset);const h=document.createRange();return h.selectNodeContents(t),h.setEnd(o.endContainer,o.endOffset),{anchor:l.toString().length,head:h.toString().length}}const i=document.caretPositionFromPoint(r.clientX,r.clientY);if(!i)return null;const n=document.createRange();return n.selectNodeContents(t),n.setEnd(i.offsetNode,i.offset),{anchor:n.toString().length}},e0=qh.forwardRef(({lazy:r=!1,value:t="",type:e="standard",disabled:i,onBlur:n,...o},l)=>{const[h,f]=at.useState(()=>r?{type:"lazy"}:{type:"edit"}),c=at.useRef(null),d=at.useRef(!1),g=at.useCallback(()=>{d.current=!0},[]),m=at.useCallback(()=>{d.current=!1},[]),w=at.useCallback(C=>{if(i||h.type!=="lazy")return;const P=c.current?GT(C,c.current)??void 0:void 0;f({type:"edit",initialSelection:P})},[i,h.type]),b=at.useCallback(C=>{i||h.type!=="lazy"||d.current||f({type:"edit",initialSelection:{anchor:t.length}})},[i,h.type,t]),S=at.useCallback(C=>{n?.(C),r&&f({type:"lazy"})},[r,n]);return h.type==="edit"||!r?Bt.jsx(Jm,{ref:l,value:t,type:e,disabled:i,onBlur:S,initialSelection:h.type==="edit"?h.initialSelection:void 0,...o}):Bt.jsx(t0,{ref:Sm(c,l),type:e,value:t,onClick:w,onFocus:b,onMouseDown:g,onMouseUp:m,disabled:i,...o})});e0.__docgenInfo={description:"",methods:[],displayName:"CodeEditor",props:{maxRows:{required:!1,tsType:{name:"number"},description:""},value:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"''",computed:!1}},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},onStateChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(state: EditorState) => void",signature:{arguments:[{type:{name:"EditorState"},name:"state"}],return:{name:"void"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},type:{required:!1,tsType:{name:"union",raw:"'unary' | 'standard' | 'template'",elements:[{name:"literal",value:"'unary'"},{name:"literal",value:"'standard'"},{name:"literal",value:"'template'"}]},description:"",defaultValue:{value:"'standard'",computed:!1}},lint:{required:!1,tsType:{name:"boolean"},description:""},strict:{required:!1,tsType:{name:"boolean"},description:""},fullHeight:{required:!1,tsType:{name:"boolean"},description:""},noStyle:{required:!1,tsType:{name:"boolean"},description:""},extension:{required:!1,tsType:{name:"signature",type:"function",raw:"(params: ExtensionParams) => Extension",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  type?: 'standard' | 'unary' | 'template';
}`,signature:{properties:[{key:"type",value:{name:"union",raw:"'standard' | 'unary' | 'template'",elements:[{name:"literal",value:"'standard'"},{name:"literal",value:"'unary'"},{name:"literal",value:"'template'"}],required:!1}}]}},name:"params"}],return:{name:"Extension"}}},description:""},livePreview:{required:!1,tsType:{name:"signature",type:"object",raw:"{ input: unknown; fromSimulation: boolean; result?: unknown }",signature:{properties:[{key:"input",value:{name:"unknown",required:!0}},{key:"fromSimulation",value:{name:"boolean",required:!0}},{key:"result",value:{name:"unknown",required:!1}}]}},description:""},variableType:{required:!1,tsType:{name:"any"},description:""},expectedVariableType:{required:!1,tsType:{name:"any"},description:""},lazy:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},initialSelection:{required:!1,tsType:{name:"signature",type:"object",raw:"{ anchor: number; head?: number }",signature:{properties:[{key:"anchor",value:{name:"number",required:!0}},{key:"head",value:{name:"number",required:!1}}]}},description:""}}};const ZT=/("(?:[^\\"]|\\.)*")|[:,]/g;function Vp(r,t={}){const e=JSON.stringify([1],void 0,t.indent===void 0?2:t.indent).slice(2,-3),i=e===""?1/0:t.maxLength===void 0?80:t.maxLength;let{replacer:n}=t;return function o(l,h,f){l&&typeof l.toJSON=="function"&&(l=l.toJSON());const c=JSON.stringify(l,n);if(c===void 0)return c;const d=i-h.length-f;if(c.length<=d){const g=c.replace(ZT,(m,w)=>w||`${m} `);if(g.length<=d)return g}if(n!=null&&(l=JSON.parse(c),n=void 0),typeof l=="object"&&l!==null){const g=h+e,m=[];let w=0,b,S;if(Array.isArray(l)){b="[",S="]";const{length:C}=l;for(;w<C;w++)m.push(o(l[w],g,w===C-1?0:1)||"null")}else{b="{",S="}";const C=Object.keys(l),{length:P}=C;for(;w<P;w++){const B=C[w],L=`${JSON.stringify(B)}: `,_=o(l[B],g,L.length+(w===P-1?0:1));_!==void 0&&m.push(L+_)}}if(m.length>0)return[b,e+m.join(`,
${g}`),S].join(`
${h}`)}return c}(r,"",0)}/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jT=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),JT=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,i)=>i?i.toUpperCase():e.toLowerCase()),Hp=r=>{const t=JT(r);return t.charAt(0).toUpperCase()+t.slice(1)},i0=(...r)=>r.filter((t,e,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===e).join(" ").trim();/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var t2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e2=at.forwardRef(({color:r="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:i,className:n="",children:o,iconNode:l,...h},f)=>at.createElement("svg",{ref:f,...t2,width:t,height:t,stroke:r,strokeWidth:i?Number(e)*24/Number(t):e,className:i0("lucide",n),...h},[...l.map(([c,d])=>at.createElement(c,d)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i2=(r,t)=>{const e=at.forwardRef(({className:i,...n},o)=>at.createElement(e2,{ref:o,iconNode:t,className:i0(`lucide-${jT(Hp(r))}`,`lucide-${r}`,i),...n}));return e.displayName=Hp(r),e};/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n2=[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]],r2=i2("bug",n2),s2=({initial:r,expression:t,inputData:e,noPreviewText:i="Run simulation to see the results"})=>{const n=at.useMemo(()=>{if(e){if(!Pn()||t===r?.expression)return{type:"initial",value:Vp(r?.result,{maxLength:30})};if(!t)return{type:"none",value:"-"};try{const o=e.evaluateExpression(t);return{type:"success",value:Vp(o,{maxLength:30})}}catch(o){return{type:"error",value:o.toString()}}}},[e,t,r]);return Bt.jsxs("div",{children:[Bt.jsxs(Lr.Text,{style:{fontSize:12},children:["Live Preview ",Bt.jsx(r2,{size:"1em",opacity:.5,color:"#077D16"})]}),Bt.jsx(Lr.Text,{style:{fontSize:12,display:"block"},type:"secondary",children:n?.type==="initial"?"Based on simulation data":"Based on live calculation"}),Bt.jsxs("div",{className:"grl-ce-preview",children:[(n?.type==="success"||n?.type==="initial")&&Bt.jsx(e0,{value:n.value,disabled:!0,noStyle:!0,maxRows:3}),n?.type==="none"&&Bt.jsx(Lr.Text,{type:"secondary",ellipsis:!0,children:n.value}),n?.type==="error"&&Bt.jsx(Lr.Text,{type:"danger",ellipsis:!0,children:n.value}),!n&&Bt.jsx(Lr.Text,{type:"secondary",ellipsis:!0,children:i})]})]})};s2.__docgenInfo={description:"",methods:[],displayName:"CodeEditorPreview",props:{initial:{required:!1,tsType:{name:"signature",type:"object",raw:"{ expression: string; result: unknown }",signature:{properties:[{key:"expression",value:{name:"string",required:!0}},{key:"result",value:{name:"unknown",required:!0}}]}},description:""},expression:{required:!0,tsType:{name:"string"},description:""},inputData:{required:!1,tsType:{name:"Variable"},description:""},noPreviewText:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'Run simulation to see the results'",computed:!1}}}};export{e0 as C,d2 as _,s2 as a,Qr as b,i2 as c,Sm as d,Cm as l,xe as s};
